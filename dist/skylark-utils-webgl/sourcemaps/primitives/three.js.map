{"version":3,"sources":["primitives/three.js"],"names":["define","EventDispatcher","Vector2","x","y","this","Matrix4","elements","arguments","length","console","error","Quaternion","z","w","_x","_y","_z","_w","undefined","Vector3","Matrix3","Texture","image","mapping","wrapS","wrapT","magFilter","minFilter","format","type","anisotropy","encoding","Object","defineProperty","value","textureId","uuid","_Math","generateUUID","name","DEFAULT_IMAGE","mipmaps","DEFAULT_MAPPING","ClampToEdgeWrapping","LinearFilter","LinearMipMapLinearFilter","RGBAFormat","UnsignedByteType","offset","repeat","center","rotation","matrixAutoUpdate","matrix","generateMipmaps","premultiplyAlpha","flipY","unpackAlignment","LinearEncoding","version","onUpdate","Vector4","WebGLRenderTarget","width","height","options","scissor","scissorTest","viewport","texture","depthBuffer","stencilBuffer","depthTexture","WebGLRenderTargetCube","call","activeCubeFace","activeMipMapLevel","DataTexture","data","NearestFilter","Box3","min","max","Infinity","Sphere","radius","Plane","normal","constant","Frustum","p0","p1","p2","p3","p4","p5","planes","Color","r","g","b","set","setRGB","WebGLAnimation","onAnimationFrame","time","frame","isAnimating","animationLoop","context","requestAnimationFrame","start","stop","setAnimationLoop","callback","setContext","WebGLAttributes","gl","createBuffer","attribute","bufferType","array","usage","dynamic","DYNAMIC_DRAW","STATIC_DRAW","buffer","bindBuffer","bufferData","onUploadCallback","FLOAT","Float32Array","Float64Array","warn","Uint16Array","UNSIGNED_SHORT","Int16Array","SHORT","Uint32Array","UNSIGNED_INT","Int32Array","INT","Int8Array","BYTE","Uint8Array","UNSIGNED_BYTE","bytesPerElement","BYTES_PER_ELEMENT","updateBuffer","updateRange","count","bufferSubData","subarray","get","isInterleavedBufferAttribute","buffers","remove","deleteBuffer","update","WeakMap","Euler","order","_order","DefaultOrder","Layers","mask","Object3D","onRotationChange","quaternion","setFromEuler","onQuaternionChange","setFromQuaternion","object3DId","parent","children","up","DefaultUp","clone","position","scale","onChange","defineProperties","enumerable","modelViewMatrix","normalMatrix","matrixWorld","DefaultMatrixAutoUpdate","matrixWorldNeedsUpdate","layers","visible","castShadow","receiveShadow","frustumCulled","renderOrder","userData","Camera","matrixWorldInverse","projectionMatrix","projectionMatrixInverse","OrthographicCamera","left","right","top","bottom","near","far","zoom","view","updateProjectionMatrix","Face3","a","c","color","materialIndex","isVector3","vertexNormals","Array","isArray","isColor","vertexColors","Geometry","geometryId","vertices","colors","faces","faceVertexUvs","morphTargets","morphNormals","skinWeights","skinIndices","lineDistances","boundingBox","boundingSphere","elementsNeedUpdate","verticesNeedUpdate","uvsNeedUpdate","normalsNeedUpdate","colorsNeedUpdate","lineDistancesNeedUpdate","groupsNeedUpdate","BufferAttribute","itemSize","normalized","TypeError","Int8BufferAttribute","Uint8BufferAttribute","Uint8ClampedBufferAttribute","Uint8ClampedArray","Int16BufferAttribute","Uint16BufferAttribute","Int32BufferAttribute","Uint32BufferAttribute","Float32BufferAttribute","Float64BufferAttribute","DirectGeometry","normals","uvs","uvs2","groups","arrayMax","i","l","BufferGeometry","bufferGeometryId","index","attributes","morphAttributes","drawRange","BoxGeometry","depth","widthSegments","heightSegments","depthSegments","parameters","fromBufferGeometry","BoxBufferGeometry","mergeVertices","buildPlane","u","v","udir","vdir","gridX","gridY","ix","iy","segmentWidth","segmentHeight","widthHalf","heightHalf","depthHalf","gridX1","gridY1","vertexCounter","groupCount","vector","push","numberOfVertices","d","indices","scope","addGroup","groupStart","Math","floor","setIndex","addAttribute","PlaneGeometry","PlaneBufferGeometry","width_half","height_half","segment_width","segment_height","Material","materialId","fog","lights","blending","NormalBlending","side","FrontSide","flatShading","NoColors","opacity","transparent","blendSrc","SrcAlphaFactor","blendDst","OneMinusSrcAlphaFactor","blendEquation","AddEquation","blendSrcAlpha","blendDstAlpha","blendEquationAlpha","depthFunc","LessEqualDepth","depthTest","depthWrite","clippingPlanes","clipIntersection","clipShadows","shadowSide","colorWrite","precision","polygonOffset","polygonOffsetFactor","polygonOffsetUnits","dithering","alphaTest","premultipliedAlpha","overdraw","needsUpdate","MeshBasicMaterial","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","specularMap","alphaMap","envMap","combine","MultiplyOperation","reflectivity","refractionRatio","wireframe","wireframeLinewidth","wireframeLinecap","wireframeLinejoin","skinning","setValues","ShaderMaterial","defines","uniforms","vertexShader","fragmentShader","linewidth","clipping","extensions","derivatives","fragDepth","drawBuffers","shaderTextureLOD","defaultAttributeValues","uv","uv2","index0AttributeName","uniformsNeedUpdate","Ray","origin","direction","Triangle","Mesh","geometry","material","random","drawMode","TrianglesDrawMode","updateMorphTargets","WebGLBackground","renderer","state","objects","render","renderList","scene","camera","forceClear","background","setClear","clearColor","clearAlpha","autoClear","clear","autoClearColor","autoClearDepth","autoClearStencil","isCubeTexture","boxMesh","ShaderLib","cube","BackSide","removeAttribute","onBeforeRender","copyPosition","tCube","isTexture","planeCamera","planeMesh","renderBufferDirect","alpha","getClearColor","setClearColor","getClearAlpha","setClearAlpha","WebGLBufferRenderer","info","capabilities","setMode","mode","drawArrays","renderInstances","extension","isWebGL2","maxInstancedCount","WebGLCapabilities","getMaxAnisotropy","maxAnisotropy","getParameter","MAX_TEXTURE_MAX_ANISOTROPY_EXT","getMaxPrecision","getShaderPrecisionFormat","VERTEX_SHADER","HIGH_FLOAT","FRAGMENT_SHADER","MEDIUM_FLOAT","WebGL2RenderingContext","maxPrecision","logarithmicDepthBuffer","maxTextures","MAX_TEXTURE_IMAGE_UNITS","maxVertexTextures","MAX_VERTEX_TEXTURE_IMAGE_UNITS","maxTextureSize","MAX_TEXTURE_SIZE","maxCubemapSize","MAX_CUBE_MAP_TEXTURE_SIZE","maxAttributes","MAX_VERTEX_ATTRIBS","maxVertexUniforms","MAX_VERTEX_UNIFORM_VECTORS","maxVaryings","MAX_VARYING_VECTORS","maxFragmentUniforms","MAX_FRAGMENT_UNIFORM_VECTORS","vertexTextures","floatFragmentTextures","floatVertexTextures","WebGLClipping","resetGlobalState","uniform","globalState","numGlobalPlanes","numPlanes","numIntersection","projectPlanes","dstOffset","skipTransform","nPlanes","dstArray","flatSize","viewMatrix","viewNormalMatrix","getNormalMatrix","i4","plane","copy","applyMatrix4","toArray","localClippingEnabled","renderingShadows","init","enableLocalClipping","enabled","beginShadows","endShadows","setState","cache","fromCache","nGlobal","lGlobal","clippingState","WebGLExtensions","getExtension","WebGLGeometries","onGeometryDispose","event","target","buffergeometry","geometries","id","removeEventListener","wireframeAttributes","memory","object","addEventListener","isBufferGeometry","isGeometry","_bufferGeometry","setFromObject","geometryAttributes","ELEMENT_ARRAY_BUFFER","ARRAY_BUFFER","getWireframeAttribute","geometryIndex","WebGLIndexedBufferRenderer","drawElements","WebGLInfo","instanceCount","calls","TRIANGLES","triangles","TRIANGLE_STRIP","TRIANGLE_FAN","LINES","lines","LINE_STRIP","LINE_LOOP","POINTS","points","reset","textures","programs","autoReset","absNumericalSort","abs","WebGLMorphtargets","program","objectInfluences","morphTargetInfluences","influences","influencesList","influence","sort","morphInfluences","getUniforms","setValue","WebGLObjects","updateList","updateFromObject","dispose","CubeTexture","images","CubeReflectionMapping","UniformContainer","seq","flatten","nBlocks","blockSize","firstElem","n","arrayCacheF32","arraysEqual","copyArray","allocTexUnits","arrayCacheI32","allocTextureUnit","setValue1f","uniform1f","addr","setValue1i","uniform1i","setValue2fv","uniform2f","uniform2fv","setValue3fv","uniform3f","uniform3fv","setValue4fv","uniform4f","uniform4fv","setValue2fm","uniformMatrix2fv","mat2array","setValue3fm","uniformMatrix3fv","mat3array","setValue4fm","uniformMatrix4fv","mat4array","setValueT1","unit","setTexture2D","emptyTexture","setValueT6","setTextureCube","emptyCubeTexture","setValue2iv","uniform2iv","setValue3iv","uniform3iv","setValue4iv","uniform4iv","getSingularSetter","setValue1fv","uniform1fv","setValue1iv","uniform1iv","setValueV2a","size","updateCache","setValueV3a","setValueV4a","setValueM2a","setValueM3a","setValueM4a","setValueT1a","units","setValueT6a","getPureArraySetter","SingleUniform","activeInfo","PureArrayUniform","StructuredUniform","addUniform","container","uniformObject","parseUniform","path","pathLength","RePathPart","lastIndex","match","exec","matchEnd","idIsIndex","subscript","next","WebGLUniforms","getProgramParameter","ACTIVE_UNIFORMS","getActiveUniform","getUniformLocation","addLineNumbers","string","split","join","WebGLShader","shader","createShader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","getEncodingComponents","sRGBEncoding","RGBEEncoding","RGBM7Encoding","RGBM16Encoding","RGBDEncoding","GammaEncoding","Error","getTexelDecodingFunction","functionName","components","getTexelEncodingFunction","getToneMappingFunction","toneMapping","toneMappingName","LinearToneMapping","ReinhardToneMapping","Uncharted2ToneMapping","CineonToneMapping","generateExtensions","rendererExtensions","chunks","envMapCubeUV","bumpMap","normalMap","objectSpaceNormalMap","filter","filterEmptyLine","generateDefines","fetchAttributeLocations","ACTIVE_ATTRIBUTES","getActiveAttrib","getAttribLocation","replaceLightNums","replace","numDirLights","numSpotLights","numRectAreaLights","numPointLights","numHemiLights","replaceClippingPlaneNums","numClippingPlanes","numClipIntersection","parseIncludes","include","ShaderChunk","pattern","unrollLoops","end","snippet","unroll","parseInt","WebGLProgram","code","shadowMapTypeDefine","shadowMapType","PCFShadowMap","PCFSoftShadowMap","envMapTypeDefine","envMapModeDefine","envMapBlendingDefine","CubeRefractionMapping","CubeUVReflectionMapping","CubeUVRefractionMapping","EquirectangularReflectionMapping","EquirectangularRefractionMapping","SphericalReflectionMapping","MixOperation","AddOperation","prefixVertex","prefixFragment","gammaFactorDefine","gammaFactor","customExtensions","customDefines","createProgram","isRawShaderMaterial","supportsVertexTextures","maxBones","useFog","fogExp","emissiveMap","displacementMap","roughnessMap","metalnessMap","useVertexTexture","doubleSided","flipSided","shadowMapEnabled","sizeAttenuation","gradientMap","physicallyCorrectLights","NoToneMapping","outputEncoding","mapEncoding","envMapEncoding","emissiveMapEncoding","depthPacking","isGLSL3ShaderMaterial","versionRegex","isShaderMaterial","vertexGlsl","fragmentGlsl","glVertexShader","glFragmentShader","attachShader","bindAttribLocation","linkProgram","programLog","getProgramInfoLog","trim","vertexLog","fragmentLog","runnable","haveDiagnostics","LINK_STATUS","getError","VALIDATE_STATUS","diagnostics","log","prefix","deleteShader","cachedUniforms","cachedAttributes","getAttributes","destroy","deleteProgram","programIdCount","usedTimes","WebGLPrograms","allocateBones","skeleton","bones","nVertexUniforms","nVertexMatrices","getTextureEncodingFromMap","gammaOverrideLinear","isWebGLRenderTarget","shaderIDs","MeshDepthMaterial","MeshDistanceMaterial","MeshNormalMaterial","MeshLambertMaterial","MeshPhongMaterial","MeshToonMaterial","MeshStandardMaterial","MeshPhysicalMaterial","LineBasicMaterial","LineDashedMaterial","PointsMaterial","ShadowMaterial","SpriteMaterial","parameterNames","getParameters","shadows","nClipPlanes","nClipIntersection","shaderID","isSkinnedMesh","currentRenderTarget","getRenderTarget","gammaOutput","gammaInput","envMapMode","normalMapType","ObjectSpaceNormalMap","isFogExp2","maxMorphTargets","maxMorphNormals","directional","point","spot","rectArea","hemi","shadowMap","DoubleSide","getProgramCode","onBeforeCompile","toString","acquireProgram","p","pl","programInfo","releaseProgram","indexOf","pop","WebGLProperties","properties","key","painterSortStable","reversePainterSortStable","WebGLRenderList","renderItemsIndex","opaque","group","renderItem","renderItems","WebGLRenderLists","hash","list","lists","UniformsCache","light","shadow","shadowBias","shadowRadius","shadowMapSize","distance","coneCos","penumbraCos","decay","shadowCameraNear","shadowCameraFar","skyColor","groundColor","halfWidth","halfHeight","WebGLLights","setup","directionalLength","pointLength","spotLength","rectAreaLength","hemiLength","intensity","isAmbientLight","isDirectionalLight","multiplyScalar","setFromMatrixPosition","vector3","sub","transformDirection","bias","mapSize","directionalShadowMap","directionalShadowMatrix","isSpotLight","cos","angle","penumbra","spotShadowMap","spotShadowMatrix","isRectAreaLight","matrix42","identity","matrix4","premultiply","extractRotation","isPointLight","pointShadowMap","pointShadowMatrix","isHemisphereLight","normalize","ambient","stateID","shadowsLength","WebGLRenderState","lightsArray","shadowsArray","pushLight","pushShadow","shadowLight","setupLights","WebGLRenderStates","renderState","renderStates","BasicDepthPacking","displacementScale","displacementBias","referencePosition","nearDistance","farDistance","WebGLShadowMap","_renderer","_objects","getDepthMaterial","lightPositionWorld","result","materialVariants","_depthMaterials","customMaterial","customDepthMaterial","_distanceMaterials","customDistanceMaterial","useMorphing","useSkinning","variantIndex","_MorphingFlag","_SkinningFlag","keyA","keyB","materialsForVariant","_materialCache","cachedMaterial","isMeshDistanceMaterial","renderObject","shadowCamera","test","isMesh","isLine","isPoints","_frustum","intersectsObject","multiplyMatrices","k","kl","groupMaterial","depthMaterial","_lightPositionWorld","_projScreenMatrix","_shadowMapSize","_maxShadowMapSize","_lookTarget","_NumberOfMaterialVariants","0","1","2","cubeDirections","cubeUps","cube2DViewPorts","RGBADepthPacking","distanceMaterial","autoUpdate","_gl","_state","disable","BLEND","setTest","setScissorTest","faceCount","il","vpWidth","vpHeight","pars","isSpotLightShadow","shadowMatrix","makeTranslation","lookAt","updateMatrixWorld","multiply","setRenderTarget","face","add","vpDimensions","setFromMatrix","WebGLState","utils","ColorBuffer","locked","currentColorMask","currentColorClear","setMask","colorMask","setLocked","lock","equals","DepthBuffer","currentDepthMask","currentDepthFunc","currentDepthClear","enable","DEPTH_TEST","depthMask","setFunc","NeverDepth","NEVER","AlwaysDepth","ALWAYS","LessDepth","LESS","LEQUAL","EqualDepth","EQUAL","GreaterEqualDepth","GEQUAL","GreaterDepth","GREATER","NotEqualDepth","NOTEQUAL","clearDepth","StencilBuffer","currentStencilMask","currentStencilFunc","currentStencilRef","currentStencilFuncMask","currentStencilFail","currentStencilZFail","currentStencilZPass","currentStencilClear","stencilTest","STENCIL_TEST","stencilMask","stencilFunc","stencilRef","setOp","stencilFail","stencilZFail","stencilZPass","stencilOp","stencil","clearStencil","createTexture","bindTexture","texParameteri","TEXTURE_MIN_FILTER","NEAREST","TEXTURE_MAG_FILTER","texImage2D","RGBA","initAttributes","newAttributes","enableAttribute","enableAttributeAndDivisor","meshPerAttribute","enabledAttributes","enableVertexAttribArray","attributeDivisors","disableUnusedAttributes","disableVertexAttribArray","enabledCapabilities","getCompressedTextureFormats","compressedTextureFormats","formats","COMPRESSED_TEXTURE_FORMATS","useProgram","currentProgram","setBlending","NoBlending","currentBlendingEnabled","CustomBlending","currentBlendEquation","currentBlendEquationAlpha","blendEquationSeparate","convert","currentBlendSrc","currentBlendDst","currentBlendSrcAlpha","currentBlendDstAlpha","blendFuncSeparate","currentBlending","currentPremultipledAlpha","FUNC_ADD","ONE","ONE_MINUS_SRC_ALPHA","AdditiveBlending","blendFunc","SubtractiveBlending","ZERO","ONE_MINUS_SRC_COLOR","MultiplyBlending","SRC_COLOR","SRC_ALPHA","setMaterial","frontFaceCW","CULL_FACE","setFlipSided","colorBuffer","setPolygonOffset","currentFlipSided","frontFace","CW","CCW","setCullFace","cullFace","CullFaceNone","currentCullFace","CullFaceBack","BACK","CullFaceFront","FRONT","FRONT_AND_BACK","setLineWidth","currentLineWidth","lineWidthAvailable","lineWidth","factor","POLYGON_OFFSET_FILL","currentPolygonOffsetFactor","currentPolygonOffsetUnits","SCISSOR_TEST","activeTexture","webglSlot","TEXTURE0","currentTextureSlot","webglType","webglTexture","boundTexture","currentBoundTextures","emptyTextures","compressedTexImage2D","apply","currentScissor","currentViewport","maxVertexAttributes","MAX_COMBINED_TEXTURE_IMAGE_UNITS","glVersion","VERSION","parseFloat","TEXTURE_2D","TEXTURE_CUBE_MAP","TEXTURE_CUBE_MAP_POSITIVE_X","WebGLTextures","clampToMaxSize","maxSize","canvas","document","createElementNS","getContext","drawImage","isPowerOfTwo","makePowerOfTwo","HTMLImageElement","HTMLCanvasElement","ImageBitmap","_canvas","floorPowerOfTwo","textureNeedsPowerOfTwo","textureNeedsGenerateMipmaps","generateMipmap","textureProperties","__maxMipLevel","LOG2E","getInternalFormat","glFormat","glType","RGB","RGB32F","HALF_FLOAT","RGB16F","RGB8","RGBA32F","RGBA16F","RGBA8","filterFallback","f","NearestMipMapNearestFilter","NearestMipMapLinearFilter","LINEAR","onTextureDispose","deallocateTexture","isVideoTexture","_videoTextures","onRenderTargetDispose","renderTarget","deallocateRenderTarget","__image__webglTextureCube","deleteTexture","__webglInit","__webglTexture","renderTargetProperties","isWebGLRenderTargetCube","deleteFramebuffer","__webglFramebuffer","__webglDepthbuffer","deleteRenderbuffer","slot","updateVideoTexture","__version","complete","uploadTexture","pixelStorei","UNPACK_FLIP_Y_WEBGL","isCompressed","isCompressedTexture","isDataTexture","cubeImage","isPowerOfTwoImage","glInternalFormat","setTextureParameters","mipmap","j","jl","RGBFormat","setTextureCubeDynamic","textureType","TEXTURE_WRAP_S","TEXTURE_WRAP_T","CLAMP_TO_EDGE","FloatType","HalfFloatType","__currentAnisotropy","texParameterf","TEXTURE_MAX_ANISOTROPY_EXT","UNPACK_PREMULTIPLY_ALPHA_WEBGL","UNPACK_ALIGNMENT","isDepthTexture","DEPTH_COMPONENT","DEPTH_COMPONENT32F","DEPTH_COMPONENT16","DepthFormat","UnsignedShortType","UnsignedIntType","DepthStencilFormat","DEPTH_STENCIL","UnsignedInt248Type","setupFrameBufferTexture","framebuffer","attachment","textureTarget","bindFramebuffer","FRAMEBUFFER","framebufferTexture2D","setupRenderBufferStorage","renderbuffer","bindRenderbuffer","RENDERBUFFER","renderbufferStorage","framebufferRenderbuffer","DEPTH_ATTACHMENT","DEPTH_STENCIL_ATTACHMENT","RGBA4","setupDepthTexture","isCube","webglDepthTexture","setupDepthRenderbuffer","createRenderbuffer","setupRenderTarget","isTargetPowerOfTwo","createFramebuffer","COLOR_ATTACHMENT0","updateRenderTargetMipmap","WebGLUtils","RepeatWrapping","REPEAT","MirroredRepeatWrapping","MIRRORED_REPEAT","NEAREST_MIPMAP_NEAREST","NEAREST_MIPMAP_LINEAR","LinearMipMapNearestFilter","LINEAR_MIPMAP_NEAREST","LINEAR_MIPMAP_LINEAR","UnsignedShort4444Type","UNSIGNED_SHORT_4_4_4_4","UnsignedShort5551Type","UNSIGNED_SHORT_5_5_5_1","UnsignedShort565Type","UNSIGNED_SHORT_5_6_5","ByteType","ShortType","IntType","HALF_FLOAT_OES","AlphaFormat","ALPHA","LuminanceFormat","LUMINANCE","LuminanceAlphaFormat","LUMINANCE_ALPHA","SubtractEquation","FUNC_SUBTRACT","ReverseSubtractEquation","FUNC_REVERSE_SUBTRACT","ZeroFactor","OneFactor","SrcColorFactor","OneMinusSrcColorFactor","DstAlphaFactor","DST_ALPHA","OneMinusDstAlphaFactor","ONE_MINUS_DST_ALPHA","DstColorFactor","DST_COLOR","OneMinusDstColorFactor","ONE_MINUS_DST_COLOR","SrcAlphaSaturateFactor","SRC_ALPHA_SATURATE","RGB_S3TC_DXT1_Format","RGBA_S3TC_DXT1_Format","RGBA_S3TC_DXT3_Format","RGBA_S3TC_DXT5_Format","COMPRESSED_RGB_S3TC_DXT1_EXT","COMPRESSED_RGBA_S3TC_DXT1_EXT","COMPRESSED_RGBA_S3TC_DXT3_EXT","COMPRESSED_RGBA_S3TC_DXT5_EXT","RGB_PVRTC_4BPPV1_Format","RGB_PVRTC_2BPPV1_Format","RGBA_PVRTC_4BPPV1_Format","RGBA_PVRTC_2BPPV1_Format","COMPRESSED_RGB_PVRTC_4BPPV1_IMG","COMPRESSED_RGB_PVRTC_2BPPV1_IMG","COMPRESSED_RGBA_PVRTC_4BPPV1_IMG","COMPRESSED_RGBA_PVRTC_2BPPV1_IMG","RGB_ETC1_Format","COMPRESSED_RGB_ETC1_WEBGL","RGBA_ASTC_4x4_Format","RGBA_ASTC_5x4_Format","RGBA_ASTC_5x5_Format","RGBA_ASTC_6x5_Format","RGBA_ASTC_6x6_Format","RGBA_ASTC_8x5_Format","RGBA_ASTC_8x6_Format","RGBA_ASTC_8x8_Format","RGBA_ASTC_10x5_Format","RGBA_ASTC_10x6_Format","RGBA_ASTC_10x8_Format","RGBA_ASTC_10x10_Format","RGBA_ASTC_12x10_Format","RGBA_ASTC_12x12_Format","MinEquation","MaxEquation","MIN","MAX","MIN_EXT","MAX_EXT","UNSIGNED_INT_24_8","UNSIGNED_INT_24_8_WEBGL","Group","PerspectiveCamera","fov","aspect","focus","filmGauge","filmOffset","ArrayCamera","cameras","WebVRManager","isPresenting","device","onVRDisplayPresentChange","eyeParameters","getEyeParameters","renderWidth","renderHeight","currentPixelRatio","getPixelRatio","currentSize","getSize","setDrawingBufferSize","animation","findGamepad","gamepads","navigator","getGamepads","gamepad","startsWith","updateControllers","controllers","controller","pose","hasPosition","fromArray","orientation","compose","standingMatrix","decompose","buttonId","triggers","buttons","pressed","dispatchEvent","frameData","poseTarget","standingMatrixInverse","window","VRFrameData","tempQuaternion","tempPosition","cameraL","bounds","cameraR","cameraVR","userHeight","getController","getDevice","setDevice","setPoseTarget","getCamera","depthNear","depthFar","getFrameData","stageParameters","sittingToStandingTransform","poseObject","setFromRotationMatrix","applyQuaternion","leftViewMatrix","rightViewMatrix","getInverse","leftProjectionMatrix","rightProjectionMatrix","getLayers","layer","leftBounds","rightBounds","getStandingMatrix","submitFrame","WebXRManager","session","frameOfRef","onSessionEvent","inputSources","inputSource","onSessionEnd","setFramebuffer","updateCamera","getDevicePose","baseLayer","views","getViewport","getViewMatrix","inputPose","getInputPose","targetRay","transformMatrix","pointerMatrix","onAnimationFrameCallback","XRDevice","setCompatibleXRDevice","setSession","XRWebGLLayer","requestFrameOfReference","frameOfReferenceType","then","getInputSources","THREE","WebGLRenderer","getTargetPixelRatio","_currentRenderTarget","_pixelRatio","initGLContext","_currentScissor","_scissor","_currentViewport","_viewport","morphtargets","programCache","_this","renderLists","_premultipliedAlpha","bufferRenderer","indexedBufferRenderer","onContextLost","preventDefault","_isContextLost","onContextRestore","onMaterialDispose","deallocateMaterial","releaseMaterialProgramReference","renderObjectImmediate","renderBufferImmediate","setupVertexAttributes","isInstancedBufferGeometry","programAttributes","materialDefaultAttributeValues","programAttribute","geometryAttribute","stride","isInstancedInterleavedBuffer","vertexAttribPointer","isInstancedBufferAttribute","vertexAttrib2fv","vertexAttrib3fv","vertexAttrib4fv","vertexAttrib1fv","vr","projectObject","sortObjects","isLight","currentRenderState","isSprite","intersectsSprite","_vector3","currentRenderList","isImmediateRenderObject","renderObjects","overrideMaterial","isArrayCamera","_currentArrayCamera","camera2","_width","_height","setProgram","_currentGeometryProgram","onAfterRender","initMaterial","materialProperties","lightsHash","lightsStateHash","_clipping","programChange","UniformsUtils","numSupportedMorphTargets","numSupportedMorphNormals","ambientLightColor","directionalLights","spotLights","rectAreaLights","pointLights","hemisphereLights","progUniforms","uniformsList","seqWithValue","_usedTextureUnits","_clippingEnabled","_localClippingEnabled","_currentCamera","useCache","_currentMaterialId","refreshProgram","refreshMaterial","refreshLights","p_uniforms","m_uniforms","LN2","isMeshPhongMaterial","isMeshStandardMaterial","uCamPos","cameraPosition","isMeshLambertMaterial","isMeshBasicMaterial","setOptional","boneTexture","sqrt","ceilPowerOfTwo","boneMatrices","boneTextureSize","toneMappingExposure","toneMappingWhitePoint","markUniformsLightsNeedsUpdate","refreshUniformsFog","refreshUniformsCommon","refreshUniformsLambert","isMeshToonMaterial","refreshUniformsToon","refreshUniformsPhong","isMeshPhysicalMaterial","refreshUniformsPhysical","refreshUniformsStandard","isMeshDepthMaterial","refreshUniformsDepth","refreshUniformsDistance","isMeshNormalMaterial","refreshUniformsNormal","isLineBasicMaterial","refreshUniformsLine","isLineDashedMaterial","refreshUniformsDash","isPointsMaterial","refreshUniformsPoints","isSpriteMaterial","refreshUniformsSprites","isShadowMaterial","ltc_1","UniformsLib","LTC_1","ltc_2","LTC_2","upload","diffuse","emissive","emissiveIntensity","flipEnvMap","maxMipLevel","uvScaleMap","updateMatrix","uvTransform","dashSize","totalSize","gapSize","fogColor","isFog","fogNear","fogFar","fogDensity","density","specular","shininess","bumpScale","normalScale","negate","roughness","metalness","envMapIntensity","clearCoat","clearCoatRoughness","textureUnit","REVISION","_context","_alpha","_depth","_stencil","_antialias","antialias","_preserveDrawingBuffer","preserveDrawingBuffer","_powerPreference","powerPreference","domElement","_framebuffer","_currentFramebuffer","_currentScissorTest","_scissorTest","contextAttributes","rangeMin","rangeMax","message","getContextAttributes","forceContextLoss","loseContext","forceContextRestore","restoreContext","setPixelRatio","setSize","updateStyle","style","setViewport","getDrawingBufferSize","pixelRatio","getCurrentViewport","setScissor","boolean","bits","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT","clearTarget","hasPositions","hasNormals","hasUvs","hasColors","positionArray","normalArray","uvArray","colorArray","determinant","updateBuffers","rangeFactor","dataCount","rangeStart","rangeCount","drawStart","drawEnd","drawCount","TriangleStripDrawMode","TriangleFanDrawMode","isLineSegments","isLineLoop","compile","traverse","isCamera","opaqueObjects","transparentObjects","warned","setTexture","readRenderTargetPixels","restore","textureFormat","IMPLEMENTATION_COLOR_READ_FORMAT","IMPLEMENTATION_COLOR_READ_TYPE","checkFramebufferStatus","FRAMEBUFFER_COMPLETE","readPixels","copyFramebufferToTexture","level","copyTexImage2D","copyTextureToTexture","srcTexture","dstTexture","texSubImage2D","FogExp2","Fog","Scene","InterleavedBuffer","InterleavedBufferAttribute","interleavedBuffer","Sprite","float32Array","LOD","levels","Skeleton","boneInverses","slice","calculateInverses","Bone","SkinnedMesh","bindMode","bindMatrix","bindMatrixInverse","initBones","bind","normalizeSkinWeights","linecap","linejoin","Line","LineSegments","LineLoop","Points","VideoTexture","video","CompressedTexture","CanvasTexture","DepthTexture","WireframeGeometry","o","ol","e","edge1","edge2","vertex","edge","edges","keys","index1","index2","getX","fromBufferAttribute","ParametricGeometry","func","slices","stacks","ParametricBufferGeometry","EPS","pu","pv","sliceCount","subVectors","crossVectors","PolyhedronGeometry","detail","PolyhedronBufferGeometry","subdivide","getVertexByIndex","subdivideFace","cols","pow","aj","lerp","bj","rows","pushVertex","appplyRadius","vertexBuffer","generateUVs","azimuth","PI","inclination","uvBuffer","correctUVs","correctSeam","x0","x1","x2","centroid","uvA","uvB","uvC","divideScalar","azi","correctUV","atan2","computeVertexNormals","normalizeNormals","TetrahedronGeometry","TetrahedronBufferGeometry","OctahedronGeometry","OctahedronBufferGeometry","IcosahedronGeometry","IcosahedronBufferGeometry","t","DodecahedronGeometry","DodecahedronBufferGeometry","TubeGeometry","tubularSegments","radialSegments","closed","taper","bufferGeometry","TubeBufferGeometry","tangents","binormals","generateBufferData","generateSegment","generateIndices","P","getPointAt","N","frames","B","sin","computeFrenetFrames","TorusKnotGeometry","tube","q","heightScale","TorusKnotBufferGeometry","calculatePositionOnCurve","cu","su","quOverP","cs","P1","P2","T","addVectors","cx","cy","TorusGeometry","arc","TorusBufferGeometry","linkedList","dim","clockwise","last","signedArea","insertNode","removeNode","filterPoints","again","steiner","area","prev","earcutLinked","ear","minX","minY","invSize","pass","indexCurve","isEarHashed","isEar","cureLocalIntersections","splitEarcut","pointInTriangle","minTX","minTY","maxTX","maxTY","minZ","zOrder","maxZ","nextZ","prevZ","intersects","locallyInside","isValidDiagonal","splitPolygon","eliminateHoles","holeIndices","outerNode","len","queue","getLeftmost","compareX","eliminateHole","hole","findHoleBridge","m","hx","hy","qx","tan","mx","my","tanMin","sortLinked","tail","numMerges","pSize","qSize","inSize","leftmost","ax","ay","bx","by","px","py","intersectsPolygon","middleInside","q1","q2","inside","a2","Node","b2","an","bp","sum","removeDupEndPts","addContour","contour","ExtrudeGeometry","shapes","ExtrudeBufferGeometry","addShape","shape","scalePt2","pt","vec","getBevelVec","inPt","inPrev","inNext","v_trans_x","v_trans_y","shrink_by","v_prev_x","v_prev_y","v_next_x","v_next_y","v_prev_lensq","collinear0","Number","EPSILON","v_prev_len","v_next_len","ptPrevShift_x","ptPrevShift_y","ptNextShift_x","ptNextShift_y","sf","v_trans_lensq","direction_eq","sign","buildLidFaces","verticesArray","bevelEnabled","vlen","flen","f3","steps","bevelSegments","buildSideFaces","layeroffset","sidewalls","h","hl","holes","ahole","s","sl","slen1","slen2","f4","placeholder","addVertex","nextIndex","uvgen","generateTopUV","addUV","generateSideWallUV","vector2","curveSegments","bevelThickness","bevelSize","extrudePath","UVGenerator","WorldUVGenerator","amount","extrudePts","splineTube","binormal","position2","extrudeByPath","getSpacedPoints","shapePoints","extractPoints","reverse","ShapeUtils","isClockWise","triangulateShape","concat","bs","vert","contourMovements","oneHoleMovements","holesMovements","verticesMovements","toJSON","TextGeometry","text","TextBufferGeometry","font","isFont","generateShapes","SphereGeometry","phiStart","phiLength","thetaStart","thetaLength","SphereBufferGeometry","thetaEnd","grid","verticesRow","RingGeometry","innerRadius","outerRadius","thetaSegments","phiSegments","RingBufferGeometry","segment","radiusStep","thetaSegmentLevel","LatheGeometry","segments","LatheBufferGeometry","clamp","base","inverseSegments","phi","n1","n2","ShapeGeometry","ShapeBufferGeometry","shapeHole","indexOffset","shapeVertices","shapeHoles","toJSON$1","EdgesGeometry","thresholdAngle","geometry2","thresholdDot","DEG2RAD","computeFaceNormals","sourceVertices","face1","face2","dot","CylinderGeometry","radiusTop","radiusBottom","openEnded","CylinderBufferGeometry","generateTorso","slope","indexRow","theta","sinTheta","cosTheta","indexArray","generateCap","centerIndexStart","centerIndexEnd","ConeGeometry","ConeBufferGeometry","CircleGeometry","CircleBufferGeometry","RawShaderMaterial","STANDARD","TangentSpaceNormalMap","PHYSICAL","TOON","LoadingManager","onLoad","onProgress","onError","isLoading","itemsLoaded","itemsTotal","urlModifier","onStart","itemStart","url","itemEnd","itemError","resolveURL","setURLModifier","transform","FileLoader","manager","DefaultLoadingManager","CompressedTextureLoader","_parser","DataTextureLoader","ImageLoader","CubeTextureLoader","TextureLoader","Curve","arcLengthDivisions","EllipseCurve","aX","aY","xRadius","yRadius","aStartAngle","aEndAngle","aClockwise","aRotation","ArcCurve","aRadius","CubicPoly","t0","t1","c0","c1","c2","c3","initCatmullRom","x3","tension","initNonuniformCatmullRom","dt0","dt1","dt2","t2","calc","t3","CatmullRomCurve3","curveType","CatmullRom","v0","v1","QuadraticBezierP0","QuadraticBezierP1","QuadraticBezierP2","QuadraticBezier","CubicBezierP0","CubicBezierP1","CubicBezierP2","CubicBezierP3","CubicBezier","CubicBezierCurve","v2","v3","CubicBezierCurve3","LineCurve","LineCurve3","QuadraticBezierCurve","QuadraticBezierCurve3","SplineCurve","CurvePath","curves","autoClose","Path","currentPoint","setFromPoints","Shape","Light","HemisphereLight","LightShadow","SpotLightShadow","SpotLight","power","PointLight","DirectionalLightShadow","DirectionalLight","AmbientLight","RectAreaLight","Interpolant","parameterPositions","sampleValues","sampleSize","resultBuffer","_cachedIndex","constructor","valueSize","CubicInterpolant","_weightPrev","_offsetPrev","_weightNext","_offsetNext","LinearInterpolant","DiscreteInterpolant","KeyframeTrack","times","values","interpolation","AnimationUtils","convertArray","TimeBufferType","ValueBufferType","setInterpolation","DefaultInterpolation","BooleanKeyframeTrack","ColorKeyframeTrack","NumberKeyframeTrack","QuaternionLinearInterpolant","QuaternionKeyframeTrack","StringKeyframeTrack","VectorKeyframeTrack","AnimationClip","duration","tracks","resetDuration","getTrackTypeForValueTypeName","typeName","toLowerCase","parseKeyframeTrack","json","trackType","flattenJSON","parse","MaterialLoader","BufferGeometryLoader","Loader","JSONLoader","withCredentials","ObjectLoader","texturePath","ImageBitmapLoader","createImageBitmap","fetch","ShapePath","subPaths","currentPath","Font","createPaths","chars","from","String","resolution","line_height","yMax","yMin","underlineThickness","paths","offsetX","offsetY","char","ret","createPath","glyph","glyphs","cpx","cpy","cpx1","cpy1","cpx2","cpy2","outline","_cachedOutline","action","moveTo","lineTo","quadraticCurveTo","bezierCurveTo","ha","FontLoader","AudioLoader","StereoCamera","eyeSep","CubeCamera","cubeResolution","cameraPX","cameraNX","cameraPY","cameraNY","cameraPZ","cameraNZ","AudioListener","AudioContext","gain","createGain","connect","destination","Audio","listener","getInput","autoplay","loop","startTime","playbackRate","isPlaying","hasPlaybackControl","sourceType","filters","PositionalAudio","panner","createPanner","AudioAnalyser","audio","fftSize","analyser","createAnalyser","frequencyBinCount","getOutput","PropertyMixer","binding","mixFunction","_slerp","_select","_lerp","_mixBufferRegion","cumulativeWeight","useCount","referenceCount","Composite","targetGroup","optionalParsedPath","parsedPath","PropertyBinding","parseTrackName","_targetGroup","_bindings","subscribe_","rootNode","node","findNode","nodeName","AnimationObjectGroup","prototype","nCachedObjects_","_indicesByUUID","_paths","_parsedPaths","_bindingsIndicesByPath","stats","total","inUse","bindingsPerObject","AnimationAction","mixer","clip","localRoot","_mixer","_clip","_localRoot","nTracks","interpolants","interpolantSettings","endingStart","ZeroCurvatureEnding","endingEnd","interpolant","createInterpolant","settings","_interpolantSettings","_interpolants","_propertyBindings","_cacheIndex","_byClipCacheIndex","_timeScaleInterpolant","_weightInterpolant","LoopRepeat","_loopCount","_startTime","timeScale","_effectiveTimeScale","weight","_effectiveWeight","repetitions","paused","clampWhenFinished","zeroSlopeAtStart","zeroSlopeAtEnd","AnimationMixer","root","_root","_initMemoryManager","_accuIndex","Uniform","InstancedBufferGeometry","InstancedInterleavedBuffer","InstancedBufferAttribute","Raycaster","ray","params","threshold","PointCloud","ascSort","intersectObject","raycaster","recursive","raycast","Clock","autoStart","oldTime","elapsedTime","running","Spherical","Cylindrical","Box2","Line3","ImmediateRenderObject","VertexNormalsHelper","hex","nNormals","objGeometry","positions","SpotLightHelper","cone","getBoneList","boneList","isBone","SkeletonHelper","color1","color2","bone","VertexColors","PointLightHelper","sphereSize","RectAreaLightHelper","line","HemisphereLightHelper","rotateY","getAttribute","GridHelper","divisions","step","halfSize","PolarGridHelper","radials","circles","FaceNormalsHelper","DirectionalLightHelper","lightPlane","targetLine","CameraHelper","addLine","addPoint","pointMap","FaceColors","colorFrustum","colorCone","colorUp","colorTarget","colorCross","BoxHelper","Box3Helper","box","computeBoundingSphere","PlaneHelper","positions2","ArrowHelper","dir","headLength","headWidth","lineGeometry","coneGeometry","translate","setDirection","setLength","AxesHelper","Face4","MeshFaceMaterial","materials","MultiMaterial","isMultiMaterial","Particle","ParticleSystem","PointCloudMaterial","ParticleBasicMaterial","ParticleSystemMaterial","Vertex","DynamicBufferAttribute","setDynamic","Int8Attribute","Uint8Attribute","Uint8ClampedAttribute","Int16Attribute","Uint16Attribute","Int32Attribute","Uint32Attribute","Float32Attribute","Float64Attribute","ClosedSplineCurve3","SplineCurve3","Spline","AxisHelper","BoundingBoxHelper","EdgesHelper","WireframeHelper","XHRLoader","BinaryTextureLoader","Projector","projectVector","project","unprojectVector","unproject","pickingRay","CanvasRenderer","LensFlare","isInteger","isFinite","Function","assign","output","source","nextKey","hasOwnProperty","_listeners","listeners","hasEventListener","listenerArray","splice","MOUSE","LEFT","MIDDLE","RIGHT","CullFaceFrontBack","FrontFaceDirectionCW","FrontFaceDirectionCCW","BasicShadowMap","FlatShading","SmoothShading","UVMapping","RGBEFormat","LoopOnce","LoopPingPong","InterpolateDiscrete","InterpolateLinear","InterpolateSmooth","ZeroSlopeEnding","WrapAroundEnding","LogLuvEncoding","RAD2DEG","lut","d0","d1","d2","d3","toUpperCase","euclideanModulo","mapLinear","a1","b1","smoothstep","smootherstep","randInt","low","high","randFloat","randFloatSpread","range","degToRad","degrees","radToDeg","radians","ceil","isVector2","setScalar","scalar","setX","setY","setComponent","getComponent","addScalar","addScaledVector","subScalar","divide","applyMatrix3","clampScalar","minVal","maxVal","clampLength","round","roundToZero","cross","lengthSq","manhattanLength","distanceTo","distanceToSquared","dx","dy","manhattanDistanceTo","lerpVectors","getY","rotateAround","isMatrix4","n11","n12","n13","n14","n21","n22","n23","n24","n31","n32","n33","n34","n41","n42","n43","n44","te","me","extractBasis","xAxis","yAxis","zAxis","setFromMatrixColumn","makeBasis","scaleX","scaleY","scaleZ","makeRotationFromEuler","euler","isEuler","ae","af","be","bf","ce","cf","de","df","ac","ad","bc","bd","makeRotationFromQuaternion","zero","one","eye","a11","a12","a13","a14","a21","a22","a23","a24","a31","a32","a33","a34","a41","a42","a43","a44","b11","b12","b13","b14","b21","b22","b23","b24","b31","b32","b33","b34","b41","b42","b43","b44","applyToBufferAttribute","getZ","setXYZ","transpose","tmp","setPosition","throwOnDegenerate","t11","t12","t13","t14","det","msg","detInv","getMaxScaleOnAxis","scaleXSq","scaleYSq","scaleZSq","makeRotationX","makeRotationY","makeRotationZ","makeRotationAxis","axis","tx","ty","makeScale","makeShear","y2","z2","xx","xy","xz","yy","yz","zz","wx","wy","wz","sx","sy","sz","invSX","invSY","invSZ","makePerspective","makeOrthographic","slerp","qa","qb","qm","slerpFlat","dst","src0","srcOffset0","src1","srcOffset1","y0","z0","w0","y1","z1","w1","sqrSin","tDir","onChangeCallback","s1","s2","s3","setFromAxisAngle","halfAngle","m11","m12","m13","m21","m22","m23","m31","m32","m33","trace","setFromUnitVectors","vFrom","vTo","angleTo","acos","rotateTowards","inverse","conjugate","multiplyQuaternions","qax","qay","qaz","qaw","qbx","qby","qbz","qbw","cosHalfTheta","sqrSinHalfTheta","sinHalfTheta","halfTheta","ratioA","ratioB","setZ","multiplyVectors","applyEuler","applyAxisAngle","qy","qz","qw","iz","iw","az","bz","projectOnVector","projectOnPlane","planeNormal","reflect","dz","setFromSpherical","setFromSphericalCoords","sinPhiRadius","setFromCylindrical","setFromCylindricalCoords","setFromMatrixScale","isMatrix3","setFromMatrix4","transposeIntoArray","setUvTransform","rotate","ImageUtils","getDataURL","ImageData","putImageData","toDataURL","create","meta","isRootObject","metadata","generator","wrap","transformUv","isVector4","setW","setAxisAngleFromQuaternion","setAxisAngleFromRotationMatrix","epsilon","epsilon2","getW","isBox3","setFromArray","maxX","maxY","setFromBufferAttribute","makeEmpty","expandByPoint","setFromCenterAndSize","expandByObject","isEmpty","getCenter","expandByVector","expandByScalar","containsPoint","containsBox","intersectsBox","intersectsSphere","closestPoint","sphere","clampPoint","intersectsPlane","intersectsTriangle","satForAxes","axes","testAxis","extents","f0","f1","f2","triangleNormal","triangle","distanceToPoint","clampedPoint","getBoundingSphere","intersect","union","optionalCenter","maxRadiusSq","empty","radiusSum","deltaLengthSq","getBoundingBox","setComponents","setFromNormalAndCoplanarPoint","setFromCoplanarPoints","inverseNormalLength","distanceToSphere","projectPoint","intersectLine","delta","denominator","intersectsLine","startSign","endSign","coplanarPoint","m1","optionalNormalMatrix","referencePoint","frustum","me0","me1","me2","me3","me4","me5","me6","me7","me8","me9","me10","me11","me12","me13","me14","me15","sprite","negRadius","alphamap_fragment","alphamap_pars_fragment","alphatest_fragment","aomap_fragment","aomap_pars_fragment","begin_vertex","beginnormal_vertex","bsdfs","bumpmap_pars_fragment","clipping_planes_fragment","clipping_planes_pars_fragment","clipping_planes_pars_vertex","clipping_planes_vertex","color_fragment","color_pars_fragment","color_pars_vertex","color_vertex","common","cube_uv_reflection_fragment","defaultnormal_vertex","displacementmap_pars_vertex","displacementmap_vertex","emissivemap_fragment","emissivemap_pars_fragment","encodings_fragment","encodings_pars_fragment","envmap_fragment","envmap_pars_fragment","envmap_pars_vertex","envmap_vertex","fog_vertex","fog_pars_vertex","fog_fragment","fog_pars_fragment","gradientmap_pars_fragment","lightmap_fragment","lightmap_pars_fragment","lights_lambert_vertex","lights_pars_begin","envmap_physical_pars_fragment","lights_phong_fragment","lights_phong_pars_fragment","lights_physical_fragment","lights_physical_pars_fragment","lights_fragment_begin","lights_fragment_maps","lights_fragment_end","logdepthbuf_fragment","logdepthbuf_pars_fragment","logdepthbuf_pars_vertex","logdepthbuf_vertex","map_fragment","map_pars_fragment","map_particle_fragment","map_particle_pars_fragment","metalnessmap_fragment","metalnessmap_pars_fragment","morphnormal_vertex","morphtarget_pars_vertex","morphtarget_vertex","normal_fragment_begin","normal_fragment_maps","normalmap_pars_fragment","packing","premultiplied_alpha_fragment","project_vertex","dithering_fragment","dithering_pars_fragment","roughnessmap_fragment","roughnessmap_pars_fragment","shadowmap_pars_fragment","shadowmap_pars_vertex","shadowmap_vertex","shadowmask_pars_fragment","skinbase_vertex","skinning_pars_vertex","skinning_vertex","skinnormal_vertex","specularmap_fragment","specularmap_pars_fragment","tonemapping_fragment","tonemapping_pars_fragment","uv_pars_fragment","uv_pars_vertex","uv_vertex","uv2_pars_fragment","uv2_pars_vertex","uv2_vertex","worldpos_vertex","cube_frag","cube_vert","depth_frag","depth_vert","distanceRGBA_frag","distanceRGBA_vert","equirect_frag","equirect_vert","linedashed_frag","linedashed_vert","meshbasic_frag","meshbasic_vert","meshlambert_frag","meshlambert_vert","meshphong_frag","meshphong_vert","meshphysical_frag","meshphysical_vert","normal_frag","normal_vert","points_frag","points_vert","shadow_frag","shadow_vert","sprite_frag","sprite_vert","merge","merged","uniforms_src","uniforms_dst","parameter_src","ColorKeywords","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","setHex","setStyle","setHSL","hue2rgb","handleAlpha","charAt","copyGammaToLinear","copyLinearToGamma","safeInverse","convertGammaToLinear","convertLinearToGamma","copySRGBToLinear","SRGBToLinear","copyLinearToSRGB","LinearToSRGB","convertSRGBToLinear","convertLinearToSRGB","getHex","getHexString","getHSL","hue","saturation","lightness","getStyle","offsetHSL","hsl","addColors","lerpHSL","hslA","hslB","specularmap","envmap","aomap","lightmap","emissivemap","bumpmap","normalmap","displacementmap","roughnessmap","metalnessmap","gradientmap","basic","lambert","phong","standard","dashed","tFlip","equirect","tEquirect","distanceRGBA","physical","RotationOrders","asin","setFromVector3","reorder","newOrder","toVector3","optionalResult","channel","toggle","isObject3D","applyMatrix","setRotationFromAxisAngle","setRotationFromEuler","setRotationFromMatrix","setRotationFromQuaternion","rotateOnAxis","rotateOnWorldAxis","rotateX","rotateZ","translateOnAxis","translateX","translateY","translateZ","localToWorld","worldToLocal","getObjectById","getObjectByProperty","getObjectByName","child","getWorldPosition","getWorldQuaternion","getWorldScale","getWorldDirection","traverseVisible","traverseAncestors","force","serialize","library","element","extractFromCache","JSON","stringify","uuids","isOrthographicCamera","setViewOffset","fullWidth","fullHeight","clearViewOffset","zoomW","zoomH","scaleW","scaleH","computeBoundingBox","obj","addFace","tempNormals","tempUVs","tempUVs2","cb","ab","fl","vA","vB","vC","areaWeighted","vl","computeFlatVertexNormals","computeMorphNormals","__originalFaceNormal","__originalVertexNormals","tmpGeo","faceNormals","faceNormal","dstNormalsFace","dstNormalsVertex","materialIndexOffset","vertexOffset","vertices1","vertices2","faces1","faces2","uvs1","colors1","colors2","vertexCopy","faceCopy","faceVertexNormals","faceVertexColors","uvCopy","mergeMesh","mesh","verticesMap","unique","changes","precisionPoints","faceIndicesToRemove","idx","diff","sortFacesByMaterialIndex","materialIndexSort","_id","newUvs1","newUvs2","setBit","getNormalIndex","normalsHash","getColorIndex","colorsHash","getUvIndex","uvsHash","hasMaterial","hasFaceUv","hasFaceVertexUv","hasFaceNormal","hasFaceVertexNormal","hasFaceColor","hasFaceVertexColor","faceType","uvsCopy","morphTarget","morphNormal","srcVertexNormal","destVertexNormal","isBufferAttribute","setArray","copyAt","copyColorsArray","copyVector2sArray","vectors","copyVector3sArray","copyVector4sArray","setXY","setXYZW","onUpload","computeGroups","fromGeometry","morphTargetsPosition","hasFaceVertexUv2","morphTargetsLength","morphTargetsNormal","morphNormalsLength","hasSkinIndices","hasSkinWeights","vertexUvs","getIndex","clearGroups","setDrawRange","direct","__directGeometry","lineDistance","fromDirectGeometry","isNaN","pA","pB","pC","attribute1","attributeArray1","attribute2","attributeArray2","attributeSize","toNonIndexed","array2","morphAttribute","isMaterial","newValue","currentValue","isRoot","srcPlanes","dstPlanes","at","recast","closestPointToPoint","directionDistance","distanceSqToPoint","distanceSqToSegment","segCenter","segDir","optionalPointOnRay","optionalPointOnSegment","s0","sqrDist","extDet","segExtent","a01","b0","invDet","intersectSphere","tca","radius2","thc","distanceToPlane","intersectPlane","distToPoint","intersectBox","tmin","tmax","tymin","tymax","tzmin","tzmax","invdirx","invdiry","invdirz","intersectTriangle","backfaceCulling","DdN","DdQxE2","DdE1xQ","QdN","getNormal","targetLengthSq","getBarycoord","dot00","dot01","dot02","dot11","dot12","denom","invDenom","setFromPointsAndIndices","i0","i1","i2","getArea","getMidpoint","getPlane","vab","vac","vbc","vap","vbp","vcp","d4","vc","d5","d6","vb","va","setDrawMode","morphTargetDictionary","ml","uvIntersection","uv1","uv3","barycoord","checkIntersection","intersectionPointWorld","checkBufferGeometryIntersection","intersection","intersectionPoint","inverseMatrix","tempA","tempB","tempC","faceIndex","fvA","fvB","fvC","faceMaterial","tl","targets","uvs_f","isGroup","isPerspectiveCamera","setFocalLength","focalLength","vExtentSlope","getFilmHeight","atan","getFocalLength","getEffectiveFOV","getFilmWidth","skew","isInterleavedBuffer","transformVertex","vertexPosition","mvPosition","alignedPosition","rotatedPosition","viewWorldMatrix","intersectPoint","worldScale","addLevel","getObjectForDistance","matrixPosition","offsetMatrix","identityMatrix","getBoneByName","gbone","pos","rotq","scl","sw","skinWeight","computeLineDistances","positionAttribute","linePrecision","precisionSq","vStart","vEnd","interSegment","interRay","distSq","nbVertices","testPoint","rayPointDistanceSq","localThresholdSq","distanceToRay","localThreshold","readyState","HAVE_CURRENT_DATA","isCanvasTexture","Earcut","triangulate","hasHoles","outerLen","pts","holeIndex","forEach","indexA","indexB","indexC","a_x","a_y","b_x","b_y","c_x","c_y","indexD","a_z","b_z","c_z","d_x","d_y","d_z","Geometries","freeze","Materials","Cache","files","file","loading","load","cached","setTimeout","dataUriRegex","dataUriRegexResult","mimeType","isBase64","decodeURIComponent","atob","response","responseType","charCodeAt","Blob","parser","DOMParser","parseFromString","request","XMLHttpRequest","open","callbacks","status","overrideMimeType","header","requestHeader","setRequestHeader","send","setPath","setResponseType","setWithCredentials","setMimeType","loadTexture","loader","texDatas","loaded","mipmapCount","isCubemap","texData","crossOrigin","onImageLoad","onImageError","substr","src","setCrossOrigin","urls","isJPEG","search","getPoint","optionalTarget","getUtoTmapping","getPoints","getLength","lengths","getLengths","cacheArcLengths","current","updateArcLengths","targetArcLength","arcLengths","comparison","lengthBefore","lengthAfter","segmentLength","segmentFraction","getTangent","pt1","pt2","getTangentAt","mat","MAX_VALUE","tz","fromJSON","isEllipseCurve","twoPi","deltaAngle","samePoints","isArcCurve","pz","isCatmullRomCurve3","intPoint","isCubicBezierCurve","isCubicBezierCurve3","isLineCurve","tangent","isLineCurve3","isQuadraticBezierCurve","isQuadraticBezierCurve3","isSplineCurve","Curves","curve","closePath","startPoint","endPoint","curveLengths","getCurveLengths","lens","cacheLengths","sums","aCPx","aCPy","aCP1x","aCP1y","aCP2x","aCP2y","splineThru","npts","absarc","absellipse","ellipse","firstPoint","lastPoint","getPointsHoles","holesPts","arraySlice","to","isTypedArray","forceClone","ArrayBuffer","isView","DataView","getKeyframeOrder","compareTime","sortedArray","nValues","srcOffset","jsonKeys","valuePropertyName","evaluate","pp","validate_interval","seek","linear_scan","forward_scan","giveUpAt","afterEnd_","t1global","beforeStart_","mid","intervalChanged_","interpolate_","DefaultSettings_","getSettings_","copySampleValue_","iPrev","iNext","tPrev","tNext","halfDt","o1","o0","oP","oN","wP","wN","ppp","sP","sN","offset1","offset0","weight1","weight0","track","getInterpolation","ValueTypeName","InterpolantFactoryMethodDiscrete","getValueSize","InterpolantFactoryMethodLinear","InterpolantFactoryMethodSmooth","factoryMethod","shift","timeOffset","endTime","nKeys","validate","valid","prevTime","currTime","optimize","smoothInterpolation","writeIndex","keep","timeNext","offsetP","offsetN","readOffset","writeOffset","jsonTracks","frameTime","fps","clipTracks","CreateFromMorphTargetSequence","morphTargetSequence","noLoop","numMorphTargets","findByName","objectOrClipArray","clipArray","animations","CreateClipsFromMorphTargetSequences","animationToMorphTargets","parts","animationMorphTargets","clips","parseAnimation","addNonemptyTrack","trackName","animationKeys","propertyName","destTracks","clipName","hierarchyTracks","hierarchy","morphTargetNames","morphTargetName","animationKey","boneName","setTextures","getTexture","shading","typedArray","TYPED_ARRAYS","drawcalls","offsets","Handlers","handlers","regex","onLoadStart","onLoadProgress","onLoadComplete","initMaterials","createMaterial","BlendingMode","textureLoader","materialLoader","fullPath","mapDiffuseRepeat","mapDiffuseOffset","mapDiffuseWrap","mapDiffuseAnisotropy","mapEmissiveRepeat","mapEmissiveOffset","mapEmissiveWrap","mapEmissiveAnisotropy","mapLightRepeat","mapLightOffset","mapLightWrap","mapLightAnisotropy","mapAORepeat","mapAOOffset","mapAOWrap","mapAOAnisotropy","mapBumpRepeat","mapBumpOffset","mapBumpWrap","mapBumpAnisotropy","mapNormalRepeat","mapNormalOffset","mapNormalWrap","mapNormalAnisotropy","mapSpecularRepeat","mapSpecularOffset","mapSpecularWrap","mapSpecularAnisotropy","mapMetalnessRepeat","mapMetalnessOffset","mapMetalnessWrap","mapMetalnessAnisotropy","mapRoughnessRepeat","mapRoughnessOffset","mapRoughnessWrap","mapRoughnessAnisotropy","mapAlphaRepeat","mapAlphaOffset","mapAlphaWrap","mapAlphaAnisotropy","LoaderUtils","decodeText","TextDecoder","decode","fromCharCode","escape","extractUrlBase","lastIndexOf","setTexturePath","parseModel","isBitSet","fi","zLength","colorIndex","normalIndex","uvIndex","isQuad","faceA","faceB","uvLayer","nUvLayers","parseSkin","influencesPerVertex","parseMorphing","dstVertices","srcVertices","morphColors","parseAnimations","outputAnimations","morphAnimationClips","substring","parseShape","parseGeometries","parseImages","parseTextures","parseMaterials","parseObject","geometryLoader","bufferGeometryLoader","details","geometryShapes","loadImage","currentUrl","parseConstant","TEXTURE_MAPPING","TEXTURE_WRAPPING","TEXTURE_FILTER","getGeometry","getMaterial","setOptions","res","blob","imageBitmap","toShapes","isCCW","noHoles","toShapesNoHoles","inSubpaths","tmpPath","tmpShape","isPointInsidePolygon","inPolygon","polyLen","edgeLowPt","edgeHighPt","edgeDx","edgeDy","perpEdge","solid","holesFirst","tmpPoints","betterShapeHoles","newShapes","newShapeHoles","mainIdx","ambiguous","toChange","sIdx","sLen","sho","hIdx","ho","hole_unassigned","s2Idx","froms","tos","tmpHoles","webkitAudioContext","bufferCopy","decodeAudioData","audioBuffer","instance","eyeRight","eyeLeft","xmin","xmax","eyeSepOnProjection","ymax","removeFilter","disconnect","getFilter","setFilter","getMasterVolume","setMasterVolume","setTargetAtTime","currentTime","positionX","setValueAtTime","positionY","positionZ","forwardX","forwardY","forwardZ","upX","upY","upZ","setOrientation","setNodeSource","audioNode","setMediaElementSource","mediaElement","createMediaElementSource","setBuffer","play","createBufferSource","onended","onEnded","pause","getFilters","setFilters","setPlaybackRate","getPlaybackRate","getLoop","setLoop","getVolume","setVolume","getRefDistance","refDistance","setRefDistance","getRolloffFactor","rolloffFactor","setRolloffFactor","getDistanceModel","distanceModel","setDistanceModel","getMaxDistance","maxDistance","setMaxDistance","setDirectionalCone","coneInnerAngle","coneOuterAngle","coneOuterGain","getFrequencyData","getByteFrequencyData","getAverageFrequency","accumulate","accuIndex","currentWeight","mix","originalValueOffset","saveOriginalState","getValue","restoreOriginalState","RESERVED_CHARS_RE","firstValidIndex","bindings","unbind","isAnimationObjectGroup","sanitizeNodeName","reservedRe","RegExp","wordChar","wordCharOrDot","directoryRe","nodeRe","objectRe","propertyRe","trackRe","supportedObjectNames","matches","results","objectName","objectIndex","propertyIndex","lastDot","searchNodeSubtree","childNode","subTreeNode","_getValue_unavailable","_setValue_unavailable","BindingType","Direct","EntireArray","ArrayElement","HasFromToArray","Versioning","None","NeedsUpdate","MatrixWorldNeedsUpdate","GetterByBindingType","resolvedProperty","SetterByBindingTypeAndVersioning","targetObject","dest","targetArray","sourceArray","nodeProperty","versioning","bindingType","_getValue_unbound","_setValue_unbound","nObjects","nCachedObjects","indicesByUUID","parsedPaths","nBindings","knownObject","firstActiveIndex","lastCachedObject","bindingsForPath","lastCached","lastCachedIndex","firstActiveObject","firstActive","uncache","lastObject","indicesByPath","unsubscribe_","lastBindingsIndex","lastBindings","lastBindingsPath","_activateAction","_deactivateAction","stopFading","stopWarping","isRunning","_isActiveAction","isScheduled","startAt","setEffectiveWeight","getEffectiveWeight","fadeIn","_scheduleFading","fadeOut","crossFadeFrom","fadeOutAction","warp","fadeInDuration","fadeOutDuration","startEndRatio","endStartRatio","crossFadeTo","fadeInAction","weightInterpolant","_takeBackControlInterpolant","setEffectiveTimeScale","getEffectiveTimeScale","setDuration","syncWith","halt","startTimeScale","endTimeScale","now","_lendControlInterpolant","timeScaleInterpolant","getMixer","getClip","getRoot","_update","deltaTime","timeDirection","_updateWeight","timeRunning","_updateTimeScale","clipTime","_updateTime","propertyMixers","interpolantValue","loopCount","pingPong","_setEndings","handle_stop","loopDelta","pending","atStart","atEnd","weightNow","weightThen","_bindAction","prototypeAction","rootUuid","bindingsByRoot","_bindingsByRootAndName","bindingsByName","_addInactiveBinding","clipUuid","actionsForClip","_actionsByClip","knownActions","_addInactiveAction","_lendBinding","_lendAction","_takeBackBinding","_takeBackAction","_actions","_nActiveActions","_nActiveBindings","_controlInterpolants","_nActiveControlInterpolants","actions","controlInterpolants","actionsByClip","actionByRoot","_removeInactiveAction","lastInactiveAction","cacheIndex","knownActionsForClip","lastKnownAction","byClipCacheIndex","_removeInactiveBindingsForAction","_removeInactiveBinding","prevIndex","lastActiveIndex","firstInactiveAction","firstInactiveIndex","lastActiveAction","bindingByName","propBinding","lastInactiveBinding","remove_empty_map","_","firstInactiveBinding","lastActiveBinding","_controlInterpolantsResultBuffer","__cacheIndex","lastActiveInterpolant","clipAction","optionalRoot","clipObject","existingAction","newAction","stopAllAction","nActions","uncacheClip","actionsToRemove","uncacheRoot","uncacheAction","setFromCamera","coords","intersectObjects","performance","Date","getElapsedTime","getDelta","newTime","other","makeSafe","setFromCartesianCoords","distanceSq","closestPointToPointParameter","startP","startEnd","clampToLine","startEnd2","startEnd_startP","objPos","objNorm","coneLength","coneWidth","boneMatrix","matrixWorldInv","setPoint","setColor","LineStrip","LinePieces","construct","createPointsGeometry","createGeometry","createSpacedPointsGeometry","fromPoints","initFromArray","getControlPointsArray","reparametrizeByArcLength","setColors","isIntersectionBox","isIntersectionSphere","random16","nearestPowerOfTwo","nextPowerOfTwo","flattenToArrayOffset","multiplyVector3","multiplyVector3Array","applyToBuffer","applyToVector3Array","extractPosition","getPosition","multiplyToArray","multiplyVector4","rotateAxis","crossVector","rotateByAxis","makeFrustum","isIntersectionLine","isIntersectionPlane","barycoordFromPoint","midpoint","extractAllPoints","extrude","makeGeometry","fromAttribute","distanceToManhattan","lengthManhattan","setEulerFromRotationMatrix","setEulerFromQuaternion","getPositionFromMatrix","getScaleFromMatrix","getColumnFromMatrix","applyProjection","computeTangents","getChildByName","renderDepth","getWorldRotation","eulerOrder","useQuaternion","setLens","onlyShadow","shadowCameraFov","shadowCameraLeft","shadowCameraRight","shadowCameraTop","shadowCameraBottom","shadowCameraVisible","shadowDarkness","shadowMapWidth","shadowMapHeight","copyIndicesArray","addIndex","addDrawCall","clearDrawCalls","computeOffsets","getArrays","addShapeList","wrapAround","wrapRGB","metal","animate","getCurrentRenderTarget","getPrecision","resetGLState","supportsFloatTextures","supportsHalfFloatTextures","supportsStandardDerivatives","supportsCompressedTextureS3TC","supportsCompressedTexturePVRTC","supportsBlendMinMax","supportsInstancedArrays","enableScissorTest","addPrePlugin","addPostPlugin","updateShadowMap","setFaceCulling","shadowMapCullFace","renderReverseSided","renderSingleSided","standing","audioLoader","getData","updateCubeMap","GeometryUtils","geometry1","loadTextureCube","loadCompressedTexture","loadCompressedTextureCube","SceneUtils","createMultiMaterialObject","detach","attach","exports","CubeGeometry"],"mappings":";;;;;;;AAAAA,UAAU,WACT,YAuGA,SAASC,MA4XT,QAASC,GAASC,EAAGC,GAEpBC,KAAKF,EAAIA,GAAK,EACdE,KAAKD,EAAIA,GAAK,EAoff,QAASE,KAERD,KAAKE,UAEJ,EAAG,EAAG,EAAG,EACT,EAAG,EAAG,EAAG,EACT,EAAG,EAAG,EAAG,EACT,EAAG,EAAG,EAAG,GAILC,UAAUC,OAAS,GAEvBC,QAAQC,MAAO,iFAm5BjB,QAASC,GAAYT,EAAGC,EAAGS,EAAGC,GAE7BT,KAAKU,GAAKZ,GAAK,EACfE,KAAKW,GAAKZ,GAAK,EACfC,KAAKY,GAAKJ,GAAK,EACfR,KAAKa,GAAaC,SAANL,EAAoBA,EAAI,EAmnBrC,QAASM,GAASjB,EAAGC,EAAGS,GAEvBR,KAAKF,EAAIA,GAAK,EACdE,KAAKD,EAAIA,GAAK,EACdC,KAAKQ,EAAIA,GAAK,EAktBf,QAASQ,KAERhB,KAAKE,UAEJ,EAAG,EAAG,EACN,EAAG,EAAG,EACN,EAAG,EAAG,GAIFC,UAAUC,OAAS,GAEvBC,QAAQC,MAAO,iFAuajB,QAASW,GAASC,EAAOC,EAASC,EAAOC,EAAOC,EAAWC,EAAWC,EAAQC,EAAMC,EAAYC,GAE/FC,OAAOC,eAAgB7B,KAAM,MAAQ8B,MAAOC,OAE5C/B,KAAKgC,KAAOC,GAAMC,eAElBlC,KAAKmC,KAAO,GAEZnC,KAAKkB,MAAkBJ,SAAVI,EAAsBA,EAAQD,EAAQmB,cACnDpC,KAAKqC,WAELrC,KAAKmB,QAAsBL,SAAZK,EAAwBA,EAAUF,EAAQqB,gBAEzDtC,KAAKoB,MAAkBN,SAAVM,EAAsBA,EAAQmB,GAC3CvC,KAAKqB,MAAkBP,SAAVO,EAAsBA,EAAQkB,GAE3CvC,KAAKsB,UAA0BR,SAAdQ,EAA0BA,EAAYkB,GACvDxC,KAAKuB,UAA0BT,SAAdS,EAA0BA,EAAYkB,GAEvDzC,KAAK0B,WAA4BZ,SAAfY,EAA2BA,EAAa,EAE1D1B,KAAKwB,OAAoBV,SAAXU,EAAuBA,EAASkB,GAC9C1C,KAAKyB,KAAgBX,SAATW,EAAqBA,EAAOkB,GAExC3C,KAAK4C,OAAS,GAAI/C,GAAS,EAAG,GAC9BG,KAAK6C,OAAS,GAAIhD,GAAS,EAAG,GAC9BG,KAAK8C,OAAS,GAAIjD,GAAS,EAAG,GAC9BG,KAAK+C,SAAW,EAEhB/C,KAAKgD,kBAAmB,EACxBhD,KAAKiD,OAAS,GAAIjC,GAElBhB,KAAKkD,iBAAkB,EACvBlD,KAAKmD,kBAAmB,EACxBnD,KAAKoD,OAAQ,EACbpD,KAAKqD,gBAAkB,EAMvBrD,KAAK2B,SAAwBb,SAAba,EAAyBA,EAAW2B,GAEpDtD,KAAKuD,QAAU,EACfvD,KAAKwD,SAAW,KAqQjB,QAASC,GAAS3D,EAAGC,EAAGS,EAAGC,GAE1BT,KAAKF,EAAIA,GAAK,EACdE,KAAKD,EAAIA,GAAK,EACdC,KAAKQ,EAAIA,GAAK,EACdR,KAAKS,EAAYK,SAANL,EAAoBA,EAAI,EAinBpC,QAASiD,GAAmBC,EAAOC,EAAQC,GAE1C7D,KAAK2D,MAAQA,EACb3D,KAAK4D,OAASA,EAEd5D,KAAK8D,QAAU,GAAIL,GAAS,EAAG,EAAGE,EAAOC,GACzC5D,KAAK+D,aAAc,EAEnB/D,KAAKgE,SAAW,GAAIP,GAAS,EAAG,EAAGE,EAAOC,GAE1CC,EAAUA,MAEiB/C,SAAtB+C,EAAQtC,YAA0BsC,EAAQtC,UAAYiB,IAE3DxC,KAAKiE,QAAU,GAAIhD,IAASH,SAAWA,QAAW+C,EAAQzC,MAAOyC,EAAQxC,MAAOwC,EAAQvC,UAAWuC,EAAQtC,UAAWsC,EAAQrC,OAAQqC,EAAQpC,KAAMoC,EAAQnC,WAAYmC,EAAQlC,UAEhL3B,KAAKiE,QAAQf,gBAA8CpC,SAA5B+C,EAAQX,iBAAgCW,EAAQX,gBAE/ElD,KAAKkE,YAAsCpD,SAAxB+C,EAAQK,aAA4BL,EAAQK,YAC/DlE,KAAKmE,cAA0CrD,SAA1B+C,EAAQM,eAA8BN,EAAQM,cACnEnE,KAAKoE,aAAwCtD,SAAzB+C,EAAQO,aAA6BP,EAAQO,aAAe,KA6DjF,QAASC,GAAuBV,EAAOC,EAAQC,GAE9CH,EAAkBY,KAAMtE,KAAM2D,EAAOC,EAAQC,GAE7C7D,KAAKuE,eAAiB,EACtBvE,KAAKwE,kBAAoB,EAa1B,QAASC,GAAaC,EAAMf,EAAOC,EAAQpC,EAAQC,EAAMN,EAASC,EAAOC,EAAOC,EAAWC,EAAWG,EAAYC,GAEjHV,EAAQqD,KAAMtE,KAAM,KAAMmB,EAASC,EAAOC,EAAOC,EAAWC,EAAWC,EAAQC,EAAMC,EAAYC,GAEjG3B,KAAKkB,OAAUwD,KAAMA,EAAMf,MAAOA,EAAOC,OAAQA,GAEjD5D,KAAKsB,UAA0BR,SAAdQ,EAA0BA,EAAYqD,GACvD3E,KAAKuB,UAA0BT,SAAdS,EAA0BA,EAAYoD,GAEvD3E,KAAKkD,iBAAkB,EACvBlD,KAAKoD,OAAQ,EACbpD,KAAKqD,gBAAkB,EAcxB,QAASuB,GAAMC,EAAKC,GAEnB9E,KAAK6E,IAAgB/D,SAAR+D,EAAsBA,EAAM,GAAI9D,MAAWgE,EAAAA,OAAYA,EAAAA,OAAYA,EAAAA,KAChF/E,KAAK8E,IAAgBhE,SAARgE,EAAsBA,EAAM,GAAI/D,MAAWgE,EAAAA,OAAYA,EAAAA,OAAYA,EAAAA,KAgmBjF,QAASC,GAAQlC,EAAQmC,GAExBjF,KAAK8C,OAAsBhC,SAAXgC,EAAyBA,EAAS,GAAI/B,GACtDf,KAAKiF,OAAsBnE,SAAXmE,EAAyBA,EAAS,EA2KnD,QAASC,GAAOC,EAAQC,GAIvBpF,KAAKmF,OAAsBrE,SAAXqE,EAAyBA,EAAS,GAAIpE,GAAS,EAAG,EAAG,GACrEf,KAAKoF,SAA0BtE,SAAbsE,EAA2BA,EAAW,EA6OzD,QAASC,GAASC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,GAErC3F,KAAK4F,QAEK9E,SAAPwE,EAAqBA,EAAK,GAAIJ,GACvBpE,SAAPyE,EAAqBA,EAAK,GAAIL,GACvBpE,SAAP0E,EAAqBA,EAAK,GAAIN,GACvBpE,SAAP2E,EAAqBA,EAAK,GAAIP,GACvBpE,SAAP4E,EAAqBA,EAAK,GAAIR,GACvBpE,SAAP6E,EAAqBA,EAAK,GAAIT,IAwmBlC,QAASW,GAAOC,EAAGC,EAAGC,GAErB,MAAWlF,UAANiF,GAAyBjF,SAANkF,EAGhBhG,KAAKiG,IAAKH,GAIX9F,KAAKkG,OAAQJ,EAAGC,EAAGC,GAm/B3B,QAASG,KAMR,QAASC,GAAkBC,EAAMC,GAE3BC,KAAgB,IAErBC,EAAeH,EAAMC,GAErBG,EAAQC,sBAAuBN,IAVhC,GAAIK,GAAU,KACVF,GAAc,EACdC,EAAgB,IAYpB,QAECG,MAAO,WAEDJ,KAAgB,GACE,OAAlBC,IAELC,EAAQC,sBAAuBN,GAE/BG,GAAc,IAIfK,KAAM,WAELL,GAAc,GAIfM,iBAAkB,SAAWC,GAE5BN,EAAgBM,GAIjBC,WAAY,SAAWjF,GAEtB2E,EAAU3E,IAYb,QAASkF,GAAiBC,GAIzB,QAASC,GAAcC,EAAWC,GAEjC,GAAIC,GAAQF,EAAUE,MAClBC,EAAQH,EAAUI,QAAUN,EAAGO,aAAeP,EAAGQ,YAEjDC,EAAST,EAAGC,cAEhBD,GAAGU,WAAYP,EAAYM,GAC3BT,EAAGW,WAAYR,EAAYC,EAAOC,GAElCH,EAAUU,kBAEV,IAAIpG,GAAOwF,EAAGa,KAoCd,OAlCKT,aAAiBU,cAErBtG,EAAOwF,EAAGa,MAECT,YAAiBW,cAE5B3H,QAAQ4H,KAAM,wEAEHZ,YAAiBa,aAE5BzG,EAAOwF,EAAGkB,eAECd,YAAiBe,YAE5B3G,EAAOwF,EAAGoB,MAEChB,YAAiBiB,aAE5B7G,EAAOwF,EAAGsB,aAEClB,YAAiBmB,YAE5B/G,EAAOwF,EAAGwB,IAECpB,YAAiBqB,WAE5BjH,EAAOwF,EAAG0B,KAECtB,YAAiBuB,cAE5BnH,EAAOwF,EAAG4B,gBAKVnB,OAAQA,EACRjG,KAAMA,EACNqH,gBAAiBzB,EAAM0B,kBACvBxF,QAAS4D,EAAU5D,SAKrB,QAASyF,GAActB,EAAQP,EAAWC,GAEzC,GAAIC,GAAQF,EAAUE,MAClB4B,EAAc9B,EAAU8B,WAE5BhC,GAAGU,WAAYP,EAAYM,GAEtBP,EAAUI,WAAY,EAE1BN,EAAGW,WAAYR,EAAYC,EAAOJ,EAAGQ,aAE1BwB,EAAYC,WAIvBjC,EAAGkC,cAAe/B,EAAY,EAAGC,GAEA,IAAtB4B,EAAYC,MAEvB7I,QAAQC,MAAO,4KAIf2G,EAAGkC,cAAe/B,EAAY6B,EAAYrG,OAASyE,EAAM0B,kBACxD1B,EAAM+B,SAAUH,EAAYrG,OAAQqG,EAAYrG,OAASqG,EAAYC,QAEtED,EAAYC,UAQd,QAASG,GAAKlC,GAIb,MAFKA,GAAUmC,+BAA+BnC,EAAYA,EAAUzC,MAE7D6E,EAAQF,IAAKlC,GAIrB,QAASqC,GAAQrC,GAEXA,EAAUmC,+BAA+BnC,EAAYA,EAAUzC,KAEpE,IAAIA,GAAO6E,EAAQF,IAAKlC,EAEnBzC,KAEJuC,EAAGwC,aAAc/E,EAAKgD,QAEtB6B,EAAAA,UAAgBpC,IAMlB,QAASuC,GAAQvC,EAAWC,GAEtBD,EAAUmC,+BAA+BnC,EAAYA,EAAUzC,KAEpE,IAAIA,GAAO6E,EAAQF,IAAKlC,EAEVrG,UAAT4D,EAEJ6E,EAAQtD,IAAKkB,EAAWD,EAAcC,EAAWC,IAEtC1C,EAAKnB,QAAU4D,EAAU5D,UAEpCyF,EAActE,EAAKgD,OAAQP,EAAWC,GAEtC1C,EAAKnB,QAAU4D,EAAU5D,SAnI3B,GAAIgG,GAAU,GAAII,QAyIlB,QAECN,IAAKA,EACLG,OAAQA,EACRE,OAAQA,GAYV,QAASE,GAAO9J,EAAGC,EAAGS,EAAGqJ,GAExB7J,KAAKU,GAAKZ,GAAK,EACfE,KAAKW,GAAKZ,GAAK,EACfC,KAAKY,GAAKJ,GAAK,EACfR,KAAK8J,OAASD,GAASD,EAAMG,aAkV9B,QAASC,KAERhK,KAAKiK,KAAO,EAgDb,QAASC,KAmBR,QAASC,KAERC,EAAWC,aAActH,GAAU,GAIpC,QAASuH,KAERvH,EAASwH,kBAAmBH,EAAYtJ,QAAW,GAzBpDc,OAAOC,eAAgB7B,KAAM,MAAQ8B,MAAO0I,OAE5CxK,KAAKgC,KAAOC,GAAMC,eAElBlC,KAAKmC,KAAO,GACZnC,KAAKyB,KAAO,WAEZzB,KAAKyK,OAAS,KACdzK,KAAK0K,YAEL1K,KAAK2K,GAAKT,EAASU,UAAUC,OAE7B,IAAIC,GAAW,GAAI/J,GACfgC,EAAW,GAAI6G,GACfQ,EAAa,GAAI7J,GACjBwK,EAAQ,GAAIhK,GAAS,EAAG,EAAG,EAc/BgC,GAASiI,SAAUb,GACnBC,EAAWY,SAAUV,GAErB1I,OAAOqJ,iBAAkBjL,MACxB8K,UACCI,YAAY,EACZpJ,MAAOgJ,GAER/H,UACCmI,YAAY,EACZpJ,MAAOiB,GAERqH,YACCc,YAAY,EACZpJ,MAAOsI,GAERW,OACCG,YAAY,EACZpJ,MAAOiJ,GAERI,iBACCrJ,MAAO,GAAI7B,IAEZmL,cACCtJ,MAAO,GAAId,MAIbhB,KAAKiD,OAAS,GAAIhD,GAClBD,KAAKqL,YAAc,GAAIpL,GAEvBD,KAAKgD,iBAAmBkH,EAASoB,wBACjCtL,KAAKuL,wBAAyB,EAE9BvL,KAAKwL,OAAS,GAAIxB,GAClBhK,KAAKyL,SAAU,EAEfzL,KAAK0L,YAAa,EAClB1L,KAAK2L,eAAgB,EAErB3L,KAAK4L,eAAgB,EACrB5L,KAAK6L,YAAc,EAEnB7L,KAAK8L,YA0uBN,QAASC,KAER7B,EAAS5F,KAAMtE,MAEfA,KAAKyB,KAAO,SAEZzB,KAAKgM,mBAAqB,GAAI/L,GAE9BD,KAAKiM,iBAAmB,GAAIhM,GAC5BD,KAAKkM,wBAA0B,GAAIjM,GA6DpC,QAASkM,GAAoBC,EAAMC,EAAOC,EAAKC,EAAQC,EAAMC,GAE5DV,EAAOzH,KAAMtE,MAEbA,KAAKyB,KAAO,qBAEZzB,KAAK0M,KAAO,EACZ1M,KAAK2M,KAAO,KAEZ3M,KAAKoM,KAAOA,EACZpM,KAAKqM,MAAQA,EACbrM,KAAKsM,IAAMA,EACXtM,KAAKuM,OAASA,EAEdvM,KAAKwM,KAAkB1L,SAAT0L,EAAuBA,EAAO,GAC5CxM,KAAKyM,IAAgB3L,SAAR2L,EAAsBA,EAAM,IAEzCzM,KAAK4M,yBA6HN,QAASC,GAAOC,EAAG9G,EAAG+G,EAAG5H,EAAQ6H,EAAOC,GAEvCjN,KAAK8M,EAAIA,EACT9M,KAAKgG,EAAIA,EACThG,KAAK+M,EAAIA,EAET/M,KAAKmF,OAAWA,GAAUA,EAAO+H,UAAc/H,EAAS,GAAIpE,GAC5Df,KAAKmN,cAAgBC,MAAMC,QAASlI,GAAWA,KAE/CnF,KAAKgN,MAAUA,GAASA,EAAMM,QAAYN,EAAQ,GAAInH,GACtD7F,KAAKuN,aAAeH,MAAMC,QAASL,GAAUA,KAE7ChN,KAAKiN,cAAkCnM,SAAlBmM,EAA8BA,EAAgB,EAoDpE,QAASO,KAER5L,OAAOC,eAAgB7B,KAAM,MAAQ8B,MAAO2L,IAAc,IAE1DzN,KAAKgC,KAAOC,GAAMC,eAElBlC,KAAKmC,KAAO,GACZnC,KAAKyB,KAAO,WAEZzB,KAAK0N,YACL1N,KAAK2N,UACL3N,KAAK4N,SACL5N,KAAK6N,mBAEL7N,KAAK8N,gBACL9N,KAAK+N,gBAEL/N,KAAKgO,eACLhO,KAAKiO,eAELjO,KAAKkO,iBAELlO,KAAKmO,YAAc,KACnBnO,KAAKoO,eAAiB,KAItBpO,KAAKqO,oBAAqB,EAC1BrO,KAAKsO,oBAAqB,EAC1BtO,KAAKuO,eAAgB,EACrBvO,KAAKwO,mBAAoB,EACzBxO,KAAKyO,kBAAmB,EACxBzO,KAAK0O,yBAA0B,EAC/B1O,KAAK2O,kBAAmB,EA22CzB,QAASC,GAAiBvH,EAAOwH,EAAUC,GAE1C,GAAK1B,MAAMC,QAAShG,GAEnB,KAAM,IAAI0H,WAAW,wDAItB/O,MAAKmC,KAAO,GAEZnC,KAAKqH,MAAQA,EACbrH,KAAK6O,SAAWA,EAChB7O,KAAKkJ,MAAkBpI,SAAVuG,EAAsBA,EAAMjH,OAASyO,EAAW,EAC7D7O,KAAK8O,WAAaA,KAAe,EAEjC9O,KAAKuH,SAAU,EACfvH,KAAKiJ,aAAgBrG,OAAQ,EAAGsG,UAEhClJ,KAAKuD,QAAU,EA4ShB,QAASyL,GAAqB3H,EAAOwH,EAAUC,GAE9CF,EAAgBtK,KAAMtE,KAAM,GAAI0I,WAAWrB,GAASwH,EAAUC,GAQ/D,QAASG,GAAsB5H,EAAOwH,EAAUC,GAE/CF,EAAgBtK,KAAMtE,KAAM,GAAI4I,YAAYvB,GAASwH,EAAUC,GAQhE,QAASI,GAA6B7H,EAAOwH,EAAUC,GAEtDF,EAAgBtK,KAAMtE,KAAM,GAAImP,mBAAmB9H,GAASwH,EAAUC,GAQvE,QAASM,GAAsB/H,EAAOwH,EAAUC,GAE/CF,EAAgBtK,KAAMtE,KAAM,GAAIoI,YAAYf,GAASwH,EAAUC,GAQhE,QAASO,GAAuBhI,EAAOwH,EAAUC,GAEhDF,EAAgBtK,KAAMtE,KAAM,GAAIkI,aAAab,GAASwH,EAAUC,GAQjE,QAASQ,GAAsBjI,EAAOwH,EAAUC,GAE/CF,EAAgBtK,KAAMtE,KAAM,GAAIwI,YAAYnB,GAASwH,EAAUC,GAQhE,QAASS,GAAuBlI,EAAOwH,EAAUC,GAEhDF,EAAgBtK,KAAMtE,KAAM,GAAIsI,aAAajB,GAASwH,EAAUC,GAQjE,QAASU,GAAwBnI,EAAOwH,EAAUC,GAEjDF,EAAgBtK,KAAMtE,KAAM,GAAI+H,cAAcV,GAASwH,EAAUC,GAQlE,QAASW,GAAwBpI,EAAOwH,EAAUC,GAEjDF,EAAgBtK,KAAMtE,KAAM,GAAIgI,cAAcX,GAASwH,EAAUC,GAWlE,QAASY,KAER1P,KAAK0N,YACL1N,KAAK2P,WACL3P,KAAK2N,UACL3N,KAAK4P,OACL5P,KAAK6P,QAEL7P,KAAK8P,UAEL9P,KAAK8N,gBAEL9N,KAAKgO,eACLhO,KAAKiO,eAILjO,KAAKmO,YAAc,KACnBnO,KAAKoO,eAAiB,KAItBpO,KAAKsO,oBAAqB,EAC1BtO,KAAKwO,mBAAoB,EACzBxO,KAAKyO,kBAAmB,EACxBzO,KAAKuO,eAAgB,EACrBvO,KAAK2O,kBAAmB,EAoPzB,QAASoB,GAAU1I,GAElB,GAAsB,IAAjBA,EAAMjH,OAAe,QAAS2E,EAAAA,EAInC,KAAM,GAFFD,GAAMuC,EAAO,GAEP2I,EAAI,EAAGC,EAAI5I,EAAMjH,OAAQ4P,EAAIC,IAAMD,EAEvC3I,EAAO2I,GAAMlL,IAAMA,EAAMuC,EAAO2I,GAItC,OAAOlL,GAWR,QAASoL,KAERtO,OAAOC,eAAgB7B,KAAM,MAAQ8B,MAAOqO,IAAoB,IAEhEnQ,KAAKgC,KAAOC,GAAMC,eAElBlC,KAAKmC,KAAO,GACZnC,KAAKyB,KAAO,iBAEZzB,KAAKoQ,MAAQ,KACbpQ,KAAKqQ,cAELrQ,KAAKsQ,mBAELtQ,KAAK8P,UAEL9P,KAAKmO,YAAc,KACnBnO,KAAKoO,eAAiB,KAEtBpO,KAAKuQ,WAAc5J,MAAO,EAAGuC,MAAOnE,EAAAA,GAEpC/E,KAAK8L,YAskCN,QAAS0E,GAAa7M,EAAOC,EAAQ6M,EAAOC,EAAeC,EAAgBC,GAE1EpD,EAASlJ,KAAMtE,MAEfA,KAAKyB,KAAO,cAEZzB,KAAK6Q,YACJlN,MAAOA,EACPC,OAAQA,EACR6M,MAAOA,EACPC,cAAeA,EACfC,eAAgBA,EAChBC,cAAeA,GAGhB5Q,KAAK8Q,mBAAoB,GAAIC,GAAmBpN,EAAOC,EAAQ6M,EAAOC,EAAeC,EAAgBC,IACrG5Q,KAAKgR,gBASN,QAASD,GAAmBpN,EAAOC,EAAQ6M,EAAOC,EAAeC,EAAgBC,GAuDhF,QAASK,GAAYC,EAAGC,EAAG1Q,EAAG2Q,EAAMC,EAAM1N,EAAOC,EAAQ6M,EAAOa,EAAOC,EAAOtE,GAE7E,GAaIuE,GAAIC,EAbJC,EAAe/N,EAAQ2N,EACvBK,EAAgB/N,EAAS2N,EAEzBK,EAAYjO,EAAQ,EACpBkO,EAAajO,EAAS,EACtBkO,EAAYrB,EAAQ,EAEpBsB,EAAST,EAAQ,EACjBU,EAAST,EAAQ,EAEjBU,EAAgB,EAChBC,EAAa,EAIbC,EAAS,GAAIpR,EAIjB,KAAM0Q,EAAK,EAAGA,EAAKO,EAAQP,IAAQ,CAElC,GAAI1R,GAAI0R,EAAKE,EAAgBE,CAE7B,KAAML,EAAK,EAAGA,EAAKO,EAAQP,IAAQ,CAElC,GAAI1R,GAAI0R,EAAKE,EAAeE,CAI5BO,GAAQjB,GAAMpR,EAAIsR,EAClBe,EAAQhB,GAAMpR,EAAIsR,EAClBc,EAAQ1R,GAAMqR,EAIdpE,EAAS0E,KAAMD,EAAOrS,EAAGqS,EAAOpS,EAAGoS,EAAO3R,GAI1C2R,EAAQjB,GAAM,EACdiB,EAAQhB,GAAM,EACdgB,EAAQ1R,GAAMgQ,EAAQ,EAAI,KAI1Bd,EAAQyC,KAAMD,EAAOrS,EAAGqS,EAAOpS,EAAGoS,EAAO3R,GAIzCoP,EAAIwC,KAAMZ,EAAKF,GACf1B,EAAIwC,KAAM,EAAMX,EAAKF,GAIrBU,GAAiB,GAYnB,IAAMR,EAAK,EAAGA,EAAKF,EAAOE,IAEzB,IAAMD,EAAK,EAAGA,EAAKF,EAAOE,IAAQ,CAEjC,GAAI1E,GAAIuF,EAAmBb,EAAKO,EAASN,EACrCzL,EAAIqM,EAAmBb,EAAKO,GAAWN,EAAK,GAC5C1E,EAAIsF,GAAqBb,EAAK,GAAMO,GAAWN,EAAK,GACpDa,EAAID,GAAqBb,EAAK,GAAMO,EAASN,CAIjDc,GAAQH,KAAMtF,EAAG9G,EAAGsM,GACpBC,EAAQH,KAAMpM,EAAG+G,EAAGuF,GAIpBJ,GAAc,EAQhBM,EAAMC,SAAUC,EAAYR,EAAYjF,GAIxCyF,GAAcR,EAIdG,GAAoBJ,EAzJrB/B,EAAe5L,KAAMtE,MAErBA,KAAKyB,KAAO,oBAEZzB,KAAK6Q,YACJlN,MAAOA,EACPC,OAAQA,EACR6M,MAAOA,EACPC,cAAeA,EACfC,eAAgBA,EAChBC,cAAeA,EAGhB,IAAI4B,GAAQxS,IAEZ2D,GAAQA,GAAS,EACjBC,EAASA,GAAU,EACnB6M,EAAQA,GAAS,EAIjBC,EAAgBiC,KAAKC,MAAOlC,IAAmB,EAC/CC,EAAiBgC,KAAKC,MAAOjC,IAAoB,EACjDC,EAAgB+B,KAAKC,MAAOhC,IAAmB,CAI/C,IAAI2B,MACA7E,KACAiC,KACAC,KAIAyC,EAAmB,EACnBK,EAAa,CAIjBzB,GAAY,IAAK,IAAK,UAAeR,EAAO7M,EAAQD,EAAOiN,EAAeD,EAAgB,GAC1FM,EAAY,IAAK,IAAK,IAAK,KAAQR,EAAO7M,GAAUD,EAAOiN,EAAeD,EAAgB,GAC1FM,EAAY,IAAK,IAAK,IAAK,EAAG,EAAGtN,EAAO8M,EAAO7M,EAAQ8M,EAAeE,EAAe,GACrFK,EAAY,IAAK,IAAK,IAAK,KAAQtN,EAAO8M,GAAS7M,EAAQ8M,EAAeE,EAAe,GACzFK,EAAY,IAAK,IAAK,IAAK,KAAQtN,EAAOC,EAAQ6M,EAAOC,EAAeC,EAAgB,GACxFM,EAAY,IAAK,IAAK,UAAetN,EAAOC,GAAU6M,EAAOC,EAAeC,EAAgB,GAI5F3Q,KAAK6S,SAAUN,GACfvS,KAAK8S,aAAc,WAAY,GAAItD,GAAwB9B,EAAU,IACrE1N,KAAK8S,aAAc,SAAU,GAAItD,GAAwBG,EAAS,IAClE3P,KAAK8S,aAAc,KAAM,GAAItD,GAAwBI,EAAK,IAsH3D,QAASmD,GAAepP,EAAOC,EAAQ8M,EAAeC,GAErDnD,EAASlJ,KAAMtE,MAEfA,KAAKyB,KAAO,gBAEZzB,KAAK6Q,YACJlN,MAAOA,EACPC,OAAQA,EACR8M,cAAeA,EACfC,eAAgBA,GAGjB3Q,KAAK8Q,mBAAoB,GAAIkC,GAAqBrP,EAAOC,EAAQ8M,EAAeC,IAChF3Q,KAAKgR,gBASN,QAASgC,GAAqBrP,EAAOC,EAAQ8M,EAAeC,GAE3DT,EAAe5L,KAAMtE,MAErBA,KAAKyB,KAAO,sBAEZzB,KAAK6Q,YACJlN,MAAOA,EACPC,OAAQA,EACR8M,cAAeA,EACfC,eAAgBA,GAGjBhN,EAAQA,GAAS,EACjBC,EAASA,GAAU,CAEnB,IAYI4N,GAAIC,EAZJwB,EAAatP,EAAQ,EACrBuP,EAActP,EAAS,EAEvB0N,EAAQqB,KAAKC,MAAOlC,IAAmB,EACvCa,EAAQoB,KAAKC,MAAOjC,IAAoB,EAExCoB,EAAST,EAAQ,EACjBU,EAAST,EAAQ,EAEjB4B,EAAgBxP,EAAQ2N,EACxB8B,EAAiBxP,EAAS2N,EAM1BgB,KACA7E,KACAiC,KACAC,IAIJ,KAAM6B,EAAK,EAAGA,EAAKO,EAAQP,IAAQ,CAElC,GAAI1R,GAAI0R,EAAK2B,EAAiBF,CAE9B,KAAM1B,EAAK,EAAGA,EAAKO,EAAQP,IAAQ,CAElC,GAAI1R,GAAI0R,EAAK2B,EAAgBF,CAE7BvF,GAAS0E,KAAMtS,GAAKC,EAAG,GAEvB4P,EAAQyC,KAAM,EAAG,EAAG,GAEpBxC,EAAIwC,KAAMZ,EAAKF,GACf1B,EAAIwC,KAAM,EAAMX,EAAKF,IAQvB,IAAME,EAAK,EAAGA,EAAKF,EAAOE,IAEzB,IAAMD,EAAK,EAAGA,EAAKF,EAAOE,IAAQ,CAEjC,GAAI1E,GAAI0E,EAAKO,EAASN,EAClBzL,EAAIwL,EAAKO,GAAWN,EAAK,GACzB1E,EAAMyE,EAAK,EAAMO,GAAWN,EAAK,GACjCa,EAAMd,EAAK,EAAMO,EAASN,CAI9Bc,GAAQH,KAAMtF,EAAG9G,EAAGsM,GACpBC,EAAQH,KAAMpM,EAAG+G,EAAGuF,GAQtBtS,KAAK6S,SAAUN,GACfvS,KAAK8S,aAAc,WAAY,GAAItD,GAAwB9B,EAAU,IACrE1N,KAAK8S,aAAc,SAAU,GAAItD,GAAwBG,EAAS,IAClE3P,KAAK8S,aAAc,KAAM,GAAItD,GAAwBI,EAAK,IAc3D,QAASyD,KAERzR,OAAOC,eAAgB7B,KAAM,MAAQ8B,MAAOwR,OAE5CtT,KAAKgC,KAAOC,GAAMC,eAElBlC,KAAKmC,KAAO,GACZnC,KAAKyB,KAAO,WAEZzB,KAAKuT,KAAM,EACXvT,KAAKwT,QAAS,EAEdxT,KAAKyT,SAAWC,GAChB1T,KAAK2T,KAAOC,GACZ5T,KAAK6T,aAAc,EACnB7T,KAAKuN,aAAeuG,GAEpB9T,KAAK+T,QAAU,EACf/T,KAAKgU,aAAc,EAEnBhU,KAAKiU,SAAWC,GAChBlU,KAAKmU,SAAWC,GAChBpU,KAAKqU,cAAgBC,GACrBtU,KAAKuU,cAAgB,KACrBvU,KAAKwU,cAAgB,KACrBxU,KAAKyU,mBAAqB,KAE1BzU,KAAK0U,UAAYC,GACjB3U,KAAK4U,WAAY,EACjB5U,KAAK6U,YAAa,EAElB7U,KAAK8U,eAAiB,KACtB9U,KAAK+U,kBAAmB,EACxB/U,KAAKgV,aAAc,EAEnBhV,KAAKiV,WAAa,KAElBjV,KAAKkV,YAAa,EAElBlV,KAAKmV,UAAY,KAEjBnV,KAAKoV,eAAgB,EACrBpV,KAAKqV,oBAAsB,EAC3BrV,KAAKsV,mBAAqB,EAE1BtV,KAAKuV,WAAY,EAEjBvV,KAAKwV,UAAY,EACjBxV,KAAKyV,oBAAqB,EAE1BzV,KAAK0V,SAAW,EAEhB1V,KAAKyL,SAAU,EAEfzL,KAAK8L,YAEL9L,KAAK2V,aAAc,EA6VpB,QAASC,GAAmB/E,GAE3BwC,EAAS/O,KAAMtE,MAEfA,KAAKyB,KAAO,oBAEZzB,KAAKgN,MAAQ,GAAInH,GAAO,UAExB7F,KAAK6V,IAAM,KAEX7V,KAAK8V,SAAW,KAChB9V,KAAK+V,kBAAoB,EAEzB/V,KAAKgW,MAAQ,KACbhW,KAAKiW,eAAiB,EAEtBjW,KAAKkW,YAAc,KAEnBlW,KAAKmW,SAAW,KAEhBnW,KAAKoW,OAAS,KACdpW,KAAKqW,QAAUC,GACftW,KAAKuW,aAAe,EACpBvW,KAAKwW,gBAAkB,IAEvBxW,KAAKyW,WAAY,EACjBzW,KAAK0W,mBAAqB,EAC1B1W,KAAK2W,iBAAmB,QACxB3W,KAAK4W,kBAAoB,QAEzB5W,KAAK6W,UAAW,EAChB7W,KAAK8N,cAAe,EAEpB9N,KAAKwT,QAAS,EAEdxT,KAAK8W,UAAWjG,GAiEjB,QAASkG,GAAgBlG,GAExBwC,EAAS/O,KAAMtE,MAEfA,KAAKyB,KAAO,iBAEZzB,KAAKgX,WACLhX,KAAKiX,YAELjX,KAAKkX,aAAe,gGACpBlX,KAAKmX,eAAiB,iEAEtBnX,KAAKoX,UAAY,EAEjBpX,KAAKyW,WAAY,EACjBzW,KAAK0W,mBAAqB,EAE1B1W,KAAKuT,KAAM,EACXvT,KAAKwT,QAAS,EACdxT,KAAKqX,UAAW,EAEhBrX,KAAK6W,UAAW,EAChB7W,KAAK8N,cAAe,EACpB9N,KAAK+N,cAAe,EAEpB/N,KAAKsX,YACJC,aAAa,EACbC,WAAW,EACXC,aAAa,EACbC,kBAAkB,GAKnB1X,KAAK2X,wBACJ3K,OAAW,EAAG,EAAG,GACjB4K,IAAQ,EAAG,GACXC,KAAS,EAAG,IAGb7X,KAAK8X,oBAAsBhX,OAC3Bd,KAAK+X,oBAAqB,EAENjX,SAAf+P,IAE2B/P,SAA1B+P,EAAWR,YAEfhQ,QAAQC,MAAO,2FAIhBN,KAAK8W,UAAWjG,IAqHlB,QAASmH,GAAKC,EAAQC,GAErBlY,KAAKiY,OAAsBnX,SAAXmX,EAAyBA,EAAS,GAAIlX,GACtDf,KAAKkY,UAA4BpX,SAAdoX,EAA4BA,EAAY,GAAInX,GA4hBhE,QAASoX,GAAUrL,EAAG9G,EAAG+G,GAExB/M,KAAK8M,EAAYhM,SAANgM,EAAoBA,EAAI,GAAI/L,GACvCf,KAAKgG,EAAYlF,SAANkF,EAAoBA,EAAI,GAAIjF,GACvCf,KAAK+M,EAAYjM,SAANiM,EAAoBA,EAAI,GAAIhM,GA8TxC,QAASqX,GAAMC,EAAUC,GAExBpO,EAAS5F,KAAMtE,MAEfA,KAAKyB,KAAO,OAEZzB,KAAKqY,SAAwBvX,SAAbuX,EAAyBA,EAAW,GAAInI,GACxDlQ,KAAKsY,SAAwBxX,SAAbwX,EAAyBA,EAAW,GAAI1C,IAAqB5I,MAAuB,SAAhB2F,KAAK4F,WAEzFvY,KAAKwY,SAAWC,GAEhBzY,KAAK0Y,qBAkcN,QAASC,GAAiBC,EAAUC,EAAOC,EAASrD,GAQnD,QAASsD,GAAQC,EAAYC,EAAOC,EAAQC,GAE3C,GAAIC,GAAaH,EAAMG,UAEH,QAAfA,EAEJC,EAAUC,EAAYC,GAEXH,GAAcA,EAAW9L,UAEpC+L,EAAUD,EAAY,GACtBD,GAAa,IAITP,EAASY,WAAaL,IAE1BP,EAASa,MAAOb,EAASc,eAAgBd,EAASe,eAAgBf,EAASgB,kBAIvER,GAAcA,EAAWS,eAEZ/Y,SAAZgZ,IAEJA,EAAU,GAAI1B,GACb,GAAIrH,GAAmB,EAAG,EAAG,GAC7B,GAAIgG,IACHE,SAAU8C,GAAUC,KAAK/C,SACzBC,aAAc6C,GAAUC,KAAK9C,aAC7BC,eAAgB4C,GAAUC,KAAK7C,eAC/BxD,KAAMsG,GACNrF,WAAW,EACXC,YAAY,EACZtB,KAAK,KAIPuG,EAAQzB,SAAS6B,gBAAiB,UAClCJ,EAAQzB,SAAS6B,gBAAiB,MAElCJ,EAAQK,eAAiB,SAAWvB,EAAUK,EAAOC,GAEpDlZ,KAAKqL,YAAY+O,aAAclB,EAAO7N,cAIvCyN,EAAQpP,OAAQoQ,IAIjBA,EAAQxB,SAASrB,SAASoD,MAAMvY,MAAQsX,EAExCJ,EAAW5G,KAAM0H,EAASA,EAAQzB,SAAUyB,EAAQxB,SAAU,EAAG,OAEtDc,GAAcA,EAAWkB,YAEfxZ,SAAhByZ,IAEJA,EAAc,GAAIpO,QAAyB,EAAG,OAAQ,EAAG,GAEzDqO,EAAY,GAAIpC,GACf,GAAIpF,GAAqB,EAAG,GAC5B,GAAI4C,IAAqBhB,WAAW,EAAOC,YAAY,EAAOtB,KAAK,KAGpEuF,EAAQpP,OAAQ8Q,IAIjBA,EAAUlC,SAASzC,IAAMuD,EAIzBR,EAAS6B,mBAAoBF,EAAa,KAAMC,EAAUnC,SAAUmC,EAAUlC,SAAUkC,EAAW,OAMrG,QAASnB,GAAUrM,EAAO0N,GAEzB7B,EAAMtP,QAAQyD,MAAMqM,SAAUrM,EAAMlH,EAAGkH,EAAMjH,EAAGiH,EAAMhH,EAAG0U,EAAOjF,GAxFjE,GAGI8E,GAAaC,EACbV,EAJAR,EAAa,GAAIzT,GAAO,GACxB0T,EAAa,CA2FjB,QAECoB,cAAe,WAEd,MAAOrB,IAGRsB,cAAe,SAAW5N,EAAO0N,GAEhCpB,EAAWrT,IAAK+G,GAChBuM,EAAuBzY,SAAV4Z,EAAsBA,EAAQ,EAC3CrB,EAAUC,EAAYC,IAGvBsB,cAAe,WAEd,MAAOtB,IAGRuB,cAAe,SAAWJ,GAEzBnB,EAAamB,EACbrB,EAAUC,EAAYC,IAGvBR,OAAQA,GAUV,QAASgC,GAAqB9T,EAAIqQ,EAAY0D,EAAMC,GAInD,QAASC,GAASpZ,GAEjBqZ,EAAOrZ,EAIR,QAASiX,GAAQpS,EAAOuC,GAEvBjC,EAAGmU,WAAYD,EAAMxU,EAAOuC,GAE5B8R,EAAKtR,OAAQR,EAAOiS,GAIrB,QAASE,GAAiBhD,EAAU1R,EAAOuC,GAE1C,GAAIoS,EAEJ,IAAKL,EAAaM,SAEjBD,EAAYrU,MAMZ,IAFAqU,EAAYhE,EAAWjO,IAAK,0BAET,OAAdiS,EAGJ,WADAjb,SAAQC,MAAO,iIAOjBgb,GAAWL,EAAaM,SAAW,sBAAwB,4BAA8BJ,EAAMxU,EAAOuC,EAAOmP,EAASmD,mBAEtHR,EAAKtR,OAAQR,EAAOiS,EAAM9C,EAASmD,mBAvCpC,GAAIL,EA6CJnb,MAAKkb,QAAUA,EACflb,KAAK+Y,OAASA,EACd/Y,KAAKqb,gBAAkBA,EAQxB,QAASI,GAAmBxU,EAAIqQ,EAAYzG,GAI3C,QAAS6K,KAER,GAAuB5a,SAAlB6a,EAA8B,MAAOA,EAE1C,IAAIL,GAAYhE,EAAWjO,IAAK,iCAYhC,OARCsS,GAFkB,OAAdL,EAEYrU,EAAG2U,aAAcN,EAAUO,gCAI3B,EAQlB,QAASC,GAAiB3G,GAEzB,GAAmB,UAAdA,EAAwB,CAE5B,GAAKlO,EAAG8U,yBAA0B9U,EAAG+U,cAAe/U,EAAGgV,YAAa9G,UAAY,GAC3ElO,EAAG8U,yBAA0B9U,EAAGiV,gBAAiBjV,EAAGgV,YAAa9G,UAAY,EAEjF,MAAO,OAIRA,GAAY,UAIb,MAAmB,YAAdA,GAEClO,EAAG8U,yBAA0B9U,EAAG+U,cAAe/U,EAAGkV,cAAehH,UAAY,GAC7ElO,EAAG8U,yBAA0B9U,EAAGiV,gBAAiBjV,EAAGkV,cAAehH,UAAY,EAE5E,UAMF,OAhDR,GAAIwG,GAoDAJ,EAA6C,mBAA3Ba,yBAA0CnV,YAAcmV,wBAE1EjH,EAAqCrU,SAAzB+P,EAAWsE,UAA0BtE,EAAWsE,UAAY,QACxEkH,EAAeP,EAAiB3G,EAE/BkH,KAAiBlH,IAErB9U,QAAQ4H,KAAM,uBAAwBkN,EAAW,uBAAwBkH,EAAc,YACvFlH,EAAYkH,EAIb,IAAIC,GAAyBzL,EAAWyL,0BAA2B,EAE/DC,EAActV,EAAG2U,aAAc3U,EAAGuV,yBAClCC,EAAoBxV,EAAG2U,aAAc3U,EAAGyV,gCACxCC,EAAiB1V,EAAG2U,aAAc3U,EAAG2V,kBACrCC,EAAiB5V,EAAG2U,aAAc3U,EAAG6V,2BAErCC,EAAgB9V,EAAG2U,aAAc3U,EAAG+V,oBACpCC,EAAoBhW,EAAG2U,aAAc3U,EAAGiW,4BACxCC,EAAclW,EAAG2U,aAAc3U,EAAGmW,qBAClCC,EAAsBpW,EAAG2U,aAAc3U,EAAGqW,8BAE1CC,EAAiBd,EAAoB,EACrCe,EAAwBjC,KAAejE,EAAWjO,IAAK,qBACvDoU,EAAsBF,GAAkBC,CAE5C,QAECjC,SAAUA,EAEVG,iBAAkBA,EAClBI,gBAAiBA,EAEjB3G,UAAWA,EACXmH,uBAAwBA,EAExBC,YAAaA,EACbE,kBAAmBA,EACnBE,eAAgBA,EAChBE,eAAgBA,EAEhBE,cAAeA,EACfE,kBAAmBA,EACnBE,YAAaA,EACbE,oBAAqBA,EAErBE,eAAgBA,EAChBC,sBAAuBA,EACvBC,oBAAqBA,GAUvB,QAASC,KA+FR,QAASC,KAEHC,EAAQ9b,QAAU+b,IAEtBD,EAAQ9b,MAAQ+b,EAChBD,EAAQjI,YAAcmI,EAAkB,GAIzCtL,EAAMuL,UAAYD,EAClBtL,EAAMwL,gBAAkB,EAIzB,QAASC,GAAerY,EAAQsT,EAAQgF,EAAWC,GAElD,GAAIC,GAAqB,OAAXxY,EAAkBA,EAAOxF,OAAS,EAC/Cie,EAAW,IAEZ,IAAiB,IAAZD,EAAgB,CAIpB,GAFAC,EAAWT,EAAQ9b,MAEdqc,KAAkB,GAAqB,OAAbE,EAAoB,CAElD,GAAIC,GAAWJ,EAAsB,EAAVE,EAC1BG,EAAarF,EAAOlN,kBAErBwS,GAAiBC,gBAAiBF,IAEhB,OAAbF,GAAqBA,EAASje,OAASke,KAE3CD,EAAW,GAAItW,cAAcuW,GAI9B,KAAM,GAAItO,GAAI,EAAG0O,EAAKR,EAAWlO,IAAMoO,IAAYpO,EAAG0O,GAAM,EAE3DC,EAAMC,KAAMhZ,EAAQoK,IAAM6O,aAAcN,EAAYC,GAEpDG,EAAMxZ,OAAO2Z,QAAST,EAAUK,GAChCL,EAAUK,EAAK,GAAMC,EAAMvZ,SAM7BwY,EAAQ9b,MAAQuc,EAChBT,EAAQjI,aAAc,EAMvB,MAFAnD,GAAMuL,UAAYK,EAEXC,EAnJR,GAAI7L,GAAQxS,KAEX6d,EAAc,KACdC,EAAkB,EAClBiB,GAAuB,EACvBC,GAAmB,EAEnBL,EAAQ,GAAIzZ,GACZsZ,EAAmB,GAAIxd,GAEvB4c,GAAY9b,MAAO,KAAM6T,aAAa,EAEvC3V,MAAK4d,QAAUA,EACf5d,KAAK+d,UAAY,EACjB/d,KAAKge,gBAAkB,EAEvBhe,KAAKif,KAAO,SAAWrZ,EAAQsZ,EAAqBhG,GAEnD,GAAIiG,GACe,IAAlBvZ,EAAOxF,QACP8e,GAGoB,IAApBpB,GACAiB,CAOD,OALAA,GAAuBG,EAEvBrB,EAAcI,EAAerY,EAAQsT,EAAQ,GAC7C4E,EAAkBlY,EAAOxF,OAElB+e,GAIRnf,KAAKof,aAAe,WAEnBJ,GAAmB,EACnBf,EAAe,OAIhBje,KAAKqf,WAAa,WAEjBL,GAAmB,EACnBrB,KAID3d,KAAKsf,SAAW,SAAW1Z,EAAQmP,EAAkBC,EAAakE,EAAQqG,EAAOC,GAEhF,IAAOT,GAAmC,OAAXnZ,GAAqC,IAAlBA,EAAOxF,QAAgB4e,IAAsBhK,EAIzFgK,EAIJf,EAAe,MAIfN,QAIK,CAEN,GAAI8B,GAAUT,EAAmB,EAAIlB,EACpC4B,EAAoB,EAAVD,EAEVpB,EAAWkB,EAAMI,eAAiB,IAEnC/B,GAAQ9b,MAAQuc,EAEhBA,EAAWJ,EAAerY,EAAQsT,EAAQwG,EAASF,EAEnD,KAAM,GAAIxP,GAAI,EAAGA,IAAM0P,IAAY1P,EAElCqO,EAAUrO,GAAM6N,EAAa7N,EAI9BuP,GAAMI,cAAgBtB,EACtBre,KAAKge,gBAAkBjJ,EAAmB/U,KAAK+d,UAAY,EAC3D/d,KAAK+d,WAAa0B,IAuErB,QAASG,GAAiB3Y,GAEzB,GAAIqQ,KAEJ,QAECjO,IAAK,SAAWlH,GAEf,GAA4BrB,SAAvBwW,EAAYnV,GAEhB,MAAOmV,GAAYnV,EAIpB,IAAImZ,EAEJ,QAASnZ,GAER,IAAK,sBACJmZ,EAAYrU,EAAG4Y,aAAc,wBAA2B5Y,EAAG4Y,aAAc,4BAA+B5Y,EAAG4Y,aAAc,6BACzH,MAED,KAAK,iCACJvE,EAAYrU,EAAG4Y,aAAc,mCAAsC5Y,EAAG4Y,aAAc,uCAA0C5Y,EAAG4Y,aAAc,wCAC/I,MAED,KAAK,gCACJvE,EAAYrU,EAAG4Y,aAAc,kCAAqC5Y,EAAG4Y,aAAc,sCAAyC5Y,EAAG4Y,aAAc,uCAC7I,MAED,KAAK,iCACJvE,EAAYrU,EAAG4Y,aAAc,mCAAsC5Y,EAAG4Y,aAAc,wCACpF,MAED,SACCvE,EAAYrU,EAAG4Y,aAAc1d,GAY/B,MARmB,QAAdmZ,GAEJjb,QAAQ4H,KAAM,wBAA0B9F,EAAO,6BAIhDmV,EAAYnV,GAASmZ,EAEdA,IAYV,QAASwE,GAAiB7Y,EAAIoJ,EAAY2K,GAKzC,QAAS+E,GAAmBC,GAE3B,GAAI3H,GAAW2H,EAAMC,OACjBC,EAAiBC,EAAY9H,EAAS+H,GAEZ,QAAzBF,EAAe9P,OAEnBC,EAAW7G,OAAQ0W,EAAe9P,MAInC,KAAM,GAAIjO,KAAQ+d,GAAe7P,WAEhCA,EAAW7G,OAAQ0W,EAAe7P,WAAYlO,GAI/CkW,GAASgI,oBAAqB,UAAWN,SAElCI,GAAY9H,EAAS+H,GAE5B,IAAIjZ,GAAYmZ,EAAqBJ,EAAeE,GAE/CjZ,KAEJkJ,EAAW7G,OAAQrC,SACZmZ,GAAqBJ,EAAeE,KAM5CpF,EAAKuF,OAAOJ,aAIb,QAAS9W,GAAKmX,EAAQnI,GAErB,GAAI6H,GAAiBC,EAAY9H,EAAS+H,GAE1C,OAAKF,GAAwBA,GAE7B7H,EAASoI,iBAAkB,UAAWV,GAEjC1H,EAASqI,iBAEbR,EAAiB7H,EAENA,EAASsI,aAEc7f,SAA7BuX,EAASuI,kBAEbvI,EAASuI,iBAAkB,GAAI1Q,IAAiB2Q,cAAeL,IAIhEN,EAAiB7H,EAASuI,iBAI3BT,EAAY9H,EAAS+H,IAAOF,EAE5BlF,EAAKuF,OAAOJ,aAELD,GAIR,QAASxW,GAAQ2O,GAEhB,GAAIjI,GAAQiI,EAASjI,MACjB0Q,EAAqBzI,EAAShI,UAEnB,QAAVD,GAEJC,EAAW3G,OAAQ0G,EAAOnJ,EAAG8Z,qBAI9B,KAAM,GAAI5e,KAAQ2e,GAEjBzQ,EAAW3G,OAAQoX,EAAoB3e,GAAQ8E,EAAG+Z,aAMnD,IAAI1Q,GAAkB+H,EAAS/H,eAE/B,KAAM,GAAInO,KAAQmO,GAIjB,IAAM,GAFFjJ,GAAQiJ,EAAiBnO,GAEnB6N,EAAI,EAAGC,EAAI5I,EAAMjH,OAAQ4P,EAAIC,EAAGD,IAEzCK,EAAW3G,OAAQrC,EAAO2I,GAAK/I,EAAG+Z,cAQrC,QAASC,GAAuB5I,GAE/B,GAAIlR,GAAYmZ,EAAqBjI,EAAS+H,GAE9C,IAAKjZ,EAAY,MAAOA,EAExB,IAAIoL,MAEA2O,EAAgB7I,EAASjI,MACzB0Q,EAAqBzI,EAAShI,UAIlC,IAAuB,OAAlB6Q,EAIJ,IAAM,GAFF7Z,GAAQ6Z,EAAc7Z,MAEhB2I,EAAI,EAAGC,EAAI5I,EAAMjH,OAAQ4P,EAAIC,EAAGD,GAAK,EAAI,CAElD,GAAIlD,GAAIzF,EAAO2I,EAAI,GACfhK,EAAIqB,EAAO2I,EAAI,GACfjD,EAAI1F,EAAO2I,EAAI,EAEnBuC,GAAQH,KAAMtF,EAAG9G,EAAGA,EAAG+G,EAAGA,EAAGD,OAQ9B,KAAM,GAFFzF,GAAQyZ,EAAmBhW,SAASzD,MAE9B2I,EAAI,EAAGC,EAAM5I,EAAMjH,OAAS,EAAM,EAAG4P,EAAIC,EAAGD,GAAK,EAAI,CAE9D,GAAIlD,GAAIkD,EAAI,EACRhK,EAAIgK,EAAI,EACRjD,EAAIiD,EAAI,CAEZuC,GAAQH,KAAMtF,EAAG9G,EAAGA,EAAG+G,EAAGA,EAAGD,GAc/B,MANA3F,GAAY,IAAM4I,EAAUwC,GAAY,MAAQhD,EAAwBF,GAAyBkD,EAAS,GAE1GlC,EAAW3G,OAAQvC,EAAWF,EAAG8Z,sBAEjCT,EAAqBjI,EAAS+H,IAAOjZ,EAE9BA,EA7JR,GAAIgZ,MACAG,IAgKJ,QAECjX,IAAKA,EACLK,OAAQA,EAERuX,sBAAuBA,GAUzB,QAASE,IAA4Bla,EAAIqQ,EAAY0D,EAAMC,GAI1D,QAASC,GAASpZ,GAEjBqZ,EAAOrZ,EAMR,QAAS+Q,GAAU/Q,GAElBL,EAAOK,EAAML,KACbqH,EAAkBhH,EAAMgH,gBAIzB,QAASiQ,GAAQpS,EAAOuC,GAEvBjC,EAAGma,aAAcjG,EAAMjS,EAAOzH,EAAMkF,EAAQmC,GAE5CkS,EAAKtR,OAAQR,EAAOiS,GAIrB,QAASE,GAAiBhD,EAAU1R,EAAOuC,GAE1C,GAAIoS,EAEJ,IAAKL,EAAaM,SAEjBD,EAAYrU,MAEN,CAEN,GAAIqU,GAAYhE,EAAWjO,IAAK,yBAEhC,IAAmB,OAAdiS,EAGJ,WADAjb,SAAQC,MAAO,yIAOjBgb,EAAWL,EAAaM,SAAW,wBAA0B,8BAAgCJ,EAAMjS,EAAOzH,EAAMkF,EAAQmC,EAAiBuP,EAASmD,mBAElJR,EAAKtR,OAAQR,EAAOiS,EAAM9C,EAASmD,mBAhDpC,GAAIL,GAQA1Z,EAAMqH,CA8CV9I,MAAKkb,QAAUA,EACflb,KAAK6S,SAAWA,EAChB7S,KAAK+Y,OAASA,EACd/Y,KAAKqb,gBAAkBA,EAQxB,QAASgG,IAAWpa,GAenB,QAASyC,GAAQR,EAAOiS,EAAMmG,GAM7B,OAJAA,EAAgBA,GAAiB,EAEjCvI,EAAOwI,QAEEpG,GAER,IAAKlU,GAAGua,UACPzI,EAAO0I,WAAaH,GAAkBpY,EAAQ,EAC9C,MAED,KAAKjC,GAAGya,eACR,IAAKza,GAAG0a,aACP5I,EAAO0I,WAAaH,GAAkBpY,EAAQ,EAC9C,MAED,KAAKjC,GAAG2a,MACP7I,EAAO8I,OAASP,GAAkBpY,EAAQ,EAC1C,MAED,KAAKjC,GAAG6a,WACP/I,EAAO8I,OAASP,GAAkBpY,EAAQ,EAC1C,MAED,KAAKjC,GAAG8a,UACPhJ,EAAO8I,OAASP,EAAgBpY,CAChC,MAED,KAAKjC,GAAG+a,OACPjJ,EAAOkJ,QAAUX,EAAgBpY,CACjC,MAED,SACC7I,QAAQC,MAAO,sCAAuC6a,IAOzD,QAAS+G,KAERnJ,EAAOzS,QACPyS,EAAOwI,MAAQ,EACfxI,EAAO0I,UAAY,EACnB1I,EAAOkJ,OAAS,EAChBlJ,EAAO8I,MAAQ,EA5DhB,GAAItB,IACHJ,WAAY,EACZgC,SAAU,GAGPpJ,GACHzS,MAAO,EACPib,MAAO,EACPE,UAAW,EACXQ,OAAQ,EACRJ,MAAO,EAsDR,QACCtB,OAAQA,EACRxH,OAAQA,EACRqJ,SAAU,KACVC,WAAW,EACXH,MAAOA,EACPxY,OAAQA,GASV,QAAS4Y,IAAkBxV,EAAG9G,GAE7B,MAAO2M,MAAK4P,IAAKvc,EAAG,IAAQ2M,KAAK4P,IAAKzV,EAAG,IAI1C,QAAS0V,IAAmBvb,GAK3B,QAASyC,GAAQ8W,EAAQnI,EAAUC,EAAUmK,GAE5C,GAAIC,GAAmBlC,EAAOmC,sBAE1BviB,EAASsiB,EAAiBtiB,OAE1BwiB,EAAaC,EAAgBxK,EAAS+H,GAE1C,IAAoBtf,SAAf8hB,EAA2B,CAI/BA,IAEA,KAAM,GAAI5S,GAAI,EAAGA,EAAI5P,EAAQ4P,IAE5B4S,EAAY5S,IAAQA,EAAG,EAIxB6S,GAAgBxK,EAAS+H,IAAOwC,EASjC,IAAM,GALF9U,GAAewK,EAASxK,cAAgBuK,EAAS/H,gBAAgBxF,SACjEiD,EAAeuK,EAASvK,cAAgBsK,EAAS/H,gBAAgBnL,OAI3D6K,EAAI,EAAGA,EAAI5P,EAAQ4P,IAAO,CAEnC,GAAI8S,GAAYF,EAAY5S,EAEJ,KAAnB8S,EAAW,KAEVhV,GAAeuK,EAAS6B,gBAAiB,cAAgBlK,GACzDjC,GAAesK,EAAS6B,gBAAiB,cAAgBlK,IAQhE,IAAM,GAAIA,GAAI,EAAGA,EAAI5P,EAAQ4P,IAAO,CAEnC,GAAI8S,GAAYF,EAAY5S,EAE5B8S,GAAW,GAAM9S,EACjB8S,EAAW,GAAMJ,EAAkB1S,GAIpC4S,EAAWG,KAAMT,GAIjB,KAAM,GAAItS,GAAI,EAAGA,EAAI,EAAGA,IAAO,CAE9B,GAAI8S,GAAYF,EAAY5S,EAE5B,IAAK8S,EAAY,CAEhB,GAAI1S,GAAQ0S,EAAW,GACnBhhB,EAAQghB,EAAW,EAEvB,IAAKhhB,EAAQ,CAEPgM,GAAeuK,EAASvF,aAAc,cAAgB9C,EAAGlC,EAAcsC,IACvErC,GAAesK,EAASvF,aAAc,cAAgB9C,EAAGjC,EAAcqC,IAE5E4S,EAAiBhT,GAAMlO,CACvB,WAMFkhB,EAAiBhT,GAAM,EAIxByS,EAAQQ,cAAcC,SAAUjc,EAAI,wBAAyB+b,GArF9D,GAAIH,MACAG,EAAkB,GAAIjb,cAAc,EAwFxC,QAEC2B,OAAQA,GAUV,QAASyZ,IAAchD,EAAYnF,GAIlC,QAAStR,GAAQ8W,GAEhB,GAAIla,GAAQ0U,EAAKjC,OAAOzS,MAEpB+R,EAAWmI,EAAOnI,SAClB6H,EAAiBC,EAAW9W,IAAKmX,EAAQnI,EAkB7C,OAdK+K,GAAYlD,EAAeE,MAAS9Z,IAEnC+R,EAASsI,YAEbT,EAAemD,iBAAkB7C,GAIlCL,EAAWzW,OAAQwW,GAEnBkD,EAAYlD,EAAeE,IAAO9Z,GAI5B4Z,EAIR,QAASoD,KAERF,KA/BD,GAAIA,KAmCJ,QAEC1Z,OAAQA,EACR4Z,QAASA,GAUX,QAASC,IAAaC,EAAQriB,EAASC,EAAOC,EAAOC,EAAWC,EAAWC,EAAQC,EAAMC,EAAYC,GAEpG6hB,EAAoB1iB,SAAX0iB,EAAuBA,KAChCriB,EAAsBL,SAAZK,EAAwBA,EAAUsiB,GAE5CxiB,EAAQqD,KAAMtE,KAAMwjB,EAAQriB,EAASC,EAAOC,EAAOC,EAAWC,EAAWC,EAAQC,EAAMC,EAAYC,GAEnG3B,KAAKoD,OAAQ,EAiFd,QAASsgB,MAER1jB,KAAK2jB,OACL3jB,KAAK6V,OAmBN,QAAS+N,IAASvc,EAAOwc,EAASC,GAEjC,GAAIC,GAAY1c,EAAO,EAEvB,IAAK0c,GAAa,GAAKA,EAAY,EAAI,MAAO1c,EAI9C,IAAI2c,GAAIH,EAAUC,EACjBhe,EAAIme,GAAeD,EASpB,IAPWljB,SAANgF,IAEJA,EAAI,GAAIiC,cAAcic,GACtBC,GAAeD,GAAMle,GAIL,IAAZ+d,EAAgB,CAEpBE,EAAUjF,QAAShZ,EAAG,EAEtB,KAAM,GAAIkK,GAAI,EAAGpN,EAAS,EAAGoN,IAAM6T,IAAY7T,EAE9CpN,GAAUkhB,EACVzc,EAAO2I,GAAI8O,QAAShZ,EAAGlD,GAMzB,MAAOkD,GAIR,QAASoe,IAAapX,EAAG9G,GAExB,GAAK8G,EAAE1M,SAAW4F,EAAE5F,OAAS,OAAO,CAEpC,KAAM,GAAI4P,GAAI,EAAGC,EAAInD,EAAE1M,OAAQ4P,EAAIC,EAAGD,IAErC,GAAKlD,EAAGkD,KAAQhK,EAAGgK,GAAM,OAAO,CAIjC,QAAO,EAIR,QAASmU,IAAWrX,EAAG9G,GAEtB,IAAM,GAAIgK,GAAI,EAAGC,EAAIjK,EAAE5F,OAAQ4P,EAAIC,EAAGD,IAErClD,EAAGkD,GAAMhK,EAAGgK,GAQd,QAASoU,IAAexL,EAAUoL,GAEjC,GAAIle,GAAIue,GAAeL,EAEZljB,UAANgF,IAEJA,EAAI,GAAI0C,YAAYwb,GACpBK,GAAeL,GAAMle,EAItB,KAAM,GAAIkK,GAAI,EAAGA,IAAMgU,IAAMhU,EAC5BlK,EAAGkK,GAAM4I,EAAS0L,kBAEnB,OAAOxe,GAWR,QAASye,IAAYtd,EAAIkK,GAExB,GAAIoO,GAAQvf,KAAKuf,KAEZA,GAAO,KAAQpO,IAEpBlK,EAAGud,UAAWxkB,KAAKykB,KAAMtT,GAEzBoO,EAAO,GAAMpO,GAId,QAASuT,IAAYzd,EAAIkK,GAExB,GAAIoO,GAAQvf,KAAKuf,KAEZA,GAAO,KAAQpO,IAEpBlK,EAAG0d,UAAW3kB,KAAKykB,KAAMtT,GAEzBoO,EAAO,GAAMpO,GAMd,QAASyT,IAAa3d,EAAIkK,GAEzB,GAAIoO,GAAQvf,KAAKuf,KAEjB,IAAaze,SAARqQ,EAAErR,EAEDyf,EAAO,KAAQpO,EAAErR,GAAKyf,EAAO,KAAQpO,EAAEpR,IAE3CkH,EAAG4d,UAAW7kB,KAAKykB,KAAMtT,EAAErR,EAAGqR,EAAEpR,GAEhCwf,EAAO,GAAMpO,EAAErR,EACfyf,EAAO,GAAMpO,EAAEpR,OAIV,CAEN,GAAKmkB,GAAa3E,EAAOpO,GAAM,MAE/BlK,GAAG6d,WAAY9kB,KAAKykB,KAAMtT,GAE1BgT,GAAW5E,EAAOpO,IAMpB,QAAS4T,IAAa9d,EAAIkK,GAEzB,GAAIoO,GAAQvf,KAAKuf,KAEjB,IAAaze,SAARqQ,EAAErR,EAEDyf,EAAO,KAAQpO,EAAErR,GAAKyf,EAAO,KAAQpO,EAAEpR,GAAKwf,EAAO,KAAQpO,EAAE3Q,IAEjEyG,EAAG+d,UAAWhlB,KAAKykB,KAAMtT,EAAErR,EAAGqR,EAAEpR,EAAGoR,EAAE3Q,GAErC+e,EAAO,GAAMpO,EAAErR,EACfyf,EAAO,GAAMpO,EAAEpR,EACfwf,EAAO,GAAMpO,EAAE3Q,OAIV,IAAaM,SAARqQ,EAAErL,EAERyZ,EAAO,KAAQpO,EAAErL,GAAKyZ,EAAO,KAAQpO,EAAEpL,GAAKwZ,EAAO,KAAQpO,EAAEnL,IAEjEiB,EAAG+d,UAAWhlB,KAAKykB,KAAMtT,EAAErL,EAAGqL,EAAEpL,EAAGoL,EAAEnL,GAErCuZ,EAAO,GAAMpO,EAAErL,EACfyZ,EAAO,GAAMpO,EAAEpL,EACfwZ,EAAO,GAAMpO,EAAEnL,OAIV,CAEN,GAAKke,GAAa3E,EAAOpO,GAAM,MAE/BlK,GAAGge,WAAYjlB,KAAKykB,KAAMtT,GAE1BgT,GAAW5E,EAAOpO,IAMpB,QAAS+T,IAAaje,EAAIkK,GAEzB,GAAIoO,GAAQvf,KAAKuf,KAEjB,IAAaze,SAARqQ,EAAErR,EAEDyf,EAAO,KAAQpO,EAAErR,GAAKyf,EAAO,KAAQpO,EAAEpR,GAAKwf,EAAO,KAAQpO,EAAE3Q,GAAK+e,EAAO,KAAQpO,EAAE1Q,IAEvFwG,EAAGke,UAAWnlB,KAAKykB,KAAMtT,EAAErR,EAAGqR,EAAEpR,EAAGoR,EAAE3Q,EAAG2Q,EAAE1Q,GAE1C8e,EAAO,GAAMpO,EAAErR,EACfyf,EAAO,GAAMpO,EAAEpR,EACfwf,EAAO,GAAMpO,EAAE3Q,EACf+e,EAAO,GAAMpO,EAAE1Q,OAIV,CAEN,GAAKyjB,GAAa3E,EAAOpO,GAAM,MAE/BlK,GAAGme,WAAYplB,KAAKykB,KAAMtT,GAE1BgT,GAAW5E,EAAOpO,IAQpB,QAASkU,IAAape,EAAIkK,GAEzB,GAAIoO,GAAQvf,KAAKuf,MACbrf,EAAWiR,EAAEjR,QAEjB,IAAkBY,SAAbZ,EAAyB,CAE7B,GAAKgkB,GAAa3E,EAAOpO,GAAM,MAE/BlK,GAAGqe,iBAAkBtlB,KAAKykB,MAAM,EAAOtT,GAEvCgT,GAAW5E,EAAOpO,OAEZ,CAEN,GAAK+S,GAAa3E,EAAOrf,GAAa,MAEtCqlB,IAAUtf,IAAK/F,GAEf+G,EAAGqe,iBAAkBtlB,KAAKykB,MAAM,EAAOc,IAEvCpB,GAAW5E,EAAOrf,IAMpB,QAASslB,IAAave,EAAIkK,GAEzB,GAAIoO,GAAQvf,KAAKuf,MACbrf,EAAWiR,EAAEjR,QAEjB,IAAkBY,SAAbZ,EAAyB,CAE7B,GAAKgkB,GAAa3E,EAAOpO,GAAM,MAE/BlK,GAAGwe,iBAAkBzlB,KAAKykB,MAAM,EAAOtT,GAEvCgT,GAAW5E,EAAOpO,OAEZ,CAEN,GAAK+S,GAAa3E,EAAOrf,GAAa,MAEtCwlB,IAAUzf,IAAK/F,GAEf+G,EAAGwe,iBAAkBzlB,KAAKykB,MAAM,EAAOiB,IAEvCvB,GAAW5E,EAAOrf,IAMpB,QAASylB,IAAa1e,EAAIkK,GAEzB,GAAIoO,GAAQvf,KAAKuf,MACbrf,EAAWiR,EAAEjR,QAEjB,IAAkBY,SAAbZ,EAAyB,CAE7B,GAAKgkB,GAAa3E,EAAOpO,GAAM,MAE/BlK,GAAG2e,iBAAkB5lB,KAAKykB,MAAM,EAAOtT,GAEvCgT,GAAW5E,EAAOpO,OAEZ,CAEN,GAAK+S,GAAa3E,EAAOrf,GAAa,MAEtC2lB,IAAU5f,IAAK/F,GAEf+G,EAAG2e,iBAAkB5lB,KAAKykB,MAAM,EAAOoB,IAEvC1B,GAAW5E,EAAOrf,IAQpB,QAAS4lB,IAAY7e,EAAIkK,EAAGyH,GAE3B,GAAI2G,GAAQvf,KAAKuf,MACbwG,EAAOnN,EAAS0L,kBAEf/E,GAAO,KAAQwG,IAEnB9e,EAAG0d,UAAW3kB,KAAKykB,KAAMsB,GACzBxG,EAAO,GAAMwG,GAIdnN,EAASoN,aAAc7U,GAAK8U,GAAcF,GAI3C,QAASG,IAAYjf,EAAIkK,EAAGyH,GAE3B,GAAI2G,GAAQvf,KAAKuf,MACbwG,EAAOnN,EAAS0L,kBAEf/E,GAAO,KAAQwG,IAEnB9e,EAAG0d,UAAW3kB,KAAKykB,KAAMsB,GACzBxG,EAAO,GAAMwG,GAIdnN,EAASuN,eAAgBhV,GAAKiV,GAAkBL,GAMjD,QAASM,IAAapf,EAAIkK,GAEzB,GAAIoO,GAAQvf,KAAKuf,KAEZ2E,IAAa3E,EAAOpO,KAEzBlK,EAAGqf,WAAYtmB,KAAKykB,KAAMtT,GAE1BgT,GAAW5E,EAAOpO,IAInB,QAASoV,IAAatf,EAAIkK,GAEzB,GAAIoO,GAAQvf,KAAKuf,KAEZ2E,IAAa3E,EAAOpO,KAEzBlK,EAAGuf,WAAYxmB,KAAKykB,KAAMtT,GAE1BgT,GAAW5E,EAAOpO,IAInB,QAASsV,IAAaxf,EAAIkK,GAEzB,GAAIoO,GAAQvf,KAAKuf,KAEZ2E,IAAa3E,EAAOpO,KAEzBlK,EAAGyf,WAAY1mB,KAAKykB,KAAMtT,GAE1BgT,GAAW5E,EAAOpO,IAMnB,QAASwV,IAAmBllB,GAE3B,OAASA,GAER,IAAK,MAAQ,MAAO8iB,GACpB,KAAK,OAAQ,MAAOK,GACpB,KAAK,OAAQ,MAAOG,GACpB,KAAK,OAAQ,MAAOG,GAEpB,KAAK,OAAQ,MAAOG,GACpB,KAAK,OAAQ,MAAOG,GACpB,KAAK,OAAQ,MAAOG,GAEpB,KAAK,OAAQ,IAAK,OAAQ,MAAOG,GACjC,KAAK,OAAQ,MAAOI,GAEpB,KAAK,MAAQ,IAAK,OAAQ,MAAOxB,GACjC,KAAK,OAAQ,IAAK,OAAQ,MAAO2B,GACjC,KAAK,OAAQ,IAAK,OAAQ,MAAOE,GACjC,KAAK,OAAQ,IAAK,OAAQ,MAAOE,KAQnC,QAASG,IAAa3f,EAAIkK,GAEzB,GAAIoO,GAAQvf,KAAKuf,KAEZ2E,IAAa3E,EAAOpO,KAEzBlK,EAAG4f,WAAY7mB,KAAKykB,KAAMtT,GAE1BgT,GAAW5E,EAAOpO,IAGnB,QAAS2V,IAAa7f,EAAIkK,GAEzB,GAAIoO,GAAQvf,KAAKuf,KAEZ2E,IAAa3E,EAAOpO,KAEzBlK,EAAG8f,WAAY/mB,KAAKykB,KAAMtT,GAE1BgT,GAAW5E,EAAOpO,IAMnB,QAAS6V,IAAa/f,EAAIkK,GAEzB,GAAIoO,GAAQvf,KAAKuf,MACb7a,EAAOkf,GAASzS,EAAGnR,KAAKinB,KAAM,EAE7B/C,IAAa3E,EAAO7a,KAEzBuC,EAAG6d,WAAY9kB,KAAKykB,KAAM/f,GAE1B1E,KAAKknB,YAAaxiB,IAInB,QAASyiB,IAAalgB,EAAIkK,GAEzB,GAAIoO,GAAQvf,KAAKuf,MACb7a,EAAOkf,GAASzS,EAAGnR,KAAKinB,KAAM,EAE7B/C,IAAa3E,EAAO7a,KAEzBuC,EAAGge,WAAYjlB,KAAKykB,KAAM/f,GAE1B1E,KAAKknB,YAAaxiB,IAInB,QAAS0iB,IAAangB,EAAIkK,GAEzB,GAAIoO,GAAQvf,KAAKuf,MACb7a,EAAOkf,GAASzS,EAAGnR,KAAKinB,KAAM,EAE7B/C,IAAa3E,EAAO7a,KAEzBuC,EAAGme,WAAYplB,KAAKykB,KAAM/f,GAE1B1E,KAAKknB,YAAaxiB,IAMnB,QAAS2iB,IAAapgB,EAAIkK,GAEzB,GAAIoO,GAAQvf,KAAKuf,MACb7a,EAAOkf,GAASzS,EAAGnR,KAAKinB,KAAM,EAE7B/C,IAAa3E,EAAO7a,KAEzBuC,EAAGqe,iBAAkBtlB,KAAKykB,MAAM,EAAO/f,GAEvC1E,KAAKknB,YAAaxiB,IAInB,QAAS4iB,IAAargB,EAAIkK,GAEzB,GAAIoO,GAAQvf,KAAKuf,MACb7a,EAAOkf,GAASzS,EAAGnR,KAAKinB,KAAM,EAE7B/C,IAAa3E,EAAO7a,KAEzBuC,EAAGwe,iBAAkBzlB,KAAKykB,MAAM,EAAO/f,GAEvC1E,KAAKknB,YAAaxiB,IAInB,QAAS6iB,IAAatgB,EAAIkK,GAEzB,GAAIoO,GAAQvf,KAAKuf,MACb7a,EAAOkf,GAASzS,EAAGnR,KAAKinB,KAAM,GAE7B/C,IAAa3E,EAAO7a,KAEzBuC,EAAG2e,iBAAkB5lB,KAAKykB,MAAM,EAAO/f,GAEvC1E,KAAKknB,YAAaxiB,IAMnB,QAAS8iB,IAAavgB,EAAIkK,EAAGyH,GAE5B,GAAI2G,GAAQvf,KAAKuf,MACbyE,EAAI7S,EAAE/Q,OAENqnB,EAAQrD,GAAexL,EAAUoL,EAEhCE,IAAa3E,EAAOkI,MAAY,IAEpCxgB,EAAG8f,WAAY/mB,KAAKykB,KAAMgD,GAC1BtD,GAAW5E,EAAOkI,GAInB,KAAM,GAAIzX,GAAI,EAAGA,IAAMgU,IAAMhU,EAE5B4I,EAASoN,aAAc7U,EAAGnB,IAAOiW,GAAcwB,EAAOzX,IAMxD,QAAS0X,IAAazgB,EAAIkK,EAAGyH,GAE5B,GAAI2G,GAAQvf,KAAKuf,MACbyE,EAAI7S,EAAE/Q,OAENqnB,EAAQrD,GAAexL,EAAUoL,EAEhCE,IAAa3E,EAAOkI,MAAY,IAEpCxgB,EAAG8f,WAAY/mB,KAAKykB,KAAMgD,GAC1BtD,GAAW5E,EAAOkI,GAInB,KAAM,GAAIzX,GAAI,EAAGA,IAAMgU,IAAMhU,EAE5B4I,EAASuN,eAAgBhV,EAAGnB,IAAOoW,GAAkBqB,EAAOzX,IAQ9D,QAAS2X,IAAoBlmB,GAE5B,OAASA,GAER,IAAK,MAAQ,MAAOmlB,GACpB,KAAK,OAAQ,MAAOI,GACpB,KAAK,OAAQ,MAAOG,GACpB,KAAK,OAAQ,MAAOC,GAEpB,KAAK,OAAQ,MAAOC,GACpB,KAAK,OAAQ,MAAOC,GACpB,KAAK,OAAQ,MAAOC,GAEpB,KAAK,OAAQ,MAAOC,GACpB,KAAK,OAAQ,MAAOE,GAEpB,KAAK,MAAQ,IAAK,OAAQ,MAAOZ,GACjC,KAAK,OAAQ,IAAK,OAAQ,MAAOT,GACjC,KAAK,OAAQ,IAAK,OAAQ,MAAOE,GACjC,KAAK,OAAQ,IAAK,OAAQ,MAAOE,KAQnC,QAASmB,IAAexH,EAAIyH,EAAYpD,GAEvCzkB,KAAKogB,GAAKA,EACVpgB,KAAKykB,KAAOA,EACZzkB,KAAKuf,SACLvf,KAAKkjB,SAAWyD,GAAmBkB,EAAWpmB,MAM/C,QAASqmB,IAAkB1H,EAAIyH,EAAYpD,GAE1CzkB,KAAKogB,GAAKA,EACVpgB,KAAKykB,KAAOA,EACZzkB,KAAKuf,SACLvf,KAAKinB,KAAOY,EAAWZ,KACvBjnB,KAAKkjB,SAAWyE,GAAoBE,EAAWpmB,MAoBhD,QAASsmB,IAAmB3H,GAE3BpgB,KAAKogB,GAAKA,EAEVsD,GAAiBpf,KAAMtE,MAgCxB,QAASgoB,IAAYC,EAAWC,GAE/BD,EAAUtE,IAAIvR,KAAM8V,GACpBD,EAAUpS,IAAKqS,EAAc9H,IAAO8H,EAIrC,QAASC,IAAcN,EAAYpD,EAAMwD,GAExC,GAAIG,GAAOP,EAAW1lB,KACrBkmB,EAAaD,EAAKhoB,MAKnB,KAFAkoB,GAAWC,UAAY,IAER,CAEd,GAAIC,GAAQF,GAAWG,KAAML,GAC5BM,EAAWJ,GAAWC,UAEtBnI,EAAKoI,EAAO,GACZG,EAA2B,MAAfH,EAAO,GACnBI,EAAYJ,EAAO,EAIpB,IAFKG,IAAYvI,EAAU,EAALA,GAEHtf,SAAd8nB,GAAyC,MAAdA,GAAqBF,EAAW,IAAML,EAAa,CAIlFL,GAAYC,EAAyBnnB,SAAd8nB,EACtB,GAAIhB,IAAexH,EAAIyH,EAAYpD,GACnC,GAAIqD,IAAkB1H,EAAIyH,EAAYpD,GAEvC,OAMA,GAAI5O,GAAMoS,EAAUpS,IAAKgT,EAAOhT,EAAKuK,EAEvBtf,UAAT+nB,IAEJA,EAAO,GAAId,IAAmB3H,GAC9B4H,GAAYC,EAAWY,IAIxBZ,EAAYY,GAUf,QAASC,IAAe7hB,EAAIwb,EAAS7J,GAEpC8K,GAAiBpf,KAAMtE,MAEvBA,KAAK4Y,SAAWA,CAIhB,KAAM,GAFFoL,GAAI/c,EAAG8hB,oBAAqBtG,EAASxb,EAAG+hB,iBAElChZ,EAAI,EAAGA,EAAIgU,IAAMhU,EAAI,CAE9B,GAAIgL,GAAO/T,EAAGgiB,iBAAkBxG,EAASzS,GACxCyU,EAAOxd,EAAGiiB,mBAAoBzG,EAASzH,EAAK7Y,KAE7CgmB,IAAcnN,EAAMyJ,EAAMzkB,OA8D5B,QAASmpB,IAAgBC,GAIxB,IAAM,GAFFvH,GAAQuH,EAAOC,MAAO,MAEhBrZ,EAAI,EAAGA,EAAI6R,EAAMzhB,OAAQ4P,IAElC6R,EAAO7R,GAAQA,EAAI,EAAM,KAAO6R,EAAO7R,EAIxC,OAAO6R,GAAMyH,KAAM,MAIpB,QAASC,IAAatiB,EAAIxF,EAAM2nB,GAE/B,GAAII,GAASviB,EAAGwiB,aAAchoB,EAoB9B,OAlBAwF,GAAGyiB,aAAcF,EAAQJ,GACzBniB,EAAG0iB,cAAeH,GAEbviB,EAAG2iB,mBAAoBJ,EAAQviB,EAAG4iB,mBAAqB,GAE3DxpB,QAAQC,MAAO,+CAIuB,KAAlC2G,EAAG6iB,iBAAkBN,IAEzBnpB,QAAQ4H,KAAM,2CAA4CxG,IAASwF,EAAG+U,cAAgB,SAAW,WAAY/U,EAAG6iB,iBAAkBN,GAAUL,GAAgBC,IAOtJI,EAUR,QAASO,IAAuBpoB,GAE/B,OAASA,GAER,IAAK2B,IACJ,OAAS,SAAU,YACpB,KAAK0mB,IACJ,OAAS,OAAQ,YAClB,KAAKC,IACJ,OAAS,OAAQ,YAClB,KAAKC,IACJ,OAAS,OAAQ,iBAClB,KAAKC,IACJ,OAAS,OAAQ,kBAClB,KAAKC,IACJ,OAAS,OAAQ,mBAClB,KAAKC,IACJ,OAAS,QAAS,mCACnB,SACC,KAAM,IAAIC,OAAO,yBAA2B3oB,IAM/C,QAAS4oB,IAA0BC,EAAc7oB,GAEhD,GAAI8oB,GAAaV,GAAuBpoB,EACxC,OAAO,QAAU6oB,EAAe,2BAA6BC,EAAY,GAAM,WAAaA,EAAY,GAAM,MAI/G,QAASC,IAA0BF,EAAc7oB,GAEhD,GAAI8oB,GAAaV,GAAuBpoB,EACxC,OAAO,QAAU6oB,EAAe,mCAAqCC,EAAY,GAAMA,EAAY,GAAM,MAI1G,QAASE,IAAwBH,EAAcI,GAE9C,GAAIC,EAEJ,QAASD,GAER,IAAKE,IACJD,EAAkB,QAClB,MAED,KAAKE,IACJF,EAAkB,UAClB,MAED,KAAKG,IACJH,EAAkB,YAClB,MAED,KAAKI,IACJJ,EAAkB,iBAClB,MAED,SACC,KAAM,IAAIP,OAAO,4BAA8BM,GAIjD,MAAO,QAAUJ,EAAe,2BAA6BK,EAAkB,0BAIhF,QAASK,IAAoB5T,EAAYzG,EAAYsa,GAEpD7T,EAAaA,KAEb,IAAI8T,IACD9T,EAAWC,aAAe1G,EAAWwa,cAAgBxa,EAAWya,SAAaza,EAAW0a,YAAe1a,EAAW2a,sBAA0B3a,EAAWgD,YAAgB,kDAAoD,IAC3NyD,EAAWE,WAAa3G,EAAWyL,yBAA4B6O,EAAmB9hB,IAAK,kBAAqB,wCAA0C,GACtJiO,EAAuB,aAAK6T,EAAmB9hB,IAAK,sBAAyB,2CAA6C,IAC1HiO,EAAWI,kBAAoB7G,EAAWuF,SAAY+U,EAAmB9hB,IAAK,0BAA6B,gDAAkD,GAGhK,OAAO+hB,GAAOK,OAAQC,IAAkBpC,KAAM,MAI/C,QAASqC,IAAiB3U,GAEzB,GAAIoU,KAEJ,KAAM,GAAIjpB,KAAQ6U,GAAU,CAE3B,GAAIlV,GAAQkV,EAAS7U,EAEhBL,MAAU,GAEfspB,EAAOhZ,KAAM,WAAajQ,EAAO,IAAML,GAIxC,MAAOspB,GAAO9B,KAAM,MAIrB,QAASsC,IAAyB3kB,EAAIwb,GAMrC,IAAM,GAJFpS,MAEA2T,EAAI/c,EAAG8hB,oBAAqBtG,EAASxb,EAAG4kB,mBAElC7b,EAAI,EAAGA,EAAIgU,EAAGhU,IAAO,CAE9B,GAAIgL,GAAO/T,EAAG6kB,gBAAiBrJ,EAASzS,GACpC7N,EAAO6Y,EAAK7Y,IAIhBkO,GAAYlO,GAAS8E,EAAG8kB,kBAAmBtJ,EAAStgB,GAIrD,MAAOkO,GAIR,QAASqb,IAAiBtC,GAEzB,MAAkB,KAAXA,EAIR,QAAS4C,IAAkB5C,EAAQvY,GAElC,MAAOuY,GACL6C,QAAS,kBAAmBpb,EAAWqb,cACvCD,QAAS,mBAAoBpb,EAAWsb,eACxCF,QAAS,wBAAyBpb,EAAWub,mBAC7CH,QAAS,oBAAqBpb,EAAWwb,gBACzCJ,QAAS,mBAAoBpb,EAAWyb,eAI3C,QAASC,IAA0BnD,EAAQvY,GAE1C,MAAOuY,GACL6C,QAAS,uBAAwBpb,EAAW2b,mBAC5CP,QAAS,yBAA4Bpb,EAAW2b,kBAAoB3b,EAAW4b,qBAIlF,QAASC,IAAetD,GAIvB,QAAS6C,GAASzD,EAAOmE,GAExB,GAAIV,GAAUW,GAAaD,EAE3B,IAAiB7rB,SAAZmrB,EAEJ,KAAM,IAAI3B,OAAO,6BAA+BqC,EAAU,IAI3D,OAAOD,IAAeT,GAZvB,GAAIY,GAAU,mCAgBd,OAAOzD,GAAO6C,QAASY,EAASZ,GAIjC,QAASa,IAAa1D,GAIrB,QAAS6C,GAASzD,EAAO7hB,EAAOomB,EAAKC,GAIpC,IAAM,GAFFC,GAAS,GAEHjd,EAAIkd,SAAUvmB,GAASqJ,EAAIkd,SAAUH,GAAO/c,IAErDid,GAAUD,EAAQf,QAAS,WAAY,KAAOjc,EAAI,KAInD,OAAOid,GAZR,GAAIJ,GAAU,8FAgBd,OAAOzD,GAAO6C,QAASY,EAASZ,GAIjC,QAASkB,IAAcvU,EAAUtB,EAAY8V,EAAM9U,EAAUkR,EAAQ3Y,EAAYoK,GAEhF,GAAIhU,GAAK2R,EAASnS,QAEduQ,EAAUsB,EAAStB,QAEnBE,EAAesS,EAAOtS,aACtBC,EAAiBqS,EAAOrS,eAExBkW,EAAsB,sBAErBxc,GAAWyc,gBAAkBC,GAEjCF,EAAsB,qBAEXxc,EAAWyc,gBAAkBE,KAExCH,EAAsB,0BAIvB,IAAII,GAAmB,mBACnBC,EAAmB,yBACnBC,EAAuB,0BAE3B,IAAK9c,EAAWuF,OAAS,CAExB,OAASkC,EAASlC,OAAOjV,SAExB,IAAKsiB,IACL,IAAKmK,IACJH,EAAmB,kBACnB,MAED,KAAKI,IACL,IAAKC,IACJL,EAAmB,qBACnB,MAED,KAAKM,IACL,IAAKC,IACJP,EAAmB,qBACnB,MAED,KAAKQ,IACJR,EAAmB,qBAKrB,OAASnV,EAASlC,OAAOjV,SAExB,IAAKysB,IACL,IAAKI,IACJN,EAAmB,yBAKrB,OAASpV,EAASjC,SAEjB,IAAKC,IACJqX,EAAuB,0BACvB,MAED,KAAKO,IACJP,EAAuB,qBACvB,MAED,KAAKQ,IACJR,EAAuB,uBAO1B,GAcIS,GAAcC,EAddC,EAAsB1V,EAAS2V,YAAc,EAAM3V,EAAS2V,YAAc,EAM1EC,EAAmBvT,EAAaM,SAAW,GAAK2P,GAAoB5S,EAAShB,WAAYzG,EAAYyG,GAErGmX,EAAgB9C,GAAiB3U,GAIjCyL,EAAUxb,EAAGynB,eAiOjB,IA7NKpW,EAASqW,qBAEbP,GAECK,GAEChD,OAAQC,IAAkBpC,KAAM,MAE7B8E,EAAahuB,OAAS,IAE1BguB,GAAgB,MAIjBC,GAECG,EACAC,GAEChD,OAAQC,IAAkBpC,KAAM,MAE7B+E,EAAejuB,OAAS,IAE5BiuB,GAAkB,QAMnBD,GAEC,aAAevd,EAAWsE,UAAY,UACtC,aAAetE,EAAWsE,UAAY,QAEtC,uBAAyBqU,EAAOrnB,KAEhCssB,EAEA5d,EAAW+d,uBAAyB,0BAA4B,GAEhE,wBAA0BN,EAE1B,qBAAuBzd,EAAWge,SAChChe,EAAWie,QAAUje,EAAW0C,IAAQ,kBAAoB,GAC5D1C,EAAWie,QAAUje,EAAWke,OAAW,mBAAqB,GAElEle,EAAWgF,IAAM,kBAAoB,GACrChF,EAAWuF,OAAS,qBAAuB,GAC3CvF,EAAWuF,OAAS,WAAasX,EAAmB,GACpD7c,EAAWiF,SAAW,uBAAyB,GAC/CjF,EAAWmF,MAAQ,oBAAsB,GACzCnF,EAAWme,YAAc,0BAA4B,GACrDne,EAAWya,QAAU,sBAAwB,GAC7Cza,EAAW0a,UAAY,wBAA0B,GAC/C1a,EAAW0a,WAAa1a,EAAW2a,qBAAyB,gCAAkC,GAChG3a,EAAWoe,iBAAmBpe,EAAW+d,uBAAyB,8BAAgC,GAClG/d,EAAWqF,YAAc,0BAA4B,GACrDrF,EAAWqe,aAAe,2BAA6B,GACvDre,EAAWse,aAAe,2BAA6B,GACvDte,EAAWsF,SAAW,uBAAyB,GAC/CtF,EAAWtD,aAAe,oBAAsB,GAEhDsD,EAAWgD,YAAc,sBAAwB,GAEjDhD,EAAWgG,SAAW,uBAAyB,GAC/ChG,EAAWue,iBAAmB,uBAAyB,GAEvDve,EAAW/C,aAAe,2BAA6B,GACvD+C,EAAW9C,cAAgB8C,EAAWgD,eAAgB,EAAQ,2BAA6B,GAC3FhD,EAAWwe,YAAc,uBAAyB,GAClDxe,EAAWye,UAAY,qBAAuB,GAE9Cze,EAAW0e,iBAAmB,wBAA0B,GACxD1e,EAAW0e,iBAAmB,WAAalC,EAAsB,GAEjExc,EAAW2e,gBAAkB,8BAAgC,GAE7D3e,EAAWyL,uBAAyB,0BAA4B,GAChEzL,EAAWyL,yBAA4BrB,EAAaM,UAAYjE,EAAWjO,IAAK,mBAAuB,8BAAgC,GAEvI,4BACA,gCACA,iCACA,2BACA,6BACA,+BAEA,2BACA,yBACA,qBAEA,mBAEA,0BAEA,SAEA,0BAEA,iCACA,iCACA,iCACA,iCAEA,4BAEA,mCACA,mCACA,mCACA,mCAEA,UAEA,mCACA,mCACA,mCACA,mCAEA,WAEA,SAEA,sBAEA,8BACA,+BAEA,SAEA,MAECoiB,OAAQC,IAAkBpC,KAAM;AAElC+E,GAECG,EAEA,aAAe3d,EAAWsE,UAAY,UACtC,aAAetE,EAAWsE,UAAY,QAEtC,uBAAyBqU,EAAOrnB,KAEhCssB,EAEA5d,EAAW2E,UAAY,qBAAuB3E,EAAW2E,WAAc3E,EAAW2E,UAAY,EAAI,GAAK,MAAS,GAEhH,wBAA0B8Y,EAExBzd,EAAWie,QAAUje,EAAW0C,IAAQ,kBAAoB,GAC5D1C,EAAWie,QAAUje,EAAWke,OAAW,mBAAqB,GAElEle,EAAWgF,IAAM,kBAAoB,GACrChF,EAAWuF,OAAS,qBAAuB,GAC3CvF,EAAWuF,OAAS,WAAaqX,EAAmB,GACpD5c,EAAWuF,OAAS,WAAasX,EAAmB,GACpD7c,EAAWuF,OAAS,WAAauX,EAAuB,GACxD9c,EAAWiF,SAAW,uBAAyB,GAC/CjF,EAAWmF,MAAQ,oBAAsB,GACzCnF,EAAWme,YAAc,0BAA4B,GACrDne,EAAWya,QAAU,sBAAwB,GAC7Cza,EAAW0a,UAAY,wBAA0B,GAC/C1a,EAAW0a,WAAa1a,EAAW2a,qBAAyB,gCAAkC,GAChG3a,EAAWqF,YAAc,0BAA4B,GACrDrF,EAAWqe,aAAe,2BAA6B,GACvDre,EAAWse,aAAe,2BAA6B,GACvDte,EAAWsF,SAAW,uBAAyB,GAC/CtF,EAAWtD,aAAe,oBAAsB,GAEhDsD,EAAW4e,YAAc,0BAA4B,GAErD5e,EAAWgD,YAAc,sBAAwB,GAEjDhD,EAAWwe,YAAc,uBAAyB,GAClDxe,EAAWye,UAAY,qBAAuB,GAE9Cze,EAAW0e,iBAAmB,wBAA0B,GACxD1e,EAAW0e,iBAAmB,WAAalC,EAAsB,GAEjExc,EAAW4E,mBAAqB,8BAAgC,GAEhE5E,EAAW6e,wBAA0B,oCAAsC,GAE3E7e,EAAWyL,uBAAyB,0BAA4B,GAChEzL,EAAWyL,yBAA4BrB,EAAaM,UAAYjE,EAAWjO,IAAK,mBAAuB,8BAAgC,GAEvIwH,EAAWuF,SAAY6E,EAAaM,UAAYjE,EAAWjO,IAAK,2BAA+B,0BAA4B,GAE3H,2BACA,+BAEEwH,EAAW+Z,cAAgB+E,GAAkB,uBAAyB,GACtE9e,EAAW+Z,cAAgB+E,GAAkB/C,GAAyC,0BAAI,GAC1F/b,EAAW+Z,cAAgB+E,GAAkBhF,GAAwB,cAAe9Z,EAAW+Z,aAAgB,GAEjH/Z,EAAW0E,UAAY,oBAAsB,GAE3C1E,EAAW+e,gBAAkB/e,EAAWgf,aAAehf,EAAWif,gBAAkBjf,EAAWkf,oBAAwBnD,GAAuC,wBAAI,GACpK/b,EAAWgf,YAActF,GAA0B,mBAAoB1Z,EAAWgf,aAAgB,GAClGhf,EAAWif,eAAiBvF,GAA0B,sBAAuB1Z,EAAWif,gBAAmB,GAC3Gjf,EAAWkf,oBAAsBxF,GAA0B,2BAA4B1Z,EAAWkf,qBAAwB,GAC1Hlf,EAAW+e,eAAiBlF,GAA0B,sBAAuB7Z,EAAW+e,gBAAmB,GAE3G/e,EAAWmf,aAAe,yBAA2B1X,EAAS0X,aAAe,GAE7E,MAECvE,OAAQC,IAAkBpC,KAAM,OAInCpS,EAAewV,GAAexV,GAC9BA,EAAe8U,GAAkB9U,EAAcrG,GAC/CqG,EAAeqV,GAA0BrV,EAAcrG,GAEvDsG,EAAiBuV,GAAevV,GAChCA,EAAiB6U,GAAkB7U,EAAgBtG,GACnDsG,EAAiBoV,GAA0BpV,EAAgBtG,GAE3DqG,EAAe4V,GAAa5V,GAC5BC,EAAiB2V,GAAa3V,GAEzB8D,EAAaM,WAAcjD,EAASqW,oBAAsB,CAE9D,GAAIsB,IAAwB,EAExBC,EAAe,8BAEd5X,GAAS6X,kBAC0B,OAAvCjZ,EAAasR,MAAO0H,IACqB,OAAzC/Y,EAAeqR,MAAO0H,KAEtBD,GAAwB,EAExB/Y,EAAeA,EAAa+U,QAASiE,EAAc,IACnD/Y,EAAiBA,EAAe8U,QAASiE,EAAc,KAKxD9B,GACC,oBACA,uBACA,sBACA,6BACC9E,KAAM,MAAS,KAAO8E,EAExBC,GACC,oBACA,qBACA4B,EAAwB,GAAK,+BAC7BA,EAAwB,GAAK,oCAC7B,uCACA,4BACA,8BACA,oCACA,qCACA,6CACA,uCACA,uCACA,+CACA,0CACC3G,KAAM,MAAS,KAAO+E,EAIzB,GAAI+B,GAAahC,EAAelX,EAC5BmZ,EAAehC,EAAiBlX,EAKhCmZ,EAAiB/G,GAAatiB,EAAIA,EAAG+U,cAAeoU,GACpDG,EAAmBhH,GAAatiB,EAAIA,EAAGiV,gBAAiBmU,EAE5DppB,GAAGupB,aAAc/N,EAAS6N,GAC1BrpB,EAAGupB,aAAc/N,EAAS8N,GAIYzvB,SAAjCwX,EAASR,oBAEb7Q,EAAGwpB,mBAAoBhO,EAAS,EAAGnK,EAASR,qBAEjCjH,EAAW/C,gBAAiB,GAGvC7G,EAAGwpB,mBAAoBhO,EAAS,EAAG,YAIpCxb,EAAGypB,YAAajO,EAEhB,IAAIkO,GAAa1pB,EAAG2pB,kBAAmBnO,GAAUoO,OAC7CC,EAAY7pB,EAAG6iB,iBAAkBwG,GAAiBO,OAClDE,EAAc9pB,EAAG6iB,iBAAkByG,GAAmBM,OAEtDG,GAAW,EACXC,GAAkB,CAKjBhqB,GAAG8hB,oBAAqBtG,EAASxb,EAAGiqB,gBAAkB,GAE1DF,GAAW,EAEX3wB,QAAQC,MAAO,qCAAsC2G,EAAGkqB,WAAY,qBAAsBlqB,EAAG8hB,oBAAqBtG,EAASxb,EAAGmqB,iBAAmB,uBAAwBT,EAAYG,EAAWC,IAEtK,KAAfJ,EAEXtwB,QAAQ4H,KAAM,6CAA8C0oB,GAEnC,KAAdG,GAAoC,KAAhBC,IAE/BE,GAAkB,GAIdA,IAEJjxB,KAAKqxB,aAEJL,SAAUA,EACV1Y,SAAUA,EAEVqY,WAAYA,EAEZzZ,cAECoa,IAAKR,EACLS,OAAQnD,GAITjX,gBAECma,IAAKP,EACLQ,OAAQlD,KAUXpnB,EAAGuqB,aAAclB,GACjBrpB,EAAGuqB,aAAcjB,EAIjB,IAAIkB,EAEJzxB,MAAKijB,YAAc,WAQlB,MANwBniB,UAAnB2wB,IAEJA,EAAiB,GAAI3I,IAAe7hB,EAAIwb,EAAS7J,IAI3C6Y,EAMR,IAAIC,EA0DJ,OAxDA1xB,MAAK2xB,cAAgB,WAQpB,MAN0B7wB,UAArB4wB,IAEJA,EAAmB9F,GAAyB3kB,EAAIwb,IAI1CiP,GAMR1xB,KAAK4xB,QAAU,WAEd3qB,EAAG4qB,cAAepP,GAClBziB,KAAKyiB,QAAU3hB,QAMhBc,OAAOqJ,iBAAkBjL,MAExBiX,UACC5N,IAAK,WAGJ,MADAhJ,SAAQ4H,KAAM,wDACPjI,KAAKijB,gBAKd5S,YACChH,IAAK,WAGJ,MADAhJ,SAAQ4H,KAAM,4DACPjI,KAAK2xB,oBAUf3xB,KAAKmC,KAAOqnB,EAAOrnB,KACnBnC,KAAKogB,GAAK0R,KACV9xB,KAAKotB,KAAOA,EACZptB,KAAK+xB,UAAY,EACjB/xB,KAAKyiB,QAAUA,EACfziB,KAAKkX,aAAeoZ,EACpBtwB,KAAKmX,eAAiBoZ,EAEfvwB,KAQR,QAASgyB,IAAepZ,EAAUtB,EAAY2D,GAmC7C,QAASgX,GAAezR,GAEvB,GAAI0R,GAAW1R,EAAO0R,SAClBC,EAAQD,EAASC,KAErB,IAAKlX,EAAawC,oBAEjB,MAAO,KAWP,IAAI2U,GAAkBnX,EAAagC,kBAC/BoV,EAAkB1f,KAAKC,OAASwf,EAAkB,IAAO,GAEzDvD,EAAWlc,KAAK9N,IAAKwtB,EAAiBF,EAAM/xB,OAEhD,OAAKyuB,GAAWsD,EAAM/xB,QAErBC,QAAQ4H,KAAM,qCAAuCkqB,EAAM/xB,OAAS,6BAA+ByuB,EAAW,KACvG,GAIDA,EAMT,QAASyD,GAA2Bzc,EAAK0c,GAExC,GAAI5wB,EAwBJ,OAtBOkU,GAIKA,EAAIyE,UAEf3Y,EAAWkU,EAAIlU,SAEJkU,EAAI2c,sBAEfnyB,QAAQ4H,KAAM,6HACdtG,EAAWkU,EAAI5R,QAAQtC,UATvBA,EAAW2B,GAcP3B,IAAa2B,IAAkBivB,IAEnC5wB,EAAW0oB,IAIL1oB,EA/FR,GAAIygB,MAEAqQ,GACHC,kBAAmB,QACnBC,qBAAsB,eACtBC,mBAAoB,SACpBhd,kBAAmB,QACnBid,oBAAqB,UACrBC,kBAAmB,QACnBC,iBAAkB,QAClBC,qBAAsB,WACtBC,qBAAsB,WACtBC,kBAAmB,QACnBC,mBAAoB,SACpBC,eAAgB,SAChBC,eAAgB,SAChBC,eAAgB,UAGbC,GACH,YAAa,yBAA0B,MAAO,cAAe,SAAU,aAAc,iBACrF,WAAY,QAAS,cAAe,sBAAuB,UAAW,YAAa,uBAAwB,kBAAmB,cAC9H,eAAgB,eAAgB,cAChC,WAAY,UAAW,eAAgB,MAAO,SAAU,SACxD,cAAe,kBAAmB,yBAA0B,WAC5D,WAAY,mBAAoB,eAAgB,eAChD,kBAAmB,kBAAmB,qBACtC,eAAgB,iBAAkB,gBAAiB,gBAAiB,oBACpE,mBAAoB,gBAAiB,cAAe,0BACpD,YAAa,cAAe,YAAa,oBAAqB,sBAAuB,eAAgB,YAsEtGvzB,MAAKwzB,cAAgB,SAAWlb,EAAU9E,EAAQigB,EAASlgB,EAAKmgB,EAAaC,EAAmBnT,GAE/F,GAAIoT,GAAWnB,EAAWna,EAAS7W,MAK/BotB,EAAWrO,EAAOqT,cAAgB5B,EAAezR,GAAW,EAC5DrL,EAAY8F,EAAa9F,SAED,QAAvBmD,EAASnD,YAEbA,EAAY8F,EAAaa,gBAAiBxD,EAASnD,WAE9CA,IAAcmD,EAASnD,WAE3B9U,QAAQ4H,KAAM,oCAAqCqQ,EAASnD,UAAW,uBAAwBA,EAAW,YAM5G,IAAI2e,GAAsBlb,EAASmb,kBAE/BljB,GAEH+iB,SAAUA,EAEVze,UAAWA,EACXyZ,uBAAwB3T,EAAasC,eACrCqS,eAAgB0C,EAA+BwB,EAA+BA,EAAoB7vB,QAA3B,KAAoC2U,EAASob,aACpHne,MAAQyC,EAASzC,IACjBga,YAAayC,EAA2Bha,EAASzC,IAAK+C,EAASqb,YAC/D7d,SAAWkC,EAASlC,OACpB8d,WAAY5b,EAASlC,QAAUkC,EAASlC,OAAOjV,QAC/C2uB,eAAgBwC,EAA2Bha,EAASlC,OAAQwC,EAASqb,YACrE5I,eAAmB/S,EAASlC,SAAgBkC,EAASlC,OAAOjV,UAAY0sB,IAA+BvV,EAASlC,OAAOjV,UAAY2sB,IACnIhY,WAAawC,EAASxC,SACtBE,QAAUsC,EAAStC,MACnBgZ,cAAgB1W,EAAS0W,YACzBe,oBAAqBuC,EAA2Bha,EAAS0W,YAAapW,EAASqb,YAC/E3I,UAAYhT,EAASgT,QACrBC,YAAcjT,EAASiT,UACvBC,qBAAsBlT,EAAS6b,gBAAkBC,GACjDnF,kBAAoB3W,EAAS2W,gBAC7BC,eAAiB5W,EAAS4W,aAC1BC,eAAiB7W,EAAS6W,aAC1BjZ,cAAgBoC,EAASpC,YACzBC,WAAamC,EAASnC,SAEtBsZ,cAAgBnX,EAASmX,YAEzBpZ,QAASiC,EAASjC,QAElB9I,aAAc+K,EAAS/K,aAEvBgG,MAAQA,EACRub,OAAQxW,EAAS/E,IACjBwb,OAAUxb,GAAOA,EAAI8gB,UAErBxgB,YAAayE,EAASzE,YAEtB2b,gBAAiBlX,EAASkX,gBAC1BlT,uBAAwBrB,EAAaqB,uBAErCzF,SAAUyB,EAASzB,UAAYgY,EAAW,EAC1CA,SAAUA,EACVO,iBAAkBnU,EAAawC,oBAE/B3P,aAAcwK,EAASxK,aACvBC,aAAcuK,EAASvK,aACvBumB,gBAAiB1b,EAAS0b,gBAC1BC,gBAAiB3b,EAAS2b,gBAE1BrI,aAAc1Y,EAAOghB,YAAYp0B,OACjCisB,eAAgB7Y,EAAOihB,MAAMr0B,OAC7B+rB,cAAe3Y,EAAOkhB,KAAKt0B,OAC3BgsB,kBAAmB5Y,EAAOmhB,SAASv0B,OACnCksB,cAAe9Y,EAAOohB,KAAKx0B,OAE3BosB,kBAAmBkH,EACnBjH,oBAAqBkH,EAErBpe,UAAW+C,EAAS/C,UAEpBga,iBAAkB3W,EAASic,UAAU1V,SAAWqB,EAAO7U,eAAiB8nB,EAAQrzB,OAAS,EACzFktB,cAAe1U,EAASic,UAAUpzB,KAElCmpB,YAAahS,EAASgS,YACtB8E,wBAAyB9W,EAAS8W,wBAElCja,mBAAoB6C,EAAS7C,mBAE7BD,UAAW8C,EAAS9C,UACpB6Z,YAAa/W,EAAS3E,OAASmhB,GAC/BxF,UAAWhX,EAAS3E,OAASsG,GAE7B+V,aAA0ClvB,SAA1BwX,EAAS0X,cAA+B1X,EAAS0X,aAIlE,OAAOnf,IAIR7Q,KAAK+0B,eAAiB,SAAWzc,EAAUzH,GAE1C,GAAIxJ,KAaJ,IAXKwJ,EAAW+iB,SAEfvsB,EAAM+K,KAAMvB,EAAW+iB,WAIvBvsB,EAAM+K,KAAMkG,EAASnB,gBACrB9P,EAAM+K,KAAMkG,EAASpB,eAIIpW,SAArBwX,EAAStB,QAEb,IAAM,GAAI7U,KAAQmW,GAAStB,QAE1B3P,EAAM+K,KAAMjQ,GACZkF,EAAM+K,KAAMkG,EAAStB,QAAS7U,GAMhC,KAAM,GAAI6N,GAAI,EAAGA,EAAIujB,EAAenzB,OAAQ4P,IAE3C3I,EAAM+K,KAAMvB,EAAY0iB,EAAgBvjB,IAQzC,OAJA3I,GAAM+K,KAAMkG,EAAS0c,gBAAgBC,YAErC5tB,EAAM+K,KAAMwG,EAASob,aAEd3sB,EAAMiiB,QAIdtpB,KAAKk1B,eAAiB,SAAW5c,EAAUkR,EAAQ3Y,EAAYuc,GAK9D,IAAM,GAHF3K,GAGM0S,EAAI,EAAGC,EAAKhT,EAAShiB,OAAQ+0B,EAAIC,EAAID,IAAO,CAErD,GAAIE,GAAcjT,EAAU+S,EAE5B,IAAKE,EAAYjI,OAASA,EAAO,CAEhC3K,EAAU4S,IACP5S,EAAQsP,SAEX,QAaF,MAPiBjxB,UAAZ2hB,IAEJA,EAAU,GAAI0K,IAAcvU,EAAUtB,EAAY8V,EAAM9U,EAAUkR,EAAQ3Y,EAAYoK,GACtFmH,EAAShQ,KAAMqQ,IAITA,GAIRziB,KAAKs1B,eAAiB,SAAW7S,GAEhC,GAA8B,MAAtBA,EAAQsP,UAAkB,CAGjC,GAAI/hB,GAAIoS,EAASmT,QAAS9S,EAC1BL,GAAUpS,GAAMoS,EAAUA,EAAShiB,OAAS,GAC5CgiB,EAASoT,MAGT/S,EAAQmP,YAOV5xB,KAAKoiB,SAAWA,EAQjB,QAASqT,MAIR,QAASpsB,GAAKmX,GAEb,GAAI3K,GAAM6f,EAAWrsB,IAAKmX,EAS1B,OAPa1f,UAAR+U,IAEJA,KACA6f,EAAWzvB,IAAKua,EAAQ3K,IAIlBA,EAIR,QAASrM,GAAQgX,GAEhBkV,EAAAA,UAAmBlV,GAIpB,QAAS9W,GAAQ8W,EAAQmV,EAAK7zB,GAE7B4zB,EAAWrsB,IAAKmX,GAAUmV,GAAQ7zB,EAInC,QAASwhB,KAERoS,EAAa,GAAI/rB,SA/BlB,GAAI+rB,GAAa,GAAI/rB,QAmCrB,QACCN,IAAKA,EACLG,OAAQA,EACRE,OAAQA,EACR4Z,QAASA,GASX,QAASsS,IAAmB9oB,EAAG9G,GAE9B,MAAK8G,GAAEjB,cAAgB7F,EAAE6F,YAEjBiB,EAAEjB,YAAc7F,EAAE6F,YAEdiB,EAAE2V,SAAWzc,EAAEyc,SAAW3V,EAAE2V,UAAYzc,EAAEyc,QAE9C3V,EAAE2V,QAAQrC,GAAKpa,EAAEyc,QAAQrC,GAErBtT,EAAEwL,SAAS8H,KAAOpa,EAAEsS,SAAS8H,GAEjCtT,EAAEwL,SAAS8H,GAAKpa,EAAEsS,SAAS8H,GAEvBtT,EAAEtM,IAAMwF,EAAExF,EAEdsM,EAAEtM,EAAIwF,EAAExF,EAIRsM,EAAEsT,GAAKpa,EAAEoa,GAMlB,QAASyV,IAA0B/oB,EAAG9G,GAErC,MAAK8G,GAAEjB,cAAgB7F,EAAE6F,YAEjBiB,EAAEjB,YAAc7F,EAAE6F,YAEnBiB,EAAEtM,IAAMwF,EAAExF,EAETwF,EAAExF,EAAIsM,EAAEtM,EAIRsM,EAAEsT,GAAKpa,EAAEoa,GAOlB,QAAS0V,MAQR,QAAS7W,KAER8W,EAAmB,EAEnBC,EAAO51B,OAAS,EAChB4T,EAAY5T,OAAS,EAItB,QAASgS,GAAMoO,EAAQnI,EAAUC,EAAU9X,EAAGy1B,GAE7C,GAAIC,GAAaC,EAAaJ,EAEVj1B,UAAfo1B,GAEJA,GACC9V,GAAII,EAAOJ,GACXI,OAAQA,EACRnI,SAAUA,EACVC,SAAUA,EACVmK,QAASnK,EAASmK,QAClB5W,YAAa2U,EAAO3U,YACpBrL,EAAGA,EACHy1B,MAAOA,GAGRE,EAAaJ,GAAqBG,IAIlCA,EAAW9V,GAAKI,EAAOJ,GACvB8V,EAAW1V,OAASA,EACpB0V,EAAW7d,SAAWA,EACtB6d,EAAW5d,SAAWA,EACtB4d,EAAWzT,QAAUnK,EAASmK,QAC9ByT,EAAWrqB,YAAc2U,EAAO3U,YAChCqqB,EAAW11B,EAAIA,EACf01B,EAAWD,MAAQA,IAKlB3d,EAAStE,eAAgB,EAAOA,EAAcgiB,GAAS5jB,KAAM8jB,GAE/DH,IAID,QAAShT,KAEHiT,EAAO51B,OAAS,GAAI41B,EAAOjT,KAAM6S,IACjC5hB,EAAY5T,OAAS,GAAI4T,EAAY+O,KAAM8S,IAzDjD,GAAIM,MACAJ,EAAmB,EAEnBC,KACAhiB,IAyDJ,QACCgiB,OAAQA,EACRhiB,YAAaA,EAEbiL,KAAMA,EACN7M,KAAMA,EAEN2Q,KAAMA,GAKR,QAASqT,MAIR,QAAS/sB,GAAK4P,EAAOC,GAEpB,GAAImd,GAAOpd,EAAMmH,GAAK,IAAMlH,EAAOkH,GAC/BkW,EAAOC,EAAOF,EAWlB,OATcv1B,UAATw1B,IAIJA,EAAO,GAAIR,IACXS,EAAOF,GAASC,GAIVA,EAIR,QAAShT,KAERiT,KAtBD,GAAIA,KA0BJ,QACCltB,IAAKA,EACLia,QAASA,GASX,QAASkT,MAER,GAAIhjB,KAEJ,QAECnK,IAAK,SAAWotB,GAEf,GAA4B31B,SAAvB0S,EAAQijB,EAAMrW,IAElB,MAAO5M,GAAQijB,EAAMrW,GAItB,IAAInJ,EAEJ,QAASwf,EAAMh1B,MAEd,IAAK,mBACJwV,GACCiB,UAAW,GAAInX,GACfiM,MAAO,GAAInH,GAEX6wB,QAAQ,EACRC,WAAY,EACZC,aAAc,EACdC,cAAe,GAAIh3B,GAEpB,MAED,KAAK,YACJoX,GACCnM,SAAU,GAAI/J,GACdmX,UAAW,GAAInX,GACfiM,MAAO,GAAInH,GACXixB,SAAU,EACVC,QAAS,EACTC,YAAa,EACbC,MAAO,EAEPP,QAAQ,EACRC,WAAY,EACZC,aAAc,EACdC,cAAe,GAAIh3B,GAEpB,MAED,KAAK,aACJoX,GACCnM,SAAU,GAAI/J,GACdiM,MAAO,GAAInH,GACXixB,SAAU,EACVG,MAAO,EAEPP,QAAQ,EACRC,WAAY,EACZC,aAAc,EACdC,cAAe,GAAIh3B,GACnBq3B,iBAAkB,EAClBC,gBAAiB,IAElB,MAED,KAAK,kBACJlgB,GACCiB,UAAW,GAAInX,GACfq2B,SAAU,GAAIvxB,GACdwxB,YAAa,GAAIxxB,GAElB,MAED,KAAK,gBACJoR,GACCjK,MAAO,GAAInH,GACXiF,SAAU,GAAI/J,GACdu2B,UAAW,GAAIv2B,GACfw2B,WAAY,GAAIx2B,IASnB,MAFAyS,GAAQijB,EAAMrW,IAAOnJ,EAEdA,IAUV,QAASugB,MAqCR,QAASC,GAAOjkB,EAAQigB,EAASva,GAYhC,IAAM,GAVFpT,GAAI,EAAGC,EAAI,EAAGC,EAAI,EAElB0xB,EAAoB,EACpBC,EAAc,EACdC,EAAa,EACbC,EAAiB,EACjBC,EAAa,EAEbvZ,EAAarF,EAAOlN,mBAEdgE,EAAI,EAAGC,EAAIuD,EAAOpT,OAAQ4P,EAAIC,EAAGD,IAAO,CAEjD,GAAIymB,GAAQjjB,EAAQxD,GAEhBhD,EAAQypB,EAAMzpB,MACd+qB,EAAYtB,EAAMsB,UAClBjB,EAAWL,EAAMK,SAEjBjC,EAAc4B,EAAMC,QAAUD,EAAMC,OAAO7gB,IAAQ4gB,EAAMC,OAAO7gB,IAAI5R,QAAU,IAElF,IAAKwyB,EAAMuB,eAEVlyB,GAAKkH,EAAMlH,EAAIiyB,EACfhyB,GAAKiH,EAAMjH,EAAIgyB,EACf/xB,GAAKgH,EAAMhH,EAAI+xB,MAET,IAAKtB,EAAMwB,mBAAqB,CAEtC,GAAIhhB,GAAWsI,EAAMlW,IAAKotB,EAU1B,IARAxf,EAASjK,MAAM4R,KAAM6X,EAAMzpB,OAAQkrB,eAAgBzB,EAAMsB,WACzD9gB,EAASiB,UAAUigB,sBAAuB1B,EAAMprB,aAChD+sB,EAAQD,sBAAuB1B,EAAMxW,OAAO5U,aAC5C4L,EAASiB,UAAUmgB,IAAKD,GACxBnhB,EAASiB,UAAUogB,mBAAoB/Z,GAEvCtH,EAASyf,OAASD,EAAM/qB,WAEnB+qB,EAAM/qB,WAAa,CAEvB,GAAIgrB,GAASD,EAAMC,MAEnBzf,GAAS0f,WAAaD,EAAO6B,KAC7BthB,EAAS2f,aAAeF,EAAOzxB,OAC/BgS,EAAS4f,cAAgBH,EAAO8B,QAIjC3f,EAAM4f,qBAAsBf,GAAsB7C,EAClDhc,EAAM6f,wBAAyBhB,GAAsBjB,EAAMC,OAAOzzB,OAClE4V,EAAM2b,YAAakD,GAAsBzgB,EAEzCygB,QAEM,IAAKjB,EAAMkC,YAAc,CAE/B,GAAI1hB,GAAWsI,EAAMlW,IAAKotB,EAmB1B,IAjBAxf,EAASnM,SAASqtB,sBAAuB1B,EAAMprB,aAC/C4L,EAASnM,SAAS+T,aAAcN,GAEhCtH,EAASjK,MAAM4R,KAAM5R,GAAQkrB,eAAgBH,GAC7C9gB,EAAS6f,SAAWA,EAEpB7f,EAASiB,UAAUigB,sBAAuB1B,EAAMprB,aAChD+sB,EAAQD,sBAAuB1B,EAAMxW,OAAO5U,aAC5C4L,EAASiB,UAAUmgB,IAAKD,GACxBnhB,EAASiB,UAAUogB,mBAAoB/Z,GAEvCtH,EAAS8f,QAAUpkB,KAAKimB,IAAKnC,EAAMoC,OACnC5hB,EAAS+f,YAAcrkB,KAAKimB,IAAKnC,EAAMoC,OAAU,EAAIpC,EAAMqC,WAC3D7hB,EAASggB,MAA6B,IAAnBR,EAAMK,SAAmB,EAAML,EAAMQ,MAExDhgB,EAASyf,OAASD,EAAM/qB,WAEnB+qB,EAAM/qB,WAAa,CAEvB,GAAIgrB,GAASD,EAAMC,MAEnBzf,GAAS0f,WAAaD,EAAO6B,KAC7BthB,EAAS2f,aAAeF,EAAOzxB,OAC/BgS,EAAS4f,cAAgBH,EAAO8B,QAIjC3f,EAAMkgB,cAAenB,GAAe/C,EACpChc,EAAMmgB,iBAAkBpB,GAAenB,EAAMC,OAAOzzB,OACpD4V,EAAM6b,KAAMkD,GAAe3gB,EAE3B2gB,QAEM,IAAKnB,EAAMwC,gBAAkB,CAEnC,GAAIhiB,GAAWsI,EAAMlW,IAAKotB,EAM1Bxf,GAASjK,MAAM4R,KAAM5R,GAAQkrB,eAAgBH,GAE7C9gB,EAASnM,SAASqtB,sBAAuB1B,EAAMprB,aAC/C4L,EAASnM,SAAS+T,aAAcN,GAGhC2a,EAASC,WACTC,EAAQxa,KAAM6X,EAAMprB,aACpB+tB,EAAQC,YAAa9a,GACrB2a,EAASI,gBAAiBF,GAE1BniB,EAASqgB,UAAUrxB,IAAmB,GAAdwwB,EAAM9yB,MAAa,EAAK,GAChDsT,EAASsgB,WAAWtxB,IAAK,EAAoB,GAAfwwB,EAAM7yB,OAAc,GAElDqT,EAASqgB,UAAUzY,aAAcqa,GACjCjiB,EAASsgB,WAAW1Y,aAAcqa,GAKlCrgB,EAAM8b,SAAUkD,GAAmB5gB,EAEnC4gB,QAEM,IAAKpB,EAAM8C,aAAe,CAEhC,GAAItiB,GAAWsI,EAAMlW,IAAKotB,EAW1B,IATAxf,EAASnM,SAASqtB,sBAAuB1B,EAAMprB,aAC/C4L,EAASnM,SAAS+T,aAAcN,GAEhCtH,EAASjK,MAAM4R,KAAM6X,EAAMzpB,OAAQkrB,eAAgBzB,EAAMsB,WACzD9gB,EAAS6f,SAAWL,EAAMK,SAC1B7f,EAASggB,MAA6B,IAAnBR,EAAMK,SAAmB,EAAML,EAAMQ,MAExDhgB,EAASyf,OAASD,EAAM/qB,WAEnB+qB,EAAM/qB,WAAa,CAEvB,GAAIgrB,GAASD,EAAMC,MAEnBzf,GAAS0f,WAAaD,EAAO6B,KAC7BthB,EAAS2f,aAAeF,EAAOzxB,OAC/BgS,EAAS4f,cAAgBH,EAAO8B,QAChCvhB,EAASigB,iBAAmBR,EAAOxd,OAAO1M,KAC1CyK,EAASkgB,gBAAkBT,EAAOxd,OAAOzM,IAI1CoM,EAAM2gB,eAAgB7B,GAAgB9C,EACtChc,EAAM4gB,kBAAmB9B,GAAgBlB,EAAMC,OAAOzzB,OACtD4V,EAAM4b,MAAOkD,GAAgB1gB,EAE7B0gB,QAEM,IAAKlB,EAAMiD,kBAAoB,CAErC,GAAIziB,GAAWsI,EAAMlW,IAAKotB,EAE1Bxf,GAASiB,UAAUigB,sBAAuB1B,EAAMprB,aAChD4L,EAASiB,UAAUogB,mBAAoB/Z,GACvCtH,EAASiB,UAAUyhB,YAEnB1iB,EAASmgB,SAASxY,KAAM6X,EAAMzpB,OAAQkrB,eAAgBH,GACtD9gB,EAASogB,YAAYzY,KAAM6X,EAAMY,aAAca,eAAgBH,GAE/Dlf,EAAM+b,KAAMkD,GAAe7gB,EAE3B6gB,KAMFjf,EAAM+gB,QAAS,GAAM9zB,EACrB+S,EAAM+gB,QAAS,GAAM7zB,EACrB8S,EAAM+gB,QAAS,GAAM5zB,EAErB6S,EAAM2b,YAAYp0B,OAASs3B,EAC3B7e,EAAM6b,KAAKt0B,OAASw3B,EACpB/e,EAAM8b,SAASv0B,OAASy3B,EACxBhf,EAAM4b,MAAMr0B,OAASu3B,EACrB9e,EAAM+b,KAAKx0B,OAAS03B,EAEpBjf,EAAMwd,KAAKwD,QAAUhhB,EAAMuH,GAC3BvH,EAAMwd,KAAKqB,kBAAoBA,EAC/B7e,EAAMwd,KAAKsB,YAAcA,EACzB9e,EAAMwd,KAAKuB,WAAaA,EACxB/e,EAAMwd,KAAKwB,eAAiBA,EAC5Bhf,EAAMwd,KAAKyB,WAAaA,EACxBjf,EAAMwd,KAAKyD,cAAgBrG,EAAQrzB,OAlOpC,GAAImf,GAAQ,GAAIiX,IAEZ3d,GAEHuH,GAAIlX,KAEJmtB,MACCwD,WACAnC,qBACAC,eACAC,cACAC,kBACAC,cACAgC,kBAGDF,SAAW,EAAG,EAAG,GACjBpF,eACAiE,wBACAC,2BACAhE,QACAqE,iBACAC,oBACArE,YACAF,SACA+E,kBACAC,qBACA7E,SAIGwD,EAAU,GAAIr3B,GACdq4B,EAAU,GAAIn5B,GACdi5B,EAAW,GAAIj5B,EAqMnB,QACCw3B,MAAOA,EACP5e,MAAOA,GAST,QAASkhB,MAOR,QAAS9a,KAER+a,EAAY55B,OAAS,EACrB65B,EAAa75B,OAAS,EAIvB,QAAS85B,GAAWzD,GAEnBuD,EAAY5nB,KAAMqkB,GAInB,QAAS0D,GAAYC,GAEpBH,EAAa7nB,KAAMgoB,GAIpB,QAASC,GAAanhB,GAErB1F,EAAOikB,MAAOuC,EAAaC,EAAc/gB,GA1B1C,GAAI1F,GAAS,GAAIgkB,IAEbwC,KACAC,KA2BAphB,GACHmhB,YAAaA,EACbC,aAAcA,EAEdzmB,OAAQA,EAGT,QACCyL,KAAMA,EACNpG,MAAOA,EACPwhB,YAAaA,EAEbH,UAAWA,EACXC,WAAYA,GAKd,QAASG,MAIR,QAASjxB,GAAK4P,EAAOC,GAEpB,GAAIqhB,EAuBJ,OArBkCz5B,UAA7B05B,EAAcvhB,EAAMmH,KAExBma,EAAc,GAAIR,IAClBS,EAAcvhB,EAAMmH,OACpBoa,EAAcvhB,EAAMmH,IAAMlH,EAAOkH,IAAOma,GAIOz5B,SAA1C05B,EAAcvhB,EAAMmH,IAAMlH,EAAOkH,KAErCma,EAAc,GAAIR,IAClBS,EAAcvhB,EAAMmH,IAAMlH,EAAOkH,IAAOma,GAIxCA,EAAcC,EAAcvhB,EAAMmH,IAAMlH,EAAOkH,IAM1Cma,EAIR,QAASjX,KAERkX,KAjCD,GAAIA,KAqCJ,QACCnxB,IAAKA,EACLia,QAASA,GA4BX,QAASoP,IAAmB7hB,GAE3BwC,EAAS/O,KAAMtE,MAEfA,KAAKyB,KAAO,oBAEZzB,KAAKgwB,aAAeyK,GAEpBz6B,KAAK6W,UAAW,EAChB7W,KAAK8N,cAAe,EAEpB9N,KAAK6V,IAAM,KAEX7V,KAAKmW,SAAW,KAEhBnW,KAAKivB,gBAAkB,KACvBjvB,KAAK06B,kBAAoB,EACzB16B,KAAK26B,iBAAmB,EAExB36B,KAAKyW,WAAY,EACjBzW,KAAK0W,mBAAqB,EAE1B1W,KAAKuT,KAAM,EACXvT,KAAKwT,QAAS,EAEdxT,KAAK8W,UAAWjG,GAwDjB,QAAS8hB,IAAsB9hB,GAE9BwC,EAAS/O,KAAMtE,MAEfA,KAAKyB,KAAO,uBAEZzB,KAAK46B,kBAAoB,GAAI75B,GAC7Bf,KAAK66B,aAAe,EACpB76B,KAAK86B,YAAc,IAEnB96B,KAAK6W,UAAW,EAChB7W,KAAK8N,cAAe,EAEpB9N,KAAK6V,IAAM,KAEX7V,KAAKmW,SAAW,KAEhBnW,KAAKivB,gBAAkB,KACvBjvB,KAAK06B,kBAAoB,EACzB16B,KAAK26B,iBAAmB,EAExB36B,KAAKuT,KAAM,EACXvT,KAAKwT,QAAS,EAEdxT,KAAK8W,UAAWjG,GAqCjB,QAASkqB,IAAgBC,EAAWC,EAAUte,GAuP7C,QAASue,GAAkB1a,EAAQlI,EAAUihB,EAAc4B,EAAoBjE,EAAkBC,GAEhG,GAAI9e,GAAWmI,EAAOnI,SAElB+iB,EAAS,KAETC,EAAmBC,EACnBC,EAAiB/a,EAAOgb,mBAS5B,IAPKjC,IAEJ8B,EAAmBI,EACnBF,EAAiB/a,EAAOkb,wBAIlBH,EAmCNH,EAASG,MAnCc,CAEvB,GAAII,IAAc,CAEbrjB,GAASxK,eAERuK,GAAYA,EAASqI,iBAEzBib,EAActjB,EAAS/H,iBAAmB+H,EAAS/H,gBAAgBxF,UAAYuN,EAAS/H,gBAAgBxF,SAAS1K,OAAS,EAE/GiY,GAAYA,EAASsI,aAEhCgb,EAActjB,EAASvK,cAAgBuK,EAASvK,aAAa1N,OAAS,IAMnEogB,EAAOqT,eAAiBvb,EAASzB,YAAa,GAElDxW,QAAQ4H,KAAM,+EAAgFuY,EAI/F,IAAIob,GAAcpb,EAAOqT,eAAiBvb,EAASzB,SAE/CglB,EAAe,CAEdF,KAAcE,GAAgBC,GAC9BF,IAAcC,GAAgBE,GAEnCX,EAASC,EAAkBQ,GAQ5B,GAAKb,EAAUjc,sBACbzG,EAAStD,eAAgB,GACU,IAAnCsD,EAASxD,eAAe1U,OAAe,CAKxC,GAAI47B,GAAOZ,EAAOp5B,KAAMi6B,EAAO3jB,EAAStW,KAEpCk6B,EAAsBC,EAAgBH,EAEbl7B,UAAxBo7B,IAEJA,KACAC,EAAgBH,GAASE,EAI1B,IAAIE,GAAiBF,EAAqBD,EAElBn7B,UAAnBs7B,IAEJA,EAAiBhB,EAAOvwB,QACxBqxB,EAAqBD,GAASG,GAI/BhB,EAASgB,EAwBV,MApBAhB,GAAO3vB,QAAU6M,EAAS7M,QAC1B2vB,EAAO3kB,UAAY6B,EAAS7B,UAE5B2kB,EAAOznB,KAAgC,MAAvB2E,EAASrD,WAAuBqD,EAASrD,WAAaA,EAAYqD,EAAS3E,MAE3FynB,EAAOpmB,YAAcsD,EAAStD,YAC9BomB,EAAOtmB,eAAiBwD,EAASxD,eACjCsmB,EAAOrmB,iBAAmBuD,EAASvD,iBAEnCqmB,EAAO1kB,mBAAqB4B,EAAS5B,mBACrC0kB,EAAOhkB,UAAYkB,EAASlB,UAEvBmiB,GAAgB6B,EAAOiB,yBAE3BjB,EAAOR,kBAAkBhc,KAAMuc,GAC/BC,EAAOP,aAAe3D,EACtBkE,EAAON,YAAc3D,GAIfiE,EAIR,QAASkB,GAAc9b,EAAQtH,EAAQqjB,EAAchD,GAEpD,GAAK/Y,EAAO/U,WAAY,EAAxB,CAEA,GAAIA,GAAU+U,EAAOhV,OAAOgxB,KAAMtjB,EAAO1N,OAEzC,IAAKC,IAAa+U,EAAOic,QAAUjc,EAAOkc,QAAUlc,EAAOmc,WAErDnc,EAAO9U,cAAkB8U,EAAO5U,eAAiBgxB,EAASC,iBAAkBrc,IAAa,CAE7FA,EAAOrV,gBAAgB2xB,iBAAkBP,EAAavwB,mBAAoBwU,EAAOnV,YAEjF,IAAIgN,GAAW4iB,EAASvxB,OAAQ8W,GAC5BlI,EAAWkI,EAAOlI,QAEtB,IAAKlL,MAAMC,QAASiL,GAInB,IAAM,GAFFxI,GAASuI,EAASvI,OAEZitB,EAAI,EAAGC,EAAKltB,EAAO1P,OAAQ28B,EAAIC,EAAID,IAAO,CAEnD,GAAI9G,GAAQnmB,EAAQitB,GAChBE,EAAgB3kB,EAAU2d,EAAMhpB,cAEpC,IAAKgwB,GAAiBA,EAAcxxB,QAAU,CAE7C,GAAIyxB,GAAgBhC,EAAkB1a,EAAQyc,EAAe1D,EAAc4D,EAAqBZ,EAAa/vB,KAAM+vB,EAAa9vB,IAChIuuB,GAAUvgB,mBAAoB8hB,EAAc,KAAMlkB,EAAU6kB,EAAe1c,EAAQyV,QAM/E,IAAK3d,EAAS7M,QAAU,CAE9B,GAAIyxB,GAAgBhC,EAAkB1a,EAAQlI,EAAUihB,EAAc4D,EAAqBZ,EAAa/vB,KAAM+vB,EAAa9vB,IAC3HuuB,GAAUvgB,mBAAoB8hB,EAAc,KAAMlkB,EAAU6kB,EAAe1c,EAAQ,OAUtF,IAAM,GAFF9V,GAAW8V,EAAO9V,SAEZsF,EAAI,EAAGC,EAAIvF,EAAStK,OAAQ4P,EAAIC,EAAGD,IAE5CssB,EAAc5xB,EAAUsF,GAAKkJ,EAAQqjB,EAAchD,IA7WrD,IAAM,GAtCFqD,GAAW,GAAIv3B,GAClB+3B,EAAoB,GAAIn9B,GAExBo9B,EAAiB,GAAIx9B,GACrBy9B,EAAoB,GAAIz9B,GAAS8c,EAAgBA,GAEjD4gB,EAAc,GAAIx8B,GAClBo8B,EAAsB,GAAIp8B,GAE1B+6B,EAAgB,EAChBC,EAAgB,EAEhByB,GAA8B1B,EAAgBC,GAAkB,EAEhET,EAAkB,GAAIluB,OAAOowB,GAC7B/B,EAAqB,GAAIruB,OAAOowB,GAEhCrB,KAEGlnB,GAAewoB,EAAGxjB,GAAUyjB,EAAG9pB,GAAW+pB,EAAG7I,IAE7C8I,GACH,GAAI78B,GAAS,EAAG,EAAG,GAAK,GAAIA,QAAc,EAAG,GAAK,GAAIA,GAAS,EAAG,EAAG,GACrE,GAAIA,GAAS,EAAG,QAAU,GAAIA,GAAS,EAAG,EAAG,GAAK,GAAIA,GAAS,OAAQ,IAGpE88B,GACH,GAAI98B,GAAS,EAAG,EAAG,GAAK,GAAIA,GAAS,EAAG,EAAG,GAAK,GAAIA,GAAS,EAAG,EAAG,GACnE,GAAIA,GAAS,EAAG,EAAG,GAAK,GAAIA,GAAS,EAAG,EAAG,GAAK,GAAIA,GAAS,EAAG,SAG7D+8B,GACH,GAAIr6B,GAAW,GAAIA,GAAW,GAAIA,GAClC,GAAIA,GAAW,GAAIA,GAAW,GAAIA,IAKzBuM,EAAI,EAAGA,IAAMwtB,IAA8BxtB,EAAI,CAExD,GAAI2rB,GAAwC,KAAxB3rB,EAAI8rB,GACpBF,EAAwC,KAAxB5rB,EAAI+rB,GAEpBmB,EAAgB,GAAIxK,KAEvB1C,aAAc+N,GAEdjwB,aAAc6tB,EACd9kB,SAAU+kB,GAIXN,GAAiBtrB,GAAMktB,CAIvB,IAAIc,GAAmB,GAAIrL,KAE1B7kB,aAAc6tB,EACd9kB,SAAU+kB,GAIXH,GAAoBzrB,GAAMguB,EAM3B,GAAIxrB,GAAQxS,IAEZA,MAAKmf,SAAU,EAEfnf,KAAKi+B,YAAa,EAClBj+B,KAAK2V,aAAc,EAEnB3V,KAAKyB,KAAO8rB,GAEZvtB,KAAK+Y,OAAS,SAAWvF,EAAQyF,EAAOC,GAEvC,GAAK1G,EAAM2M,WAAY,IAClB3M,EAAMyrB,cAAe,GAASzrB,EAAMmD,eAAgB,IAElC,IAAlBnC,EAAOpT,OAAZ,CAGA,GAAI89B,GAAMlD,EAAUv0B,QAChB03B,EAASnD,EAAUniB,KAGvBslB,GAAOC,QAASF,EAAIG,OACpBF,EAAO50B,QAAQyD,MAAMqM,SAAU,EAAG,EAAG,EAAG,GACxC8kB,EAAO50B,QAAQkH,MAAM6tB,SAAS,GAC9BH,EAAOI,gBAAgB,EAMvB,KAAM,GAFFC,GAEMxuB,EAAI,EAAGyuB,EAAKjrB,EAAOpT,OAAQ4P,EAAIyuB,EAAIzuB,IAAO,CAEnD,GAAIymB,GAAQjjB,EAAQxD,GAChB0mB,EAASD,EAAMC,OACf6C,EAAe9C,GAASA,EAAM8C,YAElC,IAAgBz4B,SAAX41B,EAAL,CAOA,GAAI6F,GAAe7F,EAAOxd,MAK1B,IAHAmkB,EAAeze,KAAM8X,EAAO8B,SAC5B6E,EAAex4B,IAAKy4B,GAEf/D,EAAe,CAEnB,GAAImF,GAAUrB,EAAev9B,EACzB6+B,EAAWtB,EAAet9B,CAgB9B+9B,GAAiB,GAAI73B,IAAe,EAAVy4B,EAAaC,EAAUD,EAASC,GAE1Db,EAAiB,GAAI73B,IAAK,EAAG04B,EAAUD,EAASC,GAEhDb,EAAiB,GAAI73B,IAAe,EAAVy4B,EAAaC,EAAUD,EAASC,GAE1Db,EAAiB,GAAI73B,IAAKy4B,EAASC,EAAUD,EAASC,GAEtDb,EAAiB,GAAI73B,IAAe,EAAVy4B,EAAa,EAAGA,EAASC,GAEnDb,EAAiB,GAAI73B,IAAKy4B,EAAS,EAAGA,EAASC,GAE/CtB,EAAev9B,GAAK,EACpBu9B,EAAet9B,GAAK,EAIrB,GAAoB,OAAf22B,EAAO7gB,IAAe,CAE1B,GAAI+oB,IAASr9B,UAAWoD,GAAerD,UAAWqD,GAAenD,OAAQkB,GAEzEg0B,GAAO7gB,IAAM,GAAInS,GAAmB25B,EAAev9B,EAAGu9B,EAAet9B,EAAG6+B,GACxElI,EAAO7gB,IAAI5R,QAAQ9B,KAAOs0B,EAAMt0B,KAAO,aAEvCo6B,EAAa3vB,yBAIT8pB,EAAOmI,mBAEXnI,EAAOhtB,OAAQ+sB,EAIhB,IAAI5B,GAAY6B,EAAO7gB,IACnBipB,EAAepI,EAAOzzB,MAE1Bk6B,GAAoBhF,sBAAuB1B,EAAMprB,aACjDkxB,EAAazxB,SAAS8T,KAAMue,GAEvB5D,GAEJiF,EAAY,EAKZM,EAAaC,iBAAmB5B,EAAoBr9B,GAAKq9B,EAAoBp9B,GAAKo9B,EAAoB38B,KAItGg+B,EAAY,EAEZjB,EAAYpF,sBAAuB1B,EAAMxW,OAAO5U,aAChDkxB,EAAayC,OAAQzB,GACrBhB,EAAa0C,oBAIbH,EAAa74B,IACZ,GAAK,EAAK,EAAK,GACf,EAAK,GAAK,EAAK,GACf,EAAK,EAAK,GAAK,GACf,EAAK,EAAK,EAAK,GAGhB64B,EAAaI,SAAU3C,EAAatwB,kBACpC6yB,EAAaI,SAAU3C,EAAavwB,qBAIrCgvB,EAAUmE,gBAAiBtK,GAC3BmG,EAAUvhB,OAKV,KAAM,GAAI2lB,GAAO,EAAGA,EAAOZ,EAAWY,IAAU,CAE/C,GAAK7F,EAAe,CAEnBgE,EAAY3e,KAAM2d,EAAazxB,UAC/ByyB,EAAY8B,IAAKzB,EAAgBwB,IACjC7C,EAAa5xB,GAAGiU,KAAMif,EAASuB,IAC/B7C,EAAayC,OAAQzB,GACrBhB,EAAa0C,mBAEb,IAAIK,GAAexB,EAAiBsB,EACpCjB,GAAOn6B,SAAUs7B,GAMlBlC,EAAkBN,iBAAkBP,EAAatwB,iBAAkBswB,EAAavwB,oBAChF4wB,EAAS2C,cAAenC,GAIxBd,EAAcrjB,EAAOC,EAAQqjB,EAAchD,QAhI3Cl5B,SAAQ4H,KAAM,wBAAyBwuB,EAAO,kBAsIhDjkB,EAAMmD,aAAc,IA8KtB,QAAS6pB,IAAYv4B,EAAIqQ,EAAYmoB,EAAOxkB,GAE3C,QAASykB,KAER,GAAIC,IAAS,EAET3yB,EAAQ,GAAIvJ,GACZm8B,EAAmB,KACnBC,EAAoB,GAAIp8B,GAAS,EAAG,EAAG,EAAG,EAE9C,QAECq8B,QAAS,SAAWC,GAEdH,IAAqBG,GAAeJ,IAExC14B,EAAG84B,UAAWA,EAAWA,EAAWA,EAAWA,GAC/CH,EAAmBG,IAMrBC,UAAW,SAAWC,GAErBN,EAASM,GAIV5mB,SAAU,SAAWvT,EAAGC,EAAGC,EAAG8G,EAAG2I,GAE3BA,KAAuB,IAE3B3P,GAAKgH,EAAG/G,GAAK+G,EAAG9G,GAAK8G,GAItBE,EAAM/G,IAAKH,EAAGC,EAAGC,EAAG8G,GAEf+yB,EAAkBK,OAAQlzB,MAAY,IAE1C/F,EAAGqS,WAAYxT,EAAGC,EAAGC,EAAG8G,GACxB+yB,EAAkBjhB,KAAM5R,KAM1BkV,MAAO,WAENyd,GAAS,EAETC,EAAmB,KACnBC,EAAkB55B,OAAU,EAAG,EAAG,KAQrC,QAASk6B,KAER,GAAIR,IAAS,EAETS,EAAmB,KACnBC,EAAmB,KACnBC,EAAoB,IAExB,QAEChC,QAAS,SAAW1pB,GAEdA,EAEJ2rB,EAAQt5B,EAAGu5B,YAIXpC,EAASn3B,EAAGu5B,aAMdV,QAAS,SAAWW,GAEdL,IAAqBK,GAAed,IAExC14B,EAAGw5B,UAAWA,GACdL,EAAmBK,IAMrBC,QAAS,SAAWhsB,GAEnB,GAAK2rB,IAAqB3rB,EAAY,CAErC,GAAKA,EAEJ,OAASA,GAER,IAAKisB,IAEJ15B,EAAGyN,UAAWzN,EAAG25B,MACjB,MAED,KAAKC,IAEJ55B,EAAGyN,UAAWzN,EAAG65B,OACjB,MAED,KAAKC,IAEJ95B,EAAGyN,UAAWzN,EAAG+5B,KACjB,MAED,KAAKrsB,IAEJ1N,EAAGyN,UAAWzN,EAAGg6B,OACjB,MAED,KAAKC,IAEJj6B,EAAGyN,UAAWzN,EAAGk6B,MACjB,MAED,KAAKC,IAEJn6B,EAAGyN,UAAWzN,EAAGo6B,OACjB,MAED,KAAKC,IAEJr6B,EAAGyN,UAAWzN,EAAGs6B,QACjB,MAED,KAAKC,IAEJv6B,EAAGyN,UAAWzN,EAAGw6B,SACjB,MAED,SAECx6B,EAAGyN,UAAWzN,EAAGg6B,YAMnBh6B,GAAGyN,UAAWzN,EAAGg6B,OAIlBZ,GAAmB3rB,IAMrBsrB,UAAW,SAAWC,GAErBN,EAASM,GAIV5mB,SAAU,SAAW5I,GAEf6vB,IAAsB7vB,IAE1BxJ,EAAGy6B,WAAYjxB,GACf6vB,EAAoB7vB,IAMtByR,MAAO,WAENyd,GAAS,EAETS,EAAmB,KACnBC,EAAmB,KACnBC,EAAoB,OAQvB,QAASqB,KAER,GAAIhC,IAAS,EAETiC,EAAqB,KACrBC,EAAqB,KACrBC,EAAoB,KACpBC,EAAyB,KACzBC,EAAqB,KACrBC,EAAsB,KACtBC,EAAsB,KACtBC,EAAsB,IAE1B,QAEC7D,QAAS,SAAW8D,GAEdA,EAEJ7B,EAAQt5B,EAAGo7B,cAIXjE,EAASn3B,EAAGo7B,eAMdvC,QAAS,SAAWwC,GAEdV,IAAuBU,GAAiB3C,IAE5C14B,EAAGq7B,YAAaA,GAChBV,EAAqBU,IAMvB5B,QAAS,SAAW6B,EAAaC,EAAYF,GAEvCT,IAAuBU,GACvBT,IAAuBU,GACvBT,IAA2BO,IAE/Br7B,EAAGs7B,YAAaA,EAAaC,EAAYF,GAEzCT,EAAqBU,EACrBT,EAAoBU,EACpBT,EAAyBO,IAM3BG,MAAO,SAAWC,EAAaC,EAAcC,GAEvCZ,IAAwBU,GACxBT,IAAwBU,GACxBT,IAAwBU,IAE5B37B,EAAG47B,UAAWH,EAAaC,EAAcC,GAEzCZ,EAAqBU,EACrBT,EAAsBU,EACtBT,EAAsBU,IAMxB5C,UAAW,SAAWC,GAErBN,EAASM,GAIV5mB,SAAU,SAAWypB,GAEfX,IAAwBW,IAE5B77B,EAAG87B,aAAcD,GACjBX,EAAsBW,IAMxB5gB,MAAO,WAENyd,GAAS,EAETiC,EAAqB,KACrBC,EAAqB,KACrBC,EAAoB,KACpBC,EAAyB,KACzBC,EAAqB,KACrBC,EAAsB,KACtBC,EAAsB,KACtBC,EAAsB,OAmEzB,QAASa,GAAevhC,EAAMwe,EAAQ/W,GAErC,GAAIxE,GAAO,GAAIkE,YAAY,GACvB3E,EAAUgD,EAAG+7B,eAEjB/7B,GAAGg8B,YAAaxhC,EAAMwC,GACtBgD,EAAGi8B,cAAezhC,EAAMwF,EAAGk8B,mBAAoBl8B,EAAGm8B,SAClDn8B,EAAGi8B,cAAezhC,EAAMwF,EAAGo8B,mBAAoBp8B,EAAGm8B,QAElD,KAAM,GAAIpzB,GAAI,EAAGA,EAAI9G,EAAO8G,IAE3B/I,EAAGq8B,WAAYrjB,EAASjQ,EAAG,EAAG/I,EAAGs8B,KAAM,EAAG,EAAG,EAAGt8B,EAAGs8B,KAAMt8B,EAAG4B,cAAenE,EAI5E,OAAOT,GAyBR,QAASu/B,KAER,IAAM,GAAIxzB,GAAI,EAAGC,EAAIwzB,EAAcrjC,OAAQ4P,EAAIC,EAAGD,IAEjDyzB,EAAezzB,GAAM,EAMvB,QAAS0zB,GAAiBv8B,GAEzBw8B,EAA2Bx8B,EAAW,GAIvC,QAASw8B,GAA2Bx8B,EAAWy8B,GAW9C,GATAH,EAAet8B,GAAc,EAEW,IAAnC08B,EAAmB18B,KAEvBF,EAAG68B,wBAAyB38B,GAC5B08B,EAAmB18B,GAAc,GAI7B48B,EAAmB58B,KAAgBy8B,EAAmB,CAE1D,GAAItoB,GAAYL,EAAaM,SAAWtU,EAAKqQ,EAAWjO,IAAK,yBAE7DiS,GAAWL,EAAaM,SAAW,sBAAwB,4BAA8BpU,EAAWy8B,GACpGG,EAAmB58B,GAAcy8B,GAMnC,QAASI,KAER,IAAM,GAAIh0B,GAAI,EAAGC,EAAI4zB,EAAkBzjC,OAAQ4P,IAAMC,IAAMD,EAErD6zB,EAAmB7zB,KAAQyzB,EAAezzB,KAE9C/I,EAAGg9B,yBAA0Bj0B,GAC7B6zB,EAAmB7zB,GAAM,GAQ5B,QAASuwB,GAAQngB,GAEX8jB,EAAqB9jB,MAAS,IAElCnZ,EAAGs5B,OAAQngB,GACX8jB,EAAqB9jB,IAAO,GAM9B,QAASge,GAAShe,GAEZ8jB,EAAqB9jB,MAAS,IAElCnZ,EAAGm3B,QAAShe,GACZ8jB,EAAqB9jB,IAAO,GAM9B,QAAS+jB,KAER,GAAkC,OAA7BC,IAEJA,KAEK9sB,EAAWjO,IAAK,mCAChBiO,EAAWjO,IAAK,kCAChBiO,EAAWjO,IAAK,kCAChBiO,EAAWjO,IAAK,kCAIpB,IAAM,GAFFg7B,GAAUp9B,EAAG2U,aAAc3U,EAAGq9B,4BAExBt0B,EAAI,EAAGA,EAAIq0B,EAAQjkC,OAAQ4P,IAEpCo0B,EAAyBhyB,KAAMiyB,EAASr0B,GAQ3C,OAAOo0B,GAIR,QAASG,GAAY9hB,GAEpB,MAAK+hB,KAAmB/hB,IAEvBxb,EAAGs9B,WAAY9hB,GAEf+hB,EAAiB/hB,GAEV,GAQT,QAASgiB,GAAahxB,EAAUY,EAAeJ,EAAUE,EAAUM,EAAoBF,EAAeC,EAAeiB,GAEpH,GAAKhC,IAAaixB,GASjB,YAPKC,IAEJvG,EAASn3B,EAAGo3B,OACZsG,GAAyB,GAe3B,IAPOA,IAENpE,EAAQt5B,EAAGo3B,OACXsG,GAAyB,GAIrBlxB,IAAamxB,GAmFlBnwB,EAAqBA,GAAsBJ,EAC3CE,EAAgBA,GAAiBN,EACjCO,EAAgBA,GAAiBL,EAE5BE,IAAkBwwB,GAAwBpwB,IAAuBqwB,IAErE79B,EAAG89B,sBAAuBtF,EAAMuF,QAAS3wB,GAAiBorB,EAAMuF,QAASvwB,IAEzEowB,EAAuBxwB,EACvBywB,EAA4BrwB,GAIxBR,IAAagxB,GAAmB9wB,IAAa+wB,GAAmB3wB,IAAkB4wB,GAAwB3wB,IAAkB4wB,IAEhIn+B,EAAGo+B,kBAAmB5F,EAAMuF,QAAS/wB,GAAYwrB,EAAMuF,QAAS7wB,GAAYsrB,EAAMuF,QAASzwB,GAAiBkrB,EAAMuF,QAASxwB,IAE3HywB,EAAkBhxB,EAClBixB,EAAkB/wB,EAClBgxB,EAAuB5wB,EACvB6wB,EAAuB5wB,GAIxB8wB,EAAkB7xB,EAClB8xB,EAA2B,SA1G1B,IAAK9xB,IAAa6xB,GAAmB7vB,IAAuB8vB,EAA2B,CAWtF,GATKV,IAAyBvwB,IAAewwB,IAA8BxwB,KAE1ErN,EAAGoN,cAAepN,EAAGu+B,UAErBX,EAAuBvwB,GACvBwwB,EAA4BxwB,IAIxBmB,EAEJ,OAAShC,GAER,IAAKC,IACJzM,EAAGo+B,kBAAmBp+B,EAAGw+B,IAAKx+B,EAAGy+B,oBAAqBz+B,EAAGw+B,IAAKx+B,EAAGy+B,oBACjE,MAED,KAAKC,IACJ1+B,EAAG2+B,UAAW3+B,EAAGw+B,IAAKx+B,EAAGw+B,IACzB,MAED,KAAKI,IACJ5+B,EAAGo+B,kBAAmBp+B,EAAG6+B,KAAM7+B,EAAG6+B,KAAM7+B,EAAG8+B,oBAAqB9+B,EAAGy+B,oBACnE,MAED,KAAKM,IACJ/+B,EAAGo+B,kBAAmBp+B,EAAG6+B,KAAM7+B,EAAGg/B,UAAWh/B,EAAG6+B,KAAM7+B,EAAGi/B,UACzD,MAED,SACC7lC,QAAQC,MAAO,uCAAwCmT,OAOzD,QAASA,GAER,IAAKC,IACJzM,EAAGo+B,kBAAmBp+B,EAAGi/B,UAAWj/B,EAAGy+B,oBAAqBz+B,EAAGw+B,IAAKx+B,EAAGy+B,oBACvE,MAED,KAAKC,IACJ1+B,EAAG2+B,UAAW3+B,EAAGi/B,UAAWj/B,EAAGw+B,IAC/B,MAED,KAAKI,IACJ5+B,EAAG2+B,UAAW3+B,EAAG6+B,KAAM7+B,EAAG8+B,oBAC1B,MAED,KAAKC,IACJ/+B,EAAG2+B,UAAW3+B,EAAG6+B,KAAM7+B,EAAGg/B,UAC1B,MAED,SACC5lC,QAAQC,MAAO,uCAAwCmT,GAO1DwxB,EAAkB,KAClBC,EAAkB,KAClBC,EAAuB,KACvBC,EAAuB,KAEvBE,EAAkB7xB,EAClB8xB,EAA2B9vB,GAuC9B,QAAS0wB,GAAa7tB,EAAU8tB,GAE/B9tB,EAAS3E,OAASmhB,GACfsJ,EAASn3B,EAAGo/B,WACZ9F,EAAQt5B,EAAGo/B,UAEd,IAAI/W,GAAchX,EAAS3E,OAASsG,EAC/BmsB,KAAc9W,GAAcA,GAEjCgX,EAAchX,GAEZhX,EAAS7E,WAAaC,IAAkB4E,EAAStE,eAAgB,EAChEywB,EAAaC,IACbD,EAAansB,EAAS7E,SAAU6E,EAASjE,cAAeiE,EAASrE,SAAUqE,EAASnE,SAAUmE,EAAS7D,mBAAoB6D,EAAS/D,cAAe+D,EAAS9D,cAAe8D,EAAS7C,oBAEvLvR,EAAYw8B,QAASpoB,EAAS5D,WAC9BxQ,EAAYo6B,QAAShmB,EAAS1D,WAC9B1Q,EAAY47B,QAASxnB,EAASzD,YAC9B0xB,EAAYzG,QAASxnB,EAASpD,YAE9BsxB,EAAkBluB,EAASlD,cAAekD,EAASjD,oBAAqBiD,EAAShD,oBAMlF,QAASgxB,GAAchX,GAEjBmX,IAAqBnX,IAEpBA,EAEJroB,EAAGy/B,UAAWz/B,EAAG0/B,IAIjB1/B,EAAGy/B,UAAWz/B,EAAG2/B,KAIlBH,EAAmBnX,GAMrB,QAASuX,GAAaC,GAEhBA,IAAaC,IAEjBxG,EAAQt5B,EAAGo/B,WAENS,IAAaE,IAEZF,IAAaG,GAEjBhgC,EAAG6/B,SAAU7/B,EAAGigC,MAELJ,IAAaK,GAExBlgC,EAAG6/B,SAAU7/B,EAAGmgC,OAIhBngC,EAAG6/B,SAAU7/B,EAAGogC,kBAQlBjJ,EAASn3B,EAAGo/B,WAIbW,EAAkBF,EAInB,QAASQ,GAAc3jC,GAEjBA,IAAU4jC,IAETC,IAAqBvgC,EAAGwgC,UAAW9jC,GAExC4jC,EAAmB5jC,GAMrB,QAAS6iC,GAAkBpxB,EAAesyB,EAAQjgB,GAE5CrS,GAEJmrB,EAAQt5B,EAAG0gC,qBAENC,IAA+BF,GAAUG,KAA8BpgB,IAE3ExgB,EAAGmO,cAAesyB,EAAQjgB,GAE1BmgB,EAA6BF,EAC7BG,GAA4BpgB,IAM7B2W,EAASn3B,EAAG0gC,qBAMd,QAASpJ,GAAgBx6B,GAEnBA,EAEJw8B,EAAQt5B,EAAG6gC,cAIX1J,EAASn3B,EAAG6gC,cAQd,QAASC,GAAeC,GAEJlnC,SAAdknC,IAA0BA,EAAY/gC,EAAGghC,SAAW1rB,GAAc,GAElE2rB,KAAuBF,IAE3B/gC,EAAG8gC,cAAeC,GAClBE,GAAqBF,GAMvB,QAAS/E,GAAakF,EAAWC,GAEJ,OAAvBF,IAEJH,GAID,IAAIM,GAAeC,GAAsBJ,GAEnBpnC,UAAjBunC,IAEJA,GAAiB5mC,KAAMX,OAAWmD,QAASnD,QAC3CwnC,GAAsBJ,IAAuBG,GAIzCA,EAAa5mC,OAAS0mC,GAAaE,EAAapkC,UAAYmkC,IAEhEnhC,EAAGg8B,YAAakF,EAAWC,GAAgBG,GAAeJ,IAE1DE,EAAa5mC,KAAO0mC,EACpBE,EAAapkC,QAAUmkC,GAMzB,QAASI,KAER,IAECvhC,EAAGuhC,qBAAqBC,MAAOxhC,EAAI9G,WAElC,MAAQG,GAETD,QAAQC,MAAO,oBAAqBA,IAMtC,QAASgjC,KAER,IAECr8B,EAAGq8B,WAAWmF,MAAOxhC,EAAI9G,WAExB,MAAQG,GAETD,QAAQC,MAAO,oBAAqBA,IAQtC,QAASwD,GAASA,GAEZ4kC,GAAexI,OAAQp8B,MAAc,IAEzCmD,EAAGnD,QAASA,EAAQhE,EAAGgE,EAAQ/D,EAAG+D,EAAQtD,EAAGsD,EAAQrD,GACrDioC,GAAe9pB,KAAM9a,IAMvB,QAASE,GAAUA,GAEb2kC,GAAgBzI,OAAQl8B,MAAe,IAE3CiD,EAAGjD,SAAUA,EAASlE,EAAGkE,EAASjE,EAAGiE,EAASxD,EAAGwD,EAASvD,GAC1DkoC,GAAgB/pB,KAAM5a,IAQxB,QAASke,KAER,IAAM,GAAIlS,GAAI,EAAGA,EAAI6zB,EAAkBzjC,OAAQ4P,IAEd,IAA3B6zB,EAAmB7zB,KAEvB/I,EAAGg9B,yBAA0Bj0B,GAC7B6zB,EAAmB7zB,GAAM,EAM3Bk0B,MAEAE,EAA2B,KAE3B8D,GAAqB,KACrBI,MAEA9D,EAAiB,KAEjBc,EAAkB,KAElBmB,EAAmB,KACnBO,EAAkB,KAElBT,EAAYrkB,QACZhe,EAAYge,QACZ/d,EAAc+d,QA5lBf,GAAIqkB,GAAc,GAAI7G,GAClBx7B,EAAc,GAAIi8B,GAClBh8B,EAAgB,GAAIw9B,GAEpBiH,EAAsB3hC,EAAG2U,aAAc3U,EAAG+V,oBAC1CymB,EAAgB,GAAI76B,YAAYggC,GAChC/E,EAAoB,GAAIj7B,YAAYggC,GACpC7E,EAAoB,GAAIn7B,YAAYggC,GAEpC1E,KAEAE,EAA2B,KAE3BI,EAAiB,KAEjBG,EAAyB,KACzBW,EAAkB,KAClBT,EAAuB,KACvBI,EAAkB,KAClBC,EAAkB,KAClBJ,EAA4B,KAC5BK,EAAuB,KACvBC,EAAuB,KACvBG,GAA2B,EAE3BkB,EAAmB,KACnBO,EAAkB,KAElBO,EAAmB,KAEnBK,EAA6B,KAC7BC,GAA4B,KAE5BtrB,GAActV,EAAG2U,aAAc3U,EAAG4hC,kCAElCrB,IAAqB,EACrBjkC,GAAU,EACVulC,GAAY7hC,EAAG2U,aAAc3U,EAAG8hC,QAE/BD,IAAUvT,QAAS,eAEvBhyB,GAAUylC,WAAY,kBAAkBvgB,KAAMqgB,IAAa,IAC3DtB,GAAuBjkC,IAAW,GAEvBulC,GAAUvT,QAAS,oBAE9BhyB,GAAUylC,WAAY,uBAAuBvgB,KAAMqgB,IAAa,IAChEtB,GAAuBjkC,IAAW,EAInC,IAAI2kC,IAAqB,KACrBI,MAEAI,GAAiB,GAAIjlC,GACrBklC,GAAkB,GAAIllC,GAqBtB8kC,KAohBJ,OAnhBAA,IAAethC,EAAGgiC,YAAejG,EAAe/7B,EAAGgiC,WAAYhiC,EAAGgiC,WAAY,GAC9EV,GAAethC,EAAGiiC,kBAAqBlG,EAAe/7B,EAAGiiC,iBAAkBjiC,EAAGkiC,4BAA6B,GAI3G5C,EAAYltB,SAAU,EAAG,EAAG,EAAG,GAC/BnV,EAAYmV,SAAU,GACtBlV,EAAckV,SAAU,GAExBknB,EAAQt5B,EAAGu5B,YACXt8B,EAAYw8B,QAAS/rB,IAErB2xB,GAAc,GACdO,EAAaI,IACb1G,EAAQt5B,EAAGo/B,WAEX5B,EAAaC,KAqgBZn7B,SACCyD,MAAOu5B,EACP91B,MAAOvM,EACP4+B,QAAS3+B,GAGVq/B,eAAgBA,EAChBE,gBAAiBA,EACjBC,0BAA2BA,EAC3BK,wBAAyBA,EACzBzD,OAAQA,EACRnC,QAASA,EACT+F,4BAA6BA,EAE7BI,WAAYA,EAEZE,YAAaA,EACb0B,YAAaA,EAEbG,aAAcA,EACdO,YAAaA,EAEbS,aAAcA,EACdd,iBAAkBA,EAElBjI,eAAgBA,EAEhBwJ,cAAeA,EACf9E,YAAaA,EACbuF,qBAAsBA,EACtBlF,WAAYA,EAEZx/B,QAASA,EACTE,SAAUA,EAEVke,MAAOA,GAUT,QAASknB,IAAelL,EAAK5mB,EAAYuB,EAAO6c,EAAYza,EAAcwkB,EAAOzkB,GAOhF,QAASquB,GAAgBnoC,EAAOooC,GAE/B,GAAKpoC,EAAMyC,MAAQ2lC,GAAWpoC,EAAM0C,OAAS0lC,EAAU,CAEtD,GAAK,QAAUpoC,GAGd,WADAb,SAAQ4H,KAAM,yDAA2D/G,EAAMyC,MAAQ,IAAMzC,EAAM0C,OAAS,KAQ7G,IAAImH,GAAQu+B,EAAU32B,KAAK7N,IAAK5D,EAAMyC,MAAOzC,EAAM0C,QAE/C2lC,EAASC,SAASC,gBAAiB,+BAAgC,SACvEF,GAAO5lC,MAAQgP,KAAKC,MAAO1R,EAAMyC,MAAQoH,GACzCw+B,EAAO3lC,OAAS+O,KAAKC,MAAO1R,EAAM0C,OAASmH,EAE3C,IAAItE,GAAU8iC,EAAOG,WAAY,KAKjC,OAJAjjC,GAAQkjC,UAAWzoC,EAAO,EAAG,EAAGA,EAAMyC,MAAOzC,EAAM0C,OAAQ,EAAG,EAAG2lC,EAAO5lC,MAAO4lC,EAAO3lC,QAEtFvD,QAAQ4H,KAAM,0CAA4C/G,EAAMyC,MAAQ,IAAMzC,EAAM0C,OAAS,iBAAmB2lC,EAAO5lC,MAAQ,IAAM4lC,EAAO3lC,QAErI2lC,EAIR,MAAOroC,GAIR,QAAS0oC,GAAc1oC,GAEtB,MAAOe,IAAM2nC,aAAc1oC,EAAMyC,QAAW1B,GAAM2nC,aAAc1oC,EAAM0C,QAIvE,QAASimC,GAAgB3oC,GAExB,GAAKA,YAAiB4oC,mBAAoB5oC,YAAiB6oC,oBAAqB7oC,YAAiB8oC,aAAc,CAE7FlpC,SAAZmpC,IAAwBA,EAAUT,SAASC,gBAAiB,+BAAgC,WAEjGQ,EAAQtmC,MAAQ1B,GAAMioC,gBAAiBhpC,EAAMyC,OAC7CsmC,EAAQrmC,OAAS3B,GAAMioC,gBAAiBhpC,EAAM0C,OAE9C,IAAI6C,GAAUwjC,EAAQP,WAAY,KAKlC,OAJAjjC,GAAQkjC,UAAWzoC,EAAO,EAAG,EAAG+oC,EAAQtmC,MAAOsmC,EAAQrmC,QAEvDvD,QAAQ4H,KAAM,mDAAqD/G,EAAMyC,MAAQ,IAAMzC,EAAM0C,OAAS,iBAAmBqmC,EAAQtmC,MAAQ,IAAMsmC,EAAQrmC,QAEhJqmC,EAIR,MAAO/oC,GAIR,QAASipC,GAAwBlmC,GAEhC,OAAKgX,EAAaM,WAETtX,EAAQ7C,QAAUmB,IAAuB0B,EAAQ5C,QAAUkB,IACjE0B,EAAQ1C,YAAcoD,IAAiBV,EAAQ1C,YAAciB,IAIjE,QAAS4nC,GAA6BnmC,EAAS2lC,GAE9C,MAAO3lC,GAAQf,iBAAmB0mC,GACjC3lC,EAAQ1C,YAAcoD,IAAiBV,EAAQ1C,YAAciB,GAI/D,QAAS6nC,GAAgBpqB,EAAQhc,EAASN,EAAOC,GAEhDs6B,EAAImM,eAAgBpqB,EAEpB,IAAIqqB,GAAoB5U,EAAWrsB,IAAKpF,EAGxCqmC,GAAkBC,cAAgB53B,KAAK2e,IAAK3e,KAAK7N,IAAKnB,EAAOC,IAAa+O,KAAK63B,MAIhF,QAASC,GAAmBC,EAAUC,GAErC,IAAO1vB,EAAaM,SAAW,MAAOmvB,EAEtC,IAAKA,IAAaxM,EAAI0M,IAAM,CAE3B,GAAKD,IAAWzM,EAAIp2B,MAAQ,MAAOo2B,GAAI2M,MACvC,IAAKF,IAAWzM,EAAI4M,WAAa,MAAO5M,GAAI6M,MAC5C,IAAKJ,IAAWzM,EAAIr1B,cAAgB,MAAOq1B,GAAI8M,KAIhD,GAAKN,IAAaxM,EAAIqF,KAAO,CAE5B,GAAKoH,IAAWzM,EAAIp2B,MAAQ,MAAOo2B,GAAI+M,OACvC,IAAKN,IAAWzM,EAAI4M,WAAa,MAAO5M,GAAIgN,OAC5C,IAAKP,IAAWzM,EAAIr1B,cAAgB,MAAOq1B,GAAIiN,MAIhD,MAAOT,GAMR,QAASU,GAAgBC,GAExB,MAAKA,KAAM1mC,IAAiB0mC,IAAMC,IAA8BD,IAAME,GAE9DrN,EAAIkF,QAILlF,EAAIsN,OAMZ,QAASC,GAAkBzrB,GAE1B,GAAI/b,GAAU+b,EAAMC,MAEpBhc,GAAQoc,oBAAqB,UAAWorB,GAExCC,EAAmBznC,GAEdA,EAAQ0nC,sBAELC,GAAgB3nC,EAAQmc,IAIhCpF,EAAKuF,OAAO4B,WAIb,QAAS0pB,GAAuB7rB,GAE/B,GAAI8rB,GAAe9rB,EAAMC,MAEzB6rB,GAAazrB,oBAAqB,UAAWwrB,GAE7CE,EAAwBD,GAExB9wB,EAAKuF,OAAO4B,WAMb,QAASupB,GAAmBznC,GAE3B,GAAIqmC,GAAoB5U,EAAWrsB,IAAKpF,EAExC,IAAKA,EAAQ/C,OAASopC,EAAkB0B,0BAIvC9N,EAAI+N,cAAe3B,EAAkB0B,+BAE/B,CAIN,GAAuClrC,SAAlCwpC,EAAkB4B,YAA4B,MAEnDhO,GAAI+N,cAAe3B,EAAkB6B,gBAKtCzW,EAAWlsB,OAAQvF,GAIpB,QAAS8nC,GAAwBD,GAEhC,GAAIM,GAAyB1W,EAAWrsB,IAAKyiC,GACzCxB,EAAoB5U,EAAWrsB,IAAKyiC,EAAa7nC,QAErD,IAAO6nC,EAAP,CAcA,GAZ0ChrC,SAArCwpC,EAAkB6B,gBAEtBjO,EAAI+N,cAAe3B,EAAkB6B,gBAIjCL,EAAa1nC,cAEjB0nC,EAAa1nC,aAAakf,UAItBwoB,EAAaO,wBAEjB,IAAM,GAAIr8B,GAAI,EAAGA,EAAI,EAAGA,IAEvBkuB,EAAIoO,kBAAmBF,EAAuBG,mBAAoBv8B,IAC7Do8B,EAAuBI,oBAAqBtO,EAAIuO,mBAAoBL,EAAuBI,mBAAoBx8B,QAMrHkuB,GAAIoO,kBAAmBF,EAAuBG,oBACzCH,EAAuBI,oBAAqBtO,EAAIuO,mBAAoBL,EAAuBI,mBAIjG9W,GAAWlsB,OAAQsiC,EAAa7nC,SAChCyxB,EAAWlsB,OAAQsiC,IAQpB,QAAS9lB,GAAc/hB,EAASyoC,GAE/B,GAAIpC,GAAoB5U,EAAWrsB,IAAKpF,EAIxC,IAFKA,EAAQ0nC,gBAAiBgB,EAAoB1oC,GAE7CA,EAAQV,QAAU,GAAK+mC,EAAkBsC,YAAc3oC,EAAQV,QAAU,CAE7E,GAAIrC,GAAQ+C,EAAQ/C,KAEpB,IAAeJ,SAAVI,EAEJb,QAAQ4H,KAAM,6EAER,CAAA,GAAK/G,EAAM2rC,YAAa,EAO9B,WADAC,GAAexC,EAAmBrmC,EAASyoC,EAJ3CrsC,SAAQ4H,KAAM,2EAWhB4Q,EAAMkvB,cAAe7J,EAAI+J,SAAWyE,GACpC7zB,EAAMoqB,YAAa/E,EAAI+K,WAAYqB,EAAkB6B,gBAItD,QAAShmB,GAAgBliB,EAASyoC,GAEjC,GAAIpC,GAAoB5U,EAAWrsB,IAAKpF,EAExC,IAA8B,IAAzBA,EAAQ/C,MAAMd,OAElB,GAAK6D,EAAQV,QAAU,GAAK+mC,EAAkBsC,YAAc3oC,EAAQV,QAAU,CAEtE+mC,EAAkB0B,4BAExB/nC,EAAQwc,iBAAkB,UAAWgrB,GAErCnB,EAAkB0B,0BAA4B9N,EAAI8E,gBAElDhoB,EAAKuF,OAAO4B,YAIbtJ,EAAMkvB,cAAe7J,EAAI+J,SAAWyE,GACpC7zB,EAAMoqB,YAAa/E,EAAIgL,iBAAkBoB,EAAkB0B,2BAE3D9N,EAAI6O,YAAa7O,EAAI8O,oBAAqB/oC,EAAQb,MAOlD,KAAM,GALF6pC,GAAiBhpC,GAAWA,EAAQipC,oBACpCC,EAAkBlpC,EAAQ/C,MAAO,IAAO+C,EAAQ/C,MAAO,GAAIisC,cAE3DC,KAEMp9B,EAAI,EAAGA,EAAI,EAAGA,IAEhBi9B,GAAkBE,EAMxBC,EAAWp9B,GAAMm9B,EAAgBlpC,EAAQ/C,MAAO8O,GAAI9O,MAAQ+C,EAAQ/C,MAAO8O,GAJ3Eo9B,EAAWp9B,GAAMq5B,EAAgBplC,EAAQ/C,MAAO8O,GAAKiL,EAAa4B,eAUpE,IAAI3b,GAAQksC,EAAW,GACtBC,EAAoBzD,EAAc1oC,GAClCwpC,EAAWjL,EAAMuF,QAAS/gC,EAAQzC,QAClCmpC,EAASlL,EAAMuF,QAAS/gC,EAAQxC,MAChC6rC,EAAmB7C,EAAmBC,EAAUC,EAEjD4C,GAAsBrP,EAAIgL,iBAAkBjlC,EAASopC,EAErD,KAAM,GAAIr9B,GAAI,EAAGA,EAAI,EAAGA,IAEvB,GAAOi9B,EAgBN,IAAM,GAFFO,GAAQnrC,EAAU+qC,EAAWp9B,GAAI3N,QAE3BorC,EAAI,EAAGC,EAAKrrC,EAAQjC,OAAQqtC,EAAIC,EAAID,IAE7CD,EAASnrC,EAASorC,GAEbxpC,EAAQzC,SAAWkB,IAAcuB,EAAQzC,SAAWmsC,GAEnD90B,EAAMsrB,8BAA8B5O,QAASmV,MAEjD7xB,EAAM2vB,qBAAsBtK,EAAIiL,4BAA8Bn5B,EAAGy9B,EAAGH,EAAkBE,EAAO7pC,MAAO6pC,EAAO5pC,OAAQ,EAAG4pC,EAAO9oC,MAI7HrE,QAAQ4H,KAAM,mGAMf4Q,EAAMyqB,WAAYpF,EAAIiL,4BAA8Bn5B,EAAGy9B,EAAGH,EAAkBE,EAAO7pC,MAAO6pC,EAAO5pC,OAAQ,EAAG8mC,EAAUC,EAAQ6C,EAAO9oC,UAhClIyoC,GAEJt0B,EAAMyqB,WAAYpF,EAAIiL,4BAA8Bn5B,EAAG,EAAGs9B,EAAkBF,EAAWp9B,GAAIrM,MAAOypC,EAAWp9B,GAAIpM,OAAQ,EAAG8mC,EAAUC,EAAQyC,EAAWp9B,GAAItL,MAI7JmU,EAAMyqB,WAAYpF,EAAIiL,4BAA8Bn5B,EAAG,EAAGs9B,EAAkB5C,EAAUC,EAAQyC,EAAWp9B,GAoCrGi9B,GAMN3C,EAAkBC,cAAgBloC,EAAQjC,OAAS,EAJnDkqC,EAAkBC,cAAgB,EAQ9BH,EAA6BnmC,EAASopC,IAG1ChD,EAAgBnM,EAAIgL,iBAAkBjlC,EAAS/C,EAAMyC,MAAOzC,EAAM0C,QAInE0mC,EAAkBsC,UAAY3oC,EAAQV,QAEjCU,EAAQT,UAAWS,EAAQT,SAAUS,OAI1C4U,GAAMkvB,cAAe7J,EAAI+J,SAAWyE,GACpC7zB,EAAMoqB,YAAa/E,EAAIgL,iBAAkBoB,EAAkB0B,2BAQ9D,QAAS4B,GAAuB3pC,EAASyoC,GAExC7zB,EAAMkvB,cAAe7J,EAAI+J,SAAWyE,GACpC7zB,EAAMoqB,YAAa/E,EAAIgL,iBAAkBxT,EAAWrsB,IAAKpF,GAAUkoC,gBAIpE,QAASoB,GAAsBM,EAAa5pC,EAASopC,GAEpD,GAAI/xB,EAkCJ,IAhCK+xB,GAEJnP,EAAIgF,cAAe2K,EAAa3P,EAAI4P,eAAgBrO,EAAMuF,QAAS/gC,EAAQ7C,QAC3E88B,EAAIgF,cAAe2K,EAAa3P,EAAI6P,eAAgBtO,EAAMuF,QAAS/gC,EAAQ5C,QAE3E68B,EAAIgF,cAAe2K,EAAa3P,EAAImF,mBAAoB5D,EAAMuF,QAAS/gC,EAAQ3C,YAC/E48B,EAAIgF,cAAe2K,EAAa3P,EAAIiF,mBAAoB1D,EAAMuF,QAAS/gC,EAAQ1C,cAI/E28B,EAAIgF,cAAe2K,EAAa3P,EAAI4P,eAAgB5P,EAAI8P,eACxD9P,EAAIgF,cAAe2K,EAAa3P,EAAI6P,eAAgB7P,EAAI8P,eAEnD/pC,EAAQ7C,QAAUmB,IAAuB0B,EAAQ5C,QAAUkB,IAE/DlC,QAAQ4H,KAAM,iIAIfi2B,EAAIgF,cAAe2K,EAAa3P,EAAImF,mBAAoB+H,EAAgBnnC,EAAQ3C,YAChF48B,EAAIgF,cAAe2K,EAAa3P,EAAIiF,mBAAoBiI,EAAgBnnC,EAAQ1C,YAE3E0C,EAAQ1C,YAAcoD,IAAiBV,EAAQ1C,YAAciB,IAEjEnC,QAAQ4H,KAAM,oIAMhBqT,EAAYhE,EAAWjO,IAAK,kCAEX,CAEhB,GAAKpF,EAAQxC,OAASwsC,IAA8D,OAAjD32B,EAAWjO,IAAK,4BAAwC,MAC3F,IAAKpF,EAAQxC,OAASysC,IAAoG,QAAjFjzB,EAAaM,UAAYjE,EAAWjO,IAAK,kCAA+C,QAE5HpF,EAAQvC,WAAa,GAAKg0B,EAAWrsB,IAAKpF,GAAUkqC,uBAExDjQ,EAAIkQ,cAAeP,EAAavyB,EAAU+yB,2BAA4B17B,KAAK9N,IAAKZ,EAAQvC,WAAYuZ,EAAaS,qBACjHga,EAAWrsB,IAAKpF,GAAUkqC,oBAAsBlqC,EAAQvC,aAQ3D,QAASorC,GAAexC,EAAmBrmC,EAASyoC,GAEZ5rC,SAAlCwpC,EAAkB4B,cAEtB5B,EAAkB4B,aAAc,EAEhCjoC,EAAQwc,iBAAkB,UAAWgrB,GAErCnB,EAAkB6B,eAAiBjO,EAAI8E,gBAEvChoB,EAAKuF,OAAO4B,YAIbtJ,EAAMkvB,cAAe7J,EAAI+J,SAAWyE,GACpC7zB,EAAMoqB,YAAa/E,EAAI+K,WAAYqB,EAAkB6B,gBAErDjO,EAAI6O,YAAa7O,EAAI8O,oBAAqB/oC,EAAQb,OAClD86B,EAAI6O,YAAa7O,EAAIoQ,+BAAgCrqC,EAAQd,kBAC7D+6B,EAAI6O,YAAa7O,EAAIqQ,iBAAkBtqC,EAAQZ,gBAE/C,IAAInC,GAAQmoC,EAAgBplC,EAAQ/C,MAAO+Z,EAAa0B,eAEnDwtB,GAAwBlmC,IAAa2lC,EAAc1oC,MAAY,IAEnEA,EAAQ2oC,EAAgB3oC,GAIzB,IAAImsC,GAAoBzD,EAAc1oC,GACrCwpC,EAAWjL,EAAMuF,QAAS/gC,EAAQzC,QAClCmpC,EAASlL,EAAMuF,QAAS/gC,EAAQxC,MAChC6rC,EAAmB7C,EAAmBC,EAAUC,EAEjD4C,GAAsBrP,EAAI+K,WAAYhlC,EAASopC,EAE/C,IAAIG,GAAQnrC,EAAU4B,EAAQ5B,OAE9B,IAAK4B,EAAQuqC,eAAiB,CAM7B,GAFAlB,EAAmBpP,EAAIuQ,gBAElBxqC,EAAQxC,OAASwsC,GAAY,CAEjC,IAAOhzB,EAAaM,SAAW,KAAM,IAAI+O,OAAO,iDAChDgjB,GAAmBpP,EAAIwQ,uBAEZzzB,GAAaM,WAGxB+xB,EAAmBpP,EAAIyQ,kBAInB1qC,GAAQzC,SAAWotC,IAAetB,IAAqBpP,EAAIuQ,iBAK1DxqC,EAAQxC,OAASotC,IAAqB5qC,EAAQxC,OAASqtC,KAE3DzuC,QAAQ4H,KAAM,+FAEdhE,EAAQxC,KAAOotC,GACflE,EAASlL,EAAMuF,QAAS/gC,EAAQxC,OAQ7BwC,EAAQzC,SAAWutC,KAEvBzB,EAAmBpP,EAAI8Q,cAKlB/qC,EAAQxC,OAASwtC,KAErB5uC,QAAQ4H,KAAM;AAEdhE,EAAQxC,KAAOwtC,GACftE,EAASlL,EAAMuF,QAAS/gC,EAAQxC,QAMlCoX,EAAMyqB,WAAYpF,EAAI+K,WAAY,EAAGqE,EAAkBpsC,EAAMyC,MAAOzC,EAAM0C,OAAQ,EAAG8mC,EAAUC,EAAQ,UAEjG,IAAK1mC,EAAQkpC,cAMnB,GAAK9qC,EAAQjC,OAAS,GAAKitC,EAAoB,CAE9C,IAAM,GAAIr9B,GAAI,EAAGyuB,EAAKp8B,EAAQjC,OAAQ4P,EAAIyuB,EAAIzuB,IAE7Cw9B,EAASnrC,EAAS2N,GAClB6I,EAAMyqB,WAAYpF,EAAI+K,WAAYj5B,EAAGs9B,EAAkBE,EAAO7pC,MAAO6pC,EAAO5pC,OAAQ,EAAG8mC,EAAUC,EAAQ6C,EAAO9oC,KAIjHT,GAAQf,iBAAkB,EAC1BonC,EAAkBC,cAAgBloC,EAAQjC,OAAS,MAInDyY,GAAMyqB,WAAYpF,EAAI+K,WAAY,EAAGqE,EAAkBpsC,EAAMyC,MAAOzC,EAAM0C,OAAQ,EAAG8mC,EAAUC,EAAQzpC,EAAMwD,MAC7G4lC,EAAkBC,cAAgB,MAI7B,IAAKtmC,EAAQipC,oBAAsB,CAEzC,IAAM,GAAIl9B,GAAI,EAAGyuB,EAAKp8B,EAAQjC,OAAQ4P,EAAIyuB,EAAIzuB,IAE7Cw9B,EAASnrC,EAAS2N,GAEb/L,EAAQzC,SAAWkB,IAAcuB,EAAQzC,SAAWmsC,GAEnD90B,EAAMsrB,8BAA8B5O,QAASmV,MAEjD7xB,EAAM2vB,qBAAsBtK,EAAI+K,WAAYj5B,EAAGs9B,EAAkBE,EAAO7pC,MAAO6pC,EAAO5pC,OAAQ,EAAG4pC,EAAO9oC,MAIxGrE,QAAQ4H,KAAM,kGAMf4Q,EAAMyqB,WAAYpF,EAAI+K,WAAYj5B,EAAGs9B,EAAkBE,EAAO7pC,MAAO6pC,EAAO5pC,OAAQ,EAAG8mC,EAAUC,EAAQ6C,EAAO9oC,KAMlH4lC,GAAkBC,cAAgBloC,EAAQjC,OAAS,MAUnD,IAAKiC,EAAQjC,OAAS,GAAKitC,EAAoB,CAE9C,IAAM,GAAIr9B,GAAI,EAAGyuB,EAAKp8B,EAAQjC,OAAQ4P,EAAIyuB,EAAIzuB,IAE7Cw9B,EAASnrC,EAAS2N,GAClB6I,EAAMyqB,WAAYpF,EAAI+K,WAAYj5B,EAAGs9B,EAAkB5C,EAAUC,EAAQ6C,EAI1EvpC,GAAQf,iBAAkB,EAC1BonC,EAAkBC,cAAgBloC,EAAQjC,OAAS,MAInDyY,GAAMyqB,WAAYpF,EAAI+K,WAAY,EAAGqE,EAAkB5C,EAAUC,EAAQzpC,GACzEopC,EAAkBC,cAAgB,CAM/BH,GAA6BnmC,EAASopC,IAE1ChD,EAAgBnM,EAAI+K,WAAYhlC,EAAS/C,EAAMyC,MAAOzC,EAAM0C,QAI7D0mC,EAAkBsC,UAAY3oC,EAAQV,QAEjCU,EAAQT,UAAWS,EAAQT,SAAUS,GAO3C,QAASirC,GAAyBC,EAAarD,EAAcsD,EAAYC,GAExE,GAAI3E,GAAWjL,EAAMuF,QAAS8G,EAAa7nC,QAAQzC,QAC/CmpC,EAASlL,EAAMuF,QAAS8G,EAAa7nC,QAAQxC,MAC7C6rC,EAAmB7C,EAAmBC,EAAUC,EACpD9xB,GAAMyqB,WAAY+L,EAAe,EAAG/B,EAAkBxB,EAAanoC,MAAOmoC,EAAaloC,OAAQ,EAAG8mC,EAAUC,EAAQ,MACpHzM,EAAIoR,gBAAiBpR,EAAIqR,YAAaJ,GACtCjR,EAAIsR,qBAAsBtR,EAAIqR,YAAaH,EAAYC,EAAe3Z,EAAWrsB,IAAKyiC,EAAa7nC,SAAUkoC,eAAgB,GAC7HjO,EAAIoR,gBAAiBpR,EAAIqR,YAAa,MAKvC,QAASE,GAA0BC,EAAc5D,GAEhD5N,EAAIyR,iBAAkBzR,EAAI0R,aAAcF,GAEnC5D,EAAa5nC,cAAiB4nC,EAAa3nC,eAE/C+5B,EAAI2R,oBAAqB3R,EAAI0R,aAAc1R,EAAIyQ,kBAAmB7C,EAAanoC,MAAOmoC,EAAaloC,QACnGs6B,EAAI4R,wBAAyB5R,EAAIqR,YAAarR,EAAI6R,iBAAkB7R,EAAI0R,aAAcF,IAE3E5D,EAAa5nC,aAAe4nC,EAAa3nC,eAEpD+5B,EAAI2R,oBAAqB3R,EAAI0R,aAAc1R,EAAI8Q,cAAelD,EAAanoC,MAAOmoC,EAAaloC,QAC/Fs6B,EAAI4R,wBAAyB5R,EAAIqR,YAAarR,EAAI8R,yBAA0B9R,EAAI0R,aAAcF,IAK9FxR,EAAI2R,oBAAqB3R,EAAI0R,aAAc1R,EAAI+R,MAAOnE,EAAanoC,MAAOmoC,EAAaloC,QAIxFs6B,EAAIyR,iBAAkBzR,EAAI0R,aAAc,MAKzC,QAASM,GAAmBf,EAAarD,GAExC,GAAIqE,GAAWrE,GAAgBA,EAAaO,uBAC5C,IAAK8D,EAAS,KAAM,IAAI7lB,OAAO,0DAI/B,IAFA4T,EAAIoR,gBAAiBpR,EAAIqR,YAAaJ,IAE7BrD,EAAa1nC,eAAgB0nC,EAAa1nC,aAAaoqC,eAE/D,KAAM,IAAIlkB,OAAO,sEAKXoL,GAAWrsB,IAAKyiC,EAAa1nC,cAAe+nC,gBACjDL,EAAa1nC,aAAalD,MAAMyC,QAAUmoC,EAAanoC,OACvDmoC,EAAa1nC,aAAalD,MAAM0C,SAAWkoC,EAAaloC,SAEzDkoC,EAAa1nC,aAAalD,MAAMyC,MAAQmoC,EAAanoC,MACrDmoC,EAAa1nC,aAAalD,MAAM0C,OAASkoC,EAAaloC,OACtDkoC,EAAa1nC,aAAauR,aAAc,GAIzCqQ,EAAc8lB,EAAa1nC,aAAc,EAEzC,IAAIgsC,GAAoB1a,EAAWrsB,IAAKyiC,EAAa1nC,cAAe+nC,cAEpE,IAAKL,EAAa1nC,aAAa5C,SAAWotC,GAEzC1Q,EAAIsR,qBAAsBtR,EAAIqR,YAAarR,EAAI6R,iBAAkB7R,EAAI+K,WAAYmH,EAAmB,OAE9F,CAAA,GAAKtE,EAAa1nC,aAAa5C,SAAWutC,GAMhD,KAAM,IAAIzkB,OAAO,8BAJjB4T,GAAIsR,qBAAsBtR,EAAIqR,YAAarR,EAAI8R,yBAA0B9R,EAAI+K,WAAYmH,EAAmB,IAW9G,QAASC,GAAwBvE,GAEhC,GAAIM,GAAyB1W,EAAWrsB,IAAKyiC,GAEzCqE,EAAWrE,EAAaO,2BAA4B,CAExD,IAAKP,EAAa1nC,aAAe,CAEhC,GAAK+rC,EAAS,KAAM,IAAI7lB,OAAO,2DAE/B4lB,GAAmB9D,EAAuBG,mBAAoBT,OAI9D,IAAKqE,EAAS,CAEb/D,EAAuBI,qBAEvB,KAAM,GAAIx8B,GAAI,EAAGA,EAAI,EAAGA,IAEvBkuB,EAAIoR,gBAAiBpR,EAAIqR,YAAanD,EAAuBG,mBAAoBv8B,IACjFo8B,EAAuBI,mBAAoBx8B,GAAMkuB,EAAIoS,qBACrDb,EAA0BrD,EAAuBI,mBAAoBx8B,GAAK87B,OAM3E5N,GAAIoR,gBAAiBpR,EAAIqR,YAAanD,EAAuBG,oBAC7DH,EAAuBI,mBAAqBtO,EAAIoS,qBAChDb,EAA0BrD,EAAuBI,mBAAoBV,EAMvE5N,GAAIoR,gBAAiBpR,EAAIqR,YAAa,MAKvC,QAASgB,GAAmBzE,GAE3B,GAAIM,GAAyB1W,EAAWrsB,IAAKyiC,GACzCxB,EAAoB5U,EAAWrsB,IAAKyiC,EAAa7nC,QAErD6nC,GAAarrB,iBAAkB,UAAWorB,GAE1CvB,EAAkB6B,eAAiBjO,EAAI8E,gBAEvChoB,EAAKuF,OAAO4B,UAEZ,IAAIguB,GAAWrE,EAAaO,2BAA4B,EACpDmE,EAAqB5G,EAAckC,EAIvC,IAAKqE,EAAS,CAEb/D,EAAuBG,qBAEvB,KAAM,GAAIv8B,GAAI,EAAGA,EAAI,EAAGA,IAEvBo8B,EAAuBG,mBAAoBv8B,GAAMkuB,EAAIuS,wBAMtDrE,GAAuBG,mBAAqBrO,EAAIuS,mBAMjD,IAAKN,EAAS,CAEbt3B,EAAMoqB,YAAa/E,EAAIgL,iBAAkBoB,EAAkB6B,gBAC3DoB,EAAsBrP,EAAIgL,iBAAkB4C,EAAa7nC,QAASusC,EAElE,KAAM,GAAIxgC,GAAI,EAAGA,EAAI,EAAGA,IAEvBk/B,EAAyB9C,EAAuBG,mBAAoBv8B,GAAK87B,EAAc5N,EAAIwS,kBAAmBxS,EAAIiL,4BAA8Bn5B,EAI5Io6B,GAA6B0B,EAAa7nC,QAASusC,IAEvDnG,EAAgBnM,EAAIgL,iBAAkB4C,EAAa7nC,QAAS6nC,EAAanoC,MAAOmoC,EAAaloC,QAI9FiV,EAAMoqB,YAAa/E,EAAIgL,iBAAkB,UAIzCrwB,GAAMoqB,YAAa/E,EAAI+K,WAAYqB,EAAkB6B,gBACrDoB,EAAsBrP,EAAI+K,WAAY6C,EAAa7nC,QAASusC,GAC5DtB,EAAyB9C,EAAuBG,mBAAoBT,EAAc5N,EAAIwS,kBAAmBxS,EAAI+K,YAExGmB,EAA6B0B,EAAa7nC,QAASusC,IAEvDnG,EAAgBnM,EAAI+K,WAAY6C,EAAa7nC,QAAS6nC,EAAanoC,MAAOmoC,EAAaloC,QAIxFiV,EAAMoqB,YAAa/E,EAAI+K,WAAY,KAM/B6C,GAAa5nC,aAEjBmsC,EAAwBvE,GAM1B,QAAS6E,GAA0B7E,GAElC,GAAI7nC,GAAU6nC,EAAa7nC,QACvBusC,EAAqB5G,EAAckC,EAEvC,IAAK1B,EAA6BnmC,EAASusC,GAAuB,CAEjE,GAAIvwB,GAAS6rB,EAAaO,wBAA0BnO,EAAIgL,iBAAmBhL,EAAI+K,WAC3Eb,EAAe1S,EAAWrsB,IAAKpF,GAAUkoC,cAE7CtzB,GAAMoqB,YAAahjB,EAAQmoB,GAC3BiC,EAAgBpqB,EAAQhc,EAAS6nC,EAAanoC,MAAOmoC,EAAaloC,QAClEiV,EAAMoqB,YAAahjB,EAAQ,OAM7B,QAAS0sB,GAAoB1oC,GAE5B,GAAImc,GAAKnc,EAAQmc,GACb9Z,EAAQ0U,EAAKjC,OAAOzS,KAInBslC,GAAgBxrB,KAAS9Z,IAE7BslC,EAAgBxrB,GAAO9Z,EACvBrC,EAAQyF,UA52BV,GACIugC,GADA2B,IAk3BJ5rC,MAAKgmB,aAAeA,EACpBhmB,KAAKmmB,eAAiBA,EACtBnmB,KAAK4tC,sBAAwBA,EAC7B5tC,KAAKuwC,kBAAoBA,EACzBvwC,KAAK2wC,yBAA2BA,EAQjC,QAASC,IAAY3pC,EAAIqQ,EAAY2D,GAEpC,QAAS+pB,GAAS7P,GAEjB,GAAI7Z,EAEJ,IAAK6Z,IAAM0b,GAAiB,MAAO5pC,GAAG6pC,MACtC,IAAK3b,IAAM5yB,GAAsB,MAAO0E,GAAG+mC,aAC3C,IAAK7Y,IAAM4b,GAAyB,MAAO9pC,GAAG+pC,eAE9C,IAAK7b,IAAMxwB,GAAgB,MAAOsC,GAAGm8B,OACrC,IAAKjO,IAAMmW,GAA6B,MAAOrkC,GAAGgqC,sBAClD,IAAK9b,IAAMoW,GAA4B,MAAOtkC,GAAGiqC,qBAEjD,IAAK/b,IAAM3yB,GAAe,MAAOyE,GAAGukC,MACpC,IAAKrW,IAAMgc,GAA4B,MAAOlqC,GAAGmqC,qBACjD,IAAKjc,IAAM1yB,GAA2B,MAAOwE,GAAGoqC,oBAEhD,IAAKlc,IAAMxyB,GAAmB,MAAOsE,GAAG4B,aACxC,IAAKssB,IAAMmc,GAAwB,MAAOrqC,GAAGsqC,sBAC7C,IAAKpc,IAAMqc,GAAwB,MAAOvqC,GAAGwqC,sBAC7C,IAAKtc,IAAMuc,GAAuB,MAAOzqC,GAAG0qC,oBAE5C,IAAKxc,IAAMyc,GAAW,MAAO3qC,GAAG0B,IAChC,IAAKwsB,IAAM0c,GAAY,MAAO5qC,GAAGoB,KACjC,IAAK8sB,IAAM0Z,GAAoB,MAAO5nC,GAAGkB,cACzC,IAAKgtB,IAAM2c,GAAU,MAAO7qC,GAAGwB,GAC/B,IAAK0sB,IAAM2Z,GAAkB,MAAO7nC,GAAGsB,YACvC,IAAK4sB,IAAM8Y,GAAY,MAAOhnC,GAAGa,KAEjC,IAAKqtB,IAAM+Y,GAAgB,CAE1B,GAAKjzB,EAAaM,SAAW,MAAOtU,GAAG6jC,UAIvC,IAFAxvB,EAAYhE,EAAWjO,IAAK,0BAET,OAAdiS,EAAqB,MAAOA,GAAUy2B,eAI5C,GAAK5c,IAAM6c,GAAc,MAAO/qC,GAAGgrC,KACnC,IAAK9c,IAAMwY,GAAY,MAAO1mC,GAAG2jC,GACjC,IAAKzV,IAAMzyB,GAAa,MAAOuE,GAAGs8B,IAClC,IAAKpO,IAAM+c,GAAkB,MAAOjrC,GAAGkrC,SACvC,IAAKhd,IAAMid,GAAuB,MAAOnrC,GAAGorC,eAC5C,IAAKld,IAAMyZ,GAAc,MAAO3nC,GAAGwnC,eACnC,IAAKtZ,IAAM4Z,GAAqB,MAAO9nC,GAAG+nC,aAE1C,IAAK7Z,IAAM7gB,GAAc,MAAOrN,GAAGu+B,QACnC,IAAKrQ,IAAMmd,GAAmB,MAAOrrC,GAAGsrC,aACxC,IAAKpd,IAAMqd,GAA0B,MAAOvrC,GAAGwrC,qBAE/C,IAAKtd,IAAMud,GAAa,MAAOzrC,GAAG6+B,IAClC,IAAK3Q,IAAMwd,GAAY,MAAO1rC,GAAGw+B,GACjC,IAAKtQ,IAAMyd,GAAiB,MAAO3rC,GAAGg/B,SACtC,IAAK9Q,IAAM0d,GAAyB,MAAO5rC,GAAG8+B,mBAC9C,IAAK5Q,IAAMjhB,GAAiB,MAAOjN,GAAGi/B,SACtC,IAAK/Q,IAAM/gB,GAAyB,MAAOnN,GAAGy+B,mBAC9C,IAAKvQ,IAAM2d,GAAiB,MAAO7rC,GAAG8rC,SACtC,IAAK5d,IAAM6d,GAAyB,MAAO/rC,GAAGgsC,mBAE9C,IAAK9d,IAAM+d,GAAiB,MAAOjsC,GAAGksC,SACtC,IAAKhe,IAAMie,GAAyB,MAAOnsC,GAAGosC,mBAC9C,IAAKle,IAAMme,GAAyB,MAAOrsC,GAAGssC,kBAE9C,KAAKpe,IAAMqe,IAAwBre,IAAMse,IACxCte,IAAMue,IAAyBve,IAAMwe,MAErCr4B,EAAYhE,EAAWjO,IAAK,iCAET,OAAdiS,GAAqB,CAEzB,GAAK6Z,IAAMqe,GAAuB,MAAOl4B,GAAUs4B,4BACnD,IAAKze,IAAMse,GAAwB,MAAOn4B,GAAUu4B,6BACpD,IAAK1e,IAAMue,GAAwB,MAAOp4B,GAAUw4B,6BACpD,IAAK3e,IAAMwe,GAAwB,MAAOr4B,GAAUy4B,8BAMtD,IAAK5e,IAAM6e,IAA2B7e,IAAM8e,IAC3C9e,IAAM+e,IAA4B/e,IAAMgf,MAExC74B,EAAYhE,EAAWjO,IAAK,kCAET,OAAdiS,GAAqB,CAEzB,GAAK6Z,IAAM6e,GAA0B,MAAO14B,GAAU84B,+BACtD,IAAKjf,IAAM8e,GAA0B,MAAO34B,GAAU+4B,+BACtD,IAAKlf,IAAM+e,GAA2B,MAAO54B,GAAUg5B,gCACvD,IAAKnf,IAAMgf,GAA2B,MAAO74B,GAAUi5B,iCAMzD,GAAKpf,IAAMqf,KAEVl5B,EAAYhE,EAAWjO,IAAK,iCAET,OAAdiS,GAAqB,MAAOA,GAAUm5B,yBAI5C,KAAKtf,IAAMuf,IAAwBvf,IAAMwf,IAAwBxf,IAAMyf,IACtEzf,IAAM0f,IAAwB1f,IAAM2f,IAAwB3f,IAAM4f,IAClE5f,IAAM6f,IAAwB7f,IAAM8f,IAAwB9f,IAAM+f,IAClE/f,IAAMggB,IAAyBhgB,IAAMigB,IAAyBjgB,IAAMkgB,IACpElgB,IAAMmgB,IAA0BngB,IAAMogB,MAEtCj6B,EAAYhE,EAAWjO,IAAK,iCAET,OAAdiS,GAEJ,MAAO6Z,EAMT,IAAKA,IAAMqgB,IAAergB,IAAMsgB,GAAc,CAE7C,GAAKx6B,EAAaM,SAAW,CAE5B,GAAK4Z,IAAMqgB,GAAc,MAAOvuC,GAAGyuC,GACnC,IAAKvgB,IAAMsgB,GAAc,MAAOxuC,GAAG0uC,IAMpC,GAFAr6B,EAAYhE,EAAWjO,IAAK,oBAET,OAAdiS,EAAqB,CAEzB,GAAK6Z,IAAMqgB,GAAc,MAAOl6B,GAAUs6B,OAC1C,IAAKzgB,IAAMsgB,GAAc,MAAOn6B,GAAUu6B,SAM5C,GAAK1gB,IAAM8Z,GAAqB,CAE/B,GAAKh0B,EAAaM,SAAW,MAAOtU,GAAG6uC,iBAIvC,IAFAx6B,EAAYhE,EAAWjO,IAAK,uBAET,OAAdiS,EAAqB,MAAOA,GAAUy6B,wBAI5C,MAAO,GAIR,OAAS/Q,QAASA,GAQnB,QAASgR,MAER9rC,EAAS5F,KAAMtE,MAEfA,KAAKyB,KAAO,QAmBb,QAASw0C,IAAmBC,EAAKC,EAAQ3pC,EAAMC,GAE9CV,EAAOzH,KAAMtE,MAEbA,KAAKyB,KAAO,oBAEZzB,KAAKk2C,IAAcp1C,SAARo1C,EAAoBA,EAAM,GACrCl2C,KAAK0M,KAAO,EAEZ1M,KAAKwM,KAAgB1L,SAAT0L,EAAqBA,EAAO,GACxCxM,KAAKyM,IAAc3L,SAAR2L,EAAoBA,EAAM,IACrCzM,KAAKo2C,MAAQ,GAEbp2C,KAAKm2C,OAAoBr1C,SAAXq1C,EAAuBA,EAAS,EAC9Cn2C,KAAK2M,KAAO,KAEZ3M,KAAKq2C,UAAY,GACjBr2C,KAAKs2C,WAAa,EAElBt2C,KAAK4M,yBAwNN,QAAS2pC,IAAalvC,GAErB4uC,GAAkB3xC,KAAMtE,MAExBA,KAAKw2C,QAAUnvC,MAgBhB,QAASovC,IAAc79B,GAsCtB,QAAS89B,KAER,MAAkB,QAAXC,GAAmBA,EAAOD,gBAAiB,EAMnD,QAASE,KAER,GAAKF,IAAiB,CAErB,GAAIG,GAAgBF,EAAOG,iBAAkB,QACzCC,EAAcF,EAAcE,YAC5BC,EAAeH,EAAcG,YAEjCC,GAAoBr+B,EAASs+B,gBAC7BC,EAAcv+B,EAASw+B,UAEvBx+B,EAASy+B,qBAAoC,EAAdN,EAAiBC,EAAc,GAE9DM,EAAU3wC,YAEC6L,GAAM2M,UAEjBvG,EAASy+B,qBAAsBF,EAAYxzC,MAAOwzC,EAAYvzC,OAAQqzC,GAEtEK,EAAU1wC,QAUZ,QAAS2wC,GAAan3B,GAIrB,IAAM,GAFFo3B,GAAWC,UAAUC,aAAeD,UAAUC,cAExC1nC,EAAI,EAAGy9B,EAAI,EAAGx9B,EAAIunC,EAASp3C,OAAQ4P,EAAIC,EAAGD,IAAO,CAE1D,GAAI2nC,GAAUH,EAAUxnC,EAExB,IAAK2nC,IAA4B,wBAAfA,EAAQv3B,IACV,uBAAfu3B,EAAQv3B,IAA8C,yBAAfu3B,EAAQv3B,IAChC,mBAAfu3B,EAAQv3B,IAA2Bu3B,EAAQv3B,GAAGw3B,WAAY,iBAC1DD,EAAQv3B,GAAGw3B,WAAY,uBAA2B,CAElD,GAAKnK,IAAMrtB,EAAK,MAAOu3B,EAEvBlK,OAQH,QAASoK,KAER,IAAM,GAAI7nC,GAAI,EAAGA,EAAI8nC,EAAY13C,OAAQ4P,IAAO,CAE/C,GAAI+nC,GAAaD,EAAa9nC,GAE1B2nC,EAAUJ,EAAavnC,EAE3B,IAAiBlP,SAAZ62C,GAA0C72C,SAAjB62C,EAAQK,KAAqB,CAE1D,GAAsB,OAAjBL,EAAQK,KAAgB,MAI7B,IAAIA,GAAOL,EAAQK,IAEdA,GAAKC,eAAgB,GAAQF,EAAWjtC,SAAS7E,IAAK,aAEpC,OAAlB+xC,EAAKltC,UAAoBitC,EAAWjtC,SAASotC,UAAWF,EAAKltC,UACxC,OAArBktC,EAAKG,aAAuBJ,EAAW3tC,WAAW8tC,UAAWF,EAAKG,aACvEJ,EAAW90C,OAAOm1C,QAASL,EAAWjtC,SAAUitC,EAAW3tC,WAAY2tC,EAAWhtC,OAClFgtC,EAAW90C,OAAOo2B,YAAagf,GAC/BN,EAAW90C,OAAOq1C,UAAWP,EAAWjtC,SAAUitC,EAAW3tC,WAAY2tC,EAAWhtC,OACpFgtC,EAAWxsC,wBAAyB,EACpCwsC,EAAWtsC,SAAU,CAIrB,IAAI8sC,GAA0B,wBAAfZ,EAAQv3B,GAA+B,EAAI,CAErDo4B,GAAUxoC,KAAQ2nC,EAAQc,QAASF,GAAWG,UAElDF,EAAUxoC,GAAM2nC,EAAQc,QAASF,GAAWG,QAEvCF,EAAUxoC,MAAQ,EAEtB+nC,EAAWY,eAAiBl3C,KAAM,iBAIlCs2C,EAAWY,eAAiBl3C,KAAM,cAClCs2C,EAAWY,eAAiBl3C,KAAM,iBAQpCs2C,GAAWtsC,SAAU,GAjJxB,GAAI+G,GAAQxS,KAER22C,EAAS,KACTiC,EAAY,KAEZC,EAAa,KAEbf,KACAO,EAAiB,GAAIp4C,GACrB64C,EAAwB,GAAI74C,EAET,oBAAX84C,SAA0B,eAAiBA,UAEtDH,EAAY,GAAIG,QAAOC,YACvBD,OAAOt4B,iBAAkB,yBAA0Bm2B,GAA0B,GAI9E,IAAI5qC,GAAqB,GAAI/L,GACzBg5C,EAAiB,GAAI14C,GACrB24C,EAAe,GAAIn4C,GAEnBo4C,EAAU,GAAIlD,GAClBkD,GAAQC,OAAS,GAAI31C,GAAS,EAAK,EAAK,GAAK,GAC7C01C,EAAQ3tC,OAAO+0B,OAAQ,EAEvB,IAAI8Y,GAAU,GAAIpD,GAClBoD,GAAQD,OAAS,GAAI31C,GAAS,GAAK,EAAK,GAAK,GAC7C41C,EAAQ7tC,OAAO+0B,OAAQ,EAEvB,IAAI+Y,GAAW,GAAI/C,KAAe4C,EAASE,GAC3CC,GAAS9tC,OAAO+0B,OAAQ,GACxB+Y,EAAS9tC,OAAO+0B,OAAQ,EAUxB,IAAI4W,GAAaF,EA6BbuB,IAoFJx4C,MAAKmf,SAAU,EACfnf,KAAKu5C,WAAa,IAElBv5C,KAAKw5C,cAAgB,SAAWp5B,GAE/B,GAAI23B,GAAaD,EAAa13B,EAY9B,OAVoBtf,UAAfi3C,IAEJA,EAAa,GAAI/B,IACjB+B,EAAW/0C,kBAAmB,EAC9B+0C,EAAWtsC,SAAU,EAErBqsC,EAAa13B,GAAO23B,GAIdA,GAIR/3C,KAAKy5C,UAAY,WAEhB,MAAO9C,IAIR32C,KAAK05C,UAAY,SAAW53C,GAEZhB,SAAVgB,IAAsB60C,EAAS70C,GAEpCw1C,EAAUvwC,WAAYjF,IAIvB9B,KAAK25C,cAAgB,SAAWn5B,GAEf1f,SAAX0f,IAAuBq4B,EAAar4B,IAI1CxgB,KAAK45C,UAAY,SAAW1gC,GAE3B,GAAgB,OAAXy9B,EAGJ,MADAz9B,GAAOpO,SAAS7E,IAAK,EAAGuM,EAAM+mC,WAAY,GACnCrgC,CAIRy9B,GAAOkD,UAAY3gC,EAAO1M,KAC1BmqC,EAAOmD,SAAW5gC,EAAOzM,IAEzBkqC,EAAOoD,aAAcnB,EAIrB,IAAIoB,GAAkBrD,EAAOqD,eAExBA,GAEJ3B,EAAeH,UAAW8B,EAAgBC,4BAI1C5B,EAAetZ,gBAAiB,EAAGvsB,EAAM+mC,WAAY,EAKtD,IAAIvB,GAAOY,EAAUZ,KACjBkC,EAA4B,OAAfrB,EAAsBA,EAAa3/B,CAwBpD,IArBAghC,EAAWj3C,OAAO2b,KAAMy5B,GACxB6B,EAAWj3C,OAAOq1C,UAAW4B,EAAWpvC,SAAUovC,EAAW9vC,WAAY8vC,EAAWnvC,OAE1D,OAArBitC,EAAKG,cAETc,EAAef,UAAWF,EAAKG,aAC/B+B,EAAW9vC,WAAW80B,SAAU+Z,IAIV,OAAlBjB,EAAKltC,WAETmuC,EAAekB,sBAAuB9B,GACtCa,EAAahB,UAAWF,EAAKltC,UAC7BouC,EAAakB,gBAAiBnB,GAC9BiB,EAAWpvC,SAASu0B,IAAK6Z,IAI1BgB,EAAWjb,oBAEN0X,EAAOD,gBAAiB,EAAQ,MAAOx9B,EAI5CigC,GAAQ3sC,KAAO0M,EAAO1M,KACtB6sC,EAAQ7sC,KAAO0M,EAAO1M,KAEtB2sC,EAAQ1sC,IAAMyM,EAAOzM,IACrB4sC,EAAQ5sC,IAAMyM,EAAOzM,IAErB6sC,EAASjuC,YAAYuT,KAAM1F,EAAO7N,aAClCiuC,EAASttC,mBAAmB4S,KAAM1F,EAAOlN,oBAEzCmtC,EAAQntC,mBAAmBksC,UAAWU,EAAUyB,gBAChDhB,EAAQrtC,mBAAmBksC,UAAWU,EAAU0B,iBAIhDxB,EAAsByB,WAAYlC,GAElCc,EAAQntC,mBAAmBkzB,SAAU4Z,GACrCO,EAAQrtC,mBAAmBkzB,SAAU4Z,EAErC,IAAIruC,GAASyvC,EAAWzvC,MAER,QAAXA,IAEJuB,EAAmBuuC,WAAY9vC,EAAOY,aAEtC8tC,EAAQntC,mBAAmBkzB,SAAUlzB,GACrCqtC,EAAQrtC,mBAAmBkzB,SAAUlzB,IAMtCmtC,EAAQ9tC,YAAYkvC,WAAYpB,EAAQntC,oBACxCqtC,EAAQhuC,YAAYkvC,WAAYlB,EAAQrtC,oBAExCmtC,EAAQltC,iBAAiBisC,UAAWU,EAAU4B,sBAC9CnB,EAAQptC,iBAAiBisC,UAAWU,EAAU6B,uBAK9CnB,EAASrtC,iBAAiB2S,KAAMu6B,EAAQltC,iBAIxC,IAAIT,GAASmrC,EAAO+D,WAEpB,IAAKlvC,EAAOpL,OAAS,CAEpB,GAAIu6C,GAAQnvC,EAAQ,EAEM,QAArBmvC,EAAMC,YAAmD,IAA5BD,EAAMC,WAAWx6C,QAElD+4C,EAAQC,OAAOlB,UAAWyC,EAAMC,YAIN,OAAtBD,EAAME,aAAqD,IAA7BF,EAAME,YAAYz6C,QAEpDi5C,EAAQD,OAAOlB,UAAWyC,EAAME,aAQlC,MAFAhD,KAEOyB,GAIRt5C,KAAK86C,kBAAoB,WAExB,MAAOzC,IAIRr4C,KAAK02C,aAAeA,CAIpB,IAAIY,GAAY,GAAInxC,EAEpBnG,MAAK6G,iBAAmB,SAAWC,GAElCwwC,EAAUzwC,iBAAkBC,IAI7B9G,KAAK+6C,YAAc,WAEbrE,KAAiBC,EAAOoE,eAI9B/6C,KAAKsjB,QAAU,WAES,mBAAXy1B,SAEXA,OAAO14B,oBAAqB,yBAA0Bu2B,IAYzD,QAASoE,IAAcpiC,GActB,QAAS89B,KAER,MAAmB,QAAZuE,GAAmC,OAAfC,EAwD5B,QAASC,GAAgBn7B,GAExB,GAAI+3B,GAAaD,EAAasD,EAAa7lB,QAASvV,EAAMq7B,aACrDtD,IAAaA,EAAWY,eAAiBl3C,KAAMue,EAAMve,OAI3D,QAAS65C,KAER1iC,EAAS2iC,eAAgB,MACzBjE,EAAU1wC,OA0CX,QAAS40C,GAActiC,EAAQzO,GAEd,OAAXA,EAEJyO,EAAO7N,YAAYuT,KAAM1F,EAAOjW,QAIhCiW,EAAO7N,YAAYyxB,iBAAkBryB,EAAOY,YAAa6N,EAAOjW,QAIjEiW,EAAOlN,mBAAmBuuC,WAAYrhC,EAAO7N,aA+C9C,QAASjF,GAAkBC,EAAMC,GAIhC,GAFA0xC,EAAO1xC,EAAMm1C,cAAeP,GAEd,OAATlD,EAKJ,IAAM,GAHF2C,GAAQM,EAAQS,UAChBC,EAAQr1C,EAAMq1C,MAER3rC,EAAI,EAAGA,EAAI2rC,EAAMv7C,OAAQ4P,IAAO,CAEzC,GAAIrD,GAAOgvC,EAAO3rC,GACdhM,EAAW22C,EAAMiB,YAAajvC,GAC9B4R,EAAay5B,EAAK6D,cAAelvC,GAEjCuM,EAASogC,EAAS9C,QAASxmC,EAC/BkJ,GAAOjW,OAAOi1C,UAAW35B,GAAag8B,WAAYrhC,EAAOjW,QACzDiW,EAAOjN,iBAAiBisC,UAAWvrC,EAAKV,kBACxCiN,EAAOlV,SAASiC,IAAKjC,EAASlE,EAAGkE,EAASjE,EAAGiE,EAASL,MAAOK,EAASJ,QAE3D,IAANoM,IAEJspC,EAASr2C,OAAO2b,KAAM1F,EAAOjW,QAK7Bq2C,EAASrtC,iBAAiB2S,KAAM1F,EAAOjN,mBAU1C,IAAM,GAAI+D,GAAI,EAAGA,EAAI8nC,EAAY13C,OAAQ4P,IAAO,CAE/C,GAAI+nC,GAAaD,EAAa9nC,GAE1BqrC,EAAcD,EAAcprC,EAEhC,IAAKqrC,EAAc,CAElB,GAAIS,GAAYx1C,EAAMy1C,aAAcV,EAAaH,EAEjD,IAAmB,OAAdY,EAAqB,CAEpB,aAAeA,GAEnB/D,EAAW90C,OAAO/C,SAAW47C,EAAUE,UAAUC,gBAEtC,iBAAmBH,KAI9B/D,EAAW90C,OAAO/C,SAAW47C,EAAUI,eAIxCnE,EAAW90C,OAAOq1C,UAAWP,EAAWjtC,SAAUitC,EAAWh1C,SAAUg1C,EAAWhtC,OAClFgtC,EAAWtsC,SAAU,CAErB,WAMFssC,EAAWtsC,SAAU,EAIjB0wC,GAA2BA,EAA0B91C,GA/P3D,GAAIY,GAAK2R,EAASnS,QAEdkwC,EAAS,KACTsE,EAAU,KAEVC,EAAa,KAEblD,EAAO,KAEPF,KACAsD,KAWAjC,EAAU,GAAIlD,GAClBkD,GAAQ3tC,OAAO+0B,OAAQ,GACvB4Y,EAAQn1C,SAAW,GAAIP,EAEvB,IAAI41C,GAAU,GAAIpD,GAClBoD,GAAQ7tC,OAAO+0B,OAAQ,GACvB8Y,EAAQr1C,SAAW,GAAIP,EAEvB,IAAI61C,GAAW,GAAI/C,KAAe4C,EAASE,GAC3CC,GAAS9tC,OAAO+0B,OAAQ,GACxB+Y,EAAS9tC,OAAO+0B,OAAQ,GAIxBvgC,KAAKmf,SAAU,EAEfnf,KAAKw5C,cAAgB,SAAWp5B,GAE/B,GAAI23B,GAAaD,EAAa13B,EAY9B,OAVoBtf,UAAfi3C,IAEJA,EAAa,GAAI/B,IACjB+B,EAAW/0C,kBAAmB,EAC9B+0C,EAAWtsC,SAAU,EAErBqsC,EAAa13B,GAAO23B,GAIdA,GAIR/3C,KAAKy5C,UAAY,WAEhB,MAAO9C,IAIR32C,KAAK05C,UAAY,SAAW53C,GAEZhB,SAAVgB,IAAsB60C,EAAS70C,GAC/BA,YAAiBs6C,WAAWn1C,EAAGo1C,sBAAuBv6C,IAoB5D9B,KAAKs8C,WAAa,SAAWx6C,EAAO+B,GAEnCo3C,EAAUn5C,EAEO,OAAZm5C,IAEJA,EAAQx6B,iBAAkB,SAAU06B,GACpCF,EAAQx6B,iBAAkB,cAAe06B,GACzCF,EAAQx6B,iBAAkB,YAAa06B,GACvCF,EAAQx6B,iBAAkB,MAAO66B,GAEjCL,EAAQS,UAAY,GAAIa,cAActB,EAASh0C,GAC/Cg0C,EAAQuB,wBAAyB34C,EAAQ44C,sBAAuBC,KAAM,SAAW56C,GAEhFo5C,EAAap5C,EAEb8W,EAAS2iC,eAAgBN,EAAQS,UAAUvM,aAE3CmI,EAAUvwC,WAAYk0C,GACtB3D,EAAU3wC,UAMXy0C,EAAeH,EAAQ0B,kBAEvB1B,EAAQx6B,iBAAkB,qBAAsB,WAE/C26B,EAAeH,EAAQ0B,kBACvBt8C,QAAQixB,IAAK8pB,OAwBhBp7C,KAAK45C,UAAY,SAAW1gC,GAE3B,GAAKw9B,IAAiB,CAErB,GAAIjsC,GAASyO,EAAOzO,OAChB+rC,EAAU8C,EAAS9C,OAIvBgF,GAAclC,EAAU7uC,EAExB,KAAM,GAAIuF,GAAI,EAAGA,EAAIwmC,EAAQp2C,OAAQ4P,IAEpCwrC,EAAchF,EAASxmC,GAAKvF,EAM7ByO,GAAO7N,YAAYuT,KAAM06B,EAASjuC,YAIlC,KAAM,GAFFX,GAAWwO,EAAOxO,SAEZsF,EAAI,EAAGC,EAAIvF,EAAStK,OAAQ4P,EAAIC,EAAGD,IAE5CtF,EAAUsF,GAAIivB,mBAAmB,EAIlC,OAAOqa,GAIR,MAAOpgC,IAIRlZ,KAAK02C,aAAeA,CAIpB,IAAIyF,GAA2B,KAgF3B7E,EAAY,GAAInxC,EACpBmxC,GAAUzwC,iBAAkBT,GAE5BpG,KAAK6G,iBAAmB,SAAWC,GAElCq1C,EAA2Br1C,GAI5B9G,KAAKsjB,QAAU,aAIftjB,KAAK86C,kBAAoB,WAGxB,MADAz6C,SAAQ4H,KAAM,gEACP,GAAI20C,OAAM38C,SAIlBD,KAAK+6C,YAAc,aAYpB,QAAS8B,IAAehsC,GA0HvB,QAASisC,KAER,MAAgC,QAAzBC,GAAgCC,GAAc,EAmEtD,QAASC,KAER3lC,GAAa,GAAIsI,GAAiBse,IAElCjjB,GAAe,GAAIQ,GAAmByiB,GAAK5mB,GAAYzG,GAEhDoK,GAAaM,WAEnBjE,GAAWjO,IAAK,uBAChBiO,GAAWjO,IAAK,qBAChBiO,GAAWjO,IAAK,0BAChBiO,GAAWjO,IAAK,iCAChBiO,GAAWjO,IAAK,4BAChBiO,GAAWjO,IAAK,0BAChBiO,GAAWjO,IAAK,2BAIjBiO,GAAWjO,IAAK,4BAEhBo2B,GAAQ,GAAImR,IAAY1S,GAAK5mB,GAAY2D,IAEzCpC,GAAQ,GAAI2mB,IAAYtB,GAAK5mB,GAAYmoB,GAAOxkB,IAChDpC,GAAM/U,QAASo5C,GAAgBt+B,KAAMu+B,IAAWjlB,eAAgB8kB,KAChEnkC,GAAM7U,SAAUo5C,GAAiBx+B,KAAMy+B,IAAYnlB,eAAgB8kB,KAEnEhiC,GAAO,GAAIqG,IAAW6c,IACtBxI,GAAa,GAAID,IACjBtT,GAAW,GAAIinB,IAAelL,GAAK5mB,GAAYuB,GAAO6c,GAAYza,GAAcwkB,GAAOzkB,IACvF3K,GAAa,GAAIrJ,GAAiBk3B,IAClC/d,GAAa,GAAIL,GAAiBoe,GAAK7tB,GAAY2K,IACnDlC,GAAU,GAAIqK,IAAchD,GAAYnF,IACxCsiC,GAAe,GAAI96B,IAAmB0b,IACtCqf,GAAe,GAAIvrB,IAAewrB,GAAOlmC,GAAY2D,IACrDwiC,GAAc,GAAIrnB,IAClBoE,GAAe,GAAIF,IAEnBlhB,GAAa,GAAIT,GAAiB6kC,GAAO3kC,GAAOC,GAAS4kC,GAEzDC,GAAiB,GAAI5iC,GAAqBmjB,GAAK5mB,GAAY0D,GAAMC,IACjE2iC,GAAwB,GAAIz8B,IAA4B+c,GAAK5mB,GAAY0D,GAAMC,IAE/ED,GAAKoH,SAAWm7B,GAAan7B,SAE7Bo7B,GAAM/2C,QAAUy3B,GAChBsf,GAAMviC,aAAeA,GACrBuiC,GAAMlmC,WAAaA,GACnBkmC,GAAM9nB,WAAaA,GACnB8nB,GAAMC,YAAcA,GACpBD,GAAM3kC,MAAQA,GACd2kC,GAAMxiC,KAAOA,GAqOd,QAAS6iC,GAAe79B,GAEvBA,EAAM89B,iBAENz9C,QAAQixB,IAAK,sCAEbysB,IAAiB,EAIlB,QAASC,KAER39C,QAAQixB,IAAK,0CAEbysB,IAAiB,EAEjBd,IAID,QAASgB,GAAmBj+B,GAE3B,GAAI1H,GAAW0H,EAAMC,MAErB3H,GAAS+H,oBAAqB,UAAW49B,GAEzCC,EAAoB5lC,GAMrB,QAAS4lC,GAAoB5lC,GAE5B6lC,EAAiC7lC,GAEjCod,GAAWlsB,OAAQ8O,GAKpB,QAAS6lC,GAAiC7lC,GAEzC,GAAI+c,GAAcK,GAAWrsB,IAAKiP,GAAWmK,OAE7CnK,GAASmK,QAAU3hB,OAEEA,SAAhBu0B,GAEJkoB,GAAajoB,eAAgBD,GAQ/B,QAAS+oB,GAAuB59B,EAAQiC,GAEvCjC,EAAOzH,OAAQ,SAAWyH,GAEzBg9B,GAAMa,sBAAuB79B,EAAQiC,KA8OvC,QAAS67B,GAAuBhmC,EAAUmK,EAASpK,GAElD,GAAKA,GAAYA,EAASkmC,2BAA8BtjC,GAAaM,UAEhB,OAA/CjE,GAAWjO,IAAK,0BAGpB,WADAhJ,SAAQC,MAAO,iJAOjBuY,IAAM2qB,gBAEN,IAAI1iB,GAAqBzI,EAAShI,WAE9BmuC,EAAoB/7B,EAAQkP,gBAE5B8sB,EAAiCnmC,EAASX,sBAE9C,KAAM,GAAIxV,KAAQq8C,GAAoB,CAErC,GAAIE,GAAmBF,EAAmBr8C,EAE1C,IAAKu8C,GAAoB,EAAI,CAE5B,GAAIC,GAAoB79B,EAAoB3e,EAE5C,IAA2BrB,SAAtB69C,EAAkC,CAEtC,GAAI7vC,GAAa6vC,EAAkB7vC,WAC/BmY,EAAO03B,EAAkB9vC,SAEzB1H,EAAYkJ,GAAWhH,IAAKs1C,EAIhC,IAAmB79C,SAAdqG,EAA0B,QAE/B,IAAIO,GAASP,EAAUO,OACnBjG,EAAO0F,EAAU1F,KACjBqH,EAAkB3B,EAAU2B,eAEhC,IAAK61C,EAAkBr1C,6BAA+B,CAErD,GAAI5E,GAAOi6C,EAAkBj6C,KACzBk6C,EAASl6C,EAAKk6C,OACdh8C,EAAS+7C,EAAkB/7C,MAE1B8B,IAAQA,EAAKm6C,8BAEjBhmC,GAAM8qB,0BAA2B+a,EAAkBh6C,EAAKk/B,kBAEpB9iC,SAA/BuX,EAASmD,oBAEbnD,EAASmD,kBAAoB9W,EAAKk/B,iBAAmBl/B,EAAKwE,QAM3D2P,GAAM6qB,gBAAiBgb,GAIxBxgB,GAAIv2B,WAAYu2B,GAAIld,aAActZ,GAClCw2B,GAAI4gB,oBAAqBJ,EAAkBz3B,EAAMxlB,EAAMqN,EAAY8vC,EAAS91C,EAAiBlG,EAASkG,OAIjG61C,GAAkBI,4BAEtBlmC,GAAM8qB,0BAA2B+a,EAAkBC,EAAkB/a,kBAEjC9iC,SAA/BuX,EAASmD,oBAEbnD,EAASmD,kBAAoBmjC,EAAkB/a,iBAAmB+a,EAAkBz1C,QAMrF2P,GAAM6qB,gBAAiBgb,GAIxBxgB,GAAIv2B,WAAYu2B,GAAIld,aAActZ,GAClCw2B,GAAI4gB,oBAAqBJ,EAAkBz3B,EAAMxlB,EAAMqN,EAAY,EAAG,OAIjE,IAAwChO,SAAnC29C,EAA+C,CAE1D,GAAI38C,GAAQ28C,EAAgCt8C,EAE5C,IAAerB,SAAVgB,EAEJ,OAASA,EAAM1B,QAEd,IAAK,GACJ89B,GAAI8gB,gBAAiBN,EAAkB58C,EACvC,MAED,KAAK,GACJo8B,GAAI+gB,gBAAiBP,EAAkB58C,EACvC,MAED,KAAK,GACJo8B,GAAIghB,gBAAiBR,EAAkB58C,EACvC,MAED,SACCo8B,GAAIihB,gBAAiBT,EAAkB58C,MAY7C+W,GAAMmrB,0BAyDP,QAAS59B,GAAkBC,GAErB+4C,GAAG1I,gBACHyF,IAA2BA,GAA0B91C,GAuN3D,QAASg5C,GAAe7+B,EAAQtH,EAAQomC,GAEvC,GAAK9+B,EAAO/U,WAAY,EAAxB,CAEA,GAAIA,GAAU+U,EAAOhV,OAAOgxB,KAAMtjB,EAAO1N,OAEzC,IAAKC,EAEJ,GAAK+U,EAAO++B,QAEXC,GAAmBtlB,UAAW1Z,GAEzBA,EAAO9U,YAEX8zC,GAAmBrlB,WAAY3Z,OAI1B,IAAKA,EAAOi/B,UAElB,IAAOj/B,EAAO5U,eAAiBgxB,GAAS8iB,iBAAkBl/B,GAAW,CAE/D8+B,GAEJK,GAASxnB,sBAAuB3X,EAAOnV,aACrCwT,aAAcue,GAIjB,IAAI/kB,GAAWS,GAAQpP,OAAQ8W,GAC3BlI,EAAWkI,EAAOlI,QAEtBsnC,IAAkBxtC,KAAMoO,EAAQnI,EAAUC,EAAUqnC,GAASn/C,EAAG,WAI3D,IAAKggB,EAAOq/B,wBAEbP,GAEJK,GAASxnB,sBAAuB3X,EAAOnV,aACrCwT,aAAcue,IAIjBwiB,GAAkBxtC,KAAMoO,EAAQ,KAAMA,EAAOlI,SAAUqnC,GAASn/C,EAAG,UAE7D,KAAKggB,EAAOic,QAAUjc,EAAOkc,QAAUlc,EAAOmc,YAE/Cnc,EAAOqT,eAEXrT,EAAO0R,SAASxoB,UAIV8W,EAAO5U,eAAiBgxB,GAASC,iBAAkBrc,IAAW,CAE/D8+B,GAEJK,GAASxnB,sBAAuB3X,EAAOnV,aACrCwT,aAAcue,GAIjB,IAAI/kB,GAAWS,GAAQpP,OAAQ8W,GAC3BlI,EAAWkI,EAAOlI,QAEtB,IAAKlL,MAAMC,QAASiL,GAInB,IAAM,GAFFxI,GAASuI,EAASvI,OAEZE,EAAI,EAAGC,EAAIH,EAAO1P,OAAQ4P,EAAIC,EAAGD,IAAO,CAEjD,GAAIimB,GAAQnmB,EAAQE,GAChBitB,EAAgB3kB,EAAU2d,EAAMhpB,cAE/BgwB,IAAiBA,EAAcxxB,SAEnCm0C,GAAkBxtC,KAAMoO,EAAQnI,EAAU4kB,EAAe0iB,GAASn/C,EAAGy1B,OAM5D3d,GAAS7M,SAEpBm0C,GAAkBxtC,KAAMoO,EAAQnI,EAAUC,EAAUqnC,GAASn/C,EAAG,MAYpE,IAAM,GAFFkK,GAAW8V,EAAO9V,SAEZsF,EAAI,EAAGC,EAAIvF,EAAStK,OAAQ4P,EAAIC,EAAGD,IAE5CqvC,EAAe30C,EAAUsF,GAAKkJ,EAAQomC,IAMxC,QAASQ,GAAe9mC,EAAYC,EAAOC,EAAQ6mC,GAElD,IAAM,GAAI/vC,GAAI,EAAGC,EAAI+I,EAAW5Y,OAAQ4P,EAAIC,EAAGD,IAAO,CAErD,GAAIkmB,GAAald,EAAYhJ,GAEzBwQ,EAAS0V,EAAW1V,OACpBnI,EAAW6d,EAAW7d,SACtBC,EAAgCxX,SAArBi/C,EAAiC7pB,EAAW5d,SAAWynC,EAClE9pB,EAAQC,EAAWD,KAEvB,IAAK/c,EAAO8mC,cAAgB,CAE3BC,GAAsB/mC,CAItB,KAAM,GAFFs9B,GAAUt9B,EAAOs9B,QAEX/I,EAAI,EAAGC,EAAK8I,EAAQp2C,OAAQqtC,EAAIC,EAAID,IAAO,CAEpD,GAAIyS,GAAU1J,EAAS/I,EAEvB,IAAKjtB,EAAOhV,OAAOgxB,KAAM0jB,EAAQ10C,QAAW,CAE3C,GAAK,YAAc00C,GAElBrnC,GAAM7U,SAAUo5C,GAAiBx+B,KAAMshC,EAAQl8C,eAEzC,CAEN,GAAIo1C,GAAS8G,EAAQ9G,OAEjBt5C,EAAIs5C,EAAOt5C,EAAIqgD,GACfpgD,EAAIq5C,EAAOr5C,EAAIqgD,GACfz8C,EAAQy1C,EAAO54C,EAAI2/C,GACnBv8C,EAASw1C,EAAO34C,EAAI2/C,EAExBvnC,IAAM7U,SAAUo5C,GAAiBn3C,IAAKnG,EAAGC,EAAG4D,EAAOC,GAASs0B,eAAgB8kB,KAI7EwC,GAAmBnlB,YAAa6lB,GAEhC5jB,EAAc9b,EAAQvH,EAAOinC,EAAS7nC,EAAUC,EAAU2d,SAQ5DgqB,IAAsB,KAEtB3jB,EAAc9b,EAAQvH,EAAOC,EAAQb,EAAUC,EAAU2d,IAQ5D,QAASqG,GAAc9b,EAAQvH,EAAOC,EAAQb,EAAUC,EAAU2d,GAQjE,GANAzV,EAAOrG,eAAgBqjC,GAAOvkC,EAAOC,EAAQb,EAAUC,EAAU2d,GACjEupB,GAAqBhlB,GAAanxB,IAAK4P,EAAOgnC,IAAuB/mC,GAErEsH,EAAOrV,gBAAgB2xB,iBAAkB5jB,EAAOlN,mBAAoBwU,EAAOnV,aAC3EmV,EAAOpV,aAAaqT,gBAAiB+B,EAAOrV,iBAEvCqV,EAAOq/B,wBAA0B,CAErChnC,GAAMstB,YAAa7tB,EAEnB,IAAImK,GAAU49B,EAAYnnC,EAAQD,EAAM1F,IAAK+E,EAAUkI,EAEvD8/B,IAAwBjoC,SAAW,KACnCioC,GAAwB79B,QAAU,KAClC69B,GAAwB7pC,WAAY,EAEpC2nC,EAAuB59B,EAAQiC,OAI/B+6B,IAAM/iC,mBAAoBvB,EAAQD,EAAM1F,IAAK8E,EAAUC,EAAUkI,EAAQyV,EAI1EzV,GAAO+/B,cAAe/C,GAAOvkC,EAAOC,EAAQb,EAAUC,EAAU2d,GAChEupB,GAAqBhlB,GAAanxB,IAAK4P,EAAOgnC,IAAuB/mC,GAItE,QAASsnC,GAAcloC,EAAU/E,EAAKiN,GAErC,GAAIigC,GAAqB/qB,GAAWrsB,IAAKiP,GAErC9E,EAASgsC,GAAmB3mC,MAAMrF,OAClCymB,EAAeulB,GAAmB3mC,MAAMohB,aAExCymB,EAAaD,EAAmBC,WAChCC,EAAkBntC,EAAOqF,MAAMwd,KAE/BxlB,EAAa0sC,GAAa/pB,cAC7Blb,EAAU9E,EAAOqF,MAAOohB,EAAc1mB,EAAKqtC,GAAU7iC,UAAW6iC,GAAU5iC,gBAAiBwC,GAExF4M,EAAOmwB,GAAaxoB,eAAgBzc,EAAUzH,GAE9C4R,EAAUg+B,EAAmBh+B,QAC7Bo+B,GAAgB,CAEpB,IAAiB//C,SAAZ2hB,EAGJnK,EAASmI,iBAAkB,UAAWw9B,OAEhC,IAAKx7B,EAAQ2K,OAASA,EAG5B+wB,EAAiC7lC,OAE3B,IAAKooC,EAAW7mB,UAAY8mB,EAAgB9mB,SAClD6mB,EAAWhpB,oBAAsBipB,EAAgBjpB,mBACjDgpB,EAAW/oB,cAAgBgpB,EAAgBhpB,aAC3C+oB,EAAW9oB,aAAe+oB,EAAgB/oB,YAC1C8oB,EAAW7oB,iBAAmB8oB,EAAgB9oB,gBAC9C6oB,EAAW5oB,aAAe6oB,EAAgB7oB,YAC1C4oB,EAAW5mB,gBAAkB6mB,EAAgB7mB,cAE7C4mB,EAAW7mB,QAAU8mB,EAAgB9mB,QACrC6mB,EAAWhpB,kBAAoBipB,EAAgBjpB,kBAC/CgpB,EAAW/oB,YAAcgpB,EAAgBhpB,YACzC+oB,EAAW9oB,WAAa+oB,EAAgB/oB,WACxC8oB,EAAW7oB,eAAiB8oB,EAAgB9oB,eAC5C6oB,EAAW5oB,WAAa6oB,EAAgB7oB,WACxC4oB,EAAW5mB,cAAgB6mB,EAAgB7mB,cAE3C+mB,GAAgB,MAEV,CAAA,GAA6B//C,SAAxB+P,EAAW+iB,SAGtB,MAKAitB,IAAgB,EAIjB,GAAKA,EAAgB,CAEpB,GAAKhwC,EAAW+iB,SAAW,CAE1B,GAAIpK,GAASzP,GAAWlJ,EAAW+iB,SAEnC6sB,GAAmBj3B,QAClBrnB,KAAMmW,EAAS7W,KACfwV,SAAU6pC,GAAcj2C,MAAO2e,EAAOvS,UACtCC,aAAcsS,EAAOtS,aACrBC,eAAgBqS,EAAOrS,oBAKxBspC,GAAmBj3B,QAClBrnB,KAAMmW,EAAS7W,KACfwV,SAAUqB,EAASrB,SACnBC,aAAcoB,EAASpB,aACvBC,eAAgBmB,EAASnB,eAK3BmB,GAAS0c,gBAAiByrB,EAAmBj3B,OAAQg0B,IAGrDpwB,EAAOmwB,GAAaxoB,eAAgBzc,EAAUzH,GAE9C4R,EAAU86B,GAAaroB,eAAgB5c,EAAUmoC,EAAmBj3B,OAAQ3Y,EAAYuc,GAExFqzB,EAAmBh+B,QAAUA,EAC7BnK,EAASmK,QAAUA,EAIpB,GAAI+7B,GAAoB/7B,EAAQkP,eAEhC,IAAKrZ,EAASxK,aAAe,CAE5BwK,EAASyoC,yBAA2B,CAEpC,KAAM,GAAI/wC,GAAI,EAAGA,EAAIwtC,GAAMlpB,gBAAiBtkB,IAEtCwuC,EAAmB,cAAgBxuC,IAAO,GAE9CsI,EAASyoC,2BAQZ,GAAKzoC,EAASvK,aAAe,CAE5BuK,EAAS0oC,yBAA2B,CAEpC,KAAM,GAAIhxC,GAAI,EAAGA,EAAIwtC,GAAMjpB,gBAAiBvkB,IAEtCwuC,EAAmB,cAAgBxuC,IAAO,GAE9CsI,EAAS0oC,2BAQZ,GAAI/pC,GAAWwpC,EAAmBj3B,OAAOvS,UAElCqB,EAAS6X,kBACb7X,EAASqW,sBACXrW,EAASjB,YAAa,IAEtBopC,EAAmBj0B,kBAAoBo0B,GAAU7iC,UACjD0iC,EAAmBziC,gBAAkB4iC,GAAU5iC,gBAC/C/G,EAASnC,eAAiB8rC,GAAUhjC,SAIrC6iC,EAAmBltC,IAAMA,EAGLzS,SAAf4/C,IAEJD,EAAmBC,WAAaA,MAIjCA,EAAW7mB,QAAU8mB,EAAgB9mB,QACrC6mB,EAAWhpB,kBAAoBipB,EAAgBjpB,kBAC/CgpB,EAAW/oB,YAAcgpB,EAAgBhpB,YACzC+oB,EAAW9oB,WAAa+oB,EAAgB/oB,WACxC8oB,EAAW7oB,eAAiB8oB,EAAgB9oB,eAC5C6oB,EAAW5oB,WAAa6oB,EAAgB7oB,WACxC4oB,EAAW5mB,cAAgB6mB,EAAgB7mB,cAEtCxhB,EAAS9E,SAIbyD,EAASgqC,kBAAkBn/C,MAAQ0R,EAAOqF,MAAM+gB,QAChD3iB,EAASiqC,kBAAkBp/C,MAAQ0R,EAAOqF,MAAM2b,YAChDvd,EAASkqC,WAAWr/C,MAAQ0R,EAAOqF,MAAM6b,KACzCzd,EAASmqC,eAAet/C,MAAQ0R,EAAOqF,MAAM8b,SAC7C1d,EAASoqC,YAAYv/C,MAAQ0R,EAAOqF,MAAM4b,MAC1Cxd,EAASqqC,iBAAiBx/C,MAAQ0R,EAAOqF,MAAM+b,KAE/C3d,EAASwhB,qBAAqB32B,MAAQ0R,EAAOqF,MAAM4f,qBACnDxhB,EAASyhB,wBAAwB52B,MAAQ0R,EAAOqF,MAAM6f,wBACtDzhB,EAAS8hB,cAAcj3B,MAAQ0R,EAAOqF,MAAMkgB,cAC5C9hB,EAAS+hB,iBAAiBl3B,MAAQ0R,EAAOqF,MAAMmgB,iBAC/C/hB,EAASuiB,eAAe13B,MAAQ0R,EAAOqF,MAAM2gB,eAC7CviB,EAASwiB,kBAAkB33B,MAAQ0R,EAAOqF,MAAM4gB,kBAKjD,IAAI8nB,GAAed,EAAmBh+B,QAAQQ,cAC7Cu+B,EACC14B,GAAc24B,aAAcF,EAAa59B,IAAK1M,EAEhDwpC,GAAmBe,aAAeA,EAInC,QAASnB,GAAYnnC,EAAQ3F,EAAK+E,EAAUkI,GAE3CkhC,GAAoB,CAEpB,IAAIjB,GAAqB/qB,GAAWrsB,IAAKiP,GACrC9E,EAASgsC,GAAmB3mC,MAAMrF,OAElCktC,EAAaD,EAAmBC,WAChCC,EAAkBntC,EAAOqF,MAAMwd,IAEnC,IAAKsrB,KAECC,IAAyB1oC,IAAW2oC,IAAiB,CAEzD,GAAIC,GACH5oC,IAAW2oC,IACXvpC,EAAS8H,KAAO2hC,EAKjBnB,IAAUthC,SACThH,EAASxD,eAAgBwD,EAASvD,iBAAkBuD,EAAStD,YAC7DkE,EAAQunC,EAAoBqB,GAM1BxpC,EAAS3C,eAAgB,IAEO7U,SAA/B2/C,EAAmBh+B,QAEvBnK,EAAS3C,aAAc,EAEZ2C,EAAS/E,KAAOktC,EAAmBltC,MAAQA,EAEtD+E,EAAS3C,aAAc,GAEZ2C,EAAS9E,QAAYktC,EAAW7mB,UAAY8mB,EAAgB9mB,SACvE6mB,EAAWhpB,oBAAsBipB,EAAgBjpB,mBACjDgpB,EAAW/oB,cAAgBgpB,EAAgBhpB,aAC3C+oB,EAAW9oB,aAAe+oB,EAAgB/oB,YAC1C8oB,EAAW7oB,iBAAmB8oB,EAAgB9oB,gBAC9C6oB,EAAW5oB,aAAe6oB,EAAgB7oB,YAC1C4oB,EAAW5mB,gBAAkB6mB,EAAgB7mB,cAIOh5B,SAAzC2/C,EAAmBj0B,mBAC5Bi0B,EAAmBj0B,oBAAsBo0B,GAAU7iC,WACrD0iC,EAAmBziC,kBAAoB4iC,GAAU5iC,kBAEjD1F,EAAS3C,aAAc,GANvB2C,EAAS3C,aAAc,GAYpB2C,EAAS3C,cAEb6qC,EAAcloC,EAAU/E,EAAKiN,GAC7BlI,EAAS3C,aAAc,EAIxB,IAAIqsC,IAAiB,EACjBC,GAAkB,EAClBC,GAAgB,EAEhBz/B,EAAUg+B,EAAmBh+B,QAChC0/B,EAAa1/B,EAAQQ,cACrBm/B,EAAa3B,EAAmBj3B,OAAOvS,QAkBxC,IAhBK4B,GAAM0rB,WAAY9hB,EAAQA,WAE9Bu/B,GAAiB,EACjBC,GAAkB,EAClBC,GAAgB,GAIZ5pC,EAAS8H,KAAO2hC,KAEpBA,GAAqBzpC,EAAS8H,GAE9B6hC,GAAkB,GAIdD,GAAkBH,KAAmB3oC,EAAS,CA2BlD,GAzBAipC,EAAWj/B,SAAUgb,GAAK,mBAAoBhlB,EAAOjN,kBAEhDgP,GAAaqB,wBAEjB6lC,EAAWj/B,SAAUgb,GAAK,gBACzB,GAAQvrB,KAAK2e,IAAKpY,EAAOzM,IAAM,GAAQkG,KAAK0vC,MAIzCR,KAAmB3oC,IAEvB2oC,GAAiB3oC,EAMjB+oC,GAAkB,EAClBC,GAAgB,GAOZ5pC,EAAS6X,kBACb7X,EAASgqC,qBACThqC,EAASiqC,wBACTjqC,EAASlC,OAAS,CAElB,GAAIosC,GAAUL,EAAWtsC,IAAI4sC,cAEZ3hD,UAAZ0hD,GAEJA,EAAQt/B,SAAUgb,GACjByhB,GAASxnB,sBAAuBjf,EAAO7N,eAMrCiN,EAASgqC,qBACbhqC,EAASoqC,uBACTpqC,EAASqqC,qBACTrqC,EAASiqC,wBACTjqC,EAAS6X,kBACT7X,EAASzB,WAETsrC,EAAWj/B,SAAUgb,GAAK,aAAchlB,EAAOlN,oBAUjD,GAAKsM,EAASzB,SAAW,CAExBsrC,EAAWS,YAAa1kB,GAAK1d,EAAQ,cACrC2hC,EAAWS,YAAa1kB,GAAK1d,EAAQ,oBAErC,IAAI0R,GAAW1R,EAAO0R,QAEtB,IAAKA,EAAW,CAEf,GAAIC,GAAQD,EAASC,KAErB,IAAKlX,GAAawC,oBAAsB,CAEvC,GAA8B3c,SAAzBoxB,EAAS2wB,YAA4B,CAUzC,GAAI57B,GAAOtU,KAAKmwC,KAAqB,EAAf3wB,EAAM/xB,OAC5B6mB,GAAOhlB,GAAM8gD,eAAgB97B,GAC7BA,EAAOtU,KAAK7N,IAAKmiB,EAAM,EAEvB,IAAI+7B,GAAe,GAAIj7C,cAAckf,EAAOA,EAAO,EACnD+7B,GAAa/8C,IAAKisB,EAAS8wB,aAE3B,IAAIH,GAAc,GAAIp+C,GAAau+C,EAAc/7B,EAAMA,EAAMvkB,GAAYurC,GACzE4U,GAAYltC,aAAc,EAE1Buc,EAAS8wB,aAAeA,EACxB9wB,EAAS2wB,YAAcA,EACvB3wB,EAAS+wB,gBAAkBh8B,EAI5Bk7B,EAAWj/B,SAAUgb,GAAK,cAAehM,EAAS2wB,aAClDV,EAAWj/B,SAAUgb,GAAK,kBAAmBhM,EAAS+wB,qBAItDd,GAAWS,YAAa1kB,GAAKhM,EAAU,iBA8I1C,MAtIK+vB,KAEJE,EAAWj/B,SAAUgb,GAAK,sBAAuBsf,GAAM0F,qBACvDf,EAAWj/B,SAAUgb,GAAK,wBAAyBsf,GAAM2F,uBAEpD7qC,EAAS9E,QAWb4vC,EAA+BhB,EAAYF,GAMvC3uC,GAAO+E,EAAS/E,KAEpB8vC,EAAoBjB,EAAY7uC,GAI5B+E,EAASqqC,oBAEbW,EAAuBlB,EAAY9pC,GAExBA,EAASoqC,uBAEpBY,EAAuBlB,EAAY9pC,GACnCirC,EAAwBnB,EAAY9pC,IAEzBA,EAASgqC,qBAEpBgB,EAAuBlB,EAAY9pC,GAE9BA,EAASkrC,mBAEbC,EAAqBrB,EAAY9pC,GAIjCorC,EAAsBtB,EAAY9pC,IAIxBA,EAASiqC,wBAEpBe,EAAuBlB,EAAY9pC,GAE9BA,EAASqrC,uBAEbC,EAAyBxB,EAAY9pC,GAIrCurC,EAAyBzB,EAAY9pC,IAI3BA,EAASwrC,qBAEpBR,EAAuBlB,EAAY9pC,GACnCyrC,EAAsB3B,EAAY9pC,IAEvBA,EAAS+jB,wBAEpBinB,EAAuBlB,EAAY9pC,GACnC0rC,EAAyB5B,EAAY9pC,IAE1BA,EAAS2rC,sBAEpBX,EAAuBlB,EAAY9pC,GACnC4rC,EAAuB9B,EAAY9pC,IAExBA,EAAS6rC,qBAEpBC,EAAqBhC,EAAY9pC,GAE5BA,EAAS+rC,sBAEbC,EAAqBlC,EAAY9pC,IAIvBA,EAASisC,iBAEpBC,EAAuBpC,EAAY9pC,GAExBA,EAASmsC,iBAEpBC,EAAwBtC,EAAY9pC,GAEzBA,EAASqsC,mBAEpBvC,EAAWp1C,MAAMlL,MAAQwW,EAAStL,MAClCo1C,EAAWruC,QAAQjS,MAAQwW,EAASvE,SAOXjT,SAArBshD,EAAWwC,QAAsBxC,EAAWwC,MAAM9iD,MAAQ+iD,GAAYC,OACjDhkD,SAArBshD,EAAW2C,QAAsB3C,EAAW2C,MAAMjjD,MAAQ+iD,GAAYG,OAE3El8B,GAAcm8B,OAAQ/mB,GAAKuiB,EAAmBe,aAAcY,EAAY5E,KAIpEllC,EAAS6X,kBAAoB7X,EAASP,sBAAuB,IAEjE+Q,GAAcm8B,OAAQ/mB,GAAKuiB,EAAmBe,aAAcY,EAAY5E,IACxEllC,EAASP,oBAAqB,GAI1BO,EAASmsC,kBAEbtC,EAAWj/B,SAAUgb,GAAK,SAAU1d,EAAO1d,QAM5Cq/C,EAAWj/B,SAAUgb,GAAK,kBAAmB1d,EAAOrV,iBACpDg3C,EAAWj/B,SAAUgb,GAAK,eAAgB1d,EAAOpV,cACjD+2C,EAAWj/B,SAAUgb,GAAK,cAAe1d,EAAOnV,aAEzCoX,EAMR,QAAS6gC,GAAuBrsC,EAAUqB,GAEzCrB,EAASlD,QAAQjS,MAAQwW,EAASvE,QAE7BuE,EAAStL,QAEbiK,EAASiuC,QAAQpjD,MAAQwW,EAAStL,OAI9BsL,EAAS6sC,UAEbluC,EAASkuC,SAASrjD,MAAM8c,KAAMtG,EAAS6sC,UAAWjtB,eAAgB5f,EAAS8sC,mBAIvE9sC,EAASzC,MAEboB,EAASpB,IAAI/T,MAAQwW,EAASzC,KAI1ByC,EAASnC,WAEbc,EAASd,SAASrU,MAAQwW,EAASnC,UAI/BmC,EAASpC,cAEbe,EAASf,YAAYpU,MAAQwW,EAASpC,aAIlCoC,EAASlC,SAEba,EAASb,OAAOtU,MAAQwW,EAASlC,OAMjCa,EAASouC,WAAWvjD,MAAcwW,EAASlC,QAAUkC,EAASlC,OAAOyD,iBAAoB,EAEzF5C,EAASV,aAAazU,MAAQwW,EAAS/B,aACvCU,EAAST,gBAAgB1U,MAAQwW,EAAS9B,gBAE1CS,EAASquC,YAAYxjD,MAAQ4zB,GAAWrsB,IAAKiP,EAASlC,QAASm0B,eAI3DjyB,EAASxC,WAEbmB,EAASnB,SAAShU,MAAQwW,EAASxC,SACnCmB,EAASlB,kBAAkBjU,MAAQwW,EAASvC,mBAIxCuC,EAAStC,QAEbiB,EAASjB,MAAMlU,MAAQwW,EAAStC,MAChCiB,EAAShB,eAAenU,MAAQwW,EAASrC,eAY1C,IAAIsvC,EAECjtC,GAASzC,IAEb0vC,EAAajtC,EAASzC,IAEXyC,EAASpC,YAEpBqvC,EAAajtC,EAASpC,YAEXoC,EAAS2W,gBAEpBs2B,EAAajtC,EAAS2W,gBAEX3W,EAASiT,UAEpBg6B,EAAajtC,EAASiT,UAEXjT,EAASgT,QAEpBi6B,EAAajtC,EAASgT,QAEXhT,EAAS4W,aAEpBq2B,EAAajtC,EAAS4W,aAEX5W,EAAS6W,aAEpBo2B,EAAajtC,EAAS6W,aAEX7W,EAASnC,SAEpBovC,EAAajtC,EAASnC,SAEXmC,EAAS0W,cAEpBu2B,EAAajtC,EAAS0W,aAIHluB,SAAfykD,IAGCA,EAAW/yB,sBAEf+yB,EAAaA,EAAWthD,SAIpBshD,EAAWviD,oBAAqB,GAEpCuiD,EAAWC,eAIZvuC,EAASwuC,YAAY3jD,MAAM8c,KAAM2mC,EAAWtiD,SAM9C,QAASmhD,GAAqBntC,EAAUqB,GAEvCrB,EAASiuC,QAAQpjD,MAAQwW,EAAStL,MAClCiK,EAASlD,QAAQjS,MAAQwW,EAASvE,QAInC,QAASuwC,GAAqBrtC,EAAUqB,GAEvCrB,EAASyuC,SAAS5jD,MAAQwW,EAASotC,SACnCzuC,EAAS0uC,UAAU7jD,MAAQwW,EAASotC,SAAWptC,EAASstC,QACxD3uC,EAASlM,MAAMjJ,MAAQwW,EAASvN,MAIjC,QAASy5C,GAAuBvtC,EAAUqB,GAEzCrB,EAASiuC,QAAQpjD,MAAQwW,EAAStL,MAClCiK,EAASlD,QAAQjS,MAAQwW,EAASvE,QAClCkD,EAASgQ,KAAKnlB,MAAQwW,EAAS2O,KAAO+1B,GACtC/lC,EAASlM,MAAMjJ,MAAkB,GAAVs+C,GAEvBnpC,EAASpB,IAAI/T,MAAQwW,EAASzC,IAER,OAAjByC,EAASzC,MAERyC,EAASzC,IAAI7S,oBAAqB,GAEtCsV,EAASzC,IAAI2vC,eAIdvuC,EAASwuC,YAAY3jD,MAAM8c,KAAMtG,EAASzC,IAAI5S,SAMhD,QAASyhD,GAAwBztC,EAAUqB,GAE1CrB,EAASiuC,QAAQpjD,MAAQwW,EAAStL,MAClCiK,EAASlD,QAAQjS,MAAQwW,EAASvE,QAClCkD,EAASlU,SAASjB,MAAQwW,EAASvV,SACnCkU,EAASpB,IAAI/T,MAAQwW,EAASzC,IAER,OAAjByC,EAASzC,MAERyC,EAASzC,IAAI7S,oBAAqB,GAEtCsV,EAASzC,IAAI2vC,eAIdvuC,EAASwuC,YAAY3jD,MAAM8c,KAAMtG,EAASzC,IAAI5S,SAMhD,QAASogD,GAAoBpsC,EAAU1D,GAEtC0D,EAAS4uC,SAAS/jD,MAAQyR,EAAIvG,MAEzBuG,EAAIuyC,OAER7uC,EAAS8uC,QAAQjkD,MAAQyR,EAAI/G,KAC7ByK,EAAS+uC,OAAOlkD,MAAQyR,EAAI9G,KAEjB8G,EAAI8gB,YAEfpd,EAASgvC,WAAWnkD,MAAQyR,EAAI2yC,SAMlC,QAAS3C,GAAwBtsC,EAAUqB,GAErCA,EAAS0W,cAEb/X,EAAS+X,YAAYltB,MAAQwW,EAAS0W,aAMxC,QAAS00B,GAAsBzsC,EAAUqB,GAExCrB,EAASkvC,SAASrkD,MAAQwW,EAAS6tC,SACnClvC,EAASmvC,UAAUtkD,MAAQ6Q,KAAK7N,IAAKwT,EAAS8tC,UAAW,MAEpD9tC,EAAS0W,cAEb/X,EAAS+X,YAAYltB,MAAQwW,EAAS0W,aAIlC1W,EAASgT,UAEbrU,EAASqU,QAAQxpB,MAAQwW,EAASgT,QAClCrU,EAASovC,UAAUvkD,MAAQwW,EAAS+tC,UAC/B/tC,EAAS3E,OAASsG,KAAWhD,EAASovC,UAAUvkD,YAIjDwW,EAASiT,YAEbtU,EAASsU,UAAUzpB,MAAQwW,EAASiT,UACpCtU,EAASqvC,YAAYxkD,MAAM8c,KAAMtG,EAASguC,aACrChuC,EAAS3E,OAASsG,IAAWhD,EAASqvC,YAAYxkD,MAAMykD,UAIzDjuC,EAAS2W,kBAEbhY,EAASgY,gBAAgBntB,MAAQwW,EAAS2W,gBAC1ChY,EAASyjB,kBAAkB54B,MAAQwW,EAASoiB,kBAC5CzjB,EAAS0jB,iBAAiB74B,MAAQwW,EAASqiB,kBAM7C,QAAS8oB,GAAqBxsC,EAAUqB,GAEvCorC,EAAsBzsC,EAAUqB,GAE3BA,EAASmX,cAEbxY,EAASwY,YAAY3tB,MAAQwW,EAASmX,aAMxC,QAASo0B,GAAyB5sC,EAAUqB,GAE3CrB,EAASuvC,UAAU1kD,MAAQwW,EAASkuC,UACpCvvC,EAASwvC,UAAU3kD,MAAQwW,EAASmuC,UAE/BnuC,EAAS4W,eAEbjY,EAASiY,aAAaptB,MAAQwW,EAAS4W,cAInC5W,EAAS6W,eAEblY,EAASkY,aAAartB,MAAQwW,EAAS6W,cAInC7W,EAAS0W,cAEb/X,EAAS+X,YAAYltB,MAAQwW,EAAS0W,aAIlC1W,EAASgT,UAEbrU,EAASqU,QAAQxpB,MAAQwW,EAASgT,QAClCrU,EAASovC,UAAUvkD,MAAQwW,EAAS+tC,UAC/B/tC,EAAS3E,OAASsG,KAAWhD,EAASovC,UAAUvkD,YAIjDwW,EAASiT,YAEbtU,EAASsU,UAAUzpB,MAAQwW,EAASiT,UACpCtU,EAASqvC,YAAYxkD,MAAM8c,KAAMtG,EAASguC,aACrChuC,EAAS3E,OAASsG,IAAWhD,EAASqvC,YAAYxkD,MAAMykD,UAIzDjuC,EAAS2W,kBAEbhY,EAASgY,gBAAgBntB,MAAQwW,EAAS2W,gBAC1ChY,EAASyjB,kBAAkB54B,MAAQwW,EAASoiB,kBAC5CzjB,EAAS0jB,iBAAiB74B,MAAQwW,EAASqiB,kBAIvCriB,EAASlC,SAGba,EAASyvC,gBAAgB5kD,MAAQwW,EAASouC,iBAM5C,QAAS9C,GAAyB3sC,EAAUqB,GAE3CurC,EAAyB5sC,EAAUqB,GAEnCrB,EAASV,aAAazU,MAAQwW,EAAS/B,aAEvCU,EAAS0vC,UAAU7kD,MAAQwW,EAASquC,UACpC1vC,EAAS2vC,mBAAmB9kD,MAAQwW,EAASsuC,mBAI9C,QAAS7C,GAAsB9sC,EAAUqB,GAEnCA,EAAS2W,kBAEbhY,EAASgY,gBAAgBntB,MAAQwW,EAAS2W,gBAC1ChY,EAASyjB,kBAAkB54B,MAAQwW,EAASoiB,kBAC5CzjB,EAAS0jB,iBAAiB74B,MAAQwW,EAASqiB,kBAM7C,QAASqpB,GAAyB/sC,EAAUqB,GAEtCA,EAAS2W,kBAEbhY,EAASgY,gBAAgBntB,MAAQwW,EAAS2W,gBAC1ChY,EAASyjB,kBAAkB54B,MAAQwW,EAASoiB,kBAC5CzjB,EAAS0jB,iBAAiB74B,MAAQwW,EAASqiB,kBAI5C1jB,EAAS2jB,kBAAkB94B,MAAM8c,KAAMtG,EAASsiB,mBAChD3jB,EAAS4jB,aAAa/4B,MAAQwW,EAASuiB,aACvC5jB,EAAS6jB,YAAYh5B,MAAQwW,EAASwiB,YAIvC,QAASopB,GAAuBjtC,EAAUqB,GAEpCA,EAASgT,UAEbrU,EAASqU,QAAQxpB,MAAQwW,EAASgT,QAClCrU,EAASovC,UAAUvkD,MAAQwW,EAAS+tC,UAC/B/tC,EAAS3E,OAASsG,KAAWhD,EAASovC,UAAUvkD,YAIjDwW,EAASiT,YAEbtU,EAASsU,UAAUzpB,MAAQwW,EAASiT,UACpCtU,EAASqvC,YAAYxkD,MAAM8c,KAAMtG,EAASguC,aACrChuC,EAAS3E,OAASsG,IAAWhD,EAASqvC,YAAYxkD,MAAMykD,UAIzDjuC,EAAS2W,kBAEbhY,EAASgY,gBAAgBntB,MAAQwW,EAAS2W,gBAC1ChY,EAASyjB,kBAAkB54B,MAAQwW,EAASoiB,kBAC5CzjB,EAAS0jB,iBAAiB74B,MAAQwW,EAASqiB,kBAQ7C,QAASyoB,GAA+BnsC,EAAUnV,GAEjDmV,EAASgqC,kBAAkBtrC,YAAc7T,EAEzCmV,EAASiqC,kBAAkBvrC,YAAc7T,EACzCmV,EAASoqC,YAAY1rC,YAAc7T,EACnCmV,EAASkqC,WAAWxrC,YAAc7T,EAClCmV,EAASmqC,eAAezrC,YAAc7T,EACtCmV,EAASqqC,iBAAiB3rC,YAAc7T,EAMzC,QAASwiB,KAER,GAAIuiC,GAAcnF,EAUlB,OARKmF,IAAe5rC,GAAasB,aAEhClc,QAAQ4H,KAAM,sCAAwC4+C,EAAc,+CAAiD5rC,GAAasB,aAInImlC,IAAqB,EAEdmF,EAxwERxmD,QAAQixB,IAAK,sBAAuBw1B,IAEpCj2C,EAAaA,KAEb,IAAIo5B,GAAgCnpC,SAAtB+P,EAAW04B,OAAuB14B,EAAW04B,OAASC,SAASC,gBAAiB,+BAAgC,UAC7Hsd,EAAkCjmD,SAAvB+P,EAAWpK,QAAwBoK,EAAWpK,QAAU,KAEnEugD,EAA8BlmD,SAArB+P,EAAW6J,OAAsB7J,EAAW6J,MACrDusC,EAA8BnmD,SAArB+P,EAAWJ,OAAsBI,EAAWJ,MACrDy2C,EAAkCpmD,SAAvB+P,EAAWiyB,SAAwBjyB,EAAWiyB,QACzDqkB,EAAsCrmD,SAAzB+P,EAAWu2C,WAA0Bv2C,EAAWu2C,UAC7D1J,EAAwD58C,SAAlC+P,EAAW4E,oBAAmC5E,EAAW4E,mBAC/E4xC,EAA8DvmD,SAArC+P,EAAWy2C,uBAAsCz2C,EAAWy2C,sBACrFC,EAAkDzmD,SAA/B+P,EAAW22C,gBAAgC32C,EAAW22C,gBAAkB,UAExF5H,GAAoB,KACpBJ,GAAqB,IAIzBx/C,MAAKynD,WAAaxd,EAClBjqC,KAAKyG,QAAU,KAIfzG,KAAKwZ,WAAY,EACjBxZ,KAAK0Z,gBAAiB,EACtB1Z,KAAK2Z,gBAAiB,EACtB3Z,KAAK4Z,kBAAmB,EAIxB5Z,KAAKs/C,aAAc,EAInBt/C,KAAK8U,kBACL9U,KAAK+e,sBAAuB,EAI5B/e,KAAKuuB,YAAc,EACnBvuB,KAAKi0B,YAAa,EAClBj0B,KAAKg0B,aAAc,EAInBh0B,KAAK0vB,yBAA0B,EAI/B1vB,KAAK4qB,YAAcE,GACnB9qB,KAAKkjD,oBAAsB,EAC3BljD,KAAKmjD,sBAAwB,EAI7BnjD,KAAKs0B,gBAAkB,EACvBt0B,KAAKu0B,gBAAkB,CAIvB,IAkEI2J,IAlEAsf,GAAQx9C,KAEX+9C,IAAiB,EAIjB2J,GAAe,KAEf3K,GAAuB,KACvB4K,GAAsB,KACtB5F,MAIAzB,IACCjoC,SAAU,KACVoK,QAAS,KACThM,WAAW,GAGZorC,GAAiB,KACjB5B,GAAsB,KAEtB7C,GAAmB,GAAI35C,GACvBy5C,GAAkB,GAAIz5C,GACtBmkD,GAAsB,KAItBlG,GAAoB,EAIpBvB,GAASlW,EAAQtmC,MACjBy8C,GAAUnW,EAAQrmC,OAElBo5C,GAAc,EAEdK,GAAY,GAAI55C,GAAS,EAAG,EAAG08C,GAAQC,IACvCjD,GAAW,GAAI15C,GAAS,EAAG,EAAG08C,GAAQC,IACtCyH,IAAe,EAIfjrB,GAAW,GAAIv3B,GAIfu7C,GAAY,GAAIljC,GAChBikC,IAAmB,EACnBC,IAAwB,EAIxBxkB,GAAoB,GAAIn9B,GAExB0/C,GAAW,GAAI5+C,EAYhB,KAEC,GAAI+mD,KACHptC,MAAOssC,EACPv2C,MAAOw2C,EACPnkB,QAASokB,EACTE,UAAWD,EACX1xC,mBAAoBioC,EACpB4J,sBAAuBD,EACvBG,gBAAiBD,EAUlB,IALAtd,EAAQxpB,iBAAkB,mBAAoBo9B,GAAe,GAC7D5T,EAAQxpB,iBAAkB,uBAAwBu9B,GAAkB,GAEpE9f,GAAM6oB,GAAY9c,EAAQP,WAAY,QAASoe,KAAuB7d,EAAQP,WAAY,qBAAsBoe,IAEnG,OAAR5pB,GAEJ,KAAuC,QAAlC+L,EAAQP,WAAY,SAElB,GAAIpf,OAAO,+DAIX,GAAIA,OAAO,gCAQmBxpB,UAAjCo9B,GAAIniB,2BAERmiB,GAAIniB,yBAA2B,WAE9B,OAASgsC,SAAY,EAAGC,SAAY,EAAG7yC,UAAa,KAMrD,MAAQ7U,IAETD,QAAQC,MAAO,wBAA0BA,GAAM2nD,SAIhD,GAAI3wC,IAAY2D,GAAcpC,GAAOmC,GACjC0a,GAAYvT,GAAU9R,GAAY8P,GAAYrH,GAC9CykC,GAAcE,GAAajjB,GAE3BphB,GAAYkkC,GAAcK,GAAgBC,GAE1Cne,EAwDJwd,IAIA,IAAImC,IAAO,MAAQ3H,WAAc,GAAIuD,IAAcwC,IAAU,GAAI/G,IAAc+G,GAE/Ex9C,MAAKo/C,GAAKA,EAIV,IAAIvqB,IAAY,GAAIkG,IAAgByiB,GAAO1kC,GAASmC,GAAa0B,eAEjE3c,MAAK60B,UAAYA,GAIjB70B,KAAK0pC,WAAa,WAEjB,MAAOxL,KAIRl+B,KAAKkoD,qBAAuB,WAE3B,MAAOhqB,IAAIgqB,wBAIZloD,KAAKmoD,iBAAmB,WAEvB,GAAI7sC,GAAYhE,GAAWjO,IAAK,qBAC3BiS,IAAYA,EAAU8sC,eAI5BpoD,KAAKqoD,oBAAsB,WAE1B,GAAI/sC,GAAYhE,GAAWjO,IAAK,qBAC3BiS,IAAYA,EAAUgtC,kBAI5BtoD,KAAKk3C,cAAgB,WAEpB,MAAO8F,KAIRh9C,KAAKuoD,cAAgB,SAAWzmD,GAEhBhB,SAAVgB,IAELk7C,GAAcl7C,EAEd9B,KAAKwoD,QAASrI,GAAQC,IAAS,KAIhCpgD,KAAKo3C,QAAU,WAEd,OACCzzC,MAAOw8C,GACPv8C,OAAQw8C,KAKVpgD,KAAKwoD,QAAU,SAAW7kD,EAAOC,EAAQ6kD,GAExC,MAAKrJ,IAAG1I,mBAEPr2C,SAAQ4H,KAAM,0EAKfk4C,GAASx8C,EACTy8C,GAAUx8C,EAEVqmC,EAAQtmC,MAAQA,EAAQq5C,GACxB/S,EAAQrmC,OAASA,EAASo5C,GAErByL,KAAgB,IAEpBxe,EAAQye,MAAM/kD,MAAQA,EAAQ,KAC9BsmC,EAAQye,MAAM9kD,OAASA,EAAS,UAIjC5D,MAAK2oD,YAAa,EAAG,EAAGhlD,EAAOC,KAIhC5D,KAAK4oD,qBAAuB,WAE3B,OACCjlD,MAAOw8C,GAASnD,GAChBp5C,OAAQw8C,GAAUpD,KAKpBh9C,KAAKq3C,qBAAuB,SAAW1zC,EAAOC,EAAQilD,GAErD1I,GAASx8C,EACTy8C,GAAUx8C,EAEVo5C,GAAc6L,EAEd5e,EAAQtmC,MAAQA,EAAQklD,EACxB5e,EAAQrmC,OAASA,EAASilD,EAE1B7oD,KAAK2oD,YAAa,EAAG,EAAGhlD,EAAOC,IAIhC5D,KAAK8oD,mBAAqB,WAEzB,MAAO1L,KAIRp9C,KAAK2oD,YAAc,SAAW7oD,EAAGC,EAAG4D,EAAOC,GAE1Cy5C,GAAUp3C,IAAKnG,EAAGsgD,GAAUrgD,EAAI6D,EAAQD,EAAOC,GAC/CiV,GAAM7U,SAAUo5C,GAAiBx+B,KAAMy+B,IAAYnlB,eAAgB8kB,MAIpEh9C,KAAK+oD,WAAa,SAAWjpD,EAAGC,EAAG4D,EAAOC,GAEzCu5C,GAASl3C,IAAKnG,EAAGsgD,GAAUrgD,EAAI6D,EAAQD,EAAOC,GAC9CiV,GAAM/U,QAASo5C,GAAgBt+B,KAAMu+B,IAAWjlB,eAAgB8kB,MAIjEh9C,KAAKu+B,eAAiB,SAAWyqB,GAEhCnwC,GAAM0lB,eAAgBspB,GAAemB,IAMtChpD,KAAK2a,cAAgB,WAEpB,MAAOvB,IAAWuB,iBAInB3a,KAAK4a,cAAgB,WAEpBxB,GAAWwB,cAAc6tB,MAAOrvB,GAAYjZ,YAI7CH,KAAK6a,cAAgB,WAEpB,MAAOzB,IAAWyB,iBAInB7a,KAAK8a,cAAgB,WAEpB1B,GAAW0B,cAAc2tB,MAAOrvB,GAAYjZ,YAI7CH,KAAKyZ,MAAQ,SAAWzM,EAAOyD,EAAOqyB,GAErC,GAAImmB,GAAO,GAEInoD,SAAVkM,GAAuBA,KAAQi8C,GAAQ/qB,GAAIgrB,mBACjCpoD,SAAV2P,GAAuBA,KAAQw4C,GAAQ/qB,GAAIirB,mBAC/BroD,SAAZgiC,GAAyBA,KAAUmmB,GAAQ/qB,GAAIkrB,oBAEpDlrB,GAAIzkB,MAAOwvC,IAIZjpD,KAAKsZ,WAAa,WAEjBtZ,KAAKyZ,OAAO,GAAM,GAAO,IAI1BzZ,KAAK0hC,WAAa;AAEjB1hC,KAAKyZ,OAAO,GAAO,GAAM,IAI1BzZ,KAAK+iC,aAAe,WAEnB/iC,KAAKyZ,OAAO,GAAO,GAAO,IAI3BzZ,KAAKqpD,YAAc,SAAWvd,EAAc9+B,EAAOyD,EAAOqyB,GAEzD9iC,KAAKm/B,gBAAiB2M,GACtB9rC,KAAKyZ,MAAOzM,EAAOyD,EAAOqyB,IAM3B9iC,KAAKsjB,QAAU,WAEd2mB,EAAQ5pB,oBAAqB,mBAAoBw9B,GAAe,GAChE5T,EAAQ5pB,oBAAqB,uBAAwB29B,GAAkB,GAEvEP,GAAYn6B,UACZkX,GAAalX,UACboS,GAAWpS,UACXxK,GAAQwK,UAER87B,GAAG97B,UAEHg0B,GAAU1wC,QAyEX5G,KAAKq+C,sBAAwB,SAAW79B,EAAQiC,GAE/C5J,GAAM2qB,gBAEN,IAAIj6B,GAAUmsB,GAAWrsB,IAAKmX,EAEzBA,GAAO8oC,eAAkB//C,EAAQuB,WAAWvB,EAAQuB,SAAWozB,GAAIh3B,gBACnEsZ,EAAO+oC,aAAgBhgD,EAAQpE,SAASoE,EAAQpE,OAAS+4B,GAAIh3B,gBAC7DsZ,EAAOgpC,SAAYjgD,EAAQqO,KAAKrO,EAAQqO,GAAKsmB,GAAIh3B,gBACjDsZ,EAAOipC,YAAelgD,EAAQyD,QAAQzD,EAAQyD,MAAQkxB,GAAIh3B,eAE/D,IAAIs3C,GAAoB/7B,EAAQkP,eAE3BnR,GAAO8oC,eAEXprB,GAAIv2B,WAAYu2B,GAAIld,aAAczX,EAAQuB,UAC1CozB,GAAIt2B,WAAYs2B,GAAIld,aAAcR,EAAOkpC,cAAexrB,GAAI12B,cAE5DqR,GAAM6qB,gBAAiB8a,EAAkB1zC,UACzCozB,GAAI4gB,oBAAqBN,EAAkB1zC,SAAU,EAAGozB,GAAIp2B,OAAO,EAAO,EAAG,IAIzE0Y,EAAO+oC,aAEXrrB,GAAIv2B,WAAYu2B,GAAIld,aAAczX,EAAQpE,QAC1C+4B,GAAIt2B,WAAYs2B,GAAIld,aAAcR,EAAOmpC,YAAazrB,GAAI12B,cAE1DqR,GAAM6qB,gBAAiB8a,EAAkBr5C,QACzC+4B,GAAI4gB,oBAAqBN,EAAkBr5C,OAAQ,EAAG+4B,GAAIp2B,OAAO,EAAO,EAAG,IAIvE0Y,EAAOgpC,SAEXtrB,GAAIv2B,WAAYu2B,GAAIld,aAAczX,EAAQqO,IAC1CsmB,GAAIt2B,WAAYs2B,GAAIld,aAAcR,EAAOopC,QAAS1rB,GAAI12B,cAEtDqR,GAAM6qB,gBAAiB8a,EAAkB5mC,IACzCsmB,GAAI4gB,oBAAqBN,EAAkB5mC,GAAI,EAAGsmB,GAAIp2B,OAAO,EAAO,EAAG,IAInE0Y,EAAOipC,YAEXvrB,GAAIv2B,WAAYu2B,GAAIld,aAAczX,EAAQyD,OAC1CkxB,GAAIt2B,WAAYs2B,GAAIld,aAAcR,EAAOqpC,WAAY3rB,GAAI12B,cAEzDqR,GAAM6qB,gBAAiB8a,EAAkBxxC,OACzCkxB,GAAI4gB,oBAAqBN,EAAkBxxC,MAAO,EAAGkxB,GAAIp2B,OAAO,EAAO,EAAG,IAI3E+Q,GAAMmrB,0BAEN9F,GAAI9iB,WAAY8iB,GAAI1c,UAAW,EAAGhB,EAAOtX,OAEzCsX,EAAOtX,MAAQ,GAIhBlJ,KAAKya,mBAAqB,SAAWvB,EAAQ3F,EAAK8E,EAAUC,EAAUkI,EAAQyV,GAE7E,GAAImQ,GAAgB5lB,EAAOic,QAAUjc,EAAOpV,aAAa0+C,cAAgB,CAEzEjxC,IAAMstB,YAAa7tB,EAAU8tB,EAE7B,IAAI3jB,GAAU49B,EAAYnnC,EAAQ3F,EAAK+E,EAAUkI,GAE7CupC,GAAgB,CAEfzJ,IAAwBjoC,WAAaA,EAAS+H,IAClDkgC,GAAwB79B,UAAYA,EAAQrC,IAC5CkgC,GAAwB7pC,aAAgB6B,EAAS7B,aAAc,KAE/D6pC,GAAwBjoC,SAAWA,EAAS+H,GAC5CkgC,GAAwB79B,QAAUA,EAAQrC,GAC1CkgC,GAAwB7pC,UAAY6B,EAAS7B,aAAc,EAC3DszC,GAAgB,GAIZvpC,EAAOmC,wBAEX26B,GAAa5zC,OAAQ8W,EAAQnI,EAAUC,EAAUmK,GAEjDsnC,GAAgB,EAMjB,IAAI35C,GAAQiI,EAASjI,MACjBtF,EAAWuN,EAAShI,WAAWvF,SAC/Bk/C,EAAc,CAEb1xC,GAAS7B,aAAc,IAE3BrG,EAAQ+P,GAAWc,sBAAuB5I,GAC1C2xC,EAAc,EAIf,IAAI7iD,GACAyR,EAAW+kC,EAEA,QAAVvtC,IAEJjJ,EAAYkJ,GAAWhH,IAAK+G,GAE5BwI,EAAWglC,GACXhlC,EAAS/F,SAAU1L,IAIf4iD,IAEJzL,EAAuBhmC,EAAUmK,EAASpK,GAE3B,OAAVjI,GAEJ8tB,GAAIv2B,WAAYu2B,GAAInd,qBAAsB5Z,EAAUO,QAQtD,IAAIuiD,GAAYllD,EAAAA,CAED,QAAVqL,EAEJ65C,EAAY75C,EAAMlH,MAEMpI,SAAbgK,IAEXm/C,EAAYn/C,EAAS5B,MAItB,IAAIghD,GAAa7xC,EAAS9H,UAAU5J,MAAQqjD,EACxCG,EAAa9xC,EAAS9H,UAAUrH,MAAQ8gD,EAExCt3C,EAAuB,OAAVujB,EAAiBA,EAAMtvB,MAAQqjD,EAAc,EAC1D93C,EAAuB,OAAV+jB,EAAiBA,EAAM/sB,MAAQ8gD,EAAcjlD,EAAAA,EAE1DqlD,EAAYz3C,KAAK7N,IAAKolD,EAAYx3C,GAClC23C,EAAU13C,KAAK9N,IAAKolD,EAAWC,EAAaC,EAAYz3C,EAAaR,GAAe,EAEpFo4C,EAAY33C,KAAK7N,IAAK,EAAGulD,EAAUD,EAAY,EAEnD,IAAmB,IAAdE,EAAL,CAIA,GAAK9pC,EAAOic,OAEX,GAAKnkB,EAAS7B,aAAc,EAE3BoC,GAAMyuB,aAAchvB,EAAS5B,mBAAqBomC,KAClDlkC,EAASsC,QAASgjB,GAAItc,WAItB,QAASpB,EAAOhI,UAEf,IAAKC,IACJG,EAASsC,QAASgjB,GAAI1c,UACtB,MAED,KAAK+oC,IACJ3xC,EAASsC,QAASgjB,GAAIxc,eACtB,MAED,KAAK8oC,IACJ5xC,EAASsC,QAASgjB,GAAIvc,kBAQnB,IAAKnB,EAAOkc,OAAS,CAE3B,GAAI+K,GAAYnvB,EAASlB,SAENtW,UAAd2mC,IAA0BA,EAAY,GAE3C5uB,GAAMyuB,aAAcG,EAAYqV,KAE3Bt8B,EAAOiqC,eAEX7xC,EAASsC,QAASgjB,GAAItc,OAEXpB,EAAOkqC,WAElB9xC,EAASsC,QAASgjB,GAAInc,WAItBnJ,EAASsC,QAASgjB,GAAIpc,gBAIZtB,GAAOmc,SAElB/jB,EAASsC,QAASgjB,GAAIlc,QAEXxB,EAAOi/B,UAElB7mC,EAASsC,QAASgjB,GAAI1c,UAIlBnJ,IAAYA,EAASkmC,0BAEpBlmC,EAASmD,kBAAoB,GAEjC5C,EAASyC,gBAAiBhD,EAAU+xC,EAAWE,GAMhD1xC,EAASG,OAAQqxC,EAAWE,KAyI9BtqD,KAAK2qD,QAAU,SAAW1xC,EAAOC,GAEhCsmC,GAAqBhlB,GAAanxB,IAAK4P,EAAOC,GAC9CsmC,GAAmBvgC,OAEnBhG,EAAM2xC,SAAU,SAAWpqC,GAErBA,EAAO++B,UAEXC,GAAmBtlB,UAAW1Z,GAEzBA,EAAO9U,YAEX8zC,GAAmBrlB,WAAY3Z,MAQlCg/B,GAAmBnlB,YAAanhB,GAEhCD,EAAM2xC,SAAU,SAAWpqC,GAE1B,GAAKA,EAAOlI,SAEX,GAAKlL,MAAMC,QAASmT,EAAOlI,UAE1B,IAAM,GAAItI,GAAI,EAAGA,EAAIwQ,EAAOlI,SAASlY,OAAQ4P,IAE5CwwC,EAAchgC,EAAOlI,SAAUtI,GAAKiJ,EAAM1F,IAAKiN,OAMhDggC,GAAchgC,EAAOlI,SAAUW,EAAM1F,IAAKiN,KAY9C,IAAI27B,IAA2B,KAS3B7E,GAAY,GAAInxC,EACpBmxC,IAAUzwC,iBAAkBT,GAEL,mBAAX2yC,SAAyBzB,GAAUvwC,WAAYgyC,QAE3D/4C,KAAK6G,iBAAmB,SAAWC,GAElCq1C,GAA2Br1C,EAC3Bs4C,GAAGv4C,iBAAkBC,GAErBwwC,GAAU3wC,SAMX3G,KAAK+Y,OAAS,SAAWE,EAAOC,EAAQ4yB,EAAc3yB,GAErD,IAASD,IAAUA,EAAO2xC,SAGzB,WADAxqD,SAAQC,MAAO,yEAKhB,KAAKy9C,GAAL,CAIAuC,GAAwBjoC,SAAW,KACnCioC,GAAwB79B,QAAU,KAClC69B,GAAwB7pC,WAAY,EACpCsrC,MACAF,GAAiB,KAIZ5oC,EAAMglB,cAAe,GAAOhlB,EAAMgmB,oBAIhB,OAAlB/lB,EAAOzO,QAAkByO,EAAO+lB,oBAEhCmgB,GAAGjgC,UAEPjG,EAASkmC,GAAGxF,UAAW1gC,IAMxBsmC,GAAqBhlB,GAAanxB,IAAK4P,EAAOC,GAC9CsmC,GAAmBvgC,OAEnBhG,EAAMkB,eAAgBqjC,GAAOvkC,EAAOC,EAAQ4yB,GAE5C1O,GAAkBN,iBAAkB5jB,EAAOjN,iBAAkBiN,EAAOlN,oBACpE4wB,GAAS2C,cAAenC,IAExBwkB,GAAwB5hD,KAAK+e,qBAC7B4iC,GAAmBf,GAAU3hC,KAAMjf,KAAK8U,eAAgB8sC,GAAuB1oC,GAE/E0mC,GAAoBnC,GAAYp0C,IAAK4P,EAAOC,GAC5C0mC,GAAkB3gC,OAElBogC,EAAepmC,EAAOC,EAAQskC,GAAM8B,aAE/B9B,GAAM8B,eAAgB,GAE1BM,GAAkB78B,OAMd4+B,IAAmBf,GAAUxhC,cAElC,IAAI6a,GAAeulB,GAAmB3mC,MAAMohB,YAE5CpF,IAAU9b,OAAQkhB,EAAchhB,EAAOC,GAEvCsmC,GAAmBnlB,YAAanhB,GAE3ByoC,IAAmBf,GAAUvhC,aAI7Brf,KAAKgb,KAAKqH,WAAYriB,KAAKgb,KAAKkH,QAEfphB,SAAjBgrC,IAEJA,EAAe,MAIhB9rC,KAAKm/B,gBAAiB2M,GAItB1yB,GAAWL,OAAQ6mC,GAAmB3mC,EAAOC,EAAQC,EAIrD,IAAI2xC,GAAgBlL,GAAkB5pB,OAClC+0B,EAAqBnL,GAAkB5rC,WAE3C,IAAKiF,EAAM8mC,iBAAmB,CAE7B,GAAIA,GAAmB9mC,EAAM8mC,gBAExB+K,GAAc1qD,QAAS0/C,EAAegL,EAAe7xC,EAAOC,EAAQ6mC,GACpEgL,EAAmB3qD,QAAS0/C,EAAeiL,EAAoB9xC,EAAOC,EAAQ6mC,OAM9E+K,GAAc1qD,QAAS0/C,EAAegL,EAAe7xC,EAAOC,GAI5D6xC,EAAmB3qD,QAAS0/C,EAAeiL,EAAoB9xC,EAAOC,EAMvE4yB,IAEJ3pB,GAASwuB,yBAA0B7E,GAMpCjzB,GAAMtP,QAAQkH,MAAM6tB,SAAS,GAC7BzlB,GAAMtP,QAAQkH,MAAMqvB,SAAS,GAC7BjnB,GAAMtP,QAAQyD,MAAM8yB,SAAS,GAE7BjnB,GAAM2tB,kBAAkB,GAExBvtB,EAAMsnC,cAAe/C,GAAOvkC,EAAOC,GAE9BkmC,GAAGjgC,SAEPigC,GAAGrE,cAMJ6E,GAAoB,KACpBJ,GAAqB,OAwrCtBx/C,KAAKskB,iBAAmBA,EAGxBtkB,KAAKgmB,aAAiB,WAErB,GAAIglC,IAAS,CAGb,OAAO,UAAuB/mD,EAASyoC,GAEjCzoC,GAAWA,EAAQuuB,sBAEhBw4B,IAEN3qD,QAAQ4H,KAAM,gHACd+iD,GAAS,GAIV/mD,EAAUA,EAAQA,SAInBke,GAAS6D,aAAc/hB,EAASyoC,OAMlC1sC,KAAKirD,WAAe,WAEnB,GAAID,IAAS,CAEb,OAAO,UAAqB/mD,EAASyoC,GAE7Bse,IAEN3qD,QAAQ4H,KAAM,6EACd+iD,GAAS,GAIV7oC,GAAS6D,aAAc/hB,EAASyoC,OAMlC1sC,KAAKmmB,eAAmB,WAEvB,GAAI6kC,IAAS,CAEb,OAAO,UAAyB/mD,EAASyoC,GAGnCzoC,GAAWA,EAAQooC,0BAEhB2e,IAEN3qD,QAAQ4H,KAAM,uHACd+iD,GAAS,GAIV/mD,EAAUA,EAAQA,SAMZA,GAAWA,EAAQ4V,eACvBzM,MAAMC,QAASpJ,EAAQ/C,QAAoC,IAAzB+C,EAAQ/C,MAAMd,OAKlD+hB,GAASgE,eAAgBliB,EAASyoC,GAMlCvqB,GAASyrB,sBAAuB3pC,EAASyoC,OAU5C1sC,KAAKu7C,eAAiB,SAAWz5C,GAEhC4lD,GAAe5lD,GAIhB9B,KAAK+zB,gBAAkB,WAEtB,MAAOgpB,KAIR/8C,KAAKm/B,gBAAkB,SAAW2M,GAEjCiR,GAAuBjR,EAElBA,GAAsEhrC,SAAtD40B,GAAWrsB,IAAKyiC,GAAeS,oBAEnDpqB,GAASouB,kBAAmBzE,EAI7B,IAAIqD,GAAcuY,GACdvX,GAAS,CAEb,IAAKrE,EAAe,CAEnB,GAAIS,GAAqB7W,GAAWrsB,IAAKyiC,GAAeS,kBAEnDT,GAAaO,yBAEjB8C,EAAc5C,EAAoBT,EAAavnC,gBAC/C4rC,GAAS,GAIThB,EAAc5C,EAIf6Q,GAAiBx+B,KAAMktB,EAAa9nC,UACpCk5C,GAAgBt+B,KAAMktB,EAAahoC,SACnC8jD,GAAsB9b,EAAa/nC,gBAInCq5C,IAAiBx+B,KAAMy+B,IAAYnlB,eAAgB8kB,IACnDE,GAAgBt+B,KAAMu+B,IAAWjlB,eAAgB8kB,IACjD4K,GAAsBC,EAevB,IAXKF,KAAwBxY,IAE5BjR,GAAIoR,gBAAiBpR,GAAIqR,YAAaJ,GACtCwY,GAAsBxY,GAIvBt2B,GAAM7U,SAAUo5C,IAChBvkC,GAAM/U,QAASo5C,IACfrkC,GAAM0lB,eAAgBqpB,IAEjBzX,EAAS,CAEb,GAAI7F,GAAoB5U,GAAWrsB,IAAKyiC,EAAa7nC,QACrDi6B,IAAIsR,qBAAsBtR,GAAIqR,YAAarR,GAAIwS,kBAAmBxS,GAAIiL,4BAA8B2C,EAAavnC,eAAgB+lC,EAAkB6B,eAAgBL,EAAatnC,qBAMlLxE,KAAKkrD,uBAAyB,SAAWpf,EAAchsC,EAAGC,EAAG4D,EAAOC,EAAQ8D,GAE3E,IAASokC,IAAgBA,EAAatZ,oBAGrC,WADAnyB,SAAQC,MAAO,2FAKhB,IAAI6uC,GAAczZ,GAAWrsB,IAAKyiC,GAAeS,kBAEjD,IAAK4C,EAAc,CAElB,GAAIgc,IAAU,CAEThc,KAAgBwY,KAEpBzpB,GAAIoR,gBAAiBpR,GAAIqR,YAAaJ,GAEtCgc,GAAU,EAIX,KAEC,GAAIlnD,GAAU6nC,EAAa7nC,QACvBmnD,EAAgBnnD,EAAQzC,OACxBqsC,EAAc5pC,EAAQxC,IAE1B,IAAK2pD,IAAkB1oD,IAAc+8B,GAAMuF,QAASomB,KAAoBltB,GAAItiB,aAAcsiB,GAAImtB,kCAG7F,WADAhrD,SAAQC,MAAO,4GAKhB,MAAKutC,IAAgBlrC,IAAoB88B,GAAMuF,QAAS6I,KAAkB3P,GAAItiB,aAAcsiB,GAAIotB,iCAC3Fzd,IAAgBI,KAAehzB,GAAaM,UAAYjE,GAAWjO,IAAK,sBAAyBiO,GAAWjO,IAAK,8BACjHwkC,IAAgBK,KAAmBjzB,GAAaM,SAAWjE,GAAWjO,IAAK,0BAA6BiO,GAAWjO,IAAK,iCAG5H,WADAhJ,SAAQC,MAAO,sHAKX49B,IAAIqtB,uBAAwBrtB,GAAIqR,eAAkBrR,GAAIstB,qBAInD1rD,GAAK,GAAKA,GAAOgsC,EAAanoC,MAAQA,GAAe5D,GAAK,GAAKA,GAAO+rC,EAAaloC,OAASA,GAElGs6B,GAAIutB,WAAY3rD,EAAGC,EAAG4D,EAAOC,EAAQ67B,GAAMuF,QAASomB,GAAiB3rB,GAAMuF,QAAS6I,GAAenmC,GAMpGrH,QAAQC,MAAO,8GAIf,QAEI6qD,GAEJjtB,GAAIoR,gBAAiBpR,GAAIqR,YAAaoY,OAU1C3nD,KAAK0rD,yBAA2B,SAAW5gD,EAAU7G,EAAS0nD,GAE7D,GAAIhoD,GAAQM,EAAQ/C,MAAMyC,MACtBC,EAASK,EAAQ/C,MAAM0C,OACvB8mC,EAAWjL,GAAMuF,QAAS/gC,EAAQzC,OAEtCxB,MAAKgmB,aAAc/hB,EAAS,GAE5Bi6B,GAAI0tB,eAAgB1tB,GAAI+K,WAAY0iB,GAAS,EAAGjhB,EAAU5/B,EAAShL,EAAGgL,EAAS/K,EAAG4D,EAAOC,EAAQ,IAIlG5D,KAAK6rD,qBAAuB,SAAW/gD,EAAUghD,EAAYC,EAAYJ,GAExE,GAAIhoD,GAAQmoD,EAAW5qD,MAAMyC,MACzBC,EAASkoD,EAAW5qD,MAAM0C,OAC1B8mC,EAAWjL,GAAMuF,QAAS+mB,EAAWvqD,QACrCmpC,EAASlL,GAAMuF,QAAS+mB,EAAWtqD,KAEvCzB,MAAKgmB,aAAc+lC,EAAY,GAE1BD,EAAW3e,cAEfjP,GAAI8tB,cAAe9tB,GAAI+K,WAAY0iB,GAAS,EAAG7gD,EAAShL,EAAGgL,EAAS/K,EAAG4D,EAAOC,EAAQ8mC,EAAUC,EAAQmhB,EAAW5qD,MAAMwD,MAIzHw5B,GAAI8tB,cAAe9tB,GAAI+K,WAAY0iB,GAAS,EAAG7gD,EAAShL,EAAGgL,EAAS/K,EAAG2qC,EAAUC,EAAQmhB,EAAW5qD,QAavG,QAAS+qD,IAASj/C,EAAOk5C,GAExBlmD,KAAKmC,KAAO,GAEZnC,KAAKgN,MAAQ,GAAInH,GAAOmH,GACxBhN,KAAKkmD,QAAwBplD,SAAZolD,EAA0BA,EAAU,MA2BtD,QAASgG,IAAKl/C,EAAOR,EAAMC,GAE1BzM,KAAKmC,KAAO,GAEZnC,KAAKgN,MAAQ,GAAInH,GAAOmH,GAExBhN,KAAKwM,KAAkB1L,SAAT0L,EAAuBA,EAAO,EAC5CxM,KAAKyM,IAAgB3L,SAAR2L,EAAsBA,EAAM,IA2B1C,QAAS0/C,MAERjiD,EAAS5F,KAAMtE,MAEfA,KAAKyB,KAAO,QAEZzB,KAAKoZ,WAAa,KAClBpZ,KAAKuT,IAAM,KACXvT,KAAK+/C,iBAAmB,KAExB//C,KAAKi+B,YAAa,EAwCnB,QAASmuB,IAAmB/kD,EAAOu3C,GAElC5+C,KAAKqH,MAAQA,EACbrH,KAAK4+C,OAASA,EACd5+C,KAAKkJ,MAAkBpI,SAAVuG,EAAsBA,EAAMjH,OAASw+C,EAAS,EAE3D5+C,KAAKuH,SAAU,EACfvH,KAAKiJ,aAAgBrG,OAAQ,EAAGsG,UAEhClJ,KAAKuD,QAAU,EAmGhB,QAAS8oD,IAA4BC,EAAmBz9C,EAAUjM,EAAQkM,GAEzE9O,KAAK0E,KAAO4nD,EACZtsD,KAAK6O,SAAWA,EAChB7O,KAAK4C,OAASA,EAEd5C,KAAK8O,WAAaA,KAAe,EAyIlC,QAASwkB,IAAgBziB,GAExBwC,EAAS/O,KAAMtE,MAEfA,KAAKyB,KAAO,iBAEZzB,KAAKgN,MAAQ,GAAInH,GAAO,UACxB7F,KAAK6V,IAAM,KAEX7V,KAAK+C,SAAW,EAEhB/C,KAAKwvB,iBAAkB,EAEvBxvB,KAAKwT,QAAS,EACdxT,KAAKgU,aAAc,EAEnBhU,KAAK8W,UAAWjG,GA8BjB,QAAS07C,IAAQj0C,GAMhB,GAJApO,EAAS5F,KAAMtE,MAEfA,KAAKyB,KAAO,SAEMX,SAAbuX,GAAyB,CAE7BA,GAAW,GAAInI,EAEf,IAAIs8C,GAAe,GAAIzkD,uBACR,EAAG,EAAG,EACpB,OAAY,EAAG,EAAG,EAClB,GAAK,GAAK,EAAG,EAAG,MACT,GAAK,EAAG,EAAG,IAGfukD,EAAoB,GAAIF,IAAmBI,EAAc,EAE7Dn0C,IAASxF,UAAY,EAAG,EAAG,EAAG,EAAG,EAAG,IACpCwF,GAASvF,aAAc,WAAY,GAAIu5C,IAA4BC,EAAmB,EAAG,IAAG,KAC5Fj0C,GAASvF,aAAc,KAAM,GAAIu5C,IAA4BC,EAAmB,EAAG,IAAG,KAIvFtsD,KAAKqY,SAAWA,GAChBrY,KAAKsY,SAA0BxX,SAAbwX,EAA2BA,EAAW,GAAIgb,IAE5DtzB,KAAK8C,OAAS,GAAIjD,GAAS,GAAK,IAkIjC,QAAS4sD,MAERviD,EAAS5F,KAAMtE,MAEfA,KAAKyB,KAAO,MAEZG,OAAOqJ,iBAAkBjL,MACxB0sD,QACCxhD,YAAY,EACZpJ,YAmKH,QAAS6qD,IAAUx6B,EAAOy6B,GAWzB,GAPAz6B,EAAQA,MAERnyB,KAAKmyB,MAAQA,EAAM06B,MAAO,GAC1B7sD,KAAKgjD,aAAe,GAAIj7C,cAAkC,GAApB/H,KAAKmyB,MAAM/xB,QAI3BU,SAAjB8rD,EAEJ5sD,KAAK8sD,wBAIL,IAAK9sD,KAAKmyB,MAAM/xB,SAAWwsD,EAAaxsD,OAEvCJ,KAAK4sD,aAAeA,EAAaC,MAAO,OAElC,CAENxsD,QAAQ4H,KAAM,oDAEdjI,KAAK4sD,eAEL,KAAM,GAAI58C,GAAI,EAAGyuB,EAAKz+B,KAAKmyB,MAAM/xB,OAAQ4P,EAAIyuB,EAAIzuB,IAEhDhQ,KAAK4sD,aAAax6C,KAAM,GAAInS,KAgJhC,QAAS8sD,MAER7iD,EAAS5F,KAAMtE,MAEfA,KAAKyB,KAAO,OAkBb,QAASurD,IAAa30C,EAAUC,GAE/BF,EAAK9T,KAAMtE,KAAMqY,EAAUC,GAE3BtY,KAAKyB,KAAO,cAEZzB,KAAKitD,SAAW,WAChBjtD,KAAKktD,WAAa,GAAIjtD,GACtBD,KAAKmtD,kBAAoB,GAAIltD,EAE7B,IAAIkyB,GAAQnyB,KAAKotD,YACbl7B,EAAW,GAAIy6B,IAAUx6B,EAE7BnyB,MAAKqtD,KAAMn7B,EAAUlyB,KAAKqL,aAE1BrL,KAAKstD,uBAkMN,QAASp6B,IAAmBriB,GAE3BwC,EAAS/O,KAAMtE,MAEfA,KAAKyB,KAAO,oBAEZzB,KAAKgN,MAAQ,GAAInH,GAAO,UAExB7F,KAAKoX,UAAY,EACjBpX,KAAKutD,QAAU,QACfvtD,KAAKwtD,SAAW,QAEhBxtD,KAAKwT,QAAS,EAEdxT,KAAK8W,UAAWjG,GA2BjB,QAAS48C,IAAMp1C,EAAUC,EAAU6C,GAEpB,IAATA,GAEJ9a,QAAQC,MAAO,+FAIhB4J,EAAS5F,KAAMtE,MAEfA,KAAKyB,KAAO,OAEZzB,KAAKqY,SAAwBvX,SAAbuX,EAAyBA,EAAW,GAAInI,GACxDlQ,KAAKsY,SAAwBxX,SAAbwX,EAAyBA,EAAW,GAAI4a,KAAqBlmB,MAAuB,SAAhB2F,KAAK4F,WAqO1F,QAASm1C,IAAcr1C,EAAUC,GAEhCm1C,GAAKnpD,KAAMtE,KAAMqY,EAAUC,GAE3BtY,KAAKyB,KAAO,eA2Eb,QAASksD,IAAUt1C,EAAUC,GAE5Bm1C,GAAKnpD,KAAMtE,KAAMqY,EAAUC,GAE3BtY,KAAKyB,KAAO,WA4Bb,QAAS2xB,IAAgBviB,GAExBwC,EAAS/O,KAAMtE,MAEfA,KAAKyB,KAAO,iBAEZzB,KAAKgN,MAAQ,GAAInH,GAAO,UAExB7F,KAAK6V,IAAM,KAEX7V,KAAKinB,KAAO,EACZjnB,KAAKwvB,iBAAkB,EAEvBxvB,KAAK8N,cAAe,EAEpB9N,KAAKwT,QAAS,EAEdxT,KAAK8W,UAAWjG,GA8BjB,QAAS+8C,IAAQv1C,EAAUC,GAE1BpO,EAAS5F,KAAMtE,MAEfA,KAAKyB,KAAO,SAEZzB,KAAKqY,SAAwBvX,SAAbuX,EAAyBA,EAAW,GAAInI,GACxDlQ,KAAKsY,SAAwBxX,SAAbwX,EAAyBA,EAAW,GAAI8a,KAAkBpmB,MAAuB,SAAhB2F,KAAK4F,WAmIvF,QAASs1C,IAAcC,EAAO3sD,EAASC,EAAOC,EAAOC,EAAWC,EAAWC,EAAQC,EAAMC,GAExFT,EAAQqD,KAAMtE,KAAM8tD,EAAO3sD,EAASC,EAAOC,EAAOC,EAAWC,EAAWC,EAAQC,EAAMC,GAEtF1B,KAAKkD,iBAAkB,EA4BxB,QAAS6qD,IAAmB1rD,EAASsB,EAAOC,EAAQpC,EAAQC,EAAMN,EAASC,EAAOC,EAAOC,EAAWC,EAAWG,EAAYC,GAE1HV,EAAQqD,KAAMtE,KAAM,KAAMmB,EAASC,EAAOC,EAAOC,EAAWC,EAAWC,EAAQC,EAAMC,EAAYC,GAEjG3B,KAAKkB,OAAUyC,MAAOA,EAAOC,OAAQA,GACrC5D,KAAKqC,QAAUA,EAKfrC,KAAKoD,OAAQ,EAKbpD,KAAKkD,iBAAkB,EAaxB,QAAS8qD,IAAezkB,EAAQpoC,EAASC,EAAOC,EAAOC,EAAWC,EAAWC,EAAQC,EAAMC,GAE1FT,EAAQqD,KAAMtE,KAAMupC,EAAQpoC,EAASC,EAAOC,EAAOC,EAAWC,EAAWC,EAAQC,EAAMC,GAEvF1B,KAAK2V,aAAc,EAapB,QAASs4C,IAActqD,EAAOC,EAAQnC,EAAMN,EAASC,EAAOC,EAAOC,EAAWC,EAAWG,EAAYF,GAIpG,GAFAA,EAAoBV,SAAXU,EAAuBA,EAASotC,GAEpCptC,IAAWotC,IAAeptC,IAAWutC,GAEzC,KAAM,IAAIzkB,OAAO,mFAIJxpB,UAATW,GAAsBD,IAAWotC,KAAcntC,EAAOotC,IAC7C/tC,SAATW,GAAsBD,IAAWutC,KAAqBttC,EAAOwtC,IAElEhuC,EAAQqD,KAAMtE,KAAM,KAAMmB,EAASC,EAAOC,EAAOC,EAAWC,EAAWC,EAAQC,EAAMC,GAErF1B,KAAKkB,OAAUyC,MAAOA,EAAOC,OAAQA,GAErC5D,KAAKsB,UAA0BR,SAAdQ,EAA0BA,EAAYqD,GACvD3E,KAAKuB,UAA0BT,SAAdS,EAA0BA,EAAYoD,GAEvD3E,KAAKoD,OAAQ,EACbpD,KAAKkD,iBAAkB,EAaxB,QAASgrD,IAAmB71C,GAE3BnI,EAAe5L,KAAMtE,MAErBA,KAAKyB,KAAO,mBAIZ,IAIIuO,GAAGy9B,EAAGx9B,EAAGk+C,EAAGC,EACiBC,EAAGC,EAAOC,EACvC54B,EACA64B,EAPA9gD,KAKA+gD,GAAS,EAAG,GAAKC,KACZC,GAAS,IAAK,IAAK,IAK5B,IAAKt2C,GAAYA,EAASsI,WAAa,CAItC,GAAI/S,GAAQyK,EAASzK,KAErB,KAAMoC,EAAI,EAAGC,EAAIrC,EAAMxN,OAAQ4P,EAAIC,EAAGD,IAAO,CAE5C,GAAIovB,GAAOxxB,EAAOoC,EAElB,KAAMy9B,EAAI,EAAGA,EAAI,EAAGA,IAEnB6gB,EAAQlvB,EAAMuvB,EAAMlhB,IACpB8gB,EAAQnvB,EAAMuvB,GAAQlhB,EAAI,GAAM,IAChCghB,EAAM,GAAM97C,KAAK9N,IAAKypD,EAAOC,GAC7BE,EAAM,GAAM97C,KAAK7N,IAAKwpD,EAAOC,GAE7B54B,EAAM84B,EAAM,GAAM,IAAMA,EAAM,GAER3tD,SAAjB4tD,EAAO/4B,KAEX+4B,EAAO/4B,IAAUi5B,OAAQH,EAAM,GAAKI,OAAQJ,EAAM,KAUrD,IAAM94B,IAAO+4B,GAEZL,EAAIK,EAAO/4B,GAEX64B,EAASn2C,EAAS3K,SAAU2gD,EAAEO,QAC9BlhD,EAAS0E,KAAMo8C,EAAO1uD,EAAG0uD,EAAOzuD,EAAGyuD,EAAOhuD,GAE1CguD,EAASn2C,EAAS3K,SAAU2gD,EAAEQ,QAC9BnhD,EAAS0E,KAAMo8C,EAAO1uD,EAAG0uD,EAAOzuD,EAAGyuD,EAAOhuD,OAIrC,IAAK6X,GAAYA,EAASqI,iBAAmB,CAEnD,GAAI5V,GAAUyH,EAASzC,EACnBmmB,EAAOtvB,EAAOuC,EACd0lD,EAAQC,CAIZ,IAFAL,EAAS,GAAIztD,GAEW,OAAnBsX,EAASjI,MAAiB,CAgB9B,IAZAtF,EAAWuN,EAAShI,WAAWvF,SAC/ByH,EAAU8F,EAASjI,MACnBN,EAASuI,EAASvI,OAEK,IAAlBA,EAAO1P,SAEX0P,IAAanJ,MAAO,EAAGuC,MAAOqJ,EAAQrJ,MAAO+D,cAAe,KAMvDkhD,EAAI,EAAGC,EAAKt+C,EAAO1P,OAAQ+tD,EAAIC,IAAOD,EAO3C,IALAl4B,EAAQnmB,EAAQq+C,GAEhBxnD,EAAQsvB,EAAMtvB,MACduC,EAAQ+sB,EAAM/sB,MAER8G,EAAIrJ,EAAOsJ,EAAMtJ,EAAQuC,EAAS8G,EAAIC,EAAGD,GAAK,EAEnD,IAAMy9B,EAAI,EAAGA,EAAI,EAAGA,IAEnB6gB,EAAQ/7C,EAAQu8C,KAAM9+C,EAAIy9B,GAC1B8gB,EAAQh8C,EAAQu8C,KAAM9+C,GAAMy9B,EAAI,GAAM,GACtCghB,EAAM,GAAM97C,KAAK9N,IAAKypD,EAAOC,GAC7BE,EAAM,GAAM97C,KAAK7N,IAAKwpD,EAAOC,GAE7B54B,EAAM84B,EAAM,GAAM,IAAMA,EAAM,GAER3tD,SAAjB4tD,EAAO/4B,KAEX+4B,EAAO/4B,IAAUi5B,OAAQH,EAAM,GAAKI,OAAQJ,EAAM,IAYtD,KAAM94B,IAAO+4B,GAEZL,EAAIK,EAAO/4B,GAEX64B,EAAOO,oBAAqBjkD,EAAUujD,EAAEO,QACxClhD,EAAS0E,KAAMo8C,EAAO1uD,EAAG0uD,EAAOzuD,EAAGyuD,EAAOhuD,GAE1CguD,EAAOO,oBAAqBjkD,EAAUujD,EAAEQ,QACxCnhD,EAAS0E,KAAMo8C,EAAO1uD,EAAG0uD,EAAOzuD,EAAGyuD,EAAOhuD,OAU3C,KAFAsK,EAAWuN,EAAShI,WAAWvF,SAEzBkF,EAAI,EAAGC,EAAMnF,EAAS5B,MAAQ,EAAK8G,EAAIC,EAAGD,IAE/C,IAAMy9B,EAAI,EAAGA,EAAI,EAAGA,IAKnBmhB,EAAS,EAAI5+C,EAAIy9B,EACjB+gB,EAAOO,oBAAqBjkD,EAAU8jD,GACtClhD,EAAS0E,KAAMo8C,EAAO1uD,EAAG0uD,EAAOzuD,EAAGyuD,EAAOhuD,GAE1CquD,EAAS,EAAI7+C,GAAQy9B,EAAI,GAAM,EAC/B+gB,EAAOO,oBAAqBjkD,EAAU+jD,GACtCnhD,EAAS0E,KAAMo8C,EAAO1uD,EAAG0uD,EAAOzuD,EAAGyuD,EAAOhuD,GAY9CR,KAAK8S,aAAc,WAAY,GAAItD,GAAwB9B,EAAU,IAiBtE,QAASshD,IAAoBC,EAAMC,EAAQC,GAE1C3hD,EAASlJ,KAAMtE,MAEfA,KAAKyB,KAAO,qBAEZzB,KAAK6Q,YACJo+C,KAAMA,EACNC,OAAQA,EACRC,OAAQA,GAGTnvD,KAAK8Q,mBAAoB,GAAIs+C,IAA0BH,EAAMC,EAAQC,IACrEnvD,KAAKgR,gBASN,QAASo+C,IAA0BH,EAAMC,EAAQC,GAEhDj/C,EAAe5L,KAAMtE,MAErBA,KAAKyB,KAAO,2BAEZzB,KAAK6Q,YACJo+C,KAAMA,EACNC,OAAQA,EACRC,OAAQA,EAKT,IAYIn/C,GAAGy9B,EAZHl7B,KACA7E,KACAiC,KACAC,KAEAy/C,EAAM,KAENlqD,EAAS,GAAIpE,GAEbuE,EAAK,GAAIvE,GAAWwE,EAAK,GAAIxE,GAC7BuuD,EAAK,GAAIvuD,GAAWwuD,EAAK,GAAIxuD,EAI5BkuD,GAAK7uD,OAAS,GAElBC,QAAQC,MAAO,mFAMhB,IAAIkvD,GAAaN,EAAS,CAE1B,KAAMl/C,EAAI,EAAGA,GAAKm/C,EAAQn/C,IAAO,CAEhC,GAAImB,GAAInB,EAAIm/C,CAEZ,KAAM1hB,EAAI,EAAGA,GAAKyhB,EAAQzhB,IAAO,CAEhC,GAAIv8B,GAAIu8B,EAAIyhB,CAIZD,GAAM/9C,EAAGC,EAAG7L,GACZoI,EAAS0E,KAAM9M,EAAGxF,EAAGwF,EAAGvF,EAAGuF,EAAG9E,GAMzB0Q,EAAIm+C,GAAO,GAEfJ,EAAM/9C,EAAIm+C,EAAKl+C,EAAG5L,GAClB+pD,EAAGG,WAAYnqD,EAAIC,KAInB0pD,EAAM/9C,EAAIm+C,EAAKl+C,EAAG5L,GAClB+pD,EAAGG,WAAYlqD,EAAID,IAIf6L,EAAIk+C,GAAO,GAEfJ,EAAM/9C,EAAGC,EAAIk+C,EAAK9pD,GAClBgqD,EAAGE,WAAYnqD,EAAIC,KAInB0pD,EAAM/9C,EAAGC,EAAIk+C,EAAK9pD,GAClBgqD,EAAGE,WAAYlqD,EAAID,IAMpBH,EAAOuqD,aAAcJ,EAAIC,GAAK51B,YAC9BhqB,EAAQyC,KAAMjN,EAAOrF,EAAGqF,EAAOpF,EAAGoF,EAAO3E,GAIzCoP,EAAIwC,KAAMlB,EAAGC,IAQf,IAAMnB,EAAI,EAAGA,EAAIm/C,EAAQn/C,IAExB,IAAMy9B,EAAI,EAAGA,EAAIyhB,EAAQzhB,IAAO,CAE/B,GAAI3gC,GAAIkD,EAAIw/C,EAAa/hB,EACrBznC,EAAIgK,EAAIw/C,EAAa/hB,EAAI,EACzB1gC,GAAMiD,EAAI,GAAMw/C,EAAa/hB,EAAI,EACjCn7B,GAAMtC,EAAI,GAAMw/C,EAAa/hB,CAIjCl7B,GAAQH,KAAMtF,EAAG9G,EAAGsM,GACpBC,EAAQH,KAAMpM,EAAG+G,EAAGuF,GAQtBtS,KAAK6S,SAAUN,GACfvS,KAAK8S,aAAc,WAAY,GAAItD,GAAwB9B,EAAU,IACrE1N,KAAK8S,aAAc,SAAU,GAAItD,GAAwBG,EAAS,IAClE3P,KAAK8S,aAAc,KAAM,GAAItD,GAAwBI,EAAK,IAgB3D,QAAS+/C,IAAoBjiD,EAAU6E,EAAStN,EAAQ2qD,GAEvDpiD,EAASlJ,KAAMtE,MAEfA,KAAKyB,KAAO,qBAEZzB,KAAK6Q,YACJnD,SAAUA,EACV6E,QAASA,EACTtN,OAAQA,EACR2qD,OAAQA,GAGT5vD,KAAK8Q,mBAAoB,GAAI++C,IAA0BniD,EAAU6E,EAAStN,EAAQ2qD,IAClF5vD,KAAKgR,gBASN,QAAS6+C,IAA0BniD,EAAU6E,EAAStN,EAAQ2qD,GAmD7D,QAASE,GAAWF,GAQnB,IAAM,GANF9iD,GAAI,GAAI/L,GACRiF,EAAI,GAAIjF,GACRgM,EAAI,GAAIhM,GAIFiP,EAAI,EAAGA,EAAIuC,EAAQnS,OAAQ4P,GAAK,EAIzC+/C,EAAkBx9C,EAASvC,EAAI,GAAKlD,GACpCijD,EAAkBx9C,EAASvC,EAAI,GAAKhK,GACpC+pD,EAAkBx9C,EAASvC,EAAI,GAAKjD,GAIpCijD,EAAeljD,EAAG9G,EAAG+G,EAAG6iD,GAM1B,QAASI,GAAeljD,EAAG9G,EAAG+G,EAAG6iD,GAEhC,GAMI5/C,GAAGy9B,EANHwiB,EAAOt9C,KAAKu9C,IAAK,EAAGN,GAIpBz+C,IAMJ,KAAMnB,EAAI,EAAGA,GAAKigD,EAAMjgD,IAAO,CAE9BmB,EAAGnB,KAEH,IAAImgD,GAAKrjD,EAAEjC,QAAQulD,KAAMrjD,EAAGiD,EAAIigD,GAC5BI,EAAKrqD,EAAE6E,QAAQulD,KAAMrjD,EAAGiD,EAAIigD,GAE5BK,EAAOL,EAAOjgD,CAElB,KAAMy9B,EAAI,EAAGA,GAAK6iB,EAAM7iB,IAEZ,IAANA,GAAWz9B,IAAMigD,EAErB9+C,EAAGnB,GAAKy9B,GAAM0iB,EAIdh/C,EAAGnB,GAAKy9B,GAAM0iB,EAAGtlD,QAAQulD,KAAMC,EAAI5iB,EAAI6iB,GAU1C,IAAMtgD,EAAI,EAAGA,EAAIigD,EAAMjgD,IAEtB,IAAMy9B,EAAI,EAAGA,EAAI,GAAMwiB,EAAOjgD,GAAM,EAAGy9B,IAAO,CAE7C,GAAI1Q,GAAIpqB,KAAKC,MAAO66B,EAAI,EAEnBA,GAAI,IAAM,GAEd8iB,EAAYp/C,EAAGnB,GAAK+sB,EAAI,IACxBwzB,EAAYp/C,EAAGnB,EAAI,GAAK+sB,IACxBwzB,EAAYp/C,EAAGnB,GAAK+sB,MAIpBwzB,EAAYp/C,EAAGnB,GAAK+sB,EAAI,IACxBwzB,EAAYp/C,EAAGnB,EAAI,GAAK+sB,EAAI,IAC5BwzB,EAAYp/C,EAAGnB,EAAI,GAAK+sB,MAU5B,QAASyzB,GAAcvrD,GAMtB,IAAM,GAJFupD,GAAS,GAAIztD,GAIPiP,EAAI,EAAGA,EAAIygD,EAAarwD,OAAQ4P,GAAK,EAE9Cw+C,EAAO1uD,EAAI2wD,EAAczgD,EAAI,GAC7Bw+C,EAAOzuD,EAAI0wD,EAAczgD,EAAI,GAC7Bw+C,EAAOhuD,EAAIiwD,EAAczgD,EAAI,GAE7Bw+C,EAAO70B,YAAYzB,eAAgBjzB,GAEnCwrD,EAAczgD,EAAI,GAAMw+C,EAAO1uD,EAC/B2wD,EAAczgD,EAAI,GAAMw+C,EAAOzuD,EAC/B0wD,EAAczgD,EAAI,GAAMw+C,EAAOhuD,EAMjC,QAASkwD,KAIR,IAAM,GAFFlC,GAAS,GAAIztD,GAEPiP,EAAI,EAAGA,EAAIygD,EAAarwD,OAAQ4P,GAAK,EAAI,CAElDw+C,EAAO1uD,EAAI2wD,EAAczgD,EAAI,GAC7Bw+C,EAAOzuD,EAAI0wD,EAAczgD,EAAI,GAC7Bw+C,EAAOhuD,EAAIiwD,EAAczgD,EAAI,EAE7B,IAAIkB,GAAIy/C,EAASnC,GAAW,EAAI77C,KAAKi+C,GAAK,GACtCz/C,EAAI0/C,EAAarC,GAAW77C,KAAKi+C,GAAK,EAC1CE,GAAS1+C,KAAMlB,EAAG,EAAIC,GAIvB4/C,IAEAC,IAID,QAASA,KAIR,IAAM,GAAIhhD,GAAI,EAAGA,EAAI8gD,EAAS1wD,OAAQ4P,GAAK,EAAI,CAI9C,GAAIihD,GAAKH,EAAU9gD,EAAI,GACnBkhD,EAAKJ,EAAU9gD,EAAI,GACnBmhD,EAAKL,EAAU9gD,EAAI,GAEnBlL,EAAM6N,KAAK7N,IAAKmsD,EAAIC,EAAIC,GACxBtsD,EAAM8N,KAAK9N,IAAKosD,EAAIC,EAAIC,EAIvBrsD,GAAM,IAAOD,EAAM,KAElBosD,EAAK,KAAMH,EAAU9gD,EAAI,IAAO,GAChCkhD,EAAK,KAAMJ,EAAU9gD,EAAI,IAAO,GAChCmhD,EAAK,KAAML,EAAU9gD,EAAI,IAAO,KAQxC,QAASugD,GAAY/B,GAEpBiC,EAAar+C,KAAMo8C,EAAO1uD,EAAG0uD,EAAOzuD,EAAGyuD,EAAOhuD,GAI/C,QAASuvD,GAAkB3/C,EAAOo+C,GAEjC,GAAI5P,GAAiB,EAARxuC,CAEbo+C,GAAO1uD,EAAI4N,EAAUkxC,EAAS,GAC9B4P,EAAOzuD,EAAI2N,EAAUkxC,EAAS,GAC9B4P,EAAOhuD,EAAIkN,EAAUkxC,EAAS,GAI/B,QAASmS,KAYR,IAAM,GAVFjkD,GAAI,GAAI/L,GACRiF,EAAI,GAAIjF,GACRgM,EAAI,GAAIhM,GAERqwD,EAAW,GAAIrwD,GAEfswD,EAAM,GAAIxxD,GACVyxD,EAAM,GAAIzxD,GACV0xD,EAAM,GAAI1xD,GAEJmQ,EAAI,EAAGy9B,EAAI,EAAGz9B,EAAIygD,EAAarwD,OAAQ4P,GAAK,EAAGy9B,GAAK,EAAI,CAEjE3gC,EAAE7G,IAAKwqD,EAAczgD,EAAI,GAAKygD,EAAczgD,EAAI,GAAKygD,EAAczgD,EAAI,IACvEhK,EAAEC,IAAKwqD,EAAczgD,EAAI,GAAKygD,EAAczgD,EAAI,GAAKygD,EAAczgD,EAAI,IACvEjD,EAAE9G,IAAKwqD,EAAczgD,EAAI,GAAKygD,EAAczgD,EAAI,GAAKygD,EAAczgD,EAAI,IAEvEqhD,EAAIprD,IAAK6qD,EAAUrjB,EAAI,GAAKqjB,EAAUrjB,EAAI,IAC1C6jB,EAAIrrD,IAAK6qD,EAAUrjB,EAAI,GAAKqjB,EAAUrjB,EAAI,IAC1C8jB,EAAItrD,IAAK6qD,EAAUrjB,EAAI,GAAKqjB,EAAUrjB,EAAI,IAE1C2jB,EAASxyC,KAAM9R,GAAIuyB,IAAKr5B,GAAIq5B,IAAKtyB,GAAIykD,aAAc,EAEnD,IAAIC,GAAMd,EAASS,EAEnBM,GAAWL,EAAK5jB,EAAI,EAAG3gC,EAAG2kD,GAC1BC,EAAWJ,EAAK7jB,EAAI,EAAGznC,EAAGyrD,GAC1BC,EAAWH,EAAK9jB,EAAI,EAAG1gC,EAAG0kD,IAM5B,QAASC,GAAW95C,EAAIgnC,EAAQzsC,EAAQw+C,GAEhCA,EAAU,GAAkB,IAAT/4C,EAAG9X,IAE5BgxD,EAAUlS,GAAWhnC,EAAG9X,EAAI,GAIT,IAAbqS,EAAOrS,GAA4B,IAAbqS,EAAO3R,IAEnCswD,EAAUlS,GAAW+R,EAAU,EAAIh+C,KAAKi+C,GAAK,IAQ/C,QAASD,GAASx+C,GAEjB,MAAOQ,MAAKg/C,MAAOx/C,EAAO3R,GAAK2R,EAAOrS,GAOvC,QAAS+wD,GAAa1+C,GAErB,MAAOQ,MAAKg/C,OAASx/C,EAAOpS,EAAG4S,KAAKmwC,KAAQ3wC,EAAOrS,EAAIqS,EAAOrS,EAAQqS,EAAO3R,EAAI2R,EAAO3R,IAlSzF0P,EAAe5L,KAAMtE,MAErBA,KAAKyB,KAAO,2BAEZzB,KAAK6Q,YACJnD,SAAUA,EACV6E,QAASA,EACTtN,OAAQA,EACR2qD,OAAQA,GAGT3qD,EAASA,GAAU,EACnB2qD,EAASA,GAAU,CAInB,IAAIa,MACAK,IAIJhB,GAAWF,GAIXY,EAAcvrD,GAIdyrD,IAIA1wD,KAAK8S,aAAc,WAAY,GAAItD,GAAwBihD,EAAc,IACzEzwD,KAAK8S,aAAc,SAAU,GAAItD,GAAwBihD,EAAa5D,QAAS,IAC/E7sD,KAAK8S,aAAc,KAAM,GAAItD,GAAwBshD,EAAU,IAE/C,IAAXlB,EAEJ5vD,KAAK4xD,uBAIL5xD,KAAK6xD,mBAuQP,QAASC,IAAqB7sD,EAAQ2qD,GAErCpiD,EAASlJ,KAAMtE,MAEfA,KAAKyB,KAAO,sBAEZzB,KAAK6Q,YACJ5L,OAAQA,EACR2qD,OAAQA,GAGT5vD,KAAK8Q,mBAAoB,GAAIihD,IAA2B9sD,EAAQ2qD,IAChE5vD,KAAKgR,gBASN,QAAS+gD,IAA2B9sD,EAAQ2qD,GAE3C,GAAIliD,IACH,EAAG,EAAG,QAAc,KAAS,KAAS,SAGnC6E,GACH,EAAG,EAAG,EAAI,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAGnCs9C,IAAyBvrD,KAAMtE,KAAM0N,EAAU6E,EAAStN,EAAQ2qD,GAEhE5vD,KAAKyB,KAAO,4BAEZzB,KAAK6Q,YACJ5L,OAAQA,EACR2qD,OAAQA,GAeV,QAASoC,IAAoB/sD,EAAQ2qD,GAEpCpiD,EAASlJ,KAAMtE,MAEfA,KAAKyB,KAAO,qBAEZzB,KAAK6Q,YACJ5L,OAAQA,EACR2qD,OAAQA,GAGT5vD,KAAK8Q,mBAAoB,GAAImhD,IAA0BhtD,EAAQ2qD,IAC/D5vD,KAAKgR,gBASN,QAASihD,IAA0BhtD,EAAQ2qD,GAE1C,GAAIliD,IACH,EAAG,EAAG,KAAS,EAAG,EAAG,EAAG,EAAG,EAC3B,KAAQ,EAAI,EAAG,EAAG,EAAG,EAAG,MAGrB6E,GACH,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EACxB,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EACxB,EAAG,EAAG,EAAG,EAAG,EAAG,EAGhBs9C,IAAyBvrD,KAAMtE,KAAM0N,EAAU6E,EAAStN,EAAQ2qD,GAEhE5vD,KAAKyB,KAAO,2BAEZzB,KAAK6Q,YACJ5L,OAAQA,EACR2qD,OAAQA,GAeV,QAASsC,IAAqBjtD,EAAQ2qD,GAErCpiD,EAASlJ,KAAMtE,MAEfA,KAAKyB,KAAO,sBAEZzB,KAAK6Q,YACJ5L,OAAQA,EACR2qD,OAAQA,GAGT5vD,KAAK8Q,mBAAoB,GAAIqhD,IAA2BltD,EAAQ2qD,IAChE5vD,KAAKgR,gBASN,QAASmhD,IAA2BltD,EAAQ2qD,GAE3C,GAAIwC,IAAM,EAAIz/C,KAAKmwC,KAAM,IAAQ,EAE7Bp1C,MACE0kD,EAAG,EAAI,EAAGA,EAAG,MAAWA,EAAG,EAAI,GAAKA,EAAG,EAC3C,KAAQA,EAAI,EAAG,EAAGA,EAAG,MAAUA,EAAI,EAAG,GAAKA,EAC3CA,EAAG,KAASA,EAAG,EAAG,GAAMA,EAAG,MAAWA,EAAG,EAAG,GAG1C7/C,GACF,EAAG,GAAI,EAAI,EAAG,EAAG,EAAI,EAAG,EAAG,EAAI,EAAG,EAAG,GAAK,EAAG,GAAI,GACjD,EAAG,EAAG,EAAI,EAAG,GAAI,EAAG,GAAI,GAAI,EAAG,GAAI,EAAG,EAAG,EAAG,EAAG,EAC/C,EAAG,EAAG,EAAI,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAC3C,EAAG,EAAG,EAAI,EAAG,EAAG,GAAI,EAAG,EAAG,GAAI,EAAG,EAAG,EAAG,EAAG,EAAG,EAG/Cs9C,IAAyBvrD,KAAMtE,KAAM0N,EAAU6E,EAAStN,EAAQ2qD,GAEhE5vD,KAAKyB,KAAO,4BAEZzB,KAAK6Q,YACJ5L,OAAQA,EACR2qD,OAAQA,GAeV,QAASyC,IAAsBptD,EAAQ2qD,GAEtCpiD,EAASlJ,KAAMtE,MAEfA,KAAKyB,KAAO,uBAEZzB,KAAK6Q,YACJ5L,OAAQA,EACR2qD,OAAQA,GAGT5vD,KAAK8Q,mBAAoB,GAAIwhD,IAA4BrtD,EAAQ2qD,IACjE5vD,KAAKgR,gBASN,QAASshD,IAA4BrtD,EAAQ2qD,GAE5C,GAAIwC,IAAM,EAAIz/C,KAAKmwC,KAAM,IAAQ,EAC7Bh9C,EAAI,EAAIssD,EAER1kD,kBAGsB,KACpB,QAAa,EAAG,EACrB,QAAa,KAAQ,EACrB,EAAG,KAAQ,EAAG,EAAG,EAGhB,GAAK5H,GAAKssD,EAAG,GAAKtsD,EAAGssD,EACrB,EAAGtsD,GAAKssD,EAAG,EAAGtsD,EAAGssD,GAGhBtsD,GAAKssD,EAAG,GAAKtsD,EAAGssD,EAAG,EACpBtsD,GAAKssD,EAAG,EAAGtsD,EAAGssD,EAAG,GAGhBA,EAAG,GAAKtsD,EAAGssD,EAAG,GAAKtsD,GACnBssD,EAAG,EAAGtsD,EAAGssD,EAAG,EAAGtsD,GAGdyM,GACH,EAAG,GAAI,EAAI,EAAG,EAAG,GAAK,EAAG,GAAI,GAC7B,EAAG,GAAI,GAAK,EAAG,GAAI,EAAI,EAAG,EAAG,GAC7B,GAAI,EAAG,EAAI,GAAI,EAAG,GAAK,GAAI,GAAI,EAC/B,EAAG,EAAG,GAAK,EAAG,GAAI,EAAI,EAAG,EAAG,GAC5B,EAAG,GAAI,EAAI,EAAG,EAAG,GAAK,EAAG,GAAI,GAC7B,EAAG,GAAI,EAAI,EAAG,EAAG,GAAK,EAAG,GAAI,GAC7B,EAAG,GAAI,GAAK,EAAG,GAAI,EAAI,EAAG,EAAG,GAC7B,GAAI,EAAG,EAAI,GAAI,EAAG,GAAK,GAAI,GAAI,EAC/B,EAAG,GAAI,GAAK,EAAG,GAAI,EAAI,EAAG,EAAG,EAC7B,GAAI,EAAG,EAAI,GAAI,EAAG,GAAK,GAAI,GAAI,EAC/B,GAAI,EAAG,GAAK,GAAI,GAAI,EAAI,GAAI,EAAG,GAC/B,EAAG,GAAI,GAAK,EAAG,GAAI,EAAI,EAAG,EAAG,EAG9Bs9C,IAAyBvrD,KAAMtE,KAAM0N,EAAU6E,EAAStN,EAAQ2qD,GAEhE5vD,KAAKyB,KAAO,6BAEZzB,KAAK6Q,YACJ5L,OAAQA,EACR2qD,OAAQA,GAoBV,QAAS2C,IAAcnqC,EAAMoqC,EAAiBvtD,EAAQwtD,EAAgBC,EAAQC,GAE7EnlD,EAASlJ,KAAMtE,MAEfA,KAAKyB,KAAO,eAEZzB,KAAK6Q,YACJuX,KAAMA,EACNoqC,gBAAiBA,EACjBvtD,OAAQA,EACRwtD,eAAgBA,EAChBC,OAAQA,GAGM5xD,SAAV6xD,GAAsBtyD,QAAQ4H,KAAM,8CAEzC,IAAI2qD,GAAiB,GAAIC,IAAoBzqC,EAAMoqC,EAAiBvtD,EAAQwtD,EAAgBC,EAI5F1yD,MAAK8yD,SAAWF,EAAeE,SAC/B9yD,KAAK2P,QAAUijD,EAAejjD,QAC9B3P,KAAK+yD,UAAYH,EAAeG,UAIhC/yD,KAAK8Q,mBAAoB8hD,GACzB5yD,KAAKgR,gBASN,QAAS6hD,IAAoBzqC,EAAMoqC,EAAiBvtD,EAAQwtD,EAAgBC,GAwD3E,QAASM,KAER,IAAMhjD,EAAI,EAAGA,EAAIwiD,EAAiBxiD,IAEjCijD,EAAiBjjD,EASlBijD,GAAmBP,KAAW,EAAUF,EAAkB,GAK1D9B,IAIAwC,IAID,QAASD,GAAiBjjD,GAIzBmjD,EAAI/qC,EAAKgrC,WAAYpjD,EAAIwiD,EAAiBW,EAI1C,IAAIE,GAAIC,EAAO3jD,QAASK,GACpBujD,EAAID,EAAOP,UAAW/iD,EAI1B,KAAMy9B,EAAI,EAAGA,GAAKglB,EAAgBhlB,IAAO,CAExC,GAAIt8B,GAAIs8B,EAAIglB,EAAiB9/C,KAAKi+C,GAAK,EAEnC4C,EAAM7gD,KAAK6gD,IAAKriD,GAChBynB,GAAQjmB,KAAKimB,IAAKznB,EAItBhM,GAAOrF,EAAM84B,EAAMy6B,EAAEvzD,EAAI0zD,EAAMD,EAAEzzD,EACjCqF,EAAOpF,EAAM64B,EAAMy6B,EAAEtzD,EAAIyzD,EAAMD,EAAExzD,EACjCoF,EAAO3E,EAAMo4B,EAAMy6B,EAAE7yD,EAAIgzD,EAAMD,EAAE/yD,EACjC2E,EAAOw0B,YAEPhqB,EAAQyC,KAAMjN,EAAOrF,EAAGqF,EAAOpF,EAAGoF,EAAO3E,GAIzCguD,EAAO1uD,EAAIqzD,EAAErzD,EAAImF,EAASE,EAAOrF,EACjC0uD,EAAOzuD,EAAIozD,EAAEpzD,EAAIkF,EAASE,EAAOpF,EACjCyuD,EAAOhuD,EAAI2yD,EAAE3yD,EAAIyE,EAASE,EAAO3E,EAEjCkN,EAAS0E,KAAMo8C,EAAO1uD,EAAG0uD,EAAOzuD,EAAGyuD,EAAOhuD,IAM5C,QAAS0yD,KAER,IAAMzlB,EAAI,EAAGA,GAAK+kB,EAAiB/kB,IAElC,IAAMz9B,EAAI,EAAGA,GAAKyiD,EAAgBziD,IAAO,CAExC,GAAIlD,IAAM2lD,EAAiB,IAAQhlB,EAAI,IAAQz9B,EAAI,GAC/ChK,GAAMysD,EAAiB,GAAMhlB,GAAMz9B,EAAI,GACvCjD,GAAM0lD,EAAiB,GAAMhlB,EAAIz9B,EACjCsC,GAAMmgD,EAAiB,IAAQhlB,EAAI,GAAMz9B,CAI7CuC,GAAQH,KAAMtF,EAAG9G,EAAGsM,GACpBC,EAAQH,KAAMpM,EAAG+G,EAAGuF,IAQvB,QAASo+C,KAER,IAAM1gD,EAAI,EAAGA,GAAKwiD,EAAiBxiD,IAElC,IAAMy9B,EAAI,EAAGA,GAAKglB,EAAgBhlB,IAEjC71B,EAAG9X,EAAIkQ,EAAIwiD,EACX56C,EAAG7X,EAAI0tC,EAAIglB,EAEX7iD,EAAIwC,KAAMwF,EAAG9X,EAAG8X,EAAG7X,GAxJtBmQ,EAAe5L,KAAMtE,MAErBA,KAAKyB,KAAO,qBAEZzB,KAAK6Q,YACJuX,KAAMA,EACNoqC,gBAAiBA,EACjBvtD,OAAQA,EACRwtD,eAAgBA,EAChBC,OAAQA,GAGTF,EAAkBA,GAAmB,GACrCvtD,EAASA,GAAU,EACnBwtD,EAAiBA,GAAkB,EACnCC,EAASA,IAAU,CAEnB,IAAIY,GAASlrC,EAAKqrC,oBAAqBjB,EAAiBE,EAIxD1yD,MAAK8yD,SAAWQ,EAAOR,SACvB9yD,KAAK2P,QAAU2jD,EAAO3jD,QACtB3P,KAAK+yD,UAAYO,EAAOP,SAIxB,IAKI/iD,GAAGy9B,EALH+gB,EAAS,GAAIztD,GACboE,EAAS,GAAIpE,GACb6W,EAAK,GAAI/X,GACTszD,EAAI,GAAIpyD,GAMR2M,KACAiC,KACAC,KACA2C,IAIJygD,KAIAhzD,KAAK6S,SAAUN,GACfvS,KAAK8S,aAAc,WAAY,GAAItD,GAAwB9B,EAAU,IACrE1N,KAAK8S,aAAc,SAAU,GAAItD,GAAwBG,EAAS,IAClE3P,KAAK8S,aAAc,KAAM,GAAItD,GAAwBI,EAAK,IA4H3D,QAAS8jD,IAAmBzuD,EAAQ0uD,EAAMnB,EAAiBC,EAAgBt9B,EAAGy+B,EAAGC,GAEhFrmD,EAASlJ,KAAMtE,MAEfA,KAAKyB,KAAO,oBAEZzB,KAAK6Q,YACJ5L,OAAQA,EACR0uD,KAAMA,EACNnB,gBAAiBA,EACjBC,eAAgBA,EAChBt9B,EAAGA,EACHy+B,EAAGA,GAGiB9yD,SAAhB+yD,GAA4BxzD,QAAQ4H,KAAM,4FAE/CjI,KAAK8Q,mBAAoB,GAAIgjD,IAAyB7uD,EAAQ0uD,EAAMnB,EAAiBC,EAAgBt9B,EAAGy+B,IACxG5zD,KAAKgR,gBASN,QAAS8iD,IAAyB7uD,EAAQ0uD,EAAMnB,EAAiBC,EAAgBt9B,EAAGy+B,GAqInF,QAASG,GAA0B7iD,EAAGikB,EAAGy+B,EAAG3uD,EAAQ6F,GAEnD,GAAIkpD,GAAKrhD,KAAKimB,IAAK1nB,GACf+iD,EAAKthD,KAAK6gD,IAAKtiD,GACfgjD,EAAUN,EAAIz+B,EAAIjkB,EAClBijD,EAAKxhD,KAAKimB,IAAKs7B,EAEnBppD,GAAShL,EAAImF,GAAW,EAAIkvD,GAAO,GAAMH,EACzClpD,EAAS/K,EAAIkF,GAAW,EAAIkvD,GAAOF,EAAK,GACxCnpD,EAAStK,EAAIyE,EAAS0N,KAAK6gD,IAAKU,GAAY,GA5I7ChkD,EAAe5L,KAAMtE,MAErBA,KAAKyB,KAAO,0BAEZzB,KAAK6Q,YACJ5L,OAAQA,EACR0uD,KAAMA,EACNnB,gBAAiBA,EACjBC,eAAgBA,EAChBt9B,EAAGA,EACHy+B,EAAGA,GAGJ3uD,EAASA,GAAU,EACnB0uD,EAAOA,GAAQ,GACfnB,EAAkB7/C,KAAKC,MAAO4/C,IAAqB,GACnDC,EAAiB9/C,KAAKC,MAAO6/C,IAAoB,EACjDt9B,EAAIA,GAAK,EACTy+B,EAAIA,GAAK,CAIT,IAOI5jD,GAAGy9B,EAPHl7B,KACA7E,KACAiC,KACAC,KAMA4+C,EAAS,GAAIztD,GACboE,EAAS,GAAIpE,GAEbqzD,EAAK,GAAIrzD,GACTszD,EAAK,GAAItzD,GAETwyD,EAAI,GAAIxyD,GACRuzD,EAAI,GAAIvzD,GACRsyD,EAAI,GAAItyD,EAIZ,KAAMiP,EAAI,EAAGA,GAAKwiD,IAAoBxiD,EAAI,CAIzC,GAAIkB,GAAIlB,EAAIwiD,EAAkBr9B,EAAIxiB,KAAKi+C,GAAK,CAoB5C,KAfAmD,EAA0B7iD,EAAGikB,EAAGy+B,EAAG3uD,EAAQmvD,GAC3CL,EAA0B7iD,EAAI,IAAMikB,EAAGy+B,EAAG3uD,EAAQovD,GAIlDC,EAAE7E,WAAY4E,EAAID,GAClBf,EAAEkB,WAAYF,EAAID,GAClBb,EAAE7D,aAAc4E,EAAGjB,GACnBA,EAAE3D,aAAc6D,EAAGe,GAInBf,EAAE55B,YACF05B,EAAE15B,YAEI8T,EAAI,EAAGA,GAAKglB,IAAmBhlB,EAAI,CAKxC,GAAIt8B,GAAIs8B,EAAIglB,EAAiB9/C,KAAKi+C,GAAK,EACnC4D,GAAOb,EAAOhhD,KAAKimB,IAAKznB,GACxBsjD,EAAKd,EAAOhhD,KAAK6gD,IAAKriD,EAK1Bq9C,GAAO1uD,EAAIs0D,EAAGt0D,GAAM00D,EAAKnB,EAAEvzD,EAAI20D,EAAKlB,EAAEzzD,GACtC0uD,EAAOzuD,EAAIq0D,EAAGr0D,GAAMy0D,EAAKnB,EAAEtzD,EAAI00D,EAAKlB,EAAExzD,GACtCyuD,EAAOhuD,EAAI4zD,EAAG5zD,GAAMg0D,EAAKnB,EAAE7yD,EAAIi0D,EAAKlB,EAAE/yD,GAEtCkN,EAAS0E,KAAMo8C,EAAO1uD,EAAG0uD,EAAOzuD,EAAGyuD,EAAOhuD,GAI1C2E,EAAOsqD,WAAYjB,EAAQ4F,GAAKz6B,YAEhChqB,EAAQyC,KAAMjN,EAAOrF,EAAGqF,EAAOpF,EAAGoF,EAAO3E,GAIzCoP,EAAIwC,KAAMpC,EAAIwiD,GACd5iD,EAAIwC,KAAMq7B,EAAIglB,IAQhB,IAAMhlB,EAAI,EAAGA,GAAK+kB,EAAiB/kB,IAElC,IAAMz9B,EAAI,EAAGA,GAAKyiD,EAAgBziD,IAAO,CAIxC,GAAIlD,IAAM2lD,EAAiB,IAAQhlB,EAAI,IAAQz9B,EAAI,GAC/ChK,GAAMysD,EAAiB,GAAMhlB,GAAMz9B,EAAI,GACvCjD,GAAM0lD,EAAiB,GAAMhlB,EAAIz9B,EACjCsC,GAAMmgD,EAAiB,IAAQhlB,EAAI,GAAMz9B,CAI7CuC,GAAQH,KAAMtF,EAAG9G,EAAGsM,GACpBC,EAAQH,KAAMpM,EAAG+G,EAAGuF,GAQtBtS,KAAK6S,SAAUN,GACfvS,KAAK8S,aAAc,WAAY,GAAItD,GAAwB9B,EAAU,IACrE1N,KAAK8S,aAAc,SAAU,GAAItD,GAAwBG,EAAS,IAClE3P,KAAK8S,aAAc,KAAM,GAAItD,GAAwBI,EAAK,IA8B3D,QAAS8kD,IAAezvD,EAAQ0uD,EAAMlB,EAAgBD,EAAiBmC,GAEtEnnD,EAASlJ,KAAMtE,MAEfA,KAAKyB,KAAO,gBAEZzB,KAAK6Q,YACJ5L,OAAQA,EACR0uD,KAAMA,EACNlB,eAAgBA,EAChBD,gBAAiBA,EACjBmC,IAAKA,GAGN30D,KAAK8Q,mBAAoB,GAAI8jD,IAAqB3vD,EAAQ0uD,EAAMlB,EAAgBD,EAAiBmC,IACjG30D,KAAKgR,gBASN,QAAS4jD,IAAqB3vD,EAAQ0uD,EAAMlB,EAAgBD,EAAiBmC,GAE5EzkD,EAAe5L,KAAMtE,MAErBA,KAAKyB,KAAO,sBAEZzB,KAAK6Q,YACJ5L,OAAQA,EACR0uD,KAAMA,EACNlB,eAAgBA,EAChBD,gBAAiBA,EACjBmC,IAAKA,GAGN1vD,EAASA,GAAU,EACnB0uD,EAAOA,GAAQ,GACflB,EAAiB9/C,KAAKC,MAAO6/C,IAAoB,EACjDD,EAAkB7/C,KAAKC,MAAO4/C,IAAqB,EACnDmC,EAAMA,GAAiB,EAAVhiD,KAAKi+C,EAIlB,IAWInjB,GAAGz9B,EAXHuC,KACA7E,KACAiC,KACAC,KAIA9M,EAAS,GAAI/B,GACbytD,EAAS,GAAIztD,GACboE,EAAS,GAAIpE,EAMjB,KAAM0sC,EAAI,EAAGA,GAAKglB,EAAgBhlB,IAEjC,IAAMz9B,EAAI,EAAGA,GAAKwiD,EAAiBxiD,IAAO,CAEzC,GAAIkB,GAAIlB,EAAIwiD,EAAkBmC,EAC1BxjD,EAAIs8B,EAAIglB,EAAiB9/C,KAAKi+C,GAAK,CAIvCpC,GAAO1uD,GAAMmF,EAAS0uD,EAAOhhD,KAAKimB,IAAKznB,IAAQwB,KAAKimB,IAAK1nB,GACzDs9C,EAAOzuD,GAAMkF,EAAS0uD,EAAOhhD,KAAKimB,IAAKznB,IAAQwB,KAAK6gD,IAAKtiD,GACzDs9C,EAAOhuD,EAAImzD,EAAOhhD,KAAK6gD,IAAKriD,GAE5BzD,EAAS0E,KAAMo8C,EAAO1uD,EAAG0uD,EAAOzuD,EAAGyuD,EAAOhuD,GAI1CsC,EAAOhD,EAAImF,EAAS0N,KAAKimB,IAAK1nB,GAC9BpO,EAAO/C,EAAIkF,EAAS0N,KAAK6gD,IAAKtiD,GAC9B/L,EAAOsqD,WAAYjB,EAAQ1rD,GAAS62B,YAEpChqB,EAAQyC,KAAMjN,EAAOrF,EAAGqF,EAAOpF,EAAGoF,EAAO3E,GAIzCoP,EAAIwC,KAAMpC,EAAIwiD,GACd5iD,EAAIwC,KAAMq7B,EAAIglB,GAQhB,IAAMhlB,EAAI,EAAGA,GAAKglB,EAAgBhlB,IAEjC,IAAMz9B,EAAI,EAAGA,GAAKwiD,EAAiBxiD,IAAO,CAIzC,GAAIlD,IAAM0lD,EAAkB,GAAM/kB,EAAIz9B,EAAI,EACtChK,GAAMwsD,EAAkB,IAAQ/kB,EAAI,GAAMz9B,EAAI,EAC9CjD,GAAMylD,EAAkB,IAAQ/kB,EAAI,GAAMz9B,EAC1CsC,GAAMkgD,EAAkB,GAAM/kB,EAAIz9B,CAItCuC,GAAQH,KAAMtF,EAAG9G,EAAGsM,GACpBC,EAAQH,KAAMpM,EAAG+G,EAAGuF,GAQtBtS,KAAK6S,SAAUN,GACfvS,KAAK8S,aAAc,WAAY,GAAItD,GAAwB9B,EAAU,IACrE1N,KAAK8S,aAAc,SAAU,GAAItD,GAAwBG,EAAS,IAClE3P,KAAK8S,aAAc,KAAM,GAAItD,GAAwBI,EAAK,IAgE3D,QAASilD,IAAYnwD,EAAMiC,EAAOomB,EAAK+nC,EAAKC,GAE3C,GAAI/kD,GAAGglD,CAEP,IAAKD,IAAgBE,GAAYvwD,EAAMiC,EAAOomB,EAAK+nC,GAAQ,EAE1D,IAAM9kD,EAAIrJ,EAAOqJ,EAAI+c,EAAK/c,GAAK8kD,EAAME,EAAOE,GAAYllD,EAAGtL,EAAMsL,GAAKtL,EAAMsL,EAAI,GAAKglD,OAIrF,KAAMhlD,EAAI+c,EAAM+nC,EAAK9kD,GAAKrJ,EAAOqJ,GAAK8kD,EAAME,EAAOE,GAAYllD,EAAGtL,EAAMsL,GAAKtL,EAAMsL,EAAI,GAAKglD,EAW7F,OAPKA,IAAQ90B,GAAQ80B,EAAMA,EAAKnsC,QAE/BssC,GAAYH,GACZA,EAAOA,EAAKnsC,MAINmsC,EAMR,QAASI,IAAczuD,EAAOomB,GAE7B,IAAOpmB,EAAQ,MAAOA,EACfomB,KAAMA,EAAMpmB,EAEnB,IAAe0uD,GAAXlgC,EAAIxuB,CAER,GAIC,IAFA0uD,GAAQ,EAEDlgC,EAAEmgC,UAAap1B,GAAQ/K,EAAGA,EAAEtM,OAAwC,IAA9B0sC,GAAMpgC,EAAEqgC,KAAMrgC,EAAGA,EAAEtM,MAS/DsM,EAAIA,EAAEtM,SAT0E,CAIhF,GAFAssC,GAAYhgC,GACZA,EAAIpI,EAAMoI,EAAEqgC,KACPrgC,IAAMA,EAAEtM,KAAO,KACpBwsC,IAAQ,QAQAA,GAASlgC,IAAMpI,EAEzB,OAAOA,GAMR,QAAS0oC,IAAcC,EAAKj0C,EAAWqzC,EAAKa,EAAMC,EAAMC,EAASC,GAEhE,GAAOJ,EAAP,EAIOI,GAAQD,GAAUE,GAAYL,EAAKC,EAAMC,EAAMC,EAMtD,KAJA,GAAgBL,GAAM3sC,EAAlBjiB,EAAO8uD,EAIHA,EAAIF,OAASE,EAAI7sC,MAKxB,GAHA2sC,EAAOE,EAAIF,KACX3sC,EAAO6sC,EAAI7sC,KAENgtC,EAAUG,GAAaN,EAAKC,EAAMC,EAAMC,GAAYI,GAAOP,GAG/Dj0C,EAAUrP,KAAMojD,EAAKxlD,EAAI8kD,GACzBrzC,EAAUrP,KAAMsjD,EAAI1lD,EAAI8kD,GACxBrzC,EAAUrP,KAAMyW,EAAK7Y,EAAI8kD,GAEzBK,GAAYO,GAGZA,EAAM7sC,EAAKA,KACXjiB,EAAOiiB,EAAKA,SAUb,IAJA6sC,EAAM7sC,EAID6sC,IAAQ9uD,EAAO,CAIZkvD,EAMc,IAATA,GAEXJ,EAAMQ,GAAwBR,EAAKj0C,EAAWqzC,GAC9CW,GAAcC,EAAKj0C,EAAWqzC,EAAKa,EAAMC,EAAMC,EAAS,IAIpC,IAATC,GAEXK,GAAaT,EAAKj0C,EAAWqzC,EAAKa,EAAMC,EAAMC,GAb9CJ,GAAcL,GAAcM,GAAOj0C,EAAWqzC,EAAKa,EAAMC,EAAMC,EAAS,EAiBzE,SAUH,QAASI,IAAOP,GAEf,GAAI5oD,GAAI4oD,EAAIF,KACXxvD,EAAI0vD,EACJ3oD,EAAI2oD,EAAI7sC,IAET,IAAK0sC,GAAMzoD,EAAG9G,EAAG+G,IAAO,EAAI,OAAO,CAKnC,KAFA,GAAIooB,GAAIugC,EAAI7sC,KAAKA,KAETsM,IAAMugC,EAAIF,MAAO,CAExB,GAAKY,GAAiBtpD,EAAEhN,EAAGgN,EAAE/M,EAAGiG,EAAElG,EAAGkG,EAAEjG,EAAGgN,EAAEjN,EAAGiN,EAAEhN,EAAGo1B,EAAEr1B,EAAGq1B,EAAEp1B,IAAOw1D,GAAMpgC,EAAEqgC,KAAMrgC,EAAGA,EAAEtM,OAAU,EAE9F,OAAO,CAIRsM,GAAIA,EAAEtM,KAIP,OAAO,EAIR,QAASmtC,IAAaN,EAAKC,EAAMC,EAAMC,GAEtC,GAAI/oD,GAAI4oD,EAAIF,KACXxvD,EAAI0vD,EACJ3oD,EAAI2oD,EAAI7sC,IAET,IAAK0sC,GAAMzoD,EAAG9G,EAAG+G,IAAO,EAAI,OAAO,CAkBnC,KAdA,GAAIspD,GAAQvpD,EAAEhN,EAAIkG,EAAElG,EAAMgN,EAAEhN,EAAIiN,EAAEjN,EAAIgN,EAAEhN,EAAIiN,EAAEjN,EAAQkG,EAAElG,EAAIiN,EAAEjN,EAAIkG,EAAElG,EAAIiN,EAAEjN,EACzEw2D,EAAQxpD,EAAE/M,EAAIiG,EAAEjG,EAAM+M,EAAE/M,EAAIgN,EAAEhN,EAAI+M,EAAE/M,EAAIgN,EAAEhN,EAAQiG,EAAEjG,EAAIgN,EAAEhN,EAAIiG,EAAEjG,EAAIgN,EAAEhN,EACtEw2D,EAAQzpD,EAAEhN,EAAIkG,EAAElG,EAAMgN,EAAEhN,EAAIiN,EAAEjN,EAAIgN,EAAEhN,EAAIiN,EAAEjN,EAAQkG,EAAElG,EAAIiN,EAAEjN,EAAIkG,EAAElG,EAAIiN,EAAEjN,EACtE02D,EAAQ1pD,EAAE/M,EAAIiG,EAAEjG,EAAM+M,EAAE/M,EAAIgN,EAAEhN,EAAI+M,EAAE/M,EAAIgN,EAAEhN,EAAQiG,EAAEjG,EAAIgN,EAAEhN,EAAIiG,EAAEjG,EAAIgN,EAAEhN,EAInE02D,EAAOC,GAAQL,EAAOC,EAAOX,EAAMC,EAAMC,GAC5Cc,EAAOD,GAAQH,EAAOC,EAAOb,EAAMC,EAAMC,GAItC1gC,EAAIugC,EAAIkB,MAEJzhC,GAAKA,EAAE30B,GAAKm2D,GAAO,CAE1B,GAAKxhC,IAAMugC,EAAIF,MAAQrgC,IAAMugC,EAAI7sC,MAC/ButC,GAAiBtpD,EAAEhN,EAAGgN,EAAE/M,EAAGiG,EAAElG,EAAGkG,EAAEjG,EAAGgN,EAAEjN,EAAGiN,EAAEhN,EAAGo1B,EAAEr1B,EAAGq1B,EAAEp1B,IACtDw1D,GAAMpgC,EAAEqgC,KAAMrgC,EAAGA,EAAEtM,OAAU,EAAI,OAAO,CAC1CsM,GAAIA,EAAEyhC,MAQP,IAFAzhC,EAAIugC,EAAImB,MAEA1hC,GAAKA,EAAE30B,GAAKi2D,GAAO,CAE1B,GAAKthC,IAAMugC,EAAIF,MAAQrgC,IAAMugC,EAAI7sC,MAC/ButC,GAAiBtpD,EAAEhN,EAAGgN,EAAE/M,EAAGiG,EAAElG,EAAGkG,EAAEjG,EAAGgN,EAAEjN,EAAGiN,EAAEhN,EAAGo1B,EAAEr1B,EAAGq1B,EAAEp1B,IACtDw1D,GAAMpgC,EAAEqgC,KAAMrgC,EAAGA,EAAEtM,OAAU,EAAI,OAAO,CAE1CsM,GAAIA,EAAE0hC,MAIP,OAAO,EAMR,QAASX,IAAwBvvD,EAAO8a,EAAWqzC,GAElD,GAAI3/B,GAAIxuB,CAER,GAAG,CAEF,GAAImG,GAAIqoB,EAAEqgC,KAAMxvD,EAAImvB,EAAEtM,KAAKA,MAEpBqX,GAAQpzB,EAAG9G,IAAO8wD,GAAYhqD,EAAGqoB,EAAGA,EAAEtM,KAAM7iB,IAAO+wD,GAAejqD,EAAG9G,IAAO+wD,GAAe/wD,EAAG8G,KAEpG2U,EAAUrP,KAAMtF,EAAEkD,EAAI8kD,GACtBrzC,EAAUrP,KAAM+iB,EAAEnlB,EAAI8kD,GACtBrzC,EAAUrP,KAAMpM,EAAEgK,EAAI8kD,GAItBK,GAAYhgC,GACZggC,GAAYhgC,EAAEtM,MAEdsM,EAAIxuB,EAAQX,GAIbmvB,EAAIA,EAAEtM,WAEGsM,IAAMxuB,EAEhB,OAAOwuB,GAMR,QAASghC,IAAaxvD,EAAO8a,EAAWqzC,EAAKa,EAAMC,EAAMC,GAIxD,GAAI/oD,GAAInG,CAER,GAAG,CAIF,IAFA,GAAIX,GAAI8G,EAAE+b,KAAKA,KAEP7iB,IAAM8G,EAAE0oD,MAAO,CAEtB,GAAK1oD,EAAEkD,IAAMhK,EAAEgK,GAAKgnD,GAAiBlqD,EAAG9G,GAAM,CAI7C,GAAI+G,GAAIkqD,GAAcnqD,EAAG9G,EAWzB,OAPA8G,GAAIsoD,GAActoD,EAAGA,EAAE+b,MACvB9b,EAAIqoD,GAAcroD,EAAGA,EAAE8b,MAIvB4sC,GAAc3oD,EAAG2U,EAAWqzC,EAAKa,EAAMC,EAAMC,OAC7CJ,IAAc1oD,EAAG0U,EAAWqzC,EAAKa,EAAMC,EAAMC,GAK9C7vD,EAAIA,EAAE6iB,KAIP/b,EAAIA,EAAE+b,WAEG/b,IAAMnG,GAMjB,QAASuwD,IAAgBxyD,EAAMyyD,EAAaC,EAAWtC,GAEtD,GAAgB9kD,GAAGqnD,EAAK1wD,EAAOomB,EAAKuJ,EAAhCghC,IAEJ,KAAMtnD,EAAI,EAAGqnD,EAAMF,EAAY/2D,OAAQ4P,EAAIqnD,EAAKrnD,IAE/CrJ,EAAQwwD,EAAannD,GAAM8kD,EAC3B/nC,EAAM/c,EAAIqnD,EAAM,EAAIF,EAAannD,EAAI,GAAM8kD,EAAMpwD,EAAKtE,OACtDk2B,EAAOu+B,GAAYnwD,EAAMiC,EAAOomB,EAAK+nC,GAAK,GACrCx+B,IAASA,EAAKzN,OAAOyN,EAAKg/B,SAAU,GACzCgC,EAAMllD,KAAMmlD,GAAajhC,GAQ1B,KAJAghC,EAAMv0C,KAAMy0C,IAINxnD,EAAI,EAAGA,EAAIsnD,EAAMl3D,OAAQ4P,IAE9BynD,GAAeH,EAAOtnD,GAAKonD,GAC3BA,EAAYhC,GAAcgC,EAAWA,EAAUvuC,KAIhD,OAAOuuC,GAIR,QAASI,IAAU1qD,EAAG9G,GAErB,MAAO8G,GAAEhN,EAAIkG,EAAElG,EAMhB,QAAS23D,IAAeC,EAAMN,GAI7B,GAFAA,EAAYO,GAAgBD,EAAMN,GAEjB,CAEhB,GAAIpxD,GAAIixD,GAAcG,EAAWM,EAEjCtC,IAAcpvD,EAAGA,EAAE6iB,OAQrB,QAAS8uC,IAAgBD,EAAMN,GAE9B,GAICQ,GAJGziC,EAAIiiC,EACPS,EAAKH,EAAK53D,EACVg4D,EAAKJ,EAAK33D,EACVg4D,IAAOhzD,EAAAA,EAMR,GAAG,CAEF,GAAK+yD,GAAM3iC,EAAEp1B,GAAK+3D,GAAM3iC,EAAEtM,KAAK9oB,GAAKo1B,EAAEtM,KAAK9oB,IAAMo1B,EAAEp1B,EAAI,CAEtD,GAAID,GAAIq1B,EAAEr1B,GAAMg4D,EAAK3iC,EAAEp1B,IAAQo1B,EAAEtM,KAAK/oB,EAAIq1B,EAAEr1B,IAAQq1B,EAAEtM,KAAK9oB,EAAIo1B,EAAEp1B,EAEjE,IAAKD,GAAK+3D,GAAM/3D,EAAIi4D,EAAK,CAIxB,GAFAA,EAAKj4D,EAEAA,IAAM+3D,EAAK,CAEf,GAAKC,IAAO3iC,EAAEp1B,EAAI,MAAOo1B,EACzB,IAAK2iC,IAAO3iC,EAAEtM,KAAK9oB,EAAI,MAAOo1B,GAAEtM,KAIjC+uC,EAAIziC,EAAEr1B,EAAIq1B,EAAEtM,KAAK/oB,EAAIq1B,EAAIA,EAAEtM,MAM7BsM,EAAIA,EAAEtM,WAEGsM,IAAMiiC,EAEhB,KAAOQ,EAAI,MAAO,KAElB,IAAKC,IAAOE,EAAK,MAAOH,GAAEpC,IAM1B,IAICwC,GAJGpxD,EAAOgxD,EACVK,EAAKL,EAAE93D,EACPo4D,EAAKN,EAAE73D,EACPo4D,EAASpzD,EAAAA,CAKV,KAFAowB,EAAIyiC,EAAE/uC,KAEEsM,IAAMvuB,GAERixD,GAAM1iC,EAAEr1B,GAAKq1B,EAAEr1B,GAAKm4D,GAAMJ,IAAO1iC,EAAEr1B,GACpCs2D,GAAiB0B,EAAKI,EAAKL,EAAKE,EAAID,EAAIG,EAAIC,EAAIJ,EAAKI,EAAKH,EAAKF,EAAIC,EAAI3iC,EAAEr1B,EAAGq1B,EAAEp1B,KAEjFi4D,EAAMrlD,KAAK4P,IAAKu1C,EAAK3iC,EAAEp1B,IAAQ83D,EAAK1iC,EAAEr1B,IAE/Bk4D,EAAMG,GAAYH,IAAQG,GAAUhjC,EAAEr1B,EAAI83D,EAAE93D,IAASi3D,GAAe5hC,EAAGuiC,KAE7EE,EAAIziC,EACJgjC,EAASH,IAMX7iC,EAAIA,EAAEtM,IAIP,OAAO+uC,GAMR,QAAS7B,IAAYpvD,EAAOgvD,EAAMC,EAAMC,GAEvC,GAAI1gC,GAAIxuB,CAER,GAEc,QAARwuB,EAAE30B,IAAa20B,EAAE30B,EAAIk2D,GAAQvhC,EAAEr1B,EAAGq1B,EAAEp1B,EAAG41D,EAAMC,EAAMC,IACxD1gC,EAAE0hC,MAAQ1hC,EAAEqgC,KACZrgC,EAAEyhC,MAAQzhC,EAAEtM,KACZsM,EAAIA,EAAEtM,WAEGsM,IAAMxuB,EAEhBwuB,GAAE0hC,MAAMD,MAAQ,KAChBzhC,EAAE0hC,MAAQ,KAEVuB,GAAYjjC,GAOb,QAASijC,IAAY9hC,GAEpB,GAAItmB,GAAGmlB,EAAGy+B,EAAGvF,EAAGgK,EAAMC,EAAWC,EAAOC,EAAOC,EAAS,CAExD,GAAG,CAOF,IALAtjC,EAAImB,EACJA,EAAO,KACP+hC,EAAO,KACPC,EAAY,EAEJnjC,GAAI,CAMX,IAJAmjC,IACA1E,EAAIz+B,EACJojC,EAAQ,EAEFvoD,EAAI,EAAGA,EAAIyoD,IAEhBF,IACA3E,EAAIA,EAAEgD,MACChD,GAJiB5jD,KAUzB,IAFAwoD,EAAQC,EAEAF,EAAQ,GAAOC,EAAQ,GAAK5E,GAEpB,IAAV2E,IAA2B,IAAVC,IAAiB5E,GAAKz+B,EAAE30B,GAAKozD,EAAEpzD,IAEpD6tD,EAAIl5B,EACJA,EAAIA,EAAEyhC,MACN2B,MAIAlK,EAAIuF,EACJA,EAAIA,EAAEgD,MACN4B,KAIIH,EAAOA,EAAKzB,MAAQvI,EACpB/3B,EAAO+3B,EAEZA,EAAEwI,MAAQwB,EACVA,EAAOhK,CAIRl5B,GAAIy+B,EAILyE,EAAKzB,MAAQ,KACb6B,GAAU,QAEDH,EAAY,EAEtB,OAAOhiC,GAMR,QAASogC,IAAQ52D,EAAGC,EAAG41D,EAAMC,EAAMC,GAiBlC,MAbA/1D,GAAI,OAAUA,EAAI61D,GAASE,EAC3B91D,EAAI,OAAUA,EAAI61D,GAASC,EAE3B/1D,EAAyB,UAAnBA,EAAMA,GAAK,GACjBA,EAAyB,WAAnBA,EAAMA,GAAK,GACjBA,EAAyB,WAAnBA,EAAMA,GAAK,GACjBA,EAAyB,YAAnBA,EAAMA,GAAK,GAEjBC,EAAyB,UAAnBA,EAAMA,GAAK,GACjBA,EAAyB,WAAnBA,EAAMA,GAAK,GACjBA,EAAyB,WAAnBA,EAAMA,GAAK,GACjBA,EAAyB,YAAnBA,EAAMA,GAAK,GAEVD,EAAMC,GAAK,EAMnB,QAASw3D,IAAa5wD,GAErB,GAAIwuB,GAAIxuB,EAAO+xD,EAAW/xD,CAE1B,GAEMwuB,GAAEr1B,EAAI44D,EAAS54D,IAAI44D,EAAWvjC,GACnCA,EAAIA,EAAEtM,WAEGsM,IAAMxuB,EAEhB,OAAO+xD,GAMR,QAAStC,IAAiBuC,EAAIC,EAAIC,EAAIC,EAAItE,EAAIC,EAAIsE,EAAIC,GAErD,OAASxE,EAAKuE,IAASH,EAAKI,IAASL,EAAKI,IAAStE,EAAKuE,IAAQ,IAC7DL,EAAKI,IAASD,EAAKE,IAASH,EAAKE,IAASH,EAAKI,IAAQ,IACvDH,EAAKE,IAAStE,EAAKuE,IAASxE,EAAKuE,IAASD,EAAKE,IAAQ,EAM3D,QAAShC,IAAiBlqD,EAAG9G,GAE5B,MAAO8G,GAAE+b,KAAK7Y,IAAMhK,EAAEgK,GAAKlD,EAAE0oD,KAAKxlD,IAAMhK,EAAEgK,IAAOipD,GAAmBnsD,EAAG9G,IACtE+wD,GAAejqD,EAAG9G,IAAO+wD,GAAe/wD,EAAG8G,IAAOosD,GAAcpsD,EAAG9G,GAMrE,QAASuvD,IAAMpgC,EAAGy+B,EAAG9tD,GAEpB,OAAS8tD,EAAE7zD,EAAIo1B,EAAEp1B,IAAQ+F,EAAEhG,EAAI8zD,EAAE9zD,IAAQ8zD,EAAE9zD,EAAIq1B,EAAEr1B,IAAQgG,EAAE/F,EAAI6zD,EAAE7zD,GAMlE,QAASmgC,IAAQ36B,EAAIC,GAEpB,MAAOD,GAAGzF,IAAM0F,EAAG1F,GAAKyF,EAAGxF,IAAMyF,EAAGzF,EAMrC,QAAS+2D,IAAYvxD,EAAI4zD,EAAI3zD,EAAI4zD,GAEhC,SAAOl5B,GAAQ36B,EAAI4zD,IAAQj5B,GAAQ16B,EAAI4zD,IACnCl5B,GAAQ36B,EAAI6zD,IAAQl5B,GAAQ16B,EAAI2zD,KAE7B5D,GAAMhwD,EAAI4zD,EAAI3zD,GAAO,GAAM+vD,GAAMhwD,EAAI4zD,EAAIC,GAAO,GACnD7D,GAAM/vD,EAAI4zD,EAAI7zD,GAAO,GAAMgwD,GAAM/vD,EAAI4zD,EAAID,GAAO,EAMrD,QAASF,IAAmBnsD,EAAG9G,GAE9B,GAAImvB,GAAIroB,CAER,GAAG,CAEF,GAAKqoB,EAAEnlB,IAAMlD,EAAEkD,GAAKmlB,EAAEtM,KAAK7Y,IAAMlD,EAAEkD,GAAKmlB,EAAEnlB,IAAMhK,EAAEgK,GAAKmlB,EAAEtM,KAAK7Y,IAAMhK,EAAEgK,GAClE8mD,GAAY3hC,EAAGA,EAAEtM,KAAM/b,EAAG9G,GAE7B,OAAO,CAIRmvB,GAAIA,EAAEtM,WAEGsM,IAAMroB,EAEhB,QAAO,EAMR,QAASiqD,IAAejqD,EAAG9G,GAE1B,MAAOuvD,IAAMzoD,EAAE0oD,KAAM1oD,EAAGA,EAAE+b,MAAS,EAClC0sC,GAAMzoD,EAAG9G,EAAG8G,EAAE+b,OAAU,GAAK0sC,GAAMzoD,EAAGA,EAAE0oD,KAAMxvD,IAAO,EACrDuvD,GAAMzoD,EAAG9G,EAAG8G,EAAE0oD,MAAS,GAAKD,GAAMzoD,EAAGA,EAAE+b,KAAM7iB,GAAM,EAMrD,QAASkzD,IAAcpsD,EAAG9G,GAEzB,GAAImvB,GAAIroB,EACPusD,GAAS,EACTN,GAAOjsD,EAAEhN,EAAIkG,EAAElG,GAAM,EACrBk5D,GAAOlsD,EAAE/M,EAAIiG,EAAEjG,GAAM,CAEtB,GAEUo1B,GAAEp1B,EAAIi5D,GAAW7jC,EAAEtM,KAAK9oB,EAAIi5D,GAAU7jC,EAAEtM,KAAK9oB,IAAMo1B,EAAEp1B,GACxDg5D,GAAO5jC,EAAEtM,KAAK/oB,EAAIq1B,EAAEr1B,IAAQk5D,EAAK7jC,EAAEp1B,IAAQo1B,EAAEtM,KAAK9oB,EAAIo1B,EAAEp1B,GAAMo1B,EAAEr1B,IAErEu5D,GAAWA,GAIZlkC,EAAIA,EAAEtM,WAEGsM,IAAMroB,EAEhB,OAAOusD,GAOR,QAASpC,IAAcnqD,EAAG9G,GAEzB,GAAIszD,GAAK,GAAIC,IAAMzsD,EAAEkD,EAAGlD,EAAEhN,EAAGgN,EAAE/M,GAC9By5D,EAAK,GAAID,IAAMvzD,EAAEgK,EAAGhK,EAAElG,EAAGkG,EAAEjG,GAC3B05D,EAAK3sD,EAAE+b,KACP6wC,EAAK1zD,EAAEwvD,IAcR,OAZA1oD,GAAE+b,KAAO7iB,EACTA,EAAEwvD,KAAO1oD,EAETwsD,EAAGzwC,KAAO4wC,EACVA,EAAGjE,KAAO8D,EAEVE,EAAG3wC,KAAOywC,EACVA,EAAG9D,KAAOgE,EAEVE,EAAG7wC,KAAO2wC,EACVA,EAAGhE,KAAOkE,EAEHF,EAMR,QAAStE,IAAYllD,EAAGlQ,EAAGC,EAAGi1D,GAE7B,GAAI7/B,GAAI,GAAIokC,IAAMvpD,EAAGlQ,EAAGC,EAgBxB,OAdOi1D,IAON7/B,EAAEtM,KAAOmsC,EAAKnsC,KACdsM,EAAEqgC,KAAOR,EACTA,EAAKnsC,KAAK2sC,KAAOrgC,EACjB6/B,EAAKnsC,KAAOsM,IARZA,EAAEqgC,KAAOrgC,EACTA,EAAEtM,KAAOsM,GAWHA,EAIR,QAASggC,IAAYhgC,GAEpBA,EAAEtM,KAAK2sC,KAAOrgC,EAAEqgC,KAChBrgC,EAAEqgC,KAAK3sC,KAAOsM,EAAEtM,KAEXsM,EAAE0hC,QAAQ1hC,EAAE0hC,MAAMD,MAAQzhC,EAAEyhC,OAC5BzhC,EAAEyhC,QAAQzhC,EAAEyhC,MAAMC,MAAQ1hC,EAAE0hC,OAIlC,QAAS0C,IAAMvpD,EAAGlQ,EAAGC,GAGpBC,KAAKgQ,EAAIA,EAGThQ,KAAKF,EAAIA,EACTE,KAAKD,EAAIA,EAGTC,KAAKw1D,KAAO,KACZx1D,KAAK6oB,KAAO,KAGZ7oB,KAAKQ,EAAI,KAGTR,KAAK62D,MAAQ,KACb72D,KAAK42D,MAAQ,KAGb52D,KAAKs1D,SAAU,EAIhB,QAASL,IAAYvwD,EAAMiC,EAAOomB,EAAK+nC,GAItC,IAAM,GAFF6E,GAAM,EAEA3pD,EAAIrJ,EAAO8mC,EAAI1gB,EAAM+nC,EAAK9kD,EAAI+c,EAAK/c,GAAK8kD,EAEjD6E,IAASj1D,EAAM+oC,GAAM/oC,EAAMsL,KAAUtL,EAAMsL,EAAI,GAAMtL,EAAM+oC,EAAI,IAC/DA,EAAIz9B,CAIL,OAAO2pD,GA0ER,QAASC,IAAiB33C,GAEzB,GAAIhS,GAAIgS,EAAO7hB,MAEV6P,GAAI,GAAKgS,EAAQhS,EAAI,GAAIiwB,OAAQje,EAAQ,KAE7CA,EAAOuT,MAMT,QAASqkC,IAAYnsD,EAAUosD,GAE9B,IAAM,GAAI9pD,GAAI,EAAGA,EAAI8pD,EAAQ15D,OAAQ4P,IAEpCtC,EAAS0E,KAAM0nD,EAAS9pD,GAAIlQ,GAC5B4N,EAAS0E,KAAM0nD,EAAS9pD,GAAIjQ,GA+B9B,QAASg6D,IAAiBC,EAAQn2D,GAEjC2J,EAASlJ,KAAMtE,MAEfA,KAAKyB,KAAO,kBAEZzB,KAAK6Q,YACJmpD,OAAQA,EACRn2D,QAASA,GAGV7D,KAAK8Q,mBAAoB,GAAImpD,IAAuBD,EAAQn2D,IAC5D7D,KAAKgR,gBAoBN,QAASipD,IAAuBD,EAAQn2D,GAkCvC,QAASq2D,GAAUC,GA+GlB,QAASC,GAAUC,EAAIC,EAAKrzC,GAI3B,MAFOqzC,IAAMj6D,QAAQC,MAAO,6CAErBg6D,EAAIzvD,QAAQqtB,eAAgBjR,GAAOoY,IAAKg7B,GAYhD,QAASE,GAAaC,EAAMC,EAAQC,GASnC,GAAIC,GAAWC,EAAWC,EAKtBC,EAAWN,EAAK16D,EAAI26D,EAAO36D,EAC9Bi7D,EAAWP,EAAKz6D,EAAI06D,EAAO16D,EACxBi7D,EAAWN,EAAO56D,EAAI06D,EAAK16D,EAC9Bm7D,EAAWP,EAAO36D,EAAIy6D,EAAKz6D,EAExBm7D,EAAiBJ,EAAWA,EAAWC,EAAWA,EAGlDI,EAAeL,EAAWG,EAAWF,EAAWC,CAEpD,IAAKroD,KAAK4P,IAAK44C,GAAeC,OAAOC,QAAU,CAM9C,GAAIC,GAAa3oD,KAAKmwC,KAAMoY,GACxBK,EAAa5oD,KAAKmwC,KAAMkY,EAAWA,EAAWC,EAAWA,GAIzDO,EAAkBf,EAAO36D,EAAIi7D,EAAWO,EACxCG,EAAkBhB,EAAO16D,EAAI+6D,EAAWQ,EAExCI,EAAkBhB,EAAO56D,EAAIm7D,EAAWM,EACxCI,EAAkBjB,EAAO36D,EAAIi7D,EAAWO,EAIxCK,IAASF,EAAgBF,GAAkBP,GAC3CU,EAAgBF,GAAkBT,IACnCF,EAAWG,EAAWF,EAAWC,EAIpCL,GAAca,EAAgBV,EAAWc,EAAKpB,EAAK16D,EACnD86D,EAAca,EAAgBV,EAAWa,EAAKpB,EAAKz6D,CAInD,IAAI87D,GAAkBlB,EAAYA,EAAYC,EAAYA,CAC1D,IAAKiB,GAAiB,EAErB,MAAO,IAAIh8D,GAAS86D,EAAWC,EAI/BC,GAAYloD,KAAKmwC,KAAM+Y,EAAgB,OAIlC,CAIN,GAAIC,IAAe,CACdhB,GAAWM,OAAOC,QAEjBL,EAAWI,OAAOC,UAEtBS,GAAe,GAMXhB,GAAaM,OAAOC,QAEnBL,GAAaI,OAAOC,UAExBS,GAAe,GAMXnpD,KAAKopD,KAAMhB,KAAepoD,KAAKopD,KAAMd,KAEzCa,GAAe,GAQbA,GAGJnB,GAAcI,EACdH,EAAYE,EACZD,EAAYloD,KAAKmwC,KAAMoY,KAKvBP,EAAYG,EACZF,EAAYG,EACZF,EAAYloD,KAAKmwC,KAAMoY,EAAe,IAMxC,MAAO,IAAIr7D,GAAS86D,EAAYE,EAAWD,EAAYC,GAyMxD,QAASmB,KAER,GAAIr1D,GAAQs1D,EAAc77D,OAAS,CAEnC,IAAK87D,EAAe,CAEnB,GAAIvhB,GAAQ,EACR/3C,EAASu5D,EAAOxhB,CAIpB,KAAM3qC,EAAI,EAAGA,EAAIosD,EAAMpsD,IAEtBovB,EAAOxxB,EAAOoC,GACdqsD,EAAIj9B,EAAM,GAAMx8B,EAAQw8B,EAAM,GAAMx8B,EAAQw8B,EAAM,GAAMx8B,EASzD,KALA+3C,EAAQ2hB,EAAwB,EAAhBC,EAChB35D,EAASu5D,EAAOxhB,EAIV3qC,EAAI,EAAGA,EAAIosD,EAAMpsD,IAEtBovB,EAAOxxB,EAAOoC,GACdqsD,EAAIj9B,EAAM,GAAMx8B,EAAQw8B,EAAM,GAAMx8B,EAAQw8B,EAAM,GAAMx8B,OAInD,CAIN,IAAMoN,EAAI,EAAGA,EAAIosD,EAAMpsD,IAEtBovB,EAAOxxB,EAAOoC,GACdqsD,EAAIj9B,EAAM,GAAKA,EAAM,GAAKA,EAAM,GAMjC,KAAMpvB,EAAI,EAAGA,EAAIosD,EAAMpsD,IAEtBovB,EAAOxxB,EAAOoC,GACdqsD,EAAIj9B,EAAM,GAAM+8B,EAAOG,EAAOl9B,EAAM,GAAM+8B,EAAOG,EAAOl9B,EAAM,GAAM+8B,EAAOG,GAM7E9pD,EAAMC,SAAU9L,EAAOs1D,EAAc77D,OAAS,EAAIuG,EAAO,GAM1D,QAAS61D,KAER,GAAI71D,GAAQs1D,EAAc77D,OAAS,EAC/Bq8D,EAAc,CAIlB,KAHAC,EAAW5C,EAAS2C,GACpBA,GAAe3C,EAAQ15D,OAEjBu8D,EAAI,EAAGC,EAAKC,EAAMz8D,OAAQu8D,EAAIC,EAAID,IAEvCG,EAAQD,EAAOF,GACfD,EAAWI,EAAOL,GAGlBA,GAAeK,EAAM18D,MAKtBoS,GAAMC,SAAU9L,EAAOs1D,EAAc77D,OAAS,EAAIuG,EAAO,GAK1D,QAAS+1D,GAAW5C,EAAS2C,GAE5B,GAAIhvB,GAAG1Q,CAGP,KAFA/sB,EAAI8pD,EAAQ15D,SAED4P,GAAK,GAAI,CAEnBy9B,EAAIz9B,EACJ+sB,EAAI/sB,EAAI,EACH+sB,EAAI,IAAIA,EAAI+8B,EAAQ15D,OAAS,EAIlC,IAAI28D,GAAI,EACPC,EAAKV,EAAwB,EAAhBC,CAEd,KAAMQ,EAAI,EAAGA,EAAIC,EAAID,IAAO,CAE3B,GAAIE,GAAQd,EAAOY,EACfG,EAAQf,GAASY,EAAI,GAErBjwD,EAAI2vD,EAAchvB,EAAIwvB,EACzBj3D,EAAIy2D,EAAc1/B,EAAIkgC,EACtBlwD,EAAI0vD,EAAc1/B,EAAImgC,EACtB5qD,EAAImqD,EAAchvB,EAAIyvB,CAEvBC,GAAIrwD,EAAG9G,EAAG+G,EAAGuF,KAQhB,QAASnB,GAAGrR,EAAGC,EAAGS,GAEjB48D,EAAYhrD,KAAMtS,GAClBs9D,EAAYhrD,KAAMrS,GAClBq9D,EAAYhrD,KAAM5R,GAKnB,QAAS67D,GAAIvvD,EAAG9G,EAAG+G,GAElBswD,EAAWvwD,GACXuwD,EAAWr3D,GACXq3D,EAAWtwD,EAEX,IAAIuwD,GAAYrB,EAAc77D,OAAS,EACnCwP,EAAM2tD,EAAMC,cAAehrD,EAAOypD,EAAeqB,EAAY,EAAGA,EAAY,EAAGA,EAAY,EAE/FG,GAAO7tD,EAAK,IACZ6tD,EAAO7tD,EAAK,IACZ6tD,EAAO7tD,EAAK,IAIb,QAASutD,GAAIrwD,EAAG9G,EAAG+G,EAAGuF,GAErB+qD,EAAWvwD,GACXuwD,EAAWr3D,GACXq3D,EAAW/qD,GAEX+qD,EAAWr3D,GACXq3D,EAAWtwD,GACXswD,EAAW/qD,EAGX,IAAIgrD,GAAYrB,EAAc77D,OAAS,EACnCwP,EAAM2tD,EAAMG,mBAAoBlrD,EAAOypD,EAAeqB,EAAY,EAAGA,EAAY,EAAGA,EAAY,EAAGA,EAAY,EAEnHG,GAAO7tD,EAAK,IACZ6tD,EAAO7tD,EAAK,IACZ6tD,EAAO7tD,EAAK,IAEZ6tD,EAAO7tD,EAAK,IACZ6tD,EAAO7tD,EAAK,IACZ6tD,EAAO7tD,EAAK,IAIb,QAASytD,GAAWjtD,GAEnB6rD,EAAc7pD,KAAMgrD,EAAqB,EAARhtD,EAAY,IAC7C6rD,EAAc7pD,KAAMgrD,EAAqB,EAARhtD,EAAY,IAC7C6rD,EAAc7pD,KAAMgrD,EAAqB,EAARhtD,EAAY,IAK9C,QAASqtD,GAAOE,GAEf/T,EAAQx3C,KAAMurD,EAAQ79D,GACtB8pD,EAAQx3C,KAAMurD,EAAQ59D,GA3mBvB,GAAIq9D,MAIAQ,EAA0C98D,SAA1B+C,EAAQ+5D,cAA8B/5D,EAAQ+5D,cAAgB,GAC9EtB,EAA0Bx7D,SAAlB+C,EAAQy4D,MAAsBz4D,EAAQy4D,MAAQ,EACtD7rD,EAA0B3P,SAAlB+C,EAAQ4M,MAAsB5M,EAAQ4M,MAAQ,IAEtDyrD,EAAwCp7D,SAAzB+C,EAAQq4D,cAA6Br4D,EAAQq4D,aAC5D2B,EAA4C/8D,SAA3B+C,EAAQg6D,eAA+Bh6D,EAAQg6D,eAAiB,EACjFC,EAAkCh9D,SAAtB+C,EAAQi6D,UAA0Bj6D,EAAQi6D,UAAYD,EAAiB,EACnFtB,EAA0Cz7D,SAA1B+C,EAAQ04D,cAA8B14D,EAAQ04D,cAAgB,EAE9EwB,EAAcl6D,EAAQk6D,YAEtBR,EAAgCz8D,SAAxB+C,EAAQm6D,YAA4Bn6D,EAAQm6D,YAAcC,EAI9Cn9D,UAAnB+C,EAAQq6D,SAEZ79D,QAAQ4H,KAAM,kEACdwI,EAAQ5M,EAAQq6D,OAMjB,IAAIC,GACAC,EAAYC,EAAUl5D,EAAQm5D,EADlBC,GAAgB,CAG3BR,KAEJI,EAAaJ,EAAYS,gBAAiBlC,GAE1CiC,GAAgB,EAChBrC,GAAe,EAMfkC,EAAaL,EAAYtK,oBAAqB6I,GAAO,GAIrD+B,EAAW,GAAIt9D,GACfoE,EAAS,GAAIpE,GACbu9D,EAAY,GAAIv9D,IAMVm7D,IAENK,EAAgB,EAChBsB,EAAiB,EACjBC,EAAY,EAMb,IAAIhB,GAAOH,EAAGC,EAEV6B,EAActE,EAAMuE,cAAed,GAEnClwD,EAAW+wD,EAAYtE,MACvB0C,EAAQ4B,EAAY5B,MAEpB8B,GAAYC,GAAWC,YAAanxD,EAExC,IAAKixD,EAMJ,IAJAjxD,EAAWA,EAASixD,UAIdhC,EAAI,EAAGC,EAAKC,EAAMz8D,OAAQu8D,EAAIC,EAAID,IAEvCG,EAAQD,EAAOF,GAEViC,GAAWC,YAAa/B,KAE5BD,EAAOF,GAAMG,EAAM6B,UAStB,IAAI/wD,GAAQgxD,GAAWE,iBAAkBpxD,EAAUmvD,GAI/C/C,EAAUpsD,CAEd,KAAMivD,EAAI,EAAGC,EAAKC,EAAMz8D,OAAQu8D,EAAIC,EAAID,IAEvCG,EAAQD,EAAOF,GAEfjvD,EAAWA,EAASqxD,OAAQjC,EAkJ7B,KAAM,GArIF92D,GAAGg5D,EAAI5M,EAAG5xD,EACby+D,EACA7/B,EADM+8B,EAAOzuD,EAAStN,OAChBg8D,EAAOxuD,EAAMxN,OAiIhB8+D,KAEMlvD,EAAI,EAAGyuB,EAAKq7B,EAAQ15D,OAAQqtC,EAAIhP,EAAK,EAAG1B,GAAI/sB,EAAI,EAAGA,EAAIyuB,EAAIzuB,IAAMy9B,IAAM1Q,KAE3E0Q,IAAMhP,IAAKgP,EAAI,GACf1Q,KAAM0B,IAAK1B,GAAI,GAKpBmiC,EAAkBlvD,GAAMuqD,EAAaT,EAAS9pD,GAAK8pD,EAASrsB,GAAKqsB,EAAS/8B,IAI3E,IACCoiC,IADGC,MACeC,GAAoBH,EAAiBH,QAExD,KAAMpC,EAAI,EAAGC,EAAKC,EAAMz8D,OAAQu8D,EAAIC,EAAID,IAAO,CAM9C,IAJAG,EAAQD,EAAOF,GAEfwC,MAEMnvD,EAAI,EAAGyuB,EAAKq+B,EAAM18D,OAAQqtC,EAAIhP,EAAK,EAAG1B,GAAI/sB,EAAI,EAAGA,EAAIyuB,EAAIzuB,IAAMy9B,IAAM1Q,KAErE0Q,IAAMhP,IAAKgP,EAAI,GACf1Q,KAAM0B,IAAK1B,GAAI,GAGpBoiC,GAAkBnvD,GAAMuqD,EAAauC,EAAO9sD,GAAK8sD,EAAOrvB,GAAKqvB,EAAO//B,IAIrEqiC,IAAehtD,KAAM+sD,IACrBE,GAAoBA,GAAkBN,OAAQI,IAO/C,IAAMn5D,EAAI,EAAGA,EAAIu2D,EAAev2D,IAAO,CAUtC,IANAosD,EAAIpsD,EAAIu2D,EACR/7D,EAAIq9D,EAAiBlrD,KAAKimB,IAAKw5B,EAAIz/C,KAAKi+C,GAAK,GAC7CoO,EAAKlB,EAAYnrD,KAAK6gD,IAAKpB,EAAIz/C,KAAKi+C,GAAK,GAInC5gD,EAAI,EAAGyuB,EAAKq7B,EAAQ15D,OAAQ4P,EAAIyuB,EAAIzuB,IAEzCivD,EAAO7E,EAAUN,EAAS9pD,GAAKkvD,EAAkBlvD,GAAKgvD,GAEtD7tD,EAAG8tD,EAAKn/D,EAAGm/D,EAAKl/D,GAAKS,EAMtB,KAAMm8D,EAAI,EAAGC,EAAKC,EAAMz8D,OAAQu8D,EAAIC,EAAID,IAKvC,IAHAG,EAAQD,EAAOF,GACfwC,GAAmBC,GAAgBzC,GAE7B3sD,EAAI,EAAGyuB,EAAKq+B,EAAM18D,OAAQ4P,EAAIyuB,EAAIzuB,IAEvCivD,EAAO7E,EAAU0C,EAAO9sD,GAAKmvD,GAAkBnvD,GAAKgvD,GAEpD7tD,EAAG8tD,EAAKn/D,EAAGm/D,EAAKl/D,GAAKS,GAYxB,IAJAw+D,EAAKlB,EAIC9tD,EAAI,EAAGA,EAAImsD,EAAMnsD,IAEtBivD,EAAO/C,EAAe9B,EAAU1sD,EAAUsC,GAAKqvD,GAAmBrvD,GAAKgvD,GAAOtxD,EAAUsC,GAEjFuuD,GAQNp5D,EAAOyZ,KAAMw/C,EAAWzuD,QAAS,IAAMuoB,eAAgB+mC,EAAKn/D,GAC5Du+D,EAASz/C,KAAMw/C,EAAWrL,UAAW,IAAM76B,eAAgB+mC,EAAKl/D,GAEhEu+D,EAAU1/C,KAAMu/C,EAAY,IAAM9+B,IAAKl6B,GAASk6B,IAAKg/B,GAErDltD,EAAGmtD,EAAUx+D,EAAGw+D,EAAUv+D,EAAGu+D,EAAU99D,IAXvC2Q,EAAG8tD,EAAKn/D,EAAGm/D,EAAKl/D,EAAG,EAoBrB,IAAIg9D,GAEJ,KAAMA,GAAI,EAAGA,IAAKT,EAAOS,KAExB,IAAM/sD,EAAI,EAAGA,EAAImsD,EAAMnsD,IAEtBivD,EAAO/C,EAAe9B,EAAU1sD,EAAUsC,GAAKqvD,GAAmBrvD,GAAKgvD,GAAOtxD,EAAUsC,GAEjFuuD,GAQNp5D,EAAOyZ,KAAMw/C,EAAWzuD,QAASotD,KAAM7kC,eAAgB+mC,EAAKn/D,GAC5Du+D,EAASz/C,KAAMw/C,EAAWrL,UAAWgK,KAAM7kC,eAAgB+mC,EAAKl/D,GAEhEu+D,EAAU1/C,KAAMu/C,EAAYpB,KAAM19B,IAAKl6B,GAASk6B,IAAKg/B,GAErDltD,EAAGmtD,EAAUx+D,EAAGw+D,EAAUv+D,EAAGu+D,EAAU99D,IAXvC2Q,EAAG8tD,EAAKn/D,EAAGm/D,EAAKl/D,EAAG0Q,EAAQ6rD,EAAQS,GAuBtC,KAAM/2D,EAAIu2D,EAAgB,EAAGv2D,GAAK,EAAGA,IAAO,CAQ3C,IANAosD,EAAIpsD,EAAIu2D,EACR/7D,EAAIq9D,EAAiBlrD,KAAKimB,IAAKw5B,EAAIz/C,KAAKi+C,GAAK,GAC7CoO,EAAKlB,EAAYnrD,KAAK6gD,IAAKpB,EAAIz/C,KAAKi+C,GAAK,GAInC5gD,EAAI,EAAGyuB,EAAKq7B,EAAQ15D,OAAQ4P,EAAIyuB,EAAIzuB,IAEzCivD,EAAO7E,EAAUN,EAAS9pD,GAAKkvD,EAAkBlvD,GAAKgvD,GACtD7tD,EAAG8tD,EAAKn/D,EAAGm/D,EAAKl/D,EAAG0Q,EAAQjQ,EAM5B,KAAMm8D,EAAI,EAAGC,EAAKC,EAAMz8D,OAAQu8D,EAAIC,EAAID,IAKvC,IAHAG,EAAQD,EAAOF,GACfwC,GAAmBC,GAAgBzC,GAE7B3sD,EAAI,EAAGyuB,EAAKq+B,EAAM18D,OAAQ4P,EAAIyuB,EAAIzuB,IAEvCivD,EAAO7E,EAAU0C,EAAO9sD,GAAKmvD,GAAkBnvD,GAAKgvD,GAE7CT,EAMNptD,EAAG8tD,EAAKn/D,EAAGm/D,EAAKl/D,EAAIo+D,EAAY7B,EAAQ,GAAIv8D,EAAGo+D,EAAY7B,EAAQ,GAAIx8D,EAAIU,GAJ3E2Q,EAAG8tD,EAAKn/D,EAAGm/D,EAAKl/D,EAAG0Q,EAAQjQ,GAkB/Bw7D,IAIAQ,IAzdDtsD,EAAe5L,KAAMtE,MAErBA,KAAKyB,KAAO,wBAEZzB,KAAK6Q,YACJmpD,OAAQA,EACRn2D,QAASA,GAGVm2D,EAAS5sD,MAAMC,QAAS2sD,GAAWA,GAAWA,EAO9C,KAAM,GALFxnD,GAAQxS,KAERi8D,KACArS,KAEM55C,EAAI,EAAGC,EAAI+pD,EAAO55D,OAAQ4P,EAAIC,EAAGD,IAAO,CAEjD,GAAImqD,GAAQH,EAAQhqD,EACpBkqD,GAAUC,GAMXn6D,KAAK8S,aAAc,WAAY,GAAItD,GAAwBysD,EAAe,IAC1Ej8D,KAAK8S,aAAc,KAAM,GAAItD,GAAwBo6C,EAAS,IAE9D5pD,KAAK4xD,uBAksBN,QAAS0N,IAAQtF,EAAQn2D,EAASa,GAMjC,GAFAA,EAAKs1D,UAEA5sD,MAAMC,QAAS2sD,GAEnB,IAAM,GAAIhqD,GAAI,EAAGC,EAAI+pD,EAAO55D,OAAQ4P,EAAIC,EAAGD,IAAO,CAEjD,GAAImqD,GAAQH,EAAQhqD,EAEpBtL,GAAKs1D,OAAO5nD,KAAM+nD,EAAMn4D,UAMzB0C,GAAKs1D,OAAO5nD,KAAM4nD,EAAOh4D,KAQ1B,OAF6BlB,UAAxB+C,EAAQk6D,cAA4Br5D,EAAKb,QAAQk6D,YAAcl6D,EAAQk6D,YAAYuB,UAEjF56D,EAyBR,QAAS66D,IAAcC,EAAM3uD,GAE5BrD,EAASlJ,KAAMtE,MAEfA,KAAKyB,KAAO,eAEZzB,KAAK6Q,YACJ2uD,KAAMA,EACN3uD,WAAYA,GAGb7Q,KAAK8Q,mBAAoB,GAAI2uD,IAAoBD,EAAM3uD,IACvD7Q,KAAKgR,gBASN,QAASyuD,IAAoBD,EAAM3uD,GAElCA,EAAaA,KAEb,IAAI6uD,GAAO7uD,EAAW6uD,IAEtB,KAASA,IAAQA,EAAKC,OAGrB,MADAt/D,SAAQC,MAAO,wEACR,GAAIkN,EAIZ,IAAIwsD,GAAS0F,EAAKE,eAAgBJ,EAAM3uD,EAAWoW,KAInDpW,GAAWJ,MAA8B3P,SAAtB+P,EAAWjN,OAAuBiN,EAAWjN,OAAS,GAItC9C,SAA9B+P,EAAWgtD,iBAA+BhtD,EAAWgtD,eAAiB,IAC7C/8D,SAAzB+P,EAAWitD,YAA0BjtD,EAAWitD,UAAY,GAChCh9D,SAA5B+P,EAAWqrD,eAA6BrrD,EAAWqrD,cAAe,GAEvEjC,GAAsB31D,KAAMtE,KAAMg6D,EAAQnpD,GAE1C7Q,KAAKyB,KAAO,qBAeb,QAASo+D,IAAgB56D,EAAQyL,EAAeC,EAAgBmvD,EAAUC,EAAWC,EAAYC,GAEhGzyD,EAASlJ,KAAMtE,MAEfA,KAAKyB,KAAO,iBAEZzB,KAAK6Q,YACJ5L,OAAQA,EACRyL,cAAeA,EACfC,eAAgBA,EAChBmvD,SAAUA,EACVC,UAAWA,EACXC,WAAYA,EACZC,YAAaA,GAGdjgE,KAAK8Q,mBAAoB,GAAIovD,IAAsBj7D,EAAQyL,EAAeC,EAAgBmvD,EAAUC,EAAWC,EAAYC,IAC3HjgE,KAAKgR,gBASN,QAASkvD,IAAsBj7D,EAAQyL,EAAeC,EAAgBmvD,EAAUC,EAAWC,EAAYC,GAEtG/vD,EAAe5L,KAAMtE,MAErBA,KAAKyB,KAAO,uBAEZzB,KAAK6Q,YACJ5L,OAAQA,EACRyL,cAAeA,EACfC,eAAgBA,EAChBmvD,SAAUA,EACVC,UAAWA,EACXC,WAAYA,EACZC,YAAaA,GAGdh7D,EAASA,GAAU,EAEnByL,EAAgBiC,KAAK7N,IAAK,EAAG6N,KAAKC,MAAOlC,IAAmB,GAC5DC,EAAiBgC,KAAK7N,IAAK,EAAG6N,KAAKC,MAAOjC,IAAoB,GAE9DmvD,EAAwBh/D,SAAbg/D,EAAyBA,EAAW,EAC/CC,EAA0Bj/D,SAAdi/D,EAA0BA,EAAsB,EAAVptD,KAAKi+C,GAEvDoP,EAA4Bl/D,SAAfk/D,EAA2BA,EAAa,EACrDC,EAA8Bn/D,SAAhBm/D,EAA4BA,EAActtD,KAAKi+C;AAE7D,GAEIp/C,GAAIC,EAFJ0uD,EAAWH,EAAaC,EAIxB7vD,EAAQ,EACRgwD,KAEA5R,EAAS,GAAIztD,GACboE,EAAS,GAAIpE,GAIbwR,KACA7E,KACAiC,KACAC,IAIJ,KAAM6B,EAAK,EAAGA,GAAMd,EAAgBc,IAAQ,CAE3C,GAAI4uD,MAEAlvD,EAAIM,EAAKd,CAEb,KAAMa,EAAK,EAAGA,GAAMd,EAAec,IAAQ,CAE1C,GAAIN,GAAIM,EAAKd,CAIb89C,GAAO1uD,GAAMmF,EAAS0N,KAAKimB,IAAKknC,EAAW5uD,EAAI6uD,GAAcptD,KAAK6gD,IAAKwM,EAAa7uD,EAAI8uD,GACxFzR,EAAOzuD,EAAIkF,EAAS0N,KAAKimB,IAAKonC,EAAa7uD,EAAI8uD,GAC/CzR,EAAOhuD,EAAIyE,EAAS0N,KAAK6gD,IAAKsM,EAAW5uD,EAAI6uD,GAAcptD,KAAK6gD,IAAKwM,EAAa7uD,EAAI8uD,GAEtFvyD,EAAS0E,KAAMo8C,EAAO1uD,EAAG0uD,EAAOzuD,EAAGyuD,EAAOhuD,GAI1C2E,EAAOc,IAAKuoD,EAAO1uD,EAAG0uD,EAAOzuD,EAAGyuD,EAAOhuD,GAAIm5B,YAC3ChqB,EAAQyC,KAAMjN,EAAOrF,EAAGqF,EAAOpF,EAAGoF,EAAO3E,GAIzCoP,EAAIwC,KAAMlB,EAAG,EAAIC,GAEjBkvD,EAAYjuD,KAAMhC,KAInBgwD,EAAKhuD,KAAMiuD,GAMZ,IAAM5uD,EAAK,EAAGA,EAAKd,EAAgBc,IAElC,IAAMD,EAAK,EAAGA,EAAKd,EAAec,IAAQ,CAEzC,GAAI1E,GAAIszD,EAAM3uD,GAAMD,EAAK,GACrBxL,EAAIo6D,EAAM3uD,GAAMD,GAChBzE,EAAIqzD,EAAM3uD,EAAK,GAAKD,GACpBc,EAAI8tD,EAAM3uD,EAAK,GAAKD,EAAK,IAEjB,IAAPC,GAAYuuD,EAAa,IAAIztD,EAAQH,KAAMtF,EAAG9G,EAAGsM,IACjDb,IAAOd,EAAiB,GAAKwvD,EAAWxtD,KAAKi+C,KAAKr+C,EAAQH,KAAMpM,EAAG+G,EAAGuF,GAQ7EtS,KAAK6S,SAAUN,GACfvS,KAAK8S,aAAc,WAAY,GAAItD,GAAwB9B,EAAU,IACrE1N,KAAK8S,aAAc,SAAU,GAAItD,GAAwBG,EAAS,IAClE3P,KAAK8S,aAAc,KAAM,GAAItD,GAAwBI,EAAK,IAc3D,QAAS0wD,IAAcC,EAAaC,EAAaC,EAAeC,EAAaV,EAAYC,GAExFzyD,EAASlJ,KAAMtE,MAEfA,KAAKyB,KAAO,eAEZzB,KAAK6Q,YACJ0vD,YAAaA,EACbC,YAAaA,EACbC,cAAeA,EACfC,YAAaA,EACbV,WAAYA,EACZC,YAAaA,GAGdjgE,KAAK8Q,mBAAoB,GAAI6vD,IAAoBJ,EAAaC,EAAaC,EAAeC,EAAaV,EAAYC,IACnHjgE,KAAKgR,gBASN,QAAS2vD,IAAoBJ,EAAaC,EAAaC,EAAeC,EAAaV,EAAYC,GAE9F/vD,EAAe5L,KAAMtE,MAErBA,KAAKyB,KAAO,qBAEZzB,KAAK6Q,YACJ0vD,YAAaA,EACbC,YAAaA,EACbC,cAAeA,EACfC,YAAaA,EACbV,WAAYA,EACZC,YAAaA,GAGdM,EAAcA,GAAe,GAC7BC,EAAcA,GAAe,EAE7BR,EAA4Bl/D,SAAfk/D,EAA2BA,EAAa,EACrDC,EAA8Bn/D,SAAhBm/D,EAA4BA,EAAwB,EAAVttD,KAAKi+C,GAE7D6P,EAAkC3/D,SAAlB2/D,EAA8B9tD,KAAK7N,IAAK,EAAG27D,GAAkB,EAC7EC,EAA8B5/D,SAAhB4/D,EAA4B/tD,KAAK7N,IAAK,EAAG47D,GAAgB,CAIvE,IAOIE,GAKAnzB,EAAGz9B,EAZHuC,KACA7E,KACAiC,KACAC,KAKA3K,EAASs7D,EACTM,GAAiBL,EAAcD,GAAgBG,EAC/ClS,EAAS,GAAIztD,GACb6W,EAAK,GAAI/X,EAKb,KAAM4tC,EAAI,EAAGA,GAAKizB,EAAajzB,IAAO,CAErC,IAAMz9B,EAAI,EAAGA,GAAKywD,EAAezwD,IAIhC4wD,EAAUZ,EAAahwD,EAAIywD,EAAgBR,EAI3CzR,EAAO1uD,EAAImF,EAAS0N,KAAKimB,IAAKgoC,GAC9BpS,EAAOzuD,EAAIkF,EAAS0N,KAAK6gD,IAAKoN,GAE9BlzD,EAAS0E,KAAMo8C,EAAO1uD,EAAG0uD,EAAOzuD,EAAGyuD,EAAOhuD,GAI1CmP,EAAQyC,KAAM,EAAG,EAAG,GAIpBwF,EAAG9X,GAAM0uD,EAAO1uD,EAAI0gE,EAAc,GAAM,EACxC5oD,EAAG7X,GAAMyuD,EAAOzuD,EAAIygE,EAAc,GAAM,EAExC5wD,EAAIwC,KAAMwF,EAAG9X,EAAG8X,EAAG7X,EAMpBkF,IAAU47D,EAMX,IAAMpzB,EAAI,EAAGA,EAAIizB,EAAajzB,IAAO,CAEpC,GAAIqzB,GAAoBrzB,GAAMgzB,EAAgB,EAE9C,KAAMzwD,EAAI,EAAGA,EAAIywD,EAAezwD,IAAO,CAEtC4wD,EAAU5wD,EAAI8wD,CAEd,IAAIh0D,GAAI8zD,EACJ56D,EAAI46D,EAAUH,EAAgB,EAC9B1zD,EAAI6zD,EAAUH,EAAgB,EAC9BnuD,EAAIsuD,EAAU,CAIlBruD,GAAQH,KAAMtF,EAAG9G,EAAGsM,GACpBC,EAAQH,KAAMpM,EAAG+G,EAAGuF,IAQtBtS,KAAK6S,SAAUN,GACfvS,KAAK8S,aAAc,WAAY,GAAItD,GAAwB9B,EAAU,IACrE1N,KAAK8S,aAAc,SAAU,GAAItD,GAAwBG,EAAS,IAClE3P,KAAK8S,aAAc,KAAM,GAAItD,GAAwBI,EAAK,IAe3D,QAASmxD,IAAe9+C,EAAQ++C,EAAUlB,EAAUC,GAEnDvyD,EAASlJ,KAAMtE,MAEfA,KAAKyB,KAAO,gBAEZzB,KAAK6Q,YACJoR,OAAQA,EACR++C,SAAUA,EACVlB,SAAUA,EACVC,UAAWA,GAGZ//D,KAAK8Q,mBAAoB,GAAImwD,IAAqBh/C,EAAQ++C,EAAUlB,EAAUC,IAC9E//D,KAAKgR,gBASN,QAASiwD,IAAqBh/C,EAAQ++C,EAAUlB,EAAUC,GAEzD7vD,EAAe5L,KAAMtE,MAErBA,KAAKyB,KAAO,sBAEZzB,KAAK6Q,YACJoR,OAAQA,EACR++C,SAAUA,EACVlB,SAAUA,EACVC,UAAWA,GAGZiB,EAAWruD,KAAKC,MAAOouD,IAAc,GACrClB,EAAWA,GAAY,EACvBC,EAAYA,GAAuB,EAAVptD,KAAKi+C,GAI9BmP,EAAY99D,GAAMi/D,MAAOnB,EAAW,EAAa,EAAVptD,KAAKi+C,GAK5C,IAMIuQ,GAIAnxD,EAAGy9B,EAVHl7B,KACA7E,KACAkC,KAKAwxD,EAAkB,EAAMJ,EACxBxS,EAAS,GAAIztD,GACb6W,EAAK,GAAI/X,EAKb,KAAMmQ,EAAI,EAAGA,GAAKgxD,EAAUhxD,IAAO,CAElC,GAAIqxD,GAAMvB,EAAW9vD,EAAIoxD,EAAkBrB,EAEvCvM,EAAM7gD,KAAK6gD,IAAK6N,GAChBzoC,EAAMjmB,KAAKimB,IAAKyoC,EAEpB,KAAM5zB,EAAI,EAAGA,GAAOxrB,EAAO7hB,OAAS,EAAKqtC,IAIxC+gB,EAAO1uD,EAAImiB,EAAQwrB,GAAI3tC,EAAI0zD,EAC3BhF,EAAOzuD,EAAIkiB,EAAQwrB,GAAI1tC,EACvByuD,EAAOhuD,EAAIyhB,EAAQwrB,GAAI3tC,EAAI84B,EAE3BlrB,EAAS0E,KAAMo8C,EAAO1uD,EAAG0uD,EAAOzuD,EAAGyuD,EAAOhuD,GAI1CoX,EAAG9X,EAAIkQ,EAAIgxD,EACXppD,EAAG7X,EAAI0tC,GAAMxrB,EAAO7hB,OAAS,GAE7BwP,EAAIwC,KAAMwF,EAAG9X,EAAG8X,EAAG7X,GASrB,IAAMiQ,EAAI,EAAGA,EAAIgxD,EAAUhxD,IAE1B,IAAMy9B,EAAI,EAAGA,EAAMxrB,EAAO7hB,OAAS,EAAKqtC,IAAO,CAE9C0zB,EAAO1zB,EAAIz9B,EAAIiS,EAAO7hB,MAEtB,IAAI0M,GAAIq0D,EACJn7D,EAAIm7D,EAAOl/C,EAAO7hB,OAClB2M,EAAIo0D,EAAOl/C,EAAO7hB,OAAS,EAC3BkS,EAAI6uD,EAAO,CAIf5uD,GAAQH,KAAMtF,EAAG9G,EAAGsM,GACpBC,EAAQH,KAAMpM,EAAG+G,EAAGuF,GAmBtB,GAXAtS,KAAK6S,SAAUN,GACfvS,KAAK8S,aAAc,WAAY,GAAItD,GAAwB9B,EAAU,IACrE1N,KAAK8S,aAAc,KAAM,GAAItD,GAAwBI,EAAK,IAI1D5P,KAAK4xD,uBAKAmO,IAAwB,EAAVptD,KAAKi+C,GAAS,CAEhC,GAAIjhD,GAAU3P,KAAKqQ,WAAWlL,OAAOkC,MACjCi6D,EAAK,GAAIvgE,GACTwgE,EAAK,GAAIxgE,GACTijB,EAAI,GAAIjjB,EAMZ,KAFAogE,EAAOH,EAAW/+C,EAAO7hB,OAAS,EAE5B4P,EAAI,EAAGy9B,EAAI,EAAGz9B,EAAIiS,EAAO7hB,OAAQ4P,IAAMy9B,GAAK,EAIjD6zB,EAAGxhE,EAAI6P,EAAS89B,EAAI,GACpB6zB,EAAGvhE,EAAI4P,EAAS89B,EAAI,GACpB6zB,EAAG9gE,EAAImP,EAAS89B,EAAI,GAIpB8zB,EAAGzhE,EAAI6P,EAASwxD,EAAO1zB,EAAI,GAC3B8zB,EAAGxhE,EAAI4P,EAASwxD,EAAO1zB,EAAI,GAC3B8zB,EAAG/gE,EAAImP,EAASwxD,EAAO1zB,EAAI,GAI3BzpB,EAAEuwC,WAAY+M,EAAIC,GAAK5nC,YAIvBhqB,EAAS89B,EAAI,GAAM99B,EAASwxD,EAAO1zB,EAAI,GAAMzpB,EAAElkB,EAC/C6P,EAAS89B,EAAI,GAAM99B,EAASwxD,EAAO1zB,EAAI,GAAMzpB,EAAEjkB,EAC/C4P,EAAS89B,EAAI,GAAM99B,EAASwxD,EAAO1zB,EAAI,GAAMzpB,EAAExjB,GAkBlD,QAASghE,IAAexH,EAAQ4D,GAE/BpwD,EAASlJ,KAAMtE,MAEfA,KAAKyB,KAAO,gBAEkB,gBAAlBm8D,KAEXv9D,QAAQ4H,KAAM,4DAEd21D,EAAgBA,EAAcA,eAI/B59D,KAAK6Q,YACJmpD,OAAQA,EACR4D,cAAeA,GAGhB59D,KAAK8Q,mBAAoB,GAAI2wD,IAAqBzH,EAAQ4D,IAC1D59D,KAAKgR,gBAmBN,QAASywD,IAAqBzH,EAAQ4D,GAwDrC,QAAS1D,GAAUC,GAElB,GAAInqD,GAAGC,EAAGyxD,EAENC,EAAcj0D,EAAStN,OAAS,EAChC6hB,EAASk4C,EAAMuE,cAAed,GAE9BgE,EAAgB3/C,EAAOk4C,MACvB0H,EAAa5/C,EAAO46C,KAIxB,IAAK+B,GAAWC,YAAa+C,MAAoB,EAMhD,IAJAA,EAAgBA,EAAcjD,UAIxB3uD,EAAI,EAAGC,EAAI4xD,EAAWzhE,OAAQ4P,EAAIC,EAAGD,IAE1C0xD,EAAYG,EAAY7xD,GAEnB4uD,GAAWC,YAAa6C,MAAgB,IAE5CG,EAAY7xD,GAAM0xD,EAAU/C,UAQ/B,IAAI/wD,GAAQgxD,GAAWE,iBAAkB8C,EAAeC,EAIxD,KAAM7xD,EAAI,EAAGC,EAAI4xD,EAAWzhE,OAAQ4P,EAAIC,EAAGD,IAE1C0xD,EAAYG,EAAY7xD,GACxB4xD,EAAgBA,EAAc7C,OAAQ2C,EAMvC,KAAM1xD,EAAI,EAAGC,EAAI2xD,EAAcxhE,OAAQ4P,EAAIC,EAAGD,IAAO,CAEpD,GAAIw+C,GAASoT,EAAe5xD,EAE5BtC,GAAS0E,KAAMo8C,EAAO1uD,EAAG0uD,EAAOzuD,EAAG,GACnC4P,EAAQyC,KAAM,EAAG,EAAG,GACpBxC,EAAIwC,KAAMo8C,EAAO1uD,EAAG0uD,EAAOzuD,GAM5B,IAAMiQ,EAAI,EAAGC,EAAIrC,EAAMxN,OAAQ4P,EAAIC,EAAGD,IAAO,CAE5C,GAAIovB,GAAOxxB,EAAOoC,GAEdlD,EAAIsyB,EAAM,GAAMuiC,EAChB37D,EAAIo5B,EAAM,GAAMuiC,EAChB50D,EAAIqyB,EAAM,GAAMuiC,CAEpBpvD,GAAQH,KAAMtF,EAAG9G,EAAG+G,GACpBmF,GAAc,GAxHhBhC,EAAe5L,KAAMtE,MAErBA,KAAKyB,KAAO,sBAEZzB,KAAK6Q,YACJmpD,OAAQA,EACR4D,cAAeA,GAGhBA,EAAgBA,GAAiB,EAIjC,IAAIrrD,MACA7E,KACAiC,KACAC,KAIA8C,EAAa,EACbR,EAAa,CAIjB,IAAK9E,MAAMC,QAAS2sD,MAAa,EAEhCE,EAAUF,OAIV,KAAM,GAAIhqD,GAAI,EAAGA,EAAIgqD,EAAO55D,OAAQ4P,IAEnCkqD,EAAUF,EAAQhqD,IAElBhQ,KAAKyS,SAAUC,EAAYR,EAAYlC,GAEvC0C,GAAcR,EACdA,EAAa,CAQflS,MAAK6S,SAAUN,GACfvS,KAAK8S,aAAc,WAAY,GAAItD,GAAwB9B,EAAU,IACrE1N,KAAK8S,aAAc,SAAU,GAAItD,GAAwBG,EAAS,IAClE3P,KAAK8S,aAAc,KAAM,GAAItD,GAAwBI,EAAK,IA8F3D,QAASkyD,IAAU9H,EAAQt1D,GAI1B,GAFAA,EAAKs1D,UAEA5sD,MAAMC,QAAS2sD,GAEnB,IAAM,GAAIhqD,GAAI,EAAGC,EAAI+pD,EAAO55D,OAAQ4P,EAAIC,EAAGD,IAAO,CAEjD,GAAImqD,GAAQH,EAAQhqD,EAEpBtL,GAAKs1D,OAAO5nD,KAAM+nD,EAAMn4D,UAMzB0C,GAAKs1D,OAAO5nD,KAAM4nD,EAAOh4D,KAI1B,OAAO0C,GASR,QAASq9D,IAAe1pD,EAAU2pD,GAEjC9xD,EAAe5L,KAAMtE,MAErBA,KAAKyB,KAAO,gBAEZzB,KAAK6Q,YACJmxD,eAAgBA,GAGjBA,EAAsClhE,SAAnBkhE,EAAiCA,EAAiB,CAIrE,IAKiC1T,GAAOC,EACpC54B,EAIAssC,EAVAv0D,KAIAw0D,EAAevvD,KAAKimB,IAAK32B,GAAMkgE,QAAUH,GACzCvT,GAAS,EAAG,GAAKC,KACZC,GAAS,IAAK,IAAK,IAMvBt2C,GAASqI,kBAEbuhD,EAAY,GAAIz0D,GAChBy0D,EAAUnxD,mBAAoBuH,IAI9B4pD,EAAY5pD,EAASxN,QAItBo3D,EAAUjxD,gBACVixD,EAAUG,oBAOV,KAAM,GALFC,GAAiBJ,EAAUv0D,SAC3BE,EAAQq0D,EAAUr0D,MAIZoC,EAAI,EAAGC,EAAIrC,EAAMxN,OAAQ4P,EAAIC,EAAGD,IAIzC,IAAM,GAFFovB,GAAOxxB,EAAOoC,GAERy9B,EAAI,EAAGA,EAAI,EAAGA,IAEvB6gB,EAAQlvB,EAAMuvB,EAAMlhB,IACpB8gB,EAAQnvB,EAAMuvB,GAAQlhB,EAAI,GAAM,IAChCghB,EAAM,GAAM97C,KAAK9N,IAAKypD,EAAOC,GAC7BE,EAAM,GAAM97C,KAAK7N,IAAKwpD,EAAOC,GAE7B54B,EAAM84B,EAAM,GAAM,IAAMA,EAAM,GAER3tD,SAAjB4tD,EAAO/4B,GAEX+4B,EAAO/4B,IAAUi5B,OAAQH,EAAM,GAAKI,OAAQJ,EAAM,GAAK6T,MAAOtyD,EAAGuyD,MAAOzhE,QAIxE4tD,EAAO/4B,GAAM4sC,MAAQvyD,CAUxB,KAAM2lB,IAAO+4B,GAAQ,CAEpB,GAAIL,GAAIK,EAAO/4B,EAIf,IAAiB70B,SAAZutD,EAAEkU,OAAuB30D,EAAOygD,EAAEiU,OAAQn9D,OAAOq9D,IAAK50D,EAAOygD,EAAEkU,OAAQp9D,SAAY+8D,EAAe,CAEtG,GAAI1T,GAAS6T,EAAgBhU,EAAEO,OAC/BlhD,GAAS0E,KAAMo8C,EAAO1uD,EAAG0uD,EAAOzuD,EAAGyuD,EAAOhuD,GAE1CguD,EAAS6T,EAAgBhU,EAAEQ,QAC3BnhD,EAAS0E,KAAMo8C,EAAO1uD,EAAG0uD,EAAOzuD,EAAGyuD,EAAOhuD,IAQ5CR,KAAK8S,aAAc,WAAY,GAAItD,GAAwB9B,EAAU,IActE,QAAS+0D,IAAkBC,EAAWC,EAAc/+D,EAAQ6uD,EAAgB9hD,EAAgBiyD,EAAW5C,EAAYC,GAElHzyD,EAASlJ,KAAMtE,MAEfA,KAAKyB,KAAO,mBAEZzB,KAAK6Q,YACJ6xD,UAAWA,EACXC,aAAcA,EACd/+D,OAAQA,EACR6uD,eAAgBA,EAChB9hD,eAAgBA,EAChBiyD,UAAWA,EACX5C,WAAYA,EACZC,YAAaA,GAGdjgE,KAAK8Q,mBAAoB,GAAI+xD,IAAwBH,EAAWC,EAAc/+D,EAAQ6uD,EAAgB9hD,EAAgBiyD,EAAW5C,EAAYC,IAC7IjgE,KAAKgR,gBASN,QAAS6xD,IAAwBH,EAAWC,EAAc/+D,EAAQ6uD,EAAgB9hD,EAAgBiyD,EAAW5C,EAAYC,GA8DxH,QAAS6C,KAER,GAAIhjE,GAAGC,EACHoF,EAAS,GAAIpE,GACbytD,EAAS,GAAIztD,GAEbmR,EAAa,EAGb6wD,GAAUJ,EAAeD,GAAc9+D,CAI3C,KAAM7D,EAAI,EAAGA,GAAK4Q,EAAgB5Q,IAAO,CAExC,GAAIijE,MAEA7xD,EAAIpR,EAAI4Q,EAIR1L,EAASkM,GAAMwxD,EAAeD,GAAcA,CAEhD,KAAM5iE,EAAI,EAAGA,GAAK2yD,EAAgB3yD,IAAO,CAExC,GAAIoR,GAAIpR,EAAI2yD,EAERwQ,EAAQ/xD,EAAI+uD,EAAcD,EAE1BkD,EAAWvwD,KAAK6gD,IAAKyP,GACrBE,EAAWxwD,KAAKimB,IAAKqqC,EAIzBzU,GAAO1uD,EAAImF,EAASi+D,EACpB1U,EAAOzuD,GAAMoR,EAAIvN,EAAS2zB,EAC1Bi3B,EAAOhuD,EAAIyE,EAASk+D,EACpBz1D,EAAS0E,KAAMo8C,EAAO1uD,EAAG0uD,EAAOzuD,EAAGyuD,EAAOhuD,GAI1C2E,EAAOc,IAAKi9D,EAAUH,EAAOI,GAAWxpC,YACxChqB,EAAQyC,KAAMjN,EAAOrF,EAAGqF,EAAOpF,EAAGoF,EAAO3E,GAIzCoP,EAAIwC,KAAMlB,EAAG,EAAIC,GAIjB6xD,EAAS5wD,KAAMhC,KAMhBgzD,EAAWhxD,KAAM4wD,GAMlB,IAAMljE,EAAI,EAAGA,EAAI2yD,EAAgB3yD,IAEhC,IAAMC,EAAI,EAAGA,EAAI4Q,EAAgB5Q,IAAO,CAIvC,GAAI+M,GAAIs2D,EAAYrjE,GAAKD,GACrBkG,EAAIo9D,EAAYrjE,EAAI,GAAKD,GACzBiN,EAAIq2D,EAAYrjE,EAAI,GAAKD,EAAI,GAC7BwS,EAAI8wD,EAAYrjE,GAAKD,EAAI,EAI7ByS,GAAQH,KAAMtF,EAAG9G,EAAGsM,GACpBC,EAAQH,KAAMpM,EAAG+G,EAAGuF,GAIpBJ,GAAc,EAQhBM,EAAMC,SAAUC,EAAYR,EAAY,GAIxCQ,GAAcR,EAIf,QAASmxD,GAAa/2D,GAErB,GAAIxM,GAAGwjE,EAAkBC,EAErB3rD,EAAK,GAAI/X,GACT2uD,EAAS,GAAIztD,GAEbmR,EAAa,EAEbjN,EAAWqH,KAAQ,EAASo2D,EAAYC,EACxC5G,EAASzvD,KAAQ,EAAS,IAS9B,KANAg3D,EAAmBlzD,EAMbtQ,EAAI,EAAGA,GAAK2yD,EAAgB3yD,IAIjC4N,EAAS0E,KAAM,EAAGmlB,EAAawkC,EAAM,GAIrCpsD,EAAQyC,KAAM,EAAG2pD,EAAM,GAIvBnsD,EAAIwC,KAAM,GAAK,IAIfhC,GAUD,KAJAmzD,EAAiBnzD,EAIXtQ,EAAI,EAAGA,GAAK2yD,EAAgB3yD,IAAO,CAExC,GAAIoR,GAAIpR,EAAI2yD,EACRwQ,EAAQ/xD,EAAI+uD,EAAcD,EAE1BmD,EAAWxwD,KAAKimB,IAAKqqC,GACrBC,EAAWvwD,KAAK6gD,IAAKyP,EAIzBzU,GAAO1uD,EAAImF,EAASi+D,EACpB1U,EAAOzuD,EAAIw3B,EAAawkC,EACxBvN,EAAOhuD,EAAIyE,EAASk+D,EACpBz1D,EAAS0E,KAAMo8C,EAAO1uD,EAAG0uD,EAAOzuD,EAAGyuD,EAAOhuD,GAI1CmP,EAAQyC,KAAM,EAAG2pD,EAAM,GAIvBnkD,EAAG9X,EAAiB,GAAXqjE,EAAmB,GAC5BvrD,EAAG7X,EAAiB,GAAXmjE,EAAiBnH,EAAS,GACnCnsD,EAAIwC,KAAMwF,EAAG9X,EAAG8X,EAAG7X,GAInBqQ,IAMD,IAAMtQ,EAAI,EAAGA,EAAI2yD,EAAgB3yD,IAAO,CAEvC,GAAIiN,GAAIu2D,EAAmBxjE,EACvBkQ,EAAIuzD,EAAiBzjE,CAEpBwM,MAAQ,EAIZiG,EAAQH,KAAMpC,EAAGA,EAAI,EAAGjD,GAMxBwF,EAAQH,KAAMpC,EAAI,EAAGA,EAAGjD,GAIzBmF,GAAc,EAMfM,EAAMC,SAAUC,EAAYR,EAAY5F,KAAQ,EAAO,EAAI,GAI3DoG,GAAcR,EAvQfhC,EAAe5L,KAAMtE,MAErBA,KAAKyB,KAAO,yBAEZzB,KAAK6Q,YACJ6xD,UAAWA,EACXC,aAAcA,EACd/+D,OAAQA,EACR6uD,eAAgBA,EAChB9hD,eAAgBA,EAChBiyD,UAAWA,EACX5C,WAAYA,EACZC,YAAaA,EAGd,IAAIztD,GAAQxS,IAEZ0iE,GAA0B5hE,SAAd4hE,EAA0BA,EAAY,EAClDC,EAAgC7hE,SAAjB6hE,EAA6BA,EAAe,EAC3D/+D,EAASA,GAAU,EAEnB6uD,EAAiB9/C,KAAKC,MAAO6/C,IAAoB,EACjD9hD,EAAiBgC,KAAKC,MAAOjC,IAAoB,EAEjDiyD,EAA0B9hE,SAAd8hE,GAA0BA,EACtC5C,EAA4Bl/D,SAAfk/D,EAA2BA,EAAa,EACrDC,EAA8Bn/D,SAAhBm/D,EAA4BA,EAAwB,EAAVttD,KAAKi+C,EAI7D,IAAIr+C,MACA7E,KACAiC,KACAC,KAIAQ,EAAQ,EACRgzD,KACA7rC,EAAa3zB,EAAS,EACtB8O,EAAa,CAIjBowD,KAEKF,KAAc,IAEbF,EAAY,GAAIW,GAAa,GAC7BV,EAAe,GAAIU,GAAa,IAMtCrjE,KAAK6S,SAAUN,GACfvS,KAAK8S,aAAc,WAAY,GAAItD,GAAwB9B,EAAU,IACrE1N,KAAK8S,aAAc,SAAU,GAAItD,GAAwBG,EAAS,IAClE3P,KAAK8S,aAAc,KAAM,GAAItD,GAAwBI,EAAK,IA4N3D,QAAS4zD,IAAcv+D,EAAQrB,EAAQ6uD,EAAgB9hD,EAAgBiyD,EAAW5C,EAAYC,GAE7FwC,GAAiBn+D,KAAMtE,KAAM,EAAGiF,EAAQrB,EAAQ6uD,EAAgB9hD,EAAgBiyD,EAAW5C,EAAYC,GAEvGjgE,KAAKyB,KAAO,eAEZzB,KAAK6Q,YACJ5L,OAAQA,EACRrB,OAAQA,EACR6uD,eAAgBA,EAChB9hD,eAAgBA,EAChBiyD,UAAWA,EACX5C,WAAYA,EACZC,YAAaA,GAUf,QAASwD,IAAoBx+D,EAAQrB,EAAQ6uD,EAAgB9hD,EAAgBiyD,EAAW5C,EAAYC,GAEnG4C,GAAuBv+D,KAAMtE,KAAM,EAAGiF,EAAQrB,EAAQ6uD,EAAgB9hD,EAAgBiyD,EAAW5C,EAAYC,GAE7GjgE,KAAKyB,KAAO,qBAEZzB,KAAK6Q,YACJ5L,OAAQA,EACRrB,OAAQA,EACR6uD,eAAgBA,EAChB9hD,eAAgBA,EAChBiyD,UAAWA,EACX5C,WAAYA,EACZC,YAAaA,GAgBf,QAASyD,IAAgBz+D,EAAQ+7D,EAAUhB,EAAYC,GAEtDzyD,EAASlJ,KAAMtE,MAEfA,KAAKyB,KAAO,iBAEZzB,KAAK6Q,YACJ5L,OAAQA,EACR+7D,SAAUA,EACVhB,WAAYA,EACZC,YAAaA,GAGdjgE,KAAK8Q,mBAAoB,GAAI6yD,IAAsB1+D,EAAQ+7D,EAAUhB,EAAYC,IACjFjgE,KAAKgR,gBASN,QAAS2yD,IAAsB1+D,EAAQ+7D,EAAUhB,EAAYC,GAE5D/vD,EAAe5L,KAAMtE,MAErBA,KAAKyB,KAAO,uBAEZzB,KAAK6Q,YACJ5L,OAAQA,EACR+7D,SAAUA,EACVhB,WAAYA,EACZC,YAAaA,GAGdh7D,EAASA,GAAU,EACnB+7D,EAAwBlgE,SAAbkgE,EAAyBruD,KAAK7N,IAAK,EAAGk8D,GAAa,EAE9DhB,EAA4Bl/D,SAAfk/D,EAA2BA,EAAa,EACrDC,EAA8Bn/D,SAAhBm/D,EAA4BA,EAAwB,EAAVttD,KAAKi+C,EAI7D,IAOI5gD,GAAG+sD,EAPHxqD,KACA7E,KACAiC,KACAC,KAKA4+C,EAAS,GAAIztD,GACb6W,EAAK,GAAI/X,EAQb,KAJA6N,EAAS0E,KAAM,EAAG,EAAG,GACrBzC,EAAQyC,KAAM,EAAG,EAAG,GACpBxC,EAAIwC,KAAM,GAAK,IAET2qD,EAAI,EAAG/sD,EAAI,EAAG+sD,GAAKiE,EAAUjE,IAAM/sD,GAAK,EAAI,CAEjD,GAAI4wD,GAAUZ,EAAajD,EAAIiE,EAAWf,CAI1CzR,GAAO1uD,EAAImF,EAAS0N,KAAKimB,IAAKgoC,GAC9BpS,EAAOzuD,EAAIkF,EAAS0N,KAAK6gD,IAAKoN,GAE9BlzD,EAAS0E,KAAMo8C,EAAO1uD,EAAG0uD,EAAOzuD,EAAGyuD,EAAOhuD,GAI1CmP,EAAQyC,KAAM,EAAG,EAAG,GAIpBwF,EAAG9X,GAAM4N,EAAUsC,GAAM/K,EAAS,GAAM,EACxC2S,EAAG7X,GAAM2N,EAAUsC,EAAI,GAAM/K,EAAS,GAAM,EAE5C2K,EAAIwC,KAAMwF,EAAG9X,EAAG8X,EAAG7X,GAMpB,IAAMiQ,EAAI,EAAGA,GAAKgxD,EAAUhxD,IAE3BuC,EAAQH,KAAMpC,EAAGA,EAAI,EAAG,EAMzBhQ,MAAK6S,SAAUN,GACfvS,KAAK8S,aAAc,WAAY,GAAItD,GAAwB9B,EAAU,IACrE1N,KAAK8S,aAAc,SAAU,GAAItD,GAAwBG,EAAS,IAClE3P,KAAK8S,aAAc,KAAM,GAAItD,GAAwBI,EAAK,IA8D3D,QAASyjB,IAAgBxiB,GAExBwC,EAAS/O,KAAMtE,MAEfA,KAAKyB,KAAO,iBAEZzB,KAAKgN,MAAQ,GAAInH,GAAO,GACxB7F,KAAKgU,aAAc,EAEnBhU,KAAK8W,UAAWjG,GAuBjB,QAAS+yD,IAAmB/yD,GAE3BkG,EAAezS,KAAMtE,KAAM6Q,GAE3B7Q,KAAKyB,KAAO,oBA6Db,QAASuxB,IAAsBniB,GAE9BwC,EAAS/O,KAAMtE,MAEfA,KAAKgX,SAAY6sD,SAAY,IAE7B7jE,KAAKyB,KAAO,uBAEZzB,KAAKgN,MAAQ,GAAInH,GAAO,UACxB7F,KAAKwmD,UAAY,GACjBxmD,KAAKymD,UAAY,GAEjBzmD,KAAK6V,IAAM,KAEX7V,KAAK8V,SAAW,KAChB9V,KAAK+V,kBAAoB,EAEzB/V,KAAKgW,MAAQ,KACbhW,KAAKiW,eAAiB,EAEtBjW,KAAKmlD,SAAW,GAAIt/C,GAAO,GAC3B7F,KAAKolD,kBAAoB,EACzBplD,KAAKgvB,YAAc,KAEnBhvB,KAAKsrB,QAAU,KACftrB,KAAKqmD,UAAY,EAEjBrmD,KAAKurB,UAAY,KACjBvrB,KAAKm0B,cAAgB2vC,GACrB9jE,KAAKsmD,YAAc,GAAIzmD,GAAS,EAAG,GAEnCG,KAAKivB,gBAAkB,KACvBjvB,KAAK06B,kBAAoB,EACzB16B,KAAK26B,iBAAmB,EAExB36B,KAAKkvB,aAAe,KAEpBlvB,KAAKmvB,aAAe,KAEpBnvB,KAAKmW,SAAW,KAEhBnW,KAAKoW,OAAS,KACdpW,KAAK0mD,gBAAkB,EAEvB1mD,KAAKwW,gBAAkB,IAEvBxW,KAAKyW,WAAY,EACjBzW,KAAK0W,mBAAqB,EAC1B1W,KAAK2W,iBAAmB,QACxB3W,KAAK4W,kBAAoB,QAEzB5W,KAAK6W,UAAW,EAChB7W,KAAK8N,cAAe,EACpB9N,KAAK+N,cAAe,EAEpB/N,KAAK8W,UAAWjG,GA0EjB,QAASoiB,IAAsBpiB,GAE9BmiB,GAAqB1uB,KAAMtE,MAE3BA,KAAKgX,SAAY+sD,SAAY,IAE7B/jE,KAAKyB,KAAO,uBAEZzB,KAAKuW,aAAe,GAEpBvW,KAAK2mD,UAAY,EACjB3mD,KAAK4mD,mBAAqB,EAE1B5mD,KAAK8W,UAAWjG,GA2EjB,QAASiiB,IAAmBjiB,GAE3BwC,EAAS/O,KAAMtE,MAEfA,KAAKyB,KAAO,oBAEZzB,KAAKgN,MAAQ,GAAInH,GAAO,UACxB7F,KAAKmmD,SAAW,GAAItgD,GAAO,SAC3B7F,KAAKomD,UAAY,GAEjBpmD,KAAK6V,IAAM,KAEX7V,KAAK8V,SAAW,KAChB9V,KAAK+V,kBAAoB,EAEzB/V,KAAKgW,MAAQ,KACbhW,KAAKiW,eAAiB,EAEtBjW,KAAKmlD,SAAW,GAAIt/C,GAAO,GAC3B7F,KAAKolD,kBAAoB,EACzBplD,KAAKgvB,YAAc,KAEnBhvB,KAAKsrB,QAAU,KACftrB,KAAKqmD,UAAY,EAEjBrmD,KAAKurB,UAAY,KACjBvrB,KAAKm0B,cAAgB2vC,GACrB9jE,KAAKsmD,YAAc,GAAIzmD,GAAS,EAAG,GAEnCG,KAAKivB,gBAAkB,KACvBjvB,KAAK06B,kBAAoB,EACzB16B,KAAK26B,iBAAmB,EAExB36B,KAAKkW,YAAc,KAEnBlW,KAAKmW,SAAW,KAEhBnW,KAAKoW,OAAS,KACdpW,KAAKqW,QAAUC,GACftW,KAAKuW,aAAe,EACpBvW,KAAKwW,gBAAkB,IAEvBxW,KAAKyW,WAAY,EACjBzW,KAAK0W,mBAAqB,EAC1B1W,KAAK2W,iBAAmB,QACxB3W,KAAK4W,kBAAoB,QAEzB5W,KAAK6W,UAAW,EAChB7W,KAAK8N,cAAe,EACpB9N,KAAK+N,cAAe,EAEpB/N,KAAK8W,UAAWjG,GAsEjB,QAASkiB,IAAkBliB,GAE1BiiB,GAAkBxuB,KAAMtE,MAExBA,KAAKgX,SAAYgtD,KAAQ,IAEzBhkE,KAAKyB,KAAO,mBAEZzB,KAAKyvB,YAAc,KAEnBzvB,KAAK8W,UAAWjG,GA8CjB,QAAS+hB,IAAoB/hB,GAE5BwC,EAAS/O,KAAMtE,MAEfA,KAAKyB,KAAO,qBAEZzB,KAAKsrB,QAAU,KACftrB,KAAKqmD,UAAY,EAEjBrmD,KAAKurB,UAAY,KACjBvrB,KAAKm0B,cAAgB2vC,GACrB9jE,KAAKsmD,YAAc,GAAIzmD,GAAS,EAAG,GAEnCG,KAAKivB,gBAAkB,KACvBjvB,KAAK06B,kBAAoB,EACzB16B,KAAK26B,iBAAmB,EAExB36B,KAAKyW,WAAY,EACjBzW,KAAK0W,mBAAqB,EAE1B1W,KAAKuT,KAAM,EACXvT,KAAKwT,QAAS,EAEdxT,KAAK6W,UAAW,EAChB7W,KAAK8N,cAAe,EACpB9N,KAAK+N,cAAe,EAEpB/N,KAAK8W,UAAWjG,GAyEjB,QAASgiB,IAAqBhiB,GAE7BwC,EAAS/O,KAAMtE,MAEfA,KAAKyB,KAAO,sBAEZzB,KAAKgN,MAAQ,GAAInH,GAAO,UAExB7F,KAAK6V,IAAM,KAEX7V,KAAK8V,SAAW,KAChB9V,KAAK+V,kBAAoB,EAEzB/V,KAAKgW,MAAQ,KACbhW,KAAKiW,eAAiB,EAEtBjW,KAAKmlD,SAAW,GAAIt/C,GAAO,GAC3B7F,KAAKolD,kBAAoB,EACzBplD,KAAKgvB,YAAc,KAEnBhvB,KAAKkW,YAAc,KAEnBlW,KAAKmW,SAAW,KAEhBnW,KAAKoW,OAAS,KACdpW,KAAKqW,QAAUC,GACftW,KAAKuW,aAAe,EACpBvW,KAAKwW,gBAAkB,IAEvBxW,KAAKyW,WAAY,EACjBzW,KAAK0W,mBAAqB,EAC1B1W,KAAK2W,iBAAmB,QACxB3W,KAAK4W,kBAAoB,QAEzB5W,KAAK6W,UAAW,EAChB7W,KAAK8N,cAAe,EACpB9N,KAAK+N,cAAe,EAEpB/N,KAAK8W,UAAWjG,GAgEjB,QAASsiB,IAAoBtiB,GAE5BqiB,GAAkB5uB,KAAMtE,MAExBA,KAAKyB,KAAO,qBAEZzB,KAAK+K,MAAQ,EACb/K,KAAK0lD,SAAW,EAChB1lD,KAAK4lD,QAAU,EAEf5lD,KAAK8W,UAAWjG,GA2FjB,QAASozD,IAAgBC,EAAQC,EAAYC,GAE5C,GAAI5xD,GAAQxS,KAERqkE,GAAY,EACZC,EAAc,EACdC,EAAa,EACbC,EAAc1jE,MAKlBd,MAAKykE,QAAU3jE,OACfd,KAAKkkE,OAASA,EACdlkE,KAAKmkE,WAAaA,EAClBnkE,KAAKokE,QAAUA,EAEfpkE,KAAK0kE,UAAY,SAAWC,GAE3BJ,IAEKF,KAAc,GAEKvjE,SAAlB0R,EAAMiyD,SAEVjyD,EAAMiyD,QAASE,EAAKL,EAAaC,GAMnCF,GAAY,GAIbrkE,KAAK4kE,QAAU,SAAWD,GAEzBL,IAE0BxjE,SAArB0R,EAAM2xD,YAEV3xD,EAAM2xD,WAAYQ,EAAKL,EAAaC,GAIhCD,IAAgBC,IAEpBF,GAAY,EAEUvjE,SAAjB0R,EAAM0xD,QAEV1xD,EAAM0xD,WAQTlkE,KAAK6kE,UAAY,SAAWF,GAEJ7jE,SAAlB0R,EAAM4xD,SAEV5xD,EAAM4xD,QAASO,IAMjB3kE,KAAK8kE,WAAa,SAAWH,GAE5B,MAAKH,GAEGA,EAAaG,GAIdA,GAIR3kE,KAAK+kE,eAAiB,SAAWC,GAGhC,MADAR,GAAcQ,EACPhlE,MAcT,QAASilE,IAAYC,GAEpBllE,KAAKklE,QAAwBpkE,SAAZokE,EAA0BA,EAAUC,GAwTtD,QAASC,IAAyBF,GAEjCllE,KAAKklE,QAAwBpkE,SAAZokE,EAA0BA,EAAUC,GAGrDnlE,KAAKqlE,QAAU,KAiIhB,QAASC,IAAmBJ,GAE3BllE,KAAKklE,QAAwBpkE,SAAZokE,EAA0BA,EAAUC,GAGrDnlE,KAAKqlE,QAAU,KAkFhB,QAASE,IAAaL,GAErBllE,KAAKklE,QAAwBpkE,SAAZokE,EAA0BA,EAAUC,GAqGtD,QAASK,IAAmBN,GAE3BllE,KAAKklE,QAAwBpkE,SAAZokE,EAA0BA,EAAUC,GAqEtD,QAASM,IAAeP,GAEvBllE,KAAKklE,QAAwBpkE,SAAZokE,EAA0BA,EAAUC,GAyFtD,QAASO,MAER1lE,KAAKyB,KAAO,QAEZzB,KAAK2lE,mBAAqB,IA4X3B,QAASC,IAAcC,EAAIC,EAAIC,EAASC,EAASC,EAAaC,EAAWC,EAAYC,GAEpFV,GAAMphE,KAAMtE,MAEZA,KAAKyB,KAAO,eAEZzB,KAAK6lE,GAAKA,GAAM,EAChB7lE,KAAK8lE,GAAKA,GAAM,EAEhB9lE,KAAK+lE,QAAUA,GAAW,EAC1B/lE,KAAKgmE,QAAUA,GAAW,EAE1BhmE,KAAKimE,YAAcA,GAAe,EAClCjmE,KAAKkmE,UAAYA,GAAa,EAAIvzD,KAAKi+C,GAEvC5wD,KAAKmmE,WAAaA,IAAc,EAEhCnmE,KAAKomE,UAAYA,GAAa,EAuI/B,QAASC,IAAUR,EAAIC,EAAIQ,EAASL,EAAaC,EAAWC,GAE3DP,GAAathE,KAAMtE,KAAM6lE,EAAIC,EAAIQ,EAASA,EAASL,EAAaC,EAAWC,GAE3EnmE,KAAKyB,KAAO,WA+Bb,QAAS8kE,MAYR,QAAStnD,GAAMgyC,EAAIC,EAAIsV,EAAIC,GAE1BC,EAAKzV,EACL0V,EAAKH,EACLI,KAAW3V,EAAK,EAAIC,EAAK,EAAIsV,EAAKC,EAClCI,EAAK,EAAI5V,EAAK,EAAIC,EAAKsV,EAAKC,EAf7B,GAAIC,GAAK,EAAGC,EAAK,EAAGC,EAAK,EAAGC,EAAK,CAmBjC,QAECC,eAAgB,SAAW7V,EAAIC,EAAIC,EAAI4V,EAAIC,GAE1C/nD,EAAMiyC,EAAIC,EAAI6V,GAAY7V,EAAKF,GAAM+V,GAAYD,EAAK7V,KAIvD+V,yBAA0B,SAAWhW,EAAIC,EAAIC,EAAI4V,EAAIG,EAAKC,EAAKC,GAG9D,GAAIX,IAAOvV,EAAKD,GAAOiW,GAAQ/V,EAAKF,IAASiW,EAAMC,IAAUhW,EAAKD,GAAOiW,EACrEE,GAAOlW,EAAKD,GAAOiW,GAAQJ,EAAK7V,IAASiW,EAAMC,IAAUL,EAAK5V,GAAOiW,CAGzEX,IAAMU,EACNE,GAAMF,EAENloD,EAAMiyC,EAAIC,EAAIsV,EAAIY,IAInBC,KAAM,SAAWlV,GAEhB,GAAIiV,GAAKjV,EAAIA,EACTmV,EAAKF,EAAKjV,CACd,OAAOsU,GAAKC,EAAKvU,EAAIwU,EAAKS,EAAKR,EAAKU,IAavC,QAASC,IAAkBvlD,EAAQywC,EAAQ+U,EAAWT,GAErDtB,GAAMphE,KAAMtE,MAEZA,KAAKyB,KAAO,mBAEZzB,KAAKiiB,OAASA,MACdjiB,KAAK0yD,OAASA,IAAU,EACxB1yD,KAAKynE,UAAYA,GAAa,cAC9BznE,KAAKgnE,QAAUA,GAAW,GAsK3B,QAASU,IAAYtV,EAAG9sD,EAAIC,EAAIC,EAAIC,GAEnC,GAAIkiE,GAAmB,IAAZniE,EAAKF,GACZsiE,EAAmB,IAAZniE,EAAKF,GACZ8hE,EAAKjV,EAAIA,EACTmV,EAAKnV,EAAIiV,CACb,QAAS,EAAI9hE,EAAK,EAAIC,EAAKmiE,EAAKC,GAAOL,MAAahiE,EAAK,EAAIC,EAAK,EAAImiE,EAAKC,GAAOP,EAAKM,EAAKvV,EAAI7sD,EAMjG,QAASsiE,IAAmBzV,EAAGj9B,GAE9B,GAAI4H,GAAI,EAAIq1B,CACZ,OAAOr1B,GAAIA,EAAI5H,EAIhB,QAAS2yC,IAAmB1V,EAAGj9B,GAE9B,MAAO,IAAM,EAAIi9B,GAAMA,EAAIj9B,EAI5B,QAAS4yC,IAAmB3V,EAAGj9B,GAE9B,MAAOi9B,GAAIA,EAAIj9B,EAIhB,QAAS6yC,IAAiB5V,EAAG9sD,EAAIC,EAAIC,GAEpC,MAAOqiE,IAAmBzV,EAAG9sD,GAAOwiE,GAAmB1V,EAAG7sD,GACzDwiE,GAAmB3V,EAAG5sD,GAMxB,QAASyiE,IAAe7V,EAAGj9B,GAE1B,GAAI4H,GAAI,EAAIq1B,CACZ,OAAOr1B,GAAIA,EAAIA,EAAI5H,EAIpB,QAAS+yC,IAAe9V,EAAGj9B,GAE1B,GAAI4H,GAAI,EAAIq1B,CACZ,OAAO,GAAIr1B,EAAIA,EAAIq1B,EAAIj9B,EAIxB,QAASgzC,IAAe/V,EAAGj9B,GAE1B,MAAO,IAAM,EAAIi9B,GAAMA,EAAIA,EAAIj9B,EAIhC,QAASizC,IAAehW,EAAGj9B,GAE1B,MAAOi9B,GAAIA,EAAIA,EAAIj9B,EAIpB,QAASkzC,IAAajW,EAAG9sD,EAAIC,EAAIC,EAAIC,GAEpC,MAAOwiE,IAAe7V,EAAG9sD,GAAO4iE,GAAe9V,EAAG7sD,GAAO4iE,GAAe/V,EAAG5sD,GAC1E4iE,GAAehW,EAAG3sD,GAIpB,QAAS6iE,IAAkBX,EAAIC,EAAIW,EAAIC,GAEtC9C,GAAMphE,KAAMtE,MAEZA,KAAKyB,KAAO,mBAEZzB,KAAK2nE,GAAKA,GAAM,GAAI9nE,GACpBG,KAAK4nE,GAAKA,GAAM,GAAI/nE,GACpBG,KAAKuoE,GAAKA,GAAM,GAAI1oE,GACpBG,KAAKwoE,GAAKA,GAAM,GAAI3oE,GA+DrB,QAAS4oE,IAAmBd,EAAIC,EAAIW,EAAIC,GAEvC9C,GAAMphE,KAAMtE,MAEZA,KAAKyB,KAAO,oBAEZzB,KAAK2nE,GAAKA,GAAM,GAAI5mE,GACpBf,KAAK4nE,GAAKA,GAAM,GAAI7mE,GACpBf,KAAKuoE,GAAKA,GAAM,GAAIxnE,GACpBf,KAAKwoE,GAAKA,GAAM,GAAIznE,GAgErB,QAAS2nE,IAAWd,EAAIW,GAEvB7C,GAAMphE,KAAMtE,MAEZA,KAAKyB,KAAO,YAEZzB,KAAK4nE,GAAKA,GAAM,GAAI/nE,GACpBG,KAAKuoE,GAAKA,GAAM,GAAI1oE,GA6ErB,QAAS8oE,IAAYf,EAAIW,GAExB7C,GAAMphE,KAAMtE,MAEZA,KAAKyB,KAAO,aAEZzB,KAAK4nE,GAAKA,GAAM,GAAI7mE,GACpBf,KAAKuoE,GAAKA,GAAM,GAAIxnE,GAqErB,QAAS6nE,IAAsBjB,EAAIC,EAAIW,GAEtC7C,GAAMphE,KAAMtE,MAEZA,KAAKyB,KAAO,uBAEZzB,KAAK2nE,GAAKA,GAAM,GAAI9nE,GACpBG,KAAK4nE,GAAKA,GAAM,GAAI/nE,GACpBG,KAAKuoE,GAAKA,GAAM,GAAI1oE,GA4DrB,QAASgpE,IAAuBlB,EAAIC,EAAIW,GAEvC7C,GAAMphE,KAAMtE,MAEZA,KAAKyB,KAAO,wBAEZzB,KAAK2nE,GAAKA,GAAM,GAAI5mE,GACpBf,KAAK4nE,GAAKA,GAAM,GAAI7mE,GACpBf,KAAKuoE,GAAKA,GAAM,GAAIxnE,GA6DrB,QAAS+nE,IAAa7mD,GAErByjD,GAAMphE,KAAMtE,MAEZA,KAAKyB,KAAO,cAEZzB,KAAKiiB,OAASA,MA8Gf,QAAS8mD,MAERrD,GAAMphE,KAAMtE,MAEZA,KAAKyB,KAAO,YAEZzB,KAAKgpE,UACLhpE,KAAKipE,WAAY,EAoPlB,QAASC,IAAMjnD,GAEd8mD,GAAUzkE,KAAMtE,MAEhBA,KAAKyB,KAAO,OAEZzB,KAAKmpE,aAAe,GAAItpE,GAEnBoiB,GAEJjiB,KAAKopE,cAAennD,GAyKtB,QAASonD,IAAOpnD,GAEfinD,GAAK5kE,KAAMtE,KAAMiiB,GAEjBjiB,KAAKgC,KAAOC,GAAMC,eAElBlC,KAAKyB,KAAO,QAEZzB,KAAK68D,SAgGN,QAASyM,IAAOt8D,EAAO+qB,GAEtB7tB,EAAS5F,KAAMtE,MAEfA,KAAKyB,KAAO,QAEZzB,KAAKgN,MAAQ,GAAInH,GAAOmH,GACxBhN,KAAK+3B,UAA0Bj3B,SAAdi3B,EAA0BA,EAAY,EAEvD/3B,KAAK2L,cAAgB7K,OA+CtB,QAASyoE,IAAiBnyC,EAAUC,EAAaU,GAEhDuxC,GAAMhlE,KAAMtE,KAAMo3B,EAAUW,GAE5B/3B,KAAKyB,KAAO,kBAEZzB,KAAK0L,WAAa5K,OAElBd,KAAK8K,SAAS8T,KAAM1U,EAASU,WAC7B5K,KAAKwlD,eAELxlD,KAAKq3B,YAAc,GAAIxxB,GAAOwxB,GA0B/B,QAASmyC,IAAatwD,GAErBlZ,KAAKkZ,OAASA,EAEdlZ,KAAKu4B,KAAO,EACZv4B,KAAKiF,OAAS,EAEdjF,KAAKw4B,QAAU,GAAI34B,GAAS,IAAK,KAEjCG,KAAK6V,IAAM,KACX7V,KAAKiD,OAAS,GAAIhD,GA8CnB,QAASwpE,MAERD,GAAYllE,KAAMtE,KAAM,GAAIi2C,IAAmB,GAAI,EAAG,GAAK,MAmC5D,QAASyzB,IAAW18D,EAAO+qB,EAAWjB,EAAU+B,EAAOC,EAAU7B,GAEhEqyC,GAAMhlE,KAAMtE,KAAMgN,EAAO+qB,GAEzB/3B,KAAKyB,KAAO,YAEZzB,KAAK8K,SAAS8T,KAAM1U,EAASU,WAC7B5K,KAAKwlD,eAELxlD,KAAKigB,OAAS,GAAI/V,GAElBtI,OAAOC,eAAgB7B,KAAM,SAC5BqJ,IAAK,WAIJ,MAAOrJ,MAAK+3B,UAAYplB,KAAKi+C,IAG9B3qD,IAAK,SAAW0jE,GAIf3pE,KAAK+3B,UAAY4xC,EAAQh3D,KAAKi+C,MAKhC5wD,KAAK82B,SAA0Bh2B,SAAbg2B,EAA2BA,EAAW,EACxD92B,KAAK64B,MAAoB/3B,SAAV+3B,EAAwBA,EAAQlmB,KAAKi+C,GAAK,EACzD5wD,KAAK84B,SAA0Bh4B,SAAbg4B,EAA2BA,EAAW,EACxD94B,KAAKi3B,MAAoBn2B,SAAVm2B,EAAwBA,EAAQ,EAE/Cj3B,KAAK02B,OAAS,GAAI+yC,IAkCnB,QAASG,IAAY58D,EAAO+qB,EAAWjB,EAAUG,GAEhDqyC,GAAMhlE,KAAMtE,KAAMgN,EAAO+qB,GAEzB/3B,KAAKyB,KAAO,aAEZG,OAAOC,eAAgB7B,KAAM,SAC5BqJ,IAAK,WAIJ,MAAwB,GAAjBrJ,KAAK+3B,UAAgBplB,KAAKi+C,IAGlC3qD,IAAK,SAAW0jE,GAIf3pE,KAAK+3B,UAAY4xC,GAAU,EAAIh3D,KAAKi+C,OAKtC5wD,KAAK82B,SAA0Bh2B,SAAbg2B,EAA2BA,EAAW,EACxD92B,KAAKi3B,MAAoBn2B,SAAVm2B,EAAwBA,EAAQ,EAE/Cj3B,KAAK02B,OAAS,GAAI8yC,IAAa,GAAIvzB,IAAmB,GAAI,EAAG,GAAK,MA6BnE,QAAS4zB,MAERL,GAAYllE,KAAMtE,KAAM,GAAImM,QAAyB,EAAG,OAAQ,GAAK,MAetE,QAAS29D,IAAkB98D,EAAO+qB,GAEjCuxC,GAAMhlE,KAAMtE,KAAMgN,EAAO+qB,GAEzB/3B,KAAKyB,KAAO,mBAEZzB,KAAK8K,SAAS8T,KAAM1U,EAASU,WAC7B5K,KAAKwlD,eAELxlD,KAAKigB,OAAS,GAAI/V,GAElBlK,KAAK02B,OAAS,GAAImzC,IA4BnB,QAASE,IAAc/8D,EAAO+qB,GAE7BuxC,GAAMhlE,KAAMtE,KAAMgN,EAAO+qB,GAEzB/3B,KAAKyB,KAAO,eAEZzB,KAAK0L,WAAa5K,OAgBnB,QAASkpE,IAAeh9D,EAAO+qB,EAAWp0B,EAAOC,GAEhD0lE,GAAMhlE,KAAMtE,KAAMgN,EAAO+qB,GAEzB/3B,KAAKyB,KAAO,gBAEZzB,KAAK2D,MAAoB7C,SAAV6C,EAAwBA,EAAQ,GAC/C3D,KAAK4D,OAAsB9C,SAAX8C,EAAyBA,EAAS,GA4NnD,QAASqmE,IAAaC,EAAoBC,EAAcC,EAAYC,GAEnErqE,KAAKkqE,mBAAqBA,EAC1BlqE,KAAKsqE,aAAe,EAEpBtqE,KAAKqqE,aAAgCvpE,SAAjBupE,EACnBA,EAAe,GAAIF,GAAaI,YAAaH,GAC9CpqE,KAAKmqE,aAAeA,EACpBnqE,KAAKwqE,UAAYJ,EA6OlB,QAASK,IAAkBP,EAAoBC,EAAcC,EAAYC,GAExEJ,GAAY3lE,KAAMtE,KAAMkqE,EAAoBC,EAAcC,EAAYC,GAEtErqE,KAAK0qE,eACL1qE,KAAK2qE,eACL3qE,KAAK4qE,eACL5qE,KAAK6qE,eAyIN,QAASC,IAAmBZ,EAAoBC,EAAcC,EAAYC,GAEzEJ,GAAY3lE,KAAMtE,KAAMkqE,EAAoBC,EAAcC,EAAYC,GA0CvE,QAASU,IAAqBb,EAAoBC,EAAcC,EAAYC,GAE3EJ,GAAY3lE,KAAMtE,KAAMkqE,EAAoBC,EAAcC,EAAYC,GA0BvE,QAASW,IAAe7oE,EAAM8oE,EAAOC,EAAQC,GAE5C,GAAcrqE,SAATqB,EAAqB,KAAM,IAAImoB,OAAO,+CAC3C,IAAexpB,SAAVmqE,GAAwC,IAAjBA,EAAM7qE,OAAe,KAAM,IAAIkqB,OAAO,oDAAsDnoB,EAExHnC,MAAKmC,KAAOA,EAEZnC,KAAKirE,MAAQG,GAAeC,aAAcJ,EAAOjrE,KAAKsrE,gBACtDtrE,KAAKkrE,OAASE,GAAeC,aAAcH,EAAQlrE,KAAKurE,iBAExDvrE,KAAKwrE,iBAAkBL,GAAiBnrE,KAAKyrE,sBAib9C,QAASC,IAAsBvpE,EAAM8oE,EAAOC,GAE3CF,GAAc1mE,KAAMtE,KAAMmC,EAAM8oE,EAAOC,GAgCxC,QAASS,IAAoBxpE,EAAM8oE,EAAOC,EAAQC,GAEjDH,GAAc1mE,KAAMtE,KAAMmC,EAAM8oE,EAAOC,EAAQC,GA4BhD,QAASS,IAAqBzpE,EAAM8oE,EAAOC,EAAQC,GAElDH,GAAc1mE,KAAMtE,KAAMmC,EAAM8oE,EAAOC,EAAQC,GAsBhD,QAASU,IAA6B3B,EAAoBC,EAAcC,EAAYC,GAEnFJ,GAAY3lE,KAAMtE,KAAMkqE,EAAoBC,EAAcC,EAAYC,GAuCvE,QAASyB,IAAyB3pE,EAAM8oE,EAAOC,EAAQC,GAEtDH,GAAc1mE,KAAMtE,KAAMmC,EAAM8oE,EAAOC,EAAQC,GAkChD,QAASY,IAAqB5pE,EAAM8oE,EAAOC,EAAQC,GAElDH,GAAc1mE,KAAMtE,KAAMmC,EAAM8oE,EAAOC,EAAQC,GA6BhD,QAASa,IAAqB7pE,EAAM8oE,EAAOC,EAAQC,GAElDH,GAAc1mE,KAAMtE,KAAMmC,EAAM8oE,EAAOC,EAAQC,GAwBhD,QAASc,IAAe9pE,EAAM+pE,EAAUC,GAEvCnsE,KAAKmC,KAAOA,EACZnC,KAAKmsE,OAASA,EACdnsE,KAAKksE,SAA0BprE,SAAborE,EAA2BA,KAE7ClsE,KAAKgC,KAAOC,GAAMC,eAGblC,KAAKksE,SAAW,GAEpBlsE,KAAKosE,gBAMP,QAASC,IAA8BC,GAEtC,OAASA,EAASC,eAEjB,IAAK,SACL,IAAK,SACL,IAAK,QACL,IAAK,SACL,IAAK,UAEJ,MAAOX,GAER,KAAK,SACL,IAAK,UACL,IAAK,UACL,IAAK,UAEJ,MAAOI,GAER,KAAK,QAEJ,MAAOL,GAER,KAAK,aAEJ,MAAOG,GAER,KAAK,OACL,IAAK,UAEJ,MAAOJ,GAER,KAAK,SAEJ,MAAOK,IAIT,KAAM,IAAIzhD,OAAO,8CAAgDgiD,GAIlE,QAASE,IAAoBC,GAE5B,GAAmB3rE,SAAd2rE,EAAKhrE,KAET,KAAM,IAAI6oB,OAAO,2DAIlB,IAAIoiD,GAAYL,GAA8BI,EAAKhrE,KAEnD,IAAoBX,SAAf2rE,EAAKxB,MAAsB,CAE/B,GAAIA,MAAYC,IAEhBE,IAAeuB,YAAaF,EAAK9d,KAAMsc,EAAOC,EAAQ,SAEtDuB,EAAKxB,MAAQA,EACbwB,EAAKvB,OAASA,EAKf,MAAyBpqE,UAApB4rE,EAAUE,MAEPF,EAAUE,MAAOH,GAKjB,GAAIC,GAAWD,EAAKtqE,KAAMsqE,EAAKxB,MAAOwB,EAAKvB,OAAQuB,EAAKtB,eA6VjE,QAAS0B,IAAgB3H,GAExBllE,KAAKklE,QAAwBpkE,SAAZokE,EAA0BA,EAAUC,GACrDnlE,KAAKmiB,YAmNN,QAAS2qD,IAAsB5H,GAE9BllE,KAAKklE,QAAwBpkE,SAAZokE,EAA0BA,EAAUC,GAgGtD,QAAS4H,OA2WT,QAASC,IAAY9H,GAEI,iBAAZA,KAEX7kE,QAAQ4H,KAAM,6EACdi9D,EAAUpkE,QAIXd,KAAKklE,QAAwBpkE,SAAZokE,EAA0BA,EAAUC,GAErDnlE,KAAKitE,iBAAkB,EAyiBxB,QAASC,IAAchI,GAEtBllE,KAAKklE,QAAwBpkE,SAAZokE,EAA0BA,EAAUC,GACrDnlE,KAAKmtE,YAAc,GAg5BpB,QAASC,IAAmBlI,GAEO,mBAAtBmI,oBAEXhtE,QAAQ4H,KAAM,+DAIO,mBAAVqlE,QAEXjtE,QAAQ4H,KAAM,mDAIfjI,KAAKklE,QAAsBpkE,SAAZokE,EAAwBA,EAAUC,GACjDnlE,KAAK6D,QAAU/C,OA2FhB,QAASysE,MAERvtE,KAAKyB,KAAO,YAEZzB,KAAKgN,MAAQ,GAAInH,GAEjB7F,KAAKwtE,YACLxtE,KAAKytE,YAAc,KAiRpB,QAASC,IAAMhpE,GAEd1E,KAAKyB,KAAO,OAEZzB,KAAK0E,KAAOA,EA2Bb,QAASipE,IAAanO,EAAMv4C,EAAMviB,GAUjC,IAAM,GARFkpE,GAAQxgE,MAAMygE,KAAOzgE,MAAMygE,KAAMrO,GAASsO,OAAQtO,GAAOn2C,MAAO,IAChEte,EAAQkc,EAAOviB,EAAKqpE,WACpBC,GAAgBtpE,EAAKyJ,YAAY8/D,KAAOvpE,EAAKyJ,YAAY+/D,KAAOxpE,EAAKypE,oBAAuBpjE,EAE5FqjE,KAEAC,EAAU,EAAGC,EAAU,EAEjBt+D,EAAI,EAAGA,EAAI49D,EAAMxtE,OAAQ4P,IAAO,CAEzC,GAAIu+D,GAAOX,EAAO59D,EAElB,IAAc,OAATu+D,EAEJF,EAAU,EACVC,GAAWN,MAEL,CAEN,GAAIQ,GAAMC,GAAYF,EAAMxjE,EAAOsjE,EAASC,EAAS5pE,EACrD2pE,IAAWG,EAAIH,QACfD,EAAMh8D,KAAMo8D,EAAIpmD,OAMlB,MAAOgmD,GAIR,QAASK,IAAYF,EAAMxjE,EAAOsjE,EAASC,EAAS5pE,GAEnD,GAAIgqE,GAAQhqE,EAAKiqE,OAAQJ,IAAU7pE,EAAKiqE,OAAQ,IAEhD,IAAOD,EAAP,CAEA,GAEI5uE,GAAGC,EAAG6uE,EAAKC,EAAKC,EAAMC,EAAMC,EAAMC,EAFlC7mD,EAAO,GAAImlD,GAIf,IAAKmB,EAAMvgB,EAIV,IAAM,GAFF+gB,GAAUR,EAAMS,iBAAoBT,EAAMS,eAAiBT,EAAMvgB,EAAE9kC,MAAO,MAEpErZ,EAAI,EAAGC,EAAIi/D,EAAQ9uE,OAAQ4P,EAAIC,GAAK,CAE7C,GAAIm/D,GAASF,EAASl/D,IAEtB,QAASo/D,GAER,IAAK,IAEJtvE,EAAIovE,EAASl/D,KAASjF,EAAQsjE,EAC9BtuE,EAAImvE,EAASl/D,KAASjF,EAAQujE,EAE9BlmD,EAAKinD,OAAQvvE,EAAGC,EAEhB,MAED,KAAK,IAEJD,EAAIovE,EAASl/D,KAASjF,EAAQsjE,EAC9BtuE,EAAImvE,EAASl/D,KAASjF,EAAQujE,EAE9BlmD,EAAKknD,OAAQxvE,EAAGC,EAEhB,MAED,KAAK,IAEJ6uE,EAAMM,EAASl/D,KAASjF,EAAQsjE,EAChCQ,EAAMK,EAASl/D,KAASjF,EAAQujE,EAChCQ,EAAOI,EAASl/D,KAASjF,EAAQsjE,EACjCU,EAAOG,EAASl/D,KAASjF,EAAQujE,EAEjClmD,EAAKmnD,iBAAkBT,EAAMC,EAAMH,EAAKC,EAExC,MAED,KAAK,IAEJD,EAAMM,EAASl/D,KAASjF,EAAQsjE,EAChCQ,EAAMK,EAASl/D,KAASjF,EAAQujE,EAChCQ,EAAOI,EAASl/D,KAASjF,EAAQsjE,EACjCU,EAAOG,EAASl/D,KAASjF,EAAQujE,EACjCU,EAAOE,EAASl/D,KAASjF,EAAQsjE,EACjCY,EAAOC,EAASl/D,KAASjF,EAAQujE,EAEjClmD,EAAKonD,cAAeV,EAAMC,EAAMC,EAAMC,EAAML,EAAKC,IAUrD,OAASR,QAASK,EAAMe,GAAK1kE,EAAOqd,KAAMA,IAQ3C,QAASsnD,IAAYxK,GAEpBllE,KAAKklE,QAAwBpkE,SAAZokE,EAA0BA,EAAUC,GAkFtD,QAASwK,IAAazK,GAErBllE,KAAKklE,QAAwBpkE,SAAZokE,EAA0BA,EAAUC,GAiCtD,QAASyK,MAER5vE,KAAKyB,KAAO,eAEZzB,KAAKm2C,OAAS,EAEdn2C,KAAK6vE,OAAS,KAEd7vE,KAAKm5C,QAAU,GAAIlD,IACnBj2C,KAAKm5C,QAAQ3tC,OAAO+0B,OAAQ,GAC5BvgC,KAAKm5C,QAAQn2C,kBAAmB,EAEhChD,KAAKq5C,QAAU,GAAIpD,IACnBj2C,KAAKq5C,QAAQ7tC,OAAO+0B,OAAQ,GAC5BvgC,KAAKq5C,QAAQr2C,kBAAmB,EAiFjC,QAAS8sE,IAAYtjE,EAAMC,EAAKsjE,GAE/B7lE,EAAS5F,KAAMtE,MAEfA,KAAKyB,KAAO,YAEZ,IAAIy0C,GAAM,GAAIC,EAAS,EAEnB65B,EAAW,GAAI/5B,IAAmBC,EAAKC,EAAQ3pC,EAAMC,EACzDujE,GAASrlE,GAAG1E,IAAK,KAAQ,GACzB+pE,EAAShxC,OAAQ,GAAIj+B,GAAS,EAAG,EAAG,IACpCf,KAAKq/B,IAAK2wC,EAEV,IAAIC,GAAW,GAAIh6B,IAAmBC,EAAKC,EAAQ3pC,EAAMC,EACzDwjE,GAAStlE,GAAG1E,IAAK,KAAQ,GACzBgqE,EAASjxC,OAAQ,GAAIj+B,QAAc,EAAG,IACtCf,KAAKq/B,IAAK4wC,EAEV,IAAIC,GAAW,GAAIj6B,IAAmBC,EAAKC,EAAQ3pC,EAAMC,EACzDyjE,GAASvlE,GAAG1E,IAAK,EAAG,EAAG,GACvBiqE,EAASlxC,OAAQ,GAAIj+B,GAAS,EAAG,EAAG,IACpCf,KAAKq/B,IAAK6wC,EAEV,IAAIC,GAAW,GAAIl6B,IAAmBC,EAAKC,EAAQ3pC,EAAMC,EACzD0jE,GAASxlE,GAAG1E,IAAK,EAAG,MACpBkqE,EAASnxC,OAAQ,GAAIj+B,GAAS,OAAQ,IACtCf,KAAKq/B,IAAK8wC,EAEV,IAAIC,GAAW,GAAIn6B,IAAmBC,EAAKC,EAAQ3pC,EAAMC,EACzD2jE,GAASzlE,GAAG1E,IAAK,KAAQ,GACzBmqE,EAASpxC,OAAQ,GAAIj+B,GAAS,EAAG,EAAG,IACpCf,KAAKq/B,IAAK+wC,EAEV,IAAIC,GAAW,GAAIp6B,IAAmBC,EAAKC,EAAQ3pC,EAAMC,EACzD4jE,GAAS1lE,GAAG1E,IAAK,KAAQ,GACzBoqE,EAASrxC,OAAQ,GAAIj+B,GAAS,EAAG,SACjCf,KAAKq/B,IAAKgxC,EAEV,IAAIxsE,IAAYrC,OAAQmsC,GAAWrsC,UAAWkB,GAAcjB,UAAWiB,GAEvExC,MAAK8rC,aAAe,GAAIznC,GAAuB0rE,EAAgBA,EAAgBlsE,GAC/E7D,KAAK8rC,aAAa7nC,QAAQ9B,KAAO,aAEjCnC,KAAK0J,OAAS,SAAWkP,EAAUK,GAEb,OAAhBjZ,KAAKyK,QAAkBzK,KAAKi/B,mBAEjC,IAAI6M,GAAe9rC,KAAK8rC,aACpB5oC,EAAkB4oC,EAAa7nC,QAAQf,eAE3C4oC,GAAa7nC,QAAQf,iBAAkB,EAEvC4oC,EAAavnC,eAAiB,EAC9BqU,EAASG,OAAQE,EAAO+2D,EAAUlkC,GAElCA,EAAavnC,eAAiB,EAC9BqU,EAASG,OAAQE,EAAOg3D,EAAUnkC,GAElCA,EAAavnC,eAAiB,EAC9BqU,EAASG,OAAQE,EAAOi3D,EAAUpkC,GAElCA,EAAavnC,eAAiB,EAC9BqU,EAASG,OAAQE,EAAOk3D,EAAUrkC,GAElCA,EAAavnC,eAAiB,EAC9BqU,EAASG,OAAQE,EAAOm3D,EAAUtkC,GAElCA,EAAa7nC,QAAQf,gBAAkBA,EAEvC4oC,EAAavnC,eAAiB,EAC9BqU,EAASG,OAAQE,EAAOo3D,EAAUvkC,GAElClzB,EAASumB,gBAAiB,OAI3Bn/B,KAAKyZ,MAAQ,SAAWb,EAAU5L,EAAOyD,EAAOqyB,GAI/C,IAAM,GAFFgJ,GAAe9rC,KAAK8rC,aAEd97B,EAAI,EAAGA,EAAI,EAAGA,IAEvB87B,EAAavnC,eAAiByL,EAC9B4I,EAASumB,gBAAiB2M,GAE1BlzB,EAASa,MAAOzM,EAAOyD,EAAOqyB,EAI/BlqB,GAASumB,gBAAiB,OAa5B,QAASmxC,MAERpmE,EAAS5F,KAAMtE,MAEfA,KAAKyB,KAAO,gBAEZzB,KAAKyG,QAAU8pE,GAAa7mC,aAE5B1pC,KAAKwwE,KAAOxwE,KAAKyG,QAAQgqE,aACzBzwE,KAAKwwE,KAAKE,QAAS1wE,KAAKyG,QAAQkqE,aAEhC3wE,KAAKyrB,OAAS,KAuHf,QAASmlD,IAAOC,GAEf3mE,EAAS5F,KAAMtE,MAEfA,KAAKyB,KAAO,QAEZzB,KAAKyG,QAAUoqE,EAASpqE,QAExBzG,KAAKwwE,KAAOxwE,KAAKyG,QAAQgqE,aACzBzwE,KAAKwwE,KAAKE,QAASG,EAASC,YAE5B9wE,KAAK+wE,UAAW,EAEhB/wE,KAAK0H,OAAS,KACd1H,KAAKgxE,MAAO,EACZhxE,KAAKixE,UAAY,EACjBjxE,KAAK4C,OAAS,EACd5C,KAAKkxE,aAAe,EACpBlxE,KAAKmxE,WAAY,EACjBnxE,KAAKoxE,oBAAqB,EAC1BpxE,KAAKqxE,WAAa,QAElBrxE,KAAKsxE,WAqSN,QAASC,IAAiBV,GAEzBD,GAAMtsE,KAAMtE,KAAM6wE,GAElB7wE,KAAKwxE,OAASxxE,KAAKyG,QAAQgrE,eAC3BzxE,KAAKwxE,OAAOd,QAAS1wE,KAAKwwE,MA+G3B,QAASkB,IAAeC,EAAOC,GAE9B5xE,KAAK6xE,SAAWF,EAAMlrE,QAAQqrE,iBAC9B9xE,KAAK6xE,SAASD,QAAsB9wE,SAAZ8wE,EAAwBA,EAAU,KAE1D5xE,KAAK0E,KAAO,GAAIkE,YAAY5I,KAAK6xE,SAASE,mBAE1CJ,EAAMK,YAAYtB,QAAS1wE,KAAK6xE,UAwCjC,QAASI,IAAeC,EAAS5F,EAAU9B,GAE1CxqE,KAAKkyE,QAAUA,EACflyE,KAAKwqE,UAAYA,CAEjB,IACC2H,GADG/qE,EAAaY,YAGjB,QAASskE,GAER,IAAK,aACJ6F,EAAcnyE,KAAKoyE,MACnB,MAED,KAAK,SACL,IAAK,OACJhrE,EAAagG,MACb+kE,EAAcnyE,KAAKqyE,OACnB,MAED,SACCF,EAAcnyE,KAAKsyE,MAIrBtyE,KAAK0H,OAAS,GAAIN,GAAwB,EAAZojE,GAY9BxqE,KAAKuyE,iBAAmBJ,EAExBnyE,KAAKwyE,iBAAmB,EAExBxyE,KAAKyyE,SAAW,EAChBzyE,KAAK0yE,eAAiB,EAsKvB,QAASC,IAAWC,EAAaxqD,EAAMyqD,GAEtC,GAAIC,GAAaD,GAAsBE,GAAgBC,eAAgB5qD,EAEvEpoB,MAAKizE,aAAeL,EACpB5yE,KAAKkzE,UAAYN,EAAYO,WAAY/qD,EAAM0qD,GA4DhD,QAASC,IAAiBK,EAAUhrD,EAAM0qD,GAEzC9yE,KAAKooB,KAAOA,EACZpoB,KAAK8yE,WAAaA,GAAcC,GAAgBC,eAAgB5qD,GAEhEpoB,KAAKqzE,KAAON,GAAgBO,SAAUF,EAAUpzE,KAAK8yE,WAAWS,WAAcH,EAE9EpzE,KAAKozE,SAAWA,EA+pBjB,QAASI,MAERxzE,KAAKgC,KAAOC,GAAMC,eAGlBlC,KAAKi7B,SAAW7tB,MAAMqmE,UAAU5mB,MAAMvoD,KAAMnE,WAE5CH,KAAK0zE,gBAAkB,CAGvB,IAAInhE,KACJvS,MAAK2zE,eAAiBphE,CAEtB,KAAM,GAAIvC,GAAI,EAAGgU,EAAI7jB,UAAUC,OAAQ4P,IAAMgU,IAAMhU,EAElDuC,EAASpS,UAAW6P,GAAIhO,MAASgO,CAIlChQ,MAAK4zE,UACL5zE,KAAK6zE,gBACL7zE,KAAKkzE,aACLlzE,KAAK8zE,yBAEL,IAAIthE,GAAQxS,IAEZA,MAAK+zE,OAEJj7D,SACCk7D,GAAIA,SAEH,MAAOxhE,GAAMyoB,SAAS76B,QAGvB6zE,GAAIA,SAEH,MAAOj0E,MAAKg0E,MAAQxhE,EAAMkhE,kBAI5BQ,GAAIA,qBAEH,MAAO1hE,GAAM0gE,UAAU9yE,SA0T1B,QAAS+zE,IAAiBC,EAAOC,EAAMC,GAEtCt0E,KAAKu0E,OAASH,EACdp0E,KAAKw0E,MAAQH,EACbr0E,KAAKy0E,WAAaH,GAAa,IAW/B,KAAM,GATFnI,GAASkI,EAAKlI,OACjBuI,EAAUvI,EAAO/rE,OACjBu0E,EAAe,GAAIvnE,OAAOsnE,GAEvBE,GACHC,YAAaC,GACbC,UAAWD,IAGF9kE,EAAI,EAAGA,IAAM0kE,IAAY1kE,EAAI,CAEtC,GAAIglE,GAAc7I,EAAQn8D,GAAIilE,kBAAmB,KACjDN,GAAc3kE,GAAMglE,EACpBA,EAAYE,SAAWN,EAIxB50E,KAAKm1E,qBAAuBP,EAE5B50E,KAAKo1E,cAAgBT,EAGrB30E,KAAKq1E,kBAAoB,GAAIjoE,OAAOsnE,GAEpC10E,KAAKs1E,YAAc,KACnBt1E,KAAKu1E,kBAAoB,KAEzBv1E,KAAKw1E,sBAAwB,KAC7Bx1E,KAAKy1E,mBAAqB,KAE1Bz1E,KAAKgxE,KAAO0E,GACZ11E,KAAK21E,cAIL31E,KAAK41E,WAAa,KAIlB51E,KAAKqG,KAAO,EAEZrG,KAAK61E,UAAY,EACjB71E,KAAK81E,oBAAsB,EAE3B91E,KAAK+1E,OAAS,EACd/1E,KAAKg2E,iBAAmB,EAExBh2E,KAAKi2E,YAAclxE,EAAAA,EAEnB/E,KAAKk2E,QAAS,EACdl2E,KAAKmf,SAAU,EAEfnf,KAAKm2E,mBAAqB,EAE1Bn2E,KAAKo2E,kBAAoB,EACzBp2E,KAAKq2E,gBAAkB,EA8lBxB,QAASC,IAAgBC,GAExBv2E,KAAKw2E,MAAQD,EACbv2E,KAAKy2E,qBACLz2E,KAAK02E,WAAa,EAElB12E,KAAKqG,KAAO,EAEZrG,KAAK61E,UAAY,EAkuBlB,QAASc,IAAS70E,GAEK,gBAAVA,KAEXzB,QAAQ4H,KAAM,sDACdnG,EAAQ3B,UAAW,IAIpBH,KAAK8B,MAAQA,EAcd,QAAS80E,MAER1mE,EAAe5L,KAAMtE,MAErBA,KAAKyB,KAAO,0BACZzB,KAAKwb,kBAAoB1a,OAgC1B,QAAS+1E,IAA4BxvE,EAAOu3C,EAAQhb,GAEnDwoB,GAAkB9nD,KAAMtE,KAAMqH,EAAOu3C,GAErC5+C,KAAK4jC,iBAAmBA,GAAoB,EA0B7C,QAASkzC,IAA0BzvE,EAAOwH,EAAU+0B,GAEnDh1B,EAAgBtK,KAAMtE,KAAMqH,EAAOwH,GAEnC7O,KAAK4jC,iBAAmBA,GAAoB,EA4B7C,QAASmzC,IAAW9+D,EAAQC,EAAW1L,EAAMC,GAE5CzM,KAAKg3E,IAAM,GAAIh/D,GAAKC,EAAQC,GAG5BlY,KAAKwM,KAAOA,GAAQ,EACpBxM,KAAKyM,IAAMA,GAAO1H,EAAAA,EAElB/E,KAAKi3E,QACJ7+D,QACAq1C,QACAhB,OACAmB,QAAUspB,UAAW,GACrB3qB,WAGD3qD,OAAOqJ,iBAAkBjL,KAAKi3E,QAC7BE,YACC9tE,IAAK,WAGJ,MADAhJ,SAAQ4H,KAAM,yEACPjI,KAAK4tD,WAQhB,QAASwpB,IAAStqE,EAAG9G,GAEpB,MAAO8G,GAAEgqB,SAAW9wB,EAAE8wB,SAIvB,QAASugD,IAAiB72D,EAAQ82D,EAAWxgB,EAAYygB,GAExD,GAAK/2D,EAAO/U,WAAY,IAExB+U,EAAOg3D,QAASF,EAAWxgB,GAEtBygB,KAAc,GAIlB,IAAM,GAFF7sE,GAAW8V,EAAO9V,SAEZsF,EAAI,EAAGC,EAAIvF,EAAStK,OAAQ4P,EAAIC,EAAGD,IAE5CqnE,GAAiB3sE,EAAUsF,GAAKsnE,EAAWxgB,GAAY,GAiF1D,QAAS2gB,IAAOC,GAEf13E,KAAK03E,UAA4B52E,SAAd42E,GAA4BA,EAE/C13E,KAAKixE,UAAY,EACjBjxE,KAAK23E,QAAU,EACf33E,KAAK43E,YAAc,EAEnB53E,KAAK63E,SAAU,EAqEhB,QAASC,IAAW7yE,EAAQo8D,EAAK4B,GAMhC,MAJAjjE,MAAKiF,OAAsBnE,SAAXmE,EAAyBA,EAAS,EAClDjF,KAAKqhE,IAAgBvgE,SAARugE,EAAsBA,EAAM,EACzCrhE,KAAKijE,MAAoBniE,SAAVmiE,EAAwBA,EAAQ,EAExCjjE,KA6ER,QAAS+3E,IAAa9yE,EAAQg+D,EAAOljE,GAMpC,MAJAC,MAAKiF,OAAsBnE,SAAXmE,EAAyBA,EAAS,EAClDjF,KAAKijE,MAAoBniE,SAAVmiE,EAAwBA,EAAQ,EAC/CjjE,KAAKD,EAAYe,SAANf,EAAoBA,EAAI,EAE5BC,KAsDR,QAASg4E,IAAMnzE,EAAKC,GAEnB9E,KAAK6E,IAAgB/D,SAAR+D,EAAsBA,EAAM,GAAIhF,MAAWkF,EAAAA,OAAYA,EAAAA,KACpE/E,KAAK8E,IAAgBhE,SAARgE,EAAsBA,EAAM,GAAIjF,MAAWkF,EAAAA,OAAYA,EAAAA,KA6OrE,QAASkzE,IAAOtxE,EAAOomB,GAEtB/sB,KAAK2G,MAAoB7F,SAAV6F,EAAwBA,EAAQ,GAAI5F,GACnDf,KAAK+sB,IAAgBjsB,SAARisB,EAAsBA,EAAM,GAAIhsB,GAgJ9C,QAASm3E,IAAuB5/D,GAE/BpO,EAAS5F,KAAMtE,MAEfA,KAAKsY,SAAWA,EAChBtY,KAAK+Y,OAAS,aAcf,QAASo/D,IAAqB33D,EAAQyG,EAAMmxD,EAAKhhE,GAEhDpX,KAAKwgB,OAASA,EAEdxgB,KAAKinB,KAAkBnmB,SAATmmB,EAAuBA,EAAO,CAE5C,IAAIja,GAAkBlM,SAARs3E,EAAsBA,EAAM,SAEtCz0E,EAAwB7C,SAAdsW,EAA4BA,EAAY,EAIlDihE,EAAW,EAEXC,EAAct4E,KAAKwgB,OAAOnI,QAEzBigE,IAAeA,EAAY33D,WAE/B03D,EAAsC,EAA3BC,EAAY1qE,MAAMxN,OAElBk4E,GAAeA,EAAY53D,mBAEtC23D,EAAWC,EAAYjoE,WAAWlL,OAAO+D,MAM1C,IAAImP,GAAW,GAAInI,GAEfqoE,EAAY,GAAI/oE,GAAmC,EAAX6oE,EAAe,EAAG,EAE9DhgE,GAASvF,aAAc,WAAYylE,GAEnC7qB,GAAappD,KAAMtE,KAAMqY,EAAU,GAAI6a,KAAqBlmB,MAAOA,EAAOoK,UAAWzT,KAIrF3D,KAAKgD,kBAAmB,EAExBhD,KAAK0J,SAyGN,QAAS8uE,IAAiB/hD,EAAOzpB,GAEhC9C,EAAS5F,KAAMtE,MAEfA,KAAKy2B,MAAQA,EACbz2B,KAAKy2B,MAAMwI,oBAEXj/B,KAAKiD,OAASwzB,EAAMprB,YACpBrL,KAAKgD,kBAAmB,EAExBhD,KAAKgN,MAAQA,CAYb,KAAM,GAVFqL,GAAW,GAAInI,GAEfqoE,GACH,EAAG,EAAG,EAAI,EAAG,EAAG,EAChB,EAAG,EAAG,EAAI,EAAG,EAAG,EAChB,EAAG,EAAG,KAAQ,EAAG,EACjB,EAAG,EAAG,EAAI,EAAG,EAAG,EAChB,EAAG,EAAG,EAAI,KAAQ,GAGTvoE,EAAI,EAAGy9B,EAAI,EAAGx9B,EAAI,GAAID,EAAIC,EAAGD,IAAMy9B,IAAO,CAEnD,GAAIloC,GAAOyK,EAAIC,EAAM0C,KAAKi+C,GAAK,EAC3BprD,EAAOioC,EAAIx9B,EAAM0C,KAAKi+C,GAAK,CAE/B2nB,GAAUnmE,KACTO,KAAKimB,IAAKrzB,GAAMoN,KAAK6gD,IAAKjuD,GAAM,EAChCoN,KAAKimB,IAAKpzB,GAAMmN,KAAK6gD,IAAKhuD,GAAM,GAKlC6S,EAASvF,aAAc,WAAY,GAAItD,GAAwB+oE,EAAW,GAE1E,IAAIjgE,GAAW,GAAI4a,KAAqB3f,KAAK,GAE7CvT,MAAKy4E,KAAO,GAAI/qB,IAAcr1C,EAAUC,GACxCtY,KAAKq/B,IAAKr/B,KAAKy4E,MAEfz4E,KAAK0J,SAuDN,QAASgvE,IAAal4D,GAErB,GAAIm4D,KAECn4D,IAAUA,EAAOo4D,QAErBD,EAASvmE,KAAMoO,EAIhB,KAAM,GAAIxQ,GAAI,EAAGA,EAAIwQ,EAAO9V,SAAStK,OAAQ4P,IAE5C2oE,EAASvmE,KAAKq2B,MAAOkwC,EAAUD,GAAal4D,EAAO9V,SAAUsF,IAI9D,OAAO2oE,GAIR,QAASE,IAAgBr4D,GAYxB,IAAM,GAVF2R,GAAQumD,GAAal4D,GAErBnI,EAAW,GAAInI,GAEfxC,KACAC,KAEAmrE,EAAS,GAAIjzE,GAAO,EAAG,EAAG,GAC1BkzE,EAAS,GAAIlzE,GAAO,EAAG,EAAG,GAEpBmK,EAAI,EAAGA,EAAImiB,EAAM/xB,OAAQ4P,IAAO,CAEzC,GAAIgpE,GAAO7mD,EAAOniB,EAEbgpE,GAAKvuE,QAAUuuE,EAAKvuE,OAAOmuE,SAE/BlrE,EAAS0E,KAAM,EAAG,EAAG,GACrB1E,EAAS0E,KAAM,EAAG,EAAG,GACrBzE,EAAOyE,KAAM0mE,EAAOhzE,EAAGgzE,EAAO/yE,EAAG+yE,EAAO9yE,GACxC2H,EAAOyE,KAAM2mE,EAAOjzE,EAAGizE,EAAOhzE,EAAGgzE,EAAO/yE,IAM1CqS,EAASvF,aAAc,WAAY,GAAItD,GAAwB9B,EAAU,IACzE2K,EAASvF,aAAc,QAAS,GAAItD,GAAwB7B,EAAQ,GAEpE,IAAI2K,GAAW,GAAI4a,KAAqB3lB,aAAc0rE,GAAcrkE,WAAW,EAAOC,YAAY,EAAOb,aAAa,GAEtH05C,IAAappD,KAAMtE,KAAMqY,EAAUC,GAEnCtY,KAAKu2E,KAAO/1D,EACZxgB,KAAKmyB,MAAQA,EAEbnyB,KAAKiD,OAASud,EAAOnV,YACrBrL,KAAKgD,kBAAmB,EAwDzB,QAASk2E,IAAkBziD,EAAO0iD,EAAYnsE,GAE7ChN,KAAKy2B,MAAQA,EACbz2B,KAAKy2B,MAAMwI,oBAEXj/B,KAAKgN,MAAQA,CAEb,IAAIqL,GAAW,GAAI6nD,IAAsBiZ,EAAY,EAAG,GACpD7gE,EAAW,GAAI1C,IAAqBa,WAAW,EAAMlD,KAAK,GAE9D6E,GAAK9T,KAAMtE,KAAMqY,EAAUC,GAE3BtY,KAAKiD,OAASjD,KAAKy2B,MAAMprB,YACzBrL,KAAKgD,kBAAmB,EAExBhD,KAAK0J,SAwEN,QAAS0vE,IAAqB3iD,EAAOzpB,GAEpC9C,EAAS5F,KAAMtE,MAEfA,KAAKy2B,MAAQA,EACbz2B,KAAKy2B,MAAMwI,oBAEXj/B,KAAKiD,OAASwzB,EAAMprB,YACpBrL,KAAKgD,kBAAmB,EAExBhD,KAAKgN,MAAQA,CAEb,IAAIsL,GAAW,GAAI4a,KAAqB3f,KAAK,IAEzC8E,EAAW,GAAInI,EAEnBmI,GAASvF,aAAc,WAAY,GAAIlE,GAAiB,GAAI7G,cAAc,IAAS,IAEnF/H,KAAKq5E,KAAO,GAAI5rB,IAAMp1C,EAAUC,GAChCtY,KAAKq/B,IAAKr/B,KAAKq5E,MAGfr5E,KAAK0J,SAoDN,QAAS4vE,IAAuB7iD,EAAOxP,EAAMja,GAE5C9C,EAAS5F,KAAMtE,MAEfA,KAAKy2B,MAAQA,EACbz2B,KAAKy2B,MAAMwI,oBAEXj/B,KAAKiD,OAASwzB,EAAMprB,YACpBrL,KAAKgD,kBAAmB,EAExBhD,KAAKgN,MAAQA,CAEb,IAAIqL,GAAW,GAAI45C,IAA0BhrC,EAC7C5O,GAASkhE,QAAmB,GAAV5mE,KAAKi+C,IAEvB5wD,KAAKsY,SAAW,GAAI1C,IAAqBa,WAAW,EAAMlD,KAAK,IAC3CzS,SAAfd,KAAKgN,QAAsBhN,KAAKsY,SAAS/K,aAAe0rE,GAE7D,IAAInuE,GAAWuN,EAASmhE,aAAc,YAClC7rE,EAAS,GAAI5F,cAA+B,EAAjB+C,EAAS5B,MAExCmP,GAASvF,aAAc,QAAS,GAAIlE,GAAiBjB,EAAQ,IAE7D3N,KAAKq/B,IAAK,GAAIjnB,GAAMC,EAAUrY,KAAKsY,WAEnCtY,KAAK0J,SA0DN,QAAS+vE,IAAYxyD,EAAMyyD,EAAWZ,EAAQC,GAE7C9xD,EAAOA,GAAQ,GACfyyD,EAAYA,GAAa,GACzBZ,EAAS,GAAIjzE,GAAkB/E,SAAXg4E,EAAuBA,EAAS,SACpDC,EAAS,GAAIlzE,GAAkB/E,SAAXi4E,EAAuBA,EAAS,QAQpD,KAAM,GANFj2E,GAAS42E,EAAY,EACrBC,EAAO1yD,EAAOyyD,EACdE,EAAW3yD,EAAO,EAElBvZ,KAAeC,KAETqC,EAAI,EAAGy9B,EAAI,EAAG1Q,GAAM68C,EAAU5pE,GAAK0pE,EAAW1pE,IAAM+sB,GAAK48C,EAAO,CAEzEjsE,EAAS0E,MAAQwnE,EAAU,EAAG78C,EAAG68C,EAAU,EAAG78C,GAC9CrvB,EAAS0E,KAAM2qB,EAAG,GAAK68C,EAAU78C,EAAG,EAAG68C,EAEvC,IAAI5sE,GAAQgD,IAAMlN,EAASg2E,EAASC,CAEpC/rE,GAAM8R,QAASnR,EAAQ8/B,GAAKA,GAAK,EACjCzgC,EAAM8R,QAASnR,EAAQ8/B,GAAKA,GAAK,EACjCzgC,EAAM8R,QAASnR,EAAQ8/B,GAAKA,GAAK,EACjCzgC,EAAM8R,QAASnR,EAAQ8/B,GAAKA,GAAK,EAIlC,GAAIp1B,GAAW,GAAInI,EACnBmI,GAASvF,aAAc,WAAY,GAAItD,GAAwB9B,EAAU,IACzE2K,EAASvF,aAAc,QAAS,GAAItD,GAAwB7B,EAAQ,GAEpE,IAAI2K,GAAW,GAAI4a,KAAqB3lB,aAAc0rE,IAEtDvrB,IAAappD,KAAMtE,KAAMqY,EAAUC,GAapC,QAASuhE,IAAiB50E,EAAQ60E,EAASC,EAASL,EAAWZ,EAAQC,GAEtE9zE,EAASA,GAAU,GACnB60E,EAAUA,GAAW,GACrBC,EAAUA,GAAW,EACrBL,EAAYA,GAAa,GACzBZ,EAAS,GAAIjzE,GAAkB/E,SAAXg4E,EAAuBA,EAAS,SACpDC,EAAS,GAAIlzE,GAAkB/E,SAAXi4E,EAAuBA,EAAS,QAEpD,IAGIj5E,GAAGU,EACH2Q,EAAGnB,EAAGy9B,EAAG3nC,EAAGkH,EAJZU,KACAC,IAOJ,KAAMqC,EAAI,EAAGA,GAAK8pE,EAAS9pE,IAE1BmB,EAAMnB,EAAI8pE,GAAwB,EAAVnnE,KAAKi+C,IAE7B9wD,EAAI6S,KAAK6gD,IAAKriD,GAAMlM,EACpBzE,EAAImS,KAAKimB,IAAKznB,GAAMlM,EAEpByI,EAAS0E,KAAM,EAAG,EAAG,GACrB1E,EAAS0E,KAAMtS,EAAG,EAAGU,GAErBwM,EAAc,EAAJgD,EAAU8oE,EAASC,EAE7BprE,EAAOyE,KAAMpF,EAAMlH,EAAGkH,EAAMjH,EAAGiH,EAAMhH,GACrC2H,EAAOyE,KAAMpF,EAAMlH,EAAGkH,EAAMjH,EAAGiH,EAAMhH,EAMtC,KAAMgK,EAAI,EAAGA,GAAK+pE,EAAS/pE,IAM1B,IAJAhD,EAAc,EAAJgD,EAAU8oE,EAASC,EAE7BjzE,EAAIb,EAAWA,EAAS80E,EAAU/pE,EAE5By9B,EAAI,EAAGA,EAAIisC,EAAWjsC,IAI3Bt8B,EAAMs8B,EAAIisC,GAA0B,EAAV/mE,KAAKi+C,IAE/B9wD,EAAI6S,KAAK6gD,IAAKriD,GAAMrL,EACpBtF,EAAImS,KAAKimB,IAAKznB,GAAMrL,EAEpB4H,EAAS0E,KAAMtS,EAAG,EAAGU,GACrBmN,EAAOyE,KAAMpF,EAAMlH,EAAGkH,EAAMjH,EAAGiH,EAAMhH,GAIrCmL,GAAQs8B,EAAI,GAAMisC,GAA0B,EAAV/mE,KAAKi+C,IAEvC9wD,EAAI6S,KAAK6gD,IAAKriD,GAAMrL,EACpBtF,EAAImS,KAAKimB,IAAKznB,GAAMrL,EAEpB4H,EAAS0E,KAAMtS,EAAG,EAAGU,GACrBmN,EAAOyE,KAAMpF,EAAMlH,EAAGkH,EAAMjH,EAAGiH,EAAMhH,EAMvC,IAAIqS,GAAW,GAAInI,EACnBmI,GAASvF,aAAc,WAAY,GAAItD,GAAwB9B,EAAU,IACzE2K,EAASvF,aAAc,QAAS,GAAItD,GAAwB7B,EAAQ,GAEpE,IAAI2K,GAAW,GAAI4a,KAAqB3lB,aAAc0rE,IAEtDvrB,IAAappD,KAAMtE,KAAMqY,EAAUC,GAYpC,QAAS0hE,IAAmBx5D,EAAQyG,EAAMmxD,EAAKhhE,GAI9CpX,KAAKwgB,OAASA,EAEdxgB,KAAKinB,KAAkBnmB,SAATmmB,EAAuBA,EAAO,CAE5C,IAAIja,GAAkBlM,SAARs3E,EAAsBA,EAAM,SAEtCz0E,EAAwB7C,SAAdsW,EAA4BA,EAAY,EAIlDihE,EAAW,EAEXC,EAAct4E,KAAKwgB,OAAOnI,QAEzBigE,IAAeA,EAAY33D,WAE/B03D,EAAWC,EAAY1qE,MAAMxN,OAI7BC,QAAQ4H,KAAM,qGAMf,IAAIoQ,GAAW,GAAInI,GAEfqoE,EAAY,GAAI/oE,GAAmC,EAAX6oE,EAAe,EAAG,EAE9DhgE,GAASvF,aAAc,WAAYylE,GAEnC7qB,GAAappD,KAAMtE,KAAMqY,EAAU,GAAI6a,KAAqBlmB,MAAOA,EAAOoK,UAAWzT,KAIrF3D,KAAKgD,kBAAmB,EACxBhD,KAAK0J,SAqEN,QAASuwE,IAAwBxjD,EAAOxP,EAAMja,GAE7C9C,EAAS5F,KAAMtE,MAEfA,KAAKy2B,MAAQA,EACbz2B,KAAKy2B,MAAMwI,oBAEXj/B,KAAKiD,OAASwzB,EAAMprB,YACpBrL,KAAKgD,kBAAmB,EAExBhD,KAAKgN,MAAQA,EAEClM,SAATmmB,IAAqBA,EAAO,EAEjC,IAAI5O,GAAW,GAAInI,EACnBmI,GAASvF,aAAc,WAAY,GAAItD,KACpCyX,EAAMA,EAAM,EACdA,EAAMA,EAAM,EACZA,GAAQA,EAAM,GACZA,GAAQA,EAAM,GACdA,EAAMA,EAAM,GACZ,GAEH,IAAI3O,GAAW,GAAI4a,KAAqB3f,KAAK,GAE7CvT,MAAKk6E,WAAa,GAAIzsB,IAAMp1C,EAAUC,GACtCtY,KAAKq/B,IAAKr/B,KAAKk6E,YAEf7hE,EAAW,GAAInI,GACfmI,EAASvF,aAAc,WAAY,GAAItD,IAA0B,EAAG,EAAG,EAAG,EAAG,EAAG,GAAK,IAErFxP,KAAKm6E,WAAa,GAAI1sB,IAAMp1C,EAAUC,GACtCtY,KAAKq/B,IAAKr/B,KAAKm6E,YAEfn6E,KAAK0J,SA2DN,QAAS0wE,IAAclhE,GAiEtB,QAASmhE,GAASvtE,EAAG9G,EAAGgH,GAEvBstE,EAAUxtE,EAAGE,GACbstE,EAAUt0E,EAAGgH,GAId,QAASstE,GAAUl6D,EAAIpT,GAEtBU,EAAS0E,KAAM,EAAG,EAAG,GACrBzE,EAAOyE,KAAMpF,EAAMlH,EAAGkH,EAAMjH,EAAGiH,EAAMhH,GAEblF,SAAnBy5E,EAAUn6D,KAEdm6D,EAAUn6D,OAIXm6D,EAAUn6D,GAAKhO,KAAQ1E,EAAStN,OAAS,EAAM,GAjFhD,GAAIiY,GAAW,GAAInI,GACfoI,EAAW,GAAI4a,KAAqBlmB,MAAO,SAAUO,aAAcitE,KAEnE9sE,KACAC,KAEA4sE,KAIAE,EAAe,GAAI50E,GAAO,UAC1B60E,EAAY,GAAI70E,GAAO,UACvB80E,EAAU,GAAI90E,GAAO,OACrB+0E,EAAc,GAAI/0E,GAAO,UACzBg1E,EAAa,GAAIh1E,GAAO,QAI5Bw0E,GAAS,KAAM,KAAMI,GACrBJ,EAAS,KAAM,KAAMI,GACrBJ,EAAS,KAAM,KAAMI,GACrBJ,EAAS,KAAM,KAAMI,GAIrBJ,EAAS,KAAM,KAAMI,GACrBJ,EAAS,KAAM,KAAMI,GACrBJ,EAAS,KAAM,KAAMI,GACrBJ,EAAS,KAAM,KAAMI,GAIrBJ,EAAS,KAAM,KAAMI,GACrBJ,EAAS,KAAM,KAAMI,GACrBJ,EAAS,KAAM,KAAMI,GACrBJ,EAAS,KAAM,KAAMI,GAIrBJ,EAAS,IAAK,KAAMK,GACpBL,EAAS,IAAK,KAAMK,GACpBL,EAAS,IAAK,KAAMK,GACpBL,EAAS,IAAK,KAAMK,GAIpBL,EAAS,KAAM,KAAMM,GACrBN,EAAS,KAAM,KAAMM,GACrBN,EAAS,KAAM,KAAMM,GAIrBN,EAAS,IAAK,IAAKO,GACnBP,EAAS,IAAK,IAAKQ,GAInBR,EAAS,MAAO,MAAOQ,GACvBR,EAAS,MAAO,MAAOQ,GAEvBR,EAAS,MAAO,MAAOQ,GACvBR,EAAS,MAAO,MAAOQ,GAwBvBxiE,EAASvF,aAAc,WAAY,GAAItD,GAAwB9B,EAAU,IACzE2K,EAASvF,aAAc,QAAS,GAAItD,GAAwB7B,EAAQ,IAEpE+/C,GAAappD,KAAMtE,KAAMqY,EAAUC,GAEnCtY,KAAKkZ,OAASA,EACTlZ,KAAKkZ,OAAOtM,wBAAyB5M,KAAKkZ,OAAOtM,yBAEtD5M,KAAKiD,OAASiW,EAAO7N,YACrBrL,KAAKgD,kBAAmB,EAExBhD,KAAKu6E,SAAWA,EAEhBv6E,KAAK0J,SA8FN,QAASoxE,IAAWt6D,EAAQxT,GAE3BhN,KAAKwgB,OAASA,EAEC1f,SAAVkM,IAAsBA,EAAQ,SAEnC,IAAIuF,GAAU,GAAIrK,cAAe,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,IAClGqwE,EAAY,GAAIxwE,cAAc,IAE9BsQ,EAAW,GAAInI,EACnBmI,GAASxF,SAAU,GAAIjE,GAAiB2D,EAAS,IACjD8F,EAASvF,aAAc,WAAY,GAAIlE,GAAiB2pE,EAAW,IAEnE7qB,GAAappD,KAAMtE,KAAMqY,EAAU,GAAI6a,KAAqBlmB,MAAOA,KAEnEhN,KAAKgD,kBAAmB,EAExBhD,KAAK0J,SA+EN,QAASqxE,IAAYC,EAAK5C,GAEzBp4E,KAAKyB,KAAO,aAEZzB,KAAKg7E,IAAMA,CAEX,IAAIhuE,GAAkBlM,SAARs3E,EAAsBA,EAAM,SAEtC7lE,EAAU,GAAIrK,cAAe,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,IAElGqwE,GAAc,EAAG,EAAG,KAAQ,EAAG,QAAa,EAAG,KAAQ,EAAG,EAAG,QAAa,cAAuB,SAEjGlgE,EAAW,GAAInI,EAEnBmI,GAASxF,SAAU,GAAIjE,GAAiB2D,EAAS,IAEjD8F,EAASvF,aAAc,WAAY,GAAItD,GAAwB+oE,EAAW,IAE1E7qB,GAAappD,KAAMtE,KAAMqY,EAAU,GAAI6a,KAAqBlmB,MAAOA,KAEnEhN,KAAKqY,SAAS4iE,wBA2Bf,QAASC,IAAav8D,EAAOsI,EAAMmxD,GAElCp4E,KAAKyB,KAAO,cAEZzB,KAAK2e,MAAQA,EAEb3e,KAAKinB,KAAkBnmB,SAATmmB,EAAuB,EAAIA,CAEzC,IAAIja,GAAkBlM,SAARs3E,EAAsBA,EAAM,SAEtCG,GAAc,KAAQ,KAAQ,EAAG,QAAa,EAAG,EAAG,EAAG,KAAQ,EAAG,QAAa,EAAG,KAAQ,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAErHlgE,EAAW,GAAInI,EACnBmI,GAASvF,aAAc,WAAY,GAAItD,GAAwB+oE,EAAW,IAC1ElgE,EAAS4iE,wBAETxtB,GAAKnpD,KAAMtE,KAAMqY,EAAU,GAAI6a,KAAqBlmB,MAAOA,IAI3D,IAAImuE,IAAe,EAAG,EAAG,KAAQ,EAAG,QAAa,EAAG,EAAG,EAAG,QAAa,EAAG,KAAQ,GAE9ElZ,EAAY,GAAI/xD,EACpB+xD,GAAUnvD,aAAc,WAAY,GAAItD,GAAwB2rE,EAAY,IAC5ElZ,EAAUgZ,wBAEVj7E,KAAKq/B,IAAK,GAAIjnB,GAAM6pD,EAAW,GAAIrsD,IAAqB5I,MAAOA,EAAO+G,QAAS,GAAKC,aAAa,EAAMa,YAAY,MAyCpH,QAASumE,IAAaC,EAAKpjE,EAAQ7X,EAAQ4M,EAAOsuE,EAAYC,GAI7DrxE,EAAS5F,KAAMtE,MAEAc,SAAVkM,IAAsBA,EAAQ,UACnBlM,SAAXV,IAAuBA,EAAS,GACjBU,SAAfw6E,IAA2BA,EAAa,GAAMl7E,GAChCU,SAAdy6E,IAA0BA,EAAY,GAAMD,GAE3Bx6E,SAAjB06E,KAEJA,GAAe,GAAItrE,GACnBsrE,GAAa1oE,aAAc,WAAY,GAAItD,IAA0B,EAAG,EAAG,EAAG,EAAG,EAAG,GAAK,IAEzFisE,GAAe,GAAI5Y,IAAwB,EAAG,GAAK,EAAG,EAAG,GACzD4Y,GAAaC,UAAW,MAAU,IAInC17E,KAAK8K,SAAS8T,KAAM3G,GAEpBjY,KAAKq5E,KAAO,GAAI5rB,IAAM+tB,GAAc,GAAItoD,KAAqBlmB,MAAOA,KACpEhN,KAAKq5E,KAAKr2E,kBAAmB,EAC7BhD,KAAKq/B,IAAKr/B,KAAKq5E,MAEfr5E,KAAKy4E,KAAO,GAAIrgE,GAAMqjE,GAAc,GAAI7lE,IAAqB5I,MAAOA,KACpEhN,KAAKy4E,KAAKz1E,kBAAmB,EAC7BhD,KAAKq/B,IAAKr/B,KAAKy4E,MAEfz4E,KAAK27E,aAAcN,GACnBr7E,KAAK47E,UAAWx7E,EAAQk7E,EAAYC,GAgErC,QAASM,IAAY50D,GAEpBA,EAAOA,GAAQ,CAEf,IAAIvZ,IACH,EAAG,EAAG,EAAGuZ,EAAM,EAAG,EAClB,EAAG,EAAG,EAAG,EAAGA,EAAM,EAClB,EAAG,EAAG,EAAG,EAAG,EAAGA,GAGZtZ,GACH,EAAG,EAAG,EAAG,EAAG,GAAK,EACjB,EAAG,EAAG,EAAG,GAAK,EAAG,EACjB,EAAG,EAAG,EAAG,EAAG,GAAK,GAGd0K,EAAW,GAAInI,EACnBmI,GAASvF,aAAc,WAAY,GAAItD,GAAwB9B,EAAU,IACzE2K,EAASvF,aAAc,QAAS,GAAItD,GAAwB7B,EAAQ,GAEpE,IAAI2K,GAAW,GAAI4a,KAAqB3lB,aAAc0rE,IAEtDvrB,IAAappD,KAAMtE,KAAMqY,EAAUC,GAWpC,QAASwjE,IAAOhvE,EAAG9G,EAAG+G,EAAGuF,EAAGnN,EAAQ6H,EAAOC,GAG1C,MADA5M,SAAQ4H,KAAM,wEACP,GAAI4E,GAAOC,EAAG9G,EAAG+G,EAAG5H,EAAQ6H,EAAOC,GAQ3C,QAAS8uE,IAAkBC,GAG1B,MADA37E,SAAQ4H,KAAM,kEACP+zE,EAIR,QAASC,IAAeD,GAYvB,MAVmBl7E,UAAdk7E,IAA0BA,MAE/B37E,QAAQ4H,KAAM,+DACd+zE,EAAUE,iBAAkB,EAC5BF,EAAUA,UAAYA,EACtBA,EAAUnxE,MAAQ,WAEjB,MAAOmxE,GAAUnvB,SAGXmvB,EAIR,QAAS7E,IAAY9+D,EAAUC,GAG9B,MADAjY,SAAQ4H,KAAM,sDACP,GAAI2lD,IAAQv1C,EAAUC,GAI9B,QAAS6jE,IAAU7jE,GAGlB,MADAjY,SAAQ4H,KAAM;AACP,GAAIskD,IAAQj0C,GAIpB,QAAS8jE,IAAgB/jE,EAAUC,GAGlC,MADAjY,SAAQ4H,KAAM,0DACP,GAAI2lD,IAAQv1C,EAAUC,GAI9B,QAAS+jE,IAAoBxrE,GAG5B,MADAxQ,SAAQ4H,KAAM,sEACP,GAAImrB,IAAgBviB,GAI5B,QAASyrE,IAAuBzrE,GAG/B,MADAxQ,SAAQ4H,KAAM,yEACP,GAAImrB,IAAgBviB,GAI5B,QAAS0rE,IAAwB1rE,GAGhC,MADAxQ,SAAQ4H,KAAM,0EACP,GAAImrB,IAAgBviB,GAI5B,QAAS2rE,IAAQ18E,EAAGC,EAAGS,GAGtB,MADAH,SAAQ4H,KAAM,6DACP,GAAIlH,GAASjB,EAAGC,EAAGS,GAM3B,QAASi8E,IAAwBp1E,EAAOwH,GAGvC,MADAxO,SAAQ4H,KAAM,8GACP,GAAI2G,GAAiBvH,EAAOwH,GAAW6tE,YAAY,GAI3D,QAASC,IAAet1E,EAAOwH,GAG9B,MADAxO,SAAQ4H,KAAM,sFACP,GAAI+G,GAAqB3H,EAAOwH,GAIxC,QAAS+tE,IAAgBv1E,EAAOwH,GAG/B,MADAxO,SAAQ4H,KAAM,wFACP,GAAIgH,GAAsB5H,EAAOwH,GAIzC,QAASguE,IAAuBx1E,EAAOwH,GAGtC,MADAxO,SAAQ4H,KAAM,sGACP,GAAIiH,GAA6B7H,EAAOwH,GAIhD,QAASiuE,IAAgBz1E,EAAOwH,GAG/B,MADAxO,SAAQ4H,KAAM,wFACP,GAAImH,GAAsB/H,EAAOwH,GAIzC,QAASkuE,IAAiB11E,EAAOwH,GAGhC,MADAxO,SAAQ4H,KAAM,0FACP,GAAIoH,GAAuBhI,EAAOwH,GAI1C,QAASmuE,IAAgB31E,EAAOwH,GAG/B,MADAxO,SAAQ4H,KAAM,wFACP,GAAIqH,GAAsBjI,EAAOwH,GAIzC,QAASouE,IAAiB51E,EAAOwH,GAGhC,MADAxO,SAAQ4H,KAAM,0FACP,GAAIsH,GAAuBlI,EAAOwH,GAI1C,QAASquE,IAAkB71E,EAAOwH,GAGjC,MADAxO,SAAQ4H,KAAM,4FACP,GAAIuH,GAAwBnI,EAAOwH,GAI3C,QAASsuE,IAAkB91E,EAAOwH,GAGjC,MADAxO,SAAQ4H,KAAM,4FACP,GAAIwH,GAAwBpI,EAAOwH,GA8E3C,QAASuuE,IAAoBn7D,GAE5B5hB,QAAQ4H,KAAM,qFAEdu/D,GAAiBljE,KAAMtE,KAAMiiB,GAC7BjiB,KAAKyB,KAAO,aACZzB,KAAK0yD,QAAS,EAQf,QAAS2qB,IAAcp7D,GAEtB5hB,QAAQ4H,KAAM,+EAEdu/D,GAAiBljE,KAAMtE,KAAMiiB,GAC7BjiB,KAAKyB,KAAO,aAQb,QAAS67E,IAAQr7D,GAEhB5hB,QAAQ4H,KAAM,sEAEdu/D,GAAiBljE,KAAMtE,KAAMiiB,GAC7BjiB,KAAKyB,KAAO,aA4Bb,QAAS87E,IAAYt2D,GAGpB,MADA5mB,SAAQ4H,KAAM,0DACP,GAAI4zE,IAAY50D,GAIxB,QAASu2D,IAAmBh9D,EAAQxT,GAGnC,MADA3M,SAAQ4H,KAAM,oFACP,GAAI6yE,IAAWt6D,EAAQxT,GAI/B,QAASywE,IAAaj9D,EAAQ43D,GAG7B,MADA/3E,SAAQ4H,KAAM,wEACP,GAAIylD,IAAc,GAAIqU,IAAevhD,EAAOnI,UAAY,GAAI6a,KAAqBlmB,MAAelM,SAARs3E,EAAoBA,EAAM,YAgB1H,QAASsF,IAAiBl9D,EAAQ43D,GAGjC,MADA/3E,SAAQ4H,KAAM,gFACP,GAAIylD,IAAc,GAAIQ,IAAmB1tC,EAAOnI,UAAY,GAAI6a,KAAqBlmB,MAAelM,SAARs3E,EAAoBA,EAAM,YAiB9H,QAASuF,IAAWzY,GAGnB,MADA7kE,SAAQ4H,KAAM,yDACP,GAAIg9D,IAAYC,GAIxB,QAAS0Y,IAAqB1Y,GAG7B,MADA7kE,SAAQ4H,KAAM,0EACP,GAAIq9D,IAAmBJ,GA61C/B,QAAS2Y,MAERx9E,QAAQC,MAAO,0EAEfN,KAAK89E,cAAgB,SAAW3rE,EAAQ+G,GAEvC7Y,QAAQ4H,KAAM,8DACdkK,EAAO4rE,QAAS7kE,IAIjBlZ,KAAKg+E,gBAAkB,SAAW7rE,EAAQ+G,GAEzC7Y,QAAQ4H,KAAM,kEACdkK,EAAO8rE,UAAW/kE,IAInBlZ,KAAKk+E,WAAa,WAEjB79E,QAAQC,MAAO,qEAQjB,QAAS69E,MAER99E,QAAQC,MAAO,mFAEfN,KAAKynD,WAAaje,SAASC,gBAAiB,+BAAgC,UAC5EzpC,KAAKyZ,MAAQ,aACbzZ,KAAK+Y,OAAS,aACd/Y,KAAK4a,cAAgB,aACrB5a,KAAKwoD,QAAU,aA8BhB,QAAS41B,MAER/9E,QAAQC,MAAO,uEA7g8CQQ,SAAnBs6D,OAAOC,UAEXD,OAAOC,QAAU1oD,KAAKu9C,IAAK,QAIFpvD,SAArBs6D,OAAOijB,YAKXjjB,OAAOijB,UAAY,SAAWv8E,GAE7B,MAAwB,gBAAVA,IAAsBw8E,SAAUx8E,IAAW6Q,KAAKC,MAAO9Q,KAAYA,IAQhEhB,SAAd6R,KAAKopD,OAITppD,KAAKopD,KAAO,SAAWj8D,GAEtB,MAASA,GAAI,KAAcA,EAAI,EAAM,GAAMA,IAMxC,QAAUy+E,UAAS9K,YAAc,GAKrC7xE,OAAOC,eAAgB08E,SAAS9K,UAAW,QAE1CpqE,IAAK,WAEJ,MAAOrJ,MAAKi1B,WAAWzM,MAAO,6BAA+B,MAQzC1nB,SAAlBc,OAAO48E,SAKX,WAEC58E,OAAO48E,OAAS,SAAWv+D,GAE1B,GAAgBnf,SAAXmf,GAAmC,OAAXA,EAE5B,KAAM,IAAIlR,WAAW,6CAMtB,KAAM,GAFF0vE,GAAS78E,OAAQqe,GAEX7P,EAAQ,EAAGA,EAAQjQ,UAAUC,OAAQgQ,IAAW,CAEzD,GAAIsuE,GAASv+E,UAAWiQ,EAExB,IAAgBtP,SAAX49E,GAAmC,OAAXA,EAE5B,IAAM,GAAIC,KAAWD,GAEf98E,OAAO6xE,UAAUmL,eAAet6E,KAAMo6E,EAAQC,KAElDF,EAAQE,GAAYD,EAAQC,IAUhC,MAAOF,OAcV78E,OAAO48E,OAAQ5+E,EAAgB6zE,WAE9BhzD,iBAAkB,SAAWhf,EAAMovE,GAET/vE,SAApBd,KAAK6+E,aAA2B7+E,KAAK6+E,cAE1C,IAAIC,GAAY9+E,KAAK6+E,UAEM/9E,UAAtBg+E,EAAWr9E,KAEfq9E,EAAWr9E,OAIPq9E,EAAWr9E,GAAO8zB,QAASs7C,SAE/BiO,EAAWr9E,GAAO2Q,KAAMy+D,IAM1BkO,iBAAkB,SAAWt9E,EAAMovE,GAElC,GAAyB/vE,SAApBd,KAAK6+E,WAA2B,OAAO,CAE5C,IAAIC,GAAY9+E,KAAK6+E,UAErB,OAA6B/9E,UAAtBg+E,EAAWr9E,IAAwBq9E,EAAWr9E,GAAO8zB,QAASs7C,SAItExwD,oBAAqB,SAAW5e,EAAMovE,GAErC,GAAyB/vE,SAApBd,KAAK6+E,WAAV,CAEA,GAAIC,GAAY9+E,KAAK6+E,WACjBG,EAAgBF,EAAWr9E,EAE/B,IAAuBX,SAAlBk+E,EAA8B,CAElC,GAAI5uE,GAAQ4uE,EAAczpD,QAASs7C,EAE9BzgE,SAEJ4uE,EAAcC,OAAQ7uE,EAAO,MAQhCuoC,cAAe,SAAW34B,GAEzB,GAAyBlf,SAApBd,KAAK6+E,WAAV,CAEA,GAAIC,GAAY9+E,KAAK6+E,WACjBG,EAAgBF,EAAW9+D,EAAMve,KAErC,IAAuBX,SAAlBk+E,EAA8B,CAElCh/D,EAAMC,OAASjgB,IAIf,KAAM,GAFFqH,GAAQ23E,EAAcnyB,MAAO,GAEvB78C,EAAI,EAAGC,EAAI5I,EAAMjH,OAAQ4P,EAAIC,EAAGD,IAEzC3I,EAAO2I,GAAI1L,KAAMtE,KAAMggB,OAU3B,IAAI8mC,IAAW,QACXo4B,IAAUC,KAAM,EAAGC,OAAQ,EAAGC,MAAO,GACrCt4C,GAAe,EACfE,GAAe,EACfE,GAAgB,EAChBm4C,GAAoB,EACpBC,GAAuB,EACvBC,GAAwB,EACxBC,GAAiB,EACjBlyD,GAAe,EACfC,GAAmB,EACnB5Z,GAAY,EACZqG,GAAW,EACX6a,GAAa,EACb4qD,GAAc,EACdC,GAAgB,EAChB7rE,GAAW,EACX0mE,GAAa,EACbvB,GAAe,EACfv0C,GAAa,EACbhxB,GAAiB,EACjBiyB,GAAmB,EACnBE,GAAsB,EACtBG,GAAmB,EACnBpB,GAAiB,EACjBtwB,GAAc,IACdg+B,GAAmB,IACnBE,GAA0B,IAC1BgD,GAAc,IACdC,GAAc,IACd/C,GAAa,IACbC,GAAY,IACZC,GAAiB,IACjBC,GAAyB,IACzB3+B,GAAiB,IACjBE,GAAyB,IACzB0+B,GAAiB,IACjBE,GAAyB,IACzBE,GAAiB,IACjBE,GAAyB,IACzBE,GAAyB,IACzB3S,GAAa,EACbE,GAAc,EACdE,GAAY,EACZpsB,GAAiB,EACjBusB,GAAa,EACbE,GAAoB,EACpBE,GAAe,EACfE,GAAgB,EAChBlrB,GAAoB,EACpB4X,GAAe,EACfC,GAAe,EACfwB,GAAgB,EAChB7E,GAAoB,EACpBC,GAAsB,EACtBC,GAAwB,EACxBC,GAAoB,EACpB20D,GAAY,IACZn8D,GAAwB,IACxBmK,GAAwB,IACxBG,GAAmC,IACnCC,GAAmC,IACnCC,GAA6B,IAC7BJ,GAA0B,IAC1BC,GAA0B,IAC1B+iB,GAAiB,IACjBtuC,GAAsB,KACtBwuC,GAAyB,KACzBpsC,GAAgB,KAChB2mC,GAA6B,KAC7BC,GAA4B,KAC5B/oC,GAAe,KACf2uC,GAA4B,KAC5B1uC,GAA2B,KAC3BE,GAAmB,KACnBivC,GAAW,KACXC,GAAY,KACZhD,GAAoB,KACpBiD,GAAU,KACVhD,GAAkB,KAClBb,GAAY,KACZC,GAAgB,KAChBoD,GAAwB,KACxBE,GAAwB,KACxBE,GAAuB,KACvBzC,GAAqB,KACrB+C,GAAc,KACdrE,GAAY,KACZjrC,GAAa,KACbwvC,GAAkB,KAClBE,GAAuB,KACvBytC,GAAan9E,GACbksC,GAAc,KACdG,GAAqB,KACrByE,GAAuB,MACvBC,GAAwB,MACxBC,GAAwB,MACxBC,GAAwB,MACxBK,GAA0B,MAC1BC,GAA0B,MAC1BC,GAA2B,MAC3BC,GAA2B,MAC3BK,GAAkB,MAClBE,GAAuB,MACvBC,GAAuB,MACvBC,GAAuB,MACvBC,GAAuB,MACvBC,GAAuB,MACvBC,GAAuB,MACvBC,GAAuB,MACvBC,GAAuB,MACvBC,GAAwB,MACxBC,GAAwB,MACxBC,GAAwB,MACxBC,GAAyB,MACzBC,GAAyB,MACzBC,GAAyB,MACzBuqC,GAAW,KACXpK,GAAa,KACbqK,GAAe,KACfC,GAAsB,KACtBC,GAAoB,KACpBC,GAAoB,KACpBpL,GAAsB,KACtBqL,GAAkB,KAClBC,GAAmB,KACnB3nE,GAAoB,EACpB8xC,GAAwB,EACxBC,GAAsB,EACtBlnD,GAAiB,IACjB0mB,GAAe,KACfK,GAAgB,KAChBJ,GAAe,KACfo2D,GAAiB,KACjBn2D,GAAgB,KAChBC,GAAiB,KACjBC,GAAe,KACfqQ,GAAoB,KACpBsD,GAAmB,KACnB+lC,GAAwB,EACxB1vC,GAAuB,EAOvBnyB,IAEHkgE,QAASxvD,KAAKi+C,GAAK,IACnB0vB,QAAS,IAAM3tE,KAAKi+C,GAEpB1uD,aAAc,WAMb,IAAM,GAFFq+E,MAEMvwE,EAAI,EAAGA,EAAI,IAAKA,IAEzBuwE,EAAKvwE,IAAQA,EAAI,GAAK,IAAM,IAAO,EAAMilB,SAAU,GAIpD,OAAO,YAEN,GAAIurD,GAAqB,WAAhB7tE,KAAK4F,SAAwB,EAClCkoE,EAAqB,WAAhB9tE,KAAK4F,SAAwB,EAClCmoE,EAAqB,WAAhB/tE,KAAK4F,SAAwB,EAClCooE,EAAqB,WAAhBhuE,KAAK4F,SAAwB,EAClCvW,EAAOu+E,EAAU,IAALC,GAAcD,EAAKC,GAAM,EAAI,KAASD,EAAKC,GAAM,GAAK,KAASD,EAAKC,GAAM,GAAK,KAAS,IACvGD,EAAU,IAALE,GAAcF,EAAKE,GAAM,EAAI,KAAS,IAAMF,EAAKE,GAAM,GAAK,GAAO,IAASF,EAAKE,GAAM,GAAK,KAAS,IAC1GF,EAAU,GAALG,EAAY,KAASH,EAAKG,GAAM,EAAI,KAAS,IAAMH,EAAKG,GAAM,GAAK,KAASH,EAAKG,GAAM,GAAK,KACjGH,EAAU,IAALI,GAAcJ,EAAKI,GAAM,EAAI,KAASJ,EAAKI,GAAM,GAAK,KAASJ,EAAKI,GAAM,GAAK,IAGrF,OAAO3+E,GAAK4+E,kBAMd1f,MAAO,SAAWp/D,EAAO+C,EAAKC,GAE7B,MAAO6N,MAAK7N,IAAKD,EAAK8N,KAAK9N,IAAKC,EAAKhD,KAOtC++E,gBAAiB,SAAW78D,EAAG4zC,GAE9B,OAAW5zC,EAAI4zC,EAAMA,GAAMA,GAM5BkpB,UAAW,SAAWhhF,EAAGihF,EAAIznB,EAAI0nB,EAAIxnB,GAEpC,MAAOwnB,IAAOlhF,EAAIihF,IAASvnB,EAAKwnB,IAAS1nB,EAAKynB,IAM/C3wB,KAAM,SAAWtwD,EAAGC,EAAGqyD,GAEtB,OAAS,EAAIA,GAAMtyD,EAAIsyD,EAAIryD,GAM5BkhF,WAAY,SAAWnhF,EAAG+E,EAAKC,GAE9B,MAAKhF,IAAK+E,EAAa,EAClB/E,GAAKgF,EAAa,GAEvBhF,GAAMA,EAAI+E,IAAUC,EAAMD,GAEnB/E,EAAIA,GAAM,EAAI,EAAIA,KAI1BohF,aAAc,SAAWphF,EAAG+E,EAAKC,GAEhC,MAAKhF,IAAK+E,EAAa,EAClB/E,GAAKgF,EAAa,GAEvBhF,GAAMA,EAAI+E,IAAUC,EAAMD,GAEnB/E,EAAIA,EAAIA,GAAMA,GAAU,EAAJA,EAAQ,IAAO,MAM3CqhF,QAAS,SAAWC,EAAKC,GAExB,MAAOD,GAAMzuE,KAAKC,MAAOD,KAAK4F,UAAa8oE,EAAOD,EAAM,KAMzDE,UAAW,SAAWF,EAAKC,GAE1B,MAAOD,GAAMzuE,KAAK4F,UAAa8oE,EAAOD,IAMvCG,gBAAiB,SAAWC,GAE3B,MAAOA,IAAU,GAAM7uE,KAAK4F,WAI7BkpE,SAAU,SAAWC,GAEpB,MAAOA,GAAUz/E,GAAMkgE,SAIxBwf,SAAU,SAAWC,GAEpB,MAAOA,GAAU3/E,GAAMq+E,SAIxB12C,aAAc,SAAW9nC,GAExB,MAAqC,MAA5BA,EAAUA,EAAQ,IAAyB,IAAVA,GAI3CihD,eAAgB,SAAWjhD,GAE1B,MAAO6Q,MAAKu9C,IAAK,EAAGv9C,KAAKkvE,KAAMlvE,KAAK2e,IAAKxvB,GAAU6Q,KAAK0vC,OAIzDnY,gBAAiB,SAAWpoC,GAE3B,MAAO6Q,MAAKu9C,IAAK,EAAGv9C,KAAKC,MAAOD,KAAK2e,IAAKxvB,GAAU6Q,KAAK0vC,OAoB3DzgD,QAAOqJ,iBAAkBpL,EAAQ4zE,WAEhC9vE,OAEC0F,IAAK,WAEJ,MAAOrJ,MAAKF,GAIbmG,IAAK,SAAWnE,GAEf9B,KAAKF,EAAIgC,IAMX8B,QAECyF,IAAK,WAEJ,MAAOrJ,MAAKD,GAIbkG,IAAK,SAAWnE,GAEf9B,KAAKD,EAAI+B,MAQZF,OAAO48E,OAAQ3+E,EAAQ4zE,WAEtBqO,WAAW,EAEX77E,IAAK,SAAWnG,EAAGC,GAKlB,MAHAC,MAAKF,EAAIA,EACTE,KAAKD,EAAIA,EAEFC,MAIR+hF,UAAW,SAAWC,GAKrB,MAHAhiF,MAAKF,EAAIkiF,EACThiF,KAAKD,EAAIiiF,EAEFhiF,MAIRiiF,KAAM,SAAWniF,GAIhB,MAFAE,MAAKF,EAAIA,EAEFE,MAIRkiF,KAAM,SAAWniF,GAIhB,MAFAC,MAAKD,EAAIA,EAEFC,MAIRmiF,aAAc,SAAW/xE,EAAOtO,GAE/B,OAASsO,GAER,IAAK,GAAGpQ,KAAKF,EAAIgC,CAAO,MACxB,KAAK,GAAG9B,KAAKD,EAAI+B,CAAO,MACxB,SAAS,KAAM,IAAIwoB,OAAO,0BAA4Bla,GAIvD,MAAOpQ,OAIRoiF,aAAc,SAAWhyE,GAExB,OAASA,GAER,IAAK,GAAG,MAAOpQ,MAAKF,CACpB,KAAK,GAAG,MAAOE,MAAKD,CACpB,SAAS,KAAM,IAAIuqB,OAAO,0BAA4Bla,KAMxDvF,MAAO,WAEN,MAAO,IAAI7K,MAAKuqE,YAAavqE,KAAKF,EAAGE,KAAKD,IAI3C6e,KAAM,SAAWzN,GAKhB,MAHAnR,MAAKF,EAAIqR,EAAErR,EACXE,KAAKD,EAAIoR,EAAEpR,EAEJC,MAIRq/B,IAAK,SAAWluB,EAAG1Q,GAElB,MAAWK,UAANL,GAEJJ,QAAQ4H,KAAM,yFACPjI,KAAKu0D,WAAYpjD,EAAG1Q,KAI5BT,KAAKF,GAAKqR,EAAErR,EACZE,KAAKD,GAAKoR,EAAEpR,EAELC,OAIRqiF,UAAW,SAAWtlB,GAKrB,MAHA/8D,MAAKF,GAAKi9D,EACV/8D,KAAKD,GAAKg9D,EAEH/8D,MAIRu0D,WAAY,SAAWznD,EAAG9G,GAKzB,MAHAhG,MAAKF,EAAIgN,EAAEhN,EAAIkG,EAAElG,EACjBE,KAAKD,EAAI+M,EAAE/M,EAAIiG,EAAEjG,EAEVC,MAIRsiF,gBAAiB,SAAWnxE,EAAG4rD,GAK9B,MAHA/8D,MAAKF,GAAKqR,EAAErR,EAAIi9D,EAChB/8D,KAAKD,GAAKoR,EAAEpR,EAAIg9D,EAET/8D,MAIRq4B,IAAK,SAAWlnB,EAAG1Q,GAElB,MAAWK,UAANL,GAEJJ,QAAQ4H,KAAM,yFACPjI,KAAKyvD,WAAYt+C,EAAG1Q,KAI5BT,KAAKF,GAAKqR,EAAErR,EACZE,KAAKD,GAAKoR,EAAEpR,EAELC,OAIRuiF,UAAW,SAAWxlB,GAKrB,MAHA/8D,MAAKF,GAAKi9D,EACV/8D,KAAKD,GAAKg9D,EAEH/8D,MAIRyvD,WAAY,SAAW3iD,EAAG9G,GAKzB,MAHAhG,MAAKF,EAAIgN,EAAEhN,EAAIkG,EAAElG,EACjBE,KAAKD,EAAI+M,EAAE/M,EAAIiG,EAAEjG,EAEVC,MAIRk/B,SAAU,SAAW/tB,GAKpB,MAHAnR,MAAKF,GAAKqR,EAAErR,EACZE,KAAKD,GAAKoR,EAAEpR,EAELC,MAIRk4B,eAAgB,SAAW8pD,GAK1B,MAHAhiF,MAAKF,GAAKkiF,EACVhiF,KAAKD,GAAKiiF,EAEHhiF,MAIRwiF,OAAQ,SAAWrxE,GAKlB,MAHAnR,MAAKF,GAAKqR,EAAErR,EACZE,KAAKD,GAAKoR,EAAEpR,EAELC,MAIRwxD,aAAc,SAAWwwB,GAExB,MAAOhiF,MAAKk4B,eAAgB,EAAI8pD,IAIjCS,aAAc,SAAW7qB,GAExB,GAAI93D,GAAIE,KAAKF,EAAGC,EAAIC,KAAKD,EACrBsuD,EAAIuJ,EAAE13D,QAKV,OAHAF,MAAKF,EAAIuuD,EAAG,GAAMvuD,EAAIuuD,EAAG,GAAMtuD,EAAIsuD,EAAG,GACtCruD,KAAKD,EAAIsuD,EAAG,GAAMvuD,EAAIuuD,EAAG,GAAMtuD,EAAIsuD,EAAG,GAE/BruD,MAIR6E,IAAK,SAAWsM,GAKf,MAHAnR,MAAKF,EAAI6S,KAAK9N,IAAK7E,KAAKF,EAAGqR,EAAErR,GAC7BE,KAAKD,EAAI4S,KAAK9N,IAAK7E,KAAKD,EAAGoR,EAAEpR,GAEtBC,MAIR8E,IAAK,SAAWqM,GAKf,MAHAnR,MAAKF,EAAI6S,KAAK7N,IAAK9E,KAAKF,EAAGqR,EAAErR,GAC7BE,KAAKD,EAAI4S,KAAK7N,IAAK9E,KAAKD,EAAGoR,EAAEpR,GAEtBC,MAIRkhE,MAAO,SAAWr8D,EAAKC,GAOtB,MAHA9E,MAAKF,EAAI6S,KAAK7N,IAAKD,EAAI/E,EAAG6S,KAAK9N,IAAKC,EAAIhF,EAAGE,KAAKF,IAChDE,KAAKD,EAAI4S,KAAK7N,IAAKD,EAAI9E,EAAG4S,KAAK9N,IAAKC,EAAI/E,EAAGC,KAAKD,IAEzCC,MAIR0iF,YAAa,WAEZ,GAAI79E,GAAM,GAAIhF,GACViF,EAAM,GAAIjF,EAEd,OAAO,UAAsB8iF,EAAQC,GAKpC,MAHA/9E,GAAIoB,IAAK08E,EAAQA,GACjB79E,EAAImB,IAAK28E,EAAQA,GAEV5iF,KAAKkhE,MAAOr8D,EAAKC,OAM1B+9E,YAAa,SAAWh+E,EAAKC,GAE5B,GAAI1E,GAASJ,KAAKI,QAElB,OAAOJ,MAAKwxD,aAAcpxD,GAAU,GAAI83B,eAAgBvlB,KAAK7N,IAAKD,EAAK8N,KAAK9N,IAAKC,EAAK1E,MAIvFwS,MAAO,WAKN,MAHA5S,MAAKF,EAAI6S,KAAKC,MAAO5S,KAAKF,GAC1BE,KAAKD,EAAI4S,KAAKC,MAAO5S,KAAKD,GAEnBC,MAIR6hF,KAAM,WAKL,MAHA7hF,MAAKF,EAAI6S,KAAKkvE,KAAM7hF,KAAKF,GACzBE,KAAKD,EAAI4S,KAAKkvE,KAAM7hF,KAAKD,GAElBC,MAIR8iF,MAAO,WAKN,MAHA9iF,MAAKF,EAAI6S,KAAKmwE,MAAO9iF,KAAKF,GAC1BE,KAAKD,EAAI4S,KAAKmwE,MAAO9iF,KAAKD,GAEnBC,MAIR+iF,YAAa,WAKZ,MAHA/iF,MAAKF,EAAME,KAAKF,EAAI,EAAM6S,KAAKkvE,KAAM7hF,KAAKF,GAAM6S,KAAKC,MAAO5S,KAAKF,GACjEE,KAAKD,EAAMC,KAAKD,EAAI,EAAM4S,KAAKkvE,KAAM7hF,KAAKD,GAAM4S,KAAKC,MAAO5S,KAAKD,GAE1DC,MAIRumD,OAAQ,WAKP,MAHAvmD,MAAKF,GAAME,KAAKF,EAChBE,KAAKD,GAAMC,KAAKD,EAETC,MAIRwiE,IAAK,SAAWrxD,GAEf,MAAOnR,MAAKF,EAAIqR,EAAErR,EAAIE,KAAKD,EAAIoR,EAAEpR,GAIlCijF,MAAO,SAAW7xE,GAEjB,MAAOnR,MAAKF,EAAIqR,EAAEpR,EAAIC,KAAKD,EAAIoR,EAAErR,GAIlCmjF,SAAU,WAET,MAAOjjF,MAAKF,EAAIE,KAAKF,EAAIE,KAAKD,EAAIC,KAAKD,GAIxCK,OAAQ,WAEP,MAAOuS,MAAKmwC,KAAM9iD,KAAKF,EAAIE,KAAKF,EAAIE,KAAKD,EAAIC,KAAKD,IAInDmjF,gBAAiB,WAEhB,MAAOvwE,MAAK4P,IAAKviB,KAAKF,GAAM6S,KAAK4P,IAAKviB,KAAKD,IAI5C45B,UAAW,WAEV,MAAO35B,MAAKwxD,aAAcxxD,KAAKI,UAAY,IAI5Cy4B,MAAO,WAIN,GAAIA,GAAQlmB,KAAKg/C,MAAO3xD,KAAKD,EAAGC,KAAKF,EAIrC,OAFK+4B,GAAQ,IAAIA,GAAS,EAAIlmB,KAAKi+C,IAE5B/3B,GAIRsqD,WAAY,SAAWhyE,GAEtB,MAAOwB,MAAKmwC,KAAM9iD,KAAKojF,kBAAmBjyE,KAI3CiyE,kBAAmB,SAAWjyE,GAE7B,GAAIkyE,GAAKrjF,KAAKF,EAAIqR,EAAErR,EAAGwjF,EAAKtjF,KAAKD,EAAIoR,EAAEpR,CACvC,OAAOsjF,GAAKA,EAAKC,EAAKA,GAIvBC,oBAAqB,SAAWpyE,GAE/B,MAAOwB,MAAK4P,IAAKviB,KAAKF,EAAIqR,EAAErR,GAAM6S,KAAK4P,IAAKviB,KAAKD,EAAIoR,EAAEpR,IAIxD67E,UAAW,SAAWx7E,GAErB,MAAOJ,MAAK25B,YAAYzB,eAAgB93B,IAIzCgwD,KAAM,SAAWj/C,EAAGuJ,GAKnB,MAHA1a,MAAKF,IAAOqR,EAAErR,EAAIE,KAAKF,GAAM4a,EAC7B1a,KAAKD,IAAOoR,EAAEpR,EAAIC,KAAKD,GAAM2a,EAEtB1a,MAIRwjF,YAAa,SAAW5b,EAAIW,EAAI7tD,GAE/B,MAAO1a,MAAKyvD,WAAY8Y,EAAIX,GAAK1vC,eAAgBxd,GAAQ2kB,IAAKuoC,IAI/D1nC,OAAQ,SAAW/uB,GAElB,MAAWA,GAAErR,IAAME,KAAKF,GAASqR,EAAEpR,IAAMC,KAAKD,GAI/Cm4C,UAAW,SAAW7wC,EAAOzE,GAO5B,MALgB9B,UAAX8B,IAAuBA,EAAS,GAErC5C,KAAKF,EAAIuH,EAAOzE,GAChB5C,KAAKD,EAAIsH,EAAOzE,EAAS,GAElB5C,MAIR8e,QAAS,SAAWzX,EAAOzE,GAQ1B,MANe9B,UAAVuG,IAAsBA,MACXvG,SAAX8B,IAAuBA,EAAS,GAErCyE,EAAOzE,GAAW5C,KAAKF,EACvBuH,EAAOzE,EAAS,GAAM5C,KAAKD,EAEpBsH,GAIR0nD,oBAAqB,SAAW5nD,EAAWiJ,EAAOxN,GAWjD,MATgB9B,UAAX8B,GAEJvC,QAAQ4H,KAAM,uEAIfjI,KAAKF,EAAIqH,EAAU2nD,KAAM1+C,GACzBpQ,KAAKD,EAAIoH,EAAUs8E,KAAMrzE,GAElBpQ,MAIR0jF,aAAc,SAAW5gF,EAAQ+1B,GAEhC,GAAI9rB,GAAI4F,KAAKimB,IAAKC,GAASkkC,EAAIpqD,KAAK6gD,IAAK36B,GAErC/4B,EAAIE,KAAKF,EAAIgD,EAAOhD,EACpBC,EAAIC,KAAKD,EAAI+C,EAAO/C,CAKxB,OAHAC,MAAKF,EAAIA,EAAIiN,EAAIhN,EAAIg9D,EAAIj6D,EAAOhD,EAChCE,KAAKD,EAAID,EAAIi9D,EAAIh9D,EAAIgN,EAAIjK,EAAO/C,EAEzBC,QAsCT4B,OAAO48E,OAAQv+E,EAAQwzE,WAEtBkQ,WAAW,EAEX19E,IAAK,SAAW29E,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,GAE1F,GAAIC,GAAK5kF,KAAKE,QAOd,OALA0kF,GAAI,GAAMhB,EAAKgB,EAAI,GAAMf,EAAKe,EAAI,GAAMd,EAAKc,EAAI,IAAOb,EACxDa,EAAI,GAAMZ,EAAKY,EAAI,GAAMX,EAAKW,EAAI,GAAMV,EAAKU,EAAI,IAAOT,EACxDS,EAAI,GAAMR,EAAKQ,EAAI,GAAMP,EAAKO,EAAI,IAAON,EAAKM,EAAI,IAAOL,EACzDK,EAAI,GAAMJ,EAAKI,EAAI,GAAMH,EAAKG,EAAI,IAAOF,EAAKE,EAAI,IAAOD,EAElD3kF,MAIRm5B,SAAU,WAWT,MATAn5B,MAAKiG,IAEJ,EAAG,EAAG,EAAG,EACT,EAAG,EAAG,EAAG,EACT,EAAG,EAAG,EAAG,EACT,EAAG,EAAG,EAAG,GAIHjG,MAIR6K,MAAO,WAEN,OAAO,GAAI5K,IAAUi4C,UAAWl4C,KAAKE,WAItC0e,KAAM,SAAWg5C,GAEhB,GAAIgtB,GAAK5kF,KAAKE,SACV2kF,EAAKjtB,EAAE13D,QAOX,OALA0kF,GAAI,GAAMC,EAAI,GAAKD,EAAI,GAAMC,EAAI,GAAKD,EAAI,GAAMC,EAAI,GAAKD,EAAI,GAAMC,EAAI,GACvED,EAAI,GAAMC,EAAI,GAAKD,EAAI,GAAMC,EAAI,GAAKD,EAAI,GAAMC,EAAI,GAAKD,EAAI,GAAMC,EAAI,GACvED,EAAI,GAAMC,EAAI,GAAKD,EAAI,GAAMC,EAAI,GAAKD,EAAI,IAAOC,EAAI,IAAMD,EAAI,IAAOC,EAAI,IAC1ED,EAAI,IAAOC,EAAI,IAAMD,EAAI,IAAOC,EAAI,IAAMD,EAAI,IAAOC,EAAI,IAAMD,EAAI,IAAOC,EAAI,IAEvE7kF,MAIRoa,aAAc,SAAWw9C,GAExB,GAAIgtB,GAAK5kF,KAAKE,SAAU2kF,EAAKjtB,EAAE13D,QAM/B,OAJA0kF,GAAI,IAAOC,EAAI,IACfD,EAAI,IAAOC,EAAI,IACfD,EAAI,IAAOC,EAAI,IAER7kF,MAIR8kF,aAAc,SAAWC,EAAOC,EAAOC,GAMtC,MAJAF,GAAMG,oBAAqBllF,KAAM,GACjCglF,EAAME,oBAAqBllF,KAAM,GACjCilF,EAAMC,oBAAqBllF,KAAM,GAE1BA,MAIRmlF,UAAW,SAAWJ,EAAOC,EAAOC,GASnC,MAPAjlF,MAAKiG,IACJ8+E,EAAMjlF,EAAGklF,EAAMllF,EAAGmlF,EAAMnlF,EAAG,EAC3BilF,EAAMhlF,EAAGilF,EAAMjlF,EAAGklF,EAAMllF,EAAG,EAC3BglF,EAAMvkF,EAAGwkF,EAAMxkF,EAAGykF,EAAMzkF,EAAG,EAC3B,EAAG,EAAG,EAAG,GAGHR,MAIRs5B,gBAAiB,WAEhB,GAAIsuC,GAAK,GAAI7mE,EAEb,OAAO,UAA0B62D,GAIhC,GAAIgtB,GAAK5kF,KAAKE,SACV2kF,EAAKjtB,EAAE13D,SAEPklF,EAAS,EAAIxd,EAAGsd,oBAAqBttB,EAAG,GAAIx3D,SAC5CilF,EAAS,EAAIzd,EAAGsd,oBAAqBttB,EAAG,GAAIx3D,SAC5CklF,EAAS,EAAI1d,EAAGsd,oBAAqBttB,EAAG,GAAIx3D,QAsBhD,OApBAwkF,GAAI,GAAMC,EAAI,GAAMO,EACpBR,EAAI,GAAMC,EAAI,GAAMO,EACpBR,EAAI,GAAMC,EAAI,GAAMO,EACpBR,EAAI,GAAM,EAEVA,EAAI,GAAMC,EAAI,GAAMQ,EACpBT,EAAI,GAAMC,EAAI,GAAMQ,EACpBT,EAAI,GAAMC,EAAI,GAAMQ,EACpBT,EAAI,GAAM,EAEVA,EAAI,GAAMC,EAAI,GAAMS,EACpBV,EAAI,GAAMC,EAAI,GAAMS,EACpBV,EAAI,IAAOC,EAAI,IAAOS,EACtBV,EAAI,IAAO,EAEXA,EAAI,IAAO,EACXA,EAAI,IAAO,EACXA,EAAI,IAAO,EACXA,EAAI,IAAO,EAEJ5kF,SAMTulF,sBAAuB,SAAWC,GAExBA,GAASA,EAAMC,SAEvBplF,QAAQC,MAAO,wGAIhB,IAAIskF,GAAK5kF,KAAKE,SAEVJ,EAAI0lF,EAAM1lF,EAAGC,EAAIylF,EAAMzlF,EAAGS,EAAIglF,EAAMhlF,EACpCsM,EAAI6F,KAAKimB,IAAK94B,GAAKkG,EAAI2M,KAAK6gD,IAAK1zD,GACjCiN,EAAI4F,KAAKimB,IAAK74B,GAAKuS,EAAIK,KAAK6gD,IAAKzzD,GACjCsuD,EAAI17C,KAAKimB,IAAKp4B,GAAK6qC,EAAI14B,KAAK6gD,IAAKhzD,EAErC,IAAqB,QAAhBglF,EAAM37E,MAAkB,CAE5B,GAAI67E,GAAK54E,EAAIuhD,EAAGs3B,EAAK74E,EAAIu+B,EAAGu6C,EAAK5/E,EAAIqoD,EAAGw3B,EAAK7/E,EAAIqlC,CAEjDu5C,GAAI,GAAM73E,EAAIshD,EACdu2B,EAAI,IAAQ73E,EAAIs+B,EAChBu5C,EAAI,GAAMtyE,EAEVsyE,EAAI,GAAMe,EAAKC,EAAKtzE,EACpBsyE,EAAI,GAAMc,EAAKG,EAAKvzE,EACpBsyE,EAAI,IAAQ5+E,EAAI+G,EAEhB63E,EAAI,GAAMiB,EAAKH,EAAKpzE,EACpBsyE,EAAI,GAAMgB,EAAKD,EAAKrzE,EACpBsyE,EAAI,IAAO93E,EAAIC,MAET,IAAqB,QAAhBy4E,EAAM37E,MAAkB,CAEnC,GAAIi8E,GAAK/4E,EAAIshD,EAAG03B,EAAKh5E,EAAIs+B,EAAG26C,EAAK1zE,EAAI+7C,EAAG43B,EAAK3zE,EAAI+4B,CAEjDu5C,GAAI,GAAMkB,EAAKG,EAAKjgF,EACpB4+E,EAAI,GAAMoB,EAAKhgF,EAAI+/E,EACnBnB,EAAI,GAAM93E,EAAIwF,EAEdsyE,EAAI,GAAM93E,EAAIu+B,EACdu5C,EAAI,GAAM93E,EAAIuhD,EACdu2B,EAAI,IAAQ5+E,EAEZ4+E,EAAI,GAAMmB,EAAK//E,EAAIggF,EACnBpB,EAAI,GAAMqB,EAAKH,EAAK9/E,EACpB4+E,EAAI,IAAO93E,EAAIC,MAET,IAAqB,QAAhBy4E,EAAM37E,MAAkB,CAEnC,GAAIi8E,GAAK/4E,EAAIshD,EAAG03B,EAAKh5E,EAAIs+B,EAAG26C,EAAK1zE,EAAI+7C,EAAG43B,EAAK3zE,EAAI+4B,CAEjDu5C,GAAI,GAAMkB,EAAKG,EAAKjgF,EACpB4+E,EAAI,IAAQ93E,EAAIu+B,EAChBu5C,EAAI,GAAMoB,EAAKD,EAAK//E,EAEpB4+E,EAAI,GAAMmB,EAAKC,EAAKhgF,EACpB4+E,EAAI,GAAM93E,EAAIuhD,EACdu2B,EAAI,GAAMqB,EAAKH,EAAK9/E,EAEpB4+E,EAAI,IAAQ93E,EAAIwF,EAChBsyE,EAAI,GAAM5+E,EACV4+E,EAAI,IAAO93E,EAAIC,MAET,IAAqB,QAAhBy4E,EAAM37E,MAAkB,CAEnC,GAAI67E,GAAK54E,EAAIuhD,EAAGs3B,EAAK74E,EAAIu+B,EAAGu6C,EAAK5/E,EAAIqoD,EAAGw3B,EAAK7/E,EAAIqlC,CAEjDu5C,GAAI,GAAM73E,EAAIshD,EACdu2B,EAAI,GAAMgB,EAAKtzE,EAAIqzE,EACnBf,EAAI,GAAMc,EAAKpzE,EAAIuzE,EAEnBjB,EAAI,GAAM73E,EAAIs+B,EACdu5C,EAAI,GAAMiB,EAAKvzE,EAAIozE,EACnBd,EAAI,GAAMe,EAAKrzE,EAAIszE,EAEnBhB,EAAI,IAAQtyE,EACZsyE,EAAI,GAAM5+E,EAAI+G,EACd63E,EAAI,IAAO93E,EAAIC,MAET,IAAqB,QAAhBy4E,EAAM37E,MAAkB,CAEnC,GAAIq8E,GAAKp5E,EAAIC,EAAGo5E,EAAKr5E,EAAIwF,EAAG8zE,EAAKpgF,EAAI+G,EAAGs5E,EAAKrgF,EAAIsM,CAEjDsyE,GAAI,GAAM73E,EAAIshD,EACdu2B,EAAI,GAAMyB,EAAKH,EAAK76C,EACpBu5C,EAAI,GAAMwB,EAAK/6C,EAAI86C,EAEnBvB,EAAI,GAAMv5C,EACVu5C,EAAI,GAAM93E,EAAIuhD,EACdu2B,EAAI,IAAQ5+E,EAAIqoD,EAEhBu2B,EAAI,IAAQtyE,EAAI+7C,EAChBu2B,EAAI,GAAMuB,EAAK96C,EAAI+6C,EACnBxB,EAAI,IAAOsB,EAAKG,EAAKh7C,MAEf,IAAqB,QAAhBm6C,EAAM37E,MAAkB,CAEnC,GAAIq8E,GAAKp5E,EAAIC,EAAGo5E,EAAKr5E,EAAIwF,EAAG8zE,EAAKpgF,EAAI+G,EAAGs5E,EAAKrgF,EAAIsM,CAEjDsyE,GAAI,GAAM73E,EAAIshD,EACdu2B,EAAI,IAAQv5C,EACZu5C,EAAI,GAAMtyE,EAAI+7C,EAEdu2B,EAAI,GAAMsB,EAAK76C,EAAIg7C,EACnBzB,EAAI,GAAM93E,EAAIuhD,EACdu2B,EAAI,GAAMuB,EAAK96C,EAAI+6C,EAEnBxB,EAAI,GAAMwB,EAAK/6C,EAAI86C,EACnBvB,EAAI,GAAM5+E,EAAIqoD,EACdu2B,EAAI,IAAOyB,EAAKh7C,EAAI66C,EAerB,MAVAtB,GAAI,GAAM,EACVA,EAAI,GAAM,EACVA,EAAI,IAAO,EAGXA,EAAI,IAAO,EACXA,EAAI,IAAO,EACXA,EAAI,IAAO,EACXA,EAAI,IAAO,EAEJ5kF,MAIRsmF,2BAA4B,WAE3B,GAAIC,GAAO,GAAIxlF,GAAS,EAAG,EAAG,GAC1BylF,EAAM,GAAIzlF,GAAS,EAAG,EAAG,EAE7B,OAAO,UAAqC6yD,GAE3C,MAAO5zD,MAAKo4C,QAASmuC,EAAM3yB,EAAG4yB,OAMhCxnD,OAAQ,WAEP,GAAIl/B,GAAI,GAAIiB,GACRhB,EAAI,GAAIgB,GACRP,EAAI,GAAIO,EAEZ,OAAO,UAAiB0lF,EAAKxmE,EAAQtV,GAEpC,GAAIi6E,GAAK5kF,KAAKE,QAyCd,OAvCAM,GAAEivD,WAAYg3B,EAAKxmE,GAEG,IAAjBzf,EAAEyiF,aAINziF,EAAEA,EAAI,GAIPA,EAAEm5B,YACF75B,EAAE4vD,aAAc/kD,EAAInK,GAEE,IAAjBV,EAAEmjF,aAIoB,IAArBtwE,KAAK4P,IAAK5X,EAAGnK,GAEjBA,EAAEV,GAAK,KAIPU,EAAEA,GAAK,KAIRA,EAAEm5B,YACF75B,EAAE4vD,aAAc/kD,EAAInK,IAIrBV,EAAE65B,YACF55B,EAAE2vD,aAAclvD,EAAGV,GAEnB8kF,EAAI,GAAM9kF,EAAEA,EAAG8kF,EAAI,GAAM7kF,EAAED,EAAG8kF,EAAI,GAAMpkF,EAAEV,EAC1C8kF,EAAI,GAAM9kF,EAAEC,EAAG6kF,EAAI,GAAM7kF,EAAEA,EAAG6kF,EAAI,GAAMpkF,EAAET,EAC1C6kF,EAAI,GAAM9kF,EAAEU,EAAGokF,EAAI,GAAM7kF,EAAES,EAAGokF,EAAI,IAAOpkF,EAAEA,EAEpCR,SAMTk/B,SAAU,SAAW04B,EAAG5zC,GAEvB,MAAWljB,UAANkjB,GAEJ3jB,QAAQ4H,KAAM,oGACPjI,KAAK88B,iBAAkB86B,EAAG5zC,IAI3BhkB,KAAK88B,iBAAkB98B,KAAM43D,IAIrCv+B,YAAa,SAAWu+B,GAEvB,MAAO53D,MAAK88B,iBAAkB86B,EAAG53D,OAIlC88B,iBAAkB,SAAWhwB,EAAG9G,GAE/B,GAAI0/E,GAAK54E,EAAE5M,SACP0lF,EAAK5/E,EAAE9F,SACP0kF,EAAK5kF,KAAKE,SAEVwmF,EAAMhB,EAAI,GAAKiB,EAAMjB,EAAI,GAAKkB,EAAMlB,EAAI,GAAKmB,EAAMnB,EAAI,IACvDoB,EAAMpB,EAAI,GAAKqB,EAAMrB,EAAI,GAAKsB,EAAMtB,EAAI,GAAKuB,EAAMvB,EAAI,IACvDwB,EAAMxB,EAAI,GAAKyB,EAAMzB,EAAI,GAAK0B,EAAM1B,EAAI,IAAM2B,EAAM3B,EAAI,IACxD4B,EAAM5B,EAAI,GAAK6B,EAAM7B,EAAI,GAAK8B,EAAM9B,EAAI,IAAM+B,EAAM/B,EAAI,IAExDgC,EAAM9B,EAAI,GAAK+B,EAAM/B,EAAI,GAAKgC,EAAMhC,EAAI,GAAKiC,EAAMjC,EAAI,IACvDkC,EAAMlC,EAAI,GAAKmC,EAAMnC,EAAI,GAAKoC,EAAMpC,EAAI,GAAKqC,EAAMrC,EAAI,IACvDsC,EAAMtC,EAAI,GAAKuC,EAAMvC,EAAI,GAAKwC,EAAMxC,EAAI,IAAMyC,EAAMzC,EAAI,IACxD0C,EAAM1C,EAAI,GAAK2C,EAAM3C,EAAI,GAAK4C,EAAM5C,EAAI,IAAM6C,EAAM7C,EAAI,GAsB5D,OApBAhB,GAAI,GAAM8B,EAAMgB,EAAMf,EAAMmB,EAAMlB,EAAMsB,EAAMrB,EAAMyB,EACpD1D,EAAI,GAAM8B,EAAMiB,EAAMhB,EAAMoB,EAAMnB,EAAMuB,EAAMtB,EAAM0B,EACpD3D,EAAI,GAAM8B,EAAMkB,EAAMjB,EAAMqB,EAAMpB,EAAMwB,EAAMvB,EAAM2B,EACpD5D,EAAI,IAAO8B,EAAMmB,EAAMlB,EAAMsB,EAAMrB,EAAMyB,EAAMxB,EAAM4B,EAErD7D,EAAI,GAAMkC,EAAMY,EAAMX,EAAMe,EAAMd,EAAMkB,EAAMjB,EAAMqB,EACpD1D,EAAI,GAAMkC,EAAMa,EAAMZ,EAAMgB,EAAMf,EAAMmB,EAAMlB,EAAMsB,EACpD3D,EAAI,GAAMkC,EAAMc,EAAMb,EAAMiB,EAAMhB,EAAMoB,EAAMnB,EAAMuB,EACpD5D,EAAI,IAAOkC,EAAMe,EAAMd,EAAMkB,EAAMjB,EAAMqB,EAAMpB,EAAMwB,EAErD7D,EAAI,GAAMsC,EAAMQ,EAAMP,EAAMW,EAAMV,EAAMc,EAAMb,EAAMiB,EACpD1D,EAAI,GAAMsC,EAAMS,EAAMR,EAAMY,EAAMX,EAAMe,EAAMd,EAAMkB,EACpD3D,EAAI,IAAOsC,EAAMU,EAAMT,EAAMa,EAAMZ,EAAMgB,EAAMf,EAAMmB,EACrD5D,EAAI,IAAOsC,EAAMW,EAAMV,EAAMc,EAAMb,EAAMiB,EAAMhB,EAAMoB,EAErD7D,EAAI,GAAM0C,EAAMI,EAAMH,EAAMO,EAAMN,EAAMU,EAAMT,EAAMa,EACpD1D,EAAI,GAAM0C,EAAMK,EAAMJ,EAAMQ,EAAMP,EAAMW,EAAMV,EAAMc,EACpD3D,EAAI,IAAO0C,EAAMM,EAAML,EAAMS,EAAMR,EAAMY,EAAMX,EAAMe,EACrD5D,EAAI,IAAO0C,EAAMO,EAAMN,EAAMU,EAAMT,EAAMa,EAAMZ,EAAMgB,EAE9CzoF,MAIRk4B,eAAgB,SAAW6kC,GAE1B,GAAI6nB,GAAK5kF,KAAKE,QAOd,OALA0kF,GAAI,IAAO7nB,EAAG6nB,EAAI,IAAO7nB,EAAG6nB,EAAI,IAAO7nB,EAAG6nB,EAAI,KAAQ7nB,EACtD6nB,EAAI,IAAO7nB,EAAG6nB,EAAI,IAAO7nB,EAAG6nB,EAAI,IAAO7nB,EAAG6nB,EAAI,KAAQ7nB,EACtD6nB,EAAI,IAAO7nB,EAAG6nB,EAAI,IAAO7nB,EAAG6nB,EAAI,KAAQ7nB,EAAG6nB,EAAI,KAAQ7nB,EACvD6nB,EAAI,IAAO7nB,EAAG6nB,EAAI,IAAO7nB,EAAG6nB,EAAI,KAAQ7nB,EAAG6nB,EAAI,KAAQ7nB,EAEhD/8D,MAIR0oF,uBAAwB,WAEvB,GAAI9gB,GAAK,GAAI7mE,EAEb,OAAO,UAAiCoG,GAEvC,IAAM,GAAI6I,GAAI,EAAGC,EAAI9I,EAAU+B,MAAO8G,EAAIC,EAAGD,IAE5C43D,EAAG9nE,EAAIqH,EAAU2nD,KAAM9+C,GACvB43D,EAAG7nE,EAAIoH,EAAUs8E,KAAMzzE,GACvB43D,EAAGpnE,EAAI2G,EAAUwhF,KAAM34E,GAEvB43D,EAAG/oD,aAAc7e,MAEjBmH,EAAUyhF,OAAQ54E,EAAG43D,EAAG9nE,EAAG8nE,EAAG7nE,EAAG6nE,EAAGpnE,EAIrC,OAAO2G,OAMT2iD,YAAa,WAEZ,GAAI86B,GAAK5kF,KAAKE,SAEV0jF,EAAMgB,EAAI,GAAKf,EAAMe,EAAI,GAAKd,EAAMc,EAAI,GAAKb,EAAMa,EAAI,IACvDZ,EAAMY,EAAI,GAAKX,EAAMW,EAAI,GAAKV,EAAMU,EAAI,GAAKT,EAAMS,EAAI,IACvDR,EAAMQ,EAAI,GAAKP,EAAMO,EAAI,GAAKN,EAAMM,EAAI,IAAML,EAAMK,EAAI,IACxDJ,EAAMI,EAAI,GAAKH,EAAMG,EAAI,GAAKF,EAAME,EAAI,IAAMD,EAAMC,EAAI,GAK5D,OACCJ,KACGT,EAAMG,EAAMG,EACXP,EAAMK,EAAME,EACZN,EAAME,EAAMK,EACZT,EAAMM,EAAMG,EACZR,EAAMG,EAAMM,EACZV,EAAMK,EAAMK,GAEhBE,IACGb,EAAMM,EAAMK,EACXX,EAAMO,EAAMG,EACZP,EAAMC,EAAMM,EACZR,EAAME,EAAMO,EACZT,EAAMK,EAAMC,EACZL,EAAMG,EAAME,GAEhBM,IACGd,EAAMO,EAAME,EACXT,EAAMK,EAAMM,EACZR,EAAMC,EAAMK,EACZR,EAAMG,EAAMO,EACZR,EAAME,EAAMG,EACZP,EAAMM,EAAMC,GAEhBO,IACGb,EAAMG,EAAMG,EACXR,EAAMM,EAAMG,EACZT,EAAMK,EAAMK,EACZR,EAAME,EAAMK,EACZR,EAAMG,EAAMM,EACZT,EAAMK,EAAME,IAOlByE,UAAW,WAEV,GACIC,GADAlE,EAAK5kF,KAAKE,QAWd,OARA4oF,GAAMlE,EAAI,GAAKA,EAAI,GAAMA,EAAI,GAAKA,EAAI,GAAMkE,EAC5CA,EAAMlE,EAAI,GAAKA,EAAI,GAAMA,EAAI,GAAKA,EAAI,GAAMkE,EAC5CA,EAAMlE,EAAI,GAAKA,EAAI,GAAMA,EAAI,GAAKA,EAAI,GAAMkE,EAE5CA,EAAMlE,EAAI,GAAKA,EAAI,GAAMA,EAAI,IAAMA,EAAI,IAAOkE,EAC9CA,EAAMlE,EAAI,GAAKA,EAAI,GAAMA,EAAI,IAAMA,EAAI,IAAOkE,EAC9CA,EAAMlE,EAAI,IAAMA,EAAI,IAAOA,EAAI,IAAMA,EAAI,IAAOkE,EAEzC9oF,MAIR+oF,YAAa,SAAW53E,GAEvB,GAAIyzE,GAAK5kF,KAAKE,QAMd,OAJA0kF,GAAI,IAAOzzE,EAAErR,EACb8kF,EAAI,IAAOzzE,EAAEpR,EACb6kF,EAAI,IAAOzzE,EAAE3Q,EAENR,MAIRu6C,WAAY,SAAWqd,EAAGoxB,GAGzB,GAAIpE,GAAK5kF,KAAKE,SACb2kF,EAAKjtB,EAAE13D,SAEP0jF,EAAMiB,EAAI,GAAKb,EAAMa,EAAI,GAAKT,EAAMS,EAAI,GAAKL,EAAMK,EAAI,GACvDhB,EAAMgB,EAAI,GAAKZ,EAAMY,EAAI,GAAKR,EAAMQ,EAAI,GAAKJ,EAAMI,EAAI,GACvDf,EAAMe,EAAI,GAAKX,EAAMW,EAAI,GAAKP,EAAMO,EAAI,IAAMH,EAAMG,EAAI,IACxDd,EAAMc,EAAI,IAAMV,EAAMU,EAAI,IAAMN,EAAMM,EAAI,IAAMF,EAAME,EAAI,IAE1DoE,EAAM/E,EAAMK,EAAME,EAAMN,EAAMG,EAAMG,EAAMN,EAAME,EAAMK,EAAMT,EAAMM,EAAMG,EAAMR,EAAMG,EAAMM,EAAMV,EAAMK,EAAMK,EAC5GuE,EAAMnF,EAAMO,EAAMG,EAAMX,EAAMS,EAAME,EAAMV,EAAMM,EAAMK,EAAMb,EAAMU,EAAMG,EAAMZ,EAAMO,EAAMM,EAAMd,EAAMS,EAAMK,EAC5GwE,EAAMrF,EAAMK,EAAMM,EAAMV,EAAMG,EAAMO,EAAMV,EAAME,EAAMS,EAAMb,EAAMM,EAAMO,EAAMZ,EAAMG,EAAMU,EAAMd,EAAMK,EAAMS,EAC5GyE,EAAMrF,EAAMG,EAAMG,EAAMP,EAAMK,EAAME,EAAMN,EAAME,EAAMK,EAAMT,EAAMM,EAAMG,EAAMR,EAAMG,EAAMM,EAAMV,EAAMK,EAAMK,EAEzG8E,EAAMzF,EAAMqF,EAAMjF,EAAMkF,EAAM9E,EAAM+E,EAAM3E,EAAM4E,CAEpD,IAAa,IAARC,EAAY,CAEhB,GAAIC,GAAM,oEAEV,IAAKN,KAAsB,EAE1B,KAAM,IAAI1+D,OAAOg/D,EAQlB,OAJCjpF,SAAQ4H,KAAMqhF,GAIRtpF,KAAKm5B,WAIb,GAAIowD,GAAS,EAAIF,CAsBjB,OApBAzE,GAAI,GAAMqE,EAAMM,EAChB3E,EAAI,IAAQT,EAAMG,EAAME,EAAMN,EAAMK,EAAMC,EAAML,EAAMC,EAAMM,EAAMV,EAAMO,EAAMG,EAAMR,EAAME,EAAMO,EAAMX,EAAMM,EAAMK,GAAQ4E,EAC1H3E,EAAI,IAAQX,EAAMM,EAAMC,EAAML,EAAME,EAAMG,EAAML,EAAMC,EAAMK,EAAMT,EAAMO,EAAME,EAAMR,EAAMG,EAAMO,EAAMX,EAAMK,EAAMM,GAAQ4E,EAC1H3E,EAAI,IAAQV,EAAMG,EAAMG,EAAMP,EAAMK,EAAME,EAAMN,EAAME,EAAMK,EAAMT,EAAMM,EAAMG,EAAMR,EAAMG,EAAMM,EAAMV,EAAMK,EAAMK,GAAQ6E,EAE1H3E,EAAI,GAAMsE,EAAMK,EAChB3E,EAAI,IAAQd,EAAMS,EAAMC,EAAMT,EAAMO,EAAME,EAAMT,EAAMK,EAAMM,EAAMd,EAAMW,EAAMG,EAAMZ,EAAMM,EAAMO,EAAMf,EAAMU,EAAMK,GAAQ4E,EAC1H3E,EAAI,IAAQb,EAAMM,EAAMG,EAAMX,EAAMU,EAAMC,EAAMT,EAAMK,EAAMK,EAAMb,EAAMW,EAAME,EAAMZ,EAAMO,EAAMO,EAAMf,EAAMS,EAAMM,GAAQ4E,EAC1H3E,EAAI,IAAQf,EAAMS,EAAME,EAAMV,EAAMO,EAAMG,EAAMV,EAAMM,EAAMK,EAAMb,EAAMU,EAAMG,EAAMZ,EAAMO,EAAMM,EAAMd,EAAMS,EAAMK,GAAQ6E,EAE1H3E,EAAI,GAAMuE,EAAMI,EAChB3E,EAAI,IAAQb,EAAMG,EAAMM,EAAMV,EAAMK,EAAMK,EAAMT,EAAMC,EAAMU,EAAMd,EAAMO,EAAMO,EAAMZ,EAAME,EAAMW,EAAMf,EAAMM,EAAMS,GAAQ4E,EAC1H3E,EAAI,KAASf,EAAMM,EAAMK,EAAMT,EAAME,EAAMO,EAAMT,EAAMC,EAAMS,EAAMb,EAAMO,EAAMM,EAAMZ,EAAMG,EAAMW,EAAMf,EAAMK,EAAMU,GAAQ4E,EAC3H3E,EAAI,KAASd,EAAMG,EAAMO,EAAMX,EAAMK,EAAMM,EAAMV,EAAME,EAAMS,EAAMb,EAAMM,EAAMO,EAAMZ,EAAMG,EAAMU,EAAMd,EAAMK,EAAMS,GAAQ6E,EAE3H3E,EAAI,IAAOwE,EAAMG,EACjB3E,EAAI,KAASd,EAAMK,EAAMC,EAAML,EAAMG,EAAME,EAAML,EAAMC,EAAMM,EAAMV,EAAMO,EAAMG,EAAMR,EAAME,EAAMO,EAAMX,EAAMM,EAAMK,GAAQgF,EAC3H3E,EAAI,KAASb,EAAME,EAAMG,EAAMP,EAAMM,EAAMC,EAAML,EAAMC,EAAMK,EAAMT,EAAMO,EAAME,EAAMR,EAAMG,EAAMO,EAAMX,EAAMK,EAAMM,GAAQgF,EAC3H3E,EAAI,KAASf,EAAMK,EAAME,EAAMN,EAAMG,EAAMG,EAAMN,EAAME,EAAMK,EAAMT,EAAMM,EAAMG,EAAMR,EAAMG,EAAMM,EAAMV,EAAMK,EAAMK,GAAQiF,EAEpHvpF,MAIR+K,MAAO,SAAWoG,GAEjB,GAAIyzE,GAAK5kF,KAAKE,SACVJ,EAAIqR,EAAErR,EAAGC,EAAIoR,EAAEpR,EAAGS,EAAI2Q,EAAE3Q,CAO5B,OALAokF,GAAI,IAAO9kF,EAAG8kF,EAAI,IAAO7kF,EAAG6kF,EAAI,IAAOpkF,EACvCokF,EAAI,IAAO9kF,EAAG8kF,EAAI,IAAO7kF,EAAG6kF,EAAI,IAAOpkF,EACvCokF,EAAI,IAAO9kF,EAAG8kF,EAAI,IAAO7kF,EAAG6kF,EAAI,KAAQpkF,EACxCokF,EAAI,IAAO9kF,EAAG8kF,EAAI,IAAO7kF,EAAG6kF,EAAI,KAAQpkF,EAEjCR,MAIRwpF,kBAAmB,WAElB,GAAI5E,GAAK5kF,KAAKE,SAEVupF,EAAW7E,EAAI,GAAMA,EAAI,GAAMA,EAAI,GAAMA,EAAI,GAAMA,EAAI,GAAMA,EAAI,GACjE8E,EAAW9E,EAAI,GAAMA,EAAI,GAAMA,EAAI,GAAMA,EAAI,GAAMA,EAAI,GAAMA,EAAI,GACjE+E,EAAW/E,EAAI,GAAMA,EAAI,GAAMA,EAAI,GAAMA,EAAI,GAAMA,EAAI,IAAOA,EAAI,GAEtE,OAAOjyE,MAAKmwC,KAAMnwC,KAAK7N,IAAK2kF,EAAUC,EAAUC,KAIjD5qD,gBAAiB,SAAWj/B,EAAGC,EAAGS,GAWjC,MATAR,MAAKiG,IAEJ,EAAG,EAAG,EAAGnG,EACT,EAAG,EAAG,EAAGC,EACT,EAAG,EAAG,EAAGS,EACT,EAAG,EAAG,EAAG,GAIHR,MAIR4pF,cAAe,SAAW3mB,GAEzB,GAAIl2D,GAAI4F,KAAKimB,IAAKqqC,GAASlG,EAAIpqD,KAAK6gD,IAAKyP,EAWzC,OATAjjE,MAAKiG,IAEJ,EAAG,EAAG,EAAG,EACT,EAAG8G,GAAKgwD,EAAG,EACX,EAAGA,EAAGhwD,EAAG,EACT,EAAG,EAAG,EAAG,GAIH/M,MAIR6pF,cAAe,SAAW5mB,GAEzB,GAAIl2D,GAAI4F,KAAKimB,IAAKqqC,GAASlG,EAAIpqD,KAAK6gD,IAAKyP,EAWzC,OATAjjE,MAAKiG,IAEH8G,EAAG,EAAGgwD,EAAG,EACT,EAAG,EAAG,EAAG,GACRA,EAAG,EAAGhwD,EAAG,EACV,EAAG,EAAG,EAAG,GAIJ/M,MAIR8pF,cAAe,SAAW7mB,GAEzB,GAAIl2D,GAAI4F,KAAKimB,IAAKqqC,GAASlG,EAAIpqD,KAAK6gD,IAAKyP,EAWzC,OATAjjE,MAAKiG,IAEJ8G,GAAKgwD,EAAG,EAAG,EACXA,EAAGhwD,EAAG,EAAG,EACT,EAAG,EAAG,EAAG,EACT,EAAG,EAAG,EAAG,GAIH/M,MAIR+pF,iBAAkB,SAAWC,EAAMnxD,GAIlC,GAAI9rB,GAAI4F,KAAKimB,IAAKC,GACdkkC,EAAIpqD,KAAK6gD,IAAK36B,GACdu5B,EAAI,EAAIrlD,EACRjN,EAAIkqF,EAAKlqF,EAAGC,EAAIiqF,EAAKjqF,EAAGS,EAAIwpF,EAAKxpF,EACjCypF,EAAK73B,EAAItyD,EAAGoqF,EAAK93B,EAAIryD,CAWxB,OATDC,MAAKiG,IAEJgkF,EAAKnqF,EAAIiN,EAAGk9E,EAAKlqF,EAAIg9D,EAAIv8D,EAAGypF,EAAKzpF,EAAIu8D,EAAIh9D,EAAG,EAC5CkqF,EAAKlqF,EAAIg9D,EAAIv8D,EAAG0pF,EAAKnqF,EAAIgN,EAAGm9E,EAAK1pF,EAAIu8D,EAAIj9D,EAAG,EAC5CmqF,EAAKzpF,EAAIu8D,EAAIh9D,EAAGmqF,EAAK1pF,EAAIu8D,EAAIj9D,EAAGsyD,EAAI5xD,EAAIA,EAAIuM,EAAG,EAC/C,EAAG,EAAG,EAAG,GAIF/M,MAITmqF,UAAW,SAAWrqF,EAAGC,EAAGS,GAW3B,MATAR,MAAKiG,IAEJnG,EAAG,EAAG,EAAG,EACT,EAAGC,EAAG,EAAG,EACT,EAAG,EAAGS,EAAG,EACT,EAAG,EAAG,EAAG,GAIHR,MAIRoqF,UAAW,SAAWtqF,EAAGC,EAAGS,GAW3B,MATAR,MAAKiG,IAEJ,EAAGlG,EAAGS,EAAG,EACTV,EAAG,EAAGU,EAAG,EACTV,EAAGC,EAAG,EAAG,EACT,EAAG,EAAG,EAAG,GAIHC,MAIRo4C,QAAS,SAAWttC,EAAUV,EAAYW,GAEzC,GAAI65E,GAAK5kF,KAAKE,SAEVJ,EAAIsK,EAAW1J,GAAIX,EAAIqK,EAAWzJ,GAAIH,EAAI4J,EAAWxJ,GAAIH,EAAI2J,EAAWvJ,GACxEswD,EAAKrxD,EAAIA,EAAGuqF,EAAKtqF,EAAIA,EAAGuqF,EAAK9pF,EAAIA,EACjC+pF,EAAKzqF,EAAIqxD,EAAIq5B,EAAK1qF,EAAIuqF,EAAII,EAAK3qF,EAAIwqF,EACnCI,EAAK3qF,EAAIsqF,EAAIM,EAAK5qF,EAAIuqF,EAAIM,EAAKpqF,EAAI8pF,EACnCO,EAAKpqF,EAAI0wD,EAAI25B,EAAKrqF,EAAI4pF,EAAIU,EAAKtqF,EAAI6pF,EAEnCU,EAAKjgF,EAAMjL,EAAGmrF,EAAKlgF,EAAMhL,EAAGmrF,EAAKngF,EAAMvK,CAsBpC,OApBAokF,GAAI,IAAQ,GAAM8F,EAAKE,IAASI,EAChCpG,EAAI,IAAQ4F,EAAKO,GAAOC,EACxBpG,EAAI,IAAQ6F,EAAKK,GAAOE,EACxBpG,EAAI,GAAM,EAEVA,EAAI,IAAQ4F,EAAKO,GAAOE,EACxBrG,EAAI,IAAQ,GAAM2F,EAAKK,IAASK,EAChCrG,EAAI,IAAQ+F,EAAKE,GAAOI,EACxBrG,EAAI,GAAM,EAEVA,EAAI,IAAQ6F,EAAKK,GAAOI,EACxBtG,EAAI,IAAQ+F,EAAKE,GAAOK,EACxBtG,EAAI,KAAS,GAAM2F,EAAKG,IAASQ,EACjCtG,EAAI,IAAO,EAEXA,EAAI,IAAO95E,EAAShL,EACpB8kF,EAAI,IAAO95E,EAAS/K,EACpB6kF,EAAI,IAAO95E,EAAStK,EACpBokF,EAAI,IAAO,EAEJ5kF,MAIfs4C,UAAW,WAEV,GAAInmC,GAAS,GAAIpR,GACbkC,EAAS,GAAIhD,EAEjB,OAAO,UAAoB6K,EAAUV,EAAYW,GAEhD,GAAI65E,GAAK5kF,KAAKE,SAEV8qF,EAAK74E,EAAOlM,IAAK2+E,EAAI,GAAKA,EAAI,GAAKA,EAAI,IAAMxkF,SAC7C6qF,EAAK94E,EAAOlM,IAAK2+E,EAAI,GAAKA,EAAI,GAAKA,EAAI,IAAMxkF,SAC7C8qF,EAAK/4E,EAAOlM,IAAK2+E,EAAI,GAAKA,EAAI,GAAKA,EAAI,KAAOxkF,SAG9CipF,EAAMrpF,KAAK8pD,aACVu/B,GAAM,IAAI2B,GAAOA,GAEtBlgF,EAAShL,EAAI8kF,EAAI,IACjB95E,EAAS/K,EAAI6kF,EAAI,IACjB95E,EAAStK,EAAIokF,EAAI,IAGjB3hF,EAAO2b,KAAM5e,KAEb,IAAImrF,GAAQ,EAAIH,EACZI,EAAQ,EAAIH,EACZI,EAAQ,EAAIH,CAoBhB,OAlBAjoF,GAAO/C,SAAU,IAAOirF,EACxBloF,EAAO/C,SAAU,IAAOirF,EACxBloF,EAAO/C,SAAU,IAAOirF,EAExBloF,EAAO/C,SAAU,IAAOkrF,EACxBnoF,EAAO/C,SAAU,IAAOkrF,EACxBnoF,EAAO/C,SAAU,IAAOkrF,EAExBnoF,EAAO/C,SAAU,IAAOmrF,EACxBpoF,EAAO/C,SAAU,IAAOmrF,EACxBpoF,EAAO/C,SAAU,KAAQmrF,EAEzBjhF,EAAW+vC,sBAAuBl3C,GAElC8H,EAAMjL,EAAIkrF,EACVjgF,EAAMhL,EAAIkrF,EACVlgF,EAAMvK,EAAI0qF,EAEHlrF,SAMTsrF,gBAAiB,SAAWl/E,EAAMC,EAAOC,EAAKC,EAAQC,EAAMC,GAE9C3L,SAAR2L,GAEJpM,QAAQ4H,KAAM,uGAIf,IAAI28E,GAAK5kF,KAAKE,SACVJ,EAAI,EAAI0M,GAASH,EAAQD,GACzBrM,EAAI,EAAIyM,GAASF,EAAMC,GAEvBO,GAAMT,EAAQD,IAAWC,EAAQD,GACjCpG,GAAMsG,EAAMC,IAAaD,EAAMC,GAC/BQ,IAAQN,EAAMD,IAAWC,EAAMD,GAC/B8F,KAAU7F,EAAMD,GAASC,EAAMD,EAOnC,OALAo4E,GAAI,GAAM9kF,EAAG8kF,EAAI,GAAM,EAAGA,EAAI,GAAM93E,EAAG83E,EAAI,IAAO,EAClDA,EAAI,GAAM,EAAGA,EAAI,GAAM7kF,EAAG6kF,EAAI,GAAM5+E,EAAG4+E,EAAI,IAAO,EAClDA,EAAI,GAAM,EAAGA,EAAI,GAAM,EAAGA,EAAI,IAAO73E,EAAG63E,EAAI,IAAOtyE,EACnDsyE,EAAI,GAAM,EAAGA,EAAI,GAAM,EAAGA,EAAI,OAAYA,EAAI,IAAO,EAE9C5kF,MAIRurF,iBAAkB,SAAWn/E,EAAMC,EAAOC,EAAKC,EAAQC,EAAMC,GAE5D,GAAIm4E,GAAK5kF,KAAKE,SACVO,EAAI,GAAQ4L,EAAQD,GACpBuwD,EAAI,GAAQrwD,EAAMC,GAClB4oB,EAAI,GAAQ1oB,EAAMD,GAElB1M,GAAMuM,EAAQD,GAAS3L,EACvBV,GAAMuM,EAAMC,GAAWowD,EACvBn8D,GAAMiM,EAAMD,GAAS2oB,CAOzB,OALAyvD,GAAI,GAAM,EAAInkF,EAAGmkF,EAAI,GAAM,EAAGA,EAAI,GAAM,EAAGA,EAAI,KAAS9kF,EACxD8kF,EAAI,GAAM,EAAGA,EAAI,GAAM,EAAIjoB,EAAGioB,EAAI,GAAM,EAAGA,EAAI,KAAS7kF,EACxD6kF,EAAI,GAAM,EAAGA,EAAI,GAAM,EAAGA,EAAI,OAAazvD,EAAGyvD,EAAI,KAASpkF,EAC3DokF,EAAI,GAAM,EAAGA,EAAI,GAAM,EAAGA,EAAI,IAAO,EAAGA,EAAI,IAAO,EAE5C5kF,MAIRkgC,OAAQ,SAAWj9B,GAKlB,IAAM,GAHF2hF,GAAK5kF,KAAKE,SACV2kF,EAAK5hF,EAAO/C,SAEN8P,EAAI,EAAGA,EAAI,GAAIA,IAExB,GAAK40E,EAAI50E,KAAQ60E,EAAI70E,GAAM,OAAO,CAInC,QAAO,GAIRkoC,UAAW,SAAW7wC,EAAOzE,GAEZ9B,SAAX8B,IAAuBA,EAAS,EAErC,KAAM,GAAIoN,GAAI,EAAGA,EAAI,GAAIA,IAExBhQ,KAAKE,SAAU8P,GAAM3I,EAAO2I,EAAIpN,EAIjC,OAAO5C,OAIR8e,QAAS,SAAWzX,EAAOzE,GAEX9B,SAAVuG,IAAsBA,MACXvG,SAAX8B,IAAuBA,EAAS,EAErC,IAAIgiF,GAAK5kF,KAAKE,QAsBd,OApBAmH,GAAOzE,GAAWgiF,EAAI,GACtBv9E,EAAOzE,EAAS,GAAMgiF,EAAI,GAC1Bv9E,EAAOzE,EAAS,GAAMgiF,EAAI,GAC1Bv9E,EAAOzE,EAAS,GAAMgiF,EAAI,GAE1Bv9E,EAAOzE,EAAS,GAAMgiF,EAAI,GAC1Bv9E,EAAOzE,EAAS,GAAMgiF,EAAI,GAC1Bv9E,EAAOzE,EAAS,GAAMgiF,EAAI,GAC1Bv9E,EAAOzE,EAAS,GAAMgiF,EAAI,GAE1Bv9E,EAAOzE,EAAS,GAAMgiF,EAAI,GAC1Bv9E,EAAOzE,EAAS,GAAMgiF,EAAI,GAC1Bv9E,EAAOzE,EAAS,IAAOgiF,EAAI,IAC3Bv9E,EAAOzE,EAAS,IAAOgiF,EAAI,IAE3Bv9E,EAAOzE,EAAS,IAAOgiF,EAAI,IAC3Bv9E,EAAOzE,EAAS,IAAOgiF,EAAI,IAC3Bv9E,EAAOzE,EAAS,IAAOgiF,EAAI,IAC3Bv9E,EAAOzE,EAAS,IAAOgiF,EAAI,IAEpBv9E,KAsBTzF,OAAO48E,OAAQj+E,GAEdirF,MAAO,SAAWC,EAAIC,EAAIC,EAAIv5B,GAE7B,MAAOu5B,GAAG/sE,KAAM6sE,GAAKD,MAAOE,EAAIt5B,IAIjCw5B,UAAW,SAAWC,EAAK3tE,EAAW4tE,EAAMC,EAAYC,EAAMC,EAAY75B,GAIzE,GAAInB,GAAK66B,EAAMC,EAAa,GAC3BG,EAAKJ,EAAMC,EAAa,GACxBI,EAAKL,EAAMC,EAAa,GACxBK,EAAKN,EAAMC,EAAa,GAExB76B,EAAK86B,EAAMC,EAAa,GACxBI,EAAKL,EAAMC,EAAa,GACxBK,EAAKN,EAAMC,EAAa,GACxBM,EAAKP,EAAMC,EAAa,EAEzB,IAAKG,IAAOG,GAAMt7B,IAAOC,GAAMg7B,IAAOG,GAAMF,IAAOG,EAAK,CAEvD,GAAIvvB,GAAI,EAAI3K,EAEXx5B,EAAMq4B,EAAKC,EAAKg7B,EAAKG,EAAKF,EAAKG,EAAKF,EAAKG,EAEzClR,EAAQziD,GAAO,EAAI,KACnB4zD,EAAS,EAAI5zD,EAAMA,CAGpB,IAAK4zD,EAASpxB,OAAOC,QAAU,CAE9B,GAAI7H,GAAM7gD,KAAKmwC,KAAM0pC,GACpBn1B,EAAM1kD,KAAKg/C,MAAO6B,EAAK56B,EAAMyiD,EAE9Bte,GAAIpqD,KAAK6gD,IAAKuJ,EAAI1F,GAAQ7D,EAC1BpB,EAAIz/C,KAAK6gD,IAAKpB,EAAIiF,GAAQ7D,EAI3B,GAAIi5B,GAAOr6B,EAAIipB,CAQf,IANApqB,EAAKA,EAAK8L,EAAI7L,EAAKu7B,EACnBP,EAAKA,EAAKnvB,EAAIsvB,EAAKI,EACnBN,EAAKA,EAAKpvB,EAAIuvB,EAAKG,EACnBL,EAAKA,EAAKrvB,EAAIwvB,EAAKE,EAGd1vB,IAAM,EAAI3K,EAAI,CAElB,GAAI/mB,GAAI,EAAI14B,KAAKmwC,KAAMmO,EAAKA,EAAKi7B,EAAKA,EAAKC,EAAKA,EAAKC,EAAKA,EAE1Dn7B,IAAM5lB,EACN6gD,GAAM7gD,EACN8gD,GAAM9gD,EACN+gD,GAAM/gD,GAMRwgD,EAAK3tE,GAAc+yC,EACnB46B,EAAK3tE,EAAY,GAAMguE,EACvBL,EAAK3tE,EAAY,GAAMiuE,EACvBN,EAAK3tE,EAAY,GAAMkuE,KAMzBxqF,OAAOqJ,iBAAkB1K,EAAWkzE,WAEnC3zE,GAECuJ,IAAK,WAEJ,MAAOrJ,MAAKU,IAIbuF,IAAK,SAAWnE,GAEf9B,KAAKU,GAAKoB,EACV9B,KAAK0sF,qBAMP3sF,GAECsJ,IAAK,WAEJ,MAAOrJ,MAAKW,IAIbsF,IAAK,SAAWnE,GAEf9B,KAAKW,GAAKmB,EACV9B,KAAK0sF,qBAMPlsF,GAEC6I,IAAK,WAEJ,MAAOrJ,MAAKY,IAIbqF,IAAK,SAAWnE,GAEf9B,KAAKY,GAAKkB,EACV9B,KAAK0sF,qBAMPjsF,GAEC4I,IAAK,WAEJ,MAAOrJ,MAAKa,IAIboF,IAAK,SAAWnE,GAEf9B,KAAKa,GAAKiB,EACV9B,KAAK0sF,uBAQR9qF,OAAO48E,OAAQj+E,EAAWkzE,WAEzBxtE,IAAK,SAAWnG,EAAGC,EAAGS,EAAGC,GASxB,MAPAT,MAAKU,GAAKZ,EACVE,KAAKW,GAAKZ,EACVC,KAAKY,GAAKJ,EACVR,KAAKa,GAAKJ,EAEVT,KAAK0sF,mBAEE1sF,MAIR6K,MAAO,WAEN,MAAO,IAAI7K,MAAKuqE,YAAavqE,KAAKU,GAAIV,KAAKW,GAAIX,KAAKY,GAAIZ,KAAKa,KAI9D+d,KAAM,SAAWxU,GAShB,MAPApK,MAAKU,GAAK0J,EAAWtK,EACrBE,KAAKW,GAAKyJ,EAAWrK,EACrBC,KAAKY,GAAKwJ,EAAW5J,EACrBR,KAAKa,GAAKuJ,EAAW3J,EAErBT,KAAK0sF,mBAEE1sF,MAIRqK,aAAc,SAAWm7E,EAAO97E,GAE/B,IAAS87E,IAASA,EAAMC,QAEvB,KAAM,IAAIn7D,OAAO,mGAIlB,IAAIxqB,GAAI0lF,EAAM9kF,GAAIX,EAAIylF,EAAM7kF,GAAIH,EAAIglF,EAAM5kF,GAAIiJ,EAAQ27E,EAAM37E,MAMxD+uB,EAAMjmB,KAAKimB,IACX46B,EAAM7gD,KAAK6gD,IAEXmT,EAAK/tC,EAAK94B,EAAI,GACd8mE,EAAKhuC,EAAK74B,EAAI,GACd8mE,EAAKjuC,EAAKp4B,EAAI,GAEdmsF,EAAKn5B,EAAK1zD,EAAI,GACd8sF,EAAKp5B,EAAKzzD,EAAI,GACd8sF,EAAKr5B,EAAKhzD,EAAI,EAgDlB,OA9Ce,QAAVqJ,GAEJ7J,KAAKU,GAAKisF,EAAK/lB,EAAKC,EAAKF,EAAKimB,EAAKC,EACnC7sF,KAAKW,GAAKgmE,EAAKimB,EAAK/lB,EAAK8lB,EAAK/lB,EAAKimB,EACnC7sF,KAAKY,GAAK+lE,EAAKC,EAAKimB,EAAKF,EAAKC,EAAK/lB,EACnC7mE,KAAKa,GAAK8lE,EAAKC,EAAKC,EAAK8lB,EAAKC,EAAKC,GAEd,QAAVhjF,GAEX7J,KAAKU,GAAKisF,EAAK/lB,EAAKC,EAAKF,EAAKimB,EAAKC,EACnC7sF,KAAKW,GAAKgmE,EAAKimB,EAAK/lB,EAAK8lB,EAAK/lB,EAAKimB,EACnC7sF,KAAKY,GAAK+lE,EAAKC,EAAKimB,EAAKF,EAAKC,EAAK/lB,EACnC7mE,KAAKa,GAAK8lE,EAAKC,EAAKC,EAAK8lB,EAAKC,EAAKC,GAEd,QAAVhjF,GAEX7J,KAAKU,GAAKisF,EAAK/lB,EAAKC,EAAKF,EAAKimB,EAAKC,EACnC7sF,KAAKW,GAAKgmE,EAAKimB,EAAK/lB,EAAK8lB,EAAK/lB,EAAKimB,EACnC7sF,KAAKY,GAAK+lE,EAAKC,EAAKimB,EAAKF,EAAKC,EAAK/lB,EACnC7mE,KAAKa,GAAK8lE,EAAKC,EAAKC,EAAK8lB,EAAKC,EAAKC,GAEd,QAAVhjF,GAEX7J,KAAKU,GAAKisF,EAAK/lB,EAAKC,EAAKF,EAAKimB,EAAKC,EACnC7sF,KAAKW,GAAKgmE,EAAKimB,EAAK/lB,EAAK8lB,EAAK/lB,EAAKimB,EACnC7sF,KAAKY,GAAK+lE,EAAKC,EAAKimB,EAAKF,EAAKC,EAAK/lB,EACnC7mE,KAAKa,GAAK8lE,EAAKC,EAAKC,EAAK8lB,EAAKC,EAAKC,GAEd,QAAVhjF,GAEX7J,KAAKU,GAAKisF,EAAK/lB,EAAKC,EAAKF,EAAKimB,EAAKC,EACnC7sF,KAAKW,GAAKgmE,EAAKimB,EAAK/lB,EAAK8lB,EAAK/lB,EAAKimB,EACnC7sF,KAAKY,GAAK+lE,EAAKC,EAAKimB,EAAKF,EAAKC,EAAK/lB,EACnC7mE,KAAKa,GAAK8lE,EAAKC,EAAKC,EAAK8lB,EAAKC,EAAKC,GAEd,QAAVhjF,IAEX7J,KAAKU,GAAKisF,EAAK/lB,EAAKC,EAAKF,EAAKimB,EAAKC,EACnC7sF,KAAKW,GAAKgmE,EAAKimB,EAAK/lB,EAAK8lB,EAAK/lB,EAAKimB,EACnC7sF,KAAKY,GAAK+lE,EAAKC,EAAKimB,EAAKF,EAAKC,EAAK/lB,EACnC7mE,KAAKa,GAAK8lE,EAAKC,EAAKC,EAAK8lB,EAAKC,EAAKC,GAI/BnjF,KAAW,GAAQ1J,KAAK0sF,mBAEtB1sF,MAIR8sF,iBAAkB,SAAW9C,EAAMnxD,GAMlC,GAAIk0D,GAAYl0D,EAAQ,EAAGkkC,EAAIpqD,KAAK6gD,IAAKu5B,EASzC,OAPA/sF,MAAKU,GAAKspF,EAAKlqF,EAAIi9D,EACnB/8D,KAAKW,GAAKqpF,EAAKjqF,EAAIg9D,EACnB/8D,KAAKY,GAAKopF,EAAKxpF,EAAIu8D,EACnB/8D,KAAKa,GAAK8R,KAAKimB,IAAKm0D,GAEpB/sF,KAAK0sF,mBAEE1sF,MAIRm6C,sBAAuB,SAAWyd,GAMjC,GAOCmF,GAPG6nB,EAAKhtB,EAAE13D,SAEV8sF,EAAMpI,EAAI,GAAKqI,EAAMrI,EAAI,GAAKsI,EAAMtI,EAAI,GACxCuI,EAAMvI,EAAI,GAAKwI,EAAMxI,EAAI,GAAKyI,EAAMzI,EAAI,GACxC0I,EAAM1I,EAAI,GAAK2I,EAAM3I,EAAI,GAAK4I,EAAM5I,EAAI,IAExC6I,EAAQT,EAAMI,EAAMI,CA2CrB,OAxCKC,GAAQ,GAEZ1wB,EAAI,GAAMpqD,KAAKmwC,KAAM2qC,EAAQ,GAE7BztF,KAAKa,GAAK,IAAOk8D,EACjB/8D,KAAKU,IAAO6sF,EAAMF,GAAQtwB,EAC1B/8D,KAAKW,IAAOusF,EAAMI,GAAQvwB,EAC1B/8D,KAAKY,IAAOusF,EAAMF,GAAQlwB,GAEfiwB,EAAMI,GAAOJ,EAAMQ,GAE9BzwB,EAAI,EAAMpqD,KAAKmwC,KAAM,EAAMkqC,EAAMI,EAAMI,GAEvCxtF,KAAKa,IAAO0sF,EAAMF,GAAQtwB,EAC1B/8D,KAAKU,GAAK,IAAOq8D,EACjB/8D,KAAKW,IAAOssF,EAAME,GAAQpwB,EAC1B/8D,KAAKY,IAAOssF,EAAMI,GAAQvwB,GAEfqwB,EAAMI,GAEjBzwB,EAAI,EAAMpqD,KAAKmwC,KAAM,EAAMsqC,EAAMJ,EAAMQ,GAEvCxtF,KAAKa,IAAOqsF,EAAMI,GAAQvwB,EAC1B/8D,KAAKU,IAAOusF,EAAME,GAAQpwB,EAC1B/8D,KAAKW,GAAK,IAAOo8D,EACjB/8D,KAAKY,IAAOysF,EAAME,GAAQxwB,IAI1BA,EAAI,EAAMpqD,KAAKmwC,KAAM,EAAM0qC,EAAMR,EAAMI,GAEvCptF,KAAKa,IAAOssF,EAAMF,GAAQlwB,EAC1B/8D,KAAKU,IAAOwsF,EAAMI,GAAQvwB,EAC1B/8D,KAAKW,IAAO0sF,EAAME,GAAQxwB,EAC1B/8D,KAAKY,GAAK,IAAOm8D,GAIlB/8D,KAAK0sF,mBAEE1sF,MAIR0tF,mBAAoB,WAInB,GACI5nF,GADA8hE,EAAK,GAAI7mE,GAGTsuD,EAAM,IAEV,OAAO,UAA6Bs+B,EAAOC,GA+B1C,MA7BY9sF,UAAP8mE,IAAmBA,EAAK,GAAI7mE,IAEjC+E,EAAI6nF,EAAMnrB,IAAKorB,GAAQ,EAElB9nF,EAAIupD,GAERvpD,EAAI,EAEC6M,KAAK4P,IAAKorE,EAAM7tF,GAAM6S,KAAK4P,IAAKorE,EAAMntF,GAE1ConE,EAAG3hE,KAAO0nF,EAAM5tF,EAAG4tF,EAAM7tF,EAAG,GAI5B8nE,EAAG3hE,IAAK,GAAK0nF,EAAMntF,EAAGmtF,EAAM5tF,IAM7B6nE,EAAGlY,aAAci+B,EAAOC,GAIzB5tF,KAAKU,GAAKknE,EAAG9nE,EACbE,KAAKW,GAAKinE,EAAG7nE,EACbC,KAAKY,GAAKgnE,EAAGpnE,EACbR,KAAKa,GAAKiF,EAEH9F,KAAK25B,gBAMdk0D,QAAS,SAAWj6B,GAEnB,MAAO,GAAIjhD,KAAKm7E,KAAMn7E,KAAK4P,IAAKtgB,GAAMi/D,MAAOlhE,KAAKwiE,IAAK5O,MAAU,MAIlEm6B,cAAe,SAAWn6B,EAAG+lB,GAE5B,GAAI9gD,GAAQ74B,KAAK6tF,QAASj6B,EAE1B,IAAe,IAAV/6B,EAAc,MAAO74B,KAE1B,IAAIoyD,GAAIz/C,KAAK9N,IAAK,EAAG80E,EAAO9gD,EAI5B,OAFA74B,MAAKwrF,MAAO53B,EAAGxB,GAERpyD,MAIRguF,QAAS,WAIR,MAAOhuF,MAAKiuF,aAIbA,UAAW,WAQV,MANAjuF,MAAKU,OACLV,KAAKW,OACLX,KAAKY,OAELZ,KAAK0sF,mBAEE1sF,MAIRwiE,IAAK,SAAWrxD,GAEf,MAAOnR,MAAKU,GAAKyQ,EAAEzQ,GAAKV,KAAKW,GAAKwQ,EAAExQ,GAAKX,KAAKY,GAAKuQ,EAAEvQ,GAAKZ,KAAKa,GAAKsQ,EAAEtQ,IAIvEoiF,SAAU,WAET,MAAOjjF,MAAKU,GAAKV,KAAKU,GAAKV,KAAKW,GAAKX,KAAKW,GAAKX,KAAKY,GAAKZ,KAAKY,GAAKZ,KAAKa,GAAKb,KAAKa,IAInFT,OAAQ,WAEP,MAAOuS,MAAKmwC,KAAM9iD,KAAKU,GAAKV,KAAKU,GAAKV,KAAKW,GAAKX,KAAKW,GAAKX,KAAKY,GAAKZ,KAAKY,GAAKZ,KAAKa,GAAKb,KAAKa,KAI9F84B,UAAW,WAEV,GAAI1pB,GAAIjQ,KAAKI,QAsBb,OApBW,KAAN6P,GAEJjQ,KAAKU,GAAK,EACVV,KAAKW,GAAK,EACVX,KAAKY,GAAK,EACVZ,KAAKa,GAAK,IAIVoP,EAAI,EAAIA,EAERjQ,KAAKU,GAAKV,KAAKU,GAAKuP,EACpBjQ,KAAKW,GAAKX,KAAKW,GAAKsP,EACpBjQ,KAAKY,GAAKZ,KAAKY,GAAKqP,EACpBjQ,KAAKa,GAAKb,KAAKa,GAAKoP,GAIrBjQ,KAAK0sF,mBAEE1sF,MAIRk/B,SAAU,SAAW00B,EAAGz+B,GAEvB,MAAWr0B,UAANq0B,GAEJ90B,QAAQ4H,KAAM,0GACPjI,KAAKkuF,oBAAqBt6B,EAAGz+B,IAI9Bn1B,KAAKkuF,oBAAqBluF,KAAM4zD,IAIxCv6B,YAAa,SAAWu6B,GAEvB,MAAO5zD,MAAKkuF,oBAAqBt6B,EAAG5zD,OAIrCkuF,oBAAqB,SAAWphF,EAAG9G,GAIlC,GAAImoF,GAAMrhF,EAAEpM,GAAI0tF,EAAMthF,EAAEnM,GAAI0tF,EAAMvhF,EAAElM,GAAI0tF,EAAMxhF,EAAEjM,GAC5C0tF,EAAMvoF,EAAEtF,GAAI8tF,EAAMxoF,EAAErF,GAAI8tF,EAAMzoF,EAAEpF,GAAI8tF,EAAM1oF,EAAEnF,EAShD,OAPAb,MAAKU,GAAKytF,EAAMO,EAAMJ,EAAMC,EAAMH,EAAMK,EAAMJ,EAAMG,EACpDxuF,KAAKW,GAAKytF,EAAMM,EAAMJ,EAAME,EAAMH,EAAME,EAAMJ,EAAMM,EACpDzuF,KAAKY,GAAKytF,EAAMK,EAAMJ,EAAMG,EAAMN,EAAMK,EAAMJ,EAAMG,EACpDvuF,KAAKa,GAAKytF,EAAMI,EAAMP,EAAMI,EAAMH,EAAMI,EAAMH,EAAMI,EAEpDzuF,KAAK0sF,mBAEE1sF,MAIRwrF,MAAO,SAAWE,EAAIt5B,GAErB,GAAW,IAANA,EAAU,MAAOpyD,KACtB,IAAW,IAANoyD,EAAU,MAAOpyD,MAAK4e,KAAM8sE,EAEjC,IAAI5rF,GAAIE,KAAKU,GAAIX,EAAIC,KAAKW,GAAIH,EAAIR,KAAKY,GAAIH,EAAIT,KAAKa,GAIhD8tF,EAAeluF,EAAIirF,EAAG7qF,GAAKf,EAAI4rF,EAAGhrF,GAAKX,EAAI2rF,EAAG/qF,GAAKH,EAAIkrF,EAAG9qF,EAiB9D,IAfK+tF,EAAe,GAEnB3uF,KAAKa,IAAO6qF,EAAG7qF,GACfb,KAAKU,IAAOgrF,EAAGhrF,GACfV,KAAKW,IAAO+qF,EAAG/qF,GACfX,KAAKY,IAAO8qF,EAAG9qF,GAEf+tF,GAAiBA,GAIjB3uF,KAAK4e,KAAM8sE,GAIPiD,GAAgB,EAOpB,MALA3uF,MAAKa,GAAKJ,EACVT,KAAKU,GAAKZ,EACVE,KAAKW,GAAKZ,EACVC,KAAKY,GAAKJ,EAEHR,IAIR,IAAI4uF,GAAkB,EAAMD,EAAeA,CAE3C,IAAKC,GAAmBxzB,OAAOC,QAAU,CAExC,GAAI0B,GAAI,EAAI3K,CAMZ,OALApyD,MAAKa,GAAKk8D,EAAIt8D,EAAI2xD,EAAIpyD,KAAKa,GAC3Bb,KAAKU,GAAKq8D,EAAIj9D,EAAIsyD,EAAIpyD,KAAKU,GAC3BV,KAAKW,GAAKo8D,EAAIh9D,EAAIqyD,EAAIpyD,KAAKW,GAC3BX,KAAKY,GAAKm8D,EAAIv8D,EAAI4xD,EAAIpyD,KAAKY,GAEpBZ,KAAK25B,YAIb,GAAIk1D,GAAel8E,KAAKmwC,KAAM8rC,GAC1BE,EAAYn8E,KAAKg/C,MAAOk9B,EAAcF,GACtCI,EAASp8E,KAAK6gD,KAAO,EAAIpB,GAAM08B,GAAcD,EAChDG,EAASr8E,KAAK6gD,IAAKpB,EAAI08B,GAAcD,CAStC,OAPA7uF,MAAKa,GAAOJ,EAAIsuF,EAAS/uF,KAAKa,GAAKmuF,EACnChvF,KAAKU,GAAOZ,EAAIivF,EAAS/uF,KAAKU,GAAKsuF,EACnChvF,KAAKW,GAAOZ,EAAIgvF,EAAS/uF,KAAKW,GAAKquF,EACnChvF,KAAKY,GAAOJ,EAAIuuF,EAAS/uF,KAAKY,GAAKouF,EAEnChvF,KAAK0sF,mBAEE1sF,MAIRkgC,OAAQ,SAAW91B,GAElB,MAASA,GAAW1J,KAAOV,KAAKU,IAAU0J,EAAWzJ,KAAOX,KAAKW,IAAUyJ,EAAWxJ,KAAOZ,KAAKY,IAAUwJ,EAAWvJ,KAAOb,KAAKa,IAIpIq3C,UAAW,SAAW7wC,EAAOzE,GAW5B,MATgB9B,UAAX8B,IAAuBA,EAAS,GAErC5C,KAAKU,GAAK2G,EAAOzE,GACjB5C,KAAKW,GAAK0G,EAAOzE,EAAS,GAC1B5C,KAAKY,GAAKyG,EAAOzE,EAAS,GAC1B5C,KAAKa,GAAKwG,EAAOzE,EAAS,GAE1B5C,KAAK0sF,mBAEE1sF,MAIR8e,QAAS,SAAWzX,EAAOzE,GAU1B,MARe9B,UAAVuG,IAAsBA,MACXvG,SAAX8B,IAAuBA,EAAS,GAErCyE,EAAOzE,GAAW5C,KAAKU,GACvB2G,EAAOzE,EAAS,GAAM5C,KAAKW,GAC3B0G,EAAOzE,EAAS,GAAM5C,KAAKY,GAC3ByG,EAAOzE,EAAS,GAAM5C,KAAKa,GAEpBwG,GAIR2D,SAAU,SAAWlE,GAIpB,MAFA9G,MAAK0sF,iBAAmB5lF,EAEjB9G,MAIR0sF,iBAAkB,eAqBnB9qF,OAAO48E,OAAQz9E,EAAQ0yE,WAEtBvmE,WAAW,EAEXjH,IAAK,SAAWnG,EAAGC,EAAGS,GAMrB,MAJAR,MAAKF,EAAIA,EACTE,KAAKD,EAAIA,EACTC,KAAKQ,EAAIA,EAEFR,MAIR+hF,UAAW,SAAWC,GAMrB,MAJAhiF,MAAKF,EAAIkiF,EACThiF,KAAKD,EAAIiiF,EACThiF,KAAKQ,EAAIwhF,EAEFhiF,MAIRiiF,KAAM,SAAWniF,GAIhB,MAFAE,MAAKF,EAAIA,EAEFE,MAIRkiF,KAAM,SAAWniF,GAIhB,MAFAC,MAAKD,EAAIA,EAEFC,MAIRivF,KAAM,SAAWzuF,GAIhB,MAFAR,MAAKQ,EAAIA,EAEFR,MAIRmiF,aAAc,SAAW/xE,EAAOtO,GAE/B,OAASsO,GAER,IAAK,GAAGpQ,KAAKF,EAAIgC,CAAO,MACxB,KAAK,GAAG9B,KAAKD,EAAI+B,CAAO,MACxB,KAAK,GAAG9B,KAAKQ,EAAIsB,CAAO,MACxB,SAAS,KAAM,IAAIwoB,OAAO,0BAA4Bla,GAIvD,MAAOpQ,OAIRoiF,aAAc,SAAWhyE,GAExB,OAASA,GAER,IAAK,GAAG,MAAOpQ,MAAKF,CACpB,KAAK,GAAG,MAAOE,MAAKD,CACpB,KAAK,GAAG,MAAOC,MAAKQ,CACpB,SAAS,KAAM,IAAI8pB,OAAO,0BAA4Bla,KAMxDvF,MAAO,WAEN,MAAO,IAAI7K,MAAKuqE,YAAavqE,KAAKF,EAAGE,KAAKD,EAAGC,KAAKQ,IAInDoe,KAAM,SAAWzN,GAMhB,MAJAnR,MAAKF,EAAIqR,EAAErR,EACXE,KAAKD,EAAIoR,EAAEpR,EACXC,KAAKQ,EAAI2Q,EAAE3Q,EAEJR,MAIRq/B,IAAK,SAAWluB,EAAG1Q,GAElB,MAAWK,UAANL,GAEJJ,QAAQ4H,KAAM,yFACPjI,KAAKu0D,WAAYpjD,EAAG1Q,KAI5BT,KAAKF,GAAKqR,EAAErR,EACZE,KAAKD,GAAKoR,EAAEpR,EACZC,KAAKQ,GAAK2Q,EAAE3Q,EAELR,OAIRqiF,UAAW,SAAWtlB,GAMrB,MAJA/8D,MAAKF,GAAKi9D,EACV/8D,KAAKD,GAAKg9D,EACV/8D,KAAKQ,GAAKu8D,EAEH/8D,MAIRu0D,WAAY,SAAWznD,EAAG9G,GAMzB,MAJAhG,MAAKF,EAAIgN,EAAEhN,EAAIkG,EAAElG,EACjBE,KAAKD,EAAI+M,EAAE/M,EAAIiG,EAAEjG,EACjBC,KAAKQ,EAAIsM,EAAEtM,EAAIwF,EAAExF,EAEVR,MAIRsiF,gBAAiB,SAAWnxE,EAAG4rD,GAM9B,MAJA/8D,MAAKF,GAAKqR,EAAErR,EAAIi9D,EAChB/8D,KAAKD,GAAKoR,EAAEpR,EAAIg9D,EAChB/8D,KAAKQ,GAAK2Q,EAAE3Q,EAAIu8D,EAET/8D,MAIRq4B,IAAK,SAAWlnB,EAAG1Q,GAElB,MAAWK,UAANL,GAEJJ,QAAQ4H,KAAM,yFACPjI,KAAKyvD,WAAYt+C,EAAG1Q,KAI5BT,KAAKF,GAAKqR,EAAErR,EACZE,KAAKD,GAAKoR,EAAEpR,EACZC,KAAKQ,GAAK2Q,EAAE3Q,EAELR,OAIRuiF,UAAW,SAAWxlB,GAMrB,MAJA/8D,MAAKF,GAAKi9D,EACV/8D,KAAKD,GAAKg9D,EACV/8D,KAAKQ,GAAKu8D,EAEH/8D,MAIRyvD,WAAY,SAAW3iD,EAAG9G,GAMzB,MAJAhG,MAAKF,EAAIgN,EAAEhN,EAAIkG,EAAElG,EACjBE,KAAKD,EAAI+M,EAAE/M,EAAIiG,EAAEjG,EACjBC,KAAKQ,EAAIsM,EAAEtM,EAAIwF,EAAExF,EAEVR,MAIRk/B,SAAU,SAAW/tB,EAAG1Q,GAEvB,MAAWK,UAANL,GAEJJ,QAAQ4H,KAAM,mGACPjI,KAAKkvF,gBAAiB/9E,EAAG1Q,KAIjCT,KAAKF,GAAKqR,EAAErR,EACZE,KAAKD,GAAKoR,EAAEpR,EACZC,KAAKQ,GAAK2Q,EAAE3Q,EAELR,OAIRk4B,eAAgB,SAAW8pD,GAM1B,MAJAhiF,MAAKF,GAAKkiF,EACVhiF,KAAKD,GAAKiiF,EACVhiF,KAAKQ,GAAKwhF,EAEHhiF,MAIRkvF,gBAAiB,SAAWpiF,EAAG9G,GAM9B,MAJAhG,MAAKF,EAAIgN,EAAEhN,EAAIkG,EAAElG,EACjBE,KAAKD,EAAI+M,EAAE/M,EAAIiG,EAAEjG,EACjBC,KAAKQ,EAAIsM,EAAEtM,EAAIwF,EAAExF,EAEVR,MAIRmvF,WAAY,WAEX,GAAI/kF,GAAa,GAAI7J,EAErB,OAAO,UAAqBilF,GAQ3B,MANSA,IAASA,EAAMC,SAEvBplF,QAAQC,MAAO,+FAITN,KAAKo6C,gBAAiBhwC,EAAWC,aAAcm7E,QAMxD4J,eAAgB,WAEf,GAAIhlF,GAAa,GAAI7J,EAErB,OAAO,UAAyBypF,EAAMnxD,GAErC,MAAO74B,MAAKo6C,gBAAiBhwC,EAAW0iF,iBAAkB9C,EAAMnxD,QAMlE4pD,aAAc,SAAW7qB,GAExB,GAAI93D,GAAIE,KAAKF,EAAGC,EAAIC,KAAKD,EAAGS,EAAIR,KAAKQ,EACjC6tD,EAAIuJ,EAAE13D,QAMV,OAJAF,MAAKF,EAAIuuD,EAAG,GAAMvuD,EAAIuuD,EAAG,GAAMtuD,EAAIsuD,EAAG,GAAM7tD,EAC5CR,KAAKD,EAAIsuD,EAAG,GAAMvuD,EAAIuuD,EAAG,GAAMtuD,EAAIsuD,EAAG,GAAM7tD,EAC5CR,KAAKQ,EAAI6tD,EAAG,GAAMvuD,EAAIuuD,EAAG,GAAMtuD,EAAIsuD,EAAG,GAAM7tD,EAErCR,MAIR6e,aAAc,SAAW+4C,GAExB,GAAI93D,GAAIE,KAAKF,EAAGC,EAAIC,KAAKD,EAAGS,EAAIR,KAAKQ,EACjC6tD,EAAIuJ,EAAE13D,SAENO,EAAI,GAAM4tD,EAAG,GAAMvuD,EAAIuuD,EAAG,GAAMtuD,EAAIsuD,EAAG,IAAO7tD,EAAI6tD,EAAG,IAMzD,OAJAruD,MAAKF,GAAMuuD,EAAG,GAAMvuD,EAAIuuD,EAAG,GAAMtuD,EAAIsuD,EAAG,GAAM7tD,EAAI6tD,EAAG,KAAS5tD,EAC9DT,KAAKD,GAAMsuD,EAAG,GAAMvuD,EAAIuuD,EAAG,GAAMtuD,EAAIsuD,EAAG,GAAM7tD,EAAI6tD,EAAG,KAAS5tD,EAC9DT,KAAKQ,GAAM6tD,EAAG,GAAMvuD,EAAIuuD,EAAG,GAAMtuD,EAAIsuD,EAAG,IAAO7tD,EAAI6tD,EAAG,KAAS5tD,EAExDT,MAIRo6C,gBAAiB,SAAWwZ,GAE3B,GAAI9zD,GAAIE,KAAKF,EAAGC,EAAIC,KAAKD,EAAGS,EAAIR,KAAKQ,EACjCu3D,EAAKnE,EAAE9zD,EAAGuvF,EAAKz7B,EAAE7zD,EAAGuvF,EAAK17B,EAAEpzD,EAAG+uF,EAAK37B,EAAEnzD,EAIrC+Q,EAAK+9E,EAAKzvF,EAAIuvF,EAAK7uF,EAAI8uF,EAAKvvF,EAC5B0R,EAAK89E,EAAKxvF,EAAIuvF,EAAKxvF,EAAIi4D,EAAKv3D,EAC5BgvF,EAAKD,EAAK/uF,EAAIu3D,EAAKh4D,EAAIsvF,EAAKvvF,EAC5B2vF,GAAO13B,EAAKj4D,EAAIuvF,EAAKtvF,EAAIuvF,EAAK9uF,CAQlC,OAJAR,MAAKF,EAAI0R,EAAK+9E,EAAKE,GAAO13B,EAAKtmD,GAAO69E,EAAKE,GAAOH,EAClDrvF,KAAKD,EAAI0R,EAAK89E,EAAKE,GAAOJ,EAAKG,GAAOz3B,EAAKvmD,GAAO89E,EAClDtvF,KAAKQ,EAAIgvF,EAAKD,EAAKE,GAAOH,EAAK99E,GAAO69E,EAAK59E,GAAOsmD,EAE3C/3D,MAIR+9E,QAAS,SAAW7kE,GAEnB,MAAOlZ,MAAK6e,aAAc3F,EAAOlN,oBAAqB6S,aAAc3F,EAAOjN,mBAI5EgyE,UAAW,WAEV,GAAIh7E,GAAS,GAAIhD,EAEjB,OAAO,UAAoBiZ,GAE1B,MAAOlZ,MAAK6e,aAAc5b,EAAOs3C,WAAYrhC,EAAOjN,mBAAqB4S,aAAc3F,EAAO7N,iBAMhGitB,mBAAoB,SAAWs/B,GAK9B,GAAI93D,GAAIE,KAAKF,EAAGC,EAAIC,KAAKD,EAAGS,EAAIR,KAAKQ,EACjC6tD,EAAIuJ,EAAE13D,QAMV,OAJAF,MAAKF,EAAIuuD,EAAG,GAAMvuD,EAAIuuD,EAAG,GAAMtuD,EAAIsuD,EAAG,GAAM7tD,EAC5CR,KAAKD,EAAIsuD,EAAG,GAAMvuD,EAAIuuD,EAAG,GAAMtuD,EAAIsuD,EAAG,GAAM7tD,EAC5CR,KAAKQ,EAAI6tD,EAAG,GAAMvuD,EAAIuuD,EAAG,GAAMtuD,EAAIsuD,EAAG,IAAO7tD,EAEtCR,KAAK25B,aAIb6oD,OAAQ,SAAWrxE,GAMlB,MAJAnR,MAAKF,GAAKqR,EAAErR,EACZE,KAAKD,GAAKoR,EAAEpR,EACZC,KAAKQ,GAAK2Q,EAAE3Q,EAELR,MAIRwxD,aAAc,SAAWwwB,GAExB,MAAOhiF,MAAKk4B,eAAgB,EAAI8pD,IAIjCn9E,IAAK,SAAWsM,GAMf,MAJAnR,MAAKF,EAAI6S,KAAK9N,IAAK7E,KAAKF,EAAGqR,EAAErR,GAC7BE,KAAKD,EAAI4S,KAAK9N,IAAK7E,KAAKD,EAAGoR,EAAEpR,GAC7BC,KAAKQ,EAAImS,KAAK9N,IAAK7E,KAAKQ,EAAG2Q,EAAE3Q,GAEtBR,MAIR8E,IAAK,SAAWqM,GAMf,MAJAnR,MAAKF,EAAI6S,KAAK7N,IAAK9E,KAAKF,EAAGqR,EAAErR,GAC7BE,KAAKD,EAAI4S,KAAK7N,IAAK9E,KAAKD,EAAGoR,EAAEpR,GAC7BC,KAAKQ,EAAImS,KAAK7N,IAAK9E,KAAKQ,EAAG2Q,EAAE3Q,GAEtBR,MAIRkhE,MAAO,SAAWr8D,EAAKC,GAQtB,MAJA9E,MAAKF,EAAI6S,KAAK7N,IAAKD,EAAI/E,EAAG6S,KAAK9N,IAAKC,EAAIhF,EAAGE,KAAKF,IAChDE,KAAKD,EAAI4S,KAAK7N,IAAKD,EAAI9E,EAAG4S,KAAK9N,IAAKC,EAAI/E,EAAGC,KAAKD,IAChDC,KAAKQ,EAAImS,KAAK7N,IAAKD,EAAIrE,EAAGmS,KAAK9N,IAAKC,EAAItE,EAAGR,KAAKQ,IAEzCR,MAIR0iF,YAAa,WAEZ,GAAI79E,GAAM,GAAI9D,GACV+D,EAAM,GAAI/D,EAEd,OAAO,UAAsB4hF,EAAQC,GAKpC,MAHA/9E,GAAIoB,IAAK08E,EAAQA,EAAQA,GACzB79E,EAAImB,IAAK28E,EAAQA,EAAQA,GAElB5iF,KAAKkhE,MAAOr8D,EAAKC,OAM1B+9E,YAAa,SAAWh+E,EAAKC,GAE5B,GAAI1E,GAASJ,KAAKI,QAElB,OAAOJ,MAAKwxD,aAAcpxD,GAAU,GAAI83B,eAAgBvlB,KAAK7N,IAAKD,EAAK8N,KAAK9N,IAAKC,EAAK1E,MAIvFwS,MAAO,WAMN,MAJA5S,MAAKF,EAAI6S,KAAKC,MAAO5S,KAAKF,GAC1BE,KAAKD,EAAI4S,KAAKC,MAAO5S,KAAKD,GAC1BC,KAAKQ,EAAImS,KAAKC,MAAO5S,KAAKQ,GAEnBR,MAIR6hF,KAAM,WAML,MAJA7hF,MAAKF,EAAI6S,KAAKkvE,KAAM7hF,KAAKF,GACzBE,KAAKD,EAAI4S,KAAKkvE,KAAM7hF,KAAKD,GACzBC,KAAKQ,EAAImS,KAAKkvE,KAAM7hF,KAAKQ,GAElBR,MAIR8iF,MAAO,WAMN,MAJA9iF,MAAKF,EAAI6S,KAAKmwE,MAAO9iF,KAAKF,GAC1BE,KAAKD,EAAI4S,KAAKmwE,MAAO9iF,KAAKD,GAC1BC,KAAKQ,EAAImS,KAAKmwE,MAAO9iF,KAAKQ,GAEnBR,MAIR+iF,YAAa,WAMZ,MAJA/iF,MAAKF,EAAME,KAAKF,EAAI,EAAM6S,KAAKkvE,KAAM7hF,KAAKF,GAAM6S,KAAKC,MAAO5S,KAAKF,GACjEE,KAAKD,EAAMC,KAAKD,EAAI,EAAM4S,KAAKkvE,KAAM7hF,KAAKD,GAAM4S,KAAKC,MAAO5S,KAAKD,GACjEC,KAAKQ,EAAMR,KAAKQ,EAAI,EAAMmS,KAAKkvE,KAAM7hF,KAAKQ,GAAMmS,KAAKC,MAAO5S,KAAKQ,GAE1DR,MAIRumD,OAAQ,WAMP,MAJAvmD,MAAKF,GAAME,KAAKF,EAChBE,KAAKD,GAAMC,KAAKD,EAChBC,KAAKQ,GAAMR,KAAKQ,EAETR,MAIRwiE,IAAK,SAAWrxD,GAEf,MAAOnR,MAAKF,EAAIqR,EAAErR,EAAIE,KAAKD,EAAIoR,EAAEpR,EAAIC,KAAKQ,EAAI2Q,EAAE3Q,GAMjDyiF,SAAU,WAET,MAAOjjF,MAAKF,EAAIE,KAAKF,EAAIE,KAAKD,EAAIC,KAAKD,EAAIC,KAAKQ,EAAIR,KAAKQ,GAI1DJ,OAAQ,WAEP,MAAOuS,MAAKmwC,KAAM9iD,KAAKF,EAAIE,KAAKF,EAAIE,KAAKD,EAAIC,KAAKD,EAAIC,KAAKQ,EAAIR,KAAKQ,IAIrE0iF,gBAAiB,WAEhB,MAAOvwE,MAAK4P,IAAKviB,KAAKF,GAAM6S,KAAK4P,IAAKviB,KAAKD,GAAM4S,KAAK4P,IAAKviB,KAAKQ,IAIjEm5B,UAAW,WAEV,MAAO35B,MAAKwxD,aAAcxxD,KAAKI,UAAY,IAI5Cw7E,UAAW,SAAWx7E,GAErB,MAAOJ,MAAK25B,YAAYzB,eAAgB93B,IAIzCgwD,KAAM,SAAWj/C,EAAGuJ,GAMnB,MAJA1a,MAAKF,IAAOqR,EAAErR,EAAIE,KAAKF,GAAM4a,EAC7B1a,KAAKD,IAAOoR,EAAEpR,EAAIC,KAAKD,GAAM2a,EAC7B1a,KAAKQ,IAAO2Q,EAAE3Q,EAAIR,KAAKQ,GAAMka,EAEtB1a,MAIRwjF,YAAa,SAAW5b,EAAIW,EAAI7tD;AAE/B,MAAO1a,MAAKyvD,WAAY8Y,EAAIX,GAAK1vC,eAAgBxd,GAAQ2kB,IAAKuoC,IAI/Dob,MAAO,SAAW7xE,EAAG1Q,GAEpB,MAAWK,UAANL,GAEJJ,QAAQ4H,KAAM,6FACPjI,KAAK0vD,aAAcv+C,EAAG1Q,IAIvBT,KAAK0vD,aAAc1vD,KAAMmR,IAIjCu+C,aAAc,SAAW5iD,EAAG9G,GAE3B,GAAI2yD,GAAK7rD,EAAEhN,EAAG84D,EAAK9rD,EAAE/M,EAAG2vF,EAAK5iF,EAAEtM,EAC3Bq4D,EAAK7yD,EAAElG,EAAGg5D,EAAK9yD,EAAEjG,EAAG4vF,EAAK3pF,EAAExF,CAM/B,OAJAR,MAAKF,EAAI84D,EAAK+2B,EAAKD,EAAK52B,EACxB94D,KAAKD,EAAI2vF,EAAK72B,EAAKF,EAAKg3B,EACxB3vF,KAAKQ,EAAIm4D,EAAKG,EAAKF,EAAKC,EAEjB74D,MAIR4vF,gBAAiB,SAAWz9E,GAE3B,GAAI6vE,GAAS7vE,EAAOqwD,IAAKxiE,MAASmS,EAAO8wE,UAEzC,OAAOjjF,MAAK4e,KAAMzM,GAAS+lB,eAAgB8pD,IAI5C6N,eAAgB,WAEf,GAAIjoB,GAAK,GAAI7mE,EAEb,OAAO,UAAyB+uF,GAI/B,MAFAloB,GAAGhpD,KAAM5e,MAAO4vF,gBAAiBE,GAE1B9vF,KAAKq4B,IAAKuvC,OAMnBmoB,QAAS,WAKR,GAAInoB,GAAK,GAAI7mE,EAEb,OAAO,UAAkBoE,GAExB,MAAOnF,MAAKq4B,IAAKuvC,EAAGhpD,KAAMzZ,GAAS+yB,eAAgB,EAAIl4B,KAAKwiE,IAAKr9D,SAMnE0oF,QAAS,SAAW18E,GAEnB,GAAI8xD,GAAQjjE,KAAKwiE,IAAKrxD,GAAQwB,KAAKmwC,KAAM9iD,KAAKijF,WAAa9xE,EAAE8xE,WAI7D,OAAOtwE,MAAKm7E,KAAM7rF,GAAMi/D,MAAO+B,KAAY,KAI5CkgB,WAAY,SAAWhyE,GAEtB,MAAOwB,MAAKmwC,KAAM9iD,KAAKojF,kBAAmBjyE,KAI3CiyE,kBAAmB,SAAWjyE,GAE7B,GAAIkyE,GAAKrjF,KAAKF,EAAIqR,EAAErR,EAAGwjF,EAAKtjF,KAAKD,EAAIoR,EAAEpR,EAAGiwF,EAAKhwF,KAAKQ,EAAI2Q,EAAE3Q,CAE1D,OAAO6iF,GAAKA,EAAKC,EAAKA,EAAK0M,EAAKA,GAIjCzM,oBAAqB,SAAWpyE,GAE/B,MAAOwB,MAAK4P,IAAKviB,KAAKF,EAAIqR,EAAErR,GAAM6S,KAAK4P,IAAKviB,KAAKD,EAAIoR,EAAEpR,GAAM4S,KAAK4P,IAAKviB,KAAKQ,EAAI2Q,EAAE3Q,IAInFyvF,iBAAkB,SAAWlzB,GAE5B,MAAO/8D,MAAKkwF,uBAAwBnzB,EAAE93D,OAAQ83D,EAAEsE,IAAKtE,EAAEkG,QAIxDitB,uBAAwB,SAAWjrF,EAAQo8D,EAAK4B,GAE/C,GAAIktB,GAAex9E,KAAK6gD,IAAK6N,GAAQp8D,CAMrC,OAJAjF,MAAKF,EAAIqwF,EAAex9E,KAAK6gD,IAAKyP,GAClCjjE,KAAKD,EAAI4S,KAAKimB,IAAKyoC,GAAQp8D,EAC3BjF,KAAKQ,EAAI2vF,EAAex9E,KAAKimB,IAAKqqC,GAE3BjjE,MAIRowF,mBAAoB,SAAWrjF,GAE9B,MAAO/M,MAAKqwF,yBAA0BtjF,EAAE9H,OAAQ8H,EAAEk2D,MAAOl2D,EAAEhN,IAI5DswF,yBAA0B,SAAWprF,EAAQg+D,EAAOljE,GAMnD,MAJAC,MAAKF,EAAImF,EAAS0N,KAAK6gD,IAAKyP,GAC5BjjE,KAAKD,EAAIA,EACTC,KAAKQ,EAAIyE,EAAS0N,KAAKimB,IAAKqqC,GAErBjjE,MAIRm4B,sBAAuB,SAAWy/B,GAEjC,GAAIvJ,GAAIuJ,EAAE13D,QAMV,OAJAF,MAAKF,EAAIuuD,EAAG,IACZruD,KAAKD,EAAIsuD,EAAG,IACZruD,KAAKQ,EAAI6tD,EAAG,IAELruD,MAIRswF,mBAAoB,SAAW14B,GAE9B,GAAIozB,GAAKhrF,KAAKklF,oBAAqBttB,EAAG,GAAIx3D,SACtC6qF,EAAKjrF,KAAKklF,oBAAqBttB,EAAG,GAAIx3D,SACtC8qF,EAAKlrF,KAAKklF,oBAAqBttB,EAAG,GAAIx3D,QAM1C,OAJAJ,MAAKF,EAAIkrF,EACThrF,KAAKD,EAAIkrF,EACTjrF,KAAKQ,EAAI0qF,EAEFlrF,MAIRklF,oBAAqB,SAAWttB,EAAGxnD,GAElC,MAAOpQ,MAAKk4C,UAAW0f,EAAE13D,SAAkB,EAARkQ,IAIpC8vB,OAAQ,SAAW/uB,GAElB,MAAWA,GAAErR,IAAME,KAAKF,GAASqR,EAAEpR,IAAMC,KAAKD,GAASoR,EAAE3Q,IAAMR,KAAKQ,GAIrE03C,UAAW,SAAW7wC,EAAOzE,GAQ5B,MANgB9B,UAAX8B,IAAuBA,EAAS,GAErC5C,KAAKF,EAAIuH,EAAOzE,GAChB5C,KAAKD,EAAIsH,EAAOzE,EAAS,GACzB5C,KAAKQ,EAAI6G,EAAOzE,EAAS,GAElB5C,MAIR8e,QAAS,SAAWzX,EAAOzE,GAS1B,MAPe9B,UAAVuG,IAAsBA,MACXvG,SAAX8B,IAAuBA,EAAS,GAErCyE,EAAOzE,GAAW5C,KAAKF,EACvBuH,EAAOzE,EAAS,GAAM5C,KAAKD,EAC3BsH,EAAOzE,EAAS,GAAM5C,KAAKQ,EAEpB6G,GAIR0nD,oBAAqB,SAAW5nD,EAAWiJ,EAAOxN,GAYjD,MAVgB9B,UAAX8B,GAEJvC,QAAQ4H,KAAM,uEAIfjI,KAAKF,EAAIqH,EAAU2nD,KAAM1+C,GACzBpQ,KAAKD,EAAIoH,EAAUs8E,KAAMrzE,GACzBpQ,KAAKQ,EAAI2G,EAAUwhF,KAAMv4E,GAElBpQ,QA+BT4B,OAAO48E,OAAQx9E,EAAQyyE,WAEtB8c,WAAW,EAEXtqF,IAAK,SAAW29E,EAAKC,EAAKC,EAAKE,EAAKC,EAAKC,EAAKE,EAAKC,EAAKC,GAEvD,GAAIM,GAAK5kF,KAAKE,QAMd,OAJA0kF,GAAI,GAAMhB,EAAKgB,EAAI,GAAMZ,EAAKY,EAAI,GAAMR,EACxCQ,EAAI,GAAMf,EAAKe,EAAI,GAAMX,EAAKW,EAAI,GAAMP,EACxCO,EAAI,GAAMd,EAAKc,EAAI,GAAMV,EAAKU,EAAI,GAAMN,EAEjCtkF,MAIRm5B,SAAU,WAUT,MARAn5B,MAAKiG,IAEJ,EAAG,EAAG,EACN,EAAG,EAAG,EACN,EAAG,EAAG,GAIAjG,MAIR6K,MAAO,WAEN,OAAO,GAAI7K,MAAKuqE,aAAcryB,UAAWl4C,KAAKE,WAI/C0e,KAAM,SAAWg5C,GAEhB,GAAIgtB,GAAK5kF,KAAKE,SACV2kF,EAAKjtB,EAAE13D,QAMX,OAJA0kF,GAAI,GAAMC,EAAI,GAAKD,EAAI,GAAMC,EAAI,GAAKD,EAAI,GAAMC,EAAI,GACpDD,EAAI,GAAMC,EAAI,GAAKD,EAAI,GAAMC,EAAI,GAAKD,EAAI,GAAMC,EAAI,GACpDD,EAAI,GAAMC,EAAI,GAAKD,EAAI,GAAMC,EAAI,GAAKD,EAAI,GAAMC,EAAI,GAE7C7kF,MAIRwwF,eAAgB,SAAW54B,GAE1B,GAAIitB,GAAKjtB,EAAE13D,QAUX,OARAF,MAAKiG,IAEJ4+E,EAAI,GAAKA,EAAI,GAAKA,EAAI,GACtBA,EAAI,GAAKA,EAAI,GAAKA,EAAI,GACtBA,EAAI,GAAKA,EAAI,GAAKA,EAAI,KAIhB7kF,MAIR0oF,uBAAwB,WAEvB,GAAI9gB,GAAK,GAAI7mE,EAEb,OAAO,UAAiCoG,GAEvC,IAAM,GAAI6I,GAAI,EAAGC,EAAI9I,EAAU+B,MAAO8G,EAAIC,EAAGD,IAE5C43D,EAAG9nE,EAAIqH,EAAU2nD,KAAM9+C,GACvB43D,EAAG7nE,EAAIoH,EAAUs8E,KAAMzzE,GACvB43D,EAAGpnE,EAAI2G,EAAUwhF,KAAM34E,GAEvB43D,EAAG6a,aAAcziF,MAEjBmH,EAAUyhF,OAAQ54E,EAAG43D,EAAG9nE,EAAG8nE,EAAG7nE,EAAG6nE,EAAGpnE,EAIrC,OAAO2G,OAMT+3B,SAAU,SAAW04B,GAEpB,MAAO53D,MAAK88B,iBAAkB98B,KAAM43D,IAIrCv+B,YAAa,SAAWu+B,GAEvB,MAAO53D,MAAK88B,iBAAkB86B,EAAG53D,OAIlC88B,iBAAkB,SAAWhwB,EAAG9G,GAE/B,GAAI0/E,GAAK54E,EAAE5M,SACP0lF,EAAK5/E,EAAE9F,SACP0kF,EAAK5kF,KAAKE,SAEVwmF,EAAMhB,EAAI,GAAKiB,EAAMjB,EAAI,GAAKkB,EAAMlB,EAAI,GACxCoB,EAAMpB,EAAI,GAAKqB,EAAMrB,EAAI,GAAKsB,EAAMtB,EAAI,GACxCwB,EAAMxB,EAAI,GAAKyB,EAAMzB,EAAI,GAAK0B,EAAM1B,EAAI,GAExCgC,EAAM9B,EAAI,GAAK+B,EAAM/B,EAAI,GAAKgC,EAAMhC,EAAI,GACxCkC,EAAMlC,EAAI,GAAKmC,EAAMnC,EAAI,GAAKoC,EAAMpC,EAAI,GACxCsC,EAAMtC,EAAI,GAAKuC,EAAMvC,EAAI,GAAKwC,EAAMxC,EAAI,EAc5C,OAZAhB,GAAI,GAAM8B,EAAMgB,EAAMf,EAAMmB,EAAMlB,EAAMsB,EACxCtD,EAAI,GAAM8B,EAAMiB,EAAMhB,EAAMoB,EAAMnB,EAAMuB,EACxCvD,EAAI,GAAM8B,EAAMkB,EAAMjB,EAAMqB,EAAMpB,EAAMwB,EAExCxD,EAAI,GAAMkC,EAAMY,EAAMX,EAAMe,EAAMd,EAAMkB,EACxCtD,EAAI,GAAMkC,EAAMa,EAAMZ,EAAMgB,EAAMf,EAAMmB,EACxCvD,EAAI,GAAMkC,EAAMc,EAAMb,EAAMiB,EAAMhB,EAAMoB,EAExCxD,EAAI,GAAMsC,EAAMQ,EAAMP,EAAMW,EAAMV,EAAMc,EACxCtD,EAAI,GAAMsC,EAAMS,EAAMR,EAAMY,EAAMX,EAAMe,EACxCvD,EAAI,GAAMsC,EAAMU,EAAMT,EAAMa,EAAMZ,EAAMgB,EAEjCpoF,MAIRk4B,eAAgB,SAAW6kC,GAE1B,GAAI6nB,GAAK5kF,KAAKE,QAMd,OAJA0kF,GAAI,IAAO7nB,EAAG6nB,EAAI,IAAO7nB,EAAG6nB,EAAI,IAAO7nB,EACvC6nB,EAAI,IAAO7nB,EAAG6nB,EAAI,IAAO7nB,EAAG6nB,EAAI,IAAO7nB,EACvC6nB,EAAI,IAAO7nB,EAAG6nB,EAAI,IAAO7nB,EAAG6nB,EAAI,IAAO7nB,EAEhC/8D,MAIR8pD,YAAa,WAEZ,GAAI86B,GAAK5kF,KAAKE,SAEV4M,EAAI83E,EAAI,GAAK5+E,EAAI4+E,EAAI,GAAK73E,EAAI63E,EAAI,GACrCtyE,EAAIsyE,EAAI,GAAKv2B,EAAIu2B,EAAI,GAAKv5C,EAAIu5C,EAAI,GAClC7+E,EAAI6+E,EAAI,GAAKjoB,EAAIioB,EAAI,GAAK50E,EAAI40E,EAAI,EAEnC,OAAO93E,GAAIuhD,EAAIr+C,EAAIlD,EAAIu+B,EAAIsxB,EAAI32D,EAAIsM,EAAItC,EAAIhK,EAAIqlC,EAAItlC,EAAIgH,EAAIuF,EAAIqqD,EAAI5vD,EAAIshD,EAAItoD,GAI5Ew0C,WAAY,SAAWt3C,EAAQ+lF,GAEzB/lF,GAAUA,EAAO0gF,WAErBtjF,QAAQC,MAAO,mEAIhB,IAAIukF,GAAK5hF,EAAO/C,SACf0kF,EAAK5kF,KAAKE,SAEV0jF,EAAMiB,EAAI,GAAKb,EAAMa,EAAI,GAAKT,EAAMS,EAAI,GACxChB,EAAMgB,EAAI,GAAKZ,EAAMY,EAAI,GAAKR,EAAMQ,EAAI,GACxCf,EAAMe,EAAI,GAAKX,EAAMW,EAAI,GAAKP,EAAMO,EAAI,GAExCoE,EAAM3E,EAAML,EAAMI,EAAMH,EACxBgF,EAAM7E,EAAMP,EAAMQ,EAAMT,EACxBsF,EAAMjF,EAAML,EAAMI,EAAMH,EAExBuF,EAAMzF,EAAMqF,EAAMjF,EAAMkF,EAAM9E,EAAM+E,CAErC,IAAa,IAARE,EAAY,CAEhB,GAAIC,GAAM,oEAEV,IAAKN,KAAsB,EAE1B,KAAM,IAAI1+D,OAAOg/D,EAQlB,OAJCjpF,SAAQ4H,KAAMqhF,GAIRtpF,KAAKm5B,WAIb,GAAIowD,GAAS,EAAIF,CAcjB,OAZAzE,GAAI,GAAMqE,EAAMM,EAChB3E,EAAI,IAAQR,EAAMF,EAAMI,EAAMN,GAAQuF,EACtC3E,EAAI,IAAQP,EAAML,EAAMI,EAAMH,GAAQsF,EAEtC3E,EAAI,GAAMsE,EAAMK,EAChB3E,EAAI,IAAQN,EAAMV,EAAMQ,EAAMN,GAAQyF,EACtC3E,EAAI,IAAQR,EAAMP,EAAMQ,EAAMT,GAAQ2F,EAEtC3E,EAAI,GAAMuE,EAAMI,EAChB3E,EAAI,IAAQZ,EAAMF,EAAMI,EAAMN,GAAQ2F,EACtC3E,EAAI,IAAQX,EAAML,EAAMI,EAAMH,GAAQ0F,EAE/BvpF,MAIR6oF,UAAW,WAEV,GAAIC,GAAKlxB,EAAI53D,KAAKE,QAMlB,OAJA4oF,GAAMlxB,EAAG,GAAKA,EAAG,GAAMA,EAAG,GAAKA,EAAG,GAAMkxB,EACxCA,EAAMlxB,EAAG,GAAKA,EAAG,GAAMA,EAAG,GAAKA,EAAG,GAAMkxB,EACxCA,EAAMlxB,EAAG,GAAKA,EAAG,GAAMA,EAAG,GAAKA,EAAG,GAAMkxB,EAEjC9oF,MAIRye,gBAAiB,SAAW2a,GAE3B,MAAOp5B,MAAKwwF,eAAgBp3D,GAAUmhB,WAAYv6C,MAAO6oF,aAI1D4H,mBAAoB,SAAW3qF,GAE9B,GAAI8xD,GAAI53D,KAAKE,QAYb,OAVA4F,GAAG,GAAM8xD,EAAG,GACZ9xD,EAAG,GAAM8xD,EAAG,GACZ9xD,EAAG,GAAM8xD,EAAG,GACZ9xD,EAAG,GAAM8xD,EAAG,GACZ9xD,EAAG,GAAM8xD,EAAG,GACZ9xD,EAAG,GAAM8xD,EAAG,GACZ9xD,EAAG,GAAM8xD,EAAG,GACZ9xD,EAAG,GAAM8xD,EAAG,GACZ9xD,EAAG,GAAM8xD,EAAG,GAEL53D,MAIR0wF,eAAgB,SAAWzG,EAAIC,EAAIc,EAAIC,EAAIloF,EAAUyxD,EAAIC,GAExD,GAAI1nD,GAAI4F,KAAKimB,IAAK71B,GACdg6D,EAAIpqD,KAAK6gD,IAAKzwD,EAElB/C,MAAKiG,IACJ+kF,EAAKj+E,EAAGi+E,EAAKjuB,GAAKiuB,GAAOj+E,EAAIynD,EAAKuI,EAAItI,GAAOD,EAAKy1B,GAChDgB,EAAKluB,EAAGkuB,EAAKl+E,GAAKk+E,IAASluB,EAAIvI,EAAKznD,EAAI0nD,GAAOA,EAAKy1B,EACtD,EAAG,EAAG,IAKRn/E,MAAO,SAAWigF,EAAIC,GAErB,GAAIrG,GAAK5kF,KAAKE,QAKd,OAHA0kF,GAAI,IAAOoG,EAAIpG,EAAI,IAAOoG,EAAIpG,EAAI,IAAOoG,EACzCpG,EAAI,IAAOqG,EAAIrG,EAAI,IAAOqG,EAAIrG,EAAI,IAAOqG,EAElCjrF,MAIR2wF,OAAQ,SAAW1tB,GAElB,GAAIl2D,GAAI4F,KAAKimB,IAAKqqC,GACdlG,EAAIpqD,KAAK6gD,IAAKyP,GAEd2hB,EAAK5kF,KAAKE,SAEVwmF,EAAM9B,EAAI,GAAK+B,EAAM/B,EAAI,GAAKgC,EAAMhC,EAAI,GACxCkC,EAAMlC,EAAI,GAAKmC,EAAMnC,EAAI,GAAKoC,EAAMpC,EAAI,EAU5C,OARAA,GAAI,GAAM73E,EAAI25E,EAAM3pB,EAAI+pB,EACxBlC,EAAI,GAAM73E,EAAI45E,EAAM5pB,EAAIgqB,EACxBnC,EAAI,GAAM73E,EAAI65E,EAAM7pB,EAAIiqB,EAExBpC,EAAI,IAAQ7nB,EAAI2pB,EAAM35E,EAAI+5E,EAC1BlC,EAAI,IAAQ7nB,EAAI4pB,EAAM55E,EAAIg6E,EAC1BnC,EAAI,IAAQ7nB,EAAI6pB,EAAM75E,EAAIi6E,EAEnBhnF,MAIR07E,UAAW,SAAWuO,EAAIC,GAEzB,GAAItF,GAAK5kF,KAAKE,QAKd,OAHA0kF,GAAI,IAAOqF,EAAKrF,EAAI,GAAKA,EAAI,IAAOqF,EAAKrF,EAAI,GAAKA,EAAI,IAAOqF,EAAKrF,EAAI,GACtEA,EAAI,IAAOsF,EAAKtF,EAAI,GAAKA,EAAI,IAAOsF,EAAKtF,EAAI,GAAKA,EAAI,IAAOsF,EAAKtF,EAAI,GAE/D5kF,MAIRkgC,OAAQ,SAAWj9B,GAKlB,IAAM,GAHF2hF,GAAK5kF,KAAKE,SACV2kF,EAAK5hF,EAAO/C,SAEN8P,EAAI,EAAGA,EAAI,EAAGA,IAEvB,GAAK40E,EAAI50E,KAAQ60E,EAAI70E,GAAM,OAAO,CAInC,QAAO,GAIRkoC,UAAW,SAAW7wC,EAAOzE,GAEZ9B,SAAX8B,IAAuBA,EAAS,EAErC,KAAM,GAAIoN,GAAI,EAAGA,EAAI,EAAGA,IAEvBhQ,KAAKE,SAAU8P,GAAM3I,EAAO2I,EAAIpN,EAIjC,OAAO5C,OAIR8e,QAAS,SAAWzX,EAAOzE,GAEX9B,SAAVuG,IAAsBA,MACXvG,SAAX8B,IAAuBA,EAAS,EAErC,IAAIgiF,GAAK5kF,KAAKE,QAcd,OAZAmH,GAAOzE,GAAWgiF,EAAI,GACtBv9E,EAAOzE,EAAS,GAAMgiF,EAAI,GAC1Bv9E,EAAOzE,EAAS,GAAMgiF,EAAI,GAE1Bv9E,EAAOzE,EAAS,GAAMgiF,EAAI,GAC1Bv9E,EAAOzE,EAAS,GAAMgiF,EAAI,GAC1Bv9E,EAAOzE,EAAS,GAAMgiF,EAAI,GAE1Bv9E,EAAOzE,EAAS,GAAMgiF,EAAI,GAC1Bv9E,EAAOzE,EAAS,GAAMgiF,EAAI,GAC1Bv9E,EAAOzE,EAAS,GAAMgiF,EAAI,GAEnBv9E,IAYT,IAAIupF,KAEHC,WAAY,SAAW3vF,GAEtB,GAAIqoC,EAEJ,IAAKroC,YAAiB6oC,mBAErBR,EAASroC,MAEH,CAENqoC,EAASC,SAASC,gBAAiB,+BAAgC,UACnEF,EAAO5lC,MAAQzC,EAAMyC,MACrB4lC,EAAO3lC,OAAS1C,EAAM0C,MAEtB,IAAI6C,GAAU8iC,EAAOG,WAAY,KAE5BxoC,aAAiB4vF,WAErBrqF,EAAQsqF,aAAc7vF,EAAO,EAAG,GAIhCuF,EAAQkjC,UAAWzoC,EAAO,EAAG,EAAGA,EAAMyC,MAAOzC,EAAM0C,QAMrD,MAAK2lC,GAAO5lC,MAAQ,MAAQ4lC,EAAO3lC,OAAS,KAEpC2lC,EAAOynD,UAAW,aAAc,IAIhCznD,EAAOynD,UAAW,eAcxBjvF,GAAY,CAkDhBd,GAAQmB,cAAgBtB,OACxBG,EAAQqB,gBAAkBs9E,GAE1B3+E,EAAQwyE,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQrxF,EAAgB6zE,YAEjElJ,YAAatpE,EAEbqZ,WAAW,EAEXkrC,aAAc,WAEbxlD,KAAKiD,OAAOytF,eAAgB1wF,KAAK4C,OAAO9C,EAAGE,KAAK4C,OAAO7C,EAAGC,KAAK6C,OAAO/C,EAAGE,KAAK6C,OAAO9C,EAAGC,KAAK+C,SAAU/C,KAAK8C,OAAOhD,EAAGE,KAAK8C,OAAO/C,IAInI8K,MAAO,WAEN,OAAO,GAAI7K,MAAKuqE,aAAc3rD,KAAM5e,OAIrC4e,KAAM,SAAW8/D,GAkChB,MAhCA1+E,MAAKmC,KAAOu8E,EAAOv8E,KAEnBnC,KAAKkB,MAAQw9E,EAAOx9E,MACpBlB,KAAKqC,QAAUq8E,EAAOr8E,QAAQwqD,MAAO,GAErC7sD,KAAKmB,QAAUu9E,EAAOv9E,QAEtBnB,KAAKoB,MAAQs9E,EAAOt9E,MACpBpB,KAAKqB,MAAQq9E,EAAOr9E,MAEpBrB,KAAKsB,UAAYo9E,EAAOp9E,UACxBtB,KAAKuB,UAAYm9E,EAAOn9E,UAExBvB,KAAK0B,WAAag9E,EAAOh9E,WAEzB1B,KAAKwB,OAASk9E,EAAOl9E,OACrBxB,KAAKyB,KAAOi9E,EAAOj9E,KAEnBzB,KAAK4C,OAAOgc,KAAM8/D,EAAO97E,QACzB5C,KAAK6C,OAAO+b,KAAM8/D,EAAO77E,QACzB7C,KAAK8C,OAAO8b,KAAM8/D,EAAO57E,QACzB9C,KAAK+C,SAAW27E,EAAO37E,SAEvB/C,KAAKgD,iBAAmB07E,EAAO17E,iBAC/BhD,KAAKiD,OAAO2b,KAAM8/D,EAAOz7E,QAEzBjD,KAAKkD,gBAAkBw7E,EAAOx7E,gBAC9BlD,KAAKmD,iBAAmBu7E,EAAOv7E,iBAC/BnD,KAAKoD,MAAQs7E,EAAOt7E,MACpBpD,KAAKqD,gBAAkBq7E,EAAOr7E,gBAC9BrD,KAAK2B,SAAW+8E,EAAO/8E,SAEhB3B,MAIRs/D,OAAQ,SAAW4xB,GAElB,GAAIC,GAA0BrwF,SAATowF,GAAsC,gBAATA,EAElD,KAAOC,GAA+CrwF,SAA/BowF,EAAK/uE,SAAUniB,KAAKgC,MAE1C,MAAOkvF,GAAK/uE,SAAUniB,KAAKgC,KAI5B,IAAIy8E,IAEH2S,UACC7tF,QAAS,IACT9B,KAAM,UACN4vF,UAAW,kBAGZrvF,KAAMhC,KAAKgC,KACXG,KAAMnC,KAAKmC,KAEXhB,QAASnB,KAAKmB,QAEd0B,QAAU7C,KAAK6C,OAAO/C,EAAGE,KAAK6C,OAAO9C,GACrC6C,QAAU5C,KAAK4C,OAAO9C,EAAGE,KAAK4C,OAAO7C,GACrC+C,QAAU9C,KAAK8C,OAAOhD,EAAGE,KAAK8C,OAAO/C,GACrCgD,SAAU/C,KAAK+C,SAEfuuF,MAAQtxF,KAAKoB,MAAOpB,KAAKqB,OAEzBG,OAAQxB,KAAKwB,OACbD,UAAWvB,KAAKuB,UAChBD,UAAWtB,KAAKsB,UAChBI,WAAY1B,KAAK0B,WAEjB0B,MAAOpD,KAAKoD,MAIb,IAAoBtC,SAAfd,KAAKkB,MAAsB,CAI/B,GAAIA,GAAQlB,KAAKkB,KAQjB,IANoBJ,SAAfI,EAAMc,OAEVd,EAAMc,KAAOC,GAAMC,iBAIbivF,GAA8CrwF,SAA9BowF,EAAK1tE,OAAQtiB,EAAMc,MAAuB,CAEhE,GAAI2iE,EAEJ,IAAKv3D,MAAMC,QAASnM,GAAU,CAI7ByjE,IAEA,KAAM,GAAI30D,GAAI,EAAGC,EAAI/O,EAAMd,OAAQ4P,EAAIC,EAAGD,IAEzC20D,EAAIvyD,KAAMw+E,GAAWC,WAAY3vF,EAAO8O,SAQzC20D,GAAMisB,GAAWC,WAAY3vF,EAI9BgwF,GAAK1tE,OAAQtiB,EAAMc,OAClBA,KAAMd,EAAMc,KACZ2iE,IAAKA,GAKP8Z,EAAOv9E,MAAQA,EAAMc,KAUtB,MANOmvF,KAEND,EAAK/uE,SAAUniB,KAAKgC,MAASy8E,GAIvBA,GAIRn7D,QAAS,WAERtjB,KAAK24C,eAAiBl3C,KAAM,aAI7B8vF,YAAa,SAAW35E,GAEvB,GAAK5X,KAAKmB,UAAYy+E,GAAtB,CAIA,GAFAhoE,EAAG6qE,aAAcziF,KAAKiD,QAEjB2U,EAAG9X,EAAI,GAAK8X,EAAG9X,EAAI,EAEvB,OAASE,KAAKoB,OAEb,IAAKyvC,IAEJj5B,EAAG9X,EAAI8X,EAAG9X,EAAI6S,KAAKC,MAAOgF,EAAG9X,EAC7B,MAED,KAAKyC,IAEJqV,EAAG9X,EAAI8X,EAAG9X,EAAI,EAAI,EAAI,CACtB,MAED,KAAKixC,IAEwC,IAAvCp+B,KAAK4P,IAAK5P,KAAKC,MAAOgF,EAAG9X,GAAM,GAEnC8X,EAAG9X,EAAI6S,KAAKkvE,KAAMjqE,EAAG9X,GAAM8X,EAAG9X,EAI9B8X,EAAG9X,EAAI8X,EAAG9X,EAAI6S,KAAKC,MAAOgF,EAAG9X,GASjC,GAAK8X,EAAG7X,EAAI,GAAK6X,EAAG7X,EAAI,EAEvB,OAASC,KAAKqB,OAEb,IAAKwvC,IAEJj5B,EAAG7X,EAAI6X,EAAG7X,EAAI4S,KAAKC,MAAOgF,EAAG7X,EAC7B,MAED,KAAKwC,IAEJqV,EAAG7X,EAAI6X,EAAG7X,EAAI,EAAI,EAAI,CACtB,MAED,KAAKgxC,IAEwC,IAAvCp+B,KAAK4P,IAAK5P,KAAKC,MAAOgF,EAAG7X,GAAM,GAEnC6X,EAAG7X,EAAI4S,KAAKkvE,KAAMjqE,EAAG7X,GAAM6X,EAAG7X,EAI9B6X,EAAG7X,EAAI6X,EAAG7X,EAAI4S,KAAKC,MAAOgF,EAAG7X,GAS5BC,KAAKoD,QAETwU,EAAG7X,EAAI,EAAI6X,EAAG7X,OAQjB6B,OAAOC,eAAgBZ,EAAQwyE,UAAW,eAEzCxtE,IAAK,SAAWnE,GAEVA,KAAU,GAAO9B,KAAKuD,aAuB7B3B,OAAO48E,OAAQ/6E,EAAQgwE,WAEtB+d,WAAW,EAEXvrF,IAAK,SAAWnG,EAAGC,EAAGS,EAAGC,GAOxB,MALAT,MAAKF,EAAIA,EACTE,KAAKD,EAAIA,EACTC,KAAKQ,EAAIA,EACTR,KAAKS,EAAIA,EAEFT,MAIR+hF,UAAW,SAAWC,GAOrB,MALAhiF,MAAKF,EAAIkiF,EACThiF,KAAKD,EAAIiiF,EACThiF,KAAKQ,EAAIwhF,EACThiF,KAAKS,EAAIuhF,EAEFhiF,MAIRiiF,KAAM,SAAWniF,GAIhB,MAFAE,MAAKF,EAAIA,EAEFE,MAIRkiF,KAAM,SAAWniF,GAIhB,MAFAC,MAAKD,EAAIA,EAEFC,MAIRivF,KAAM,SAAWzuF,GAIhB,MAFAR,MAAKQ,EAAIA,EAEFR,MAIRyxF,KAAM,SAAWhxF,GAIhB,MAFAT,MAAKS,EAAIA,EAEFT,MAIRmiF,aAAc,SAAW/xE,EAAOtO,GAE/B,OAASsO,GAER,IAAK,GAAGpQ,KAAKF,EAAIgC,CAAO,MACxB,KAAK,GAAG9B,KAAKD,EAAI+B,CAAO,MACxB,KAAK,GAAG9B,KAAKQ,EAAIsB,CAAO,MACxB,KAAK,GAAG9B,KAAKS,EAAIqB,CAAO,MACxB,SAAS,KAAM,IAAIwoB,OAAO,0BAA4Bla,GAIvD,MAAOpQ,OAIRoiF,aAAc,SAAWhyE,GAExB,OAASA,GAER,IAAK,GAAG,MAAOpQ,MAAKF,CACpB,KAAK,GAAG,MAAOE,MAAKD,CACpB,KAAK,GAAG,MAAOC,MAAKQ,CACpB,KAAK,GAAG,MAAOR,MAAKS,CACpB,SAAS,KAAM,IAAI6pB,OAAO,0BAA4Bla,KAMxDvF,MAAO,WAEN,MAAO,IAAI7K,MAAKuqE,YAAavqE,KAAKF,EAAGE,KAAKD,EAAGC,KAAKQ,EAAGR,KAAKS,IAI3Dme,KAAM,SAAWzN,GAOhB,MALAnR,MAAKF,EAAIqR,EAAErR,EACXE,KAAKD,EAAIoR,EAAEpR,EACXC,KAAKQ,EAAI2Q,EAAE3Q,EACXR,KAAKS,EAAcK,SAARqQ,EAAE1Q,EAAoB0Q,EAAE1Q,EAAI,EAEhCT,MAIRq/B,IAAK,SAAWluB,EAAG1Q,GAElB,MAAWK,UAANL,GAEJJ,QAAQ4H,KAAM,yFACPjI,KAAKu0D,WAAYpjD,EAAG1Q,KAI5BT,KAAKF,GAAKqR,EAAErR,EACZE,KAAKD,GAAKoR,EAAEpR,EACZC,KAAKQ,GAAK2Q,EAAE3Q,EACZR,KAAKS,GAAK0Q,EAAE1Q,EAELT,OAIRqiF,UAAW,SAAWtlB,GAOrB,MALA/8D,MAAKF,GAAKi9D,EACV/8D,KAAKD,GAAKg9D,EACV/8D,KAAKQ,GAAKu8D,EACV/8D,KAAKS,GAAKs8D,EAEH/8D,MAIRu0D,WAAY,SAAWznD,EAAG9G,GAOzB,MALAhG,MAAKF,EAAIgN,EAAEhN,EAAIkG,EAAElG,EACjBE,KAAKD,EAAI+M,EAAE/M,EAAIiG,EAAEjG,EACjBC,KAAKQ,EAAIsM,EAAEtM,EAAIwF,EAAExF,EACjBR,KAAKS,EAAIqM,EAAErM,EAAIuF,EAAEvF,EAEVT,MAIRsiF,gBAAiB,SAAWnxE,EAAG4rD,GAO9B,MALA/8D,MAAKF,GAAKqR,EAAErR,EAAIi9D,EAChB/8D,KAAKD,GAAKoR,EAAEpR,EAAIg9D,EAChB/8D,KAAKQ,GAAK2Q,EAAE3Q,EAAIu8D,EAChB/8D,KAAKS,GAAK0Q,EAAE1Q,EAAIs8D,EAET/8D,MAIRq4B,IAAK,SAAWlnB,EAAG1Q,GAElB,MAAWK,UAANL,GAEJJ,QAAQ4H,KAAM,yFACPjI,KAAKyvD,WAAYt+C,EAAG1Q,KAI5BT,KAAKF,GAAKqR,EAAErR,EACZE,KAAKD,GAAKoR,EAAEpR,EACZC,KAAKQ,GAAK2Q,EAAE3Q,EACZR,KAAKS,GAAK0Q,EAAE1Q,EAELT,OAIRuiF,UAAW,SAAWxlB,GAOrB,MALA/8D,MAAKF,GAAKi9D,EACV/8D,KAAKD,GAAKg9D,EACV/8D,KAAKQ,GAAKu8D,EACV/8D,KAAKS,GAAKs8D,EAEH/8D,MAIRyvD,WAAY,SAAW3iD,EAAG9G,GAOzB,MALAhG,MAAKF,EAAIgN,EAAEhN,EAAIkG,EAAElG,EACjBE,KAAKD,EAAI+M,EAAE/M,EAAIiG,EAAEjG,EACjBC,KAAKQ,EAAIsM,EAAEtM,EAAIwF,EAAExF,EACjBR,KAAKS,EAAIqM,EAAErM,EAAIuF,EAAEvF,EAEVT,MAIRk4B,eAAgB,SAAW8pD,GAO1B,MALAhiF,MAAKF,GAAKkiF,EACVhiF,KAAKD,GAAKiiF,EACVhiF,KAAKQ,GAAKwhF,EACVhiF,KAAKS,GAAKuhF,EAEHhiF,MAIR6e,aAAc,SAAW+4C,GAExB,GAAI93D,GAAIE,KAAKF,EAAGC,EAAIC,KAAKD,EAAGS,EAAIR,KAAKQ,EAAGC,EAAIT,KAAKS,EAC7C4tD,EAAIuJ,EAAE13D,QAOV,OALAF,MAAKF,EAAIuuD,EAAG,GAAMvuD,EAAIuuD,EAAG,GAAMtuD,EAAIsuD,EAAG,GAAM7tD,EAAI6tD,EAAG,IAAO5tD,EAC1DT,KAAKD,EAAIsuD,EAAG,GAAMvuD,EAAIuuD,EAAG,GAAMtuD,EAAIsuD,EAAG,GAAM7tD,EAAI6tD,EAAG,IAAO5tD,EAC1DT,KAAKQ,EAAI6tD,EAAG,GAAMvuD,EAAIuuD,EAAG,GAAMtuD,EAAIsuD,EAAG,IAAO7tD,EAAI6tD,EAAG,IAAO5tD,EAC3DT,KAAKS,EAAI4tD,EAAG,GAAMvuD,EAAIuuD,EAAG,GAAMtuD,EAAIsuD,EAAG,IAAO7tD,EAAI6tD,EAAG,IAAO5tD,EAEpDT,MAIRwxD,aAAc,SAAWwwB,GAExB,MAAOhiF,MAAKk4B,eAAgB,EAAI8pD,IAIjC0P,2BAA4B,SAAW99B,GAMtC5zD,KAAKS,EAAI,EAAIkS,KAAKm7E,KAAMl6B,EAAEnzD,EAE1B,IAAIs8D,GAAIpqD,KAAKmwC,KAAM,EAAI8Q,EAAEnzD,EAAImzD,EAAEnzD,EAgB/B,OAdKs8D,GAAI,MAER/8D,KAAKF,EAAI,EACTE,KAAKD,EAAI,EACTC,KAAKQ,EAAI,IAITR,KAAKF,EAAI8zD,EAAE9zD,EAAIi9D,EACf/8D,KAAKD,EAAI6zD,EAAE7zD,EAAIg9D,EACf/8D,KAAKQ,EAAIozD,EAAEpzD,EAAIu8D,GAIT/8D,MAIR2xF,+BAAgC,SAAW/5B,GAM1C,GAAI/+B,GAAO/4B,EAAGC,EAAGS,EAChBoxF,EAAU,IACVC,EAAW,GAEXjN,EAAKhtB,EAAE13D,SAEP8sF,EAAMpI,EAAI,GAAKqI,EAAMrI,EAAI,GAAKsI,EAAMtI,EAAI,GACxCuI,EAAMvI,EAAI,GAAKwI,EAAMxI,EAAI,GAAKyI,EAAMzI,EAAI,GACxC0I,EAAM1I,EAAI,GAAK2I,EAAM3I,EAAI,GAAK4I,EAAM5I,EAAI,GAEzC,IAAOjyE,KAAK4P,IAAK0qE,EAAME,GAAQyE,GACxBj/E,KAAK4P,IAAK2qE,EAAMI,GAAQsE,GACxBj/E,KAAK4P,IAAK8qE,EAAME,GAAQqE,EAAY,CAM1C,GAAOj/E,KAAK4P,IAAK0qE,EAAME,GAAQ0E,GACxBl/E,KAAK4P,IAAK2qE,EAAMI,GAAQuE,GACxBl/E,KAAK4P,IAAK8qE,EAAME,GAAQsE,GACxBl/E,KAAK4P,IAAKyqE,EAAMI,EAAMI,EAAM,GAAMqE,EAMxC,MAFA7xF,MAAKiG,IAAK,EAAG,EAAG,EAAG,GAEZjG,IAMR64B,GAAQlmB,KAAKi+C,EAEb,IAAI25B,IAAOyC,EAAM,GAAM,EACnBtC,GAAO0C,EAAM,GAAM,EACnBxC,GAAO4C,EAAM,GAAM,EACnBhD,GAAOyC,EAAME,GAAQ,EACrB1C,GAAOyC,EAAMI,GAAQ,EACrB3C,GAAO0C,EAAME,GAAQ,CA4DzB,OA1DOhD,GAAKG,GAAUH,EAAKK,EAIrBL,EAAKqH,GAET9xF,EAAI,EACJC,EAAI,WACJS,EAAI,aAIJV,EAAI6S,KAAKmwC,KAAMynC,GACfxqF,EAAIyqF,EAAK1qF,EACTU,EAAIiqF,EAAK3qF,GAIC4qF,EAAKE,EAIXF,EAAKkH,GAET9xF,EAAI,WACJC,EAAI,EACJS,EAAI,aAIJT,EAAI4S,KAAKmwC,KAAM4nC,GACf5qF,EAAI0qF,EAAKzqF,EACTS,EAAImqF,EAAK5qF,GAQL6qF,EAAKgH,GAET9xF,EAAI,WACJC,EAAI,WACJS,EAAI,IAIJA,EAAImS,KAAKmwC,KAAM8nC,GACf9qF,EAAI2qF,EAAKjqF,EACTT,EAAI4qF,EAAKnqF,GAMXR,KAAKiG,IAAKnG,EAAGC,EAAGS,EAAGq4B,GAEZ74B,KAMR,GAAI+8D,GAAIpqD,KAAKmwC,MAAQyqC,EAAMF,IAAUE,EAAMF,IACtBH,EAAMI,IAAUJ,EAAMI,IACtBH,EAAMF,IAAUE,EAAMF,GAY3C,OAVKt6E,MAAK4P,IAAKw6C,GAAM,OAAQA,EAAI,GAKjC/8D,KAAKF,GAAMytF,EAAMF,GAAQtwB,EACzB/8D,KAAKD,GAAMmtF,EAAMI,GAAQvwB,EACzB/8D,KAAKQ,GAAM2sF,EAAMF,GAAQlwB,EACzB/8D,KAAKS,EAAIkS,KAAKm7E,MAAQd,EAAMI,EAAMI,EAAM,GAAM,GAEvCxtF,MAIR6E,IAAK,SAAWsM,GAOf,MALAnR,MAAKF,EAAI6S,KAAK9N,IAAK7E,KAAKF,EAAGqR,EAAErR,GAC7BE,KAAKD,EAAI4S,KAAK9N,IAAK7E,KAAKD,EAAGoR,EAAEpR,GAC7BC,KAAKQ,EAAImS,KAAK9N,IAAK7E,KAAKQ,EAAG2Q,EAAE3Q,GAC7BR,KAAKS,EAAIkS,KAAK9N,IAAK7E,KAAKS,EAAG0Q,EAAE1Q,GAEtBT,MAIR8E,IAAK,SAAWqM,GAOf,MALAnR,MAAKF,EAAI6S,KAAK7N,IAAK9E,KAAKF,EAAGqR,EAAErR,GAC7BE,KAAKD,EAAI4S,KAAK7N,IAAK9E,KAAKD,EAAGoR,EAAEpR,GAC7BC,KAAKQ,EAAImS,KAAK7N,IAAK9E,KAAKQ,EAAG2Q,EAAE3Q,GAC7BR,KAAKS,EAAIkS,KAAK7N,IAAK9E,KAAKS,EAAG0Q,EAAE1Q,GAEtBT,MAIRkhE,MAAO,SAAWr8D,EAAKC,GAStB,MALA9E,MAAKF,EAAI6S,KAAK7N,IAAKD,EAAI/E,EAAG6S,KAAK9N,IAAKC,EAAIhF,EAAGE,KAAKF,IAChDE,KAAKD,EAAI4S,KAAK7N,IAAKD,EAAI9E,EAAG4S,KAAK9N,IAAKC,EAAI/E,EAAGC,KAAKD,IAChDC,KAAKQ,EAAImS,KAAK7N,IAAKD,EAAIrE,EAAGmS,KAAK9N,IAAKC,EAAItE,EAAGR,KAAKQ,IAChDR,KAAKS,EAAIkS,KAAK7N,IAAKD,EAAIpE,EAAGkS,KAAK9N,IAAKC,EAAIrE,EAAGT,KAAKS,IAEzCT,MAIR0iF,YAAa,WAEZ,GAAI79E,GAAKC,CAET,OAAO,UAAsB69E,EAAQC,GAYpC,MAVa9hF,UAAR+D,IAEJA,EAAM,GAAIpB,GACVqB,EAAM,GAAIrB,IAIXoB,EAAIoB,IAAK08E,EAAQA,EAAQA,EAAQA,GACjC79E,EAAImB,IAAK28E,EAAQA,EAAQA,EAAQA,GAE1B5iF,KAAKkhE,MAAOr8D,EAAKC,OAM1B+9E,YAAa,SAAWh+E,EAAKC,GAE5B,GAAI1E,GAASJ,KAAKI,QAElB,OAAOJ,MAAKwxD,aAAcpxD,GAAU,GAAI83B,eAAgBvlB,KAAK7N,IAAKD,EAAK8N,KAAK9N,IAAKC,EAAK1E,MAIvFwS,MAAO,WAON,MALA5S,MAAKF,EAAI6S,KAAKC,MAAO5S,KAAKF,GAC1BE,KAAKD,EAAI4S,KAAKC,MAAO5S,KAAKD,GAC1BC,KAAKQ,EAAImS,KAAKC,MAAO5S,KAAKQ,GAC1BR,KAAKS,EAAIkS,KAAKC,MAAO5S,KAAKS,GAEnBT,MAIR6hF,KAAM,WAOL,MALA7hF,MAAKF,EAAI6S,KAAKkvE,KAAM7hF,KAAKF,GACzBE,KAAKD,EAAI4S,KAAKkvE,KAAM7hF,KAAKD,GACzBC,KAAKQ,EAAImS,KAAKkvE,KAAM7hF,KAAKQ,GACzBR,KAAKS,EAAIkS,KAAKkvE,KAAM7hF,KAAKS,GAElBT,MAIR8iF,MAAO,WAON,MALA9iF,MAAKF,EAAI6S,KAAKmwE,MAAO9iF,KAAKF,GAC1BE,KAAKD,EAAI4S,KAAKmwE,MAAO9iF,KAAKD,GAC1BC,KAAKQ,EAAImS,KAAKmwE,MAAO9iF,KAAKQ,GAC1BR,KAAKS,EAAIkS,KAAKmwE,MAAO9iF,KAAKS,GAEnBT,MAIR+iF,YAAa,WAOZ,MALA/iF,MAAKF,EAAME,KAAKF,EAAI,EAAM6S,KAAKkvE,KAAM7hF,KAAKF,GAAM6S,KAAKC,MAAO5S,KAAKF,GACjEE,KAAKD,EAAMC,KAAKD,EAAI,EAAM4S,KAAKkvE,KAAM7hF,KAAKD,GAAM4S,KAAKC,MAAO5S,KAAKD,GACjEC,KAAKQ,EAAMR,KAAKQ,EAAI,EAAMmS,KAAKkvE,KAAM7hF,KAAKQ,GAAMmS,KAAKC,MAAO5S,KAAKQ,GACjER,KAAKS,EAAMT,KAAKS,EAAI,EAAMkS,KAAKkvE,KAAM7hF,KAAKS,GAAMkS,KAAKC,MAAO5S,KAAKS,GAE1DT,MAIRumD,OAAQ,WAOP,MALAvmD,MAAKF,GAAME,KAAKF,EAChBE,KAAKD,GAAMC,KAAKD,EAChBC,KAAKQ,GAAMR,KAAKQ,EAChBR,KAAKS,GAAMT,KAAKS,EAETT,MAIRwiE,IAAK,SAAWrxD,GAEf,MAAOnR,MAAKF,EAAIqR,EAAErR,EAAIE,KAAKD,EAAIoR,EAAEpR,EAAIC,KAAKQ,EAAI2Q,EAAE3Q,EAAIR,KAAKS,EAAI0Q,EAAE1Q,GAIhEwiF,SAAU,WAET,MAAOjjF,MAAKF,EAAIE,KAAKF,EAAIE,KAAKD,EAAIC,KAAKD,EAAIC,KAAKQ,EAAIR,KAAKQ,EAAIR,KAAKS,EAAIT,KAAKS,GAI5EL,OAAQ,WAEP,MAAOuS,MAAKmwC,KAAM9iD,KAAKF,EAAIE,KAAKF,EAAIE,KAAKD,EAAIC,KAAKD,EAAIC,KAAKQ,EAAIR,KAAKQ,EAAIR,KAAKS,EAAIT,KAAKS,IAIvFyiF,gBAAiB,WAEhB,MAAOvwE,MAAK4P,IAAKviB,KAAKF,GAAM6S,KAAK4P,IAAKviB,KAAKD,GAAM4S,KAAK4P,IAAKviB,KAAKQ,GAAMmS,KAAK4P,IAAKviB,KAAKS,IAItFk5B,UAAW,WAEV,MAAO35B,MAAKwxD,aAAcxxD,KAAKI,UAAY,IAI5Cw7E,UAAW,SAAWx7E,GAErB,MAAOJ,MAAK25B,YAAYzB,eAAgB93B,IAIzCgwD,KAAM,SAAWj/C,EAAGuJ,GAOnB,MALA1a,MAAKF,IAAOqR,EAAErR,EAAIE,KAAKF,GAAM4a,EAC7B1a,KAAKD,IAAOoR,EAAEpR,EAAIC,KAAKD,GAAM2a,EAC7B1a,KAAKQ,IAAO2Q,EAAE3Q,EAAIR,KAAKQ,GAAMka,EAC7B1a,KAAKS,IAAO0Q,EAAE1Q,EAAIT,KAAKS,GAAMia,EAEtB1a,MAIRwjF,YAAa,SAAW5b,EAAIW,EAAI7tD,GAE/B,MAAO1a,MAAKyvD,WAAY8Y,EAAIX,GAAK1vC,eAAgBxd,GAAQ2kB,IAAKuoC,IAI/D1nC,OAAQ,SAAW/uB,GAElB,MAAWA,GAAErR,IAAME,KAAKF,GAASqR,EAAEpR,IAAMC,KAAKD,GAASoR,EAAE3Q,IAAMR,KAAKQ,GAAS2Q,EAAE1Q,IAAMT,KAAKS,GAI3Fy3C,UAAW,SAAW7wC,EAAOzE,GAS5B,MAPgB9B,UAAX8B,IAAuBA,EAAS,GAErC5C,KAAKF,EAAIuH,EAAOzE,GAChB5C,KAAKD,EAAIsH,EAAOzE,EAAS,GACzB5C,KAAKQ,EAAI6G,EAAOzE,EAAS,GACzB5C,KAAKS,EAAI4G,EAAOzE,EAAS,GAElB5C,MAIR8e,QAAS,SAAWzX,EAAOzE,GAU1B,MARe9B,UAAVuG,IAAsBA,MACXvG,SAAX8B,IAAuBA,EAAS,GAErCyE,EAAOzE,GAAW5C,KAAKF,EACvBuH,EAAOzE,EAAS,GAAM5C,KAAKD,EAC3BsH,EAAOzE,EAAS,GAAM5C,KAAKQ,EAC3B6G,EAAOzE,EAAS,GAAM5C,KAAKS,EAEpB4G,GAIR0nD,oBAAqB,SAAW5nD,EAAWiJ,EAAOxN,GAajD,MAXgB9B,UAAX8B,GAEJvC,QAAQ4H,KAAM,uEAIfjI,KAAKF,EAAIqH,EAAU2nD,KAAM1+C,GACzBpQ,KAAKD,EAAIoH,EAAUs8E,KAAMrzE,GACzBpQ,KAAKQ,EAAI2G,EAAUwhF,KAAMv4E,GACzBpQ,KAAKS,EAAI0G,EAAU2qF,KAAM1hF,GAElBpQ,QAyCT0D,EAAkB+vE,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQrxF,EAAgB6zE,YAE3ElJ,YAAa7mE,EAEb8uB,qBAAqB,EAErBg2B,QAAS,SAAW7kD,EAAOC,GAErB5D,KAAK2D,QAAUA,GAAS3D,KAAK4D,SAAWA,IAE5C5D,KAAK2D,MAAQA,EACb3D,KAAK4D,OAASA,EAEd5D,KAAKsjB,WAINtjB,KAAKgE,SAASiC,IAAK,EAAG,EAAGtC,EAAOC,GAChC5D,KAAK8D,QAAQmC,IAAK,EAAG,EAAGtC,EAAOC,IAIhCiH,MAAO,WAEN,OAAO,GAAI7K,MAAKuqE,aAAc3rD,KAAM5e,OAIrC4e,KAAM,SAAW8/D,GAahB,MAXA1+E,MAAK2D,MAAQ+6E,EAAO/6E,MACpB3D,KAAK4D,OAAS86E,EAAO96E,OAErB5D,KAAKgE,SAAS4a,KAAM8/D,EAAO16E,UAE3BhE,KAAKiE,QAAUy6E,EAAOz6E,QAAQ4G,QAE9B7K,KAAKkE,YAAcw6E,EAAOx6E,YAC1BlE,KAAKmE,cAAgBu6E,EAAOv6E,cAC5BnE,KAAKoE,aAAes6E,EAAOt6E,aAEpBpE,MAIRsjB,QAAS,WAERtjB,KAAK24C,eAAiBl3C,KAAM,eAmB9B4C,EAAsBovE,UAAY7xE,OAAOqvF,OAAQvtF,EAAkB+vE,WACnEpvE,EAAsBovE,UAAUlJ,YAAclmE,EAE9CA,EAAsBovE,UAAUpnC,yBAA0B,EAqB1D5nC,EAAYgvE,UAAY7xE,OAAOqvF,OAAQhwF,EAAQwyE,WAC/ChvE,EAAYgvE,UAAUlJ,YAAc9lE,EAEpCA,EAAYgvE,UAAUtmC,eAAgB,EActCvrC,OAAO48E,OAAQ55E,EAAK6uE,WAEnBse,QAAQ,EAER9rF,IAAK,SAAWpB,EAAKC,GAKpB,MAHA9E,MAAK6E,IAAI+Z,KAAM/Z,GACf7E,KAAK8E,IAAI8Z,KAAM9Z,GAER9E,MAIRgyF,aAAc,SAAW3qF,GAUxB,IAAM,GARFsuD,KAAS5wD,EAAAA,GACT6wD,IAAS7wD,EAAAA,GACT0xD,IAAS1xD,EAAAA,GAETktF,IAASltF,EAAAA,GACTmtF,IAASntF,EAAAA,GACT4xD,IAAS5xD,EAAAA,GAEHiL,EAAI,EAAGC,EAAI5I,EAAMjH,OAAQ4P,EAAIC,EAAGD,GAAK,EAAI,CAElD,GAAIlQ,GAAIuH,EAAO2I,GACXjQ,EAAIsH,EAAO2I,EAAI,GACfxP,EAAI6G,EAAO2I,EAAI,EAEdlQ,GAAI61D,IAAOA,EAAO71D,GAClBC,EAAI61D,IAAOA,EAAO71D,GAClBS,EAAIi2D,IAAOA,EAAOj2D,GAElBV,EAAImyF,IAAOA,EAAOnyF,GAClBC,EAAImyF,IAAOA,EAAOnyF,GAClBS,EAAIm2D,IAAOA,EAAOn2D,GAOxB,MAHAR,MAAK6E,IAAIoB,IAAK0vD,EAAMC,EAAMa,GAC1Bz2D,KAAK8E,IAAImB,IAAKgsF,EAAMC,EAAMv7B,GAEnB32D,MAIRmyF,uBAAwB,SAAWhrF,GAUlC,IAAM,GARFwuD,KAAS5wD,EAAAA,GACT6wD,IAAS7wD,EAAAA,GACT0xD,IAAS1xD,EAAAA,GAETktF,IAASltF,EAAAA,GACTmtF,IAASntF,EAAAA,GACT4xD,IAAS5xD,EAAAA,GAEHiL,EAAI,EAAGC,EAAI9I,EAAU+B,MAAO8G,EAAIC,EAAGD,IAAO,CAEnD,GAAIlQ,GAAIqH,EAAU2nD,KAAM9+C,GACpBjQ,EAAIoH,EAAUs8E,KAAMzzE,GACpBxP,EAAI2G,EAAUwhF,KAAM34E,EAEnBlQ,GAAI61D,IAAOA,EAAO71D,GAClBC,EAAI61D,IAAOA,EAAO71D,GAClBS,EAAIi2D,IAAOA,EAAOj2D,GAElBV,EAAImyF,IAAOA,EAAOnyF,GAClBC,EAAImyF,IAAOA,EAAOnyF,GAClBS,EAAIm2D,IAAOA,EAAOn2D,GAOxB,MAHAR,MAAK6E,IAAIoB,IAAK0vD,EAAMC,EAAMa,GAC1Bz2D,KAAK8E,IAAImB,IAAKgsF,EAAMC,EAAMv7B,GAEnB32D,MAIRopE,cAAe,SAAWnnD,GAEzBjiB,KAAKoyF,WAEL,KAAM,GAAIpiF,GAAI,EAAGyuB,EAAKxc,EAAO7hB,OAAQ4P,EAAIyuB,EAAIzuB,IAE5ChQ,KAAKqyF,cAAepwE,EAAQjS,GAI7B,OAAOhQ,OAIRsyF,qBAAsB,WAErB,GAAI1qB,GAAK,GAAI7mE,EAEb,OAAO,UAA+B+B,EAAQmkB,GAE7C,GAAI2yD,GAAWhS,EAAGhpD,KAAMqI,GAAOiR,eAAgB,GAK/C,OAHAl4B,MAAK6E,IAAI+Z,KAAM9b,GAASu1B,IAAKuhD,GAC7B55E,KAAK8E,IAAI8Z,KAAM9b,GAASu8B,IAAKu6C,GAEtB55E,SAMT6gB,cAAe,SAAWL,GAIzB,MAFAxgB,MAAKoyF,YAEEpyF,KAAKuyF,eAAgB/xE,IAI7B3V,MAAO,WAEN,OAAO,GAAI7K,MAAKuqE,aAAc3rD,KAAM5e,OAIrC4e,KAAM,SAAWo8D,GAKhB,MAHAh7E,MAAK6E,IAAI+Z,KAAMo8D,EAAIn2E,KACnB7E,KAAK8E,IAAI8Z,KAAMo8D,EAAIl2E,KAEZ9E,MAIRoyF,UAAW,WAKV,MAHApyF,MAAK6E,IAAI/E,EAAIE,KAAK6E,IAAI9E,EAAIC,KAAK6E,IAAIrE,IAAMuE,EAAAA,GACzC/E,KAAK8E,IAAIhF,EAAIE,KAAK8E,IAAI/E,EAAIC,KAAK8E,IAAItE,IAAMuE,EAAAA,GAElC/E,MAIRwyF,QAAS,WAIR,MAASxyF,MAAK8E,IAAIhF,EAAIE,KAAK6E,IAAI/E,GAASE,KAAK8E,IAAI/E,EAAIC,KAAK6E,IAAI9E,GAASC,KAAK8E,IAAItE,EAAIR,KAAK6E,IAAIrE,GAI9FiyF,UAAW,SAAWxyE,GASrB,MAPgBnf,UAAXmf,IAEJ5f,QAAQ4H,KAAM,mDACdgY,EAAS,GAAIlf,IAIPf,KAAKwyF,UAAYvyE,EAAOha,IAAK,EAAG,EAAG,GAAMga,EAAOs0C,WAAYv0D,KAAK6E,IAAK7E,KAAK8E,KAAMozB,eAAgB,KAIzGkf,QAAS,SAAWn3B,GASnB,MAPgBnf,UAAXmf,IAEJ5f,QAAQ4H,KAAM,iDACdgY,EAAS,GAAIlf,IAIPf,KAAKwyF,UAAYvyE,EAAOha,IAAK,EAAG,EAAG,GAAMga,EAAOwvC,WAAYzvD,KAAK8E,IAAK9E,KAAK6E,MAInFwtF,cAAe,SAAW59D,GAKzB,MAHAz0B,MAAK6E,IAAIA,IAAK4vB,GACdz0B,KAAK8E,IAAIA,IAAK2vB,GAEPz0B,MAIR0yF,eAAgB,SAAWvgF,GAK1B,MAHAnS,MAAK6E,IAAIwzB,IAAKlmB,GACdnS,KAAK8E,IAAIu6B,IAAKltB,GAEPnS,MAIR2yF,eAAgB,SAAW3Q,GAK1B,MAHAhiF,MAAK6E,IAAIw9E,WAAaL,GACtBhiF,KAAK8E,IAAIu9E,UAAWL,GAEbhiF,MAIRuyF,eAAgB,WASf,QAAS3nC,GAAUyoB,GAElB,GAAIh7D,GAAWg7D,EAAKh7D,QAEpB,IAAkBvX,SAAbuX,EAEJ,GAAKA,EAASsI,WAAa,CAE1B,GAAIjT,GAAW2K,EAAS3K,QAExB,KAAMsC,EAAI,EAAGC,EAAIvC,EAAStN,OAAQ4P,EAAIC,EAAGD,IAExC43D,EAAGhpD,KAAMlR,EAAUsC,IACnB43D,EAAG/oD,aAAcw0D,EAAKhoE,aAEtBmH,EAAM6/E,cAAezqB,OAIhB,IAAKvvD,EAASqI,iBAAmB,CAEvC,GAAIvZ,GAAYkR,EAAShI,WAAWvF,QAEpC,IAAmBhK,SAAdqG,EAEJ,IAAM6I,EAAI,EAAGC,EAAI9I,EAAU+B,MAAO8G,EAAIC,EAAGD,IAExC43D,EAAG7Y,oBAAqB5nD,EAAW6I,GAAI6O,aAAcw0D,EAAKhoE,aAE1DmH,EAAM6/E,cAAezqB,IAjC1B,GAAIp1D,GAAOxC,EAAGC,EAEV23D,EAAK,GAAI7mE,EA2Cb,OAAO,UAAyByf,GAQ/B,MANAhO,GAAQxS,KAERwgB,EAAOye,mBAAmB,GAE1Bze,EAAOoqC,SAAUA,GAEV5qD,SAMT4yF,cAAe,SAAWn+D,GAEzB,QAAOA,EAAM30B,EAAIE,KAAK6E,IAAI/E,GAAK20B,EAAM30B,EAAIE,KAAK8E,IAAIhF,GACjD20B,EAAM10B,EAAIC,KAAK6E,IAAI9E,GAAK00B,EAAM10B,EAAIC,KAAK8E,IAAI/E,GAC3C00B,EAAMj0B,EAAIR,KAAK6E,IAAIrE,GAAKi0B,EAAMj0B,EAAIR,KAAK8E,IAAItE,IAI7CqyF,YAAa,SAAW7X,GAEvB,MAAOh7E,MAAK6E,IAAI/E,GAAKk7E,EAAIn2E,IAAI/E,GAAKk7E,EAAIl2E,IAAIhF,GAAKE,KAAK8E,IAAIhF,GACvDE,KAAK6E,IAAI9E,GAAKi7E,EAAIn2E,IAAI9E,GAAKi7E,EAAIl2E,IAAI/E,GAAKC,KAAK8E,IAAI/E,GACjDC,KAAK6E,IAAIrE,GAAKw6E,EAAIn2E,IAAIrE,GAAKw6E,EAAIl2E,IAAItE,GAAKR,KAAK8E,IAAItE,GAInDob,aAAc,SAAW6Y,EAAOxU,GAY/B,MAPgBnf,UAAXmf,IAEJ5f,QAAQ4H,KAAM,sDACdgY,EAAS,GAAIlf,IAIPkf,EAAOha,KACXwuB,EAAM30B,EAAIE,KAAK6E,IAAI/E,IAAQE,KAAK8E,IAAIhF,EAAIE,KAAK6E,IAAI/E,IACjD20B,EAAM10B,EAAIC,KAAK6E,IAAI9E,IAAQC,KAAK8E,IAAI/E,EAAIC,KAAK6E,IAAI9E,IACjD00B,EAAMj0B,EAAIR,KAAK6E,IAAIrE,IAAQR,KAAK8E,IAAItE,EAAIR,KAAK6E,IAAIrE,KAKrDsyF,cAAe,SAAW9X,GAGzB,QAAOA,EAAIl2E,IAAIhF,EAAIE,KAAK6E,IAAI/E,GAAKk7E,EAAIn2E,IAAI/E,EAAIE,KAAK8E,IAAIhF,GACrDk7E,EAAIl2E,IAAI/E,EAAIC,KAAK6E,IAAI9E,GAAKi7E,EAAIn2E,IAAI9E,EAAIC,KAAK8E,IAAI/E,GAC/Ci7E,EAAIl2E,IAAItE,EAAIR,KAAK6E,IAAIrE,GAAKw6E,EAAIn2E,IAAIrE,EAAIR,KAAK8E,IAAItE,IAIjDuyF,iBAAkB,WAEjB,GAAIC,GAAe,GAAIjyF,EAEvB,OAAO,UAA2BkyF,GAMjC,MAHAjzF,MAAKkzF,WAAYD,EAAOnwF,OAAQkwF,GAGzBA,EAAa5P,kBAAmB6P,EAAOnwF,SAAcmwF,EAAOhuF,OAASguF,EAAOhuF,WAMrFkuF,gBAAiB,SAAWx0E,GAK3B,GAAI9Z,GAAKC,CAsCT,OApCK6Z,GAAMxZ,OAAOrF,EAAI,GAErB+E,EAAM8Z,EAAMxZ,OAAOrF,EAAIE,KAAK6E,IAAI/E,EAChCgF,EAAM6Z,EAAMxZ,OAAOrF,EAAIE,KAAK8E,IAAIhF,IAIhC+E,EAAM8Z,EAAMxZ,OAAOrF,EAAIE,KAAK8E,IAAIhF,EAChCgF,EAAM6Z,EAAMxZ,OAAOrF,EAAIE,KAAK6E,IAAI/E,GAI5B6e,EAAMxZ,OAAOpF,EAAI,GAErB8E,GAAO8Z,EAAMxZ,OAAOpF,EAAIC,KAAK6E,IAAI9E,EACjC+E,GAAO6Z,EAAMxZ,OAAOpF,EAAIC,KAAK8E,IAAI/E,IAIjC8E,GAAO8Z,EAAMxZ,OAAOpF,EAAIC,KAAK8E,IAAI/E,EACjC+E,GAAO6Z,EAAMxZ,OAAOpF,EAAIC,KAAK6E,IAAI9E,GAI7B4e,EAAMxZ,OAAO3E,EAAI,GAErBqE,GAAO8Z,EAAMxZ,OAAO3E,EAAIR,KAAK6E,IAAIrE,EACjCsE,GAAO6Z,EAAMxZ,OAAO3E,EAAIR,KAAK8E,IAAItE,IAIjCqE,GAAO8Z,EAAMxZ,OAAO3E,EAAIR,KAAK8E,IAAItE,EACjCsE,GAAO6Z,EAAMxZ,OAAO3E,EAAIR,KAAK6E,IAAIrE,GAIzBqE,GAAO8Z,EAAMvZ,UAAYN,GAAO6Z,EAAMvZ,UAIhDguF,mBAAoB,WAmBnB,QAASC,GAAYC,GAEpB,GAAItjF,GAAGy9B,CAEP,KAAMz9B,EAAI,EAAGy9B,EAAI6lD,EAAKlzF,OAAS,EAAG4P,GAAKy9B,EAAGz9B,GAAK,EAAI,CAElDujF,EAASr7C,UAAWo7C,EAAMtjF,EAE1B,IAAIlK,GAAI0tF,EAAQ1zF,EAAI6S,KAAK4P,IAAKgxE,EAASzzF,GAAM0zF,EAAQzzF,EAAI4S,KAAK4P,IAAKgxE,EAASxzF,GAAMyzF,EAAQhzF,EAAImS,KAAK4P,IAAKgxE,EAAS/yF,GAE7G8E,EAAKqiE,EAAGnF,IAAK+wB,GACbhuF,EAAKqiE,EAAGpF,IAAK+wB,GACb/tF,EAAK+iE,EAAG/F,IAAK+wB,EAEjB,IAAK5gF,KAAK7N,KAAO6N,KAAK7N,IAAKQ,EAAIC,EAAIC,GAAMmN,KAAK9N,IAAKS,EAAIC,EAAIC,IAASM,EAInE,OAAO,EAMT,OAAO,EAxCR,GAAI6hE,GAAK,GAAI5mE,GACT6mE,EAAK,GAAI7mE,GACTwnE,EAAK,GAAIxnE,GAGT0yF,EAAK,GAAI1yF,GACT2yF,EAAK,GAAI3yF,GACT4yF,EAAK,GAAI5yF,GAETwyF,EAAW,GAAIxyF,GAEf+B,EAAS,GAAI/B,GACbyyF,EAAU,GAAIzyF,GAEd6yF,EAAiB,GAAI7yF,EA8BzB,OAAO,UAA6B8yF,GAEnC,GAAK7zF,KAAKwyF,UAET,OAAO,CAKRxyF,MAAKyyF,UAAW3vF,GAChB0wF,EAAQ/jC,WAAYzvD,KAAK8E,IAAKhC,GAG9B6kE,EAAGlY,WAAYokC,EAAS/mF,EAAGhK,GAC3B8kE,EAAGnY,WAAYokC,EAAS7tF,EAAGlD,GAC3BylE,EAAG9Y,WAAYokC,EAAS9mF,EAAGjK,GAG3B2wF,EAAGhkC,WAAYmY,EAAID,GACnB+rB,EAAGjkC,WAAY8Y,EAAIX,GACnB+rB,EAAGlkC,WAAYkY,EAAIY,EAKnB,IAAI+qB,IACH,GAAKG,EAAGjzF,EAAGizF,EAAG1zF,EAAG,GAAK2zF,EAAGlzF,EAAGkzF,EAAG3zF,EAAG,GAAK4zF,EAAGnzF,EAAGmzF,EAAG5zF,EAChD0zF,EAAGjzF,EAAG,GAAKizF,EAAG3zF,EAAG4zF,EAAGlzF,EAAG,GAAKkzF,EAAG5zF,EAAG6zF,EAAGnzF,EAAG,GAAKmzF,EAAG7zF,GAC9C2zF,EAAG1zF,EAAG0zF,EAAG3zF,EAAG,GAAK4zF,EAAG3zF,EAAG2zF,EAAG5zF,EAAG,GAAK6zF,EAAG5zF,EAAG4zF,EAAG7zF,EAAG,EAEjD,SAAOuzF,EAAYC,KAOnBA,GAAS,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,KAC1BD,EAAYC,KAQnBM,EAAelkC,aAAc+jC,EAAIC,GACjCJ,GAASM,EAAe9zF,EAAG8zF,EAAe7zF,EAAG6zF,EAAepzF,GACrD6yF,EAAYC,SAMrBJ,WAAY,SAAWz+D,EAAOxU,GAS7B,MAPgBnf,UAAXmf,IAEJ5f,QAAQ4H,KAAM,oDACdgY,EAAS,GAAIlf,IAIPkf,EAAOrB,KAAM6V,GAAQysC,MAAOlhE,KAAK6E,IAAK7E,KAAK8E,MAInDgvF,gBAAiB,WAEhB,GAAIlsB,GAAK,GAAI7mE,EAEb,OAAO,UAA0B0zB,GAEhC,GAAIs/D,GAAensB,EAAGhpD,KAAM6V,GAAQysC,MAAOlhE,KAAK6E,IAAK7E,KAAK8E,IAC1D,OAAOivF,GAAa17D,IAAK5D,GAAQr0B,aAMnC4zF,kBAAmB,WAElB,GAAIpsB,GAAK,GAAI7mE,EAEb,OAAO,UAA4Bkf,GAalC,MAXgBnf,UAAXmf,IAEJ5f,QAAQ4H,KAAM,2DACdgY,EAAS,GAAIjb,IAIdhF,KAAKyyF,UAAWxyE,EAAOnd,QAEvBmd,EAAOhb,OAAuC,GAA9BjF,KAAKo3C,QAASwwB,GAAKxnE,SAE5B6f,MAMTg0E,UAAW,SAAWjZ,GAQrB,MANAh7E,MAAK6E,IAAIC,IAAKk2E,EAAIn2E,KAClB7E,KAAK8E,IAAID,IAAKm2E,EAAIl2E,KAGb9E,KAAKwyF,WAAYxyF,KAAKoyF,YAEpBpyF,MAIRk0F,MAAO,SAAWlZ,GAKjB,MAHAh7E,MAAK6E,IAAIA,IAAKm2E,EAAIn2E,KAClB7E,KAAK8E,IAAIA,IAAKk2E,EAAIl2E,KAEX9E,MAIR6e,aAAc,WAEb,GAAIoD,IACH,GAAIlhB,GACJ,GAAIA,GACJ,GAAIA,GACJ,GAAIA,GACJ,GAAIA,GACJ,GAAIA,GACJ,GAAIA,GACJ,GAAIA,GAGL,OAAO,UAAuBkC,GAG7B,MAAKjD,MAAKwyF,UAAmBxyF,MAG7BiiB,EAAQ,GAAIhc,IAAKjG,KAAK6E,IAAI/E,EAAGE,KAAK6E,IAAI9E,EAAGC,KAAK6E,IAAIrE,GAAIqe,aAAc5b,GACpEgf,EAAQ,GAAIhc,IAAKjG,KAAK6E,IAAI/E,EAAGE,KAAK6E,IAAI9E,EAAGC,KAAK8E,IAAItE,GAAIqe,aAAc5b,GACpEgf,EAAQ,GAAIhc,IAAKjG,KAAK6E,IAAI/E,EAAGE,KAAK8E,IAAI/E,EAAGC,KAAK6E,IAAIrE,GAAIqe,aAAc5b,GACpEgf,EAAQ,GAAIhc,IAAKjG,KAAK6E,IAAI/E,EAAGE,KAAK8E,IAAI/E,EAAGC,KAAK8E,IAAItE,GAAIqe,aAAc5b,GACpEgf,EAAQ,GAAIhc,IAAKjG,KAAK8E,IAAIhF,EAAGE,KAAK6E,IAAI9E,EAAGC,KAAK6E,IAAIrE,GAAIqe,aAAc5b,GACpEgf,EAAQ,GAAIhc,IAAKjG,KAAK8E,IAAIhF,EAAGE,KAAK6E,IAAI9E,EAAGC,KAAK8E,IAAItE,GAAIqe,aAAc5b,GACpEgf,EAAQ,GAAIhc,IAAKjG,KAAK8E,IAAIhF,EAAGE,KAAK8E,IAAI/E,EAAGC,KAAK6E,IAAIrE,GAAIqe,aAAc5b,GACpEgf,EAAQ,GAAIhc,IAAKjG,KAAK8E,IAAIhF,EAAGE,KAAK8E,IAAI/E,EAAGC,KAAK8E,IAAItE,GAAIqe,aAAc5b,GAEpEjD,KAAKopE,cAAennD,GAEbjiB,UAMT07E,UAAW,SAAW94E,GAKrB,MAHA5C,MAAK6E,IAAIw6B,IAAKz8B,GACd5C,KAAK8E,IAAIu6B,IAAKz8B,GAEP5C,MAIRkgC,OAAQ,SAAW86C,GAElB,MAAOA,GAAIn2E,IAAIq7B,OAAQlgC,KAAK6E,MAASm2E,EAAIl2E,IAAIo7B,OAAQlgC,KAAK8E,QAkB5DlD,OAAO48E,OAAQx5E,EAAOyuE,WAErBxtE,IAAK,SAAWnD,EAAQmC,GAKvB,MAHAjF,MAAK8C,OAAO8b,KAAM9b,GAClB9C,KAAKiF,OAASA,EAEPjF,MAIRopE,cAAe,WAEd,GAAI4R,GAAM,GAAIp2E,EAEd,OAAO,UAAwBqd,EAAQkyE,GAEtC,GAAIrxF,GAAS9C,KAAK8C,MAEMhC,UAAnBqzF,EAEJrxF,EAAO8b,KAAMu1E,GAIbnZ,EAAI5R,cAAennD,GAASwwE,UAAW3vF,EAMxC,KAAM,GAFFsxF,GAAc,EAERpkF,EAAI,EAAGyuB,EAAKxc,EAAO7hB,OAAQ4P,EAAIyuB,EAAIzuB,IAE5CokF,EAAczhF,KAAK7N,IAAKsvF,EAAatxF,EAAOsgF,kBAAmBnhE,EAAQjS,IAMxE,OAFAhQ,MAAKiF,OAAS0N,KAAKmwC,KAAMsxC,GAElBp0F,SAMT6K,MAAO,WAEN,OAAO,GAAI7K,MAAKuqE,aAAc3rD,KAAM5e,OAIrC4e,KAAM,SAAWq0E,GAKhB,MAHAjzF,MAAK8C,OAAO8b,KAAMq0E,EAAOnwF,QACzB9C,KAAKiF,OAASguF,EAAOhuF,OAEdjF,MAIRq0F,MAAO,WAEN,MAASr0F,MAAKiF,QAAU,GAIzB2tF,cAAe,SAAWn+D,GAEzB,MAASA,GAAM2uD,kBAAmBpjF,KAAK8C,SAAc9C,KAAKiF,OAASjF,KAAKiF,QAIzE6uF,gBAAiB,SAAWr/D,GAE3B,MAASA,GAAM0uD,WAAYnjF,KAAK8C,QAAW9C,KAAKiF,QAIjD8tF,iBAAkB,SAAWE,GAE5B,GAAIqB,GAAYt0F,KAAKiF,OAASguF,EAAOhuF,MAErC,OAAOguF,GAAOnwF,OAAOsgF,kBAAmBpjF,KAAK8C,SAAcwxF,EAAYA,GAIxExB,cAAe,SAAW9X,GAEzB,MAAOA,GAAI+X,iBAAkB/yF,OAI9BmzF,gBAAiB,SAAWx0E,GAE3B,MAAOhM,MAAK4P,IAAK5D,EAAMm1E,gBAAiB9zF,KAAK8C,UAAc9C,KAAKiF,QAIjEiuF,WAAY,SAAWz+D,EAAOxU,GAE7B,GAAIs0E,GAAgBv0F,KAAK8C,OAAOsgF,kBAAmB3uD,EAkBnD,OAhBgB3zB,UAAXmf,IAEJ5f,QAAQ4H,KAAM,sDACdgY,EAAS,GAAIlf,IAIdkf,EAAOrB,KAAM6V,GAER8/D,EAAkBv0F,KAAKiF,OAASjF,KAAKiF,SAEzCgb,EAAOoY,IAAKr4B,KAAK8C,QAAS62B,YAC1B1Z,EAAOiY,eAAgBl4B,KAAKiF,QAASo6B,IAAKr/B,KAAK8C,SAIzCmd,GAIRu0E,eAAgB,SAAWv0E,GAY1B,MAVgBnf,UAAXmf,IAEJ5f,QAAQ4H,KAAM,0DACdgY,EAAS,GAAIrb,IAIdqb,EAAOha,IAAKjG,KAAK8C,OAAQ9C,KAAK8C,QAC9Bmd,EAAO0yE,eAAgB3yF,KAAKiF,QAErBgb,GAIRpB,aAAc,SAAW5b,GAKxB,MAHAjD,MAAK8C,OAAO+b,aAAc5b,GAC1BjD,KAAKiF,OAASjF,KAAKiF,OAAShC,EAAOumF,oBAE5BxpF,MAIR07E,UAAW,SAAW94E,GAIrB,MAFA5C,MAAK8C,OAAOu8B,IAAKz8B,GAEV5C,MAIRkgC,OAAQ,SAAW+yD,GAElB,MAAOA,GAAOnwF,OAAOo9B,OAAQlgC,KAAK8C,SAAcmwF,EAAOhuF,SAAWjF,KAAKiF,UAmBzErD,OAAO48E,OAAQt5E,EAAMuuE,WAEpBxtE,IAAK,SAAWd,EAAQC,GAKvB,MAHApF,MAAKmF,OAAOyZ,KAAMzZ,GAClBnF,KAAKoF,SAAWA,EAETpF,MAIRy0F,cAAe,SAAW30F,EAAGC,EAAGS,EAAGC,GAKlC,MAHAT,MAAKmF,OAAOc,IAAKnG,EAAGC,EAAGS,GACvBR,KAAKoF,SAAW3E,EAETT,MAIR00F,8BAA+B,SAAWvvF,EAAQsvB,GAKjD,MAHAz0B,MAAKmF,OAAOyZ,KAAMzZ,GAClBnF,KAAKoF,UAAaqvB,EAAM+tC,IAAKxiE,KAAKmF,QAE3BnF,MAIR20F,sBAAuB,WAEtB,GAAI/sB,GAAK,GAAI7mE,GACTwnE,EAAK,GAAIxnE,EAEb,OAAO,UAAgC+L,EAAG9G,EAAG+G,GAE5C,GAAI5H,GAASyiE,EAAGnY,WAAY1iD,EAAG/G,GAAIg9E,MAAOza,EAAG9Y,WAAY3iD,EAAG9G,IAAM2zB,WAMlE,OAFA35B,MAAK00F,8BAA+BvvF,EAAQ2H,GAErC9M,SAMT6K,MAAO,WAEN,OAAO,GAAI7K,MAAKuqE,aAAc3rD,KAAM5e,OAIrC4e,KAAM,SAAWD,GAKhB,MAHA3e,MAAKmF,OAAOyZ,KAAMD,EAAMxZ,QACxBnF,KAAKoF,SAAWuZ,EAAMvZ,SAEfpF,MAIR25B,UAAW,WAIV,GAAIi7D,GAAsB,EAAM50F,KAAKmF,OAAO/E,QAI5C,OAHAJ,MAAKmF,OAAO+yB,eAAgB08D,GAC5B50F,KAAKoF,UAAYwvF,EAEV50F,MAIRumD,OAAQ,WAKP,MAHAvmD,MAAKoF,aACLpF,KAAKmF,OAAOohD,SAELvmD,MAIR8zF,gBAAiB,SAAWr/D,GAE3B,MAAOz0B,MAAKmF,OAAOq9D,IAAK/tC,GAAUz0B,KAAKoF,UAIxCyvF,iBAAkB,SAAW5B,GAE5B,MAAOjzF,MAAK8zF,gBAAiBb,EAAOnwF,QAAWmwF,EAAOhuF,QAIvD6vF,aAAc,SAAWrgE,EAAOxU,GAS/B,MAPgBnf,UAAXmf,IAEJ5f,QAAQ4H,KAAM,uDACdgY,EAAS,GAAIlf,IAIPkf,EAAOrB,KAAM5e,KAAKmF,QAAS+yB,gBAAkBl4B,KAAK8zF,gBAAiBr/D,IAAU4K,IAAK5K,IAI1FsgE,cAAe,WAEd,GAAIntB,GAAK,GAAI7mE,EAEb,OAAO,UAAwBs4E,EAAMp5D,GAEpBnf,SAAXmf,IAEJ5f,QAAQ4H,KAAM,wDACdgY,EAAS,GAAIlf,GAId,IAAImX,GAAYmhE,EAAK2b,MAAOptB,GAExBqtB,EAAcj1F,KAAKmF,OAAOq9D,IAAKtqD,EAEnC,IAAqB,IAAhB+8E,EAAL,CAcA,GAAI7iC,KAAQinB,EAAK1yE,MAAM67D,IAAKxiE,KAAKmF,QAAWnF,KAAKoF,UAAa6vF,CAE9D,MAAK7iC,EAAI,GAAKA,EAAI,GAMlB,MAAOnyC,GAAOrB,KAAM1G,GAAYggB,eAAgBk6B,GAAI/yB,IAAKg6C,EAAK1yE,WAnB7D,IAA4C,IAAvC3G,KAAK8zF,gBAAiBza,EAAK1yE,OAE/B,MAAOsZ,GAAOrB,KAAMy6D,EAAK1yE,WAuB7BuuF,eAAgB,SAAW7b,GAI1B,GAAI8b,GAAYn1F,KAAK8zF,gBAAiBza,EAAK1yE,OACvCyuF,EAAUp1F,KAAK8zF,gBAAiBza,EAAKtsD,IAEzC,OAASooE,GAAY,GAAKC,EAAU,GAASA,EAAU,GAAKD,EAAY,GAIzErC,cAAe,SAAW9X,GAEzB,MAAOA,GAAImY,gBAAiBnzF,OAI7B+yF,iBAAkB,SAAWE,GAE5B,MAAOA,GAAOE,gBAAiBnzF,OAIhCq1F,cAAe,SAAWp1E,GASzB,MAPgBnf,UAAXmf,IAEJ5f,QAAQ4H,KAAM,wDACdgY,EAAS,GAAIlf,IAIPkf,EAAOrB,KAAM5e,KAAKmF,QAAS+yB,gBAAkBl4B,KAAKoF,WAI1DyZ,aAAc,WAEb,GAAI+oD,GAAK,GAAI7mE,GACTu0F,EAAK,GAAIt0F,EAEb,OAAO,UAAuBiC,EAAQsyF,GAErC,GAAInqF,GAAemqF,GAAwBD,EAAG72E,gBAAiBxb,GAE3DuyF,EAAiBx1F,KAAKq1F,cAAeztB,GAAK/oD,aAAc5b,GAExDkC,EAASnF,KAAKmF,OAAOs9E,aAAcr3E,GAAeuuB,WAItD,OAFA35B,MAAKoF,UAAaowF,EAAehzB,IAAKr9D,GAE/BnF,SAMT07E,UAAW,SAAW94E,GAIrB,MAFA5C,MAAKoF,UAAYxC,EAAO4/D,IAAKxiE,KAAKmF,QAE3BnF,MAIRkgC,OAAQ,SAAWvhB,GAElB,MAAOA,GAAMxZ,OAAO+6B,OAAQlgC,KAAKmF,SAAcwZ,EAAMvZ,WAAapF,KAAKoF,YA2BzExD,OAAO48E,OAAQn5E,EAAQouE,WAEtBxtE,IAAK,SAAWX,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,GAEnC,GAAIC,GAAS5F,KAAK4F,MASlB,OAPAA,GAAQ,GAAIgZ,KAAMtZ,GAClBM,EAAQ,GAAIgZ,KAAMrZ,GAClBK,EAAQ,GAAIgZ,KAAMpZ,GAClBI,EAAQ,GAAIgZ,KAAMnZ,GAClBG,EAAQ,GAAIgZ,KAAMlZ,GAClBE,EAAQ,GAAIgZ,KAAMjZ,GAEX3F,MAIR6K,MAAO,WAEN,OAAO,GAAI7K,MAAKuqE,aAAc3rD,KAAM5e,OAIrC4e,KAAM,SAAW62E,GAIhB,IAAM,GAFF7vF,GAAS5F,KAAK4F,OAERoK,EAAI,EAAGA,EAAI,EAAGA,IAEvBpK,EAAQoK,GAAI4O,KAAM62E,EAAQ7vF,OAAQoK,GAInC,OAAOhQ,OAIRu/B,cAAe,SAAWq4B,GAEzB,GAAIhyD,GAAS5F,KAAK4F,OACdi/E,EAAKjtB,EAAE13D,SACPw1F,EAAM7Q,EAAI,GAAK8Q,EAAM9Q,EAAI,GAAK+Q,EAAM/Q,EAAI,GAAKgR,EAAMhR,EAAI,GACvDiR,EAAMjR,EAAI,GAAKkR,EAAMlR,EAAI,GAAKmR,EAAMnR,EAAI,GAAKoR,EAAMpR,EAAI,GACvDqR,EAAMrR,EAAI,GAAKsR,EAAMtR,EAAI,GAAKuR,EAAOvR,EAAI,IAAMwR,EAAOxR,EAAI,IAC1DyR,EAAOzR,EAAI,IAAM0R,EAAO1R,EAAI,IAAM2R,EAAO3R,EAAI,IAAM4R,EAAO5R,EAAI,GASlE,OAPAj/E,GAAQ,GAAI6uF,cAAeoB,EAAMH,EAAKO,EAAMH,EAAKO,EAAOH,EAAKO,EAAOH,GAAO38D,YAC3E/zB,EAAQ,GAAI6uF,cAAeoB,EAAMH,EAAKO,EAAMH,EAAKO,EAAOH,EAAKO,EAAOH,GAAO38D,YAC3E/zB,EAAQ,GAAI6uF,cAAeoB,EAAMF,EAAKM,EAAMF,EAAKM,EAAOF,EAAKM,EAAOF,GAAO58D,YAC3E/zB,EAAQ,GAAI6uF,cAAeoB,EAAMF,EAAKM,EAAMF,EAAKM,EAAOF,EAAKM,EAAOF,GAAO58D,YAC3E/zB,EAAQ,GAAI6uF,cAAeoB,EAAMD,EAAKK,EAAMD,EAAKK,EAAOD,EAAMK,EAAOD,GAAO78D,YAC5E/zB,EAAQ,GAAI6uF,cAAeoB,EAAMD,EAAKK,EAAMD,EAAKK,EAAOD,EAAMK,EAAOD,GAAO78D,YAErE35B,MAIR68B,iBAAkB,WAEjB,GAAIo2D,GAAS,GAAIjuF,EAEjB,OAAO,UAA2Bwb,GAEjC,GAAInI,GAAWmI,EAAOnI,QAQtB,OANiC,QAA5BA,EAASjK,gBACbiK,EAAS4iE,wBAEVgY,EAAOr0E,KAAMvG,EAASjK,gBACpByQ,aAAc2B,EAAOnV,aAEhBrL,KAAK+yF,iBAAkBE,OAMhCvzC,iBAAkB,WAEjB,GAAIuzC,GAAS,GAAIjuF,EAEjB,OAAO,UAA2B0xF,GAMjC,MAJAzD,GAAOnwF,OAAOmD,IAAK,EAAG,EAAG,GACzBgtF,EAAOhuF,OAAS,kBAChBguF,EAAOp0E,aAAc63E,EAAOrrF,aAErBrL,KAAK+yF,iBAAkBE,OAMhCF,iBAAkB,SAAWE,GAM5B,IAAM,GAJFrtF,GAAS5F,KAAK4F,OACd9C,EAASmwF,EAAOnwF,OAChB6zF,GAAc1D,EAAOhuF,OAEf+K,EAAI,EAAGA,EAAI,EAAGA,IAAO,CAE9B,GAAI8mB,GAAWlxB,EAAQoK,GAAI8jF,gBAAiBhxF,EAE5C,IAAKg0B,EAAW6/D,EAEf,OAAO,EAMT,OAAO,GAIR7D,cAAe,WAEd,GAAI39D,GAAI,GAAIp0B,EAEZ,OAAO,UAAwBi6E,GAI9B,IAAM,GAFFp1E,GAAS5F,KAAK4F,OAERoK,EAAI,EAAGA,EAAI,EAAGA,IAAO,CAE9B,GAAI2O,GAAQ/Y,EAAQoK,EAQpB,IAJAmlB,EAAEr1B,EAAI6e,EAAMxZ,OAAOrF,EAAI,EAAIk7E,EAAIl2E,IAAIhF,EAAIk7E,EAAIn2E,IAAI/E,EAC/Cq1B,EAAEp1B,EAAI4e,EAAMxZ,OAAOpF,EAAI,EAAIi7E,EAAIl2E,IAAI/E,EAAIi7E,EAAIn2E,IAAI9E,EAC/Co1B,EAAE30B,EAAIme,EAAMxZ,OAAO3E,EAAI,EAAIw6E,EAAIl2E,IAAItE,EAAIw6E,EAAIn2E,IAAIrE,EAE1Cme,EAAMm1E,gBAAiB3+D,GAAM,EAEjC,OAAO,EAMT,OAAO,MAMTy9D,cAAe,SAAWn+D,GAIzB,IAAM,GAFF7uB,GAAS5F,KAAK4F,OAERoK,EAAI,EAAGA,EAAI,EAAGA,IAEvB,GAAKpK,EAAQoK,GAAI8jF,gBAAiBr/D,GAAU,EAE3C,OAAO,CAMT,QAAO,IAMT,IAAImiE,IAAoB,mFAEpBC,GAAyB,+DAEzBC,GAAqB,2EAErBC,GAAiB,6aAEjBC,GAAsB,wFAEtBC,GAAe,2CAEfC,GAAqB,0CAErBC,GAAQ,q7LAERC,GAAwB,m9BAExBC,GAA2B,2jBAE3BC,GAAgC,6LAEhCC,GAA8B,sHAE9BC,GAAyB,4HAEzBC,GAAiB,0DAEjBC,GAAsB,qDAEtBC,GAAoB,mDAEpBC,GAAe,sDAEfC,GAAS,4rEAETC,GAA8B,wmIAE9BC,GAAuB,iIAEvBC,GAA8B,oJAE9BC,GAAyB,oKAEzBC,GAAuB,+MAEvBC,GAA4B,qEAE5BC,GAAqB,0DAErBC,GAA0B,gvFAE1BC,GAAkB,iqDAElBC,GAAuB,+oBAEvBC,GAAqB,iOAErBC,GAAgB,ugBAEhBC,GAAa,6DAEbC,GAAkB,yDAElBC,GAAe,2VAEfC,GAAoB,+MAEpBC,GAA4B,0YAE5BC,GAAoB,+HAEpBC,GAAyB,iGAEzBC,GAAwB,yuEAExBC,GAAoB,spHAEpBC,GAAgC,q6GAEhCC,GAAwB,wMAExBC,GAA6B,66CAE7BC,GAA2B,8iBAE3BC,GAAgC,+uJAEhCC,GAAwB,8xFAExBC,GAAuB,2yBAEvBC,GAAsB,8PAEtBC,GAAuB,0IAEvBC,GAA4B,0IAE5BC,GAA0B,qJAE1BC,GAAqB,wPAErBC,GAAe,sJAEfC,GAAoB,qDAEpBC,GAAwB,0MAExBC,GAA6B,kFAE7BC,GAAwB,yKAExBC,GAA6B,qEAE7BC,GAAqB,gVAErBC,GAA0B,2KAE1BC,GAAqB,0qBAErBC,GAAwB,iaAExBC,GAAuB,mgBAEvBC,GAA0B,46BAE1BC,GAAU,qyCAEVC,GAA+B,8EAE/BC,GAAiB,gHAEjBC,GAAqB,0FAErBC,GAA0B,qVAE1BC,GAAwB,yKAExBC,GAA6B,qEAE7BC,GAA0B,kpNAE1BC,GAAwB,0eAExBC,GAAmB,slBAEnBC,GAA2B,4wCAE3BC,GAAkB,kOAElBC,GAAuB,4gCAEvBC,GAAkB,iYAElBC,GAAoB,8WAEpBC,GAAuB,0LAEvBC,GAA4B,mEAE5BC,GAAuB,+FAEvBC,GAA4B,g7BAE5BC,GAAmB,iQAEnBC,GAAiB,gSAEjBC,GAAY,yRAEZC,GAAoB,oFAEpBC,GAAkB,2GAElBC,GAAa,6EAEbC,GAAkB,0JAElBC,GAAY,wPAEZC,GAAY,iOAEZC,GAAa,uvBAEbC,GAAa,oqBAEbC,GAAoB,+rBAEpBC,GAAoB,otBAEpBC,GAAgB,oXAEhBC,GAAgB,+LAEhBC,GAAkB,qyBAElBC,GAAkB,khBAElBC,GAAiB,w8CAEjBC,GAAiB,u2BAEjBC,GAAmB,ylEAEnBC,GAAmB,kkCAEnBC,GAAiB,0/DAEjBC,GAAiB,uqCAEjBC,GAAoB,8wEAEpBC,GAAoB,+mCAEpBC,GAAc,2lBAEdC,GAAc,qhCAEdC,GAAc,svBAEdC,GAAc,urBAEdC,GAAc,iWAEdC,GAAc,iOAEdC,GAAc,ypBAEdC,GAAc,wnCAEdlxE;AACHgqE,kBAAmBA,GACnBC,uBAAwBA,GACxBC,mBAAoBA,GACpBC,eAAgBA,GAChBC,oBAAqBA,GACrBC,aAAcA,GACdC,mBAAoBA,GACpBC,MAAOA,GACPC,sBAAuBA,GACvBC,yBAA0BA,GAC1BC,8BAA+BA,GAC/BC,4BAA6BA,GAC7BC,uBAAwBA,GACxBC,eAAgBA,GAChBC,oBAAqBA,GACrBC,kBAAmBA,GACnBC,aAAcA,GACdC,OAAQA,GACRC,4BAA6BA,GAC7BC,qBAAsBA,GACtBC,4BAA6BA,GAC7BC,uBAAwBA,GACxBC,qBAAsBA,GACtBC,0BAA2BA,GAC3BC,mBAAoBA,GACpBC,wBAAyBA,GACzBC,gBAAiBA,GACjBC,qBAAsBA,GACtBC,mBAAoBA,GACpBW,8BAA+BA,GAC/BV,cAAeA,GACfC,WAAYA,GACZC,gBAAiBA,GACjBC,aAAcA,GACdC,kBAAmBA,GACnBC,0BAA2BA,GAC3BC,kBAAmBA,GACnBC,uBAAwBA,GACxBC,sBAAuBA,GACvBC,kBAAmBA,GACnBE,sBAAuBA,GACvBC,2BAA4BA,GAC5BC,yBAA0BA,GAC1BC,8BAA+BA,GAC/BC,sBAAuBA,GACvBC,qBAAsBA,GACtBC,oBAAqBA,GACrBC,qBAAsBA,GACtBC,0BAA2BA,GAC3BC,wBAAyBA,GACzBC,mBAAoBA,GACpBC,aAAcA,GACdC,kBAAmBA,GACnBC,sBAAuBA,GACvBC,2BAA4BA,GAC5BC,sBAAuBA,GACvBC,2BAA4BA,GAC5BC,mBAAoBA,GACpBC,wBAAyBA,GACzBC,mBAAoBA,GACpBC,sBAAuBA,GACvBC,qBAAsBA,GACtBC,wBAAyBA,GACzBC,QAASA,GACTC,6BAA8BA,GAC9BC,eAAgBA,GAChBC,mBAAoBA,GACpBC,wBAAyBA,GACzBC,sBAAuBA,GACvBC,2BAA4BA,GAC5BC,wBAAyBA,GACzBC,sBAAuBA,GACvBC,iBAAkBA,GAClBC,yBAA0BA,GAC1BC,gBAAiBA,GACjBC,qBAAsBA,GACtBC,gBAAiBA,GACjBC,kBAAmBA,GACnBC,qBAAsBA,GACtBC,0BAA2BA,GAC3BC,qBAAsBA,GACtBC,0BAA2BA,GAC3BC,iBAAkBA,GAClBC,eAAgBA,GAChBC,UAAWA,GACXC,kBAAmBA,GACnBC,gBAAiBA,GACjBC,WAAYA,GACZC,gBAAiBA,GAEjBC,UAAWA,GACXC,UAAWA,GACXC,WAAYA,GACZC,WAAYA,GACZC,kBAAmBA,GACnBC,kBAAmBA,GACnBC,cAAeA,GACfC,cAAeA,GACfC,gBAAiBA,GACjBC,gBAAiBA,GACjBC,eAAgBA,GAChBC,eAAgBA,GAChBC,iBAAkBA,GAClBC,iBAAkBA,GAClBC,eAAgBA,GAChBC,eAAgBA,GAChBC,kBAAmBA,GACnBC,kBAAmBA,GACnBC,YAAaA,GACbC,YAAaA,GACbC,YAAaA,GACbC,YAAaA,GACbC,YAAaA,GACbC,YAAaA,GACbC,YAAaA,GACbC,YAAaA,IAOVh9C,IAEHi9C,MAAO,SAAW9mF,GAIjB,IAAM,GAFF+mF,MAEM9sF,EAAI,EAAGA,EAAI+F,EAAS7W,OAAQ8Q,IAAO,CAE5C,GAAI43E,GAAM9oF,KAAK6K,MAAOoM,EAAU/F,GAEhC,KAAM,GAAIikB,KAAK2zD,GAEdkV,EAAQ7oE,GAAM2zD,EAAK3zD,GAMrB,MAAO6oE,IAIRnzF,MAAO,SAAWozF,GAEjB,GAAIC,KAEJ,KAAM,GAAIhtF,KAAK+sF,GAAe,CAE7BC,EAAchtF,KAEd,KAAM,GAAIikB,KAAK8oE,GAAc/sF,GAAM,CAElC,GAAIitF,GAAgBF,EAAc/sF,GAAKikB,EAElCgpE,KAAmBA,EAAc7wF,SACrC6wF,EAAc5N,WAAa4N,EAAcxa,WACzCwa,EAAcrc,WAAaqc,EAAcjxF,WAAaixF,EAAc3M,WACpE2M,EAAc7jF,WAEd4jF,EAAchtF,GAAKikB,GAAMgpE,EAActzF,QAE5BuC,MAAMC,QAAS8wF,GAE1BD,EAAchtF,GAAKikB,GAAMgpE,EAActxC,QAIvCqxC,EAAchtF,GAAKikB,GAAMgpE,GAQ5B,MAAOD,KAULE,IAAkBC,UAAa,SAAUC,aAAgB,SAAUC,KAAQ,MAAUC,WAAc,QAAUC,MAAS,SACzHC,MAAS,SAAUC,OAAU,SAAUC,MAAS,EAAUC,eAAkB,SAAUC,KAAQ,IAAUC,WAAc,QACtHC,MAAS,SAAUC,UAAa,SAAUC,UAAa,QAAUC,WAAc,QAAUC,UAAa,SAAUC,MAAS,SACzHC,eAAkB,QAAUC,SAAY,SAAUC,QAAW,SAAUC,KAAQ,MAAUC,SAAY,IAAUC,SAAY,MAC3HC,cAAiB,SAAUC,SAAY,SAAUC,UAAa,MAAUC,SAAY,SAAUC,UAAa,SAAUC,YAAe,QACpIC,eAAkB,QAAUC,WAAc,SAAUC,WAAc,SAAUC,QAAW,QAAUC,WAAc,SAAUC,aAAgB,QACzIC,cAAiB,QAAUC,cAAiB,QAAUC,cAAiB,QAAUC,cAAiB,MAAUC,WAAc,QAC1HC,SAAY,SAAUC,YAAe,MAAUC,QAAW,QAAUC,QAAW,QAAUC,WAAc,QAAUC,UAAa,SAC9HC,YAAe,SAAUC,YAAe,QAAUC,QAAW,SAAUC,UAAa,SAAUC,WAAc,SAAUC,KAAQ,SAC9HC,UAAa,SAAUC,KAAQ,QAAUC,MAAS,MAAUC,YAAe,SAAUC,KAAQ,QAAUC,SAAY,SAAUC,QAAW,SACxIC,UAAa,SAAUC,OAAU,QAAUC,MAAS,SAAUC,MAAS,SAAUC,SAAY,SAAUC,cAAiB,SAAUC,UAAa,QAC/IC,aAAgB,SAAUC,UAAa,SAAUC,WAAc,SAAUC,UAAa,SAAUC,qBAAwB,SAAUC,UAAa,SAC/IC,WAAc,QAAUC,UAAa,SAAUC,UAAa,SAAUC,YAAe,SAAUC,cAAiB,QAAUC,aAAgB,QAC1IC,eAAkB,QAAUC,eAAkB,QAAUC,eAAkB,SAAUC,YAAe,SAAUC,KAAQ,MAAUC,UAAa,QAC5IC,MAAS,SAAUC,QAAW,SAAUC,OAAU,QAAUC,iBAAoB,QAAUC,WAAc,IAAUC,aAAgB,SAClIC,aAAgB,QAAUC,eAAkB,QAAUC,gBAAmB,QAAUC,kBAAqB,MAAUC,gBAAmB,QACrIC,gBAAmB,SAAUC,aAAgB,QAAUC,UAAa,SAAUC,UAAa,SAAUC,SAAY,SAAUC,YAAe,SAC1IC,KAAQ,IAAUC,QAAW,SAAUC,MAAS,QAAUC,UAAa,QAAUC,OAAU,SAAUC,UAAa,SAAUC,OAAU,SACtIC,cAAiB,SAAUC,UAAa,SAAUC,cAAiB,SAAUC,cAAiB,SAAUC,WAAc,SAAUC,UAAa,SAC7IC,KAAQ,SAAUC,KAAQ,SAAUC,KAAQ,SAAUC,WAAc,SAAUC,OAAU,QAAUC,cAAiB,QAAUC,IAAO,SAAUC,UAAa,SAC3JC,UAAa,QAAUC,YAAe,QAAUC,OAAU,SAAUC,WAAc,SAAUC,SAAY,QAAUC,SAAY,SAC9HC,OAAU,SAAUC,OAAU,SAAUC,QAAW,QAAUC,UAAa,QAAUC,UAAa,QAAUC,UAAa,QAAUC,KAAQ,SAC1IC,YAAe,MAAUC,UAAa,QAAU7uC,IAAO,SAAU8uC,KAAQ,MAAUC,QAAW,SAAUC,OAAU,SAAUC,UAAa,QACzIC,OAAU,SAAUC,MAAS,SAAUC,MAAS,SAAUC,WAAc,SAAUC,OAAU,SAAUC,YAAe,SAetH3lG,QAAO48E,OAAQ34E,EAAM4tE,WAEpBnmE,SAAS,EAETxH,EAAG,EAAGC,EAAG,EAAGC,EAAG,EAEfC,IAAK,SAAWnE,GAgBf,MAdKA,IAASA,EAAMwL,QAEnBtN,KAAK4e,KAAM9c,GAEiB,gBAAVA,GAElB9B,KAAKwnG,OAAQ1lG,GAEe,gBAAVA,IAElB9B,KAAKynG,SAAU3lG,GAIT9B,MAIR+hF,UAAW,SAAWC,GAMrB,MAJAhiF,MAAK8F,EAAIk8E,EACThiF,KAAK+F,EAAIi8E,EACThiF,KAAKgG,EAAIg8E,EAEFhiF,MAIRwnG,OAAQ,SAAWpvB,GAQlB,MANAA,GAAMzlE,KAAKC,MAAOwlE,GAElBp4E,KAAK8F,GAAMsyE,GAAO,GAAK,KAAQ,IAC/Bp4E,KAAK+F,GAAMqyE,GAAO,EAAI,KAAQ,IAC9Bp4E,KAAKgG,GAAY,IAANoyE,GAAc,IAElBp4E,MAIRkG,OAAQ,SAAWJ,EAAGC,EAAGC,GAMxB,MAJAhG,MAAK8F,EAAIA,EACT9F,KAAK+F,EAAIA,EACT/F,KAAKgG,EAAIA,EAEFhG,MAIR0nG,OAAQ,WAEP,QAASC,GAASxyE,EAAGy+B,EAAGxB,GAIvB,MAFKA,GAAI,IAAIA,GAAK,GACbA,EAAI,IAAIA,GAAK,GACbA,EAAI,EAAI,EAAWj9B,EAAgB,GAAVy+B,EAAIz+B,GAAUi9B,EACvCA,EAAI,GAAewB,EACnBxB,EAAI,EAAI,EAAWj9B,EAAgB,GAAVy+B,EAAIz+B,IAAY,EAAI,EAAIi9B,GAC/Cj9B,EAIR,MAAO,UAAiBwnC,EAAGI,EAAG9sD,GAO7B,GAJA0sD,EAAI16D,GAAM4+E,gBAAiBlkB,EAAG,GAC9BI,EAAI96D,GAAMi/D,MAAOnE,EAAG,EAAG,GACvB9sD,EAAIhO,GAAMi/D,MAAOjxD,EAAG,EAAG,GAEZ,IAAN8sD,EAEJ/8D,KAAK8F,EAAI9F,KAAK+F,EAAI/F,KAAKgG,EAAIiK,MAErB,CAEN,GAAIklB,GAAIllB,GAAK,GAAMA,GAAM,EAAI8sD,GAAM9sD,EAAI8sD,EAAM9sD,EAAI8sD,EAC7CnJ,EAAM,EAAI3jD,EAAMklB,CAEpBn1B,MAAK8F,EAAI6hG,EAAS/zC,EAAGz+B,EAAGwnC,EAAI,EAAI,GAChC38D,KAAK+F,EAAI4hG,EAAS/zC,EAAGz+B,EAAGwnC,GACxB38D,KAAKgG,EAAI2hG,EAAS/zC,EAAGz+B,EAAGwnC,EAAI,EAAI,GAIjC,MAAO38D,UAMTynG,SAAU,SAAW/+C,GAEpB,QAASk/C,GAAax+E,GAELtoB,SAAXsoB,GAEA4f,WAAY5f,GAAW,GAE3B/oB,QAAQ4H,KAAM,mCAAqCygD,EAAQ,qBAO7D,GAAIkP,EAEJ,IAAKA,EAAI,kCAAkCnvC,KAAMigC,GAAU,CAI1D,GAAI17C,GACA7K,EAAOy1D,EAAG,GACVntC,EAAamtC,EAAG,EAEpB,QAASz1D,GAER,IAAK,MACL,IAAK,OAEJ,GAAK6K,EAAQ,gEAAgEyb,KAAMgC,GASlF,MANAzqB,MAAK8F,EAAI6M,KAAK9N,IAAK,IAAKqoB,SAAUlgB,EAAO,GAAK,KAAS,IACvDhN,KAAK+F,EAAI4M,KAAK9N,IAAK,IAAKqoB,SAAUlgB,EAAO,GAAK,KAAS,IACvDhN,KAAKgG,EAAI2M,KAAK9N,IAAK,IAAKqoB,SAAUlgB,EAAO,GAAK,KAAS,IAEvD46F,EAAa56F,EAAO,IAEbhN,IAIR,IAAKgN,EAAQ,sEAAsEyb,KAAMgC,GASxF,MANAzqB,MAAK8F,EAAI6M,KAAK9N,IAAK,IAAKqoB,SAAUlgB,EAAO,GAAK,KAAS,IACvDhN,KAAK+F,EAAI4M,KAAK9N,IAAK,IAAKqoB,SAAUlgB,EAAO,GAAK,KAAS,IACvDhN,KAAKgG,EAAI2M,KAAK9N,IAAK,IAAKqoB,SAAUlgB,EAAO,GAAK,KAAS,IAEvD46F,EAAa56F,EAAO,IAEbhN,IAIR,MAED,KAAK,MACL,IAAK,OAEJ,GAAKgN,EAAQ,gFAAgFyb,KAAMgC,GAAe,CAGjH,GAAIkyC,GAAI3zB,WAAYh8B,EAAO,IAAQ,IAC/B+vD,EAAI7vC,SAAUlgB,EAAO,GAAK,IAAO,IACjCiD,EAAIid,SAAUlgB,EAAO,GAAK,IAAO,GAIrC,OAFA46F,GAAa56F,EAAO,IAEbhN,KAAK0nG,OAAQ/qC,EAAGI,EAAG9sD,SAQvB,IAAK2nD,EAAI,qBAAqBnvC,KAAMigC,GAAU,CAIpD,GAAI0vB,GAAMxgB,EAAG,GACT3wC,EAAOmxD,EAAIh4E,MAEf,IAAc,IAAT6mB,EAOJ,MAJAjnB,MAAK8F,EAAIonB,SAAUkrD,EAAIyvB,OAAQ,GAAMzvB,EAAIyvB,OAAQ,GAAK,IAAO,IAC7D7nG,KAAK+F,EAAImnB,SAAUkrD,EAAIyvB,OAAQ,GAAMzvB,EAAIyvB,OAAQ,GAAK,IAAO,IAC7D7nG,KAAKgG,EAAIknB,SAAUkrD,EAAIyvB,OAAQ,GAAMzvB,EAAIyvB,OAAQ,GAAK,IAAO,IAEtD7nG,IAED,IAAc,IAATinB,EAOX,MAJAjnB,MAAK8F,EAAIonB,SAAUkrD,EAAIyvB,OAAQ,GAAMzvB,EAAIyvB,OAAQ,GAAK,IAAO,IAC7D7nG,KAAK+F,EAAImnB,SAAUkrD,EAAIyvB,OAAQ,GAAMzvB,EAAIyvB,OAAQ,GAAK,IAAO,IAC7D7nG,KAAKgG,EAAIknB,SAAUkrD,EAAIyvB,OAAQ,GAAMzvB,EAAIyvB,OAAQ,GAAK,IAAO,IAEtD7nG,KAMT,GAAK0oD,GAASA,EAAMtoD,OAAS,EAAI,CAGhC,GAAIg4E,GAAMgmB,GAAe11C,EAEZ5nD,UAARs3E,EAGJp4E,KAAKwnG,OAAQpvB,GAKb/3E,QAAQ4H,KAAM,8BAAgCygD,GAMhD,MAAO1oD,OAIR6K,MAAO,WAEN,MAAO,IAAI7K,MAAKuqE,YAAavqE,KAAK8F,EAAG9F,KAAK+F,EAAG/F,KAAKgG,IAInD4Y,KAAM,SAAW5R,GAMhB,MAJAhN,MAAK8F,EAAIkH,EAAMlH,EACf9F,KAAK+F,EAAIiH,EAAMjH,EACf/F,KAAKgG,EAAIgH,EAAMhH,EAERhG,MAIR8nG,kBAAmB,SAAW96F,EAAOuhB,GAQpC,MANqBztB,UAAhBytB,IAA4BA,EAAc,GAE/CvuB,KAAK8F,EAAI6M,KAAKu9C,IAAKljD,EAAMlH,EAAGyoB,GAC5BvuB,KAAK+F,EAAI4M,KAAKu9C,IAAKljD,EAAMjH,EAAGwoB,GAC5BvuB,KAAKgG,EAAI2M,KAAKu9C,IAAKljD,EAAMhH,EAAGuoB,GAErBvuB,MAIR+nG,kBAAmB,SAAW/6F,EAAOuhB,GAEfztB,SAAhBytB,IAA4BA,EAAc,EAE/C,IAAIy5E,GAAgBz5E,EAAc,EAAQ,EAAMA,EAAgB,CAMhE,OAJAvuB,MAAK8F,EAAI6M,KAAKu9C,IAAKljD,EAAMlH,EAAGkiG,GAC5BhoG,KAAK+F,EAAI4M,KAAKu9C,IAAKljD,EAAMjH,EAAGiiG,GAC5BhoG,KAAKgG,EAAI2M,KAAKu9C,IAAKljD,EAAMhH,EAAGgiG,GAErBhoG,MAIRioG,qBAAsB,SAAW15E,GAIhC,MAFAvuB,MAAK8nG,kBAAmB9nG,KAAMuuB,GAEvBvuB,MAIRkoG,qBAAsB,SAAW35E,GAIhC,MAFAvuB,MAAK+nG,kBAAmB/nG,KAAMuuB,GAEvBvuB,MAIRmoG,iBAAkB,WAEjB,QAASC,GAAcr7F,GAEtB,MAASA,GAAI,OAAgB,YAAJA,EAAmB4F,KAAKu9C,IAAS,YAAJnjD,EAAmB,YAAc,KAIxF,MAAO,UAA2BC,GAMjC,MAJAhN,MAAK8F,EAAIsiG,EAAcp7F,EAAMlH,GAC7B9F,KAAK+F,EAAIqiG,EAAcp7F,EAAMjH,GAC7B/F,KAAKgG,EAAIoiG,EAAcp7F,EAAMhH,GAEtBhG,SAMTqoG,iBAAkB,WAEjB,QAASC,GAAcv7F,GAEtB,MAASA,GAAI,SAAkB,MAAJA,EAAY,MAAU4F,KAAKu9C,IAAKnjD,EAAG,QAAc,KAI7E,MAAO,UAA2BC,GAMjC,MAJAhN,MAAK8F,EAAIwiG,EAAct7F,EAAMlH,GAC7B9F,KAAK+F,EAAIuiG,EAAct7F,EAAMjH,GAC7B/F,KAAKgG,EAAIsiG,EAAct7F,EAAMhH,GAEtBhG,SAMTuoG,oBAAqB,WAIpB,MAFAvoG,MAAKmoG,iBAAkBnoG,MAEhBA,MAIRwoG,oBAAqB,WAIpB,MAFAxoG,MAAKqoG,iBAAkBroG,MAEhBA,MAIRyoG,OAAQ,WAEP,MAAkB,KAATzoG,KAAK8F,GAAa,GAAgB,IAAT9F,KAAK+F,GAAa,EAAe,IAAT/F,KAAKgG,GAAa,GAI7E0iG,aAAc,WAEb,OAAS,SAAW1oG,KAAKyoG,SAASxzE,SAAU,KAAO43B,WAIpD87C,OAAQ,SAAW1oF,GAIFnf,SAAXmf,IAEJ5f,QAAQ4H,KAAM,iDACdgY,GAAW08C,EAAG,EAAGI,EAAG,EAAG9sD,EAAG,GAI3B,IAKI24F,GAAKC,EALL/iG,EAAI9F,KAAK8F,EAAGC,EAAI/F,KAAK+F,EAAGC,EAAIhG,KAAKgG,EAEjClB,EAAM6N,KAAK7N,IAAKgB,EAAGC,EAAGC,GACtBnB,EAAM8N,KAAK9N,IAAKiB,EAAGC,EAAGC,GAGtB8iG,GAAcjkG,EAAMC,GAAQ,CAEhC,IAAKD,IAAQC,EAEZ8jG,EAAM,EACNC,EAAa,MAEP,CAEN,GAAI7T,GAAQlwF,EAAMD,CAIlB,QAFAgkG,EAAaC,GAAa,GAAM9T,GAAUlwF,EAAMD,GAAQmwF,GAAU,EAAIlwF,EAAMD,GAEnEC,GAER,IAAKgB,GAAG8iG,GAAQ7iG,EAAIC,GAAMgvF,GAAUjvF,EAAIC,EAAI,EAAI,EAAK,MACrD,KAAKD,GAAG6iG,GAAQ5iG,EAAIF,GAAMkvF,EAAQ,CAAG,MACrC,KAAKhvF,GAAG4iG,GAAQ9iG,EAAIC,GAAMivF,EAAQ,EAInC4T,GAAO,EAQR,MAJA3oF,GAAO08C,EAAIisC,EACX3oF,EAAO88C,EAAI8rC,EACX5oF,EAAOhQ,EAAI64F,EAEJ7oF,GAIR8oF,SAAU,WAET,MAAO,QAAsB,IAAT/oG,KAAK8F,EAAY,GAAM,KAAmB,IAAT9F,KAAK+F,EAAY,GAAM,KAAmB,IAAT/F,KAAKgG,EAAY,GAAM,KAI9GgjG,UAAW,WAEV,GAAIC,KAEJ,OAAO,UAAWtsC,EAAGI,EAAG9sD,GAQvB,MANAjQ,MAAK2oG,OAAQM,GAEbA,EAAItsC,GAAKA,EAAGssC,EAAIlsC,GAAKA,EAAGksC,EAAIh5F,GAAKA,EAEjCjQ,KAAK0nG,OAAQuB,EAAItsC,EAAGssC,EAAIlsC,EAAGksC,EAAIh5F,GAExBjQ,SAMTq/B,IAAK,SAAWryB,GAMf,MAJAhN,MAAK8F,GAAKkH,EAAMlH,EAChB9F,KAAK+F,GAAKiH,EAAMjH,EAChB/F,KAAKgG,GAAKgH,EAAMhH,EAEThG,MAIRkpG,UAAW,SAAWpwB,EAAQC,GAM7B,MAJA/4E,MAAK8F,EAAIgzE,EAAOhzE,EAAIizE,EAAOjzE,EAC3B9F,KAAK+F,EAAI+yE,EAAO/yE,EAAIgzE,EAAOhzE,EAC3B/F,KAAKgG,EAAI8yE,EAAO9yE,EAAI+yE,EAAO/yE,EAEpBhG,MAIRqiF,UAAW,SAAWtlB,GAMrB,MAJA/8D,MAAK8F,GAAKi3D,EACV/8D,KAAK+F,GAAKg3D,EACV/8D,KAAKgG,GAAK+2D,EAEH/8D,MAIRq4B,IAAK,SAAWrrB,GAMf,MAJAhN,MAAK8F,EAAI6M,KAAK7N,IAAK,EAAG9E,KAAK8F,EAAIkH,EAAMlH,GACrC9F,KAAK+F,EAAI4M,KAAK7N,IAAK,EAAG9E,KAAK+F,EAAIiH,EAAMjH,GACrC/F,KAAKgG,EAAI2M,KAAK7N,IAAK,EAAG9E,KAAKgG,EAAIgH,EAAMhH,GAE9BhG,MAIRk/B,SAAU,SAAWlyB,GAMpB,MAJAhN,MAAK8F,GAAKkH,EAAMlH,EAChB9F,KAAK+F,GAAKiH,EAAMjH,EAChB/F,KAAKgG,GAAKgH,EAAMhH,EAEThG,MAIRk4B,eAAgB,SAAW6kC,GAM1B,MAJA/8D,MAAK8F,GAAKi3D,EACV/8D,KAAK+F,GAAKg3D,EACV/8D,KAAKgG,GAAK+2D,EAEH/8D,MAIRowD,KAAM,SAAWpjD,EAAO0N,GAMvB,MAJA1a,MAAK8F,IAAOkH,EAAMlH,EAAI9F,KAAK8F,GAAM4U,EACjC1a,KAAK+F,IAAOiH,EAAMjH,EAAI/F,KAAK+F,GAAM2U,EACjC1a,KAAKgG,IAAOgH,EAAMhH,EAAIhG,KAAKgG,GAAM0U,EAE1B1a,MAIRmpG,QAAS,WAER,GAAIC,IAASzsC,EAAG,EAAGI,EAAG,EAAG9sD,EAAG,GACxBo5F,GAAS1sC,EAAG,EAAGI,EAAG,EAAG9sD,EAAG,EAE5B,OAAO,UAAkBjD,EAAO0N,GAE/B1a,KAAK2oG,OAAQS,GACbp8F,EAAM27F,OAAQU,EAEd,IAAI1sC,GAAI16D,GAAMmuD,KAAMg5C,EAAKzsC,EAAG0sC,EAAK1sC,EAAGjiD,GAChCqiD,EAAI96D,GAAMmuD,KAAMg5C,EAAKrsC,EAAGssC,EAAKtsC,EAAGriD,GAChCzK,EAAIhO,GAAMmuD,KAAMg5C,EAAKn5F,EAAGo5F,EAAKp5F,EAAGyK,EAIpC,OAFA1a,MAAK0nG,OAAQ/qC,EAAGI,EAAG9sD,GAEZjQ,SAMTkgC,OAAQ,SAAWnzB,GAElB,MAASA,GAAEjH,IAAM9F,KAAK8F,GAASiH,EAAEhH,IAAM/F,KAAK+F,GAASgH,EAAE/G,IAAMhG,KAAKgG,GAInEkyC,UAAW,SAAW7wC,EAAOzE,GAQ5B,MANgB9B,UAAX8B,IAAuBA,EAAS,GAErC5C,KAAK8F,EAAIuB,EAAOzE,GAChB5C,KAAK+F,EAAIsB,EAAOzE,EAAS,GACzB5C,KAAKgG,EAAIqB,EAAOzE,EAAS,GAElB5C,MAIR8e,QAAS,SAAWzX,EAAOzE,GAS1B,MAPe9B,UAAVuG,IAAsBA,MACXvG,SAAX8B,IAAuBA,EAAS,GAErCyE,EAAOzE,GAAW5C,KAAK8F,EACvBuB,EAAOzE,EAAS,GAAM5C,KAAK+F,EAC3BsB,EAAOzE,EAAS,GAAM5C,KAAKgG,EAEpBqB,GAIRi4D,OAAQ,WAEP,MAAOt/D,MAAKyoG,WAUd,IAAI5jD,KAEHgzC,QAEC3yC,SAAWpjD,MAAO,GAAI+D,GAAO,WAC7BkO,SAAWjS,MAAO,GAElB+T,KAAO/T,MAAO,MACd2jD,aAAe3jD,MAAO,GAAId,IAE1BmV,UAAYrU,MAAO,OAIpBwnG,aAECpzF,aAAepU,MAAO,OAIvBynG,QAECnzF,QAAUtU,MAAO,MACjBujD,YAAcvjD,UACdyU,cAAgBzU,MAAO,GACvB0U,iBAAmB1U,MAAO,KAC1BwjD,aAAexjD,MAAO,IAIvB0nG,OAECxzF,OAASlU,MAAO,MAChBmU,gBAAkBnU,MAAO,IAI1B2nG,UAEC3zF,UAAYhU,MAAO,MACnBiU,mBAAqBjU,MAAO,IAI7B4nG,aAEC16E,aAAeltB,MAAO,OAIvB6nG,SAECr+E,SAAWxpB,MAAO,MAClBukD,WAAavkD,MAAO,IAIrB8nG,WAECr+E,WAAazpB,MAAO,MACpBwkD,aAAexkD,MAAO,GAAIjC,GAAS,EAAG,KAIvCgqG,iBAEC56E,iBAAmBntB,MAAO,MAC1B44B,mBAAqB54B,MAAO,GAC5B64B,kBAAoB74B,MAAO,IAI5BgoG,cAEC56E,cAAgBptB,MAAO,OAIxBioG,cAEC56E,cAAgBrtB,MAAO,OAIxBkoG,aAECv6E,aAAe3tB,MAAO,OAIvByR,KAEC0yC,YAAcnkD,MAAO,OACrBikD,SAAWjkD,MAAO,GAClBkkD,QAAUlkD,MAAO,KACjB+jD,UAAY/jD,MAAO,GAAI+D,GAAO,YAI/B2N,QAECytC,mBAAqBn/C,UAErBo/C,mBAAqBp/C,SAAW4zB,YAC/Bxd,aACAlL,SAEA0pB,UACAC,cACAC,gBACAC,mBAGD4B,sBAAwB32B,UACxB42B,yBAA2B52B,UAE3Bq/C,YAAcr/C,SAAW4zB,YACxB1oB,SACAlC,YACAoN,aACA4e,YACAC,WACAC,eACAC,SAEAP,UACAC,cACAC,gBACAC,mBAGDkC,eAAiBj3B,UACjBk3B,kBAAoBl3B,UAEpBu/C,aAAev/C,SAAW4zB,YACzB1oB,SACAlC,YACAmsB,SACAH,YAEAJ,UACAC,cACAC,gBACAC,iBACAK,oBACAC,qBAGDqC,gBAAkB13B,UAClB23B,mBAAqB33B,UAErBw/C,kBAAoBx/C,SAAW4zB,YAC9Bxd,aACAkf,YACAC,iBAID+pB,gBAAkBt/C,SAAW4zB,YAC5B1oB,SACAlC,YACAnH,SACAC,aAKFqe,QAECijC,SAAWpjD,MAAO,GAAI+D,GAAO,WAC7BkO,SAAWjS,MAAO,GAClBmlB,MAAQnlB,MAAO,GACfiJ,OAASjJ,MAAO,GAChB+T,KAAO/T,MAAO,MACd2jD,aAAe3jD,MAAO,GAAId,KAI3B01F,QAECxxC,SAAWpjD,MAAO,GAAI+D,GAAO,WAC7BkO,SAAWjS,MAAO,GAClBgB,QAAUhB,MAAO,GAAIjC,GAAS,GAAK,KACnCkD,UAAYjB,MAAO,GACnB+T,KAAO/T,MAAO,MACd2jD,aAAe3jD,MAAO,GAAId,MAYxB+Y,IAEHkwF,OAEChzF,SAAU6pC,GAAci9C,OACvBl5C,GAAYgzC,OACZhzC,GAAYykD,YACZzkD,GAAY0kD,OACZ1kD,GAAY2kD,MACZ3kD,GAAY4kD,SACZ5kD,GAAYtxC,MAGb2D,aAAc0V,GAAYowE,eAC1B7lF,eAAgByV,GAAYmwE,gBAI7BmN,SAECjzF,SAAU6pC,GAAci9C,OACvBl5C,GAAYgzC,OACZhzC,GAAYykD,YACZzkD,GAAY0kD,OACZ1kD,GAAY2kD,MACZ3kD,GAAY4kD,SACZ5kD,GAAY6kD,YACZ7kD,GAAYtxC,IACZsxC,GAAYrxC,QAEX2xC,UAAYrjD,MAAO,GAAI+D,GAAO,OAIhCqR,aAAc0V,GAAYswE,iBAC1B/lF,eAAgByV,GAAYqwE,kBAI7BkN,OAEClzF,SAAU6pC,GAAci9C,OACvBl5C,GAAYgzC,OACZhzC,GAAYykD,YACZzkD,GAAY0kD,OACZ1kD,GAAY2kD,MACZ3kD,GAAY4kD,SACZ5kD,GAAY6kD,YACZ7kD,GAAY8kD,QACZ9kD,GAAY+kD,UACZ/kD,GAAYglD,gBACZhlD,GAAYmlD,YACZnlD,GAAYtxC,IACZsxC,GAAYrxC,QAEX2xC,UAAYrjD,MAAO,GAAI+D,GAAO,IAC9BsgD,UAAYrkD,MAAO,GAAI+D,GAAO,UAC9BugD,WAAatkD,MAAO,OAItBoV,aAAc0V,GAAYwwE,eAC1BjmF,eAAgByV,GAAYuwE,gBAI7BiN,UAECnzF,SAAU6pC,GAAci9C,OACvBl5C,GAAYgzC,OACZhzC,GAAY0kD,OACZ1kD,GAAY2kD,MACZ3kD,GAAY4kD,SACZ5kD,GAAY6kD,YACZ7kD,GAAY8kD,QACZ9kD,GAAY+kD,UACZ/kD,GAAYglD,gBACZhlD,GAAYilD,aACZjlD,GAAYklD,aACZllD,GAAYtxC,IACZsxC,GAAYrxC,QAEX2xC,UAAYrjD,MAAO,GAAI+D,GAAO,IAC9B2gD,WAAa1kD,MAAO,IACpB2kD,WAAa3kD,MAAO,IACpB4kD,iBAAmB5kD,MAAO,MAI5BoV,aAAc0V,GAAY0wE,kBAC1BnmF,eAAgByV,GAAYywE,mBAI7Bp7E,QAEChL,SAAU6pC,GAAci9C,OACvBl5C,GAAY5iC,OACZ4iC,GAAYtxC,MAGb2D,aAAc0V,GAAY8wE,YAC1BvmF,eAAgByV,GAAY6wE,aAI7B4M,QAECpzF,SAAU6pC,GAAci9C,OACvBl5C,GAAYgzC,OACZhzC,GAAYtxC,KAEXxI,OAASjJ,MAAO,GAChB4jD,UAAY5jD,MAAO,GACnB6jD,WAAa7jD,MAAO,MAItBoV,aAAc0V,GAAYkwE,gBAC1B3lF,eAAgByV,GAAYiwE,iBAI7BpsF,OAECwG,SAAU6pC,GAAci9C,OACvBl5C,GAAYgzC,OACZhzC,GAAYglD,kBAGb3yF,aAAc0V,GAAY4vE,WAC1BrlF,eAAgByV,GAAY2vE,YAI7Bp3F,QAEC8R,SAAU6pC,GAAci9C,OACvBl5C,GAAYgzC,OACZhzC,GAAY8kD,QACZ9kD,GAAY+kD,UACZ/kD,GAAYglD,iBAEX91F,SAAWjS,MAAO,MAIpBoV,aAAc0V,GAAY4wE,YAC1BrmF,eAAgByV,GAAY2wE,aAI7B7G,QAECz/E,SAAU6pC,GAAci9C,OACvBl5C,GAAY6xC,OACZ7xC,GAAYtxC,MAGb2D,aAAc0V,GAAYkxE,YAC1B3mF,eAAgByV,GAAYixE,aAQ7B7jF,MAEC/C,UACCoD,OAASvY,MAAO,MAChBwoG,OAASxoG,UACTiS,SAAWjS,MAAO,IAGnBoV,aAAc0V,GAAY0vE,UAC1BnlF,eAAgByV,GAAYyvE,WAI7BkO,UAECtzF,UACCuzF,WAAa1oG,MAAO,OAGrBoV,aAAc0V,GAAYgwE,cAC1BzlF,eAAgByV,GAAY+vE,eAI7B8N,cAECxzF,SAAU6pC,GAAci9C,OACvBl5C,GAAYgzC,OACZhzC,GAAYglD,iBAEXjvE,mBAAqB94B,MAAO,GAAIf,IAChC85B,cAAgB/4B,MAAO,GACvBg5B,aAAeh5B,MAAO,QAIxBoV,aAAc0V,GAAY8vE,kBAC1BvlF,eAAgByV,GAAY6vE,mBAI7B/lE,QAECzf,SAAU6pC,GAAci9C,OACvBl5C,GAAYrxC,OACZqxC,GAAYtxC,KAEXvG,OAASlL,MAAO,GAAI+D,GAAO,IAC3BkO,SAAWjS,MAAO,MAIpBoV,aAAc0V,GAAYgxE,YAC1BzmF,eAAgByV,GAAY+wE,aAM9B5jF,IAAU2wF,UAETzzF,SAAU6pC,GAAci9C,OACvBhkF,GAAUqwF,SAASnzF,UAElB0vC,WAAa7kD,MAAO,GACpB8kD,oBAAsB9kD,MAAO,MAI/BoV,aAAc0V,GAAY0wE,kBAC1BnmF,eAAgByV,GAAYywE,mBAmO7BzzF,EAAM+gG,gBAAmB,MAAO,MAAO,MAAO,MAAO,MAAO,OAE5D/gG,EAAMG,aAAe,MAErBnI,OAAOqJ,iBAAkBrB,EAAM6pE,WAE9B3zE,GAECuJ,IAAK,WAEJ,MAAOrJ,MAAKU,IAIbuF,IAAK,SAAWnE,GAEf9B,KAAKU,GAAKoB,EACV9B,KAAK0sF,qBAMP3sF,GAECsJ,IAAK,WAEJ,MAAOrJ,MAAKW,IAIbsF,IAAK,SAAWnE,GAEf9B,KAAKW,GAAKmB,EACV9B,KAAK0sF,qBAMPlsF,GAEC6I,IAAK,WAEJ,MAAOrJ,MAAKY,IAIbqF,IAAK,SAAWnE,GAEf9B,KAAKY,GAAKkB,EACV9B,KAAK0sF,qBAMP7iF,OAECR,IAAK,WAEJ,MAAOrJ,MAAK8J,QAIb7D,IAAK,SAAWnE,GAEf9B,KAAK8J,OAAShI,EACd9B,KAAK0sF,uBAQR9qF,OAAO48E,OAAQ50E,EAAM6pE,WAEpBgS,SAAS,EAETx/E,IAAK,SAAWnG,EAAGC,EAAGS,EAAGqJ,GASxB,MAPA7J,MAAKU,GAAKZ,EACVE,KAAKW,GAAKZ,EACVC,KAAKY,GAAKJ,EACVR,KAAK8J,OAASD,GAAS7J,KAAK8J,OAE5B9J,KAAK0sF,mBAEE1sF,MAIR6K,MAAO,WAEN,MAAO,IAAI7K,MAAKuqE,YAAavqE,KAAKU,GAAIV,KAAKW,GAAIX,KAAKY,GAAIZ,KAAK8J,SAI9D8U,KAAM,SAAW4mE,GAShB,MAPAxlF,MAAKU,GAAK8kF,EAAM9kF,GAChBV,KAAKW,GAAK6kF,EAAM7kF,GAChBX,KAAKY,GAAK4kF,EAAM5kF,GAChBZ,KAAK8J,OAAS07E,EAAM17E,OAEpB9J,KAAK0sF,mBAEE1sF,MAIRm6C,sBAAuB,SAAWyd,EAAG/tD,EAAOH,GAE3C,GAAIw3D,GAAQj/D,GAAMi/D,MAId0jB,EAAKhtB,EAAE13D,SACP8sF,EAAMpI,EAAI,GAAKqI,EAAMrI,EAAI,GAAKsI,EAAMtI,EAAI,GACxCuI,EAAMvI,EAAI,GAAKwI,EAAMxI,EAAI,GAAKyI,EAAMzI,EAAI,GACxC0I,EAAM1I,EAAI,GAAK2I,EAAM3I,EAAI,GAAK4I,EAAM5I,EAAI,GA8G5C,OA5GA/6E,GAAQA,GAAS7J,KAAK8J,OAEP,QAAVD,GAEJ7J,KAAKW,GAAKgS,KAAKi4F,KAAM1pC,EAAOgsB,KAAU,IAEjCv6E,KAAK4P,IAAK2qE,GAAQ,QAEtBltF,KAAKU,GAAKiS,KAAKg/C,OAAS07B,EAAKG,GAC7BxtF,KAAKY,GAAK+R,KAAKg/C,OAASs7B,EAAKD,KAI7BhtF,KAAKU,GAAKiS,KAAKg/C,MAAO47B,EAAKH,GAC3BptF,KAAKY,GAAK,IAIU,QAAViJ,GAEX7J,KAAKU,GAAKiS,KAAKi4F,MAAQ1pC,EAAOmsB,KAAU,IAEnC16E,KAAK4P,IAAK8qE,GAAQ,QAEtBrtF,KAAKW,GAAKgS,KAAKg/C,MAAOu7B,EAAKM,GAC3BxtF,KAAKY,GAAK+R,KAAKg/C,MAAOw7B,EAAKC,KAI3BptF,KAAKW,GAAKgS,KAAKg/C,OAAS27B,EAAKN,GAC7BhtF,KAAKY,GAAK,IAIU,QAAViJ,GAEX7J,KAAKU,GAAKiS,KAAKi4F,KAAM1pC,EAAOqsB,KAAU,IAEjC56E,KAAK4P,IAAKgrE,GAAQ,QAEtBvtF,KAAKW,GAAKgS,KAAKg/C,OAAS27B,EAAKE,GAC7BxtF,KAAKY,GAAK+R,KAAKg/C,OAASs7B,EAAKG,KAI7BptF,KAAKW,GAAK,EACVX,KAAKY,GAAK+R,KAAKg/C,MAAOw7B,EAAKH,KAIP,QAAVnjF,GAEX7J,KAAKW,GAAKgS,KAAKi4F,MAAQ1pC,EAAOosB,KAAU,IAEnC36E,KAAK4P,IAAK+qE,GAAQ,QAEtBttF,KAAKU,GAAKiS,KAAKg/C,MAAO47B,EAAKC,GAC3BxtF,KAAKY,GAAK+R,KAAKg/C,MAAOw7B,EAAKH,KAI3BhtF,KAAKU,GAAK,EACVV,KAAKY,GAAK+R,KAAKg/C,OAASs7B,EAAKG,KAIT,QAAVvjF,GAEX7J,KAAKY,GAAK+R,KAAKi4F,KAAM1pC,EAAOisB,KAAU,IAEjCx6E,KAAK4P,IAAK4qE,GAAQ,QAEtBntF,KAAKU,GAAKiS,KAAKg/C,OAAS07B,EAAKD,GAC7BptF,KAAKW,GAAKgS,KAAKg/C,OAAS27B,EAAKN,KAI7BhtF,KAAKU,GAAK,EACVV,KAAKW,GAAKgS,KAAKg/C,MAAOu7B,EAAKM,KAIP,QAAV3jF,GAEX7J,KAAKY,GAAK+R,KAAKi4F,MAAQ1pC,EAAO+rB,KAAU,IAEnCt6E,KAAK4P,IAAK0qE,GAAQ,QAEtBjtF,KAAKU,GAAKiS,KAAKg/C,MAAO47B,EAAKH,GAC3BptF,KAAKW,GAAKgS,KAAKg/C,MAAOu7B,EAAKF,KAI3BhtF,KAAKU,GAAKiS,KAAKg/C,OAAS07B,EAAKG,GAC7BxtF,KAAKW,GAAK,IAMXN,QAAQ4H,KAAM,kEAAoE4B,GAInF7J,KAAK8J,OAASD,EAETH,KAAW,GAAQ1J,KAAK0sF,mBAEtB1sF,MAIRuK,kBAAmB,WAElB,GAAItH,GAAS,GAAIhD,EAEjB,OAAO,UAA4B2zD,EAAG/pD,EAAOH,GAI5C,MAFAzG,GAAOqjF,2BAA4B1yB,GAE5B5zD,KAAKm6C,sBAAuBl3C,EAAQ4G,EAAOH,OAMpDmhG,eAAgB,SAAW15F,EAAGtH,GAE7B,MAAO7J,MAAKiG,IAAKkL,EAAErR,EAAGqR,EAAEpR,EAAGoR,EAAE3Q,EAAGqJ,GAAS7J,KAAK8J,SAI/CghG,QAAS,WAIR,GAAIl3C,GAAI,GAAIrzD,EAEZ,OAAO,UAAkBwqG,GAIxB,MAFAn3C,GAAEvpD,aAAcrK,MAETA,KAAKuK,kBAAmBqpD,EAAGm3C,OAMpC7qE,OAAQ,SAAWslD,GAElB,MAASA,GAAM9kF,KAAOV,KAAKU,IAAU8kF,EAAM7kF,KAAOX,KAAKW,IAAU6kF,EAAM5kF,KAAOZ,KAAKY,IAAU4kF,EAAM17E,SAAW9J,KAAK8J,QAIpHouC,UAAW,SAAW7wC,GASrB,MAPArH,MAAKU,GAAK2G,EAAO,GACjBrH,KAAKW,GAAK0G,EAAO,GACjBrH,KAAKY,GAAKyG,EAAO,GACGvG,SAAfuG,EAAO,KAAoBrH,KAAK8J,OAASzC,EAAO,IAErDrH,KAAK0sF,mBAEE1sF,MAIR8e,QAAS,SAAWzX,EAAOzE,GAU1B,MARe9B,UAAVuG,IAAsBA,MACXvG,SAAX8B,IAAuBA,EAAS,GAErCyE,EAAOzE,GAAW5C,KAAKU,GACvB2G,EAAOzE,EAAS,GAAM5C,KAAKW,GAC3B0G,EAAOzE,EAAS,GAAM5C,KAAKY,GAC3ByG,EAAOzE,EAAS,GAAM5C,KAAK8J,OAEpBzC,GAIR2jG,UAAW,SAAWC,GAErB,MAAKA,GAEGA,EAAehlG,IAAKjG,KAAKU,GAAIV,KAAKW,GAAIX,KAAKY,IAI3C,GAAIG,GAASf,KAAKU,GAAIV,KAAKW,GAAIX,KAAKY,KAM7CoK,SAAU,SAAWlE,GAIpB,MAFA9G,MAAK0sF,iBAAmB5lF,EAEjB9G,MAIR0sF,iBAAkB,eAcnB9qF,OAAO48E,OAAQx0E,EAAOypE,WAErBxtE,IAAK,SAAWilG,GAEflrG,KAAKiK,KAAO,GAAKihG,EAAU,GAI5B3qE,OAAQ,SAAW2qE,GAElBlrG,KAAKiK,MAAQ,GAAKihG,EAAU,GAI7BC,OAAQ,SAAWD,GAElBlrG,KAAKiK,MAAQ,GAAKihG,EAAU,GAI7B9sE,QAAS,SAAW8sE,GAEnBlrG,KAAKiK,QAAY,GAAKihG,EAAU,IAIjC1uE,KAAM,SAAWhxB,GAEhB,MAAuC,MAA9BxL,KAAKiK,KAAOuB,EAAOvB,QAc9B,IAAIO,IAAa,CAgFjBN,GAASU,UAAY,GAAI7J,GAAS,EAAG,EAAG,GACxCmJ,EAASoB,yBAA0B,EAEnCpB,EAASupE,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQrxF,EAAgB6zE,YAElElJ,YAAargE,EAEbkhG,YAAY,EAEZjxF,eAAgB,aAChBomC,cAAe,aAEf8qD,YAAa,SAAWpoG,GAEvBjD,KAAKiD,OAAO65B,iBAAkB75B,EAAQjD,KAAKiD,QAE3CjD,KAAKiD,OAAOq1C,UAAWt4C,KAAK8K,SAAU9K,KAAKoK,WAAYpK,KAAK+K,QAI7DqvC,gBAAiB,SAAWwZ,GAI3B,MAFA5zD,MAAKoK,WAAWivB,YAAau6B,GAEtB5zD,MAIRsrG,yBAA0B,SAAWthB,EAAMnxD,GAI1C74B,KAAKoK,WAAW0iF,iBAAkB9C,EAAMnxD,IAIzC0yE,qBAAsB,SAAW/lB,GAEhCxlF,KAAKoK,WAAWC,aAAcm7E,GAAO,IAItCgmB,sBAAuB,SAAW5zC,GAIjC53D,KAAKoK,WAAW+vC,sBAAuByd,IAIxC6zC,0BAA2B,SAAW73C,GAIrC5zD,KAAKoK,WAAWwU,KAAMg1C,IAIvB83C,aAAc,WAKb,GAAIvyC,GAAK,GAAI54D,EAEb,OAAO,UAAuBypF,EAAMnxD,GAMnC,MAJAsgC,GAAG2zB,iBAAkB9C,EAAMnxD,GAE3B74B,KAAKoK,WAAW80B,SAAUi6B,GAEnBn5D,SAMT2rG,kBAAmB,WAMlB,GAAIxyC,GAAK,GAAI54D,EAEb,OAAO,UAA4BypF,EAAMnxD,GAMxC,MAJAsgC,GAAG2zB,iBAAkB9C,EAAMnxD,GAE3B74B,KAAKoK,WAAWivB,YAAa8/B,GAEtBn5D,SAMT4rG,QAAS,WAER,GAAIhkC,GAAK,GAAI7mE,GAAS,EAAG,EAAG,EAE5B,OAAO,UAAkB83B,GAExB,MAAO74B,MAAK0rG,aAAc9jC,EAAI/uC,OAMhC0gD,QAAS,WAER,GAAI3R,GAAK,GAAI7mE,GAAS,EAAG,EAAG,EAE5B,OAAO,UAAkB83B,GAExB,MAAO74B,MAAK0rG,aAAc9jC,EAAI/uC,OAMhCgzE,QAAS,WAER,GAAIjkC,GAAK,GAAI7mE,GAAS,EAAG,EAAG,EAE5B,OAAO,UAAkB83B,GAExB,MAAO74B,MAAK0rG,aAAc9jC,EAAI/uC,OAMhCizE,gBAAiB,WAKhB,GAAIlkC,GAAK,GAAI7mE,EAEb,OAAO,UAA0BipF,EAAMlzD,GAMtC,MAJA8wC,GAAGhpD,KAAMorE,GAAO5vC,gBAAiBp6C,KAAKoK,YAEtCpK,KAAK8K,SAASu0B,IAAKuoC,EAAG1vC,eAAgBpB,IAE/B92B,SAMT+rG,WAAY,WAEX,GAAInkC,GAAK,GAAI7mE,GAAS,EAAG,EAAG,EAE5B,OAAO,UAAqB+1B,GAE3B,MAAO92B,MAAK8rG,gBAAiBlkC,EAAI9wC,OAMnCk1E,WAAY,WAEX,GAAIpkC,GAAK,GAAI7mE,GAAS,EAAG,EAAG,EAE5B,OAAO,UAAqB+1B,GAE3B,MAAO92B,MAAK8rG,gBAAiBlkC,EAAI9wC,OAMnCm1E,WAAY,WAEX,GAAIrkC,GAAK,GAAI7mE,GAAS,EAAG,EAAG,EAE5B,OAAO,UAAqB+1B,GAE3B,MAAO92B,MAAK8rG,gBAAiBlkC,EAAI9wC,OAMnCo1E,aAAc,SAAW/5F,GAExB,MAAOA,GAAO0M,aAAc7e,KAAKqL,cAIlC8gG,aAAc,WAEb,GAAI7W,GAAK,GAAIr1F,EAEb,OAAO,UAAuBkS,GAE7B,MAAOA,GAAO0M,aAAcy2E,EAAG/6C,WAAYv6C,KAAKqL,kBAMlD2zB,OAAQ,WAIP,GAAIs2D,GAAK,GAAIr1F,GACTkS,EAAS,GAAIpR,EAEjB,OAAO,UAAiBjB,EAAGC,EAAGS,GAExBV,EAAEoN,UAENiF,EAAOyM,KAAM9e,GAIbqS,EAAOlM,IAAKnG,EAAGC,EAAGS,GAIdR,KAAK6qD,SAETyqC,EAAGt2D,OAAQh/B,KAAK8K,SAAUqH,EAAQnS,KAAK2K,IAIvC2qF,EAAGt2D,OAAQ7sB,EAAQnS,KAAK8K,SAAU9K,KAAK2K,IAIxC3K,KAAKoK,WAAW+vC,sBAAuBm7C,OAMzCj2D,IAAK,SAAW7e,GAEf,GAAKrgB,UAAUC,OAAS,EAAI,CAE3B,IAAM,GAAI4P,GAAI,EAAGA,EAAI7P,UAAUC,OAAQ4P,IAEtChQ,KAAKq/B,IAAKl/B,UAAW6P,GAItB,OAAOhQ,MAIR,MAAKwgB,KAAWxgB,MAEfK,QAAQC,MAAO,kEAAmEkgB,GAC3ExgB,OAIDwgB,GAAUA,EAAO4qF,YAEA,OAAlB5qF,EAAO/V,QAEX+V,EAAO/V,OAAOjB,OAAQgX,GAIvBA,EAAO/V,OAASzK,KAChBwgB,EAAOm4B,eAAiBl3C,KAAM,UAE9BzB,KAAK0K,SAAS0H,KAAMoO,IAIpBngB,QAAQC,MAAO,gEAAiEkgB,GAI1ExgB,OAIRwJ,OAAQ,SAAWgX,GAElB,GAAKrgB,UAAUC,OAAS,EAAI,CAE3B,IAAM,GAAI4P,GAAI,EAAGA,EAAI7P,UAAUC,OAAQ4P,IAEtChQ,KAAKwJ,OAAQrJ,UAAW6P,GAIzB,OAAOhQ,MAIR,GAAIoQ,GAAQpQ,KAAK0K,SAAS6qB,QAAS/U,EAYnC,OAVKpQ,UAEJoQ,EAAO/V,OAAS,KAEhB+V,EAAOm4B,eAAiBl3C,KAAM,YAE9BzB,KAAK0K,SAASu0E,OAAQ7uE,EAAO,IAIvBpQ,MAIRosG,cAAe,SAAWhsF,GAEzB,MAAOpgB,MAAKqsG,oBAAqB,KAAMjsF,IAIxCksF,gBAAiB,SAAWnqG,GAE3B,MAAOnC,MAAKqsG,oBAAqB,OAAQlqG,IAI1CkqG,oBAAqB,SAAWlqG,EAAML,GAErC,GAAK9B,KAAMmC,KAAWL,EAAQ,MAAO9B,KAErC,KAAM,GAAIgQ,GAAI,EAAGC,EAAIjQ,KAAK0K,SAAStK,OAAQ4P,EAAIC,EAAGD,IAAO,CAExD,GAAIu8F,GAAQvsG,KAAK0K,SAAUsF,GACvBwQ,EAAS+rF,EAAMF,oBAAqBlqG,EAAML,EAE9C,IAAgBhB,SAAX0f,EAEJ,MAAOA,KAUVgsF,iBAAkB,SAAWvsF,GAW5B,MATgBnf,UAAXmf,IAEJ5f,QAAQ4H,KAAM,8DACdgY,EAAS,GAAIlf,IAIdf,KAAKi/B,mBAAmB,GAEjBhf,EAAOkY,sBAAuBn4B,KAAKqL,cAI3CohG,mBAAoB,WAEnB,GAAI3hG,GAAW,GAAI/J,GACfgK,EAAQ,GAAIhK,EAEhB,OAAO,UAA6Bkf,GAanC,MAXgBnf,UAAXmf,IAEJ5f,QAAQ4H,KAAM,gEACdgY,EAAS,GAAI1f,IAIdP,KAAKi/B,mBAAmB,GAExBj/B,KAAKqL,YAAYitC,UAAWxtC,EAAUmV,EAAQlV,GAEvCkV,MAMTysF,cAAe,WAEd,GAAI5hG,GAAW,GAAI/J,GACfqJ,EAAa,GAAI7J,EAErB,OAAO,UAAwB0f,GAa9B,MAXgBnf,UAAXmf,IAEJ5f,QAAQ4H,KAAM,2DACdgY,EAAS,GAAIlf,IAIdf,KAAKi/B,mBAAmB,GAExBj/B,KAAKqL,YAAYitC,UAAWxtC,EAAUV,EAAY6V,GAE3CA,MAMT0sF,kBAAmB,SAAW1sF,GAEbnf,SAAXmf,IAEJ5f,QAAQ4H,KAAM,+DACdgY,EAAS,GAAIlf,IAIdf,KAAKi/B,mBAAmB,EAExB,IAAIovB,GAAIruD,KAAKqL,YAAYnL,QAEzB,OAAO+f,GAAOha,IAAKooD,EAAG,GAAKA,EAAG,GAAKA,EAAG,KAAO10B,aAI9C69C,QAAS,aAET5sB,SAAU,SAAW9jD,GAEpBA,EAAU9G,KAIV,KAAM,GAFF0K,GAAW1K,KAAK0K,SAEVsF,EAAI,EAAGC,EAAIvF,EAAStK,OAAQ4P,EAAIC,EAAGD,IAE5CtF,EAAUsF,GAAI46C,SAAU9jD,IAM1B8lG,gBAAiB,SAAW9lG,GAE3B,GAAK9G,KAAKyL,WAAY,EAAtB,CAEA3E,EAAU9G,KAIV,KAAM,GAFF0K,GAAW1K,KAAK0K,SAEVsF,EAAI,EAAGC,EAAIvF,EAAStK,OAAQ4P,EAAIC,EAAGD,IAE5CtF,EAAUsF,GAAI48F,gBAAiB9lG,KAMjC+lG,kBAAmB,SAAW/lG,GAE7B,GAAI2D,GAASzK,KAAKyK,MAEF,QAAXA,IAEJ3D,EAAU2D,GAEVA,EAAOoiG,kBAAmB/lG,KAM5B0+C,aAAc,WAEbxlD,KAAKiD,OAAOm1C,QAASp4C,KAAK8K,SAAU9K,KAAKoK,WAAYpK,KAAK+K,OAE1D/K,KAAKuL,wBAAyB,GAI/B0zB,kBAAmB,SAAW6tE,GAExB9sG,KAAKgD,kBAAmBhD,KAAKwlD,gBAE7BxlD,KAAKuL,wBAA0BuhG,KAEd,OAAhB9sG,KAAKyK,OAETzK,KAAKqL,YAAYuT,KAAM5e,KAAKiD,QAI5BjD,KAAKqL,YAAYyxB,iBAAkB98B,KAAKyK,OAAOY,YAAarL,KAAKiD,QAIlEjD,KAAKuL,wBAAyB,EAE9BuhG,GAAQ,EAQT,KAAM,GAFFpiG,GAAW1K,KAAK0K,SAEVsF,EAAI,EAAGC,EAAIvF,EAAStK,OAAQ4P,EAAIC,EAAGD,IAE5CtF,EAAUsF,GAAIivB,kBAAmB6tE,IAMnCxtC,OAAQ,SAAW4xB,GAmDlB,QAAS6b,GAAWC,EAASC,GAQ5B,MANiCnsG,UAA5BksG,EAASC,EAAQjrG,QAErBgrG,EAASC,EAAQjrG,MAASirG,EAAQ3tC,OAAQ4xB,IAIpC+b,EAAQjrG,KA6FhB,QAASkrG,GAAkB3tF,GAE1B,GAAI2rD,KACJ,KAAM,GAAIv1C,KAAOpW,GAAQ,CAExB,GAAI7a,GAAO6a,EAAOoW,SACXjxB,GAAK0sF,SACZlmB,EAAO94D,KAAM1N,GAGd,MAAOwmE,GA/JR,GAAIimB,GAA0BrwF,SAATowF,GAAsC,gBAATA,GAE9CzS,IAKC0S,KAGJD,GACC/wE,cACA67D,aACA75D,YACAqB,UACAw2C,WAGDykB,EAAO2S,UACN7tF,QAAS,IACT9B,KAAM,SACN4vF,UAAW,mBAOb,IAAI7wE,KAgCJ,IA9BAA,EAAOxe,KAAOhC,KAAKgC,KACnBwe,EAAO/e,KAAOzB,KAAKyB,KAEA,KAAdzB,KAAKmC,OAAcqe,EAAOre,KAAOnC,KAAKmC,MACtCnC,KAAK0L,cAAe,IAAO8U,EAAO9U,YAAa,GAC/C1L,KAAK2L,iBAAkB,IAAO6U,EAAO7U,eAAgB,GACrD3L,KAAKyL,WAAY,IAAQ+U,EAAO/U,SAAU,GAC1CzL,KAAK4L,iBAAkB,IAAQ4U,EAAO5U,eAAgB,GACjC,IAArB5L,KAAK6L,cAAoB2U,EAAO3U,YAAc7L,KAAK6L,aACf,OAApCshG,KAAKC,UAAWptG,KAAK8L,YAAsB0U,EAAO1U,SAAW9L,KAAK8L,UAEvE0U,EAAOhV,OAASxL,KAAKwL,OAAOvB,KAC5BuW,EAAOvd,OAASjD,KAAKiD,OAAO6b,UAEvB9e,KAAKgD,oBAAqB,IAAQwd,EAAOxd,kBAAmB,GAgB5DhD,KAAKy8B,QAAUz8B,KAAK08B,QAAU18B,KAAK28B,SAAW,CAElDnc,EAAOnI,SAAW00F,EAAW7b,EAAK/wE,WAAYngB,KAAKqY,SAEnD,IAAIxH,GAAa7Q,KAAKqY,SAASxH,UAE/B,IAAoB/P,SAAf+P,GAAkD/P,SAAtB+P,EAAWmpD,OAAuB,CAElE,GAAIA,GAASnpD,EAAWmpD,MAExB,IAAK5sD,MAAMC,QAAS2sD,GAEnB,IAAM,GAAIhqD,GAAI,EAAGC,EAAI+pD,EAAO55D,OAAQ4P,EAAIC,EAAGD,IAAO,CAEjD,GAAImqD,GAAQH,EAAQhqD,EAEpB+8F,GAAW7b,EAAKl3B,OAAQG,OAMzB4yC,GAAW7b,EAAKl3B,OAAQA,IAQ3B,GAAuBl5D,SAAlBd,KAAKsY,SAET,GAAKlL,MAAMC,QAASrN,KAAKsY,UAAa,CAIrC,IAAM,GAFF+0F,MAEMr9F,EAAI,EAAGC,EAAIjQ,KAAKsY,SAASlY,OAAQ4P,EAAIC,EAAGD,IAEjDq9F,EAAMj7F,KAAM26F,EAAW7b,EAAKlV,UAAWh8E,KAAKsY,SAAUtI,IAIvDwQ,GAAOlI,SAAW+0F,MAIlB7sF,GAAOlI,SAAWy0F,EAAW7b,EAAKlV,UAAWh8E,KAAKsY,SAQpD,IAAKtY,KAAK0K,SAAStK,OAAS,EAAI,CAE/BogB,EAAO9V,WAEP,KAAM,GAAIsF,GAAI,EAAGA,EAAIhQ,KAAK0K,SAAStK,OAAQ4P,IAE1CwQ,EAAO9V,SAAS0H,KAAMpS,KAAK0K,SAAUsF,GAAIsvD,OAAQ4xB,GAAO1wE,QAM1D,GAAK2wE,EAAe,CAEnB,GAAIhxE,GAAa+sF,EAAkBhc,EAAK/wE,YACpC67D,EAAYkxB,EAAkBhc,EAAKlV,WACnC75D,EAAW+qF,EAAkBhc,EAAK/uE,UAClCqB,EAAS0pF,EAAkBhc,EAAK1tE,QAChCw2C,EAASkzC,EAAkBhc,EAAKl3B,OAE/B75C,GAAW/f,OAAS,IAAIq+E,EAAOt+D,WAAaA,GAC5C67D,EAAU57E,OAAS,IAAIq+E,EAAOzC,UAAYA,GAC1C75D,EAAS/hB,OAAS,IAAIq+E,EAAOt8D,SAAWA,GACxCqB,EAAOpjB,OAAS,IAAIq+E,EAAOj7D,OAASA,GACpCw2C,EAAO55D,OAAS,IAAIq+E,EAAOzkB,OAASA,GAM1C,MAFAykB,GAAOj+D,OAASA,EAETi+D,GAqBR5zE,MAAO,SAAW0sE,GAEjB,OAAO,GAAIv3E,MAAKuqE,aAAc3rD,KAAM5e,KAAMu3E,IAI3C34D,KAAM,SAAW8/D,EAAQnH,GA6BxB,GA3BmBz2E,SAAdy2E,IAA0BA,GAAY,GAE3Cv3E,KAAKmC,KAAOu8E,EAAOv8E,KAEnBnC,KAAK2K,GAAGiU,KAAM8/D,EAAO/zE,IAErB3K,KAAK8K,SAAS8T,KAAM8/D,EAAO5zE,UAC3B9K,KAAKoK,WAAWwU,KAAM8/D,EAAOt0E,YAC7BpK,KAAK+K,MAAM6T,KAAM8/D,EAAO3zE,OAExB/K,KAAKiD,OAAO2b,KAAM8/D,EAAOz7E,QACzBjD,KAAKqL,YAAYuT,KAAM8/D,EAAOrzE,aAE9BrL,KAAKgD,iBAAmB07E,EAAO17E,iBAC/BhD,KAAKuL,uBAAyBmzE,EAAOnzE,uBAErCvL,KAAKwL,OAAOvB,KAAOy0E,EAAOlzE,OAAOvB,KACjCjK,KAAKyL,QAAUizE,EAAOjzE,QAEtBzL,KAAK0L,WAAagzE,EAAOhzE,WACzB1L,KAAK2L,cAAgB+yE,EAAO/yE,cAE5B3L,KAAK4L,cAAgB8yE,EAAO9yE,cAC5B5L,KAAK6L,YAAc6yE,EAAO7yE,YAE1B7L,KAAK8L,SAAWqhG,KAAKvgC,MAAOugC,KAAKC,UAAW1uB,EAAO5yE,WAE9CyrE,KAAc,EAElB,IAAM,GAAIvnE,GAAI,EAAGA,EAAI0uE,EAAOh0E,SAAStK,OAAQ4P,IAAO,CAEnD,GAAIu8F,GAAQ7tB,EAAOh0E,SAAUsF,EAC7BhQ,MAAKq/B,IAAKktE,EAAM1hG,SAMlB,MAAO7K,SAyBT+L,EAAO0nE,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQ/mF,EAASupE,YAEzDlJ,YAAax+D,EAEb8+C,UAAU,EAEVjsC,KAAM,SAAW8/D,EAAQnH,GASxB,MAPArtE,GAASupE,UAAU70D,KAAKta,KAAMtE,KAAM0+E,EAAQnH,GAE5Cv3E,KAAKgM,mBAAmB4S,KAAM8/D,EAAO1yE,oBAErChM,KAAKiM,iBAAiB2S,KAAM8/D,EAAOzyE,kBACnCjM,KAAKkM,wBAAwB0S,KAAM8/D,EAAOxyE,yBAEnClM,MAIR2sG,kBAAmB,SAAW1sF,GAEbnf,SAAXmf,IAEJ5f,QAAQ4H,KAAM,6DACdgY,EAAS,GAAIlf,IAIdf,KAAKi/B,mBAAmB,EAExB,IAAIovB,GAAIruD,KAAKqL,YAAYnL,QAEzB,OAAO+f,GAAOha,KAAOooD,EAAG,IAAOA,EAAG,IAAOA,EAAG,KAAO10B,aAIpDsF,kBAAmB,SAAW6tE,GAE7B5iG,EAASupE,UAAUx0C,kBAAkB36B,KAAMtE,KAAM8sG,GAEjD9sG,KAAKgM,mBAAmBuuC,WAAYv6C,KAAKqL,cAI1CR,MAAO,WAEN,OAAO,GAAI7K,MAAKuqE,aAAc3rD,KAAM5e,SAgCtCmM,EAAmBsnE,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQllF,EAAO0nE,YAEnElJ,YAAap+D,EAEbmhG,sBAAsB,EAEtB1uF,KAAM,SAAW8/D,EAAQnH,GAcxB,MAZAxrE,GAAO0nE,UAAU70D,KAAKta,KAAMtE,KAAM0+E,EAAQnH,GAE1Cv3E,KAAKoM,KAAOsyE,EAAOtyE,KACnBpM,KAAKqM,MAAQqyE,EAAOryE,MACpBrM,KAAKsM,IAAMoyE,EAAOpyE,IAClBtM,KAAKuM,OAASmyE,EAAOnyE,OACrBvM,KAAKwM,KAAOkyE,EAAOlyE,KACnBxM,KAAKyM,IAAMiyE,EAAOjyE,IAElBzM,KAAK0M,KAAOgyE,EAAOhyE,KACnB1M,KAAK2M,KAAuB,OAAhB+xE,EAAO/xE,KAAgB,KAAO/K,OAAO48E,UAAYE,EAAO/xE,MAE7D3M,MAIRutG,cAAe,SAAWC,EAAWC,EAAY3tG,EAAGC,EAAG4D,EAAOC,GAE1C,OAAd5D,KAAK2M,OAET3M,KAAK2M,MACJwS,SAAS,EACTquF,UAAW,EACXC,WAAY,EACZp/B,QAAS,EACTC,QAAS,EACT3qE,MAAO,EACPC,OAAQ,IAKV5D,KAAK2M,KAAKwS,SAAU,EACpBnf,KAAK2M,KAAK6gG,UAAYA,EACtBxtG,KAAK2M,KAAK8gG,WAAaA,EACvBztG,KAAK2M,KAAK0hE,QAAUvuE,EACpBE,KAAK2M,KAAK2hE,QAAUvuE,EACpBC,KAAK2M,KAAKhJ,MAAQA,EAClB3D,KAAK2M,KAAK/I,OAASA,EAEnB5D,KAAK4M,0BAIN8gG,gBAAiB,WAEG,OAAd1tG,KAAK2M,OAET3M,KAAK2M,KAAKwS,SAAU,GAIrBnf,KAAK4M,0BAINA,uBAAwB,WAEvB,GAAIy2E,IAAOrjF,KAAKqM,MAAQrM,KAAKoM,OAAW,EAAIpM,KAAK0M,MAC7C42E,GAAOtjF,KAAKsM,IAAMtM,KAAKuM,SAAa,EAAIvM,KAAK0M,MAC7C8nD,GAAOx0D,KAAKqM,MAAQrM,KAAKoM,MAAS,EAClCqoD,GAAOz0D,KAAKsM,IAAMtM,KAAKuM,QAAW,EAElCH,EAAOooD,EAAK6uB,EACZh3E,EAAQmoD,EAAK6uB,EACb/2E,EAAMmoD,EAAK6uB,EACX/2E,EAASkoD,EAAK6uB,CAElB,IAAmB,OAAdtjF,KAAK2M,MAAiB3M,KAAK2M,KAAKwS,QAAU,CAE9C,GAAIwuF,GAAQ3tG,KAAK0M,MAAS1M,KAAK2M,KAAKhJ,MAAQ3D,KAAK2M,KAAK6gG,WAClDI,EAAQ5tG,KAAK0M,MAAS1M,KAAK2M,KAAK/I,OAAS5D,KAAK2M,KAAK8gG,YACnDI,GAAW7tG,KAAKqM,MAAQrM,KAAKoM,MAASpM,KAAK2M,KAAKhJ,MAChDmqG,GAAW9tG,KAAKsM,IAAMtM,KAAKuM,QAAWvM,KAAK2M,KAAK/I,MAEpDwI,IAAQyhG,GAAW7tG,KAAK2M,KAAK0hE,QAAUs/B,GACvCthG,EAAQD,EAAOyhG,GAAW7tG,KAAK2M,KAAKhJ,MAAQgqG,GAC5CrhG,GAAOwhG,GAAW9tG,KAAK2M,KAAK2hE,QAAUs/B,GACtCrhG,EAASD,EAAMwhG,GAAW9tG,KAAK2M,KAAK/I,OAASgqG,GAI9C5tG,KAAKiM,iBAAiBs/E,iBAAkBn/E,EAAMC,EAAOC,EAAKC,EAAQvM,KAAKwM,KAAMxM,KAAKyM,KAElFzM,KAAKkM,wBAAwBquC,WAAYv6C,KAAKiM,mBAI/CqzD,OAAQ,SAAW4xB,GAElB,GAAIxsF,GAAOwF,EAASupE,UAAUnU,OAAOh7D,KAAMtE,KAAMkxF,EAYjD,OAVAxsF,GAAK8b,OAAO9T,KAAO1M,KAAK0M,KACxBhI,EAAK8b,OAAOpU,KAAOpM,KAAKoM,KACxB1H,EAAK8b,OAAOnU,MAAQrM,KAAKqM,MACzB3H,EAAK8b,OAAOlU,IAAMtM,KAAKsM,IACvB5H,EAAK8b,OAAOjU,OAASvM,KAAKuM,OAC1B7H,EAAK8b,OAAOhU,KAAOxM,KAAKwM,KACxB9H,EAAK8b,OAAO/T,IAAMzM,KAAKyM,IAEJ,OAAdzM,KAAK2M,OAAgBjI,EAAK8b,OAAO7T,KAAO/K,OAAO48E,UAAYx+E,KAAK2M,OAE9DjI,KA2BT9C,OAAO48E,OAAQ3xE,EAAM4mE,WAEpB5oE,MAAO,WAEN,OAAO,GAAI7K,MAAKuqE,aAAc3rD,KAAM5e,OAIrC4e,KAAM,SAAW8/D,GAEhB1+E,KAAK8M,EAAI4xE,EAAO5xE,EAChB9M,KAAKgG,EAAI04E,EAAO14E,EAChBhG,KAAK+M,EAAI2xE,EAAO3xE,EAEhB/M,KAAKmF,OAAOyZ,KAAM8/D,EAAOv5E,QACzBnF,KAAKgN,MAAM4R,KAAM8/D,EAAO1xE,OAExBhN,KAAKiN,cAAgByxE,EAAOzxE,aAE5B,KAAM,GAAI+C,GAAI,EAAGyuB,EAAKigD,EAAOvxE,cAAc/M,OAAQ4P,EAAIyuB,EAAIzuB,IAE1DhQ,KAAKmN,cAAe6C,GAAM0uE,EAAOvxE,cAAe6C,GAAInF,OAIrD,KAAM,GAAImF,GAAI,EAAGyuB,EAAKigD,EAAOnxE,aAAanN,OAAQ4P,EAAIyuB,EAAIzuB,IAEzDhQ,KAAKuN,aAAcyC,GAAM0uE,EAAOnxE,aAAcyC,GAAInF,OAInD,OAAO7K,QAeT,IAAIyN,IAAa,CAuCjBD,GAASimE,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQrxF,EAAgB6zE,YAElElJ,YAAa/8D,EAEbmT,YAAY,EAEZ0qF,YAAa,SAAWpoG,GAIvB,IAAM,GAFFmI,IAAe,GAAIpK,IAAUyd,gBAAiBxb,GAExC+M,EAAI,EAAGyuB,EAAKz+B,KAAK0N,SAAStN,OAAQ4P,EAAIyuB,EAAIzuB,IAAO,CAE1D,GAAIw+C,GAASxuD,KAAK0N,SAAUsC,EAC5Bw+C,GAAO3vC,aAAc5b,GAItB,IAAM,GAAI+M,GAAI,EAAGyuB,EAAKz+B,KAAK4N,MAAMxN,OAAQ4P,EAAIyuB,EAAIzuB,IAAO,CAEvD,GAAIovB,GAAOp/B,KAAK4N,MAAOoC,EACvBovB,GAAKj6B,OAAOs9E,aAAcr3E,GAAeuuB,WAEzC,KAAM,GAAI8T,GAAI,EAAGC,EAAKtO,EAAKjyB,cAAc/M,OAAQqtC,EAAIC,EAAID,IAExDrO,EAAKjyB,cAAesgC,GAAIg1C,aAAcr3E,GAAeuuB,YAqBvD,MAf0B,QAArB35B,KAAKmO,aAETnO,KAAK+tG,qBAIuB,OAAxB/tG,KAAKoO,gBAETpO,KAAKi7E,wBAINj7E,KAAKsO,oBAAqB,EAC1BtO,KAAKwO,mBAAoB,EAElBxO,MAIR4rG,QAAS,WAIR,GAAItW,GAAK,GAAIr1F,EAEb,OAAO,UAAkB44B,GAMxB,MAJAy8D,GAAG1L,cAAe/wD,GAElB74B,KAAKqrG,YAAa/V,GAEXt1F,SAMTu5E,QAAS,WAIR,GAAI+b,GAAK,GAAIr1F,EAEb,OAAO,UAAkB44B,GAMxB,MAJAy8D,GAAGzL,cAAehxD,GAElB74B,KAAKqrG,YAAa/V,GAEXt1F,SAMT6rG,QAAS,WAIR,GAAIvW,GAAK,GAAIr1F,EAEb,OAAO,UAAkB44B,GAMxB,MAJAy8D,GAAGxL,cAAejxD,GAElB74B,KAAKqrG,YAAa/V,GAEXt1F,SAMT07E,UAAW,WAIV,GAAI4Z,GAAK,GAAIr1F,EAEb,OAAO,UAAoBH,EAAGC,EAAGS,GAMhC,MAJA80F,GAAGv2D,gBAAiBj/B,EAAGC,EAAGS,GAE1BR,KAAKqrG,YAAa/V,GAEXt1F,SAMT+K,MAAO,WAIN,GAAIuqF,GAAK,GAAIr1F,EAEb,OAAO,UAAgBH,EAAGC,EAAGS,GAM5B,MAJA80F,GAAGnL,UAAWrqF,EAAGC,EAAGS,GAEpBR,KAAKqrG,YAAa/V,GAEXt1F,SAMTg/B,OAAQ,WAEP,GAAIgvE,GAAM,GAAI9jG,EAEd,OAAO,UAAiBiI,GAEvB67F,EAAIhvE,OAAQ7sB,GAEZ67F,EAAIxoD,eAEJxlD,KAAKqrG,YAAa2C,EAAI/qG,YAMxB6N,mBAAoB,SAAWuH,GAiD9B,QAAS41F,GAASnhG,EAAG9G,EAAG+G,EAAGE,GAE1B,GAAIE,GAA4BrM,SAAZ6O,GAA0Bu+F,EAAaphG,GAAIjC,QAASqjG,EAAaloG,GAAI6E,QAASqjG,EAAanhG,GAAIlC,YAC/G0C,EAA0BzM,SAAX6M,GAAyB6E,EAAM7E,OAAQb,GAAIjC,QAAS2H,EAAM7E,OAAQ3H,GAAI6E,QAAS2H,EAAM7E,OAAQZ,GAAIlC,YAEhHu0B,EAAO,GAAIvyB,GAAOC,EAAG9G,EAAG+G,EAAGI,EAAeI,EAAcN,EAE5DuF,GAAM5E,MAAMwE,KAAMgtB,GAELt+B,SAAR8O,GAEJ4C,EAAM3E,cAAe,GAAIuE,MAAQ+7F,EAASrhG,GAAIjC,QAASsjG,EAASnoG,GAAI6E,QAASsjG,EAASphG,GAAIlC,UAI7E/J,SAAT+O,GAEJ2C,EAAM3E,cAAe,GAAIuE,MAAQg8F,EAAUthG,GAAIjC,QAASujG,EAAUpoG,GAAI6E,QAASujG,EAAUrhG,GAAIlC,UAhE/F,GAAI2H,GAAQxS,KAERuS,EAA6B,OAAnB8F,EAASjI,MAAiBiI,EAASjI,MAAM/I,MAAQvG,OAC3DuP,EAAagI,EAAShI,WAEtBkoE,EAAYloE,EAAWvF,SAASzD,MAChCsI,EAAgC7O,SAAtBuP,EAAWlL,OAAuBkL,EAAWlL,OAAOkC,MAAQvG,OACtE6M,EAA8B7M,SAArBuP,EAAWrD,MAAsBqD,EAAWrD,MAAM3F,MAAQvG,OACnE8O,EAAwB9O,SAAlBuP,EAAWuH,GAAmBvH,EAAWuH,GAAGvQ,MAAQvG,OAC1D+O,EAA0B/O,SAAnBuP,EAAWwH,IAAoBxH,EAAWwH,IAAIxQ,MAAQvG,MAEnDA,UAAT+O,IAAqB7P,KAAK6N,cAAe,MAM9C,KAAM,GAJFqgG,MACAC,KACAC,KAEMp+F,EAAI,EAAGy9B,EAAI,EAAGz9B,EAAIuoE,EAAUn4E,OAAQ4P,GAAK,EAAGy9B,GAAK,EAE1Dj7B,EAAM9E,SAAS0E,KAAM,GAAIrR,GAASw3E,EAAWvoE,GAAKuoE,EAAWvoE,EAAI,GAAKuoE,EAAWvoE,EAAI,KAEpElP,SAAZ6O,GAEJu+F,EAAY97F,KAAM,GAAIrR,GAAS4O,EAASK,GAAKL,EAASK,EAAI,GAAKL,EAASK,EAAI,KAI7DlP,SAAX6M,GAEJ6E,EAAM7E,OAAOyE,KAAM,GAAIvM,GAAO8H,EAAQqC,GAAKrC,EAAQqC,EAAI,GAAKrC,EAAQqC,EAAI,KAI5DlP,SAAR8O,GAEJu+F,EAAQ/7F,KAAM,GAAIvS,GAAS+P,EAAK69B,GAAK79B,EAAK69B,EAAI,KAIjC3sC,SAAT+O,GAEJu+F,EAASh8F,KAAM,GAAIvS,GAASgQ,EAAM49B,GAAK59B,EAAM49B,EAAI,IA6BnD,IAAI39B,GAASuI,EAASvI,MAEtB,IAAKA,EAAO1P,OAAS,EAEpB,IAAM,GAAI4P,GAAI,EAAGA,EAAIF,EAAO1P,OAAQ4P,IAOnC,IAAM,GALFimB,GAAQnmB,EAAQE,GAEhBrJ,EAAQsvB,EAAMtvB,MACduC,EAAQ+sB,EAAM/sB,MAERukC,EAAI9mC,EAAO+mC,EAAK/mC,EAAQuC,EAAOukC,EAAIC,EAAID,GAAK,EAEpC3sC,SAAZyR,EAEJ07F,EAAS17F,EAASk7B,GAAKl7B,EAASk7B,EAAI,GAAKl7B,EAASk7B,EAAI,GAAKxX,EAAMhpB,eAIjEghG,EAASxgE,EAAGA,EAAI,EAAGA,EAAI,EAAGxX,EAAMhpB,mBAUnC,IAAiBnM,SAAZyR,EAEJ,IAAM,GAAIvC,GAAI,EAAGA,EAAIuC,EAAQnS,OAAQ4P,GAAK,EAEzCi+F,EAAS17F,EAASvC,GAAKuC,EAASvC,EAAI,GAAKuC,EAASvC,EAAI,QAMvD,KAAM,GAAIA,GAAI,EAAGA,EAAIuoE,EAAUn4E,OAAS,EAAG4P,GAAK,EAE/Ci+F,EAASj+F,EAAGA,EAAI,EAAGA,EAAI,EAsB1B,OAdAhQ,MAAKoiE,qBAEyB,OAAzB/pD,EAASlK,cAEbnO,KAAKmO,YAAckK,EAASlK,YAAYtD,SAIR,OAA5BwN,EAASjK,iBAEbpO,KAAKoO,eAAiBiK,EAASjK,eAAevD,SAIxC7K,MAIR8C,OAAQ,WAEP,GAAIF,GAAS,GAAI7B,EAEjB,OAAO,YAQN,MANAf,MAAK+tG,qBAEL/tG,KAAKmO,YAAYskF,UAAW7vF,GAAS2jD,SAErCvmD,KAAK07E,UAAW94E,EAAO9C,EAAG8C,EAAO7C,EAAG6C,EAAOpC,GAEpCR,SAMT25B,UAAW,WAEV35B,KAAKi7E,uBAEL,IAAIn4E,GAAS9C,KAAKoO,eAAetL,OAC7BmC,EAASjF,KAAKoO,eAAenJ,OAE7B83D,EAAe,IAAX93D,EAAe,EAAI,EAAMA,EAE7BhC,EAAS,GAAIhD,EAUjB,OATAgD,GAAOgD,IACN82D,EAAG,EAAG,GAAKA,EAAIj6D,EAAOhD,EACtB,EAAGi9D,EAAG,GAAKA,EAAIj6D,EAAO/C,EACtB,EAAG,EAAGg9D,GAAKA,EAAIj6D,EAAOtC,EACtB,EAAG,EAAG,EAAG,GAGVR,KAAKqrG,YAAapoG,GAEXjD,MAIRoiE,mBAAoB,WAInB,IAAM,GAFFisC,GAAK,GAAIttG,GAAWutG,EAAK,GAAIvtG,GAEvBsqC,EAAI,EAAGkjE,EAAKvuG,KAAK4N,MAAMxN,OAAQirC,EAAIkjE,EAAIljE,IAAO,CAEvD,GAAIjM,GAAOp/B,KAAK4N,MAAOy9B,GAEnBmjE,EAAKxuG,KAAK0N,SAAU0xB,EAAKtyB,GACzB2hG,EAAKzuG,KAAK0N,SAAU0xB,EAAKp5B,GACzB0oG,EAAK1uG,KAAK0N,SAAU0xB,EAAKryB,EAE7BshG,GAAG5+C,WAAYi/C,EAAID,GACnBH,EAAG7+C,WAAY++C,EAAIC,GACnBJ,EAAGrrB,MAAOsrB,GAEVD,EAAG10E,YAEHyF,EAAKj6B,OAAOyZ,KAAMyvF,KAMpBz8C,qBAAsB,SAAW+8C,GAEV7tG,SAAjB6tG,IAA6BA,GAAe,EAEjD,IAAIx9F,GAAGy9F,EAAIvjE,EAAGkjE,EAAInvE,EAAM1xB,CAIxB,KAFAA,EAAW,GAAIN,OAAOpN,KAAK0N,SAAStN,QAE9B+Q,EAAI,EAAGy9F,EAAK5uG,KAAK0N,SAAStN,OAAQ+Q,EAAIy9F,EAAIz9F,IAE/CzD,EAAUyD,GAAM,GAAIpQ,EAIrB,IAAK4tG,EAAe,CAKnB,GAAIH,GAAIC,EAAIC,EACRL,EAAK,GAAIttG,GAAWutG,EAAK,GAAIvtG,EAEjC,KAAMsqC,EAAI,EAAGkjE,EAAKvuG,KAAK4N,MAAMxN,OAAQirC,EAAIkjE,EAAIljE,IAE5CjM,EAAOp/B,KAAK4N,MAAOy9B,GAEnBmjE,EAAKxuG,KAAK0N,SAAU0xB,EAAKtyB,GACzB2hG,EAAKzuG,KAAK0N,SAAU0xB,EAAKp5B,GACzB0oG,EAAK1uG,KAAK0N,SAAU0xB,EAAKryB,GAEzBshG,EAAG5+C,WAAYi/C,EAAID,GACnBH,EAAG7+C,WAAY++C,EAAIC,GACnBJ,EAAGrrB,MAAOsrB,GAEV5gG,EAAU0xB,EAAKtyB,GAAIuyB,IAAKgvE,GACxB3gG,EAAU0xB,EAAKp5B,GAAIq5B,IAAKgvE,GACxB3gG,EAAU0xB,EAAKryB,GAAIsyB,IAAKgvE,OAQzB,KAFAruG,KAAKoiE,qBAEC/2B,EAAI,EAAGkjE,EAAKvuG,KAAK4N,MAAMxN,OAAQirC,EAAIkjE,EAAIljE,IAE5CjM,EAAOp/B,KAAK4N,MAAOy9B;AAEnB39B,EAAU0xB,EAAKtyB,GAAIuyB,IAAKD,EAAKj6B,QAC7BuI,EAAU0xB,EAAKp5B,GAAIq5B,IAAKD,EAAKj6B,QAC7BuI,EAAU0xB,EAAKryB,GAAIsyB,IAAKD,EAAKj6B,OAM/B,KAAMgM,EAAI,EAAGy9F,EAAK5uG,KAAK0N,SAAStN,OAAQ+Q,EAAIy9F,EAAIz9F,IAE/CzD,EAAUyD,GAAIwoB,WAIf,KAAM0R,EAAI,EAAGkjE,EAAKvuG,KAAK4N,MAAMxN,OAAQirC,EAAIkjE,EAAIljE,IAAO,CAEnDjM,EAAOp/B,KAAK4N,MAAOy9B,EAEnB,IAAIl+B,GAAgBiyB,EAAKjyB,aAEK,KAAzBA,EAAc/M,QAElB+M,EAAe,GAAIyR,KAAMlR,EAAU0xB,EAAKtyB,IACxCK,EAAe,GAAIyR,KAAMlR,EAAU0xB,EAAKp5B,IACxCmH,EAAe,GAAIyR,KAAMlR,EAAU0xB,EAAKryB,MAIxCI,EAAe,GAAMO,EAAU0xB,EAAKtyB,GAAIjC,QACxCsC,EAAe,GAAMO,EAAU0xB,EAAKp5B,GAAI6E,QACxCsC,EAAe,GAAMO,EAAU0xB,EAAKryB,GAAIlC,SAMrC7K,KAAK4N,MAAMxN,OAAS,IAExBJ,KAAKwO,mBAAoB,IAM3BqgG,yBAA0B,WAEzB,GAAIxjE,GAAGkjE,EAAInvE,CAIX,KAFAp/B,KAAKoiE,qBAEC/2B,EAAI,EAAGkjE,EAAKvuG,KAAK4N,MAAMxN,OAAQirC,EAAIkjE,EAAIljE,IAAO,CAEnDjM,EAAOp/B,KAAK4N,MAAOy9B,EAEnB,IAAIl+B,GAAgBiyB,EAAKjyB,aAEK,KAAzBA,EAAc/M,QAElB+M,EAAe,GAAIyR,KAAMwgB,EAAKj6B,QAC9BgI,EAAe,GAAIyR,KAAMwgB,EAAKj6B,QAC9BgI,EAAe,GAAIyR,KAAMwgB,EAAKj6B,UAI9BgI,EAAe,GAAMiyB,EAAKj6B,OAAO0F,QACjCsC,EAAe,GAAMiyB,EAAKj6B,OAAO0F,QACjCsC,EAAe,GAAMiyB,EAAKj6B,OAAO0F,SAM9B7K,KAAK4N,MAAMxN,OAAS,IAExBJ,KAAKwO,mBAAoB,IAM3BsgG,oBAAqB,WAEpB,GAAI9+F,GAAGyuB,EAAI4M,EAAGkjE,EAAInvE,CAMlB,KAAMiM,EAAI,EAAGkjE,EAAKvuG,KAAK4N,MAAMxN,OAAQirC,EAAIkjE,EAAIljE,IAgB5C,IAdAjM,EAAOp/B,KAAK4N,MAAOy9B,GAEZjM,EAAK2vE,qBAMX3vE,EAAK2vE,qBAAqBnwF,KAAMwgB,EAAKj6B,QAJrCi6B,EAAK2vE,qBAAuB3vE,EAAKj6B,OAAO0F,QAQlCu0B,EAAK4vE,0BAA0B5vE,EAAK4vE,4BAErCh/F,EAAI,EAAGyuB,EAAKW,EAAKjyB,cAAc/M,OAAQ4P,EAAIyuB,EAAIzuB,IAE7CovB,EAAK4vE,wBAAyBh/F,GAMpCovB,EAAK4vE,wBAAyBh/F,GAAI4O,KAAMwgB,EAAKjyB,cAAe6C,IAJ5DovB,EAAK4vE,wBAAyBh/F,GAAMovB,EAAKjyB,cAAe6C,GAAInF,OAc/D,IAAIokG,GAAS,GAAIzhG,EAGjB,KAFAyhG,EAAOrhG,MAAQ5N,KAAK4N,MAEdoC,EAAI,EAAGyuB,EAAKz+B,KAAK8N,aAAa1N,OAAQ4P,EAAIyuB,EAAIzuB,IAAO,CAI1D,IAAOhQ,KAAK+N,aAAciC,GAAM,CAE/BhQ,KAAK+N,aAAciC,MACnBhQ,KAAK+N,aAAciC,GAAIk/F,eACvBlvG,KAAK+N,aAAciC,GAAI7C,gBAEvB,IAGIgiG,GAAYhiG,EAHZiiG,EAAiBpvG,KAAK+N,aAAciC,GAAIk/F,YACxCG,EAAmBrvG,KAAK+N,aAAciC,GAAI7C,aAI9C,KAAMk+B,EAAI,EAAGkjE,EAAKvuG,KAAK4N,MAAMxN,OAAQirC,EAAIkjE,EAAIljE,IAE5C8jE,EAAa,GAAIpuG,GACjBoM,GAAkBL,EAAG,GAAI/L,GAAWiF,EAAG,GAAIjF,GAAWgM,EAAG,GAAIhM,IAE7DquG,EAAeh9F,KAAM+8F,GACrBE,EAAiBj9F,KAAMjF,GAMzB,GAAIY,GAAe/N,KAAK+N,aAAciC,EAItCi/F,GAAOvhG,SAAW1N,KAAK8N,aAAckC,GAAItC,SAIzCuhG,EAAO7sC,qBACP6sC,EAAOr9C,sBAIP,IAAIu9C,GAAYhiG,CAEhB,KAAMk+B,EAAI,EAAGkjE,EAAKvuG,KAAK4N,MAAMxN,OAAQirC,EAAIkjE,EAAIljE,IAE5CjM,EAAOp/B,KAAK4N,MAAOy9B,GAEnB8jE,EAAaphG,EAAamhG,YAAa7jE,GACvCl+B,EAAgBY,EAAaZ,cAAek+B,GAE5C8jE,EAAWvwF,KAAMwgB,EAAKj6B,QAEtBgI,EAAcL,EAAE8R,KAAMwgB,EAAKjyB,cAAe,IAC1CA,EAAcnH,EAAE4Y,KAAMwgB,EAAKjyB,cAAe,IAC1CA,EAAcJ,EAAE6R,KAAMwgB,EAAKjyB,cAAe,IAQ5C,IAAMk+B,EAAI,EAAGkjE,EAAKvuG,KAAK4N,MAAMxN,OAAQirC,EAAIkjE,EAAIljE,IAE5CjM,EAAOp/B,KAAK4N,MAAOy9B,GAEnBjM,EAAKj6B,OAASi6B,EAAK2vE,qBACnB3vE,EAAKjyB,cAAgBiyB,EAAK4vE,yBAM5BjB,mBAAoB,WAEO,OAArB/tG,KAAKmO,cAETnO,KAAKmO,YAAc,GAAIvJ,IAIxB5E,KAAKmO,YAAYi7D,cAAeppE,KAAK0N,WAItCutE,sBAAuB,WAEO,OAAxBj7E,KAAKoO,iBAETpO,KAAKoO,eAAiB,GAAIpJ,IAI3BhF,KAAKoO,eAAeg7D,cAAeppE,KAAK0N,WAIzCqwF,MAAO,SAAW1lF,EAAUpV,EAAQqsG,GAEnC,IAASj3F,IAAYA,EAASsI,WAG7B,WADAtgB,SAAQC,MAAO,sEAAuE+X,EAKvF,IAAIjN,GACHmkG,EAAevvG,KAAK0N,SAAStN,OAC7BovG,EAAYxvG,KAAK0N,SACjB+hG,EAAYp3F,EAAS3K,SACrBgiG,EAAS1vG,KAAK4N,MACd+hG,EAASt3F,EAASzK,MAClBgiG,EAAO5vG,KAAK6N,cAAe,GAC3BgC,EAAOwI,EAASxK,cAAe,GAC/BgiG,EAAU7vG,KAAK2N,OACfmiG,EAAUz3F,EAAS1K,MAES7M,UAAxBwuG,IAAoCA,EAAsB,GAE/CxuG,SAAXmC,IAEJmI,GAAe,GAAIpK,IAAUyd,gBAAiBxb,GAM/C,KAAM,GAAI+M,GAAI,EAAGyuB,EAAKgxE,EAAUrvG,OAAQ4P,EAAIyuB,EAAIzuB,IAAO,CAEtD,GAAIw+C,GAASihD,EAAWz/F,GAEpB+/F,EAAavhD,EAAO3jD,OAER/J,UAAXmC,GAAuB8sG,EAAWlxF,aAAc5b,GAErDusG,EAAUp9F,KAAM29F,GAMjB,IAAM,GAAI//F,GAAI,EAAGyuB,EAAKqxE,EAAQ1vG,OAAQ4P,EAAIyuB,EAAIzuB,IAE7C6/F,EAAQz9F,KAAM09F,EAAS9/F,GAAInF,QAM5B,KAAMmF,EAAI,EAAGyuB,EAAKkxE,EAAOvvG,OAAQ4P,EAAIyuB,EAAIzuB,IAAO,CAE/C,GAAwBggG,GAAU7qG,EAAQ6H,EAAtCoyB,EAAOuwE,EAAQ3/F,GAClBigG,EAAoB7wE,EAAKjyB,cACzB+iG,EAAmB9wE,EAAK7xB,YAEzByiG,GAAW,GAAInjG,GAAOuyB,EAAKtyB,EAAIyiG,EAAcnwE,EAAKp5B,EAAIupG,EAAcnwE,EAAKryB,EAAIwiG,GAC7ES,EAAS7qG,OAAOyZ,KAAMwgB,EAAKj6B,QAELrE,SAAjBsK,GAEJ4kG,EAAS7qG,OAAOs9E,aAAcr3E,GAAeuuB,WAI9C,KAAM,GAAI8T,GAAI,EAAGC,EAAKuiE,EAAkB7vG,OAAQqtC,EAAIC,EAAID,IAEvDtoC,EAAS8qG,EAAmBxiE,GAAI5iC,QAEV/J,SAAjBsK,GAEJjG,EAAOs9E,aAAcr3E,GAAeuuB,YAIrCq2E,EAAS7iG,cAAciF,KAAMjN,EAI9B6qG,GAAShjG,MAAM4R,KAAMwgB,EAAKpyB,MAE1B,KAAM,GAAIygC,GAAI,EAAGC,EAAKwiE,EAAiB9vG,OAAQqtC,EAAIC,EAAID,IAEtDzgC,EAAQkjG,EAAkBziE,GAC1BuiE,EAASziG,aAAa6E,KAAMpF,EAAMnC,QAInCmlG,GAAS/iG,cAAgBmyB,EAAKnyB,cAAgBqiG,EAE9CI,EAAOt9F,KAAM49F,GAMd,IAAMhgG,EAAI,EAAGyuB,EAAK5uB,EAAKzP,OAAQ4P,EAAIyuB,EAAIzuB,IAAO,CAE7C,GAAI4H,GAAK/H,EAAMG,GAAKmgG,IAEpB,IAAYrvG,SAAP8W,EAAL,CAMA,IAAM,GAAI61B,GAAI,EAAGC,EAAK91B,EAAGxX,OAAQqtC,EAAIC,EAAID,IAExC0iE,EAAO/9F,KAAMwF,EAAI61B,GAAI5iC,QAItB+kG,GAAKx9F,KAAM+9F,MAMbC,UAAW,SAAWC,GAErB,MAASA,IAAQA,EAAK5zE,QAOjB4zE,EAAKrtG,kBAAmBqtG,EAAK7qD,mBAElCxlD,MAAK+9F,MAAOsS,EAAKh4F,SAAUg4F,EAAKptG,aAP/B5C,SAAQC,MAAO,kEAAmE+vG,IAiBpFr/F,cAAe,WAEd,GAGIG,GAAGwkB,EAGH3lB,EAAGyuB,EAAIW,EACP7sB,EAASk7B,EAAGC,EAPZ4iE,KACAC,KAAaC,KAGbC,EAAkB,EAClBt7F,EAAYxC,KAAKu9C,IAAK,GAAIugD,EAI9B,KAAMzgG,EAAI,EAAGyuB,EAAKz+B,KAAK0N,SAAStN,OAAQ4P,EAAIyuB,EAAIzuB,IAE/CmB,EAAInR,KAAK0N,SAAUsC,GACnB2lB,EAAMhjB,KAAKmwE,MAAO3xE,EAAErR,EAAIqV,GAAc,IAAMxC,KAAKmwE,MAAO3xE,EAAEpR,EAAIoV,GAAc,IAAMxC,KAAKmwE,MAAO3xE,EAAE3Q,EAAI2U,GAExErU,SAAvBwvG,EAAa36E,IAEjB26E,EAAa36E,GAAQ3lB,EACrBugG,EAAOn+F,KAAMpS,KAAK0N,SAAUsC,IAC5BwgG,EAASxgG,GAAMugG,EAAOnwG,OAAS,GAK/BowG,EAASxgG,GAAMwgG,EAASF,EAAa36E,GASvC,IAAI+6E,KAEJ,KAAM1gG,EAAI,EAAGyuB,EAAKz+B,KAAK4N,MAAMxN,OAAQ4P,EAAIyuB,EAAIzuB,IAAO,CAEnDovB,EAAOp/B,KAAK4N,MAAOoC,GAEnBovB,EAAKtyB,EAAI0jG,EAASpxE,EAAKtyB,GACvBsyB,EAAKp5B,EAAIwqG,EAASpxE,EAAKp5B,GACvBo5B,EAAKryB,EAAIyjG,EAASpxE,EAAKryB,GAEvBwF,GAAY6sB,EAAKtyB,EAAGsyB,EAAKp5B,EAAGo5B,EAAKryB,EAIjC,KAAM,GAAIiX,GAAI,EAAGA,EAAI,EAAGA,IAEvB,GAAKzR,EAASyR,KAAQzR,GAAWyR,EAAI,GAAM,GAAM,CAEhD0sF,EAAoBt+F,KAAMpC,EAC1B,QAQH,IAAMA,EAAI0gG,EAAoBtwG,OAAS,EAAG4P,GAAK,EAAGA,IAAO,CAExD,GAAI2gG,GAAMD,EAAqB1gG,EAI/B,KAFAhQ,KAAK4N,MAAMqxE,OAAQ0xB,EAAK,GAElBljE,EAAI,EAAGC,EAAK1tC,KAAK6N,cAAczN,OAAQqtC,EAAIC,EAAID,IAEpDztC,KAAK6N,cAAe4/B,GAAIwxC,OAAQ0xB,EAAK,GAQvC,GAAIC,GAAO5wG,KAAK0N,SAAStN,OAASmwG,EAAOnwG,MAEzC,OADAJ,MAAK0N,SAAW6iG,EACTK,GAIRxnC,cAAe,SAAWnnD,GAEzBjiB,KAAK0N,WAEL,KAAM,GAAIsC,GAAI,EAAGC,EAAIgS,EAAO7hB,OAAQ4P,EAAIC,EAAGD,IAAO,CAEjD,GAAIykB,GAAQxS,EAAQjS,EACpBhQ,MAAK0N,SAAS0E,KAAM,GAAIrR,GAAS0zB,EAAM30B,EAAG20B,EAAM10B,EAAG00B,EAAMj0B,GAAK,IAI/D,MAAOR,OAIR6wG,yBAA0B,WAezB,QAASC,GAAmBhkG,EAAG9G,GAE9B,MAAO8G,GAAEG,cAAgBjH,EAAEiH,cAV5B,IAAM,GALFW,GAAQ5N,KAAK4N,MACbxN,EAASwN,EAAMxN,OAIT4P,EAAI,EAAGA,EAAI5P,EAAQ4P,IAE5BpC,EAAOoC,GAAI+gG,IAAM/gG,CAYlBpC,GAAMmV,KAAM+tF,EAIZ,IAGIE,GAASC,EAHTrB,EAAO5vG,KAAK6N,cAAe,GAC3BgC,EAAO7P,KAAK6N,cAAe,EAI1B+hG,IAAQA,EAAKxvG,SAAWA,IAAS4wG,MACjCnhG,GAAQA,EAAKzP,SAAWA,IAAS6wG,KAEtC,KAAM,GAAIjhG,GAAI,EAAGA,EAAI5P,EAAQ4P,IAAO,CAEnC,GAAIoQ,GAAKxS,EAAOoC,GAAI+gG,GAEfC,IAAUA,EAAQ5+F,KAAMw9F,EAAMxvF,IAC9B6wF,GAAUA,EAAQ7+F,KAAMvC,EAAMuQ,IAI/B4wF,IAAUhxG,KAAK6N,cAAe,GAAMmjG,GACpCC,IAAUjxG,KAAK6N,cAAe,GAAMojG,IAI1C3xC,OAAQ,WA4HP,QAAS4xC,GAAQpvG,EAAOgJ,EAAUqU,GAEjC,MAAOA,GAAUrd,EAAU,GAAKgJ,EAAahJ,IAAc,GAAKgJ,GAIjE,QAASqmG,GAAgBhsG,GAExB,GAAIkxB,GAAOlxB,EAAOrF,EAAEm1B,WAAa9vB,EAAOpF,EAAEk1B,WAAa9vB,EAAO3E,EAAEy0B,UAEhE,OAA6Bn0B,UAAxBswG,EAAa/6E,GAEV+6E,EAAa/6E,IAIrB+6E,EAAa/6E,GAAS1mB,EAAQvP,OAAS,EACvCuP,EAAQyC,KAAMjN,EAAOrF,EAAGqF,EAAOpF,EAAGoF,EAAO3E,GAElC4wG,EAAa/6E,IAIrB,QAASg7E,GAAerkG,GAEvB,GAAIqpB,GAAOrpB,EAAMlH,EAAEmvB,WAAajoB,EAAMjH,EAAEkvB,WAAajoB,EAAMhH,EAAEivB,UAE7D,OAA4Bn0B,UAAvBwwG,EAAYj7E,GAETi7E,EAAYj7E,IAIpBi7E,EAAYj7E,GAAS1oB,EAAOvN,OAC5BuN,EAAOyE,KAAMpF,EAAMy7F,UAEZ6I,EAAYj7E,IAIpB,QAASk7E,GAAY35F,GAEpB,GAAIye,GAAOze,EAAG9X,EAAEm1B,WAAard,EAAG7X,EAAEk1B,UAElC,OAAyBn0B,UAApB0wG,EAASn7E,GAENm7E,EAASn7E,IAIjBm7E,EAASn7E,GAASzmB,EAAIxP,OAAS,EAC/BwP,EAAIwC,KAAMwF,EAAG9X,EAAG8X,EAAG7X,GAEZyxG,EAASn7E,IA/KjB,GAAI3xB,IACH0sF,UACC7tF,QAAS,IACT9B,KAAM,WACN4vF,UAAW,mBAUb,IAJA3sF,EAAK1C,KAAOhC,KAAKgC,KACjB0C,EAAKjD,KAAOzB,KAAKyB,KACE,KAAdzB,KAAKmC,OAAcuC,EAAKvC,KAAOnC,KAAKmC,MAEhBrB,SAApBd,KAAK6Q,WAA2B,CAEpC,GAAIA,GAAa7Q,KAAK6Q,UAEtB,KAAM,GAAI8kB,KAAO9kB,GAEW/P,SAAtB+P,EAAY8kB,KAAsBjxB,EAAMixB,GAAQ9kB,EAAY8kB,GAIlE,OAAOjxB,GAMR,IAAM,GAFFgJ,MAEMsC,EAAI,EAAGA,EAAIhQ,KAAK0N,SAAStN,OAAQ4P,IAAO,CAEjD,GAAIw+C,GAASxuD,KAAK0N,SAAUsC,EAC5BtC,GAAS0E,KAAMo8C,EAAO1uD,EAAG0uD,EAAOzuD,EAAGyuD,EAAOhuD,GAY3C,IAAM,GARFoN,MACA+B,KACAyhG,KACAzjG,KACA2jG,KACA1hG,KACA4hG,KAEMxhG,EAAI,EAAGA,EAAIhQ,KAAK4N,MAAMxN,OAAQ4P,IAAO,CAE9C,GAAIovB,GAAOp/B,KAAK4N,MAAOoC,GAEnByhG,GAAc,EACdC,GAAY,EACZC,EAAmD7wG,SAAjCd,KAAK6N,cAAe,GAAKmC,GAC3C4hG,EAAgBxyE,EAAKj6B,OAAO/E,SAAW,EACvCyxG,EAAsBzyE,EAAKjyB,cAAc/M,OAAS,EAClD0xG,EAAgC,IAAjB1yE,EAAKpyB,MAAMlH,GAA4B,IAAjBs5B,EAAKpyB,MAAMjH,GAA4B,IAAjBq5B,EAAKpyB,MAAMhH,EACtE+rG,EAAqB3yE,EAAK7xB,aAAanN,OAAS,EAEhD4xG,EAAW,CAef,IAbAA,EAAWd,EAAQc,EAAU,EAAG,GAChCA,EAAWd,EAAQc,EAAU,EAAGP,GAChCO,EAAWd,EAAQc,EAAU,EAAGN,GAChCM,EAAWd,EAAQc,EAAU,EAAGL,GAChCK,EAAWd,EAAQc,EAAU,EAAGJ,GAChCI,EAAWd,EAAQc,EAAU,EAAGH,GAChCG,EAAWd,EAAQc,EAAU,EAAGF,GAChCE,EAAWd,EAAQc,EAAU,EAAGD,GAEhCnkG,EAAMwE,KAAM4/F,GACZpkG,EAAMwE,KAAMgtB,EAAKtyB,EAAGsyB,EAAKp5B,EAAGo5B,EAAKryB,GACjCa,EAAMwE,KAAMgtB,EAAKnyB,eAEZ0kG,EAAkB,CAEtB,GAAI9jG,GAAgB7N,KAAK6N,cAAe,GAAKmC,EAE7CpC,GAAMwE,KACLm/F,EAAY1jG,EAAe,IAC3B0jG,EAAY1jG,EAAe,IAC3B0jG,EAAY1jG,EAAe,KAW7B,GANK+jG,GAEJhkG,EAAMwE,KAAM++F,EAAgB/xE,EAAKj6B,SAI7B0sG,EAAsB,CAE1B,GAAI1kG,GAAgBiyB,EAAKjyB,aAEzBS,GAAMwE,KACL++F,EAAgBhkG,EAAe,IAC/BgkG,EAAgBhkG,EAAe,IAC/BgkG,EAAgBhkG,EAAe,KAWjC,GANK2kG,GAEJlkG,EAAMwE,KAAMi/F,EAAejyE,EAAKpyB,QAI5B+kG,EAAqB,CAEzB,GAAIxkG,GAAe6xB,EAAK7xB,YAExBK,GAAMwE,KACLi/F,EAAe9jG,EAAc,IAC7B8jG,EAAe9jG,EAAc,IAC7B8jG,EAAe9jG,EAAc,MAwEhC,MARA7I,GAAKA,QAELA,EAAKA,KAAKgJ,SAAWA,EACrBhJ,EAAKA,KAAKiL,QAAUA,EACfhC,EAAOvN,OAAS,IAAIsE,EAAKA,KAAKiJ,OAASA,GACvCiC,EAAIxP,OAAS,IAAIsE,EAAKA,KAAKkL,KAAQA,IACxClL,EAAKA,KAAKkJ,MAAQA,EAEXlJ,GAIRmG,MAAO,WA0BN,OAAO,GAAI2C,IAAWoR,KAAM5e,OAI7B4e,KAAM,SAAW8/D,GAEhB,GAAI1uE,GAAGyuB,EAAIgP,EAAGC,EAAI3Q,EAAGC,CAIrBh9B,MAAK0N,YACL1N,KAAK2N,UACL3N,KAAK4N,SACL5N,KAAK6N,mBACL7N,KAAK8N,gBACL9N,KAAK+N,gBACL/N,KAAKgO,eACLhO,KAAKiO,eACLjO,KAAKkO,iBACLlO,KAAKmO,YAAc,KACnBnO,KAAKoO,eAAiB,KAItBpO,KAAKmC,KAAOu8E,EAAOv8E,IAInB,IAAIuL,GAAWgxE,EAAOhxE,QAEtB,KAAMsC,EAAI,EAAGyuB,EAAK/wB,EAAStN,OAAQ4P,EAAIyuB,EAAIzuB,IAE1ChQ,KAAK0N,SAAS0E,KAAM1E,EAAUsC,GAAInF,QAMnC,IAAI8C,GAAS+wE,EAAO/wE,MAEpB,KAAMqC,EAAI,EAAGyuB,EAAK9wB,EAAOvN,OAAQ4P,EAAIyuB,EAAIzuB,IAExChQ,KAAK2N,OAAOyE,KAAMzE,EAAQqC,GAAInF,QAM/B,IAAI+C,GAAQ8wE,EAAO9wE,KAEnB,KAAMoC,EAAI,EAAGyuB,EAAK7wB,EAAMxN,OAAQ4P,EAAIyuB,EAAIzuB,IAEvChQ,KAAK4N,MAAMwE,KAAMxE,EAAOoC,GAAInF,QAM7B,KAAMmF,EAAI,EAAGyuB,EAAKigD,EAAO7wE,cAAczN,OAAQ4P,EAAIyuB,EAAIzuB,IAAO,CAE7D,GAAInC,GAAgB6wE,EAAO7wE,cAAemC,EAQ1C,KANiClP,SAA5Bd,KAAK6N,cAAemC,KAExBhQ,KAAK6N,cAAemC,OAIfy9B,EAAI,EAAGC,EAAK7/B,EAAczN,OAAQqtC,EAAIC,EAAID,IAAO,CAEtD,GAAI79B,GAAM/B,EAAe4/B,GAAKwkE,IAE9B,KAAMl1E,EAAI,EAAGC,EAAKptB,EAAIxP,OAAQ28B,EAAIC,EAAID,IAAO,CAE5C,GAAInlB,GAAKhI,EAAKmtB,EAEdk1E,GAAQ7/F,KAAMwF,EAAG/M,SAIlB7K,KAAK6N,cAAemC,GAAIoC,KAAM6/F,IAQhC,GAAInkG,GAAe4wE,EAAO5wE,YAE1B,KAAMkC,EAAI,EAAGyuB,EAAK3wB,EAAa1N,OAAQ4P,EAAIyuB,EAAIzuB,IAAO,CAErD,GAAIkiG,KAKJ,IAJAA,EAAY/vG,KAAO2L,EAAckC,GAAI7N,KAIDrB,SAA/BgN,EAAckC,GAAItC,SAItB,IAFAwkG,EAAYxkG,YAEN+/B,EAAI,EAAGC,EAAK5/B,EAAckC,GAAItC,SAAStN,OAAQqtC,EAAIC,EAAID,IAE5DykE,EAAYxkG,SAAS0E,KAAMtE,EAAckC,GAAItC,SAAU+/B,GAAI5iC,QAQ7D,IAAmC/J,SAA9BgN,EAAckC,GAAIL,QAItB,IAFAuiG,EAAYviG,WAEN89B,EAAI,EAAGC,EAAK5/B,EAAckC,GAAIL,QAAQvP,OAAQqtC,EAAIC,EAAID,IAE3DykE,EAAYviG,QAAQyC,KAAMtE,EAAckC,GAAIL,QAAS89B,GAAI5iC,QAM3D7K,MAAK8N,aAAasE,KAAM8/F,GAMzB,GAAInkG,GAAe2wE,EAAO3wE,YAE1B,KAAMiC,EAAI,EAAGyuB,EAAK1wB,EAAa3N,OAAQ4P,EAAIyuB,EAAIzuB,IAAO,CAErD,GAAImiG,KAIJ,IAAyCrxG,SAApCiN,EAAciC,GAAI7C,cAItB,IAFAglG,EAAYhlG,iBAENsgC,EAAI,EAAGC,EAAK3/B,EAAciC,GAAI7C,cAAc/M,OAAQqtC,EAAIC,EAAID,IAAO,CAExE,GAAI2kE,GAAkBrkG,EAAciC,GAAI7C,cAAesgC,GACnD4kE,IAEJA,GAAiBvlG,EAAIslG,EAAgBtlG,EAAEjC,QACvCwnG,EAAiBrsG,EAAIosG,EAAgBpsG,EAAE6E,QACvCwnG,EAAiBtlG,EAAIqlG,EAAgBrlG,EAAElC,QAEvCsnG,EAAYhlG,cAAciF,KAAMigG,GAQlC,GAAuCvxG,SAAlCiN,EAAciC,GAAIk/F,YAItB,IAFAiD,EAAYjD,eAENzhE,EAAI,EAAGC,EAAK3/B,EAAciC,GAAIk/F,YAAY9uG,OAAQqtC,EAAIC,EAAID,IAE/D0kE,EAAYjD,YAAY98F,KAAMrE,EAAciC,GAAIk/F,YAAazhE,GAAI5iC,QAMnE7K,MAAK+N,aAAaqE,KAAM+/F,GAMzB,GAAInkG,GAAc0wE,EAAO1wE,WAEzB,KAAMgC,EAAI,EAAGyuB,EAAKzwB,EAAY5N,OAAQ4P,EAAIyuB,EAAIzuB,IAE7ChQ,KAAKgO,YAAYoE,KAAMpE,EAAagC,GAAInF,QAMzC,IAAIoD,GAAcywE,EAAOzwE,WAEzB,KAAM+B,EAAI,EAAGyuB,EAAKxwB,EAAY7N,OAAQ4P,EAAIyuB,EAAIzuB,IAE7ChQ,KAAKiO,YAAYmE,KAAMnE,EAAa+B,GAAInF,QAMzC,IAAIqD,GAAgBwwE,EAAOxwE,aAE3B,KAAM8B,EAAI,EAAGyuB,EAAKvwB,EAAc9N,OAAQ4P,EAAIyuB,EAAIzuB,IAE/ChQ,KAAKkO,cAAckE,KAAMlE,EAAe8B,GAMzC,IAAI7B,GAAcuwE,EAAOvwE,WAEJ,QAAhBA,IAEJnO,KAAKmO,YAAcA,EAAYtD,QAMhC,IAAIuD,GAAiBswE,EAAOtwE,cAkB5B,OAhBwB,QAAnBA,IAEJpO,KAAKoO,eAAiBA,EAAevD,SAMtC7K,KAAKqO,mBAAqBqwE,EAAOrwE,mBACjCrO,KAAKsO,mBAAqBowE,EAAOpwE,mBACjCtO,KAAKuO,cAAgBmwE,EAAOnwE,cAC5BvO,KAAKwO,kBAAoBkwE,EAAOlwE,kBAChCxO,KAAKyO,iBAAmBiwE,EAAOjwE,iBAC/BzO,KAAK0O,wBAA0BgwE,EAAOhwE,wBACtC1O,KAAK2O,iBAAmB+vE,EAAO/vE,iBAExB3O,MAIRsjB,QAAS,WAERtjB,KAAK24C,eAAiBl3C,KAAM,eAgC9BG,OAAOC,eAAgB+M,EAAgB6kE,UAAW,eAEjDxtE,IAAK,SAAWnE,GAEVA,KAAU,GAAO9B,KAAKuD,aAM7B3B,OAAO48E,OAAQ5vE,EAAgB6kE,WAE9B6+B,mBAAmB,EAEnBzqG,iBAAkB,aAElB0qG,SAAU,SAAWlrG,GAEpB,GAAK+F,MAAMC,QAAShG,GAEnB,KAAM,IAAI0H,WAAW,wDAOtB,OAHA/O,MAAKkJ,MAAkBpI,SAAVuG,EAAsBA,EAAMjH,OAASJ,KAAK6O,SAAW,EAClE7O,KAAKqH,MAAQA,EAENrH,MAIR08E,WAAY,SAAW56E,GAItB,MAFA9B,MAAKuH,QAAUzF,EAER9B,MAIR4e,KAAM,SAAW8/D,GAUhB,MARA1+E,MAAKmC,KAAOu8E,EAAOv8E,KACnBnC,KAAKqH,MAAQ,GAAIq3E,GAAOr3E,MAAMkjE,YAAamU,EAAOr3E,OAClDrH,KAAK6O,SAAW6vE,EAAO7vE,SACvB7O,KAAKkJ,MAAQw1E,EAAOx1E,MACpBlJ,KAAK8O,WAAa4vE,EAAO5vE,WAEzB9O,KAAKuH,QAAUm3E,EAAOn3E,QAEfvH,MAIRwyG,OAAQ,SAAW5jD,EAAQznD,EAAW0nD,GAErCD,GAAU5uD,KAAK6O,SACfggD,GAAU1nD,EAAU0H,QAEpB,KAAM,GAAImB,GAAI,EAAGC,EAAIjQ,KAAK6O,SAAUmB,EAAIC,EAAGD,IAE1ChQ,KAAKqH,MAAOunD,EAAS5+C,GAAM7I,EAAUE,MAAOwnD,EAAS7+C,EAItD,OAAOhQ,OAIRmkB,UAAW,SAAW9c,GAIrB,MAFArH,MAAKqH,MAAMpB,IAAKoB,GAETrH,MAIRyyG,gBAAiB,SAAW9kG,GAI3B,IAAM,GAFFtG,GAAQrH,KAAKqH,MAAOzE,EAAS,EAEvBoN,EAAI,EAAGC,EAAItC,EAAOvN,OAAQ4P,EAAIC,EAAGD,IAAO,CAEjD,GAAIhD,GAAQW,EAAQqC,EAELlP,UAAVkM,IAEJ3M,QAAQ4H,KAAM,8DAA+D+H,GAC7EhD,EAAQ,GAAInH,IAIbwB,EAAOzE,KAAcoK,EAAMlH,EAC3BuB,EAAOzE,KAAcoK,EAAMjH,EAC3BsB,EAAOzE,KAAcoK,EAAMhH,EAI5B,MAAOhG,OAIR0yG,kBAAmB,SAAWC,GAI7B,IAAM,GAFFtrG,GAAQrH,KAAKqH,MAAOzE,EAAS,EAEvBoN,EAAI,EAAGC,EAAI0iG,EAAQvyG,OAAQ4P,EAAIC,EAAGD,IAAO,CAElD,GAAImC,GAASwgG,EAAS3iG,EAENlP,UAAXqR,IAEJ9R,QAAQ4H,KAAM,iEAAkE+H,GAChFmC,EAAS,GAAItS,IAIdwH,EAAOzE,KAAcuP,EAAOrS,EAC5BuH,EAAOzE,KAAcuP,EAAOpS,EAI7B,MAAOC,OAIR4yG,kBAAmB,SAAWD,GAI7B,IAAM,GAFFtrG,GAAQrH,KAAKqH,MAAOzE,EAAS,EAEvBoN,EAAI,EAAGC,EAAI0iG,EAAQvyG,OAAQ4P,EAAIC,EAAGD,IAAO,CAElD,GAAImC,GAASwgG,EAAS3iG,EAENlP,UAAXqR,IAEJ9R,QAAQ4H,KAAM,iEAAkE+H,GAChFmC,EAAS,GAAIpR,IAIdsG,EAAOzE,KAAcuP,EAAOrS,EAC5BuH,EAAOzE,KAAcuP,EAAOpS,EAC5BsH,EAAOzE,KAAcuP,EAAO3R,EAI7B,MAAOR,OAIR6yG,kBAAmB,SAAWF,GAI7B,IAAM,GAFFtrG,GAAQrH,KAAKqH,MAAOzE,EAAS,EAEvBoN,EAAI,EAAGC,EAAI0iG,EAAQvyG,OAAQ4P,EAAIC,EAAGD,IAAO,CAElD,GAAImC,GAASwgG,EAAS3iG,EAENlP,UAAXqR,IAEJ9R,QAAQ4H,KAAM,iEAAkE+H,GAChFmC,EAAS,GAAI1O,IAId4D,EAAOzE,KAAcuP,EAAOrS,EAC5BuH,EAAOzE,KAAcuP,EAAOpS,EAC5BsH,EAAOzE,KAAcuP,EAAO3R,EAC5B6G,EAAOzE,KAAcuP,EAAO1R,EAI7B,MAAOT,OAIRiG,IAAK,SAAWnE,EAAOc,GAMtB,MAJgB9B,UAAX8B,IAAuBA,EAAS,GAErC5C,KAAKqH,MAAMpB,IAAKnE,EAAOc,GAEhB5C,MAIR8uD,KAAM,SAAW1+C,GAEhB,MAAOpQ,MAAKqH,MAAO+I,EAAQpQ,KAAK6O,WAIjCozE,KAAM,SAAW7xE,EAAOtQ,GAIvB,MAFAE,MAAKqH,MAAO+I,EAAQpQ,KAAK6O,UAAa/O,EAE/BE,MAIRyjF,KAAM,SAAWrzE,GAEhB,MAAOpQ,MAAKqH,MAAO+I,EAAQpQ,KAAK6O,SAAW,IAI5CqzE,KAAM,SAAW9xE,EAAOrQ,GAIvB,MAFAC,MAAKqH,MAAO+I,EAAQpQ,KAAK6O,SAAW,GAAM9O,EAEnCC,MAIR2oF,KAAM,SAAWv4E,GAEhB,MAAOpQ,MAAKqH,MAAO+I,EAAQpQ,KAAK6O,SAAW,IAI5CogF,KAAM,SAAW7+E,EAAO5P,GAIvB,MAFAR,MAAKqH,MAAO+I,EAAQpQ,KAAK6O,SAAW,GAAMrO,EAEnCR,MAIR8xF,KAAM,SAAW1hF,GAEhB,MAAOpQ,MAAKqH,MAAO+I,EAAQpQ,KAAK6O,SAAW,IAI5C4iF,KAAM,SAAWrhF,EAAO3P,GAIvB,MAFAT,MAAKqH,MAAO+I,EAAQpQ,KAAK6O,SAAW,GAAMpO,EAEnCT,MAIR8yG,MAAO,SAAW1iG,EAAOtQ,EAAGC,GAO3B,MALAqQ,IAASpQ,KAAK6O,SAEd7O,KAAKqH,MAAO+I,EAAQ,GAAMtQ,EAC1BE,KAAKqH,MAAO+I,EAAQ,GAAMrQ,EAEnBC,MAIR4oF,OAAQ,SAAWx4E,EAAOtQ,EAAGC,EAAGS,GAQ/B,MANA4P,IAASpQ,KAAK6O,SAEd7O,KAAKqH,MAAO+I,EAAQ,GAAMtQ,EAC1BE,KAAKqH,MAAO+I,EAAQ,GAAMrQ,EAC1BC,KAAKqH,MAAO+I,EAAQ,GAAM5P,EAEnBR,MAIR+yG,QAAS,SAAW3iG,EAAOtQ,EAAGC,EAAGS,EAAGC,GASnC,MAPA2P,IAASpQ,KAAK6O,SAEd7O,KAAKqH,MAAO+I,EAAQ,GAAMtQ,EAC1BE,KAAKqH,MAAO+I,EAAQ,GAAMrQ,EAC1BC,KAAKqH,MAAO+I,EAAQ,GAAM5P,EAC1BR,KAAKqH,MAAO+I,EAAQ,GAAM3P,EAEnBT,MAIRgzG,SAAU,SAAWlsG,GAIpB,MAFA9G,MAAK6H,iBAAmBf,EAEjB9G,MAIR6K,MAAO,WAEN,MAAO,IAAI7K,MAAKuqE,YAAavqE,KAAKqH,MAAOrH,KAAK6O,UAAW+P,KAAM5e,SAcjEgP,EAAoBykE,UAAY7xE,OAAOqvF,OAAQriF,EAAgB6kE,WAC/DzkE,EAAoBykE,UAAUlJ,YAAcv7D,EAS5CC,EAAqBwkE,UAAY7xE,OAAOqvF,OAAQriF,EAAgB6kE,WAChExkE,EAAqBwkE,UAAUlJ,YAAct7D,EAS7CC,EAA4BukE,UAAY7xE,OAAOqvF,OAAQriF,EAAgB6kE,WACvEvkE,EAA4BukE,UAAUlJ,YAAcr7D,EASpDE,EAAqBqkE,UAAY7xE,OAAOqvF,OAAQriF,EAAgB6kE,WAChErkE,EAAqBqkE,UAAUlJ,YAAcn7D,EAS7CC,EAAsBokE,UAAY7xE,OAAOqvF,OAAQriF,EAAgB6kE,WACjEpkE,EAAsBokE,UAAUlJ,YAAcl7D,EAS9CC,EAAqBmkE,UAAY7xE,OAAOqvF,OAAQriF,EAAgB6kE,WAChEnkE,EAAqBmkE,UAAUlJ,YAAcj7D,EAS7CC,EAAsBkkE,UAAY7xE,OAAOqvF,OAAQriF,EAAgB6kE,WACjElkE,EAAsBkkE,UAAUlJ,YAAch7D,EAS9CC,EAAuBikE,UAAY7xE,OAAOqvF,OAAQriF,EAAgB6kE,WAClEjkE,EAAuBikE,UAAUlJ,YAAc/6D,EAS/CC,EAAuBgkE,UAAY7xE,OAAOqvF,OAAQriF,EAAgB6kE,WAClEhkE,EAAuBgkE,UAAUlJ,YAAc96D,EAoC/C7N,OAAO48E,OAAQ9uE,EAAe+jE,WAE7Bw/B,cAAe,SAAW56F,GAQzB,IAAM,GANF4d,GACAnmB,KACA7C,EAAgBnM,OAEhB8M,EAAQyK,EAASzK,MAEXoC,EAAI,EAAGA,EAAIpC,EAAMxN,OAAQ4P,IAAO,CAEzC,GAAIovB,GAAOxxB,EAAOoC,EAIbovB,GAAKnyB,gBAAkBA,IAE3BA,EAAgBmyB,EAAKnyB,cAENnM,SAAVm1B,IAEJA,EAAM/sB,MAAc,EAAJ8G,EAAUimB,EAAMtvB,MAChCmJ,EAAOsC,KAAM6jB,IAIdA,GACCtvB,MAAW,EAAJqJ,EACP/C,cAAeA,IAOHnM,SAAVm1B,IAEJA,EAAM/sB,MAAc,EAAJ8G,EAAUimB,EAAMtvB,MAChCmJ,EAAOsC,KAAM6jB,IAIdj2B,KAAK8P,OAASA,GAIfojG,aAAc,SAAW76F,GAExB,GAYI86F,GAZAvlG,EAAQyK,EAASzK,MACjBF,EAAW2K,EAAS3K,SACpBG,EAAgBwK,EAASxK,cAEzB8jG,EAAkB9jG,EAAe,IAAOA,EAAe,GAAIzN,OAAS,EACpEgzG,EAAmBvlG,EAAe,IAAOA,EAAe,GAAIzN,OAAS,EAIrE0N,EAAeuK,EAASvK,aACxBulG,EAAqBvlG,EAAa1N,MAItC,IAAKizG,EAAqB,EAAI,CAE7BF,IAEA,KAAM,GAAInjG,GAAI,EAAGA,EAAIqjG,EAAoBrjG,IAExCmjG,EAAsBnjG,IACrB7N,KAAM2L,EAAckC,GAAI7N,KACvBuC,QAKH1E,MAAK8N,aAAahD,SAAWqoG,EAI9B,GAGIG,GAHAvlG,EAAesK,EAAStK,aACxBwlG,EAAqBxlG,EAAa3N,MAItC,IAAKmzG,EAAqB,EAAI,CAE7BD,IAEA,KAAM,GAAItjG,GAAI,EAAGA,EAAIujG,EAAoBvjG,IAExCsjG,EAAoBtjG,IACnB7N,KAAM4L,EAAciC,GAAI7N,KACvBuC,QAKH1E,MAAK8N,aAAa3I,OAASmuG,EAM5B,GAAIrlG,GAAcoK,EAASpK,YACvBD,EAAcqK,EAASrK,YAEvBwlG,EAAiBvlG,EAAY7N,SAAWsN,EAAStN,OACjDqzG,EAAiBzlG,EAAY5N,SAAWsN,EAAStN,MAIhDsN,GAAStN,OAAS,GAAsB,IAAjBwN,EAAMxN,QAEjCC,QAAQC,MAAO,+DAIhB,KAAM,GAAI0P,GAAI,EAAGA,EAAIpC,EAAMxN,OAAQ4P,IAAO,CAEzC,GAAIovB,GAAOxxB,EAAOoC,EAElBhQ,MAAK0N,SAAS0E,KAAM1E,EAAU0xB,EAAKtyB,GAAKY,EAAU0xB,EAAKp5B,GAAK0H,EAAU0xB,EAAKryB,GAE3E,IAAII,GAAgBiyB,EAAKjyB,aAEzB,IAA8B,IAAzBA,EAAc/M,OAElBJ,KAAK2P,QAAQyC,KAAMjF,EAAe,GAAKA,EAAe,GAAKA,EAAe,QAEpE,CAEN,GAAIhI,GAASi6B,EAAKj6B,MAElBnF,MAAK2P,QAAQyC,KAAMjN,EAAQA,EAAQA,GAIpC,GAAIoI,GAAe6xB,EAAK7xB,YAExB,IAA6B,IAAxBA,EAAanN,OAEjBJ,KAAK2N,OAAOyE,KAAM7E,EAAc,GAAKA,EAAc,GAAKA,EAAc,QAEhE,CAEN,GAAIP,GAAQoyB,EAAKpyB,KAEjBhN,MAAK2N,OAAOyE,KAAMpF,EAAOA,EAAOA,GAIjC,GAAK2kG,KAAoB,EAAO,CAE/B,GAAI+B,GAAY7lG,EAAe,GAAKmC,EAEjBlP,UAAd4yG,EAEJ1zG,KAAK4P,IAAIwC,KAAMshG,EAAW,GAAKA,EAAW,GAAKA,EAAW,KAI1DrzG,QAAQ4H,KAAM,2DAA4D+H,GAE1EhQ,KAAK4P,IAAIwC,KAAM,GAAIvS,GAAW,GAAIA,GAAW,GAAIA,KAMnD,GAAKuzG,KAAqB,EAAO,CAEhC,GAAIM,GAAY7lG,EAAe,GAAKmC,EAEjBlP,UAAd4yG,EAEJ1zG,KAAK6P,KAAKuC,KAAMshG,EAAW,GAAKA,EAAW,GAAKA,EAAW,KAI3DrzG,QAAQ4H,KAAM,4DAA6D+H,GAE3EhQ,KAAK6P,KAAKuC,KAAM,GAAIvS,GAAW,GAAIA,GAAW,GAAIA,KAQpD,IAAM,GAAI4tC,GAAI,EAAGA,EAAI4lE,EAAoB5lE,IAAO,CAE/C,GAAIykE,GAAcpkG,EAAc2/B,GAAI//B,QAEpCylG,GAAsB1lE,GAAI/oC,KAAK0N,KAAM8/F,EAAa9yE,EAAKtyB,GAAKolG,EAAa9yE,EAAKp5B,GAAKksG,EAAa9yE,EAAKryB,IAItG,IAAM,GAAI0gC,GAAI,EAAGA,EAAI8lE,EAAoB9lE,IAAO,CAE/C,GAAI0kE,GAAcpkG,EAAc0/B,GAAItgC,cAAe6C,EAEnDsjG,GAAoB7lE,GAAI/oC,KAAK0N,KAAM+/F,EAAYrlG,EAAGqlG,EAAYnsG,EAAGmsG,EAAYplG,GAMzEymG,GAEJxzG,KAAKiO,YAAYmE,KAAMnE,EAAamxB,EAAKtyB,GAAKmB,EAAamxB,EAAKp5B,GAAKiI,EAAamxB,EAAKryB,IAInF0mG,GAEJzzG,KAAKgO,YAAYoE,KAAMpE,EAAaoxB,EAAKtyB,GAAKkB,EAAaoxB,EAAKp5B,GAAKgI,EAAaoxB,EAAKryB,IAczF,MARA/M,MAAKizG,cAAe56F,GAEpBrY,KAAKsO,mBAAqB+J,EAAS/J,mBACnCtO,KAAKwO,kBAAoB6J,EAAS7J,kBAClCxO,KAAKyO,iBAAmB4J,EAAS5J,iBACjCzO,KAAKuO,cAAgB8J,EAAS9J,cAC9BvO,KAAK2O,iBAAmB0J,EAAS1J,iBAE1B3O,OA+BT,IAAImQ,IAAmB,CA2BvBD,GAAeujE,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQrxF,EAAgB6zE,YAExElJ,YAAar6D,EAEbwQ,kBAAkB,EAElBizF,SAAU,WAET,MAAO3zG,MAAKoQ,OAIbyC,SAAU,SAAWzC,GAEfhD,MAAMC,QAAS+C,GAEnBpQ,KAAKoQ,MAAQ,IAAML,EAAUK,GAAU,MAAQb,EAAwBF,GAAyBe,EAAO,GAIvGpQ,KAAKoQ,MAAQA,GAMf0C,aAAc,SAAW3Q,EAAMgF,GAE9B,MAASA,IAAaA,EAAUmrG,mBAA2BnrG,GAAaA,EAAUmC,6BAQpE,UAATnH,GAEJ9B,QAAQ4H,KAAM,2EACdjI,KAAK6S,SAAU1L,GAERnH,OAIRA,KAAKqQ,WAAYlO,GAASgF,EAEnBnH,OAjBNK,QAAQ4H,KAAM,0EAEPjI,KAAK8S,aAAc3Q,EAAM,GAAIyM,GAAiBzO,UAAW,GAAKA,UAAW,OAmBlFq5E,aAAc,SAAWr3E,GAExB,MAAOnC,MAAKqQ,WAAYlO,IAIzB+X,gBAAiB,SAAW/X,GAI3B,aAFOnC,MAAKqQ,WAAYlO,GAEjBnC,MAIRyS,SAAU,SAAW9L,EAAOuC,EAAO+D,GAElCjN,KAAK8P,OAAOsC,MAEXzL,MAAOA,EACPuC,MAAOA,EACP+D,cAAiCnM,SAAlBmM,EAA8BA,EAAgB,KAM/D2mG,YAAa,WAEZ5zG,KAAK8P,WAIN+jG,aAAc,SAAWltG,EAAOuC,GAE/BlJ,KAAKuQ,UAAU5J,MAAQA,EACvB3G,KAAKuQ,UAAUrH,MAAQA,GAIxBmiG,YAAa,SAAWpoG,GAEvB,GAAI6H,GAAW9K,KAAKqQ,WAAWvF,QAEbhK,UAAbgK,IAEJ7H,EAAOylF,uBAAwB59E,GAC/BA,EAAS6K,aAAc,EAIxB,IAAIxQ,GAASnF,KAAKqQ,WAAWlL,MAE7B,IAAgBrE,SAAXqE,EAAuB,CAE3B,GAAIiG,IAAe,GAAIpK,IAAUyd,gBAAiBxb,EAElDmI,GAAas9E,uBAAwBvjF,GACrCA,EAAOwQ,aAAc,EAgBtB,MAZ0B,QAArB3V,KAAKmO,aAETnO,KAAK+tG,qBAIuB,OAAxB/tG,KAAKoO,gBAETpO,KAAKi7E,wBAICj7E,MAIR4rG,QAAS,WAIR,GAAItW,GAAK,GAAIr1F,EAEb,OAAO,UAAkB44B,GAMxB,MAJAy8D,GAAG1L,cAAe/wD,GAElB74B,KAAKqrG,YAAa/V,GAEXt1F,SAMTu5E,QAAS,WAIR,GAAI+b,GAAK,GAAIr1F,EAEb,OAAO,UAAkB44B,GAMxB,MAJAy8D,GAAGzL,cAAehxD,GAElB74B,KAAKqrG,YAAa/V,GAEXt1F,SAMT6rG,QAAS,WAIR,GAAIvW,GAAK,GAAIr1F,EAEb,OAAO,UAAkB44B,GAMxB,MAJAy8D,GAAGxL,cAAejxD,GAElB74B,KAAKqrG,YAAa/V,GAEXt1F,SAMT07E,UAAW,WAIV,GAAI4Z,GAAK,GAAIr1F,EAEb,OAAO,UAAoBH,EAAGC,EAAGS,GAMhC,MAJA80F,GAAGv2D,gBAAiBj/B,EAAGC,EAAGS,GAE1BR,KAAKqrG,YAAa/V,GAEXt1F,SAMT+K,MAAO,WAIN,GAAIuqF,GAAK,GAAIr1F,EAEb,OAAO,UAAgBH,EAAGC,EAAGS,GAM5B,MAJA80F,GAAGnL,UAAWrqF,EAAGC,EAAGS,GAEpBR,KAAKqrG,YAAa/V,GAEXt1F,SAMTg/B,OAAQ,WAEP,GAAIgvE,GAAM,GAAI9jG,EAEd,OAAO,UAAiBiI,GAEvB67F,EAAIhvE,OAAQ7sB,GAEZ67F,EAAIxoD,eAEJxlD,KAAKqrG,YAAa2C,EAAI/qG,YAMxBH,OAAQ,WAEP,GAAIF,GAAS,GAAI7B,EAEjB,OAAO,YAQN,MANAf,MAAK+tG,qBAEL/tG,KAAKmO,YAAYskF,UAAW7vF,GAAS2jD,SAErCvmD,KAAK07E,UAAW94E,EAAO9C,EAAG8C,EAAO7C,EAAG6C,EAAOpC,GAEpCR,SAMT6gB,cAAe,SAAWL,GAIzB,GAAInI,GAAWmI,EAAOnI,QAEtB,IAAKmI,EAAOmc,UAAYnc,EAAOkc,OAAS,CAEvC,GAAI67C,GAAY,GAAI/oE,GAAmD,EAA3B6I,EAAS3K,SAAStN,OAAY,GACtEuN,EAAS,GAAI6B,GAAiD,EAAzB6I,EAAS1K,OAAOvN,OAAY,EAKrE,IAHAJ,KAAK8S,aAAc,WAAYylE,EAAUq6B,kBAAmBv6F,EAAS3K,WACrE1N,KAAK8S,aAAc,QAASnF,EAAO8kG,gBAAiBp6F,EAAS1K,SAExD0K,EAASnK,eAAiBmK,EAASnK,cAAc9N,SAAWiY,EAAS3K,SAAStN,OAAS,CAE3F,GAAI8N,GAAgB,GAAIsB,GAAwB6I,EAASnK,cAAc9N,OAAQ,EAE/EJ,MAAK8S,aAAc,eAAgB5E,EAAciW,UAAW9L,EAASnK,gBAIrC,OAA5BmK,EAASjK,iBAEbpO,KAAKoO,eAAiBiK,EAASjK,eAAevD,SAIjB,OAAzBwN,EAASlK,cAEbnO,KAAKmO,YAAckK,EAASlK,YAAYtD,aAI9B2V,GAAOic,QAEbpkB,GAAYA,EAASsI,YAEzB3gB,KAAKkzG,aAAc76F,EAMrB,OAAOrY,OAIRopE,cAAe,SAAWnnD,GAIzB,IAAM,GAFFnX,MAEMkF,EAAI,EAAGC,EAAIgS,EAAO7hB,OAAQ4P,EAAIC,EAAGD,IAAO,CAEjD,GAAIykB,GAAQxS,EAAQjS,EACpBlF,GAASsH,KAAMqiB,EAAM30B,EAAG20B,EAAM10B,EAAG00B,EAAMj0B,GAAK,GAM7C,MAFAR,MAAK8S,aAAc,WAAY,GAAItD,GAAwB1E,EAAU,IAE9D9K,MAIRqjB,iBAAkB,SAAW7C,GAE5B,GAAInI,GAAWmI,EAAOnI,QAEtB,IAAKmI,EAAOic,OAAS,CAEpB,GAAIq3E,GAASz7F,EAAS07F,gBAStB,IAPK17F,EAAShK,sBAAuB,IAEpCylG,EAAShzG,OACTuX,EAAShK,oBAAqB,GAIfvN,SAAXgzG,EAEJ,MAAO9zG,MAAKkzG,aAAc76F,EAI3By7F,GAAOxlG,mBAAqB+J,EAAS/J,mBACrCwlG,EAAOtlG,kBAAoB6J,EAAS7J,kBACpCslG,EAAOrlG,iBAAmB4J,EAAS5J,iBACnCqlG,EAAOvlG,cAAgB8J,EAAS9J,cAChCulG,EAAOnlG,iBAAmB0J,EAAS1J,iBAEnC0J,EAAS/J,oBAAqB,EAC9B+J,EAAS7J,mBAAoB,EAC7B6J,EAAS5J,kBAAmB,EAC5B4J,EAAS9J,eAAgB,EACzB8J,EAAS1J,kBAAmB,EAE5B0J,EAAWy7F,EAIZ,GAAI3sG,EAsFJ,OApFKkR,GAAS/J,sBAAuB,IAEpCnH,EAAYnH,KAAKqQ,WAAWvF,SAEThK,SAAdqG,IAEJA,EAAUyrG,kBAAmBv6F,EAAS3K,UACtCvG,EAAUwO,aAAc,GAIzB0C,EAAS/J,oBAAqB,GAI1B+J,EAAS7J,qBAAsB,IAEnCrH,EAAYnH,KAAKqQ,WAAWlL,OAETrE,SAAdqG,IAEJA,EAAUyrG,kBAAmBv6F,EAAS1I,SACtCxI,EAAUwO,aAAc,GAIzB0C,EAAS7J,mBAAoB,GAIzB6J,EAAS5J,oBAAqB,IAElCtH,EAAYnH,KAAKqQ,WAAWrD,MAETlM,SAAdqG,IAEJA,EAAUsrG,gBAAiBp6F,EAAS1K,QACpCxG,EAAUwO,aAAc,GAIzB0C,EAAS5J,kBAAmB,GAIxB4J,EAAS9J,gBAEbpH,EAAYnH,KAAKqQ,WAAWuH,GAET9W,SAAdqG,IAEJA,EAAUurG,kBAAmBr6F,EAASzI,KACtCzI,EAAUwO,aAAc,GAIzB0C,EAAS9J,eAAgB,GAIrB8J,EAAS3J,0BAEbvH,EAAYnH,KAAKqQ,WAAW2jG,aAETlzG,SAAdqG,IAEJA,EAAUgd,UAAW9L,EAASnK,eAC9B/G,EAAUwO,aAAc,GAIzB0C,EAAS3J,yBAA0B,GAI/B2J,EAAS1J,mBAEb0J,EAAS46F,cAAezyF,EAAOnI,UAC/BrY,KAAK8P,OAASuI,EAASvI,OAEvBuI,EAAS1J,kBAAmB,GAItB3O,MAIRkzG,aAAc,SAAW76F,GAIxB,MAFAA,GAAS07F,kBAAmB,GAAIrkG,IAAiBwjG,aAAc76F,GAExDrY,KAAKi0G,mBAAoB57F,EAAS07F,mBAI1CE,mBAAoB,SAAW57F,GAE9B,GAAIkgE,GAAY,GAAIxwE,cAAyC,EAA3BsQ,EAAS3K,SAAStN,OAGpD,IAFAJ,KAAK8S,aAAc,WAAY,GAAIlE,GAAiB2pE,EAAW,GAAIq6B,kBAAmBv6F,EAAS3K,WAE1F2K,EAAS1I,QAAQvP,OAAS,EAAI,CAElC,GAAIuP,GAAU,GAAI5H,cAAwC,EAA1BsQ,EAAS1I,QAAQvP,OACjDJ,MAAK8S,aAAc,SAAU,GAAIlE,GAAiBe,EAAS,GAAIijG,kBAAmBv6F,EAAS1I,UAI5F,GAAK0I,EAAS1K,OAAOvN,OAAS,EAAI,CAEjC,GAAIuN,GAAS,GAAI5F,cAAuC,EAAzBsQ,EAAS1K,OAAOvN,OAC/CJ,MAAK8S,aAAc,QAAS,GAAIlE,GAAiBjB,EAAQ,GAAI8kG,gBAAiBp6F,EAAS1K,SAIxF,GAAK0K,EAASzI,IAAIxP,OAAS,EAAI,CAE9B,GAAIwP,GAAM,GAAI7H,cAAoC,EAAtBsQ,EAASzI,IAAIxP,OACzCJ,MAAK8S,aAAc,KAAM,GAAIlE,GAAiBgB,EAAK,GAAI8iG,kBAAmBr6F,EAASzI,MAIpF,GAAKyI,EAASxI,KAAKzP,OAAS,EAAI,CAE/B,GAAIyP,GAAO,GAAI9H,cAAqC,EAAvBsQ,EAASxI,KAAKzP,OAC3CJ,MAAK8S,aAAc,MAAO,GAAIlE,GAAiBiB,EAAM,GAAI6iG,kBAAmBr6F,EAASxI,OAMtF7P,KAAK8P,OAASuI,EAASvI,MAIvB,KAAM,GAAI3N,KAAQkW,GAASvK,aAAe,CAKzC,IAAM,GAHFzG,MACAyG,EAAeuK,EAASvK,aAAc3L,GAEhC6N,EAAI,EAAGC,EAAInC,EAAa1N,OAAQ4P,EAAIC,EAAGD,IAAO,CAEvD,GAAIkiG,GAAcpkG,EAAckC,GAE5B7I,EAAY,GAAIqI,GAAkD,EAA1B0iG,EAAYxtG,KAAKtE,OAAY,EACzE+G,GAAUhF,KAAO+vG,EAAY/vG,KAE7BkF,EAAM+K,KAAMjL,EAAUyrG,kBAAmBV,EAAYxtG,OAItD1E,KAAKsQ,gBAAiBnO,GAASkF,EAMhC,GAAKgR,EAASpK,YAAY7N,OAAS,EAAI,CAEtC,GAAI6N,GAAc,GAAIuB,GAAsD,EAA9B6I,EAASpK,YAAY7N,OAAY,EAC/EJ,MAAK8S,aAAc,YAAa7E,EAAY4kG,kBAAmBx6F,EAASpK,cAIzE,GAAKoK,EAASrK,YAAY5N,OAAS,EAAI,CAEtC,GAAI4N,GAAc,GAAIwB,GAAsD,EAA9B6I,EAASrK,YAAY5N,OAAY,EAC/EJ,MAAK8S,aAAc,aAAc9E,EAAY6kG,kBAAmBx6F,EAASrK,cAkB1E,MAZiC,QAA5BqK,EAASjK,iBAEbpO,KAAKoO,eAAiBiK,EAASjK,eAAevD,SAIjB,OAAzBwN,EAASlK,cAEbnO,KAAKmO,YAAckK,EAASlK,YAAYtD,SAIlC7K,MAIR+tG,mBAAoB,WAEO,OAArB/tG,KAAKmO,cAETnO,KAAKmO,YAAc,GAAIvJ,GAIxB,IAAIkG,GAAW9K,KAAKqQ,WAAWvF,QAEbhK,UAAbgK,EAEJ9K,KAAKmO,YAAYgkF,uBAAwBrnF,GAIzC9K,KAAKmO,YAAYikF,aAIb8hB,MAAOl0G,KAAKmO,YAAYtJ,IAAI/E,IAAOo0G,MAAOl0G,KAAKmO,YAAYtJ,IAAI9E,IAAOm0G,MAAOl0G,KAAKmO,YAAYtJ,IAAIrE,KAEtGH,QAAQC,MAAO,oIAAqIN,OAMtJi7E,sBAAuB,WAEtB,GAAID,GAAM,GAAIp2E,GACVuN,EAAS,GAAIpR,EAEjB,OAAO,YAEuB,OAAxBf,KAAKoO,iBAETpO,KAAKoO,eAAiB,GAAIpJ,GAI3B,IAAI8F,GAAW9K,KAAKqQ,WAAWvF,QAE/B,IAAKA,EAAW,CAEf,GAAIhI,GAAS9C,KAAKoO,eAAetL,MAEjCk4E,GAAImX,uBAAwBrnF,GAC5BkwE,EAAIyX,UAAW3vF,EAOf,KAAM,GAFFsxF,GAAc,EAERpkF,EAAI,EAAGyuB,EAAK3zB,EAAS5B,MAAO8G,EAAIyuB,EAAIzuB,IAE7CmC,EAAOrS,EAAIgL,EAASgkD,KAAM9+C,GAC1BmC,EAAOpS,EAAI+K,EAAS24E,KAAMzzE,GAC1BmC,EAAO3R,EAAIsK,EAAS69E,KAAM34E,GAC1BokF,EAAczhF,KAAK7N,IAAKsvF,EAAatxF,EAAOsgF,kBAAmBjxE,GAIhEnS,MAAKoO,eAAenJ,OAAS0N,KAAKmwC,KAAMsxC,GAEnC8f,MAAOl0G,KAAKoO,eAAenJ,SAE/B5E,QAAQC,MAAO,+HAAgIN,WAUnJoiE,mBAAoB,aAMpBxQ,qBAAsB,WAErB,GAAIxhD,GAAQpQ,KAAKoQ,MACbC,EAAarQ,KAAKqQ,UAEtB,IAAKA,EAAWvF,SAAW,CAE1B,GAAIytE,GAAYloE,EAAWvF,SAASzD,KAEpC,IAA2BvG,SAAtBuP,EAAWlL,OAEfnF,KAAK8S,aAAc,SAAU,GAAIlE,GAAiB,GAAI7G,cAAcwwE,EAAUn4E,QAAU,QAQxF,KAAM,GAFFiH,GAAQgJ,EAAWlL,OAAOkC,MAEpB2I,EAAI,EAAGyuB,EAAKp3B,EAAMjH,OAAQ4P,EAAIyuB,EAAIzuB,IAE3C3I,EAAO2I,GAAM,CAMf,IAEIw+F,GAAIC,EAAIC,EAFR/+F,EAAUU,EAAWlL,OAAOkC,MAG5B8sG,EAAK,GAAIpzG,GAAWqzG,EAAK,GAAIrzG,GAAWszG,EAAK,GAAItzG,GACjDstG,EAAK,GAAIttG,GAAWutG,EAAK,GAAIvtG,EAIjC,IAAKqP,EAIJ,IAAM,GAFFmC,GAAUnC,EAAM/I,MAEV2I,EAAI,EAAGyuB,EAAKruB,EAAMlH,MAAO8G,EAAIyuB,EAAIzuB,GAAK,EAE/Cw+F,EAAwB,EAAnBj8F,EAASvC,EAAI,GAClBy+F,EAAwB,EAAnBl8F,EAASvC,EAAI,GAClB0+F,EAAwB,EAAnBn8F,EAASvC,EAAI,GAElBmkG,EAAGj8D,UAAWqgC,EAAWi2B,GACzB4F,EAAGl8D,UAAWqgC,EAAWk2B,GACzB4F,EAAGn8D,UAAWqgC,EAAWm2B,GAEzBL,EAAG5+C,WAAY4kD,EAAID,GACnB9F,EAAG7+C,WAAY0kD,EAAIC,GACnB/F,EAAGrrB,MAAOsrB,GAEV3+F,EAAS6+F,IAAQH,EAAGvuG,EACpB6P,EAAS6+F,EAAK,IAAOH,EAAGtuG,EACxB4P,EAAS6+F,EAAK,IAAOH,EAAG7tG,EAExBmP,EAAS8+F,IAAQJ,EAAGvuG,EACpB6P,EAAS8+F,EAAK,IAAOJ,EAAGtuG,EACxB4P,EAAS8+F,EAAK,IAAOJ,EAAG7tG,EAExBmP,EAAS++F,IAAQL,EAAGvuG,EACpB6P,EAAS++F,EAAK,IAAOL,EAAGtuG,EACxB4P,EAAS++F,EAAK,IAAOL,EAAG7tG,MAQzB,KAAM,GAAIwP,GAAI,EAAGyuB,EAAK85C,EAAUn4E,OAAQ4P,EAAIyuB,EAAIzuB,GAAK,EAEpDmkG,EAAGj8D,UAAWqgC,EAAWvoE,GACzBokG,EAAGl8D,UAAWqgC,EAAWvoE,EAAI,GAC7BqkG,EAAGn8D,UAAWqgC,EAAWvoE,EAAI,GAE7Bq+F,EAAG5+C,WAAY4kD,EAAID,GACnB9F,EAAG7+C,WAAY0kD,EAAIC,GACnB/F,EAAGrrB,MAAOsrB,GAEV3+F,EAASK,GAAMq+F,EAAGvuG,EAClB6P,EAASK,EAAI,GAAMq+F,EAAGtuG,EACtB4P,EAASK,EAAI,GAAMq+F,EAAG7tG,EAEtBmP,EAASK,EAAI,GAAMq+F,EAAGvuG,EACtB6P,EAASK,EAAI,GAAMq+F,EAAGtuG,EACtB4P,EAASK,EAAI,GAAMq+F,EAAG7tG,EAEtBmP,EAASK,EAAI,GAAMq+F,EAAGvuG,EACtB6P,EAASK,EAAI,GAAMq+F,EAAGtuG,EACtB4P,EAASK,EAAI,GAAMq+F,EAAG7tG,CAMxBR,MAAK6xD,mBAELxhD,EAAWlL,OAAOwQ,aAAc,IAMlCooF,MAAO,SAAW1lF,EAAUzV,GAE3B,IAASyV,IAAYA,EAASqI,iBAG7B,WADArgB,SAAQC,MAAO,kFAAmF+X,EAKnFvX,UAAX8B,IAEJA,EAAS,EAETvC,QAAQ4H,KACP,0JAMF,IAAIoI,GAAarQ,KAAKqQ,UAEtB,KAAM,GAAIslB,KAAOtlB,GAEhB,GAAoCvP,SAA/BuX,EAAShI,WAAYslB,GAU1B,IAAM,GARF2+E,GAAajkG,EAAYslB,GACzB4+E,EAAkBD,EAAWjtG,MAE7BmtG,EAAan8F,EAAShI,WAAYslB,GAClC8+E,EAAkBD,EAAWntG,MAE7BqtG,EAAgBF,EAAW3lG,SAErBmB,EAAI,EAAGy9B,EAAIinE,EAAgB9xG,EAAQoN,EAAIykG,EAAgBr0G,OAAQ4P,IAAMy9B,IAE9E8mE,EAAiB9mE,GAAMgnE,EAAiBzkG,EAM1C,OAAOhQ,OAIR6xD,iBAAkB,WAEjB,GAAI1/C,GAAS,GAAIpR,EAEjB,OAAO,YAIN,IAAM,GAFF4O,GAAU3P,KAAKqQ,WAAWlL,OAEpB6K,EAAI,EAAGyuB,EAAK9uB,EAAQzG,MAAO8G,EAAIyuB,EAAIzuB,IAE5CmC,EAAOrS,EAAI6P,EAAQm/C,KAAM9+C,GACzBmC,EAAOpS,EAAI4P,EAAQ8zE,KAAMzzE,GACzBmC,EAAO3R,EAAImP,EAAQg5E,KAAM34E,GAEzBmC,EAAOwnB,YAEPhqB,EAAQi5E,OAAQ54E,EAAGmC,EAAOrS,EAAGqS,EAAOpS,EAAGoS,EAAO3R,OAQjDm0G,aAAc,WAEb,GAAoB,OAAf30G,KAAKoQ,MAGT,MADA/P,SAAQ4H,KAAM,yEACPjI,IAIR,IAAIiiE,GAAY,GAAI/xD,GAEhBqC,EAAUvS,KAAKoQ,MAAM/I,MACrBgJ,EAAarQ,KAAKqQ,UAEtB,KAAM,GAAIlO,KAAQkO,GAAa,CAW9B,IAAM,GATFlJ,GAAYkJ,EAAYlO,GAExBkF,EAAQF,EAAUE,MAClBwH,EAAW1H,EAAU0H,SAErB+lG,EAAS,GAAIvtG,GAAMkjE,YAAah4D,EAAQnS,OAASyO,GAEjDuB,EAAQ,EAAGy+C,EAAS,EAEd7+C,EAAI,EAAGC,EAAIsC,EAAQnS,OAAQ4P,EAAIC,EAAGD,IAAO,CAElDI,EAAQmC,EAASvC,GAAMnB,CAEvB,KAAM,GAAI4+B,GAAI,EAAGA,EAAI5+B,EAAU4+B,IAE9BmnE,EAAQ/lD,KAAcxnD,EAAO+I,KAM/B6xD,EAAUnvD,aAAc3Q,EAAM,GAAIyM,GAAiBgmG,EAAQ/lG,IAM5D,IAAM,GAFFiB,GAAS9P,KAAK8P,OAERE,EAAI,EAAGC,EAAIH,EAAO1P,OAAQ4P,EAAIC,EAAGD,IAAO,CAEjD,GAAIimB,GAAQnmB,EAAQE,EACpBiyD,GAAUxvD,SAAUwjB,EAAMtvB,MAAOsvB,EAAM/sB,MAAO+sB,EAAMhpB,eAIrD,MAAOg1D,IAIR3C,OAAQ,WAEP,GAAI56D,IACH0sF,UACC7tF,QAAS,IACT9B,KAAM,iBACN4vF,UAAW,yBAWb,IALA3sF,EAAK1C,KAAOhC,KAAKgC,KACjB0C,EAAKjD,KAAOzB,KAAKyB,KACE,KAAdzB,KAAKmC,OAAcuC,EAAKvC,KAAOnC,KAAKmC,MACpCP,OAAO+sD,KAAM3uD,KAAK8L,UAAW1L,OAAS,IAAIsE,EAAKoH,SAAW9L,KAAK8L,UAE3ChL,SAApBd,KAAK6Q,WAA2B,CAEpC,GAAIA,GAAa7Q,KAAK6Q,UAEtB,KAAM,GAAI8kB,KAAO9kB,GAEW/P,SAAtB+P,EAAY8kB,KAAsBjxB,EAAMixB,GAAQ9kB,EAAY8kB,GAIlE,OAAOjxB,GAIRA,EAAKA,MAAS2L,cAEd,IAAID,GAAQpQ,KAAKoQ,KAEjB,IAAe,OAAVA,EAAiB,CAErB,GAAI/I,GAAQ+F,MAAMqmE,UAAU5mB,MAAMvoD,KAAM8L,EAAM/I,MAE9C3C,GAAKA,KAAK0L,OACT3O,KAAM2O,EAAM/I,MAAMkjE,YAAYpoE,KAC9BkF,MAAOA,GAKT,GAAIgJ,GAAarQ,KAAKqQ,UAEtB,KAAM,GAAIslB,KAAOtlB,GAAa,CAE7B,GAAIlJ,GAAYkJ,EAAYslB,GAExBtuB,EAAQ+F,MAAMqmE,UAAU5mB,MAAMvoD,KAAM6C,EAAUE,MAElD3C,GAAKA,KAAK2L,WAAYslB,IACrB9mB,SAAU1H,EAAU0H,SACpBpN,KAAM0F,EAAUE,MAAMkjE,YAAYpoE,KAClCkF,MAAOA,EACPyH,WAAY3H,EAAU2H,YAKxB,GAAIgB,GAAS9P,KAAK8P,MAEbA,GAAO1P,OAAS,IAEpBsE,EAAKA,KAAKoL,OAASq9F,KAAKvgC,MAAOugC,KAAKC,UAAWt9F,IAIhD,IAAI1B,GAAiBpO,KAAKoO,cAW1B,OATwB,QAAnBA,IAEJ1J,EAAKA,KAAK0J,gBACTtL,OAAQsL,EAAetL,OAAOgc,UAC9B7Z,OAAQmJ,EAAenJ,SAKlBP,GAIRmG,MAAO,WA0BN,OAAO,GAAIqF,IAAiB0O,KAAM5e,OAInC4e,KAAM,SAAW8/D,GAEhB,GAAIv8E,GAAM6N,EAAGC,CAIbjQ,MAAKoQ,MAAQ,KACbpQ,KAAKqQ,cACLrQ,KAAKsQ,mBACLtQ,KAAK8P,UACL9P,KAAKmO,YAAc,KACnBnO,KAAKoO,eAAiB,KAItBpO,KAAKmC,KAAOu8E,EAAOv8E,IAInB,IAAIiO,GAAQsuE,EAAOtuE,KAEJ,QAAVA,GAEJpQ,KAAK6S,SAAUzC,EAAMvF,QAMtB,IAAIwF,GAAaquE,EAAOruE,UAExB,KAAMlO,IAAQkO,GAAa,CAE1B,GAAIlJ,GAAYkJ,EAAYlO,EAC5BnC,MAAK8S,aAAc3Q,EAAMgF,EAAU0D,SAMpC,GAAIyF,GAAkBouE,EAAOpuE,eAE7B,KAAMnO,IAAQmO,GAAkB,CAE/B,GAAIjJ,MACAwtG,EAAiBvkG,EAAiBnO,EAEtC,KAAM6N,EAAI,EAAGC,EAAI4kG,EAAez0G,OAAQ4P,EAAIC,EAAGD,IAE9C3I,EAAM+K,KAAMyiG,EAAgB7kG,GAAInF,QAIjC7K,MAAKsQ,gBAAiBnO,GAASkF,EAMhC,GAAIyI,GAAS4uE,EAAO5uE,MAEpB,KAAME,EAAI,EAAGC,EAAIH,EAAO1P,OAAQ4P,EAAIC,EAAGD,IAAO,CAE7C,GAAIimB,GAAQnmB,EAAQE,EACpBhQ,MAAKyS,SAAUwjB,EAAMtvB,MAAOsvB,EAAM/sB,MAAO+sB,EAAMhpB,eAMhD,GAAIkB,GAAcuwE,EAAOvwE,WAEJ,QAAhBA,IAEJnO,KAAKmO,YAAcA,EAAYtD,QAMhC,IAAIuD,GAAiBswE,EAAOtwE,cAiB5B,OAfwB,QAAnBA,IAEJpO,KAAKoO,eAAiBA,EAAevD,SAMtC7K,KAAKuQ,UAAU5J,MAAQ+3E,EAAOnuE,UAAU5J,MACxC3G,KAAKuQ,UAAUrH,MAAQw1E,EAAOnuE,UAAUrH,MAIxClJ,KAAK8L,SAAW4yE,EAAO5yE,SAEhB9L,MAIRsjB,QAAS,WAERtjB,KAAK24C,eAAiBl3C,KAAM,eAiC9B+O,EAAYijE,UAAY7xE,OAAOqvF,OAAQzjF,EAASimE,WAChDjjE,EAAYijE,UAAUlJ,YAAc/5D,EAqKpCO,EAAkB0iE,UAAY7xE,OAAOqvF,OAAQ/gF,EAAeujE,WAC5D1iE,EAAkB0iE,UAAUlJ,YAAcx5D,EA2B1CgC,EAAc0gE,UAAY7xE,OAAOqvF,OAAQzjF,EAASimE,WAClD1gE,EAAc0gE,UAAUlJ,YAAcx3D,EA2FtCC,EAAoBygE,UAAY7xE,OAAOqvF,OAAQ/gF,EAAeujE,WAC9DzgE,EAAoBygE,UAAUlJ,YAAcv3D,CAO5C,IAAIM,IAAa,CA8DjBD,GAASogE,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQrxF,EAAgB6zE,YAElElJ,YAAal3D,EAEbyhG,YAAY,EAEZ9/E,gBAAiB,aAEjBle,UAAW,SAAWo0D,GAErB,GAAgBpqE,SAAXoqE,EAEL,IAAM,GAAIv1C,KAAOu1C,GAAS,CAEzB,GAAI6pC,GAAW7pC,EAAQv1C,EAEvB,IAAkB70B,SAAbi0G,EAQL,GAAa,YAARp/E,EAAL,CAQA,GAAIq/E,GAAeh1G,KAAM21B,EAEH70B,UAAjBk0G,EAOAA,GAAgBA,EAAa1nG,QAEjC0nG,EAAa/uG,IAAK8uG,GAELC,GAAgBA,EAAa9nG,WAAiB6nG,GAAYA,EAAS7nG,UAEhF8nG,EAAap2F,KAAMm2F,GAEA,aAARp/E,EAGX31B,KAAM21B,GAAQylC,OAAQ25C,GAItB/0G,KAAM21B,GAAQo/E,EApBd10G,QAAQ4H,KAAM,SAAWjI,KAAKyB,KAAO,MAAQk0B,EAAM,6CAVnDt1B,SAAQ4H,KAAM,SAAWjI,KAAKyB,KAAO,sEACrCzB,KAAK6T,YAAgBkhG,IAAar1B,OATlCr/E,SAAQ4H,KAAM,oBAAsB0tB,EAAM,+BA8C7C2pC,OAAQ,SAAW4xB,GAsIlB,QAASgc,GAAkB3tF,GAE1B,GAAI2rD,KAEJ,KAAM,GAAIv1C,KAAOpW,GAAQ,CAExB,GAAI7a,GAAO6a,EAAOoW,SACXjxB,GAAK0sF,SACZlmB,EAAO94D,KAAM1N,GAId,MAAOwmE,GAhJR,GAAI+pC,GAAoBn0G,SAATowF,GAAsC,gBAATA,EAEvC+jB,KAEJ/jB,GACC/uE,YACAqB,WAKF,IAAI9e,IACH0sF,UACC7tF,QAAS,IACT9B,KAAM,WACN4vF,UAAW,mBAqIb,IAhIA3sF,EAAK1C,KAAOhC,KAAKgC,KACjB0C,EAAKjD,KAAOzB,KAAKyB,KAEE,KAAdzB,KAAKmC,OAAcuC,EAAKvC,KAAOnC,KAAKmC,MAEpCnC,KAAKgN,OAAShN,KAAKgN,MAAMM,UAAU5I,EAAKsI,MAAQhN,KAAKgN,MAAMy7F,UAExC3nG,SAAnBd,KAAKwmD,YAA0B9hD,EAAK8hD,UAAYxmD,KAAKwmD,WAClC1lD,SAAnBd,KAAKymD,YAA0B/hD,EAAK+hD,UAAYzmD,KAAKymD,WAErDzmD,KAAKmlD,UAAYnlD,KAAKmlD,SAAS73C,UAAU5I,EAAKygD,SAAWnlD,KAAKmlD,SAASsjD,UAC5C,IAA3BzoG,KAAKolD,oBAA0B1gD,EAAK0gD,kBAAoBplD,KAAKolD,mBAE7DplD,KAAKmmD,UAAYnmD,KAAKmmD,SAAS74C,UAAU5I,EAAKyhD,SAAWnmD,KAAKmmD,SAASsiD,UACpD3nG,SAAnBd,KAAKomD,YAA0B1hD,EAAK0hD,UAAYpmD,KAAKomD,WAClCtlD,SAAnBd,KAAK2mD,YAA0BjiD,EAAKiiD,UAAY3mD,KAAK2mD,WACzB7lD,SAA5Bd,KAAK4mD,qBAAmCliD,EAAKkiD,mBAAqB5mD,KAAK4mD,oBAEvE5mD,KAAK6V,KAAO7V,KAAK6V,IAAIyE,YAAY5V,EAAKmR,IAAM7V,KAAK6V,IAAIypD,OAAQ4xB,GAAOlvF,MACpEhC,KAAKmW,UAAYnW,KAAKmW,SAASmE,YAAY5V,EAAKyR,SAAWnW,KAAKmW,SAASmpD,OAAQ4xB,GAAOlvF,MACxFhC,KAAK8V,UAAY9V,KAAK8V,SAASwE,YAAY5V,EAAKoR,SAAW9V,KAAK8V,SAASwpD,OAAQ4xB,GAAOlvF,MAExFhC,KAAKgW,OAAShW,KAAKgW,MAAMsE,YAE7B5V,EAAKsR,MAAQhW,KAAKgW,MAAMspD,OAAQ4xB,GAAOlvF,KACvC0C,EAAKuR,eAAiBjW,KAAKiW,gBAIvBjW,KAAKsrB,SAAWtrB,KAAKsrB,QAAQhR,YAEjC5V,EAAK4mB,QAAUtrB,KAAKsrB,QAAQg0C,OAAQ4xB,GAAOlvF,KAC3C0C,EAAK2hD,UAAYrmD,KAAKqmD,WAIlBrmD,KAAKurB,WAAavrB,KAAKurB,UAAUjR,YAErC5V,EAAK6mB,UAAYvrB,KAAKurB,UAAU+zC,OAAQ4xB,GAAOlvF,KAC/C0C,EAAKyvB,cAAgBn0B,KAAKm0B,cAC1BzvB,EAAK4hD,YAActmD,KAAKsmD,YAAYxnC,WAIhC9e,KAAKivB,iBAAmBjvB,KAAKivB,gBAAgB3U,YAEjD5V,EAAKuqB,gBAAkBjvB,KAAKivB,gBAAgBqwC,OAAQ4xB,GAAOlvF,KAC3D0C,EAAKg2B,kBAAoB16B,KAAK06B,kBAC9Bh2B,EAAKi2B,iBAAmB36B,KAAK26B,kBAIzB36B,KAAKkvB,cAAgBlvB,KAAKkvB,aAAa5U,YAAY5V,EAAKwqB,aAAelvB,KAAKkvB,aAAaowC,OAAQ4xB,GAAOlvF,MACxGhC,KAAKmvB,cAAgBnvB,KAAKmvB,aAAa7U,YAAY5V,EAAKyqB,aAAenvB,KAAKmvB,aAAamwC,OAAQ4xB,GAAOlvF,MAExGhC,KAAKgvB,aAAehvB,KAAKgvB,YAAY1U,YAAY5V,EAAKsqB,YAAchvB,KAAKgvB,YAAYswC,OAAQ4xB,GAAOlvF,MACpGhC,KAAKkW,aAAelW,KAAKkW,YAAYoE,YAAY5V,EAAKwR,YAAclW,KAAKkW,YAAYopD,OAAQ4xB,GAAOlvF,MAEpGhC,KAAKoW,QAAUpW,KAAKoW,OAAOkE,YAE/B5V,EAAK0R,OAASpW,KAAKoW,OAAOkpD,OAAQ4xB,GAAOlvF,KACzC0C,EAAK6R,aAAevW,KAAKuW,cAIrBvW,KAAKyvB,aAAezvB,KAAKyvB,YAAYnV,YAEzC5V,EAAK+qB,YAAczvB,KAAKyvB,YAAY6vC,OAAQ4xB,GAAOlvF,MAIjClB,SAAdd,KAAKinB,OAAqBviB,EAAKuiB,KAAOjnB,KAAKinB,MAClBnmB,SAAzBd,KAAKwvB,kBAAgC9qB,EAAK8qB,gBAAkBxvB,KAAKwvB,iBAEjExvB,KAAKyT,WAAaC,KAAiBhP,EAAK+O,SAAWzT,KAAKyT,UACxDzT,KAAK6T,eAAgB,IAAOnP,EAAKmP,YAAc7T,KAAK6T,aACpD7T,KAAK2T,OAASC,KAAYlP,EAAKiP,KAAO3T,KAAK2T,MAC3C3T,KAAKuN,eAAiBuG,KAAWpP,EAAK6I,aAAevN,KAAKuN,cAE1DvN,KAAK+T,QAAU,IAAIrP,EAAKqP,QAAU/T,KAAK+T,SACvC/T,KAAKgU,eAAgB,IAAOtP,EAAKsP,YAAchU,KAAKgU,aAEzDtP,EAAKgQ,UAAY1U,KAAK0U,UACtBhQ,EAAKkQ,UAAY5U,KAAK4U,UACtBlQ,EAAKmQ,WAAa7U,KAAK6U,WAGA,IAAlB7U,KAAK+C,WAAiB2B,EAAK3B,SAAW/C,KAAK+C,UAExB,IAAnB/C,KAAKoX,YAAkB1S,EAAK0S,UAAYpX,KAAKoX,WAC3BtW,SAAlBd,KAAK0lD,WAAyBhhD,EAAKghD,SAAW1lD,KAAK0lD,UAClC5kD,SAAjBd,KAAK4lD,UAAwBlhD,EAAKkhD,QAAU5lD,KAAK4lD,SAClC9kD,SAAfd,KAAK+K,QAAsBrG,EAAKqG,MAAQ/K,KAAK+K,OAE7C/K,KAAKuV,aAAc,IAAO7Q,EAAK6Q,WAAY,GAE3CvV,KAAKwV,UAAY,IAAI9Q,EAAK8Q,UAAYxV,KAAKwV,WAC3CxV,KAAKyV,sBAAuB,IAAO/Q,EAAK+Q,mBAAqBzV,KAAKyV,oBAElEzV,KAAKyW,aAAc,IAAO/R,EAAK+R,UAAYzW,KAAKyW,WAChDzW,KAAK0W,mBAAqB,IAAIhS,EAAKgS,mBAAqB1W,KAAK0W,oBACnC,UAA1B1W,KAAK2W,mBAA+BjS,EAAKiS,iBAAmB3W,KAAK2W,kBACtC,UAA3B3W,KAAK4W,oBAAgClS,EAAKkS,kBAAoB5W,KAAK4W,mBAEnE5W,KAAK8N,gBAAiB,IAAOpJ,EAAKoJ,cAAe,GACjD9N,KAAK6W,YAAa,IAAOnS,EAAKmS,UAAW,GAEzC7W,KAAKyL,WAAY,IAAQ/G,EAAK+G,SAAU,GACJ,OAApC0hG,KAAKC,UAAWptG,KAAK8L,YAAsBpH,EAAKoH,SAAW9L,KAAK8L,UAoBhEmpG,EAAS,CAEb,GAAI9yF,GAAW+qF,EAAkBhc,EAAK/uE,UAClCqB,EAAS0pF,EAAkBhc,EAAK1tE,OAE/BrB,GAAS/hB,OAAS,IAAIsE,EAAKyd,SAAWA,GACtCqB,EAAOpjB,OAAS,IAAIsE,EAAK8e,OAASA,GAIxC,MAAO9e,IAIRmG,MAAO,WAEN,OAAO,GAAI7K,MAAKuqE,aAAc3rD,KAAM5e,OAIrC4e,KAAM,SAAW8/D,GAEhB1+E,KAAKmC,KAAOu8E,EAAOv8E,KAEnBnC,KAAKuT,IAAMmrE,EAAOnrE,IAClBvT,KAAKwT,OAASkrE,EAAOlrE,OAErBxT,KAAKyT,SAAWirE,EAAOjrE,SACvBzT,KAAK2T,KAAO+qE,EAAO/qE,KACnB3T,KAAK6T,YAAc6qE,EAAO7qE,YAC1B7T,KAAKuN,aAAemxE,EAAOnxE,aAE3BvN,KAAK+T,QAAU2qE,EAAO3qE,QACtB/T,KAAKgU,YAAc0qE,EAAO1qE,YAE1BhU,KAAKiU,SAAWyqE,EAAOzqE,SACvBjU,KAAKmU,SAAWuqE,EAAOvqE,SACvBnU,KAAKqU,cAAgBqqE,EAAOrqE,cAC5BrU,KAAKuU,cAAgBmqE,EAAOnqE,cAC5BvU,KAAKwU,cAAgBkqE,EAAOlqE,cAC5BxU,KAAKyU,mBAAqBiqE,EAAOjqE,mBAEjCzU,KAAK0U,UAAYgqE,EAAOhqE,UACxB1U,KAAK4U,UAAY8pE,EAAO9pE,UACxB5U,KAAK6U,WAAa6pE,EAAO7pE,WAEzB7U,KAAKkV,WAAawpE,EAAOxpE,WAEzBlV,KAAKmV,UAAYupE,EAAOvpE,UAExBnV,KAAKoV,cAAgBspE,EAAOtpE,cAC5BpV,KAAKqV,oBAAsBqpE,EAAOrpE,oBAClCrV,KAAKsV,mBAAqBopE,EAAOppE,mBAEjCtV,KAAKuV,UAAYmpE,EAAOnpE,UAExBvV,KAAKwV,UAAYkpE,EAAOlpE,UACxBxV,KAAKyV,mBAAqBipE,EAAOjpE,mBAEjCzV,KAAK0V,SAAWgpE,EAAOhpE,SAEvB1V,KAAKyL,QAAUizE,EAAOjzE,QACtBzL,KAAK8L,SAAWqhG,KAAKvgC,MAAOugC,KAAKC,UAAW1uB,EAAO5yE,WAEnD9L,KAAKgV,YAAc0pE,EAAO1pE,YAC1BhV,KAAK+U,iBAAmB2pE,EAAO3pE,gBAE/B,IAAImgG,GAAYx2B,EAAO5pE,eACtBqgG,EAAY,IAEb,IAAmB,OAAdD,EAAqB,CAEzB,GAAIlxF,GAAIkxF,EAAU90G,MAClB+0G,GAAY,GAAI/nG,OAAO4W,EAEvB,KAAM,GAAIhU,GAAI,EAAGA,IAAMgU,IAAMhU,EAC5BmlG,EAAWnlG,GAAMklG,EAAWllG,GAAInF,QAQlC,MAJA7K,MAAK8U,eAAiBqgG,EAEtBn1G,KAAKiV,WAAaypE,EAAOzpE,WAElBjV,MAIRsjB,QAAS,WAERtjB,KAAK24C,eAAiBl3C,KAAM,eAgF9BmU,EAAkB69D,UAAY7xE,OAAOqvF,OAAQ59E,EAASogE,WACtD79D,EAAkB69D,UAAUlJ,YAAc30D,EAE1CA,EAAkB69D,UAAU9wB,qBAAsB,EAElD/sC,EAAkB69D,UAAU70D,KAAO,SAAW8/D,GA+B7C,MA7BArrE,GAASogE,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAEpC1+E,KAAKgN,MAAM4R,KAAM8/D,EAAO1xE,OAExBhN,KAAK6V,IAAM6oE,EAAO7oE,IAElB7V,KAAK8V,SAAW4oE,EAAO5oE,SACvB9V,KAAK+V,kBAAoB2oE,EAAO3oE,kBAEhC/V,KAAKgW,MAAQ0oE,EAAO1oE,MACpBhW,KAAKiW,eAAiByoE,EAAOzoE,eAE7BjW,KAAKkW,YAAcwoE,EAAOxoE,YAE1BlW,KAAKmW,SAAWuoE,EAAOvoE,SAEvBnW,KAAKoW,OAASsoE,EAAOtoE,OACrBpW,KAAKqW,QAAUqoE,EAAOroE,QACtBrW,KAAKuW,aAAemoE,EAAOnoE,aAC3BvW,KAAKwW,gBAAkBkoE,EAAOloE,gBAE9BxW,KAAKyW,UAAYioE,EAAOjoE,UACxBzW,KAAK0W,mBAAqBgoE,EAAOhoE,mBACjC1W,KAAK2W,iBAAmB+nE,EAAO/nE,iBAC/B3W,KAAK4W,kBAAoB8nE,EAAO9nE,kBAEhC5W,KAAK6W,SAAW6nE,EAAO7nE,SACvB7W,KAAK8N,aAAe4wE,EAAO5wE,aAEpB9N,MAkFR+W,EAAe08D,UAAY7xE,OAAOqvF,OAAQ59E,EAASogE,WACnD18D,EAAe08D,UAAUlJ,YAAcxzD,EAEvCA,EAAe08D,UAAUtjD,kBAAmB,EAE5CpZ,EAAe08D,UAAU70D,KAAO,SAAW8/D,GAwB1C,MAtBArrE,GAASogE,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAEpC1+E,KAAKmX,eAAiBunE,EAAOvnE,eAC7BnX,KAAKkX,aAAewnE,EAAOxnE,aAE3BlX,KAAKiX,SAAW6pC,GAAcj2C,MAAO6zE,EAAOznE,UAE5CjX,KAAKgX,QAAUpV,OAAO48E,UAAYE,EAAO1nE,SAEzChX,KAAKyW,UAAYioE,EAAOjoE,UACxBzW,KAAK0W,mBAAqBgoE,EAAOhoE,mBAEjC1W,KAAKwT,OAASkrE,EAAOlrE,OACrBxT,KAAKqX,SAAWqnE,EAAOrnE,SAEvBrX,KAAK6W,SAAW6nE,EAAO7nE,SAEvB7W,KAAK8N,aAAe4wE,EAAO5wE,aAC3B9N,KAAK+N,aAAe2wE,EAAO3wE,aAE3B/N,KAAKsX,WAAaonE,EAAOpnE,WAElBtX,MAIR+W,EAAe08D,UAAUnU,OAAS,SAAW4xB,GAE5C,GAAIxsF,GAAO2O,EAASogE,UAAUnU,OAAOh7D,KAAMtE,KAAMkxF,EAEjDxsF,GAAKuS,WAEL,KAAM,GAAI9U,KAAQnC,MAAKiX,SAAW,CAEjC,GAAI2G,GAAU5d,KAAKiX,SAAU9U,GACzBL,EAAQ8b,EAAQ9b,KAEfA,GAAMwY,UAEV5V,EAAKuS,SAAU9U,IACdV,KAAM,IACNK,MAAOA,EAAMw9D,OAAQ4xB,GAAOlvF,MAGlBF,EAAMwL,QAEjB5I,EAAKuS,SAAU9U,IACdV,KAAM,IACNK,MAAOA,EAAM2mG,UAGH3mG,EAAMggF,UAEjBp9E,EAAKuS,SAAU9U,IACdV,KAAM,KACNK,MAAOA,EAAMgd,WAGHhd,EAAMoL,UAEjBxI,EAAKuS,SAAU9U,IACdV,KAAM,KACNK,MAAOA,EAAMgd,WAGHhd,EAAM0vF,UAEjB9sF,EAAKuS,SAAU9U,IACdV,KAAM,KACNK,MAAOA,EAAMgd,WAGHhd,EAAM6hF,UAEjBj/E,EAAKuS,SAAU9U,IACdV,KAAM,KACNK,MAAOA,EAAMgd,WAKdpa,EAAKuS,SAAU9U,IACdL,MAAOA,GAcV,MALKF,QAAO+sD,KAAM3uD,KAAKgX,SAAU5W,OAAS,IAAIsE,EAAKsS,QAAUhX,KAAKgX,SAElEtS,EAAKwS,aAAelX,KAAKkX;AACzBxS,EAAKyS,eAAiBnX,KAAKmX,eAEpBzS,GAeR9C,OAAO48E,OAAQxmE,EAAIy7D,WAElBxtE,IAAK,SAAWgS,EAAQC,GAKvB,MAHAlY,MAAKiY,OAAO2G,KAAM3G,GAClBjY,KAAKkY,UAAU0G,KAAM1G,GAEdlY,MAIR6K,MAAO,WAEN,OAAO,GAAI7K,MAAKuqE,aAAc3rD,KAAM5e,OAIrC4e,KAAM,SAAWo4D,GAKhB,MAHAh3E,MAAKiY,OAAO2G,KAAMo4D,EAAI/+D,QACtBjY,KAAKkY,UAAU0G,KAAMo4D,EAAI9+D,WAElBlY,MAIRo1G,GAAI,SAAWhjD,EAAGnyC,GASjB,MAPgBnf,UAAXmf,IAEJ5f,QAAQ4H,KAAM,2CACdgY,EAAS,GAAIlf,IAIPkf,EAAOrB,KAAM5e,KAAKkY,WAAYggB,eAAgBk6B,GAAI/yB,IAAKr/B,KAAKiY,SAIpE+mB,OAAQ,SAAW7tB,GAIlB,MAFAnR,MAAKkY,UAAU0G,KAAMzN,GAAIknB,IAAKr4B,KAAKiY,QAAS0hB,YAErC35B,MAIRq1G,OAAQ,WAEP,GAAIztC,GAAK,GAAI7mE,EAEb,OAAO,UAAiBqxD,GAIvB,MAFApyD,MAAKiY,OAAO2G,KAAM5e,KAAKo1G,GAAIhjD,EAAGwV,IAEvB5nE,SAMTs1G,oBAAqB,SAAW7gF,EAAOxU,GAEtBnf,SAAXmf,IAEJ5f,QAAQ4H,KAAM,4DACdgY,EAAS,GAAIlf,IAIdkf,EAAOwvC,WAAYh7B,EAAOz0B,KAAKiY,OAE/B,IAAIs9F,GAAoBt1F,EAAOuiD,IAAKxiE,KAAKkY,UAEzC,OAAKq9F,GAAoB,EAEjBt1F,EAAOrB,KAAM5e,KAAKiY,QAInBgI,EAAOrB,KAAM5e,KAAKkY,WAAYggB,eAAgBq9E,GAAoBl2E,IAAKr/B,KAAKiY,SAIpF67E,gBAAiB,SAAWr/D,GAE3B,MAAO9hB,MAAKmwC,KAAM9iD,KAAKw1G,kBAAmB/gF,KAI3C+gF,kBAAmB,WAElB,GAAI5tC,GAAK,GAAI7mE,EAEb,OAAO,UAA4B0zB,GAElC,GAAI8gF,GAAoB3tC,EAAGnY,WAAYh7B,EAAOz0B,KAAKiY,QAASuqD,IAAKxiE,KAAKkY,UAItE,OAAKq9F,GAAoB,EAEjBv1G,KAAKiY,OAAOmrE,kBAAmB3uD,IAIvCmzC,EAAGhpD,KAAM5e,KAAKkY,WAAYggB,eAAgBq9E,GAAoBl2E,IAAKr/B,KAAKiY,QAEjE2vD,EAAGwb,kBAAmB3uD,QAM/BghF,oBAAqB,WAEpB,GAAIC,GAAY,GAAI30G,GAChB40G,EAAS,GAAI50G,GACb6vG,EAAO,GAAI7vG,EAEf,OAAO,UAA8B4mE,EAAIC,EAAIguC,EAAoBC,GAShEH,EAAU92F,KAAM+oD,GAAKtoC,IAAKuoC,GAAK1vC,eAAgB,IAC/Cy9E,EAAO/2F,KAAMgpD,GAAKvvC,IAAKsvC,GAAKhuC,YAC5Bi3E,EAAKhyF,KAAM5e,KAAKiY,QAASogB,IAAKq9E,EAE9B,IAMII,GAAInpB,EAAIopB,EAASC,EANjBC,EAAkC,GAAtBtuC,EAAGwb,WAAYvb,GAC3BsuC,GAAQl2G,KAAKkY,UAAUsqD,IAAKmzC,GAC5BQ,EAAKvF,EAAKpuC,IAAKxiE,KAAKkY,WACpB8oE,GAAO4vB,EAAKpuC,IAAKmzC,GACjB5oG,EAAI6jG,EAAK3tB,WACToG,EAAM12E,KAAK4P,IAAK,EAAI2zF,EAAMA,EAG9B,IAAK7sB,EAAM,EAQV,GAJAysB,EAAKI,EAAMl1B,EAAKm1B,EAChBxpB,EAAKupB,EAAMC,EAAKn1B,EAChBg1B,EAASC,EAAY5sB,EAEhBysB,GAAM,EAEV,GAAKnpB,IAAQqpB,EAEZ,GAAKrpB,GAAMqpB,EAAS,CAKnB,GAAII,GAAS,EAAI/sB,CACjBysB,IAAMM,EACNzpB,GAAMypB,EACNL,EAAUD,GAAOA,EAAKI,EAAMvpB,EAAK,EAAIwpB,GAAOxpB,GAAOupB,EAAMJ,EAAKnpB,EAAK,EAAI3L,GAAOj0E,MAM9E4/E,GAAKspB,EACLH,EAAKnjG,KAAK7N,IAAK,IAAOoxG,EAAMvpB,EAAKwpB,IACjCJ,GAAYD,EAAKA,EAAKnpB,GAAOA,EAAK,EAAI3L,GAAOj0E,MAQ9C4/E,IAAOspB,EACPH,EAAKnjG,KAAK7N,IAAK,IAAOoxG,EAAMvpB,EAAKwpB,IACjCJ,GAAYD,EAAKA,EAAKnpB,GAAOA,EAAK,EAAI3L,GAAOj0E,MAMzC4/E,KAAQqpB,GAIZF,EAAKnjG,KAAK7N,IAAK,KAASoxG,EAAMD,EAAYE,IAC1CxpB,EAAOmpB,EAAK,GAAQG,EAAYtjG,KAAK9N,IAAK8N,KAAK7N,KAAOmxG,GAAaj1B,GAAMi1B,GACzEF,GAAYD,EAAKA,EAAKnpB,GAAOA,EAAK,EAAI3L,GAAOj0E,GAElC4/E,GAAMqpB,GAIjBF,EAAK,EACLnpB,EAAKh6E,KAAK9N,IAAK8N,KAAK7N,KAAOmxG,GAAaj1B,GAAMi1B,GAC9CF,EAAUppB,GAAOA,EAAK,EAAI3L,GAAOj0E,IAMjC+oG,EAAKnjG,KAAK7N,IAAK,IAAOoxG,EAAMD,EAAYE,IACxCxpB,EAAOmpB,EAAK,EAAMG,EAAYtjG,KAAK9N,IAAK8N,KAAK7N,KAAOmxG,GAAaj1B,GAAMi1B,GACvEF,GAAYD,EAAKA,EAAKnpB,GAAOA,EAAK,EAAI3L,GAAOj0E,OAU/C4/E,GAAOupB,EAAM,GAAQD,EAAYA,EACjCH,EAAKnjG,KAAK7N,IAAK,IAAOoxG,EAAMvpB,EAAKwpB,IACjCJ,GAAYD,EAAKA,EAAKnpB,GAAOA,EAAK,EAAI3L,GAAOj0E,CAgB9C,OAZK6oG,IAEJA,EAAmBh3F,KAAM5e,KAAKkY,WAAYggB,eAAgB49E,GAAKz2E,IAAKr/B,KAAKiY,QAIrE49F,GAEJA,EAAuBj3F,KAAM+2F,GAASz9E,eAAgBy0D,GAAKttD,IAAKq2E,GAI1DK,MAMTM,gBAAiB,WAEhB,GAAIzuC,GAAK,GAAI7mE,EAEb,OAAO,UAA0BkyF,EAAQhzE,GAExC2nD,EAAGnY,WAAYwjC,EAAOnwF,OAAQ9C,KAAKiY,OACnC,IAAIq+F,GAAM1uC,EAAGpF,IAAKxiE,KAAKkY,WACnBwoE,EAAK9Y,EAAGpF,IAAKoF,GAAO0uC,EAAMA,EAC1BC,EAAUtjB,EAAOhuF,OAASguF,EAAOhuF,MAErC,IAAKy7E,EAAK61B,EAAU,MAAO,KAE3B,IAAIC,GAAM7jG,KAAKmwC,KAAMyzD,EAAU71B,GAG3Bla,EAAK8vC,EAAME,EAGX/vC,EAAK6vC,EAAME,CAGf,OAAKhwC,GAAK,GAAKC,EAAK,EAAW,KAK1BD,EAAK,EAAWxmE,KAAKo1G,GAAI3uC,EAAIxmD,GAG3BjgB,KAAKo1G,GAAI5uC,EAAIvmD,OAMtB8yE,iBAAkB,SAAWE,GAE5B,MAAOjzF,MAAK8zF,gBAAiBb,EAAOnwF,SAAYmwF,EAAOhuF,QAIxDwxG,gBAAiB,SAAW93F,GAE3B,GAAIs2E,GAAct2E,EAAMxZ,OAAOq9D,IAAKxiE,KAAKkY,UAEzC,IAAqB,IAAhB+8E,EAGJ,MAA8C,KAAzCt2E,EAAMm1E,gBAAiB9zF,KAAKiY,QAEzB,EAMD,IAIR,IAAIm6C,KAAQpyD,KAAKiY,OAAOuqD,IAAK7jD,EAAMxZ,QAAWwZ,EAAMvZ,UAAa6vF,CAIjE,OAAO7iC,IAAK,EAAIA,EAAI,MAIrBskD,eAAgB,SAAW/3F,EAAOsB,GAEjC,GAAImyC,GAAIpyD,KAAKy2G,gBAAiB93F,EAE9B,OAAW,QAANyzC,EAEG,KAIDpyD,KAAKo1G,GAAIhjD,EAAGnyC,IAIpBkzE,gBAAiB,SAAWx0E,GAI3B,GAAIg4F,GAAch4F,EAAMm1E,gBAAiB9zF,KAAKiY,OAE9C,IAAqB,IAAhB0+F,EAEJ,OAAO,CAIR,IAAI1hB,GAAct2E,EAAMxZ,OAAOq9D,IAAKxiE,KAAKkY,UAEzC,OAAK+8E,GAAc0hB,EAAc,GAYlCC,aAAc,SAAW57B,EAAK/6D,GAE7B,GAAI42F,GAAMC,EAAMC,EAAOC,EAAOC,EAAOC,EAEjCC,EAAU,EAAIn3G,KAAKkY,UAAUpY,EAChCs3G,EAAU,EAAIp3G,KAAKkY,UAAUnY,EAC7Bs3G,EAAU,EAAIr3G,KAAKkY,UAAU1X,EAE1ByX,EAASjY,KAAKiY,MA0BlB,OAxBKk/F,IAAW,GAEfN,GAAS77B,EAAIn2E,IAAI/E,EAAImY,EAAOnY,GAAMq3G,EAClCL,GAAS97B,EAAIl2E,IAAIhF,EAAImY,EAAOnY,GAAMq3G,IAIlCN,GAAS77B,EAAIl2E,IAAIhF,EAAImY,EAAOnY,GAAMq3G,EAClCL,GAAS97B,EAAIn2E,IAAI/E,EAAImY,EAAOnY,GAAMq3G,GAI9BC,GAAW,GAEfL,GAAU/7B,EAAIn2E,IAAI9E,EAAIkY,EAAOlY,GAAMq3G,EACnCJ,GAAUh8B,EAAIl2E,IAAI/E,EAAIkY,EAAOlY,GAAMq3G,IAInCL,GAAU/7B,EAAIl2E,IAAI/E,EAAIkY,EAAOlY,GAAMq3G,EACnCJ,GAAUh8B,EAAIn2E,IAAI9E,EAAIkY,EAAOlY,GAAMq3G,GAI7BP,EAAOG,GAAaD,EAAQD,EAAgB,OAK9CC,EAAQF,GAAQA,IAASA,KAAOA,EAAOE,IAEvCC,EAAQF,GAAQA,IAASA,KAAOA,EAAOE,GAEvCK,GAAW,GAEfJ,GAAUj8B,EAAIn2E,IAAIrE,EAAIyX,EAAOzX,GAAM62G,EACnCH,GAAUl8B,EAAIl2E,IAAItE,EAAIyX,EAAOzX,GAAM62G,IAInCJ,GAAUj8B,EAAIl2E,IAAItE,EAAIyX,EAAOzX,GAAM62G,EACnCH,GAAUl8B,EAAIn2E,IAAIrE,EAAIyX,EAAOzX,GAAM62G,GAI7BR,EAAOK,GAAaD,EAAQH,EAAgB,OAE9CG,EAAQJ,GAAQA,IAASA,KAAOA,EAAOI,IAEvCC,EAAQJ,GAAQA,IAASA,KAAOA,EAAOI,GAIvCJ,EAAO,EAAW,KAEhB92G,KAAKo1G,GAAIyB,GAAQ,EAAIA,EAAOC,EAAM72F,MAI1C6yE,cAAe,WAEd,GAAI3hF,GAAI,GAAIpQ,EAEZ,OAAO,UAAwBi6E,GAE9B,MAAuC,QAAhCh7E,KAAK42G,aAAc57B,EAAK7pE,OAMjCmmG,kBAAmB,WAGlB,GAAI1G,GAAO,GAAI7vG,GACXutD,EAAQ,GAAIvtD,GACZwtD,EAAQ,GAAIxtD,GACZoE,EAAS,GAAIpE,EAEjB,OAAO,UAA4B+L,EAAG9G,EAAG+G,EAAGwqG,EAAiBt3F,GAI5DquC,EAAMmB,WAAYzpD,EAAG8G,GACrByhD,EAAMkB,WAAY1iD,EAAGD,GACrB3H,EAAOuqD,aAAcpB,EAAOC,EAO5B,IACIwN,GADAy7C,EAAMx3G,KAAKkY,UAAUsqD,IAAKr9D,EAG9B,IAAKqyG,EAAM,EAAI,CAEd,GAAKD,EAAkB,MAAO,KAC9Bx7C,GAAO,MAED,CAAA,KAAKy7C,EAAM,GAOjB,MAAO,KALPz7C,MACAy7C,GAAQA,EAQT5G,EAAKnhD,WAAYzvD,KAAKiY,OAAQnL,EAC9B,IAAI2qG,GAAS17C,EAAO/7D,KAAKkY,UAAUsqD,IAAKjU,EAAMmB,aAAckhD,EAAMriD,GAGlE,IAAKkpD,EAAS,EAEb,MAAO,KAIR,IAAIC,GAAS37C,EAAO/7D,KAAKkY,UAAUsqD,IAAKlU,EAAM00B,MAAO4tB,GAGrD,IAAK8G,EAAS,EAEb,MAAO,KAKR,IAAKD,EAASC,EAASF,EAEtB,MAAO,KAKR,IAAIG,IAAQ57C,EAAO60C,EAAKpuC,IAAKr9D,EAG7B,OAAKwyG,GAAM,EAEH,KAKD33G,KAAKo1G,GAAIuC,EAAMH,EAAKv3F,OAM7BpB,aAAc,SAAWua,GAKxB,MAHAp5B,MAAKiY,OAAO4G,aAAcua,GAC1Bp5B,KAAKkY,UAAUogB,mBAAoBc,GAE5Bp5B,MAIRkgC,OAAQ,SAAW82C,GAElB,MAAOA,GAAI/+D,OAAOioB,OAAQlgC,KAAKiY,SAAY++D,EAAI9+D,UAAUgoB,OAAQlgC,KAAKkY,cAmBxEtW,OAAO48E,OAAQrmE,GAEdy/F,UAAW,WAEV,GAAIjwC,GAAK,GAAI5mE,EAEb,OAAO,UAAoB+L,EAAG9G,EAAG+G,EAAGkT,GAEnBnf,SAAXmf,IAEJ5f,QAAQ4H,KAAM,uDACdgY,EAAS,GAAIlf,IAIdkf,EAAOwvC,WAAY1iD,EAAG/G,GACtB2hE,EAAGlY,WAAY3iD,EAAG9G,GAClBia,EAAO+iE,MAAOrb,EAEd,IAAIkwC,GAAiB53F,EAAOgjE,UAC5B,OAAK40B,GAAiB,EAEd53F,EAAOiY,eAAgB,EAAIvlB,KAAKmwC,KAAM+0D,IAIvC53F,EAAOha,IAAK,EAAG,EAAG,OAQ3B6xG,aAAc,WAEb,GAAInwC,GAAK,GAAI5mE,GACT6mE,EAAK,GAAI7mE,GACTwnE,EAAK,GAAIxnE,EAEb,OAAO,UAAuB0zB,EAAO3nB,EAAG9G,EAAG+G,EAAGkT,GAE7C0nD,EAAGlY,WAAY1iD,EAAGD,GAClB86D,EAAGnY,WAAYzpD,EAAG8G,GAClBy7D,EAAG9Y,WAAYh7B,EAAO3nB,EAEtB,IAAIirG,GAAQpwC,EAAGnF,IAAKmF,GAChBqwC,EAAQrwC,EAAGnF,IAAKoF,GAChBqwC,EAAQtwC,EAAGnF,IAAK+F,GAChB2vC,EAAQtwC,EAAGpF,IAAKoF,GAChBuwC,EAAQvwC,EAAGpF,IAAK+F,GAEhB6vC,EAAUL,EAAQG,EAAQF,EAAQA,CAUtC,IARgBl3G,SAAXmf,IAEJ5f,QAAQ4H,KAAM,0DACdgY,EAAS,GAAIlf,IAKC,IAAVq3G,EAIJ,MAAOn4F,GAAOha,aAIf,IAAIoyG,GAAW,EAAID,EACflnG,GAAMgnG,EAAQD,EAAQD,EAAQG,GAAUE,EACxClnG,GAAM4mG,EAAQI,EAAQH,EAAQC,GAAUI,CAG5C,OAAOp4F,GAAOha,IAAK,EAAIiL,EAAIC,EAAGA,EAAGD,OAMnC0hF,cAAe,WAEd,GAAIhrB,GAAK,GAAI7mE,EAEb,OAAO,UAAwB0zB,EAAO3nB,EAAG9G,EAAG+G,GAI3C,MAFAoL,GAAS2/F,aAAcrjF,EAAO3nB,EAAG9G,EAAG+G,EAAG66D,GAE9BA,EAAG9nE,GAAK,GAAS8nE,EAAG7nE,GAAK,GAAW6nE,EAAG9nE,EAAI8nE,EAAG7nE,GAAO,QAQjE6B,OAAO48E,OAAQrmE,EAASs7D,WAEvBxtE,IAAK,SAAW6G,EAAG9G,EAAG+G,GAMrB,MAJA/M,MAAK8M,EAAE8R,KAAM9R,GACb9M,KAAKgG,EAAE4Y,KAAM5Y,GACbhG,KAAK+M,EAAE6R,KAAM7R,GAEN/M,MAIRs4G,wBAAyB,SAAWr2F,EAAQs2F,EAAIC,EAAIC,GAMnD,MAJAz4G,MAAK8M,EAAE8R,KAAMqD,EAAQs2F,IACrBv4G,KAAKgG,EAAE4Y,KAAMqD,EAAQu2F,IACrBx4G,KAAK+M,EAAE6R,KAAMqD,EAAQw2F,IAEdz4G,MAIR6K,MAAO,WAEN,OAAO,GAAI7K,MAAKuqE,aAAc3rD,KAAM5e,OAIrC4e,KAAM,SAAWi1E,GAMhB,MAJA7zF,MAAK8M,EAAE8R,KAAMi1E,EAAS/mF,GACtB9M,KAAKgG,EAAE4Y,KAAMi1E,EAAS7tF,GACtBhG,KAAK+M,EAAE6R,KAAMi1E,EAAS9mF,GAEf/M,MAIR04G,QAAS,WAER,GAAI/wC,GAAK,GAAI5mE,GACT6mE,EAAK,GAAI7mE,EAEb,OAAO,YAKN,MAHA4mE,GAAGlY,WAAYzvD,KAAK+M,EAAG/M,KAAKgG,GAC5B4hE,EAAGnY,WAAYzvD,KAAK8M,EAAG9M,KAAKgG,GAEK,GAA1B2hE,EAAGqb,MAAOpb,GAAKxnE,aAMxBu4G,YAAa,SAAW14F,GASvB,MAPgBnf,UAAXmf,IAEJ5f,QAAQ4H,KAAM,yDACdgY,EAAS,GAAIlf,IAIPkf,EAAOs0C,WAAYv0D,KAAK8M,EAAG9M,KAAKgG,GAAIq5B,IAAKr/B,KAAK+M,GAAImrB,eAAgB,EAAI,IAI9E0/E,UAAW,SAAW33F,GAErB,MAAO9H,GAASy/F,UAAW53G,KAAK8M,EAAG9M,KAAKgG,EAAGhG,KAAK+M,EAAGkT,IAIpD24F,SAAU,SAAW34F,GASpB,MAPgBnf,UAAXmf,IAEJ5f,QAAQ4H,KAAM,sDACdgY,EAAS,GAAIlf,IAIPkf,EAAO00E,sBAAuB30F,KAAK8M,EAAG9M,KAAKgG,EAAGhG,KAAK+M,IAI3D+qG,aAAc,SAAWrjF,EAAOxU,GAE/B,MAAO9H,GAAS2/F,aAAcrjF,EAAOz0B,KAAK8M,EAAG9M,KAAKgG,EAAGhG,KAAK+M,EAAGkT,IAI9D2yE,cAAe,SAAWn+D,GAEzB,MAAOtc,GAASy6E,cAAen+D,EAAOz0B,KAAK8M,EAAG9M,KAAKgG,EAAGhG,KAAK+M,IAI5D+lF,cAAe,SAAW9X,GAEzB,MAAOA,GAAIoY,mBAAoBpzF,OAIhCs1G,oBAAqB,WAEpB,GAAIuD,GAAM,GAAI93G,GACV+3G,EAAM,GAAI/3G,GACVg4G,EAAM,GAAIh4G,GACVi4G,EAAM,GAAIj4G,GACVk4G,EAAM,GAAIl4G,GACVm4G,EAAM,GAAIn4G,EAEd,OAAO,UAA8Bo0B,EAAGlV,GAEvBnf,SAAXmf,IAEJ5f,QAAQ4H,KAAM,iEACdgY,EAAS,GAAIlf,GAId,IACIoQ,GAAG1Q,EADHqM,EAAI9M,KAAK8M,EAAG9G,EAAIhG,KAAKgG,EAAG+G,EAAI/M,KAAK+M,CASrC8rG,GAAIppD,WAAYzpD,EAAG8G,GACnBgsG,EAAIrpD,WAAY1iD,EAAGD,GACnBksG,EAAIvpD,WAAYt6B,EAAGroB,EACnB,IAAI2zE,GAAKo4B,EAAIr2C,IAAKw2C,GACdt4B,EAAKo4B,EAAIt2C,IAAKw2C,EAClB,IAAKv4B,GAAM,GAAKC,GAAM,EAGrB,MAAOzgE,GAAOrB,KAAM9R,EAIrBmsG,GAAIxpD,WAAYt6B,EAAGnvB,EACnB,IAAI26E,GAAKk4B,EAAIr2C,IAAKy2C,GACdE,EAAKL,EAAIt2C,IAAKy2C,EAClB,IAAKt4B,GAAM,GAAKw4B,GAAMx4B,EAGrB,MAAO1gE,GAAOrB,KAAM5Y,EAIrB,IAAIozG,GAAK34B,EAAK04B,EAAKx4B,EAAKD,CACxB,IAAK04B,GAAM,GAAK34B,GAAM,GAAKE,GAAM,EAIhC,MAFAxvE,GAAIsvE,GAAOA,EAAKE,GAET1gE,EAAOrB,KAAM9R,GAAIw1E,gBAAiBu2B,EAAK1nG,EAI/C+nG,GAAIzpD,WAAYt6B,EAAGpoB,EACnB,IAAIssG,GAAKR,EAAIr2C,IAAK02C,GACdI,EAAKR,EAAIt2C,IAAK02C,EAClB,IAAKI,GAAM,GAAKD,GAAMC,EAGrB,MAAOr5F,GAAOrB,KAAM7R,EAIrB,IAAIwsG,GAAKF,EAAK34B,EAAKD,EAAK64B,CACxB,IAAKC,GAAM,GAAK74B,GAAM,GAAK44B,GAAM,EAIhC,MAFA74G,GAAIigF,GAAOA,EAAK44B,GAETr5F,EAAOrB,KAAM9R,GAAIw1E,gBAAiBw2B,EAAKr4G,EAI/C,IAAI+4G,GAAK74B,EAAK24B,EAAKD,EAAKF,CACxB,IAAKK,GAAM,GAAOL,EAAKx4B,GAAQ,GAAO04B,EAAKC,GAAQ,EAKlD,MAHAP,GAAItpD,WAAY1iD,EAAG/G,GACnBvF,GAAM04G,EAAKx4B,IAAWw4B,EAAKx4B,GAAS04B,EAAKC,IAElCr5F,EAAOrB,KAAM5Y,GAAIs8E,gBAAiBy2B,EAAKt4G,EAK/C,IAAI23G,GAAQ,GAAMoB,EAAKD,EAAKH,EAI5B,OAFAjoG,GAAIooG,EAAKnB,EACT33G,EAAI24G,EAAKhB,EACFn4F,EAAOrB,KAAM9R,GAAIw1E,gBAAiBu2B,EAAK1nG,GAAImxE,gBAAiBw2B,EAAKr4G,OAM1Ey/B,OAAQ,SAAW2zD,GAElB,MAAOA,GAAS/mF,EAAEozB,OAAQlgC,KAAK8M,IAAO+mF,EAAS7tF,EAAEk6B,OAAQlgC,KAAKgG,IAAO6tF,EAAS9mF,EAAEmzB,OAAQlgC,KAAK+M,MA4B/FqL,EAAKq7D,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQ/mF,EAASupE,YAEvDlJ,YAAanyD,EAEbqkB,QAAQ,EAERg9E,YAAa,SAAW33G,GAEvB9B,KAAKwY,SAAW1W,GAIjB8c,KAAM,SAAW8/D,GAkBhB,MAhBAx0E,GAASupE,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAEpC1+E,KAAKwY,SAAWkmE,EAAOlmE,SAEe1X,SAAjC49E,EAAO/7D,wBAEX3iB,KAAK2iB,sBAAwB+7D,EAAO/7D,sBAAsBkqC,SAIrB/rD,SAAjC49E,EAAOg7B,wBAEX15G,KAAK05G,sBAAwB93G,OAAO48E,UAAYE,EAAOg7B,wBAIjD15G,MAIR0Y,mBAAoB,WAEnB,GACIk/C,GAAG+hD,EAAIx3G,EADPkW,EAAWrY,KAAKqY,QAGpB,IAAKA,EAASqI,iBAAmB,CAEhC,GAAIpQ,GAAkB+H,EAAS/H,gBAC3Bq+C,EAAO/sD,OAAO+sD,KAAMr+C,EAExB,IAAKq+C,EAAKvuD,OAAS,EAAI,CAEtB,GAAIy0G,GAAiBvkG,EAAiBq+C,EAAM,GAE5C,IAAwB7tD,SAAnB+zG,EAKJ,IAHA70G,KAAK2iB,yBACL3iB,KAAK05G,yBAEC9hD,EAAI,EAAG+hD,EAAK9E,EAAez0G,OAAQw3D,EAAI+hD,EAAI/hD,IAEhDz1D,EAAO0yG,EAAgBj9C,GAAIz1D,MAAQ2rE,OAAQlW,GAE3C53D,KAAK2iB,sBAAsBvQ,KAAM,GACjCpS,KAAK05G,sBAAuBv3G,GAASy1D,OAQlC,CAEN,GAAI9pD,GAAeuK,EAASvK,YAE5B,IAAsBhN,SAAjBgN,GAA8BA,EAAa1N,OAAS,EAKxD,IAHAJ,KAAK2iB,yBACL3iB,KAAK05G,yBAEC9hD,EAAI,EAAG+hD,EAAK7rG,EAAa1N,OAAQw3D,EAAI+hD,EAAI/hD,IAE9Cz1D,EAAO2L,EAAc8pD,GAAIz1D,MAAQ2rE,OAAQlW,GAEzC53D,KAAK2iB,sBAAsBvQ,KAAM,GACjCpS,KAAK05G,sBAAuBv3G,GAASy1D,IAUzC4f,QAAW,WAuBV,QAASoiC,GAAgBnlF,EAAOlvB,EAAIC,EAAIC,EAAIo0G,EAAKhiG,EAAKiiG,GAUrD,MARA3hG,GAAS2/F,aAAcrjF,EAAOlvB,EAAIC,EAAIC,EAAIs0G,GAE1CF,EAAI3hF,eAAgB6hF,EAAUj6G,GAC9B+X,EAAIqgB,eAAgB6hF,EAAUh6G,GAC9B+5G,EAAI5hF,eAAgB6hF,EAAUv5G,GAE9Bq5G,EAAIx6E,IAAKxnB,GAAMwnB,IAAKy6E,GAEbD,EAAIhvG,QAIZ,QAASmvG,GAAmBx5F,EAAQlI,EAAUg/D,EAAWN,EAAKm9B,EAAIC,EAAIC,EAAI5/E,GAEzE,GAAIw/D,EAYJ,IARCA,EAFI37E,EAAS3E,OAASsG,GAEV+8D,EAAIsgC,kBAAmBjD,EAAID,EAAID,GAAI,EAAM1/E,GAIzCuiD,EAAIsgC,kBAAmBnD,EAAIC,EAAIC,EAAI/7F,EAAS3E,OAASmhB,GAAYL,GAI3D,OAAdw/D,EAAqB,MAAO,KAEjCgmB,GAAuBr7F,KAAM6V,GAC7BwlF,EAAuBp7F,aAAc2B,EAAOnV,YAE5C,IAAIyrB,GAAWwgD,EAAUN,IAAI/+D,OAAOkrE,WAAY82B,EAEhD,OAAKnjF,GAAWwgD,EAAU9qE,MAAQsqB,EAAWwgD,EAAU7qE,IAAa,MAGnEqqB,SAAUA,EACVrC,MAAOwlF,EAAuBpvG,QAC9B2V,OAAQA,GAKV,QAAS05F,GAAiC15F,EAAQlI,EAAUg/D,EAAWN,EAAKlsE,EAAU8M,EAAI9K,EAAG9G,EAAG+G,GAE/FyhG,EAAGz/C,oBAAqBjkD,EAAUgC,GAClC2hG,EAAG1/C,oBAAqBjkD,EAAU9E,GAClC0oG,EAAG3/C,oBAAqBjkD,EAAUiC,EAElC,IAAIotG,GAAeH,EAAmBx5F,EAAQlI,EAAUg/D,EAAWN,EAAKw3B,EAAIC,EAAIC,EAAI0L,EAEpF,IAAKD,EAAe,CAEdviG,IAEJy5C,EAAItC,oBAAqBn3C,EAAI9K,GAC7BwkD,EAAIvC,oBAAqBn3C,EAAI5R,GAC7BurD,EAAIxC,oBAAqBn3C,EAAI7K,GAE7BotG,EAAaviG,GAAKgiG,EAAgBQ,EAAmB5L,EAAIC,EAAIC,EAAIr9C,EAAKC,EAAKC,GAI5E,IAAInyB,GAAO,GAAIvyB,GAAOC,EAAG9G,EAAG+G,EAC5BoL,GAASy/F,UAAWpJ,EAAIC,EAAIC,EAAItvE,EAAKj6B,QAErCg1G,EAAa/6E,KAAOA,EAIrB,MAAO+6E,GA7FR,GAAIE,GAAgB,GAAIp6G,GACpB+2E,EAAM,GAAIh/D,GACVi7E,EAAS,GAAIjuF,GAEbwpG,EAAK,GAAIztG,GACT0tG,EAAK,GAAI1tG,GACT2tG,EAAK,GAAI3tG,GAETu5G,EAAQ,GAAIv5G,GACZw5G,EAAQ,GAAIx5G,GACZy5G,EAAQ,GAAIz5G,GAEZswD,EAAM,GAAIxxD,GACVyxD,EAAM,GAAIzxD,GACV0xD,EAAM,GAAI1xD,GAEVk6G,EAAY,GAAIh5G,GAEhBq5G,EAAoB,GAAIr5G,GACxBk5G,EAAyB,GAAIl5G,EA8EjC,OAAO,UAAkBu2E,EAAWxgB,GAEnC,GAAIz+C,GAAWrY,KAAKqY,SAChBC,EAAWtY,KAAKsY,SAChBjN,EAAcrL,KAAKqL,WAEvB,IAAkBvK,SAAbwX,IAI4B,OAA5BD,EAASjK,gBAA0BiK,EAAS4iE,wBAEjDgY,EAAOr0E,KAAMvG,EAASjK,gBACtB6kF,EAAOp0E,aAAcxT,GAEhBisE,EAAUN,IAAI+b,iBAAkBE,MAAa,IAIlDonB,EAAc9/D,WAAYlvC,GAC1B2rE,EAAIp4D,KAAM04D,EAAUN,KAAMn4D,aAAcw7F,GAIV,OAAzBhiG,EAASlK,aAER6oE,EAAI8b,cAAez6E,EAASlK,gBAAkB,IAFpD,CAMA,GAAIgsG,EAEJ,IAAK9hG,EAASqI,iBAAmB,CAEhC,GAAI5T,GAAG9G,EAAG+G,EAMNiD,EAAGy9B,EAAGhP,EAAIiP,EACVzX,EAAOgH,EACPt2B,EAAOomB,EAPP3c,EAAQiI,EAASjI,MACjBtF,EAAWuN,EAAShI,WAAWvF,SAC/B8M,EAAKS,EAAShI,WAAWuH,GACzB9H,EAASuI,EAASvI,OAClBS,EAAY8H,EAAS9H,SAKzB,IAAe,OAAVH,EAIJ,GAAKhD,MAAMC,QAASiL,GAEnB,IAAMtI,EAAI,EAAGyuB,EAAK3uB,EAAO1P,OAAQ4P,EAAIyuB,EAAIzuB,IAQxC,IANAimB,EAAQnmB,EAAQE,GAChBitB,EAAgB3kB,EAAU2d,EAAMhpB,eAEhCtG,EAAQgM,KAAK7N,IAAKmxB,EAAMtvB,MAAO4J,EAAU5J,OACzComB,EAAMpa,KAAK9N,IAAOoxB,EAAMtvB,MAAQsvB,EAAM/sB,MAAWqH,EAAU5J,MAAQ4J,EAAUrH,OAEvEukC,EAAI9mC,EAAO+mC,EAAK3gB,EAAK0gB,EAAIC,EAAID,GAAK,EAEvC3gC,EAAIsD,EAAM0+C,KAAMrhB,GAChBznC,EAAIoK,EAAM0+C,KAAMrhB,EAAI,GACpB1gC,EAAIqD,EAAM0+C,KAAMrhB,EAAI,GAEpB0sE,EAAeD,EAAiCl6G,KAAMi9B,EAAeq6C,EAAWN,EAAKlsE,EAAU8M,EAAI9K,EAAG9G,EAAG+G,GAEpGotG,IAEJA,EAAaM,UAAY9nG,KAAKC,MAAO66B,EAAI,GACzCqpB,EAAW1kD,KAAM+nG,QAapB,KAHAxzG,EAAQgM,KAAK7N,IAAK,EAAGyL,EAAU5J,OAC/BomB,EAAMpa,KAAK9N,IAAKuL,EAAMlH,MAASqH,EAAU5J,MAAQ4J,EAAUrH,OAErD8G,EAAIrJ,EAAO83B,EAAK1R,EAAK/c,EAAIyuB,EAAIzuB,GAAK,EAEvClD,EAAIsD,EAAM0+C,KAAM9+C,GAChBhK,EAAIoK,EAAM0+C,KAAM9+C,EAAI,GACpBjD,EAAIqD,EAAM0+C,KAAM9+C,EAAI,GAEpBmqG,EAAeD,EAAiCl6G,KAAMsY,EAAUg/D,EAAWN,EAAKlsE,EAAU8M,EAAI9K,EAAG9G,EAAG+G,GAE/FotG,IAEJA,EAAaM,UAAY9nG,KAAKC,MAAO5C,EAAI,GACzC8mD,EAAW1kD,KAAM+nG,QAQd,IAAkBr5G,SAAbgK,EAIX,GAAKsC,MAAMC,QAASiL,GAEnB,IAAMtI,EAAI,EAAGyuB,EAAK3uB,EAAO1P,OAAQ4P,EAAIyuB,EAAIzuB,IAQxC,IANAimB,EAAQnmB,EAAQE,GAChBitB,EAAgB3kB,EAAU2d,EAAMhpB,eAEhCtG,EAAQgM,KAAK7N,IAAKmxB,EAAMtvB,MAAO4J,EAAU5J,OACzComB,EAAMpa,KAAK9N,IAAOoxB,EAAMtvB,MAAQsvB,EAAM/sB,MAAWqH,EAAU5J,MAAQ4J,EAAUrH,OAEvEukC,EAAI9mC,EAAO+mC,EAAK3gB,EAAK0gB,EAAIC,EAAID,GAAK,EAEvC3gC,EAAI2gC,EACJznC,EAAIynC,EAAI,EACR1gC,EAAI0gC,EAAI,EAER0sE,EAAeD,EAAiCl6G,KAAMi9B,EAAeq6C,EAAWN,EAAKlsE,EAAU8M,EAAI9K,EAAG9G,EAAG+G,GAEpGotG,IAEJA,EAAaM,UAAY9nG,KAAKC,MAAO66B,EAAI,GACzCqpB,EAAW1kD,KAAM+nG,QAapB,KAHAxzG,EAAQgM,KAAK7N,IAAK,EAAGyL,EAAU5J,OAC/BomB,EAAMpa,KAAK9N,IAAKiG,EAAS5B,MAASqH,EAAU5J,MAAQ4J,EAAUrH,OAExD8G,EAAIrJ,EAAO83B,EAAK1R,EAAK/c,EAAIyuB,EAAIzuB,GAAK,EAEvClD,EAAIkD,EACJhK,EAAIgK,EAAI,EACRjD,EAAIiD,EAAI,EAERmqG,EAAeD,EAAiCl6G,KAAMsY,EAAUg/D,EAAWN,EAAKlsE,EAAU8M,EAAI9K,EAAG9G,EAAG+G,GAE/FotG,IAEJA,EAAaM,UAAY9nG,KAAKC,MAAO5C,EAAI,GACzC8mD,EAAW1kD,KAAM+nG,QAUf,IAAK9hG,EAASsI,WAAa,CAEjC,GAAI+5F,GAAKC,EAAKC,EAKVhrG,EAJAssE,EAAkB9uE,MAAMC,QAASiL,GAEjC5K,EAAW2K,EAAS3K,SACpBE,EAAQyK,EAASzK,MAGjBC,EAAgBwK,EAASxK,cAAe,EACvCA,GAAczN,OAAS,IAAIwP,EAAM/B,EAEtC,KAAM,GAAIw9B,GAAI,EAAGkjE,EAAK3gG,EAAMxN,OAAQirC,EAAIkjE,EAAIljE,IAAO,CAElD,GAAIjM,GAAOxxB,EAAOy9B,GACdwvE,EAAe3+B,EAAkB5jE,EAAU8mB,EAAKnyB,eAAkBqL,CAEtE,IAAsBxX,SAAjB+5G,EAAL,CAMA,GAJAH,EAAMhtG,EAAU0xB,EAAKtyB,GACrB6tG,EAAMjtG,EAAU0xB,EAAKp5B,GACrB40G,EAAMltG,EAAU0xB,EAAKryB,GAEhB8tG,EAAa/sG,gBAAiB,EAAO,CAEzC,GAAIA,GAAeuK,EAASvK,aACxBkV,EAAkBhjB,KAAK2iB,qBAE3B6rF,GAAGvoG,IAAK,EAAG,EAAG,GACdwoG,EAAGxoG,IAAK,EAAG,EAAG,GACdyoG,EAAGzoG,IAAK,EAAG,EAAG,EAEd,KAAM,GAAImsD,GAAI,EAAG0oD,EAAKhtG,EAAa1N,OAAQgyD,EAAI0oD,EAAI1oD,IAAO,CAEzD,GAAItvC,IAAYE,EAAiBovC,EAEjC,IAAmB,IAAdtvC,GAAL,CAEA,GAAIi4F,IAAUjtG,EAAcskD,GAAI1kD,QAEhC8gG,GAAGlsB,gBAAiBg4B,EAAM7qD,WAAYsrD,GAAS37E,EAAKtyB,GAAK4tG,GAAO53F,IAChE2rF,EAAGnsB,gBAAiBi4B,EAAM9qD,WAAYsrD,GAAS37E,EAAKp5B,GAAK20G,GAAO73F,IAChE4rF,EAAGpsB,gBAAiBk4B,EAAM/qD,WAAYsrD,GAAS37E,EAAKryB,GAAK6tG,GAAO93F,KAIjE0rF,EAAGnvE,IAAKq7E,GACRjM,EAAGpvE,IAAKs7E,GACRjM,EAAGrvE,IAAKu7E,GAERF,EAAMlM,EACNmM,EAAMlM,EACNmM,EAAMlM,EAMP,GAFAyL,EAAeH,EAAmBh6G,KAAM66G,EAAcvjC,EAAWN,EAAK0jC,EAAKC,EAAKC,EAAKR,GAEjE,CAEnB,GAAKxqG,GAAOA,EAAKy7B,GAAM,CAEtB,GAAI2vE,IAAQprG,EAAKy7B,EACjBgmB,GAAIzyC,KAAMo8F,GAAO,IACjB1pD,EAAI1yC,KAAMo8F,GAAO,IACjBzpD,EAAI3yC,KAAMo8F,GAAO,IAEjBb,EAAaviG,GAAKgiG,EAAgBQ,EAAmBM,EAAKC,EAAKC,EAAKvpD,EAAKC,EAAKC,GAI/E4oD,EAAa/6E,KAAOA,EACpB+6E,EAAaM,UAAYpvE,EACzByrB,EAAW1kD,KAAM+nG,YAYtBtvG,MAAO,WAEN,MAAO,IAAI7K,MAAKuqE,YAAavqE,KAAKqY,SAAUrY,KAAKsY,UAAWsG,KAAM5e,SAggCpEujB,GAAYkwD,UAAY7xE,OAAOqvF,OAAQhwF,EAAQwyE,WAC/ClwD,GAAYkwD,UAAUlJ,YAAchnD,GAEpCA,GAAYkwD,UAAU55D,eAAgB,EAEtCjY,OAAOC,eAAgB0hB,GAAYkwD,UAAW,UAE7CpqE,IAAK,WAEJ,MAAOrJ,MAAKkB,OAIb+E,IAAK,SAAWnE,GAEf9B,KAAKkB,MAAQY,IAyDf,IAAImkB,IAAe,GAAIhlB,GACnBmlB,GAAmB,GAAI7C,IAevBU,MACAI,MAIAwB,GAAY,GAAI9d,cAAc,IAC9B2d,GAAY,GAAI3d,cAAc,GAC9Bwd,GAAY,GAAIxd,cAAc,EAulBlC+f,IAAiB2rD,UAAUvsD,YAAc,SAAWxiB,GAEnD,GAAI6a,GAAQvf,KAAKuf,KAEZ7a,aAAgBqD,eAAgBwX,EAAMnf,SAAWsE,EAAKtE,SAE1DJ,KAAKuf,MAAQ,GAAIxX,cAAcrD,EAAKtE,SAIrC+jB,GAAW5E,EAAO7a,IAYnBqjB,GAAkB0rD,UAAUvwD,SAAW,SAAWjc,EAAInF,EAAO8W,GAI5D,IAAM,GAFF+K,GAAM3jB,KAAK2jB,IAEL3T,EAAI,EAAGgU,EAAIL,EAAIvjB,OAAQ4P,IAAMgU,IAAMhU,EAAI,CAEhD,GAAIkB,GAAIyS,EAAK3T,EACbkB,GAAEgS,SAAUjc,EAAInF,EAAOoP,EAAEkP,IAAMxH,IAUjC,IAAI0P,IAAa,0BAyFjBQ,IAAc2qD,UAAUvwD,SAAW,SAAWjc,EAAI9E,EAAML,GAEvD,GAAIoP,GAAIlR,KAAK6V,IAAK1T,EAEPrB,UAANoQ,GAAkBA,EAAEgS,SAAUjc,EAAInF,EAAO9B,KAAK4Y,WAIpDkQ,GAAc2qD,UAAU7wB,YAAc,SAAW37C,EAAIuZ,EAAQre,GAE5D,GAAIgP,GAAIqP,EAAQre,EAELrB,UAANqQ,GAAkBnR,KAAKkjB,SAAUjc,EAAI9E,EAAMgP,IAOjD2X,GAAcm8B,OAAS,SAAWh+C,EAAI0c,EAAKunD,EAAQtyD,GAElD,IAAM,GAAI5I,GAAI,EAAGgU,EAAIL,EAAIvjB,OAAQ4P,IAAMgU,IAAMhU,EAAI,CAEhD,GAAIkB,GAAIyS,EAAK3T,GACZmB,EAAI+5D,EAAQh6D,EAAEkP,GAEVjP,GAAEwE,eAAgB,GAGtBzE,EAAEgS,SAAUjc,EAAIkK,EAAErP,MAAO8W,KAQ5BkQ,GAAc24B,aAAe,SAAW99B,EAAKunD,GAI5C,IAAM,GAFFplE,MAEMkK,EAAI,EAAGgU,EAAIL,EAAIvjB,OAAQ4P,IAAMgU,IAAMhU,EAAI,CAEhD,GAAIkB,GAAIyS,EAAK3T,EACRkB,GAAEkP,KAAM8qD,IAASplE,EAAEsM,KAAMlB,GAI/B,MAAOpL,GAoDR,IAAIgsB,IAAiB,EA8yCjB5oB,GAAQ,CAyYZwpB,IAAkB+gD,UAAY7xE,OAAOqvF,OAAQ59E,EAASogE,WACtD/gD,GAAkB+gD,UAAUlJ,YAAc73C,GAE1CA,GAAkB+gD,UAAU3vB,qBAAsB,EAElDpxB,GAAkB+gD,UAAU70D,KAAO,SAAW8/D,GAoB7C,MAlBArrE,GAASogE,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAEpC1+E,KAAKgwB,aAAe0uD,EAAO1uD,aAE3BhwB,KAAK6W,SAAW6nE,EAAO7nE,SACvB7W,KAAK8N,aAAe4wE,EAAO5wE,aAE3B9N,KAAK6V,IAAM6oE,EAAO7oE,IAElB7V,KAAKmW,SAAWuoE,EAAOvoE,SAEvBnW,KAAKivB,gBAAkByvD,EAAOzvD,gBAC9BjvB,KAAK06B,kBAAoBgkD,EAAOhkD,kBAChC16B,KAAK26B,iBAAmB+jD,EAAO/jD,iBAE/B36B,KAAKyW,UAAYioE,EAAOjoE,UACxBzW,KAAK0W,mBAAqBgoE,EAAOhoE,mBAE1B1W,MAuDR2yB,GAAqB8gD,UAAY7xE,OAAOqvF,OAAQ59E,EAASogE,WACzD9gD,GAAqB8gD,UAAUlJ,YAAc53C,GAE7CA,GAAqB8gD,UAAUp3C,wBAAyB,EAExD1J,GAAqB8gD,UAAU70D,KAAO,SAAW8/D,GAmBhD,MAjBArrE,GAASogE,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAEpC1+E,KAAK46B,kBAAkBhc,KAAM8/D,EAAO9jD,mBACpC56B,KAAK66B,aAAe6jD,EAAO7jD,aAC3B76B,KAAK86B,YAAc4jD,EAAO5jD,YAE1B96B,KAAK6W,SAAW6nE,EAAO7nE,SACvB7W,KAAK8N,aAAe4wE,EAAO5wE,aAE3B9N,KAAK6V,IAAM6oE,EAAO7oE,IAElB7V,KAAKmW,SAAWuoE,EAAOvoE,SAEvBnW,KAAKivB,gBAAkByvD,EAAOzvD,gBAC9BjvB,KAAK06B,kBAAoBgkD,EAAOhkD,kBAChC16B,KAAK26B,iBAAmB+jD,EAAO/jD,iBAExB36B,MAm5ERg2C,GAAMy9B,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQ/mF,EAASupE,YAExDlJ,YAAav0B,GAEbilE,SAAS,IAkCVhlE,GAAkBw9B,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQllF,EAAO0nE,YAElElJ,YAAat0B,GAEbilE,qBAAqB,EAErBt8F,KAAM,SAAW8/D,EAAQnH,GAiBxB,MAfAxrE,GAAO0nE,UAAU70D,KAAKta,KAAMtE,KAAM0+E,EAAQnH,GAE1Cv3E,KAAKk2C,IAAMwoC,EAAOxoC,IAClBl2C,KAAK0M,KAAOgyE,EAAOhyE,KAEnB1M,KAAKwM,KAAOkyE,EAAOlyE,KACnBxM,KAAKyM,IAAMiyE,EAAOjyE,IAClBzM,KAAKo2C,MAAQsoC,EAAOtoC,MAEpBp2C,KAAKm2C,OAASuoC,EAAOvoC,OACrBn2C,KAAK2M,KAAuB,OAAhB+xE,EAAO/xE,KAAgB,KAAO/K,OAAO48E,UAAYE,EAAO/xE,MAEpE3M,KAAKq2C,UAAYqoC,EAAOroC,UACxBr2C,KAAKs2C,WAAaooC,EAAOpoC,WAElBt2C,MAYRm7G,eAAgB,SAAWC,GAG1B,GAAIC,GAAe,GAAMr7G,KAAKs7G,gBAAkBF,CAEhDp7G,MAAKk2C,IAAsB,EAAhBj0C,GAAMq+E,QAAc3tE,KAAK4oG,KAAMF,GAC1Cr7G,KAAK4M,0BAON4uG,eAAgB,WAEf,GAAIH,GAAe1oG,KAAKqlD,IAAqB,GAAhB/1D,GAAMkgE,QAAgBniE,KAAKk2C,IAExD,OAAO,GAAMl2C,KAAKs7G,gBAAkBD,GAIrCI,gBAAiB,WAEhB,MAAuB,GAAhBx5G,GAAMq+E,QAAc3tE,KAAK4oG,KAC/B5oG,KAAKqlD,IAAqB,GAAhB/1D,GAAMkgE,QAAgBniE,KAAKk2C,KAAQl2C,KAAK0M,OAIpDgvG,aAAc,WAGb,MAAO17G,MAAKq2C,UAAY1jC,KAAK9N,IAAK7E,KAAKm2C,OAAQ,IAIhDmlE,cAAe,WAGd,MAAOt7G,MAAKq2C,UAAY1jC,KAAK7N,IAAK9E,KAAKm2C,OAAQ,IAuChDo3D,cAAe,SAAWC,EAAWC,EAAY3tG,EAAGC,EAAG4D,EAAOC,GAE7D5D,KAAKm2C,OAASq3D,EAAYC,EAEP,OAAdztG,KAAK2M,OAET3M,KAAK2M,MACJwS,SAAS,EACTquF,UAAW,EACXC,WAAY,EACZp/B,QAAS,EACTC,QAAS,EACT3qE,MAAO,EACPC,OAAQ,IAKV5D,KAAK2M,KAAKwS,SAAU,EACpBnf,KAAK2M,KAAK6gG,UAAYA,EACtBxtG,KAAK2M,KAAK8gG,WAAaA,EACvBztG,KAAK2M,KAAK0hE,QAAUvuE,EACpBE,KAAK2M,KAAK2hE,QAAUvuE,EACpBC,KAAK2M,KAAKhJ,MAAQA,EAClB3D,KAAK2M,KAAK/I,OAASA,EAEnB5D,KAAK4M,0BAIN8gG,gBAAiB,WAEG,OAAd1tG,KAAK2M,OAET3M,KAAK2M,KAAKwS,SAAU,GAIrBnf,KAAK4M,0BAINA,uBAAwB,WAEvB,GAAIJ,GAAOxM,KAAKwM,KACfF,EAAME,EAAOmG,KAAKqlD,IAAqB,GAAhB/1D,GAAMkgE,QAAgBniE,KAAKk2C,KAAQl2C,KAAK0M,KAC/D9I,EAAS,EAAI0I,EACb3I,EAAQ3D,KAAKm2C,OAASvyC,EACtBwI,MAAezI,EACfgJ,EAAO3M,KAAK2M,IAEb,IAAmB,OAAd3M,KAAK2M,MAAiB3M,KAAK2M,KAAKwS,QAAU,CAE9C,GAAIquF,GAAY7gG,EAAK6gG,UACpBC,EAAa9gG,EAAK8gG,UAEnBrhG,IAAQO,EAAK0hE,QAAU1qE,EAAQ6pG,EAC/BlhG,GAAOK,EAAK2hE,QAAU1qE,EAAS6pG,EAC/B9pG,GAASgJ,EAAKhJ,MAAQ6pG,EACtB5pG,GAAU+I,EAAK/I,OAAS6pG,EAIzB,GAAIkO,GAAO37G,KAAKs2C,UACF,KAATqlE,IAAavvG,GAAQI,EAAOmvG,EAAO37G,KAAK07G,gBAE7C17G,KAAKiM,iBAAiBq/E,gBAAiBl/E,EAAMA,EAAOzI,EAAO2I,EAAKA,EAAM1I,EAAQ4I,EAAMxM,KAAKyM,KAEzFzM,KAAKkM,wBAAwBquC,WAAYv6C,KAAKiM,mBAI/CqzD,OAAQ,SAAW4xB,GAElB,GAAIxsF,GAAOwF,EAASupE,UAAUnU,OAAOh7D,KAAMtE,KAAMkxF,EAgBjD,OAdAxsF,GAAK8b,OAAO01B,IAAMl2C,KAAKk2C,IACvBxxC,EAAK8b,OAAO9T,KAAO1M,KAAK0M,KAExBhI,EAAK8b,OAAOhU,KAAOxM,KAAKwM,KACxB9H,EAAK8b,OAAO/T,IAAMzM,KAAKyM,IACvB/H,EAAK8b,OAAO41B,MAAQp2C,KAAKo2C,MAEzB1xC,EAAK8b,OAAO21B,OAASn2C,KAAKm2C,OAEP,OAAdn2C,KAAK2M,OAAgBjI,EAAK8b,OAAO7T,KAAO/K,OAAO48E,UAAYx+E,KAAK2M,OAErEjI,EAAK8b,OAAO61B,UAAYr2C,KAAKq2C,UAC7B3xC,EAAK8b,OAAO81B,WAAat2C,KAAKs2C,WAEvB5xC,KAkBT6xC,GAAYk9B,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQh7C,GAAkBw9B,YAEvElJ,YAAah0B,GAEbyJ,eAAe,IA0sGhBiM,GAAQwnB,UAAUp/C,WAAY,EAE9B43B,GAAQwnB,UAAU5oE,MAAQ,WAEzB,MAAO,IAAIohD,IAASjsD,KAAKgN,MAAOhN,KAAKkmD,UAItC+F,GAAQwnB,UAAUnU,OAAS,WAE1B,OACC79D,KAAM,UACNuL,MAAOhN,KAAKgN,MAAMy7F,SAClBviD,QAASlmD,KAAKkmD,UAqBhBgG,GAAIunB,UAAU3tB,OAAQ,EAEtBoG,GAAIunB,UAAU5oE,MAAQ,WAErB,MAAO,IAAIqhD,IAAKlsD,KAAKgN,MAAOhN,KAAKwM,KAAMxM,KAAKyM,MAI7Cy/C,GAAIunB,UAAUnU,OAAS,WAEtB,OACC79D,KAAM,MACNuL,MAAOhN,KAAKgN,MAAMy7F,SAClBj8F,KAAMxM,KAAKwM,KACXC,IAAKzM,KAAKyM,MAuBZ0/C,GAAMsnB,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQ/mF,EAASupE,YAExDlJ,YAAape,GAEbvtC,KAAM,SAAW8/D,EAAQnH,GAWxB,MATArtE,GAASupE,UAAU70D,KAAKta,KAAMtE,KAAM0+E,EAAQnH,GAEjB,OAAtBmH,EAAOtlE,aAAsBpZ,KAAKoZ,WAAaslE,EAAOtlE,WAAWvO,SAClD,OAAf6zE,EAAOnrE,MAAevT,KAAKuT,IAAMmrE,EAAOnrE,IAAI1I,SAChB,OAA5B6zE,EAAO3+B,mBAA4B//C,KAAK+/C,iBAAmB2+B,EAAO3+B,iBAAiBl1C,SAExF7K,KAAKi+B,WAAaygD,EAAOzgD,WACzBj+B,KAAKgD,iBAAmB07E,EAAO17E,iBAExBhD,MAIRs/D,OAAQ,SAAW4xB,GAElB,GAAIxsF,GAAOwF,EAASupE,UAAUnU,OAAOh7D,KAAMtE,KAAMkxF,EAKjD,OAHyB,QAApBlxF,KAAKoZ,aAAsB1U,EAAK8b,OAAOpH,WAAapZ,KAAKoZ,WAAWkmD,OAAQ4xB,IAC/D,OAAblxF,KAAKuT,MAAe7O,EAAK8b,OAAOjN,IAAMvT,KAAKuT,IAAI+rD,UAE7C56D,KAuBT9C,OAAOC,eAAgBuqD,GAAkBqnB,UAAW,eAEnDxtE,IAAK,SAAWnE,GAEVA,KAAU,GAAO9B,KAAKuD,aAM7B3B,OAAO48E,OAAQpyB,GAAkBqnB,WAEhCmoC,qBAAqB,EAErB/zG,iBAAkB,aAElB0qG,SAAU,SAAWlrG,GAEpB,GAAK+F,MAAMC,QAAShG,GAEnB,KAAM,IAAI0H,WAAW,wDAOtB,OAHA/O,MAAKkJ,MAAkBpI,SAAVuG,EAAsBA,EAAMjH,OAASJ,KAAK4+C,OAAS,EAChE5+C,KAAKqH,MAAQA,EAENrH,MAIR08E,WAAY,SAAW56E,GAItB,MAFA9B,MAAKuH,QAAUzF,EAER9B,MAIR4e,KAAM,SAAW8/D,GAOhB,MALA1+E,MAAKqH,MAAQ,GAAIq3E,GAAOr3E,MAAMkjE,YAAamU,EAAOr3E,OAClDrH,KAAKkJ,MAAQw1E,EAAOx1E,MACpBlJ,KAAK4+C,OAAS8/B,EAAO9/B,OACrB5+C,KAAKuH,QAAUm3E,EAAOn3E,QAEfvH,MAIRwyG,OAAQ,SAAW5jD,EAAQznD,EAAW0nD,GAErCD,GAAU5uD,KAAK4+C,OACfiQ,GAAU1nD,EAAUy3C,MAEpB,KAAM,GAAI5uC,GAAI,EAAGC,EAAIjQ,KAAK4+C,OAAQ5uC,EAAIC,EAAGD,IAExChQ,KAAKqH,MAAOunD,EAAS5+C,GAAM7I,EAAUE,MAAOwnD,EAAS7+C,EAItD,OAAOhQ,OAIRiG,IAAK,SAAWnE,EAAOc,GAMtB,MAJgB9B,UAAX8B,IAAuBA,EAAS,GAErC5C,KAAKqH,MAAMpB,IAAKnE,EAAOc,GAEhB5C,MAIR6K,MAAO,WAEN,OAAO,GAAI7K,MAAKuqE,aAAc3rD,KAAM5e,OAIrCgzG,SAAU,SAAWlsG,GAIpB,MAFA9G,MAAK6H,iBAAmBf,EAEjB9G,QAoBT4B,OAAOqJ,iBAAkBohD,GAA2BonB,WAEnDvqE,OAECG,IAAK,WAEJ,MAAOrJ,MAAK0E,KAAKwE,QAMnB7B,OAECgC,IAAK,WAEJ,MAAOrJ,MAAK0E,KAAK2C,UAQpBzF,OAAO48E,OAAQnyB,GAA2BonB,WAEzCnqE,8BAA8B,EAE9B24E,KAAM,SAAW7xE,EAAOtQ,GAIvB,MAFAE,MAAK0E,KAAK2C,MAAO+I,EAAQpQ,KAAK0E,KAAKk6C,OAAS5+C,KAAK4C,QAAW9C,EAErDE,MAIRkiF,KAAM,SAAW9xE,EAAOrQ,GAIvB,MAFAC,MAAK0E,KAAK2C,MAAO+I,EAAQpQ,KAAK0E,KAAKk6C,OAAS5+C,KAAK4C,OAAS,GAAM7C,EAEzDC,MAIRivF,KAAM,SAAW7+E,EAAO5P,GAIvB,MAFAR,MAAK0E,KAAK2C,MAAO+I,EAAQpQ,KAAK0E,KAAKk6C,OAAS5+C,KAAK4C,OAAS,GAAMpC,EAEzDR,MAIRyxF,KAAM,SAAWrhF,EAAO3P,GAIvB,MAFAT,MAAK0E,KAAK2C,MAAO+I,EAAQpQ,KAAK0E,KAAKk6C,OAAS5+C,KAAK4C,OAAS,GAAMnC,EAEzDT,MAIR8uD,KAAM,SAAW1+C,GAEhB,MAAOpQ,MAAK0E,KAAK2C,MAAO+I,EAAQpQ,KAAK0E,KAAKk6C,OAAS5+C,KAAK4C,SAIzD6gF,KAAM,SAAWrzE,GAEhB,MAAOpQ,MAAK0E,KAAK2C,MAAO+I,EAAQpQ,KAAK0E,KAAKk6C,OAAS5+C,KAAK4C,OAAS,IAIlE+lF,KAAM,SAAWv4E,GAEhB,MAAOpQ,MAAK0E,KAAK2C,MAAO+I,EAAQpQ,KAAK0E,KAAKk6C,OAAS5+C,KAAK4C,OAAS,IAIlEkvF,KAAM,SAAW1hF,GAEhB,MAAOpQ,MAAK0E,KAAK2C,MAAO+I,EAAQpQ,KAAK0E,KAAKk6C,OAAS5+C,KAAK4C,OAAS,IAIlEkwG,MAAO,SAAW1iG,EAAOtQ,EAAGC,GAO3B,MALAqQ,GAAQA,EAAQpQ,KAAK0E,KAAKk6C,OAAS5+C,KAAK4C,OAExC5C,KAAK0E,KAAK2C,MAAO+I,EAAQ,GAAMtQ,EAC/BE,KAAK0E,KAAK2C,MAAO+I,EAAQ,GAAMrQ,EAExBC,MAIR4oF,OAAQ,SAAWx4E,EAAOtQ,EAAGC,EAAGS,GAQ/B,MANA4P,GAAQA,EAAQpQ,KAAK0E,KAAKk6C,OAAS5+C,KAAK4C,OAExC5C,KAAK0E,KAAK2C,MAAO+I,EAAQ,GAAMtQ,EAC/BE,KAAK0E,KAAK2C,MAAO+I,EAAQ,GAAMrQ,EAC/BC,KAAK0E,KAAK2C,MAAO+I,EAAQ,GAAM5P,EAExBR,MAIR+yG,QAAS,SAAW3iG,EAAOtQ,EAAGC,EAAGS,EAAGC,GASnC,MAPA2P,GAAQA,EAAQpQ,KAAK0E,KAAKk6C,OAAS5+C,KAAK4C,OAExC5C,KAAK0E,KAAK2C,MAAO+I,EAAQ,GAAMtQ,EAC/BE,KAAK0E,KAAK2C,MAAO+I,EAAQ,GAAMrQ,EAC/BC,KAAK0E,KAAK2C,MAAO+I,EAAQ,GAAM5P,EAC/BR,KAAK0E,KAAK2C,MAAO+I,EAAQ,GAAM3P,EAExBT,QAqCTszB,GAAemgD,UAAY7xE,OAAOqvF,OAAQ59E,EAASogE,WACnDngD,GAAemgD,UAAUlJ,YAAcj3C,GACvCA,GAAemgD,UAAUhvB,kBAAmB,EAE5CnxB,GAAemgD,UAAU70D,KAAO,SAAW8/D,GAW1C,MATArrE,GAASogE,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAEpC1+E,KAAKgN,MAAM4R,KAAM8/D,EAAO1xE,OACxBhN,KAAK6V,IAAM6oE,EAAO7oE,IAElB7V,KAAK+C,SAAW27E,EAAO37E,SAEvB/C,KAAKwvB,gBAAkBkvD,EAAOlvD,gBAEvBxvB,KASR,IAAIqY,GAkCJk0C,IAAOknB,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQ/mF,EAASupE,YAEzDlJ,YAAahe,GAEb9M,UAAU,EAEV+3B,QAAW,WAcV,QAASqkC,GAAiBC,EAAgBC,EAAYj5G,EAAQiI,EAAOyoD,EAAK56B,GAGzEojF,EAAgBvsD,WAAYqsD,EAAgBh5G,GAASu/E,UAAW,IAAMnjD,SAAUn0B,GAGnEjK,SAAR0yD,GAEJyoD,EAAgBn8G,EAAM84B,EAAMojF,EAAgBl8G,EAAQ0zD,EAAMwoD,EAAgBj8G,EAC1Ek8G,EAAgBl8G,EAAMyzD,EAAMwoD,EAAgBl8G,EAAQ84B,EAAMojF,EAAgBj8G,GAI1Ek8G,EAAgBr9F,KAAMo9F,GAKvBF,EAAel9F,KAAMm9F,GACrBD,EAAeh8G,GAAKm8G,EAAgBn8G,EACpCg8G,EAAe/7G,GAAKk8G,EAAgBl8G,EAGpC+7G,EAAej9F,aAAcq9F,GAnC9B,GAAIC,GAAiB,GAAIp7G,GACrBq7G,EAAa,GAAIr7G,GACjBg7G,EAAa,GAAIh7G,GAEjBi7G,EAAkB,GAAIn8G,GACtBo8G,EAAkB,GAAIp8G,GACtBq8G,EAAkB,GAAIj8G,GAEtBuuG,EAAK,GAAIztG,GACT0tG,EAAK,GAAI1tG,GACT2tG,EAAK,GAAI3tG,EA6Bb,OAAO,UAAkBu2E,EAAWxgB,GAEnCslD,EAAW9rB,mBAAoBtwF,KAAKqL,aACpC6wG,EAAgB3hE,WAAYv6C,KAAKmL,iBAAkBkuB,YAAar5B,KAAKqL,aACrE0wG,EAAW5jF,sBAAuBn4B,KAAKmL,gBAEvC,IACIqoD,GAAK56B,EADL71B,EAAW/C,KAAKsY,SAASvV,QAEX,KAAbA,IAEJ61B,EAAMjmB,KAAKimB,IAAK71B,GAChBywD,EAAM7gD,KAAK6gD,IAAKzwD,GAIjB,IAAID,GAAS9C,KAAK8C,MAElB+4G,GAAiBrN,EAAGvoG,YAAmB,GAAK81G,EAAYj5G,EAAQs5G,EAAY5oD,EAAK56B,GACjFijF,EAAiBpN,EAAGxoG,IAAK,OAAY,GAAK81G,EAAYj5G,EAAQs5G,EAAY5oD,EAAK56B,GAC/EijF,EAAiBnN,EAAGzoG,IAAK,GAAK,GAAK,GAAK81G,EAAYj5G,EAAQs5G,EAAY5oD,EAAK56B,EAG7E,IAAIq7D,GAAY3c,EAAUN,IAAIsgC,kBAAmB9I,EAAIC,EAAIC,GAAI,EAAOyN,EAEpE,IAAmB,OAAdloB,IAGJ4nB,EAAiBpN,EAAGxoG,QAAY,GAAK,GAAK81G,EAAYj5G,EAAQs5G,EAAY5oD,EAAK56B,GAC/Eq7D,EAAY3c,EAAUN,IAAIsgC,kBAAmB9I,EAAIE,EAAID,GAAI,EAAO0N,GAC7C,OAAdloB,GALN,CAaA,GAAIn9D,GAAWwgD,EAAUN,IAAI/+D,OAAOkrE,WAAYg5B,EAE3CrlF,GAAWwgD,EAAU9qE,MAAQsqB,EAAWwgD,EAAU7qE,KAEvDqqD,EAAW1kD,MAEV0kB,SAAUA,EACVrC,MAAO0nF,EAAetxG,QACtBu0B,KAAM,KACN5e,OAAQxgB,YAQX6K,MAAO,WAEN,MAAO,IAAI7K,MAAKuqE,YAAavqE,KAAKsY,UAAWsG,KAAM5e,OAIpD4e,KAAM,SAAW8/D,GAMhB,MAJAx0E,GAASupE,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAEb59E,SAAlB49E,EAAO57E,QAAuB9C,KAAK8C,OAAO8b,KAAM8/D,EAAO57E,QAErD9C,QA4BTysD,GAAIgnB,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQ/mF,EAASupE,YAEtDlJ,YAAa9d,GAEb7tC,KAAM,SAAW8/D,GAEhBx0E,EAASupE,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAAQ,EAI5C,KAAM,GAFFhyB,GAASgyB,EAAOhyB,OAEV18C,EAAI,EAAGC,EAAIy8C,EAAOtsD,OAAQ4P,EAAIC,EAAGD,IAAO,CAEjD,GAAI27C,GAAQe,EAAQ18C,EAEpBhQ,MAAKq8G,SAAU1wD,EAAMnrC,OAAO3V,QAAS8gD,EAAM70B,UAI5C,MAAO92B,OAIRq8G,SAAU,SAAW77F,EAAQsW,GAEVh2B,SAAbg2B,IAAyBA,EAAW,GAEzCA,EAAWnkB,KAAK4P,IAAKuU,EAIrB,KAAM,GAFF41B,GAAS1sD,KAAK0sD,OAERz8C,EAAI,EAAGA,EAAIy8C,EAAOtsD,UAEtB02B,EAAW41B,EAAQz8C,GAAI6mB,UAFO7mB,KAUpCy8C,EAAOuyB,OAAQhvE,EAAG,GAAK6mB,SAAUA,EAAUtW,OAAQA,IAEnDxgB,KAAKq/B,IAAK7e,IAIX87F,qBAAsB,SAAWxlF,GAIhC,IAAM,GAFF41B,GAAS1sD,KAAK0sD,OAER18C,EAAI,EAAGC,EAAIy8C,EAAOtsD,OAAQ4P,EAAIC,KAElC6mB,EAAW41B,EAAQ18C,GAAI8mB,UAFc9mB,KAU3C,MAAO08C,GAAQ18C,EAAI,GAAIwQ,QAIxBg3D,QAAW,WAEV,GAAI+kC,GAAiB,GAAIx7G,EAEzB,OAAO,UAAkBu2E,EAAWxgB,GAEnCylD,EAAepkF,sBAAuBn4B,KAAKqL,YAE3C,IAAIyrB,GAAWwgD,EAAUN,IAAI/+D,OAAOkrE,WAAYo5B,EAEhDv8G,MAAKs8G,qBAAsBxlF,GAAW0gD,QAASF,EAAWxgB,OAM5DptD,OAAQ,WAEP,GAAIk+D,GAAK,GAAI7mE,GACTwnE,EAAK,GAAIxnE,EAEb,OAAO,UAAiBmY,GAEvB,GAAIwzC,GAAS1sD,KAAK0sD,MAElB,IAAKA,EAAOtsD,OAAS,EAAI,CAExBwnE,EAAGzvC,sBAAuBjf,EAAO7N,aACjCk9D,EAAGpwC,sBAAuBn4B,KAAKqL,YAE/B,IAAIyrB,GAAW8wC,EAAGub,WAAY5a,EAE9B7b,GAAQ,GAAIlsC,OAAO/U,SAAU,CAE7B,KAAM,GAAIuE,GAAI,EAAGC,EAAIy8C,EAAOtsD,OAAQ4P,EAAIC,GAElC6mB,GAAY41B,EAAQ18C,GAAI8mB,SAFa9mB,IAIzC08C,EAAQ18C,EAAI,GAAIwQ,OAAO/U,SAAU,EACjCihD,EAAQ18C,GAAIwQ,OAAO/U,SAAU,CAU/B,MAAQuE,EAAIC,EAAGD,IAEd08C,EAAQ18C,GAAIwQ,OAAO/U,SAAU,OAUjC6zD,OAAQ,SAAW4xB,GAElB,GAAIxsF,GAAOwF,EAASupE,UAAUnU,OAAOh7D,KAAMtE,KAAMkxF,EAEjDxsF,GAAK8b,OAAOksC,SAIZ,KAAM,GAFFA,GAAS1sD,KAAK0sD,OAER18C,EAAI,EAAGC,EAAIy8C,EAAOtsD,OAAQ4P,EAAIC,EAAGD,IAAO,CAEjD,GAAI27C,GAAQe,EAAQ18C,EAEpBtL,GAAK8b,OAAOksC,OAAOt6C,MAClBoO,OAAQmrC,EAAMnrC,OAAOxe,KACrB80B,SAAU60B,EAAM70B,WAKlB,MAAOpyB,MAoDT9C,OAAO48E,OAAQ7xB,GAAS8mB,WAEvB3mB,kBAAmB,WAElB9sD,KAAK4sD,eAEL,KAAM,GAAI58C,GAAI,EAAGyuB,EAAKz+B,KAAKmyB,MAAM/xB,OAAQ4P,EAAIyuB,EAAIzuB,IAAO,CAEvD,GAAIg+E,GAAU,GAAI/tF,EAEbD,MAAKmyB,MAAOniB,IAEhBg+E,EAAQzzC,WAAYv6C,KAAKmyB,MAAOniB,GAAI3E,aAIrCrL,KAAK4sD,aAAax6C,KAAM47E,KAM1Bh2C,KAAM,WAEL,GAAIghC,GAAMhpE,EAAGyuB,CAIb,KAAMzuB,EAAI,EAAGyuB,EAAKz+B,KAAKmyB,MAAM/xB,OAAQ4P,EAAIyuB,EAAIzuB,IAE5CgpE,EAAOh5E,KAAKmyB,MAAOniB,GAEdgpE,GAEJA,EAAK3tE,YAAYkvC,WAAYv6C,KAAK4sD,aAAc58C,GAQlD,KAAMA,EAAI,EAAGyuB,EAAKz+B,KAAKmyB,MAAM/xB,OAAQ4P,EAAIyuB,EAAIzuB,IAE5CgpE,EAAOh5E,KAAKmyB,MAAOniB,GAEdgpE,IAECA,EAAKvuE,QAAUuuE,EAAKvuE,OAAOmuE,QAE/BI,EAAK/1E,OAAOs3C,WAAYy+B,EAAKvuE,OAAOY,aACpC2tE,EAAK/1E,OAAOi8B,SAAU85C,EAAK3tE,cAI3B2tE,EAAK/1E,OAAO2b,KAAMo6D,EAAK3tE,aAIxB2tE,EAAK/1E,OAAOq1C,UAAW0gC,EAAKluE,SAAUkuE,EAAK5uE,WAAY4uE,EAAKjuE,SAQ/DrB,OAAQ,WAEP,GAAI8yG,GAAe,GAAIv8G,GACnBw8G,EAAiB,GAAIx8G,EAEzB,OAAO,YASN,IAAM,GAPFkyB,GAAQnyB,KAAKmyB,MACby6B,EAAe5sD,KAAK4sD,aACpB5J,EAAehjD,KAAKgjD,aACpBH,EAAc7iD,KAAK6iD,YAIb7yC,EAAI,EAAGyuB,EAAKtM,EAAM/xB,OAAQ4P,EAAIyuB,EAAIzuB,IAAO,CAIlD,GAAI/M,GAASkvB,EAAOniB,GAAMmiB,EAAOniB,GAAI3E,YAAcoxG,CAEnDD,GAAa1/E,iBAAkB75B,EAAQ2pD,EAAc58C,IACrDwsG,EAAa19F,QAASkkC,EAAkB,GAAJhzC,GAIhBlP,SAAhB+hD,IAEJA,EAAYltC,aAAc,OAQ7B9K,MAAO,WAEN,MAAO,IAAI8hD,IAAU3sD,KAAKmyB,MAAOnyB,KAAK4sD,eAIvC8vD,cAAe,SAAWv6G,GAEzB,IAAM,GAAI6N,GAAI,EAAGyuB,EAAKz+B,KAAKmyB,MAAM/xB,OAAQ4P,EAAIyuB,EAAIzuB,IAAO,CAEvD,GAAIgpE,GAAOh5E,KAAKmyB,MAAOniB,EAEvB,IAAKgpE,EAAK72E,OAASA,EAElB,MAAO62E,OA0BXjsB,GAAK0mB,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQ/mF,EAASupE,YAEvDlJ,YAAaxd,GAEb6rB,QAAQ,IA6BT5rB,GAAYymB,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQ74E,EAAKq7D,YAE1DlJ,YAAavd,GAEbn5B,eAAe,EAEfu5B,UAAW,WAEV,GAAgB4rB,GAAM2jC,EAClB3sG,EAAGyuB,EADHtM,IAGJ,IAAKnyB,KAAKqY,UAAoCvX,SAAxBd,KAAKqY,SAAS8Z,MAAsB,CAIzD,IAAMniB,EAAI,EAAGyuB,EAAKz+B,KAAKqY,SAAS8Z,MAAM/xB,OAAQ4P,EAAIyuB,EAAIzuB,IAErD2sG,EAAQ38G,KAAKqY,SAAS8Z,MAAOniB,GAI7BgpE,EAAO,GAAIjsB,IACX56B,EAAM/f,KAAM4mE,GAIZA,EAAK72E,KAAOw6G,EAAMx6G,KAClB62E,EAAKluE,SAASotC,UAAWykE,EAAMC,KAC/B5jC,EAAK5uE,WAAW8tC,UAAWykE,EAAME,MACd/7G,SAAd67G,EAAMG,KAAoB9jC,EAAKjuE,MAAMmtC,UAAWykE,EAAMG,IAM5D,KAAM9sG,EAAI,EAAGyuB,EAAKz+B,KAAKqY,SAAS8Z,MAAM/xB,OAAQ4P,EAAIyuB,EAAIzuB,IAErD2sG,EAAQ38G,KAAKqY,SAAS8Z,MAAOniB,GAEtB2sG,EAAMlyG,aAAuC,OAAjBkyG,EAAMlyG,QAAiD3J,SAA1BqxB,EAAOwqF,EAAMlyG,QAI5E0nB,EAAOwqF,EAAMlyG,QAAS40B,IAAKlN,EAAOniB,IAMlChQ,KAAKq/B,IAAKlN,EAAOniB,IAapB,MAFAhQ,MAAKi/B,mBAAmB,GAEjB9M,GAIRk7B,KAAM,SAAWn7B,EAAUg7B,GAE1BltD,KAAKkyB,SAAWA,EAEIpxB,SAAfosD,IAEJltD,KAAKi/B,mBAAmB,GAExBj/B,KAAKkyB,SAAS46B,oBAEdI,EAAaltD,KAAKqL,aAInBrL,KAAKktD,WAAWtuC,KAAMsuC,GACtBltD,KAAKmtD,kBAAkB5S,WAAY2S,IAIpClV,KAAM,WAELh4C,KAAKkyB,SAAS8lB,QAIfsV,qBAAsB,WAErB,GAAIviD,GAAOiF,CAEX,IAAKhQ,KAAKqY,UAAYrY,KAAKqY,SAASsI,WAEnC,IAAM3Q,EAAI,EAAGA,EAAIhQ,KAAKqY,SAASrK,YAAY5N,OAAQ4P,IAAO,CAEzD,GAAI+sG,GAAK/8G,KAAKqY,SAASrK,YAAagC,EAEpCjF,GAAQ,EAAMgyG,EAAG75B,kBAEZn4E,IAAUhG,EAAAA,EAEdg4G,EAAG7kF,eAAgBntB,GAInBgyG,EAAG92G,IAAK,EAAG,EAAG,EAAG,OAMb,IAAKjG,KAAKqY,UAAYrY,KAAKqY,SAASqI,iBAAmB,CAE7D,GAAI45C,GAAM,GAAI72D,GAEVu5G,EAAah9G,KAAKqY,SAAShI,WAAW2sG,UAE1C,KAAMhtG,EAAI,EAAGA,EAAIgtG,EAAW9zG,MAAO8G,IAElCsqD,EAAIx6D,EAAIk9G,EAAWluD,KAAM9+C,GACzBsqD,EAAIv6D,EAAIi9G,EAAWv5B,KAAMzzE,GACzBsqD,EAAI95D,EAAIw8G,EAAWr0B,KAAM34E,GACzBsqD,EAAI75D,EAAIu8G,EAAWlrB,KAAM9hF,GAEzBjF,EAAQ,EAAMuvD,EAAI4oB,kBAEbn4E,IAAUhG,EAAAA,EAEdu1D,EAAIpiC,eAAgBntB,GAIpBuvD,EAAIr0D,IAAK,EAAG,EAAG,EAAG,GAInB+2G,EAAWjK,QAAS/iG,EAAGsqD,EAAIx6D,EAAGw6D,EAAIv6D,EAAGu6D,EAAI95D,EAAG85D,EAAI75D,KAQnDw+B,kBAAmB,SAAW6tE,GAE7B10F,EAAKq7D,UAAUx0C,kBAAkB36B,KAAMtE,KAAM8sG,GAEtB,aAAlB9sG,KAAKitD,SAETjtD,KAAKmtD,kBAAkB5S,WAAYv6C,KAAKqL,aAEX,aAAlBrL,KAAKitD,SAEhBjtD,KAAKmtD,kBAAkB5S,WAAYv6C,KAAKktD,YAIxC7sD,QAAQ4H,KAAM,6CAA+CjI,KAAKitD,WAMpEpiD,MAAO,WAEN,MAAO,IAAI7K,MAAKuqE,YAAavqE,KAAKqY,SAAUrY,KAAKsY,UAAWsG,KAAM5e,SAsCpEkzB,GAAkBugD,UAAY7xE,OAAOqvF,OAAQ59E,EAASogE,WACtDvgD,GAAkBugD,UAAUlJ,YAAcr3C,GAE1CA,GAAkBugD,UAAUtvB,qBAAsB,EAElDjxB,GAAkBugD,UAAU70D,KAAO,SAAW8/D,GAU7C,MARArrE,GAASogE,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAEpC1+E,KAAKgN,MAAM4R,KAAM8/D,EAAO1xE,OAExBhN,KAAKoX,UAAYsnE,EAAOtnE,UACxBpX,KAAKutD,QAAUmxB,EAAOnxB,QACtBvtD,KAAKwtD,SAAWkxB,EAAOlxB,SAEhBxtD,MAyBRytD,GAAKgmB,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQ/mF,EAASupE,YAEvDlJ,YAAa9c,GAEb/wB,QAAQ,EAERugF,qBAAwB,WAEvB,GAAIt2G,GAAQ,GAAI5F,GACZgsB,EAAM,GAAIhsB,EAEd,OAAO,YAEN,GAAIsX,GAAWrY,KAAKqY,QAEpB,IAAKA,EAASqI,iBAIb,GAAwB,OAAnBrI,EAASjI,MAAiB,CAK9B,IAAM,GAHF8sG,GAAoB7kG,EAAShI,WAAWvF,SACxCoD,GAAkB,GAEZ8B,EAAI,EAAGC,EAAIitG,EAAkBh0G,MAAO8G,EAAIC,EAAGD,IAEpDrJ,EAAMooD,oBAAqBmuD,EAAmBltG,EAAI,GAClD+c,EAAIgiC,oBAAqBmuD,EAAmBltG,GAE5C9B,EAAe8B,GAAM9B,EAAe8B,EAAI,GACxC9B,EAAe8B,IAAOrJ,EAAMw8E,WAAYp2D,EAIzC1U,GAASvF,aAAc,eAAgB,GAAItD,GAAwBtB,EAAe,QAIlF7N,SAAQ4H,KAAM,qGAIT,IAAKoQ,EAASsI,WAAa,CAEjC,GAAIjT,GAAW2K,EAAS3K,SACpBQ,EAAgBmK,EAASnK,aAE7BA,GAAe,GAAM,CAErB,KAAM,GAAI8B,GAAI,EAAGC,EAAIvC,EAAStN,OAAQ4P,EAAIC,EAAGD,IAE5C9B,EAAe8B,GAAM9B,EAAe8B,EAAI,GACxC9B,EAAe8B,IAAOtC,EAAUsC,EAAI,GAAImzE,WAAYz1E,EAAUsC,IAMhE,MAAOhQ,UAMTw3E,QAAW,WAEV,GAAI6iC,GAAgB,GAAIp6G,GACpB+2E,EAAM,GAAIh/D,GACVi7E,EAAS,GAAIjuF,EAEjB,OAAO,UAAkBsyE,EAAWxgB,GAEnC,GAAI3hD,GAAYmiE,EAAU6lC,cACtBC,EAAcjoG,EAAYA,EAE1BkD,EAAWrY,KAAKqY,SAChBhN,EAAcrL,KAAKqL,WASvB,IALiC,OAA5BgN,EAASjK,gBAA0BiK,EAAS4iE,wBAEjDgY,EAAOr0E,KAAMvG,EAASjK,gBACtB6kF,EAAOp0E,aAAcxT,GAEhBisE,EAAUN,IAAI+b,iBAAkBE,MAAa,EAAlD,CAIAonB,EAAc9/D,WAAYlvC,GAC1B2rE,EAAIp4D,KAAM04D,EAAUN,KAAMn4D,aAAcw7F,EAExC,IAAIgD,GAAS,GAAIt8G,GACbu8G,EAAO,GAAIv8G,GACXw8G,EAAe,GAAIx8G,GACnBy8G,EAAW,GAAIz8G,GACf44E,EAAS35E,MAAQA,KAAKyqD,eAAmB,EAAI,CAEjD,IAAKpyC,EAASqI,iBAAmB,CAEhC,GAAItQ,GAAQiI,EAASjI,MACjBC,EAAagI,EAAShI,WACtBkoE,EAAYloE,EAAWvF,SAASzD,KAEpC,IAAe,OAAV+I,EAIJ,IAAM,GAFFmC,GAAUnC,EAAM/I,MAEV2I,EAAI,EAAGC,EAAIsC,EAAQnS,OAAS,EAAG4P,EAAIC,EAAGD,GAAK2pE,EAAO,CAE3D,GAAI7sE,GAAIyF,EAASvC,GACbhK,EAAIuM,EAASvC,EAAI,EAErBqtG,GAAOnlE,UAAWqgC,EAAe,EAAJzrE,GAC7BwwG,EAAKplE,UAAWqgC,EAAe,EAAJvyE,EAE3B,IAAIy3G,GAASzmC,EAAIy+B,oBAAqB4H,EAAQC,EAAME,EAAUD,EAE9D,MAAKE,EAASL,GAAd,CAEAI,EAAS3+F,aAAc7e,KAAKqL,YAE5B,IAAIyrB,GAAWwgD,EAAUN,IAAI/+D,OAAOkrE,WAAYq6B,EAE3C1mF,GAAWwgD,EAAU9qE,MAAQsqB,EAAWwgD,EAAU7qE,KAEvDqqD,EAAW1kD,MAEV0kB,SAAUA,EAGVrC,MAAO8oF,EAAa1yG,QAAQgU,aAAc7e,KAAKqL,aAC/C+E,MAAOJ,EACPovB,KAAM,KACNq7E,UAAW,KACXj6F,OAAQxgB,YAQV,KAAM,GAAIgQ,GAAI,EAAGC,EAAIsoE,EAAUn4E,OAAS,EAAI,EAAG4P,EAAIC,EAAGD,GAAK2pE,EAAO,CAEjE0jC,EAAOnlE,UAAWqgC,EAAW,EAAIvoE,GACjCstG,EAAKplE,UAAWqgC,EAAW,EAAIvoE,EAAI,EAEnC,IAAIytG,GAASzmC,EAAIy+B,oBAAqB4H,EAAQC,EAAME,EAAUD,EAE9D,MAAKE,EAASL,GAAd,CAEAI,EAAS3+F,aAAc7e,KAAKqL,YAE5B,IAAIyrB,GAAWwgD,EAAUN,IAAI/+D,OAAOkrE,WAAYq6B,EAE3C1mF,GAAWwgD,EAAU9qE,MAAQsqB,EAAWwgD,EAAU7qE,KAEvDqqD,EAAW1kD,MAEV0kB,SAAUA,EAGVrC,MAAO8oF,EAAa1yG,QAAQgU,aAAc7e,KAAKqL,aAC/C+E,MAAOJ,EACPovB,KAAM,KACNq7E,UAAW,KACXj6F,OAAQxgB,aAQL,IAAKqY,EAASsI,WAKpB,IAAM,GAHFjT,GAAW2K,EAAS3K,SACpBgwG,EAAahwG,EAAStN,OAEhB4P,EAAI,EAAGA,EAAI0tG,EAAa,EAAG1tG,GAAK2pE,EAAO,CAEhD,GAAI8jC,GAASzmC,EAAIy+B,oBAAqB/nG,EAAUsC,GAAKtC,EAAUsC,EAAI,GAAKwtG,EAAUD,EAElF,MAAKE,EAASL,GAAd,CAEAI,EAAS3+F,aAAc7e,KAAKqL,YAE5B,IAAIyrB,GAAWwgD,EAAUN,IAAI/+D,OAAOkrE,WAAYq6B,EAE3C1mF,GAAWwgD,EAAU9qE,MAAQsqB,EAAWwgD,EAAU7qE,KAEvDqqD,EAAW1kD,MAEV0kB,SAAUA,EAGVrC,MAAO8oF,EAAa1yG,QAAQgU,aAAc7e,KAAKqL,aAC/C+E,MAAOJ,EACPovB,KAAM,KACNq7E,UAAW,KACXj6F,OAAQxgB,cAYb6K,MAAO,WAEN,MAAO,IAAI7K,MAAKuqE,YAAavqE,KAAKqY,SAAUrY,KAAKsY,UAAWsG,KAAM5e,SAkBpE0tD,GAAa+lB,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQxjC,GAAKgmB,YAE3DlJ,YAAa7c,GAEbjD,gBAAgB,EAEhBwyD,qBAAwB,WAEvB,GAAIt2G,GAAQ,GAAI5F,GACZgsB,EAAM,GAAIhsB,EAEd,OAAO,YAEN,GAAIsX,GAAWrY,KAAKqY,QAEpB,IAAKA,EAASqI,iBAIb,GAAwB,OAAnBrI,EAASjI,MAAiB,CAK9B,IAAM,GAHF8sG,GAAoB7kG,EAAShI,WAAWvF,SACxCoD,KAEM8B,EAAI,EAAGC,EAAIitG,EAAkBh0G,MAAO8G,EAAIC,EAAGD,GAAK,EAEzDrJ,EAAMooD,oBAAqBmuD,EAAmBltG,GAC9C+c,EAAIgiC,oBAAqBmuD,EAAmBltG,EAAI,GAEhD9B,EAAe8B,GAAc,IAANA,EAAY,EAAI9B,EAAe8B,EAAI,GAC1D9B,EAAe8B,EAAI,GAAM9B,EAAe8B,GAAMrJ,EAAMw8E,WAAYp2D,EAIjE1U,GAASvF,aAAc,eAAgB,GAAItD,GAAwBtB,EAAe,QAIlF7N,SAAQ4H,KAAM,6GAIT,IAAKoQ,EAASsI,WAKpB,IAAM,GAHFjT,GAAW2K,EAAS3K,SACpBQ,EAAgBmK,EAASnK,cAEnB8B,EAAI,EAAGC,EAAIvC,EAAStN,OAAQ4P,EAAIC,EAAGD,GAAK,EAEjDrJ,EAAMiY,KAAMlR,EAAUsC,IACtB+c,EAAInO,KAAMlR,EAAUsC,EAAI,IAExB9B,EAAe8B,GAAc,IAANA,EAAY,EAAI9B,EAAe8B,EAAI,GAC1D9B,EAAe8B,EAAI,GAAM9B,EAAe8B,GAAMrJ,EAAMw8E,WAAYp2D,EAMlE,OAAO/sB,YAoBV2tD,GAAS8lB,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQxjC,GAAKgmB,YAEvDlJ,YAAa5c,GAEbjD,YAAY,IAyCbt3B,GAAeqgD,UAAY7xE,OAAOqvF,OAAQ59E,EAASogE,WACnDrgD,GAAeqgD,UAAUlJ,YAAcn3C,GAEvCA,GAAeqgD,UAAUlvB,kBAAmB,EAE5CnxB,GAAeqgD,UAAU70D,KAAO,SAAW8/D,GAa1C,MAXArrE,GAASogE,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAEpC1+E,KAAKgN,MAAM4R,KAAM8/D,EAAO1xE,OAExBhN,KAAK6V,IAAM6oE,EAAO7oE,IAElB7V,KAAKinB,KAAOy3D,EAAOz3D,KACnBjnB,KAAKwvB,gBAAkBkvD,EAAOlvD,gBAE9BxvB,KAAK8N,aAAe4wE,EAAO5wE,aAEpB9N,MAmBR4tD,GAAO6lB,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQ/mF,EAASupE,YAEzDlJ,YAAa3c,GAEbjxB,UAAU,EAEV66C,QAAW,WAEV,GAAI6iC,GAAgB,GAAIp6G,GACpB+2E,EAAM,GAAIh/D,GACVi7E,EAAS,GAAIjuF,EAEjB,OAAO,UAAkBsyE,EAAWxgB,GA2BnC,QAAS6mD,GAAWlpF,EAAOrkB,GAE1B,GAAIwtG,GAAqB5mC,EAAIw+B,kBAAmB/gF,EAEhD,IAAKmpF,EAAqBC,EAAmB,CAE5C7mC,EAAIs+B,oBAAqB7gF,EAAO0nF,GAChCA,EAAet9F,aAAcxT,EAE7B,IAAIyrB,GAAWwgD,EAAUN,IAAI/+D,OAAOkrE,WAAYg5B,EAEhD,IAAKrlF,EAAWwgD,EAAU9qE,MAAQsqB,EAAWwgD,EAAU7qE,IAAM,MAE7DqqD,GAAW1kD,MAEV0kB,SAAUA,EACVgnF,cAAenrG,KAAKmwC,KAAM86D,GAC1BnpF,MAAO0nF,EAAetxG,QACtBuF,MAAOA,EACPgvB,KAAM,KACN5e,OAAQA,KA7CX,GAAIA,GAASxgB,KACTqY,EAAWrY,KAAKqY,SAChBhN,EAAcrL,KAAKqL,YACnB6rE,EAAYI,EAAUL,OAAOrpB,OAAOspB,SAUxC,IANiC,OAA5B7+D,EAASjK,gBAA0BiK,EAAS4iE,wBAEjDgY,EAAOr0E,KAAMvG,EAASjK,gBACtB6kF,EAAOp0E,aAAcxT,GACrB4nF,EAAOhuF,QAAUiyE,EAEZI,EAAUN,IAAI+b,iBAAkBE,MAAa,EAAlD,CAIAonB,EAAc9/D,WAAYlvC,GAC1B2rE,EAAIp4D,KAAM04D,EAAUN,KAAMn4D,aAAcw7F,EAExC,IAAI0D,GAAiB7mC,IAAgBl3E,KAAK+K,MAAMjL,EAAIE,KAAK+K,MAAMhL,EAAIC,KAAK+K,MAAMvK,GAAM,GAChFq9G,EAAmBE,EAAiBA,EACpCjzG,EAAW,GAAI/J,GACfo7G,EAAiB,GAAIp7G,EA8BzB,IAAKsX,EAASqI,iBAAmB,CAEhC,GAAItQ,GAAQiI,EAASjI,MACjBC,EAAagI,EAAShI,WACtBkoE,EAAYloE,EAAWvF,SAASzD,KAEpC,IAAe,OAAV+I,EAIJ,IAAM,GAFFmC,GAAUnC,EAAM/I,MAEV2I,EAAI,EAAGyuB,EAAKlsB,EAAQnS,OAAQ4P,EAAIyuB,EAAIzuB,IAAO,CAEpD,GAAIlD,GAAIyF,EAASvC,EAEjBlF,GAASotC,UAAWqgC,EAAe,EAAJzrE,GAE/B6wG,EAAW7yG,EAAUgC,OAMtB,KAAM,GAAIkD,GAAI,EAAGC,EAAIsoE,EAAUn4E,OAAS,EAAG4P,EAAIC,EAAGD,IAEjDlF,EAASotC,UAAWqgC,EAAe,EAAJvoE,GAE/B2tG,EAAW7yG,EAAUkF,OAUvB,KAAM,GAFFtC,GAAW2K,EAAS3K,SAEdsC,EAAI,EAAGC,EAAIvC,EAAStN,OAAQ4P,EAAIC,EAAGD,IAE5C2tG,EAAWjwG,EAAUsC,GAAKA,QAU9BnF,MAAO,WAEN,MAAO,IAAI7K,MAAKuqE,YAAavqE,KAAKqY,SAAUrY,KAAKsY,UAAWsG,KAAM5e,SAkBpE6tD,GAAa4lB,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQhwF,EAAQwyE,YAE9DlJ,YAAa1c,GAEbliB,gBAAgB,EAEhBjiC,OAAQ,WAEP,GAAIokD,GAAQ9tD,KAAKkB,KAEZ4sD,GAAMkwD,YAAclwD,EAAMmwD,oBAE9Bj+G,KAAK2V,aAAc,MA+BtBo4C,GAAkB0lB,UAAY7xE,OAAOqvF,OAAQhwF,EAAQwyE,WACrD1lB,GAAkB0lB,UAAUlJ,YAAcxc,GAE1CA,GAAkB0lB,UAAUvmC,qBAAsB,EAclD8gB,GAAcylB,UAAY7xE,OAAOqvF,OAAQhwF,EAAQwyE,WACjDzlB,GAAcylB,UAAUlJ,YAAcvc,GACtCA,GAAcylB,UAAUyqC,iBAAkB,EAgC1CjwD,GAAawlB,UAAY7xE,OAAOqvF,OAAQhwF,EAAQwyE,WAChDxlB,GAAawlB,UAAUlJ,YAActc,GACrCA,GAAawlB,UAAUjlC,gBAAiB,EA4KxC0f,GAAkBulB,UAAY7xE,OAAOqvF,OAAQ/gF,EAAeujE,WAC5DvlB,GAAkBulB,UAAUlJ,YAAcrc,GA6B1Cc,GAAmBykB,UAAY7xE,OAAOqvF,OAAQzjF,EAASimE,WACvDzkB,GAAmBykB,UAAUlJ,YAAcvb,GA6H3CI,GAAyBqkB,UAAY7xE,OAAOqvF,OAAQ/gF,EAAeujE,WACnErkB,GAAyBqkB,UAAUlJ,YAAcnb,GA6BjDO,GAAmB8jB,UAAY7xE,OAAOqvF,OAAQzjF,EAASimE,WACvD9jB,GAAmB8jB,UAAUlJ,YAAc5a,GA8S3CE,GAAyB4jB,UAAY7xE,OAAOqvF,OAAQ/gF,EAAeujE,WACnE5jB,GAAyB4jB,UAAUlJ,YAAc1a,GAyBjDiC,GAAoB2hB,UAAY7xE,OAAOqvF,OAAQzjF,EAASimE,WACxD3hB,GAAoB2hB,UAAUlJ,YAAczY,GAyB5CC,GAA0B0hB,UAAY7xE,OAAOqvF,OAAQphC,GAAyB4jB,WAC9E1hB,GAA0B0hB,UAAUlJ,YAAcxY,GAyBlDC,GAAmByhB,UAAY7xE,OAAOqvF,OAAQzjF,EAASimE,WACvDzhB,GAAmByhB,UAAUlJ,YAAcvY,GA4B3CC,GAAyBwhB,UAAY7xE,OAAOqvF,OAAQphC,GAAyB4jB,WAC7ExhB,GAAyBwhB,UAAUlJ,YAActY,GAyBjDC,GAAoBuhB,UAAY7xE,OAAOqvF,OAAQzjF,EAASimE,WACxDvhB,GAAoBuhB,UAAUlJ,YAAcrY,GAgC5CC,GAA0BshB,UAAY7xE,OAAOqvF,OAAQphC,GAAyB4jB,WAC9EthB,GAA0BshB,UAAUlJ,YAAcpY,GAyBlDE,GAAqBohB,UAAY7xE,OAAOqvF,OAAQzjF,EAASimE,WACzDphB,GAAqBohB,UAAUlJ,YAAclY,GAwD7CC,GAA2BmhB,UAAY7xE,OAAOqvF,OAAQphC,GAAyB4jB,WAC/EnhB,GAA2BmhB,UAAUlJ,YAAcjY,GA6CnDC,GAAakhB,UAAY7xE,OAAOqvF,OAAQzjF,EAASimE,WACjDlhB,GAAakhB,UAAUlJ,YAAchY,GAwKrCM,GAAmB4gB,UAAY7xE,OAAOqvF,OAAQ/gF,EAAeujE,WAC7D5gB,GAAmB4gB,UAAUlJ,YAAc1X,GAiC3Ca,GAAkB+f,UAAY7xE,OAAOqvF,OAAQzjF,EAASimE,WACtD/f,GAAkB+f,UAAUlJ,YAAc7W,GAwJ1CI,GAAwB2f,UAAY7xE,OAAOqvF,OAAQ/gF,EAAeujE,WAClE3f,GAAwB2f,UAAUlJ,YAAczW,GA6BhDY,GAAc+e,UAAY7xE,OAAOqvF,OAAQzjF,EAASimE,WAClD/e,GAAc+e,UAAUlJ,YAAc7V,GAwGtCE,GAAoB6e,UAAY7xE,OAAOqvF,OAAQ/gF,EAAeujE,WAC9D7e,GAAoB6e,UAAUlJ,YAAc3V,EAO5C,IAAIupD,KAEHC,YAAa,SAAW15G,EAAMyyD,EAAarC,GAE1CA,EAAMA,GAAO,CAEb,IAAIupD,GAAWlnD,GAAeA,EAAY/2D,OACzCk+G,EAAWD,EAAWlnD,EAAa,GAAMrC,EAAMpwD,EAAKtE,OACpDg3D,EAAYvC,GAAYnwD,EAAM,EAAG45G,EAAUxpD,GAAK,GAChDrzC,IAED,KAAO21C,EAAY,MAAO31C,EAE1B,IAAIk0C,GAAMC,EAAMq8B,EAAMC,EAAMpyF,EAAGC,EAAG81D,CAMlC,IAJKwoD,IAAWjnD,EAAYF,GAAgBxyD,EAAMyyD,EAAaC,EAAWtC,IAIrEpwD,EAAKtE,OAAS,GAAK00D,EAAM,CAE7Ba,EAAOs8B,EAAOvtF,EAAM,GACpBkxD,EAAOs8B,EAAOxtF,EAAM,EAEpB,KAAM,GAAIsL,GAAI8kD,EAAK9kD,EAAIsuG,EAAUtuG,GAAK8kD,EAErCh1D,EAAI4E,EAAMsL,GACVjQ,EAAI2E,EAAMsL,EAAI,GACTlQ,EAAI61D,IAAOA,EAAO71D,GAClBC,EAAI61D,IAAOA,EAAO71D,GAClBD,EAAImyF,IAAOA,EAAOnyF,GAClBC,EAAImyF,IAAOA,EAAOnyF,EAMxB81D,GAAUljD,KAAK7N,IAAKmtF,EAAOt8B,EAAMu8B,EAAOt8B,GACxCC,EAAsB,IAAZA,EAAgB,EAAIA,EAAU,EAMzC,MAFAJ,IAAc2B,EAAW31C,EAAWqzC,EAAKa,EAAMC,EAAMC,GAE9Cp0C,IA4vBLm9C,IAIHrJ,KAAM,SAAWuE,GAKhB,IAAM,GAHF91C,GAAI81C,EAAQ15D,OACZ0M,EAAI,EAEEqoB,EAAInR,EAAI,EAAG4vC,EAAI,EAAGA,EAAI5vC,EAAGmR,EAAIy+B,IAEtC9mD,GAAKgtD,EAAS3kC,GAAIr1B,EAAIg6D,EAASlG,GAAI7zD,EAAI+5D,EAASlG,GAAI9zD,EAAIg6D,EAAS3kC,GAAIp1B,CAItE,OAAW,GAAJ+M,GAIR+xD,YAAa,SAAW0/C,GAEvB,MAAO3/C,IAAWrJ,KAAMgpD,GAAQ,GAIjCz/C,iBAAkB,SAAWhF,EAAS+C,GAErC,GAAInvD,MACAypD,KACAvpD,IAEJgsD,IAAiBE,GACjBD,GAAYnsD,EAAUosD,EAItB,IAAI0kD,GAAY1kD,EAAQ15D,MAExBy8D,GAAM4hD,QAAS7kD,GAEf,KAAM,GAAI5pD,GAAI,EAAGA,EAAI6sD,EAAMz8D,OAAQ4P,IAElCmnD,EAAY/kD,KAAMosG,GAClBA,GAAa3hD,EAAO7sD,GAAI5P,OACxBy5D,GAAYnsD,EAAUmvD,EAAO7sD,GAU9B,KAAM,GAJFyR,GAAY08F,GAAOC,YAAa1wG,EAAUypD,GAIpCnnD,EAAI,EAAGA,EAAIyR,EAAUrhB,OAAQ4P,GAAK,EAE3CpC,EAAMwE,KAAMqP,EAAUorC,MAAO78C,EAAGA,EAAI,GAIrC,OAAOpC,IAsETmsD,IAAgB0Z,UAAY7xE,OAAOqvF,OAAQzjF,EAASimE,WACpD1Z,GAAgB0Z,UAAUlJ,YAAcxQ,GAExCA,GAAgB0Z,UAAUnU,OAAS,WAElC,GAAI56D,GAAO8I,EAASimE,UAAUnU,OAAOh7D,KAAMtE,MAEvCg6D,EAASh6D,KAAK6Q,WAAWmpD,OACzBn2D,EAAU7D,KAAK6Q,WAAWhN,OAE9B,OAAOy7D,IAAQtF,EAAQn2D,EAASa,IA6pBjCu1D,GAAsBwZ,UAAY7xE,OAAOqvF,OAAQ/gF,EAAeujE,WAChExZ,GAAsBwZ,UAAUlJ,YAActQ,GAE9CA,GAAsBwZ,UAAUnU,OAAS,WAExC,GAAI56D,GAAOwL,EAAeujE,UAAUnU,OAAOh7D,KAAMtE,MAE7Cg6D,EAASh6D,KAAK6Q,WAAWmpD,OACzBn2D,EAAU7D,KAAK6Q,WAAWhN,OAE9B,OAAOy7D,IAAQtF,EAAQn2D,EAASa,GAMjC,IAAIu5D,KAEHT,cAAe,SAAWnlD,EAAU3K,EAAUgxG,EAAQC,EAAQC,GAE7D,GAAIC,GAAMnxG,EAAmB,EAATgxG,GAChBI,EAAMpxG,EAAmB,EAATgxG,EAAa,GAC7BK,EAAMrxG,EAAmB,EAATixG,GAChBK,EAAMtxG,EAAmB,EAATixG,EAAa,GAC7BM,EAAMvxG,EAAmB,EAATkxG,GAChBM,EAAMxxG,EAAmB,EAATkxG,EAAa,EAEjC,QACC,GAAI/+G,GAASg/G,EAAKC,GAClB,GAAIj/G,GAASk/G,EAAKC,GAClB,GAAIn/G,GAASo/G,EAAKC,KAKpBxhD,mBAAoB,SAAWrlD,EAAU3K,EAAUgxG,EAAQC,EAAQC,EAAQO,GAE1E,GAAIN,GAAMnxG,EAAmB,EAATgxG,GAChBI,EAAMpxG,EAAmB,EAATgxG,EAAa,GAC7BU,EAAM1xG,EAAmB,EAATgxG,EAAa,GAC7BK,EAAMrxG,EAAmB,EAATixG,GAChBK,EAAMtxG,EAAmB,EAATixG,EAAa,GAC7BU,EAAM3xG,EAAmB,EAATixG,EAAa,GAC7BM,EAAMvxG,EAAmB,EAATkxG,GAChBM,EAAMxxG,EAAmB,EAATkxG,EAAa,GAC7BU,EAAM5xG,EAAmB,EAATkxG,EAAa,GAC7BW,EAAM7xG,EAAmB,EAATyxG,GAChBK,EAAM9xG,EAAmB,EAATyxG,EAAa,GAC7BM,EAAM/xG,EAAmB,EAATyxG,EAAa;AAEjC,MAAKxsG,MAAK4P,IAAKu8F,EAAME,GAAQ,KAG3B,GAAIn/G,GAASg/G,EAAK,EAAIO,GACtB,GAAIv/G,GAASk/G,EAAK,EAAIM,GACtB,GAAIx/G,GAASo/G,EAAK,EAAIK,GACtB,GAAIz/G,GAAS0/G,EAAK,EAAIE,KAMtB,GAAI5/G,GAASi/G,EAAK,EAAIM,GACtB,GAAIv/G,GAASm/G,EAAK,EAAIK,GACtB,GAAIx/G,GAASq/G,EAAK,EAAII,GACtB,GAAIz/G,GAAS2/G,EAAK,EAAIC,KA2E1BlgD,IAAakU,UAAY7xE,OAAOqvF,OAAQzjF,EAASimE,WACjDlU,GAAakU,UAAUlJ,YAAchL,GAmCrCE,GAAmBgU,UAAY7xE,OAAOqvF,OAAQh3B,GAAsBwZ,WACpEhU,GAAmBgU,UAAUlJ,YAAc9K,GA+B3CI,GAAe4T,UAAY7xE,OAAOqvF,OAAQzjF,EAASimE,WACnD5T,GAAe4T,UAAUlJ,YAAc1K,GAgHvCK,GAAqBuT,UAAY7xE,OAAOqvF,OAAQ/gF,EAAeujE,WAC/DvT,GAAqBuT,UAAUlJ,YAAcrK,GA6B7CI,GAAamT,UAAY7xE,OAAOqvF,OAAQzjF,EAASimE,WACjDnT,GAAamT,UAAUlJ,YAAcjK,GAiHrCK,GAAmB8S,UAAY7xE,OAAOqvF,OAAQ/gF,EAAeujE,WAC7D9S,GAAmB8S,UAAUlJ,YAAc5J,GA4B3CI,GAAc0S,UAAY7xE,OAAOqvF,OAAQzjF,EAASimE,WAClD1S,GAAc0S,UAAUlJ,YAAcxJ,GAmJtCE,GAAoBwS,UAAY7xE,OAAOqvF,OAAQ/gF,EAAeujE,WAC9DxS,GAAoBwS,UAAUlJ,YAActJ,GAiC5CO,GAAciS,UAAY7xE,OAAOqvF,OAAQzjF,EAASimE,WAClDjS,GAAciS,UAAUlJ,YAAc/I,GAEtCA,GAAciS,UAAUnU,OAAS,WAEhC,GAAI56D,GAAO8I,EAASimE,UAAUnU,OAAOh7D,KAAMtE,MAEvCg6D,EAASh6D,KAAK6Q,WAAWmpD,MAE7B,OAAO8H,IAAU9H,EAAQt1D,IAwI1B+8D,GAAoBgS,UAAY7xE,OAAOqvF,OAAQ/gF,EAAeujE,WAC9DhS,GAAoBgS,UAAUlJ,YAAc9I,GAE5CA,GAAoBgS,UAAUnU,OAAS,WAEtC,GAAI56D,GAAOwL,EAAeujE,UAAUnU,OAAOh7D,KAAMtE,MAE7Cg6D,EAASh6D,KAAK6Q,WAAWmpD,MAE7B,OAAO8H,IAAU9H,EAAQt1D,IAqI1Bq9D,GAAc0R,UAAY7xE,OAAOqvF,OAAQ/gF,EAAeujE,WACxD1R,GAAc0R,UAAUlJ,YAAcxI,GA+BtCU,GAAiBgR,UAAY7xE,OAAOqvF,OAAQzjF,EAASimE,WACrDhR,GAAiBgR,UAAUlJ,YAAc9H,GAmRzCI,GAAuB4Q,UAAY7xE,OAAOqvF,OAAQ/gF,EAAeujE,WACjE5Q,GAAuB4Q,UAAUlJ,YAAc1H,GA0B/CW,GAAaiQ,UAAY7xE,OAAOqvF,OAAQxuB,GAAiBgR,WACzDjQ,GAAaiQ,UAAUlJ,YAAc/G,GAsBrCC,GAAmBgQ,UAAY7xE,OAAOqvF,OAAQpuB,GAAuB4Q,WACrEhQ,GAAmBgQ,UAAUlJ,YAAc9G,GA4B3CC,GAAe+P,UAAY7xE,OAAOqvF,OAAQzjF,EAASimE,WACnD/P,GAAe+P,UAAUlJ,YAAc7G,GAmFvCC,GAAqB8P,UAAY7xE,OAAOqvF,OAAQ/gF,EAAeujE,WAC/D9P,GAAqB8P,UAAUlJ,YAAc5G,EAI7C,IAAI+7C,IAA0B99G,OAAO+9G,QACpCzxD,kBAAmBA,GACnBc,mBAAoBA,GACpBI,yBAA0BA,GAC1B0C,oBAAqBA,GACrBC,0BAA2BA,GAC3BC,mBAAoBA,GACpBC,yBAA0BA,GAC1BC,oBAAqBA,GACrBC,0BAA2BA,GAC3BE,qBAAsBA,GACtBC,2BAA4BA,GAC5B3C,mBAAoBA,GACpBE,yBAA0BA,GAC1B0C,aAAcA,GACdM,mBAAoBA,GACpBa,kBAAmBA,GACnBI,wBAAyBA,GACzBY,cAAeA,GACfE,oBAAqBA,GACrB2K,aAAcA,GACdE,mBAAoBA,GACpBI,eAAgBA,GAChBK,qBAAsBA,GACtBI,aAAcA,GACdK,mBAAoBA,GACpB5tD,cAAeA,EACfC,oBAAqBA,EACrB+tD,cAAeA,GACfE,oBAAqBA,GACrBO,cAAeA,GACfC,oBAAqBA,GACrB1H,gBAAiBA,GACjBE,sBAAuBA,GACvB8H,cAAeA,GACfyB,aAAcA,GACdC,mBAAoBA,GACpBhB,iBAAkBA,GAClBI,uBAAwBA,GACxBa,eAAgBA,GAChBC,qBAAsBA,GACtBnzD,YAAaA,EACbO,kBAAmBA,GAwBpBsiB,IAAeogD,UAAY7xE,OAAOqvF,OAAQ59E,EAASogE,WACnDpgD,GAAeogD,UAAUlJ,YAAcl3C,GAEvCA,GAAeogD,UAAU9uB,kBAAmB,EAE5CtxB,GAAeogD,UAAU70D,KAAO,SAAW8/D,GAM1C,MAJArrE,GAASogE,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAEpC1+E,KAAKgN,MAAM4R,KAAM8/D,EAAO1xE,OAEjBhN,MAgBR4jE,GAAkB6P,UAAY7xE,OAAOqvF,OAAQl6E,EAAe08D,WAC5D7P,GAAkB6P,UAAUlJ,YAAc3G,GAE1CA,GAAkB6P,UAAU9kD,qBAAsB,EAiHlDqE,GAAqBygD,UAAY7xE,OAAOqvF,OAAQ59E,EAASogE,WACzDzgD,GAAqBygD,UAAUlJ,YAAcv3C,GAE7CA,GAAqBygD,UAAUlxB,wBAAyB,EAExDvvB,GAAqBygD,UAAU70D,KAAO,SAAW8/D,GAqDhD,MAnDArrE,GAASogE,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAEpC1+E,KAAKgX,SAAY6sD,SAAY,IAE7B7jE,KAAKgN,MAAM4R,KAAM8/D,EAAO1xE,OACxBhN,KAAKwmD,UAAYk4B,EAAOl4B,UACxBxmD,KAAKymD,UAAYi4B,EAAOj4B,UAExBzmD,KAAK6V,IAAM6oE,EAAO7oE,IAElB7V,KAAK8V,SAAW4oE,EAAO5oE,SACvB9V,KAAK+V,kBAAoB2oE,EAAO3oE,kBAEhC/V,KAAKgW,MAAQ0oE,EAAO1oE,MACpBhW,KAAKiW,eAAiByoE,EAAOzoE,eAE7BjW,KAAKmlD,SAASvmC,KAAM8/D,EAAOv5B,UAC3BnlD,KAAKgvB,YAAc0vD,EAAO1vD,YAC1BhvB,KAAKolD,kBAAoBs5B,EAAOt5B,kBAEhCplD,KAAKsrB,QAAUozD,EAAOpzD,QACtBtrB,KAAKqmD,UAAYq4B,EAAOr4B,UAExBrmD,KAAKurB,UAAYmzD,EAAOnzD,UACxBvrB,KAAKm0B,cAAgBuqD,EAAOvqD,cAC5Bn0B,KAAKsmD,YAAY1nC,KAAM8/D,EAAOp4B,aAE9BtmD,KAAKivB,gBAAkByvD,EAAOzvD,gBAC9BjvB,KAAK06B,kBAAoBgkD,EAAOhkD,kBAChC16B,KAAK26B,iBAAmB+jD,EAAO/jD,iBAE/B36B,KAAKkvB,aAAewvD,EAAOxvD,aAE3BlvB,KAAKmvB,aAAeuvD,EAAOvvD,aAE3BnvB,KAAKmW,SAAWuoE,EAAOvoE,SAEvBnW,KAAKoW,OAASsoE,EAAOtoE,OACrBpW,KAAK0mD,gBAAkBg4B,EAAOh4B,gBAE9B1mD,KAAKwW,gBAAkBkoE,EAAOloE,gBAE9BxW,KAAKyW,UAAYioE,EAAOjoE,UACxBzW,KAAK0W,mBAAqBgoE,EAAOhoE,mBACjC1W,KAAK2W,iBAAmB+nE,EAAO/nE,iBAC/B3W,KAAK4W,kBAAoB8nE,EAAO9nE,kBAEhC5W,KAAK6W,SAAW6nE,EAAO7nE,SACvB7W,KAAK8N,aAAe4wE,EAAO5wE,aAC3B9N,KAAK+N,aAAe2wE,EAAO3wE,aAEpB/N,MA6BRizB,GAAqBwgD,UAAY7xE,OAAOqvF,OAAQj+D,GAAqBygD,WACrExgD,GAAqBwgD,UAAUlJ,YAAct3C,GAE7CA,GAAqBwgD,UAAU9vB,wBAAyB,EAExD1wB,GAAqBwgD,UAAU70D,KAAO,SAAW8/D,GAWhD,MATA1rD,IAAqBygD,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAEhD1+E,KAAKgX,SAAY+sD,SAAY,IAE7B/jE,KAAKuW,aAAemoE,EAAOnoE,aAE3BvW,KAAK2mD,UAAY+3B,EAAO/3B,UACxB3mD,KAAK4mD,mBAAqB83B,EAAO93B,mBAE1B5mD,MA8GR8yB,GAAkB2gD,UAAY7xE,OAAOqvF,OAAQ59E,EAASogE,WACtD3gD,GAAkB2gD,UAAUlJ,YAAcz3C,GAE1CA,GAAkB2gD,UAAUnxB,qBAAsB,EAElDxvB,GAAkB2gD,UAAU70D,KAAO,SAAW8/D,GAiD7C,MA/CArrE,GAASogE,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAEpC1+E,KAAKgN,MAAM4R,KAAM8/D,EAAO1xE,OACxBhN,KAAKmmD,SAASvnC,KAAM8/D,EAAOv4B,UAC3BnmD,KAAKomD,UAAYs4B,EAAOt4B,UAExBpmD,KAAK6V,IAAM6oE,EAAO7oE,IAElB7V,KAAK8V,SAAW4oE,EAAO5oE,SACvB9V,KAAK+V,kBAAoB2oE,EAAO3oE,kBAEhC/V,KAAKgW,MAAQ0oE,EAAO1oE,MACpBhW,KAAKiW,eAAiByoE,EAAOzoE,eAE7BjW,KAAKmlD,SAASvmC,KAAM8/D,EAAOv5B,UAC3BnlD,KAAKgvB,YAAc0vD,EAAO1vD,YAC1BhvB,KAAKolD,kBAAoBs5B,EAAOt5B,kBAEhCplD,KAAKsrB,QAAUozD,EAAOpzD,QACtBtrB,KAAKqmD,UAAYq4B,EAAOr4B,UAExBrmD,KAAKurB,UAAYmzD,EAAOnzD,UACxBvrB,KAAKm0B,cAAgBuqD,EAAOvqD,cAC5Bn0B,KAAKsmD,YAAY1nC,KAAM8/D,EAAOp4B,aAE9BtmD,KAAKivB,gBAAkByvD,EAAOzvD,gBAC9BjvB,KAAK06B,kBAAoBgkD,EAAOhkD,kBAChC16B,KAAK26B,iBAAmB+jD,EAAO/jD,iBAE/B36B,KAAKkW,YAAcwoE,EAAOxoE,YAE1BlW,KAAKmW,SAAWuoE,EAAOvoE,SAEvBnW,KAAKoW,OAASsoE,EAAOtoE,OACrBpW,KAAKqW,QAAUqoE,EAAOroE,QACtBrW,KAAKuW,aAAemoE,EAAOnoE,aAC3BvW,KAAKwW,gBAAkBkoE,EAAOloE,gBAE9BxW,KAAKyW,UAAYioE,EAAOjoE,UACxBzW,KAAK0W,mBAAqBgoE,EAAOhoE,mBACjC1W,KAAK2W,iBAAmB+nE,EAAO/nE,iBAC/B3W,KAAK4W,kBAAoB8nE,EAAO9nE,kBAEhC5W,KAAK6W,SAAW6nE,EAAO7nE,SACvB7W,KAAK8N,aAAe4wE,EAAO5wE,aAC3B9N,KAAK+N,aAAe2wE,EAAO3wE,aAEpB/N,MA0BR+yB,GAAiB0gD,UAAY7xE,OAAOqvF,OAAQn+D,GAAkB2gD,WAC9D1gD,GAAiB0gD,UAAUlJ,YAAcx3C,GAEzCA,GAAiB0gD,UAAUjwB,oBAAqB,EAEhDzwB,GAAiB0gD,UAAU70D,KAAO,SAAW8/D,GAM5C,MAJA5rD,IAAkB2gD,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAE7C1+E,KAAKyvB,YAAcivD,EAAOjvD,YAEnBzvB,MA8DR4yB,GAAmB6gD,UAAY7xE,OAAOqvF,OAAQ59E,EAASogE,WACvD7gD,GAAmB6gD,UAAUlJ,YAAc33C,GAE3CA,GAAmB6gD,UAAUxvB,sBAAuB,EAEpDrxB,GAAmB6gD,UAAU70D,KAAO,SAAW8/D,GAsB9C,MApBArrE,GAASogE,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAEpC1+E,KAAKsrB,QAAUozD,EAAOpzD,QACtBtrB,KAAKqmD,UAAYq4B,EAAOr4B,UAExBrmD,KAAKurB,UAAYmzD,EAAOnzD,UACxBvrB,KAAKm0B,cAAgBuqD,EAAOvqD,cAC5Bn0B,KAAKsmD,YAAY1nC,KAAM8/D,EAAOp4B,aAE9BtmD,KAAKivB,gBAAkByvD,EAAOzvD,gBAC9BjvB,KAAK06B,kBAAoBgkD,EAAOhkD,kBAChC16B,KAAK26B,iBAAmB+jD,EAAO/jD,iBAE/B36B,KAAKyW,UAAYioE,EAAOjoE,UACxBzW,KAAK0W,mBAAqBgoE,EAAOhoE,mBAEjC1W,KAAK6W,SAAW6nE,EAAO7nE,SACvB7W,KAAK8N,aAAe4wE,EAAO5wE,aAC3B9N,KAAK+N,aAAe2wE,EAAO3wE,aAEpB/N,MAoFR6yB,GAAoB4gD,UAAY7xE,OAAOqvF,OAAQ59E,EAASogE,WACxD5gD,GAAoB4gD,UAAUlJ,YAAc13C,GAE5CA,GAAoB4gD,UAAU/wB,uBAAwB,EAEtD7vB,GAAoB4gD,UAAU70D,KAAO,SAAW8/D,GAoC/C,MAlCArrE,GAASogE,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAEpC1+E,KAAKgN,MAAM4R,KAAM8/D,EAAO1xE,OAExBhN,KAAK6V,IAAM6oE,EAAO7oE,IAElB7V,KAAK8V,SAAW4oE,EAAO5oE,SACvB9V,KAAK+V,kBAAoB2oE,EAAO3oE,kBAEhC/V,KAAKgW,MAAQ0oE,EAAO1oE,MACpBhW,KAAKiW,eAAiByoE,EAAOzoE,eAE7BjW,KAAKmlD,SAASvmC,KAAM8/D,EAAOv5B,UAC3BnlD,KAAKgvB,YAAc0vD,EAAO1vD,YAC1BhvB,KAAKolD,kBAAoBs5B,EAAOt5B,kBAEhCplD,KAAKkW,YAAcwoE,EAAOxoE,YAE1BlW,KAAKmW,SAAWuoE,EAAOvoE,SAEvBnW,KAAKoW,OAASsoE,EAAOtoE,OACrBpW,KAAKqW,QAAUqoE,EAAOroE,QACtBrW,KAAKuW,aAAemoE,EAAOnoE,aAC3BvW,KAAKwW,gBAAkBkoE,EAAOloE,gBAE9BxW,KAAKyW,UAAYioE,EAAOjoE,UACxBzW,KAAK0W,mBAAqBgoE,EAAOhoE,mBACjC1W,KAAK2W,iBAAmB+nE,EAAO/nE,iBAC/B3W,KAAK4W,kBAAoB8nE,EAAO9nE,kBAEhC5W,KAAK6W,SAAW6nE,EAAO7nE,SACvB7W,KAAK8N,aAAe4wE,EAAO5wE,aAC3B9N,KAAK+N,aAAe2wE,EAAO3wE,aAEpB/N,MAiCRmzB,GAAmBsgD,UAAY7xE,OAAOqvF,OAAQ/9D,GAAkBugD,WAChEtgD,GAAmBsgD,UAAUlJ,YAAcp3C,GAE3CA,GAAmBsgD,UAAUpvB,sBAAuB,EAEpDlxB,GAAmBsgD,UAAU70D,KAAO,SAAW8/D,GAQ9C,MANAxrD,IAAkBugD,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAE7C1+E,KAAK+K,MAAQ2zE,EAAO3zE,MACpB/K,KAAK0lD,SAAWg5B,EAAOh5B,SACvB1lD,KAAK4lD,QAAU84B,EAAO94B,QAEf5lD,KAMR,IAAI4/G,IAAyBh+G,OAAO+9G,QACnCtsF,eAAgBA,GAChBC,eAAgBA,GAChBswC,kBAAmBA,GACnB7sD,eAAgBA,EAChBqc,eAAgBA,GAChBH,qBAAsBA,GACtBD,qBAAsBA,GACtBF,kBAAmBA,GACnBC,iBAAkBA,GAClBH,mBAAoBA,GACpBC,oBAAqBA,GACrBH,kBAAmBA,GACnBC,qBAAsBA,GACtB/c,kBAAmBA,EACnBud,mBAAoBA,GACpBD,kBAAmBA,GACnB7f,SAAUA,IAOPwsG,IAEH1gG,SAAS,EAET2gG,SAEAzgF,IAAK,SAAW1J,EAAKoqF,GAEf//G,KAAKmf,WAAY,IAItBnf,KAAK8/G,MAAOnqF,GAAQoqF,IAIrB12G,IAAK,SAAWssB,GAEf,GAAK31B,KAAKmf,WAAY,EAItB,MAAOnf,MAAK8/G,MAAOnqF,IAIpBnsB,OAAQ,SAAWmsB,SAEX31B,MAAK8/G,MAAOnqF,IAIpBlc,MAAO,WAENzZ,KAAK8/G,WAoGH36C,GAAwB,GAAIlB,IAM5B+7C,KAQJp+G,QAAO48E,OAAQvZ,GAAWwO,WAEzBwsC,KAAM,SAAWt7C,EAAKT,EAAQC,EAAYC,GAE5BtjE,SAAR6jE,IAAoBA,EAAM,IAEZ7jE,SAAdd,KAAKooB,OAAqBu8C,EAAM3kE,KAAKooB,KAAOu8C,GAEjDA,EAAM3kE,KAAKklE,QAAQJ,WAAYH,EAE/B,IAAInyD,GAAQxS,KAERkgH,EAASL,GAAMx2G,IAAKs7D,EAExB,IAAgB7jE,SAAXo/G,EAYJ,MAVA1tG,GAAM0yD,QAAQR,UAAWC,GAEzBw7C,WAAY,WAENj8C,GAASA,EAAQg8C,GAEtB1tG,EAAM0yD,QAAQN,QAASD,IAErB,GAEIu7C,CAMR,IAAwBp/G,SAAnBk/G,GAASr7C,GAUb,WARAq7C,IAASr7C,GAAMvyD,MAEd8xD,OAAQA,EACRC,WAAYA,EACZC,QAASA,GASX,IAAIg8C,GAAe,8BACfC,EAAqB17C,EAAIn8C,MAAO43F,EAGpC,IAAKC,EAAqB,CAEzB,GAAIC,GAAWD,EAAoB,GAC/BE,IAAcF,EAAoB,GAClC37G,EAAO27G,EAAoB,EAE/B37G,GAAOq0C,OAAOynE,mBAAoB97G,GAE7B67G,IAAW77G,EAAOq0C,OAAO0nE,KAAM/7G,GAEpC,KAEC,GAAIg8G,GACAC,GAAiB3gH,KAAK2gH,cAAgB,IAAKp0C,aAE/C,QAASo0C,GAER,IAAK,cACL,IAAK,OAIJ,IAAM,GAFFh0G,GAAO,GAAI/D,YAAYlE,EAAKtE,QAEtB4P,EAAI,EAAGA,EAAItL,EAAKtE,OAAQ4P,IAEjCrD,EAAMqD,GAAMtL,EAAKk8G,WAAY5wG,EAM7B0wG,GAFqB,SAAjBC,EAEO,GAAIE,OAAQl0G,EAAKjF,SAAYjG,KAAM6+G,IAInC3zG,EAAKjF,MAIjB,MAED,KAAK,WAEJ,GAAIo5G,GAAS,GAAIC,UACjBL,GAAWI,EAAOE,gBAAiBt8G,EAAM47G,EAEzC,MAED,KAAK,OAEJI,EAAWvT,KAAKvgC,MAAOloE,EAEvB,MAED,SAECg8G,EAAWh8G,EAObq0C,OAAOonE,WAAY,WAEbj8C,GAASA,EAAQw8C,GAEtBluG,EAAM0yD,QAAQN,QAASD,IAErB,GAEF,MAAQrkE,GAGTy4C,OAAOonE,WAAY,WAEb/7C,GAAUA,EAAS9jE,GAExBkS,EAAM0yD,QAAQN,QAASD,GACvBnyD,EAAM0yD,QAAQL,UAAWF,IAEvB,QAIE,CAINq7C,GAASr7C,MAETq7C,GAASr7C,GAAMvyD,MAEd8xD,OAAQA,EACRC,WAAYA,EACZC,QAASA,GAIV,IAAI68C,GAAU,GAAIC,eAElBD,GAAQE,KAAM,MAAOx8C,GAAK,GAE1Bs8C,EAAQxgG,iBAAkB,OAAQ,SAAWT,GAE5C,GAAI0gG,GAAW1gH,KAAK0gH,QAEpBb,IAAMxgF,IAAKslC,EAAK+7C,EAEhB,IAAIU,GAAYpB,GAASr7C,EAIzB,UAFOq7C,IAASr7C,GAEK,MAAhB3kE,KAAKqhH,QAAkC,IAAhBrhH,KAAKqhH,OAAe,CAK1B,IAAhBrhH,KAAKqhH,QAAehhH,QAAQ4H,KAAM,4CAEvC,KAAM,GAAI+H,GAAI,EAAGyuB,EAAK2iF,EAAUhhH,OAAQ4P,EAAIyuB,EAAIzuB,IAAO,CAEtD,GAAIlJ,GAAWs6G,EAAWpxG,EACrBlJ,GAASo9D,QAASp9D,EAASo9D,OAAQw8C,GAIzCluG,EAAM0yD,QAAQN,QAASD,OAEjB,CAEN,IAAM,GAAI30D,GAAI,EAAGyuB,EAAK2iF,EAAUhhH,OAAQ4P,EAAIyuB,EAAIzuB,IAAO,CAEtD,GAAIlJ,GAAWs6G,EAAWpxG,EACrBlJ,GAASs9D,SAAUt9D,EAASs9D,QAASpkD,GAI3CxN,EAAM0yD,QAAQN,QAASD,GACvBnyD,EAAM0yD,QAAQL,UAAWF,MAIxB,GAEHs8C,EAAQxgG,iBAAkB,WAAY,SAAWT,GAIhD,IAAM,GAFFohG,GAAYpB,GAASr7C,GAEf30D,EAAI,EAAGyuB,EAAK2iF,EAAUhhH,OAAQ4P,EAAIyuB,EAAIzuB,IAAO,CAEtD,GAAIlJ,GAAWs6G,EAAWpxG,EACrBlJ,GAASq9D,YAAar9D,EAASq9D,WAAYnkD,MAI/C,GAEHihG,EAAQxgG,iBAAkB,QAAS,SAAWT,GAE7C,GAAIohG,GAAYpB,GAASr7C,SAElBq7C,IAASr7C,EAEhB,KAAM,GAAI30D,GAAI,EAAGyuB,EAAK2iF,EAAUhhH,OAAQ4P,EAAIyuB,EAAIzuB,IAAO,CAEtD,GAAIlJ,GAAWs6G,EAAWpxG,EACrBlJ,GAASs9D,SAAUt9D,EAASs9D,QAASpkD,GAI3CxN,EAAM0yD,QAAQN,QAASD,GACvBnyD,EAAM0yD,QAAQL,UAAWF,KAEvB,GAEHs8C,EAAQxgG,iBAAkB,QAAS,SAAWT,GAE7C,GAAIohG,GAAYpB,GAASr7C,SAElBq7C,IAASr7C,EAEhB,KAAM,GAAI30D,GAAI,EAAGyuB,EAAK2iF,EAAUhhH,OAAQ4P,EAAIyuB,EAAIzuB,IAAO,CAEtD,GAAIlJ,GAAWs6G,EAAWpxG,EACrBlJ,GAASs9D,SAAUt9D,EAASs9D,QAASpkD,GAI3CxN,EAAM0yD,QAAQN,QAASD,GACvBnyD,EAAM0yD,QAAQL,UAAWF,KAEvB,GAEwB7jE,SAAtBd,KAAK2gH,eAA6BM,EAAQN,aAAe3gH,KAAK2gH,cACrC7/G,SAAzBd,KAAKitE,kBAAgCg0C,EAAQh0C,gBAAkBjtE,KAAKitE,iBAEpEg0C,EAAQK,kBAAmBL,EAAQK,iBAAoCxgH,SAAlBd,KAAKsgH,SAAyBtgH,KAAKsgH,SAAW,aAExG,KAAM,GAAIiB,KAAUvhH,MAAKwhH,cAExBP,EAAQQ,iBAAkBF,EAAQvhH,KAAKwhH,cAAeD,GAIvDN,GAAQS,KAAM,MAMf,MAFAlvG,GAAM0yD,QAAQR,UAAWC,GAElBs8C,GAIRU,QAAS,SAAW7/G,GAGnB,MADA9B,MAAKooB,KAAOtmB,EACL9B,MAIR4hH,gBAAiB,SAAW9/G,GAG3B,MADA9B,MAAK2gH,aAAe7+G,EACb9B,MAIR6hH,mBAAoB,SAAW//G,GAG9B,MADA9B,MAAKitE,gBAAkBnrE,EAChB9B,MAIR8hH,YAAa,SAAWhgH,GAGvB,MADA9B,MAAKsgH,SAAWx+G,EACT9B,MAIRyhH,iBAAkB,SAAW3/G,GAG5B,MADA9B,MAAKwhH,cAAgB1/G,EACd9B,QAqBT4B,OAAO48E,OAAQpZ,GAAwBqO,WAEtCwsC,KAAM,SAAWt7C,EAAKT,EAAQC,EAAYC,GAazC,QAAS29C,GAAa/xG,GAErBgyG,EAAO/B,KAAMt7C,EAAK30D,GAAK,SAAWtI,GAEjC,GAAIu6G,GAAWzvG,EAAM6yD,QAAS39D,GAAQ,EAEtC8b,GAAQxT,IACPrM,MAAOs+G,EAASt+G,MAChBC,OAAQq+G,EAASr+G,OACjBpC,OAAQygH,EAASzgH,OACjBa,QAAS4/G,EAAS5/G,SAGnB6/G,GAAU,EAEM,IAAXA,IAE0B,IAAzBD,EAASE,cACbl+G,EAAQ1C,UAAYiB,IAErByB,EAAQzC,OAASygH,EAASzgH,OAC1ByC,EAAQ0R,aAAc,EAEjBuuD,GAASA,EAAQjgE,KAIrBkgE,EAAYC,GAtChB,GAAI5xD,GAAQxS,KAERwjB,KAEAvf,EAAU,GAAI8pD,GAClB9pD,GAAQ/C,MAAQsiB,CAEhB,IAAIw+F,GAAS,GAAI/8C,IAAYjlE,KAAKklE,QAmClC,IAlCA88C,EAAOL,QAAS3hH,KAAKooB,MACrB45F,EAAOJ,gBAAiB,eAiCnBx0G,MAAMC,QAASs3D,GAInB,IAAM,GAFFu9C,GAAS,EAEHlyG,EAAI,EAAGyuB,EAAKkmC,EAAIvkE,OAAQ4P,EAAIyuB,IAAOzuB,EAE5C+xG,EAAa/xG,OAQdgyG,GAAO/B,KAAMt7C,EAAK,SAAWj9D,GAE5B,GAAIu6G,GAAWzvG,EAAM6yD,QAAS39D,GAAQ,EAEtC,IAAKu6G,EAASG,UAIb,IAAM,GAFFx0G,GAAQq0G,EAAS5/G,QAAQjC,OAAS6hH,EAASE,YAErC92E,EAAI,EAAGA,EAAIz9B,EAAOy9B,IAAO,CAElC7nB,EAAQ6nB,IAAQhpC,WAEhB,KAAM,GAAI2N,GAAI,EAAGA,EAAIiyG,EAASE,YAAanyG,IAE1CwT,EAAQ6nB,GAAIhpC,QAAQ+P,KAAM6vG,EAAS5/G,QAASgpC,EAAI42E,EAASE,YAAcnyG,IACvEwT,EAAQ6nB,GAAI7pC,OAASygH,EAASzgH,OAC9BgiB,EAAQ6nB,GAAI1nC,MAAQs+G,EAASt+G,MAC7B6f,EAAQ6nB,GAAIznC,OAASq+G,EAASr+G,WAQhCK,GAAQ/C,MAAMyC,MAAQs+G,EAASt+G,MAC/BM,EAAQ/C,MAAM0C,OAASq+G,EAASr+G,OAChCK,EAAQ5B,QAAU4/G,EAAS5/G,OAIE,KAAzB4/G,EAASE,cAEbl+G,EAAQ1C,UAAYiB,IAIrByB,EAAQzC,OAASygH,EAASzgH,OAC1ByC,EAAQ0R,aAAc,EAEjBuuD,GAASA,EAAQjgE,IAEpBkgE,EAAYC,EAIhB,OAAOngE,IAIR09G,QAAS,SAAW7/G,GAGnB,MADA9B,MAAKooB,KAAOtmB,EACL9B,QAqBT4B,OAAO48E,OAAQlZ,GAAkBmO,WAEhCwsC,KAAM,SAAWt7C,EAAKT,EAAQC,EAAYC,GAEzC,GAAI5xD,GAAQxS,KAERiE,EAAU,GAAIQ,GAEdu9G,EAAS,GAAI/8C,IAAYjlE,KAAKklE,QA2DlC,OA1DA88C,GAAOJ,gBAAiB,eAExBI,EAAO/B,KAAMt7C,EAAK,SAAWj9D,GAE5B,GAAI26G,GAAU7vG,EAAM6yD,QAAS39D,EAEtB26G,KAEFvhH,SAAcuhH,EAAQnhH,MAE1B+C,EAAQ/C,MAAQmhH,EAAQnhH,MAEbJ,SAAcuhH,EAAQ39G,OAEjCT,EAAQ/C,MAAMyC,MAAQ0+G,EAAQ1+G,MAC9BM,EAAQ/C,MAAM0C,OAASy+G,EAAQz+G,OAC/BK,EAAQ/C,MAAMwD,KAAO29G,EAAQ39G,MAI9BT,EAAQ7C,MAAQN,SAAcuhH,EAAQjhH,MAAQihH,EAAQjhH,MAAQmB,GAC9D0B,EAAQ5C,MAAQP,SAAcuhH,EAAQhhH,MAAQghH,EAAQhhH,MAAQkB,GAE9D0B,EAAQ3C,UAAYR,SAAcuhH,EAAQ/gH,UAAY+gH,EAAQ/gH,UAAYkB,GAC1EyB,EAAQ1C,UAAYT,SAAcuhH,EAAQ9gH,UAAY8gH,EAAQ9gH,UAAYkB,GAE1EwB,EAAQvC,WAAaZ,SAAcuhH,EAAQ3gH,WAAa2gH,EAAQ3gH,WAAa,EAExEZ,SAAcuhH,EAAQ7gH,SAE1ByC,EAAQzC,OAAS6gH,EAAQ7gH,QAGrBV,SAAcuhH,EAAQ5gH,OAE1BwC,EAAQxC,KAAO4gH,EAAQ5gH,MAInBX,SAAcuhH,EAAQhgH,UAE1B4B,EAAQ5B,QAAUggH,EAAQhgH,SAItB,IAAMggH,EAAQF,cAElBl+G,EAAQ1C,UAAYiB,IAIrByB,EAAQ0R,aAAc,EAEjBuuD,GAASA,EAAQjgE,EAASo+G,KAE7Bl+C,EAAYC,GAGRngE,KAiBTrC,OAAO48E,OAAQjZ,GAAYkO,WAE1B6uC,YAAa,YAEbrC,KAAM,SAAWt7C,EAAKT,EAAQC,EAAYC,GA8BzC,QAASm+C,KAERrhH,EAAMmf,oBAAqB,OAAQkiG,GAAa,GAChDrhH,EAAMmf,oBAAqB,QAASmiG,GAAc,GAElD3C,GAAMxgF,IAAKslC,EAAK3kE,MAEXkkE,GAASA,EAAQlkE,MAEtBwS,EAAM0yD,QAAQN,QAASD,GAIxB,QAAS69C,GAAcxiG,GAEtB9e,EAAMmf,oBAAqB,OAAQkiG,GAAa,GAChDrhH,EAAMmf,oBAAqB,QAASmiG,GAAc,GAE7Cp+C,GAAUA,EAASpkD,GAExBxN,EAAM0yD,QAAQN,QAASD,GACvBnyD,EAAM0yD,QAAQL,UAAWF,GAjDb7jE,SAAR6jE,IAAoBA,EAAM,IAEZ7jE,SAAdd,KAAKooB,OAAqBu8C,EAAM3kE,KAAKooB,KAAOu8C,GAEjDA,EAAM3kE,KAAKklE,QAAQJ,WAAYH,EAE/B,IAAInyD,GAAQxS,KAERkgH,EAASL,GAAMx2G,IAAKs7D,EAExB,IAAgB7jE,SAAXo/G,EAYJ,MAVA1tG,GAAM0yD,QAAQR,UAAWC,GAEzBw7C,WAAY,WAENj8C,GAASA,EAAQg8C,GAEtB1tG,EAAM0yD,QAAQN,QAASD,IAErB,GAEIu7C,CAIR,IAAIh/G,GAAQsoC,SAASC,gBAAiB,+BAAgC,MAwCtE,OAbAvoC,GAAMuf,iBAAkB,OAAQ8hG,GAAa,GAC7CrhH,EAAMuf,iBAAkB,QAAS+hG,GAAc,GAEnB,UAAvB79C,EAAI89C,OAAQ,EAAG,IAEO3hH,SAArBd,KAAKsiH,cAA4BphH,EAAMohH,YAActiH,KAAKsiH,aAIhE9vG,EAAM0yD,QAAQR,UAAWC,GAEzBzjE,EAAMwhH,IAAM/9C,EAELzjE,GAIRyhH,eAAgB,SAAW7gH,GAG1B,MADA9B,MAAKsiH,YAAcxgH,EACZ9B,MAIR2hH,QAAS,SAAW7/G,GAGnB,MADA9B,MAAKooB,KAAOtmB,EACL9B,QAiBT4B,OAAO48E,OAAQhZ,GAAkBiO,WAEhC6uC,YAAa,YAEbrC,KAAM,SAAW2C,EAAM1+C,EAAQC,EAAYC,GAU1C,QAAS29C,GAAa/xG,GAErBgyG,EAAO/B,KAAM2C,EAAM5yG,GAAK,SAAW9O,GAElC+C,EAAQuf,OAAQxT,GAAM9O,EAEtBghH,IAEgB,IAAXA,IAEJj+G,EAAQ0R,aAAc,EAEjBuuD,GAASA,EAAQjgE,KAIrBnD,OAAWsjE,GAxBf,GAAIngE,GAAU,GAAIsf,IAEdy+F,EAAS,GAAIz8C,IAAavlE,KAAKklE,QACnC88C,GAAOW,eAAgB3iH,KAAKsiH,aAC5BN,EAAOL,QAAS3hH,KAAKooB,KAwBrB,KAAM,GAtBF85F,GAAS,EAsBHlyG,EAAI,EAAGA,EAAI4yG,EAAKxiH,SAAW4P,EAEpC+xG,EAAa/xG,EAId,OAAO/L,IAIR0+G,eAAgB,SAAW7gH,GAG1B,MADA9B,MAAKsiH,YAAcxgH,EACZ9B,MAIR2hH,QAAS,SAAW7/G,GAGnB,MADA9B,MAAKooB,KAAOtmB,EACL9B,QAiBT4B,OAAO48E,OAAQ/Y,GAAcgO,WAE5B6uC,YAAa,YAEbrC,KAAM,SAAWt7C,EAAKT,EAAQC,EAAYC,GAEzC,GAAIngE,GAAU,GAAIhD,GAEd+gH,EAAS,GAAIz8C,IAAavlE,KAAKklE,QAsBnC,OArBA88C,GAAOW,eAAgB3iH,KAAKsiH,aAC5BN,EAAOL,QAAS3hH,KAAKooB,MAErB45F,EAAO/B,KAAMt7C,EAAK,SAAWzjE,GAE5B+C,EAAQ/C,MAAQA,CAGhB,IAAI2hH,GAASl+C,EAAIm+C,OAAQ,aAAgB,GAA4C,IAAvCn+C,EAAIm+C,OAAQ,qBAE1D7+G,GAAQzC,OAASqhH,EAASl1E,GAAYjrC,GACtCuB,EAAQ0R,aAAc,EAEN7U,SAAXojE,GAEJA,EAAQjgE,IAIPkgE,EAAYC,GAERngE,GAIR0+G,eAAgB,SAAW7gH,GAG1B,MADA9B,MAAKsiH,YAAcxgH,EACZ9B,MAIR2hH,QAAS,SAAW7/G,GAGnB,MADA9B,MAAKooB,KAAOtmB,EACL9B,QAiDT4B,OAAO48E,OAAQ9Y,GAAM+N,WAKpBsvC,SAAU,WAGT,MADA1iH,SAAQ4H,KAAM,6CACP,MAORmrD,WAAY,SAAWliD,EAAG8xG,GAEzB,GAAI5wD,GAAIpyD,KAAKijH,eAAgB/xG,EAC7B,OAAOlR,MAAK+iH,SAAU3wD,EAAG4wD,IAM1BE,UAAW,SAAWxpC,GAEF54E,SAAd44E,IAA0BA,EAAY,EAI3C,KAAM,GAFFz3D,MAEM3P,EAAI,EAAGA,GAAKonE,EAAWpnE,IAEhC2P,EAAO7P,KAAMpS,KAAK+iH,SAAUzwG,EAAIonE,GAIjC,OAAOz3D,IAMRu8C,gBAAiB,SAAWkb,GAER54E,SAAd44E,IAA0BA,EAAY,EAI3C,KAAM,GAFFz3D,MAEM3P,EAAI,EAAGA,GAAKonE,EAAWpnE,IAEhC2P,EAAO7P,KAAMpS,KAAKozD,WAAY9gD,EAAIonE,GAInC,OAAOz3D,IAMRkhG,UAAW,WAEV,GAAIC,GAAUpjH,KAAKqjH,YACnB,OAAOD,GAASA,EAAQhjH,OAAS,IAMlCijH,WAAY,SAAW3pC,GAItB,GAFmB54E,SAAd44E,IAA0BA,EAAY15E,KAAK2lE,oBAE3C3lE,KAAKsjH,iBACPtjH,KAAKsjH,gBAAgBljH,SAAWs5E,EAAY,IAC5C15E,KAAK2V,YAEP,MAAO3V,MAAKsjH,eAIbtjH,MAAK2V,aAAc,CAEnB,IACI4tG,GACApuF,EAFA5V,KACSy1C,EAAOh1D,KAAK+iH,SAAU,GAC5BppD,EAAM,CAIb,KAFAp6C,EAAMnN,KAAM,GAEN+iB,EAAI,EAAGA,GAAKukD,EAAWvkD,IAE5BouF,EAAUvjH,KAAK+iH,SAAU5tF,EAAIukD,GAC7B/f,GAAO4pD,EAAQpgC,WAAYnuB,GAC3Bz1C,EAAMnN,KAAMunD,GACZ3E,EAAOuuD,CAMR,OAFAvjH,MAAKsjH,gBAAkB/jG,EAEhBA,GAIRikG,iBAAkB,WAEjBxjH,KAAK2V,aAAc,EACnB3V,KAAKqjH,cAMNJ,eAAgB,SAAW/xG,EAAG4lB,GAE7B,GAII2sF,GAJAC,EAAa1jH,KAAKqjH,aAElBrzG,EAAI,EAAGyuB,EAAKilF,EAAWtjH,MAM1BqjH,GAFI3sF,EAEcA,EAIA5lB,EAAIwyG,EAAYjlF,EAAK,EAQxC,KAFA,GAA4BklF,GAAxBviC,EAAM,EAAGC,EAAO5iD,EAAK,EAEjB2iD,GAAOC,GAMd,GAJArxE,EAAI2C,KAAKC,MAAOwuE,GAAQC,EAAOD,GAAQ,GAEvCuiC,EAAaD,EAAY1zG,GAAMyzG,EAE1BE,EAAa,EAEjBviC,EAAMpxE,EAAI,MAEJ,CAAA,KAAK2zG,EAAa,GAIlB,CAENtiC,EAAOrxE,CACP,OALAqxE,EAAOrxE,EAAI,EAeb,GAFAA,EAAIqxE,EAECqiC,EAAY1zG,KAAQyzG,EAExB,MAAOzzG,IAAMyuB,EAAK,EAMnB,IAAImlF,GAAeF,EAAY1zG,GAC3B6zG,EAAcH,EAAY1zG,EAAI,GAE9B8zG,EAAgBD,EAAcD,EAI9BG,GAAoBN,EAAkBG,GAAiBE,EAIvD1xD,GAAMpiD,EAAI+zG,IAAsBtlF,EAAK,EAEzC,OAAO2zB,IASR4xD,WAAY,SAAW5xD,GAEtB,GAAI4iC,GAAQ,KACRvuB,EAAKrU,EAAI4iC,EACT3tB,EAAKjV,EAAI4iC,CAIRvuB,GAAK,IAAIA,EAAK,GACdY,EAAK,IAAIA,EAAK,EAEnB,IAAI48C,GAAMjkH,KAAK+iH,SAAUt8C,GACrBy9C,EAAMlkH,KAAK+iH,SAAU17C,GAErB/M,EAAM4pD,EAAIr5G,QAAQwtB,IAAK4rF,EAC3B,OAAO3pD,GAAI3gC,aAIZwqF,aAAc,SAAWjzG,GAExB,GAAIkhD,GAAIpyD,KAAKijH,eAAgB/xG,EAC7B,OAAOlR,MAAKgkH,WAAY5xD,IAIzBqB,oBAAqB,SAAWuN,EAAUtO,GAIzC,GASI1iD,GAAGkB,EAAG+xD,EATN99D,EAAS,GAAIpE,GAEb+xD,KACAnjD,KACAojD,KAEAuH,EAAM,GAAIv5D,GACVqjH,EAAM,GAAInkH,EAMd,KAAM+P,EAAI,EAAGA,GAAKgxD,EAAUhxD,IAE3BkB,EAAIlB,EAAIgxD,EAERlO,EAAU9iD,GAAMhQ,KAAKmkH,aAAcjzG,GACnC4hD,EAAU9iD,GAAI2pB,WAOfhqB,GAAS,GAAM,GAAI5O,GACnBgyD,EAAW,GAAM,GAAIhyD,EACrB,IAAI8D,GAAMu2D,OAAOipD,UACbp6B,EAAKt3E,KAAK4P,IAAKuwC,EAAU,GAAIhzD,GAC7BoqF,EAAKv3E,KAAK4P,IAAKuwC,EAAU,GAAI/yD,GAC7BukH,EAAK3xG,KAAK4P,IAAKuwC,EAAU,GAAItyD,EA8BjC,KA5BKypF,GAAMplF,IAEVA,EAAMolF,EACN9kF,EAAOc,IAAK,EAAG,EAAG,IAIdikF,GAAMrlF,IAEVA,EAAMqlF,EACN/kF,EAAOc,IAAK,EAAG,EAAG,IAIdq+G,GAAMz/G,GAEVM,EAAOc,IAAK,EAAG,EAAG,GAInBq0D,EAAI5K,aAAcoD,EAAU,GAAK3tD,GAASw0B,YAE1ChqB,EAAS,GAAI+/C,aAAcoD,EAAU,GAAKwH,GAC1CvH,EAAW,GAAIrD,aAAcoD,EAAU,GAAKnjD,EAAS,IAK/CK,EAAI,EAAGA,GAAKgxD,EAAUhxD,IAE3BL,EAASK,GAAML,EAASK,EAAI,GAAInF,QAEhCkoD,EAAW/iD,GAAM+iD,EAAW/iD,EAAI,GAAInF,QAEpCyvD,EAAI5K,aAAcoD,EAAU9iD,EAAI,GAAK8iD,EAAU9iD,IAE1CsqD,EAAIl6D,SAAWg7D,OAAOC,UAE1Bf,EAAI3gC,YAEJspC,EAAQtwD,KAAKm7E,KAAM7rF,GAAMi/D,MAAOpO,EAAU9iD,EAAI,GAAIwyD,IAAK1P,EAAU9iD,OAAY,IAE7EL,EAASK,GAAI6O,aAAculG,EAAIr6B,iBAAkBzvB,EAAK2I,KAIvDlQ,EAAW/iD,GAAI0/C,aAAcoD,EAAU9iD,GAAKL,EAASK,GAMtD,IAAK0iD,KAAW,EAWf,IATAuQ,EAAQtwD,KAAKm7E,KAAM7rF,GAAMi/D,MAAOvxD,EAAS,GAAI6yD,IAAK7yD,EAASqxD,OAAmB,IAC9EiC,GAASjC,EAEJlO,EAAU,GAAI0P,IAAKlI,EAAI5K,aAAc//C,EAAS,GAAKA,EAASqxD,KAAiB,IAEjFiC,GAAUA,GAILjzD,EAAI,EAAGA,GAAKgxD,EAAUhxD,IAG3BL,EAASK,GAAI6O,aAAculG,EAAIr6B,iBAAkBj3B,EAAU9iD,GAAKizD,EAAQjzD,IACxE+iD,EAAW/iD,GAAI0/C,aAAcoD,EAAU9iD,GAAKL,EAASK,GAMvD,QACC8iD,SAAUA,EACVnjD,QAASA,EACTojD,UAAWA,IAKbloD,MAAO,WAEN,OAAO,GAAI7K,MAAKuqE,aAAc3rD,KAAM5e,OAIrC4e,KAAM,SAAW8/D,GAIhB,MAFA1+E,MAAK2lE,mBAAqB+Y,EAAO/Y,mBAE1B3lE,MAIRs/D,OAAQ,WAEP,GAAI56D,IACH0sF,UACC7tF,QAAS,IACT9B,KAAM,QACN4vF,UAAW,gBAOb,OAHA3sF,GAAKihE,mBAAqB3lE,KAAK2lE,mBAC/BjhE,EAAKjD,KAAOzB,KAAKyB,KAEViD,GAIR6/G,SAAU,SAAW93C,GAIpB,MAFAzsE,MAAK2lE,mBAAqB8G,EAAK9G,mBAExB3lE,QA2BT4lE,GAAa6N,UAAY7xE,OAAOqvF,OAAQvrB,GAAM+N,WAC9C7N,GAAa6N,UAAUlJ,YAAc3E,GAErCA,GAAa6N,UAAU+wC,gBAAiB,EAExC5+C,GAAa6N,UAAUsvC,SAAW,SAAW3wD,EAAG4wD,GAS/C,IAPA,GAAIvuF,GAAQuuF,GAAkB,GAAInjH,GAE9B4kH,EAAkB,EAAV9xG,KAAKi+C,GACb8zD,EAAa1kH,KAAKkmE,UAAYlmE,KAAKimE,YACnC0+C,EAAahyG,KAAK4P,IAAKmiG,GAAetpD,OAAOC,QAGzCqpD,EAAa,GAAIA,GAAcD,CACvC,MAAQC,EAAaD,GAAQC,GAAcD,CAEtCC,GAAatpD,OAAOC,UAIvBqpD,EAFIC,EAES,EAIAF,GAMVzkH,KAAKmmE,cAAe,GAAUw+C,IAE7BD,IAAeD,EAEnBC,GAAeD,EAIfC,GAA0BD,EAM5B,IAAI5rF,GAAQ74B,KAAKimE,YAAc7T,EAAIsyD,EAC/B5kH,EAAIE,KAAK6lE,GAAK7lE,KAAK+lE,QAAUpzD,KAAKimB,IAAKC,GACvC94B,EAAIC,KAAK8lE,GAAK9lE,KAAKgmE,QAAUrzD,KAAK6gD,IAAK36B,EAE3C,IAAwB,IAAnB74B,KAAKomE,UAAkB,CAE3B,GAAIxtC,GAAMjmB,KAAKimB,IAAK54B,KAAKomE,WACrB5S,EAAM7gD,KAAK6gD,IAAKxzD,KAAKomE,WAErB6jB,EAAKnqF,EAAIE,KAAK6lE,GACdqkB,EAAKnqF,EAAIC,KAAK8lE,EAGlBhmE,GAAImqF,EAAKrxD,EAAMsxD,EAAK12B,EAAMxzD,KAAK6lE,GAC/B9lE,EAAIkqF,EAAKz2B,EAAM02B,EAAKtxD,EAAM54B,KAAK8lE,GAIhC,MAAOrxC,GAAMxuB,IAAKnG,EAAGC,IAItB6lE,GAAa6N,UAAU70D,KAAO,SAAW8/D,GAiBxC,MAfAhZ,IAAM+N,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAEjC1+E,KAAK6lE,GAAK6Y,EAAO7Y,GACjB7lE,KAAK8lE,GAAK4Y,EAAO5Y,GAEjB9lE,KAAK+lE,QAAU2Y,EAAO3Y,QACtB/lE,KAAKgmE,QAAU0Y,EAAO1Y,QAEtBhmE,KAAKimE,YAAcyY,EAAOzY,YAC1BjmE,KAAKkmE,UAAYwY,EAAOxY,UAExBlmE,KAAKmmE,WAAauY,EAAOvY,WAEzBnmE,KAAKomE,UAAYsY,EAAOtY,UAEjBpmE,MAKR4lE,GAAa6N,UAAUnU,OAAS,WAE/B,GAAI56D,GAAOghE,GAAM+N,UAAUnU,OAAOh7D,KAAMtE,KAexC,OAbA0E,GAAKmhE,GAAK7lE,KAAK6lE,GACfnhE,EAAKohE,GAAK9lE,KAAK8lE,GAEfphE,EAAKqhE,QAAU/lE,KAAK+lE,QACpBrhE,EAAKshE,QAAUhmE,KAAKgmE,QAEpBthE,EAAKuhE,YAAcjmE,KAAKimE,YACxBvhE,EAAKwhE,UAAYlmE,KAAKkmE,UAEtBxhE,EAAKyhE,WAAanmE,KAAKmmE,WAEvBzhE,EAAK0hE,UAAYpmE,KAAKomE,UAEf1hE,GAIRkhE,GAAa6N,UAAU8wC,SAAW,SAAW93C,GAiB5C,MAfA/G,IAAM+N,UAAU8wC,SAASjgH,KAAMtE,KAAMysE,GAErCzsE,KAAK6lE,GAAK4G,EAAK5G,GACf7lE,KAAK8lE,GAAK2G,EAAK3G,GAEf9lE,KAAK+lE,QAAU0G,EAAK1G,QACpB/lE,KAAKgmE,QAAUyG,EAAKzG,QAEpBhmE,KAAKimE,YAAcwG,EAAKxG,YACxBjmE,KAAKkmE,UAAYuG,EAAKvG,UAEtBlmE,KAAKmmE,WAAasG,EAAKtG,WAEvBnmE,KAAKomE,UAAYqG,EAAKrG,UAEfpmE,MAYRqmE,GAASoN,UAAY7xE,OAAOqvF,OAAQrrB,GAAa6N,WACjDpN,GAASoN,UAAUlJ,YAAclE,GAEjCA,GAASoN,UAAUmxC,YAAa,CAiFhC,IAAI97B,IAAM,GAAI/nF,GACVg4D,GAAK,GAAIwN,IAAavN,GAAK,GAAIuN,IAAas+C,GAAK,GAAIt+C,GAezDiB,IAAiBiM,UAAY7xE,OAAOqvF,OAAQvrB,GAAM+N,WAClDjM,GAAiBiM,UAAUlJ,YAAc/C,GAEzCA,GAAiBiM,UAAUqxC,oBAAqB,EAEhDt9C,GAAiBiM,UAAUsvC,SAAW,SAAW3wD,EAAG4wD,GAEnD,GAAIvuF,GAAQuuF,GAAkB,GAAIjiH,GAE9BkhB,EAASjiB,KAAKiiB,OACdhS,EAAIgS,EAAO7hB,OAEX+0B,GAAMllB,GAAMjQ,KAAK0yD,OAAS,EAAI,IAAQN,EACtC2yD,EAAWpyG,KAAKC,MAAOuiB,GACvB4gD,EAAS5gD,EAAI4vF,CAEZ/kH,MAAK0yD,OAETqyD,GAAYA,EAAW,EAAI,GAAMpyG,KAAKC,MAAOD,KAAK4P,IAAKwiG,GAAa90G,GAAM,GAAMA,EAE1D,IAAX8lE,GAAgBgvC,IAAa90G,EAAI,IAE5C80G,EAAW90G,EAAI,EACf8lE,EAAS,EAIV,IAAIzwE,GAAIC,EAAIC,EAAIC,CA6BhB,IA3BKzF,KAAK0yD,QAAUqyD,EAAW,EAE9Bz/G,EAAK2c,GAAU8iG,EAAW,GAAM90G,IAKhC64E,GAAIr5B,WAAYxtC,EAAQ,GAAKA,EAAQ,IAAMod,IAAKpd,EAAQ,IACxD3c,EAAKwjF,IAINvjF,EAAK0c,EAAQ8iG,EAAW90G,GACxBzK,EAAKyc,GAAU8iG,EAAW,GAAM90G,GAE3BjQ,KAAK0yD,QAAUqyD,EAAW,EAAI90G,EAElCxK,EAAKwc,GAAU8iG,EAAW,GAAM90G,IAKhC64E,GAAIr5B,WAAYxtC,EAAQhS,EAAI,GAAKgS,EAAQhS,EAAI,IAAMovB,IAAKpd,EAAQhS,EAAI,IACpExK,EAAKqjF,IAIkB,gBAAnB9oF,KAAKynE,WAAkD,YAAnBznE,KAAKynE,UAA0B,CAGvE,GAAIvX,GAAyB,YAAnBlwD,KAAKynE,UAA0B,GAAM,IAC3CP,EAAMv0D,KAAKu9C,IAAK5qD,EAAG89E,kBAAmB79E,GAAM2qD,GAC5CiX,EAAMx0D,KAAKu9C,IAAK3qD,EAAG69E,kBAAmB59E,GAAM0qD,GAC5CkX,EAAMz0D,KAAKu9C,IAAK1qD,EAAG49E,kBAAmB39E,GAAMyqD,EAG3CiX,GAAM,OAAOA,EAAM,GACnBD,EAAM,OAAOA,EAAMC,GACnBC,EAAM,OAAOA,EAAMD,GAExBpO,GAAGkO,yBAA0B3hE,EAAGxF,EAAGyF,EAAGzF,EAAG0F,EAAG1F,EAAG2F,EAAG3F,EAAGonE,EAAKC,EAAKC,GAC/DpO,GAAGiO,yBAA0B3hE,EAAGvF,EAAGwF,EAAGxF,EAAGyF,EAAGzF,EAAG0F,EAAG1F,EAAGmnE,EAAKC,EAAKC,GAC/Dy9C,GAAG59C,yBAA0B3hE,EAAG9E,EAAG+E,EAAG/E,EAAGgF,EAAGhF,EAAGiF,EAAGjF,EAAG0mE,EAAKC,EAAKC,OAEjC,eAAnBpnE,KAAKynE,YAEhB1O,GAAG+N,eAAgBxhE,EAAGxF,EAAGyF,EAAGzF,EAAG0F,EAAG1F,EAAG2F,EAAG3F,EAAGE,KAAKgnE,SAChDhO,GAAG8N,eAAgBxhE,EAAGvF,EAAGwF,EAAGxF,EAAGyF,EAAGzF,EAAG0F,EAAG1F,EAAGC,KAAKgnE,SAChD69C,GAAG/9C,eAAgBxhE,EAAG9E,EAAG+E,EAAG/E,EAAGgF,EAAGhF,EAAGiF,EAAGjF,EAAGR,KAAKgnE,SAUjD,OANAvyC,GAAMxuB,IACL8yD,GAAGuO,KAAMyO,GACT/c,GAAGsO,KAAMyO,GACT8uC,GAAGv9C,KAAMyO,IAGHthD,GAIR+yC,GAAiBiM,UAAU70D,KAAO,SAAW8/D,GAE5ChZ,GAAM+N,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAEjC1+E,KAAKiiB,SAEL,KAAM,GAAIjS,GAAI,EAAGC,EAAIyuE,EAAOz8D,OAAO7hB,OAAQ4P,EAAIC,EAAGD,IAAO,CAExD,GAAIykB,GAAQiqD,EAAOz8D,OAAQjS,EAE3BhQ,MAAKiiB,OAAO7P,KAAMqiB,EAAM5pB,SAQzB,MAJA7K,MAAK0yD,OAASgsB,EAAOhsB,OACrB1yD,KAAKynE,UAAYiX,EAAOjX,UACxBznE,KAAKgnE,QAAU0X,EAAO1X,QAEfhnE,MAIRwnE,GAAiBiM,UAAUnU,OAAS,WAEnC,GAAI56D,GAAOghE,GAAM+N,UAAUnU,OAAOh7D,KAAMtE,KAExC0E,GAAKud,SAEL,KAAM,GAAIjS,GAAI,EAAGC,EAAIjQ,KAAKiiB,OAAO7hB,OAAQ4P,EAAIC,EAAGD,IAAO,CAEtD,GAAIykB,GAAQz0B,KAAKiiB,OAAQjS,EACzBtL,GAAKud,OAAO7P,KAAMqiB,EAAM3V,WAQzB,MAJApa,GAAKguD,OAAS1yD,KAAK0yD,OACnBhuD,EAAK+iE,UAAYznE,KAAKynE,UACtB/iE,EAAKsiE,QAAUhnE,KAAKgnE,QAEbtiE,GAIR8iE,GAAiBiM,UAAU8wC,SAAW,SAAW93C,GAEhD/G,GAAM+N,UAAU8wC,SAASjgH,KAAMtE,KAAMysE,GAErCzsE,KAAKiiB,SAEL,KAAM,GAAIjS,GAAI,EAAGC,EAAIw8D,EAAKxqD,OAAO7hB,OAAQ4P,EAAIC,EAAGD,IAAO,CAEtD,GAAIykB,GAAQg4C,EAAKxqD,OAAQjS,EACzBhQ,MAAKiiB,OAAO7P,MAAM,GAAIrR,IAAUm3C,UAAWzjB,IAQ5C,MAJAz0B,MAAK0yD,OAAS+Z,EAAK/Z,OACnB1yD,KAAKynE,UAAYgF,EAAKhF,UACtBznE,KAAKgnE,QAAUyF,EAAKzF,QAEbhnE,MAiGRsoE,GAAiBmL,UAAY7xE,OAAOqvF,OAAQvrB,GAAM+N,WAClDnL,GAAiBmL,UAAUlJ,YAAcjC,GAEzCA,GAAiBmL,UAAUuxC,oBAAqB,EAEhD18C,GAAiBmL,UAAUsvC,SAAW,SAAW3wD,EAAG4wD,GAEnD,GAAIvuF,GAAQuuF,GAAkB,GAAInjH,GAE9B8nE,EAAK3nE,KAAK2nE,GAAIC,EAAK5nE,KAAK4nE,GAAIW,EAAKvoE,KAAKuoE,GAAIC,EAAKxoE,KAAKwoE,EAOxD,OALA/zC,GAAMxuB,IACLoiE,GAAajW,EAAGuV,EAAG7nE,EAAG8nE,EAAG9nE,EAAGyoE,EAAGzoE,EAAG0oE,EAAG1oE,GACrCuoE,GAAajW,EAAGuV,EAAG5nE,EAAG6nE,EAAG7nE,EAAGwoE,EAAGxoE,EAAGyoE,EAAGzoE,IAG/B00B,GAIR6zC,GAAiBmL,UAAU70D,KAAO,SAAW8/D,GAS5C,MAPAhZ,IAAM+N,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAEjC1+E,KAAK2nE,GAAG/oD,KAAM8/D,EAAO/W,IACrB3nE,KAAK4nE,GAAGhpD,KAAM8/D,EAAO9W,IACrB5nE,KAAKuoE,GAAG3pD,KAAM8/D,EAAOnW,IACrBvoE,KAAKwoE,GAAG5pD,KAAM8/D,EAAOlW,IAEdxoE,MAIRsoE,GAAiBmL,UAAUnU,OAAS,WAEnC,GAAI56D,GAAOghE,GAAM+N,UAAUnU,OAAOh7D,KAAMtE,KAOxC,OALA0E,GAAKijE,GAAK3nE,KAAK2nE,GAAG7oD,UAClBpa,EAAKkjE,GAAK5nE,KAAK4nE,GAAG9oD,UAClBpa,EAAK6jE,GAAKvoE,KAAKuoE,GAAGzpD,UAClBpa,EAAK8jE,GAAKxoE,KAAKwoE,GAAG1pD,UAEXpa,GAIR4jE,GAAiBmL,UAAU8wC,SAAW,SAAW93C,GAShD,MAPA/G,IAAM+N,UAAU8wC,SAASjgH,KAAMtE,KAAMysE,GAErCzsE,KAAK2nE,GAAGzvB,UAAWu0B,EAAK9E,IACxB3nE,KAAK4nE,GAAG1vB,UAAWu0B,EAAK7E,IACxB5nE,KAAKuoE,GAAGrwB,UAAWu0B,EAAKlE,IACxBvoE,KAAKwoE,GAAGtwB,UAAWu0B,EAAKjE,IAEjBxoE,MAiBRyoE,GAAkBgL,UAAY7xE,OAAOqvF,OAAQvrB,GAAM+N,WACnDhL,GAAkBgL,UAAUlJ,YAAc9B,GAE1CA,GAAkBgL,UAAUwxC,qBAAsB,EAElDx8C,GAAkBgL,UAAUsvC,SAAW,SAAW3wD,EAAG4wD,GAEpD,GAAIvuF,GAAQuuF,GAAkB,GAAIjiH,GAE9B4mE,EAAK3nE,KAAK2nE,GAAIC,EAAK5nE,KAAK4nE,GAAIW,EAAKvoE,KAAKuoE,GAAIC,EAAKxoE,KAAKwoE,EAQxD,OANA/zC,GAAMxuB,IACLoiE,GAAajW,EAAGuV,EAAG7nE,EAAG8nE,EAAG9nE,EAAGyoE,EAAGzoE,EAAG0oE,EAAG1oE,GACrCuoE,GAAajW,EAAGuV,EAAG5nE,EAAG6nE,EAAG7nE,EAAGwoE,EAAGxoE,EAAGyoE,EAAGzoE,GACrCsoE,GAAajW,EAAGuV,EAAGnnE,EAAGonE,EAAGpnE,EAAG+nE,EAAG/nE,EAAGgoE,EAAGhoE,IAG/Bi0B,GAIRg0C,GAAkBgL,UAAU70D,KAAO,SAAW8/D,GAS7C,MAPAhZ,IAAM+N,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAEjC1+E,KAAK2nE,GAAG/oD,KAAM8/D,EAAO/W,IACrB3nE,KAAK4nE,GAAGhpD,KAAM8/D,EAAO9W,IACrB5nE,KAAKuoE,GAAG3pD,KAAM8/D,EAAOnW,IACrBvoE,KAAKwoE,GAAG5pD,KAAM8/D,EAAOlW,IAEdxoE,MAIRyoE,GAAkBgL,UAAUnU,OAAS,WAEpC,GAAI56D,GAAOghE,GAAM+N,UAAUnU,OAAOh7D,KAAMtE,KAOxC,OALA0E,GAAKijE,GAAK3nE,KAAK2nE,GAAG7oD,UAClBpa,EAAKkjE,GAAK5nE,KAAK4nE,GAAG9oD,UAClBpa,EAAK6jE,GAAKvoE,KAAKuoE,GAAGzpD,UAClBpa,EAAK8jE,GAAKxoE,KAAKwoE,GAAG1pD,UAEXpa,GAIR+jE,GAAkBgL,UAAU8wC,SAAW,SAAW93C,GASjD,MAPA/G,IAAM+N,UAAU8wC,SAASjgH,KAAMtE,KAAMysE,GAErCzsE,KAAK2nE,GAAGzvB,UAAWu0B,EAAK9E,IACxB3nE,KAAK4nE,GAAG1vB,UAAWu0B,EAAK7E,IACxB5nE,KAAKuoE,GAAGrwB,UAAWu0B,EAAKlE,IACxBvoE,KAAKwoE,GAAGtwB,UAAWu0B,EAAKjE,IAEjBxoE,MAeR0oE,GAAU+K,UAAY7xE,OAAOqvF,OAAQvrB,GAAM+N,WAC3C/K,GAAU+K,UAAUlJ,YAAc7B,GAElCA,GAAU+K,UAAUyxC,aAAc,EAElCx8C,GAAU+K,UAAUsvC,SAAW,SAAW3wD,EAAG4wD,GAE5C,GAAIvuF,GAAQuuF,GAAkB,GAAInjH,EAalC,OAXW,KAANuyD,EAEJ39B,EAAM7V,KAAM5e,KAAKuoE,KAIjB9zC,EAAM7V,KAAM5e,KAAKuoE,IAAKlwC,IAAKr4B,KAAK4nE,IAChCnzC,EAAMyD,eAAgBk6B,GAAI/yB,IAAKr/B,KAAK4nE,KAI9BnzC,GAMRi0C,GAAU+K,UAAUrgB,WAAa,SAAWliD,EAAG8xG,GAE9C,MAAOhjH,MAAK+iH,SAAU7xG,EAAG8xG,IAI1Bt6C,GAAU+K,UAAUuwC,WAAa,WAEhC,GAAImB,GAAUnlH,KAAKuoE,GAAG19D,QAAQwtB,IAAKr4B,KAAK4nE,GAExC,OAAOu9C,GAAQxrF,aAIhB+uC,GAAU+K,UAAU70D,KAAO,SAAW8/D,GAOrC,MALAhZ,IAAM+N,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAEjC1+E,KAAK4nE,GAAGhpD,KAAM8/D,EAAO9W,IACrB5nE,KAAKuoE,GAAG3pD,KAAM8/D,EAAOnW,IAEdvoE,MAIR0oE,GAAU+K,UAAUnU,OAAS,WAE5B,GAAI56D,GAAOghE,GAAM+N,UAAUnU,OAAOh7D,KAAMtE,KAKxC,OAHA0E,GAAKkjE,GAAK5nE,KAAK4nE,GAAG9oD,UAClBpa,EAAK6jE,GAAKvoE,KAAKuoE,GAAGzpD,UAEXpa,GAIRgkE,GAAU+K,UAAU8wC,SAAW,SAAW93C,GAOzC,MALA/G,IAAM+N,UAAU8wC,SAASjgH,KAAMtE,KAAMysE,GAErCzsE,KAAK4nE,GAAG1vB,UAAWu0B,EAAK7E,IACxB5nE,KAAKuoE,GAAGrwB,UAAWu0B,EAAKlE,IAEjBvoE,MAeR2oE,GAAW8K,UAAY7xE,OAAOqvF,OAAQvrB,GAAM+N,WAC5C9K,GAAW8K,UAAUlJ,YAAc5B,GAEnCA,GAAW8K,UAAU2xC,cAAe,EAEpCz8C,GAAW8K,UAAUsvC,SAAW,SAAW3wD,EAAG4wD,GAE7C,GAAIvuF,GAAQuuF,GAAkB,GAAIjiH,EAalC,OAXW,KAANqxD,EAEJ39B,EAAM7V,KAAM5e,KAAKuoE,KAIjB9zC,EAAM7V,KAAM5e,KAAKuoE,IAAKlwC,IAAKr4B,KAAK4nE,IAChCnzC,EAAMyD,eAAgBk6B,GAAI/yB,IAAKr/B,KAAK4nE,KAI9BnzC,GAMRk0C,GAAW8K,UAAUrgB,WAAa,SAAWliD,EAAG8xG,GAE/C,MAAOhjH,MAAK+iH,SAAU7xG,EAAG8xG,IAI1Br6C,GAAW8K,UAAU70D,KAAO,SAAW8/D,GAOtC,MALAhZ,IAAM+N,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAEjC1+E,KAAK4nE,GAAGhpD,KAAM8/D,EAAO9W,IACrB5nE,KAAKuoE,GAAG3pD,KAAM8/D,EAAOnW,IAEdvoE,MAIR2oE,GAAW8K,UAAUnU,OAAS,WAE7B,GAAI56D,GAAOghE,GAAM+N,UAAUnU,OAAOh7D,KAAMtE,KAKxC,OAHA0E,GAAKkjE,GAAK5nE,KAAK4nE,GAAG9oD,UAClBpa,EAAK6jE,GAAKvoE,KAAKuoE,GAAGzpD,UAEXpa,GAIRikE,GAAW8K,UAAU8wC,SAAW,SAAW93C,GAO1C,MALA/G,IAAM+N,UAAU8wC,SAASjgH,KAAMtE,KAAMysE,GAErCzsE,KAAK4nE,GAAG1vB,UAAWu0B,EAAK7E,IACxB5nE,KAAKuoE,GAAGrwB,UAAWu0B,EAAKlE,IAEjBvoE,MAgBR4oE,GAAqB6K,UAAY7xE,OAAOqvF,OAAQvrB,GAAM+N,WACtD7K,GAAqB6K,UAAUlJ,YAAc3B,GAE7CA,GAAqB6K,UAAU4xC,wBAAyB,EAExDz8C,GAAqB6K,UAAUsvC,SAAW,SAAW3wD,EAAG4wD,GAEvD,GAAIvuF,GAAQuuF,GAAkB,GAAInjH,GAE9B8nE,EAAK3nE,KAAK2nE,GAAIC,EAAK5nE,KAAK4nE,GAAIW,EAAKvoE,KAAKuoE,EAO1C,OALA9zC,GAAMxuB,IACL+hE,GAAiB5V,EAAGuV,EAAG7nE,EAAG8nE,EAAG9nE,EAAGyoE,EAAGzoE,GACnCkoE,GAAiB5V,EAAGuV,EAAG5nE,EAAG6nE,EAAG7nE,EAAGwoE,EAAGxoE,IAG7B00B,GAIRm0C,GAAqB6K,UAAU70D,KAAO,SAAW8/D,GAQhD,MANAhZ,IAAM+N,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAEjC1+E,KAAK2nE,GAAG/oD,KAAM8/D,EAAO/W,IACrB3nE,KAAK4nE,GAAGhpD,KAAM8/D,EAAO9W,IACrB5nE,KAAKuoE,GAAG3pD,KAAM8/D,EAAOnW,IAEdvoE,MAIR4oE,GAAqB6K,UAAUnU,OAAS,WAEvC,GAAI56D,GAAOghE,GAAM+N,UAAUnU,OAAOh7D,KAAMtE,KAMxC,OAJA0E,GAAKijE,GAAK3nE,KAAK2nE,GAAG7oD,UAClBpa,EAAKkjE,GAAK5nE,KAAK4nE,GAAG9oD,UAClBpa,EAAK6jE,GAAKvoE,KAAKuoE,GAAGzpD,UAEXpa,GAIRkkE,GAAqB6K,UAAU8wC,SAAW,SAAW93C,GAQpD,MANA/G,IAAM+N,UAAU8wC,SAASjgH,KAAMtE,KAAMysE,GAErCzsE,KAAK2nE,GAAGzvB,UAAWu0B,EAAK9E,IACxB3nE,KAAK4nE,GAAG1vB,UAAWu0B,EAAK7E,IACxB5nE,KAAKuoE,GAAGrwB,UAAWu0B,EAAKlE,IAEjBvoE,MAgBR6oE,GAAsB4K,UAAY7xE,OAAOqvF,OAAQvrB,GAAM+N,WACvD5K,GAAsB4K,UAAUlJ,YAAc1B,GAE9CA,GAAsB4K,UAAU6xC,yBAA0B,EAE1Dz8C,GAAsB4K,UAAUsvC,SAAW,SAAW3wD,EAAG4wD,GAExD,GAAIvuF,GAAQuuF,GAAkB,GAAIjiH,GAE9B4mE,EAAK3nE,KAAK2nE,GAAIC,EAAK5nE,KAAK4nE,GAAIW,EAAKvoE,KAAKuoE,EAQ1C,OANA9zC,GAAMxuB,IACL+hE,GAAiB5V,EAAGuV,EAAG7nE,EAAG8nE,EAAG9nE,EAAGyoE,EAAGzoE,GACnCkoE,GAAiB5V,EAAGuV,EAAG5nE,EAAG6nE,EAAG7nE,EAAGwoE,EAAGxoE,GACnCioE,GAAiB5V,EAAGuV,EAAGnnE,EAAGonE,EAAGpnE,EAAG+nE,EAAG/nE,IAG7Bi0B,GAIRo0C,GAAsB4K,UAAU70D,KAAO,SAAW8/D,GAQjD,MANAhZ,IAAM+N,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAEjC1+E,KAAK2nE,GAAG/oD,KAAM8/D,EAAO/W,IACrB3nE,KAAK4nE,GAAGhpD,KAAM8/D,EAAO9W,IACrB5nE,KAAKuoE,GAAG3pD,KAAM8/D,EAAOnW,IAEdvoE,MAIR6oE,GAAsB4K,UAAUnU,OAAS,WAExC,GAAI56D,GAAOghE,GAAM+N,UAAUnU,OAAOh7D,KAAMtE,KAMxC,OAJA0E,GAAKijE,GAAK3nE,KAAK2nE,GAAG7oD,UAClBpa,EAAKkjE,GAAK5nE,KAAK4nE,GAAG9oD,UAClBpa,EAAK6jE,GAAKvoE,KAAKuoE,GAAGzpD,UAEXpa,GAIRmkE,GAAsB4K,UAAU8wC,SAAW,SAAW93C,GAQrD,MANA/G,IAAM+N,UAAU8wC,SAASjgH,KAAMtE,KAAMysE,GAErCzsE,KAAK2nE,GAAGzvB,UAAWu0B,EAAK9E,IACxB3nE,KAAK4nE,GAAG1vB,UAAWu0B,EAAK7E,IACxB5nE,KAAKuoE,GAAGrwB,UAAWu0B,EAAKlE,IAEjBvoE,MAcR8oE,GAAY2K,UAAY7xE,OAAOqvF,OAAQvrB,GAAM+N,WAC7C3K,GAAY2K,UAAUlJ,YAAczB,GAEpCA,GAAY2K,UAAU8xC,eAAgB,EAEtCz8C,GAAY2K,UAAUsvC,SAAW,SAAW3wD,EAAG4wD,GAE9C,GAAIvuF,GAAQuuF,GAAkB,GAAInjH,GAE9BoiB,EAASjiB,KAAKiiB,OACdkT,GAAMlT,EAAO7hB,OAAS,GAAMgyD,EAE5B2yD,EAAWpyG,KAAKC,MAAOuiB,GACvB4gD,EAAS5gD,EAAI4vF,EAEbz/G,EAAK2c,EAAqB,IAAb8iG,EAAiBA,EAAWA,EAAW,GACpDx/G,EAAK0c,EAAQ8iG,GACbv/G,EAAKyc,EAAQ8iG,EAAW9iG,EAAO7hB,OAAS,EAAI6hB,EAAO7hB,OAAS,EAAI2kH,EAAW,GAC3Et/G,EAAKwc,EAAQ8iG,EAAW9iG,EAAO7hB,OAAS,EAAI6hB,EAAO7hB,OAAS,EAAI2kH,EAAW,EAO/E,OALAtwF,GAAMxuB,IACLyhE,GAAYqO,EAAQzwE,EAAGxF,EAAGyF,EAAGzF,EAAG0F,EAAG1F,EAAG2F,EAAG3F,GACzC4nE,GAAYqO,EAAQzwE,EAAGvF,EAAGwF,EAAGxF,EAAGyF,EAAGzF,EAAG0F,EAAG1F,IAGnC00B,GAIRq0C,GAAY2K,UAAU70D,KAAO,SAAW8/D,GAEvChZ,GAAM+N,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAEjC1+E,KAAKiiB,SAEL,KAAM,GAAIjS,GAAI,EAAGC,EAAIyuE,EAAOz8D,OAAO7hB,OAAQ4P,EAAIC,EAAGD,IAAO,CAExD,GAAIykB,GAAQiqD,EAAOz8D,OAAQjS,EAE3BhQ,MAAKiiB,OAAO7P,KAAMqiB,EAAM5pB,SAIzB,MAAO7K,OAIR8oE,GAAY2K,UAAUnU,OAAS,WAE9B,GAAI56D,GAAOghE,GAAM+N,UAAUnU,OAAOh7D,KAAMtE,KAExC0E,GAAKud,SAEL,KAAM,GAAIjS,GAAI,EAAGC,EAAIjQ,KAAKiiB,OAAO7hB,OAAQ4P,EAAIC,EAAGD,IAAO,CAEtD,GAAIykB,GAAQz0B,KAAKiiB,OAAQjS,EACzBtL,GAAKud,OAAO7P,KAAMqiB,EAAM3V,WAIzB,MAAOpa,IAIRokE,GAAY2K,UAAU8wC,SAAW,SAAW93C,GAE3C/G,GAAM+N,UAAU8wC,SAASjgH,KAAMtE,KAAMysE,GAErCzsE,KAAKiiB,SAEL,KAAM,GAAIjS,GAAI,EAAGC,EAAIw8D,EAAKxqD,OAAO7hB,OAAQ4P,EAAIC,EAAGD,IAAO,CAEtD,GAAIykB,GAAQg4C,EAAKxqD,OAAQjS,EACzBhQ,MAAKiiB,OAAO7P,MAAM,GAAIvS,IAAUq4C,UAAWzjB,IAI5C,MAAOz0B,MAMR,IAAIwlH,IAAsB5jH,OAAO+9G,QAChCt5C,SAAUA,GACVmB,iBAAkBA,GAClBc,iBAAkBA,GAClBG,kBAAmBA,GACnB7C,aAAcA,GACd8C,UAAWA,GACXC,WAAYA,GACZC,qBAAsBA,GACtBC,sBAAuBA,GACvBC,YAAaA,IAwBdC,IAAU0K,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQvrB,GAAM+N,YAEzDlJ,YAAaxB,GAEb1pC,IAAK,SAAWomF,GAEfzlH,KAAKgpE,OAAO52D,KAAMqzG,IAInBC,UAAW,WAGV,GAAIC,GAAa3lH,KAAKgpE,OAAQ,GAAI+5C,SAAU,GACxC6C,EAAW5lH,KAAKgpE,OAAQhpE,KAAKgpE,OAAO5oE,OAAS,GAAI2iH,SAAU,EAExD4C,GAAWzlF,OAAQ0lF,IAEzB5lH,KAAKgpE,OAAO52D,KAAM,GAAIs2D,IAAWk9C,EAAUD,KAe7C5C,SAAU,SAAW3wD,GAQpB,IANA,GAAI9/C,GAAI8/C,EAAIpyD,KAAKmjH,YACb0C,EAAe7lH,KAAK8lH,kBACpB91G,EAAI,EAIAA,EAAI61G,EAAazlH,QAAS,CAEjC,GAAKylH,EAAc71G,IAAOsC,EAAI,CAE7B,GAAIs+F,GAAOiV,EAAc71G,GAAMsC,EAC3BmzG,EAAQzlH,KAAKgpE,OAAQh5D,GAErB8zG,EAAgB2B,EAAMtC,YACtBjyG,EAAsB,IAAlB4yG,EAAsB,EAAI,EAAIlT,EAAOkT,CAE7C,OAAO2B,GAAMryD,WAAYliD,GAI1BlB,IAID,MAAO,OAURmzG,UAAW,WAEV,GAAI4C,GAAO/lH,KAAK8lH,iBAChB,OAAOC,GAAMA,EAAK3lH,OAAS,IAK5BojH,iBAAkB,WAEjBxjH,KAAK2V,aAAc,EACnB3V,KAAKgmH,aAAe,KACpBhmH,KAAK8lH,mBAONA,gBAAiB,WAIhB,GAAK9lH,KAAKgmH,cAAgBhmH,KAAKgmH,aAAa5lH,SAAWJ,KAAKgpE,OAAO5oE,OAElE,MAAOJ,MAAKgmH,YASb,KAAM,GAFF5C,MAAc6C,EAAO,EAEfj2G,EAAI,EAAGC,EAAIjQ,KAAKgpE,OAAO5oE,OAAQ4P,EAAIC,EAAGD,IAE/Ci2G,GAAQjmH,KAAKgpE,OAAQh5D,GAAImzG,YACzBC,EAAQhxG,KAAM6zG,EAMf,OAFAjmH,MAAKgmH,aAAe5C,EAEbA,GAIR5kD,gBAAiB,SAAWkb,GAER54E,SAAd44E,IAA0BA,EAAY,GAI3C,KAAM,GAFFz3D,MAEMjS,EAAI,EAAGA,GAAK0pE,EAAW1pE,IAEhCiS,EAAO7P,KAAMpS,KAAK+iH,SAAU/yG,EAAI0pE,GAUjC,OANK15E,MAAKipE,WAEThnD,EAAO7P,KAAM6P,EAAQ,IAIfA,GAIRihG,UAAW,SAAWxpC,GAErBA,EAAYA,GAAa,EAIzB,KAAM,GAFW1kB,GAAb/yC,KAEMjS,EAAI,EAAGg5D,EAAShpE,KAAKgpE,OAAQh5D,EAAIg5D,EAAO5oE,OAAQ4P,IAUzD,IAAM,GARFy1G,GAAQz8C,EAAQh5D,GAChB+9D,EAAe03C,GAASA,EAAMjB,eAA+B,EAAZ9qC,EAChD+rC,IAAWA,EAAMP,aAAeO,EAAML,cAAmB,EACxDK,GAASA,EAAMF,cAAkB7rC,EAAY+rC,EAAMxjG,OAAO7hB,OAC3Ds5E,EAED6kC,EAAMkH,EAAMvC,UAAWn1C,GAEjBtgC,EAAI,EAAGA,EAAI8wE,EAAIn+G,OAAQqtC,IAAO,CAEvC,GAAIhZ,GAAQ8pF,EAAK9wE,EAEZunB,IAAQA,EAAK90B,OAAQzL,KAE1BxS,EAAO7P,KAAMqiB,GACbugC,EAAOvgC,GAYT,MANKz0B,MAAKipE,WAAahnD,EAAO7hB,OAAS,IAAO6hB,EAAQA,EAAO7hB,OAAS,GAAI8/B,OAAQje,EAAQ,KAEzFA,EAAO7P,KAAM6P,EAAQ,IAIfA,GAIRrD,KAAM,SAAW8/D,GAEhBhZ,GAAM+N,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAEjC1+E,KAAKgpE,SAEL,KAAM,GAAIh5D,GAAI,EAAGC,EAAIyuE,EAAO1V,OAAO5oE,OAAQ4P,EAAIC,EAAGD,IAAO,CAExD,GAAIy1G,GAAQ/mC,EAAO1V,OAAQh5D,EAE3BhQ,MAAKgpE,OAAO52D,KAAMqzG,EAAM56G,SAMzB,MAFA7K,MAAKipE,UAAYyV,EAAOzV,UAEjBjpE,MAIRs/D,OAAQ,WAEP,GAAI56D,GAAOghE,GAAM+N,UAAUnU,OAAOh7D,KAAMtE,KAExC0E,GAAKukE,UAAYjpE,KAAKipE,UACtBvkE,EAAKskE,SAEL,KAAM,GAAIh5D,GAAI,EAAGC,EAAIjQ,KAAKgpE,OAAO5oE,OAAQ4P,EAAIC,EAAGD,IAAO,CAEtD,GAAIy1G,GAAQzlH,KAAKgpE,OAAQh5D,EACzBtL,GAAKskE,OAAO52D,KAAMqzG,EAAMnmD,UAIzB,MAAO56D,IAIR6/G,SAAU,SAAW93C,GAEpB/G,GAAM+N,UAAU8wC,SAASjgH,KAAMtE,KAAMysE,GAErCzsE,KAAKipE,UAAYwD,EAAKxD,UACtBjpE,KAAKgpE,SAEL,KAAM,GAAIh5D,GAAI,EAAGC,EAAIw8D,EAAKzD,OAAO5oE,OAAQ4P,EAAIC,EAAGD,IAAO,CAEtD,GAAIy1G,GAAQh5C,EAAKzD,OAAQh5D,EACzBhQ,MAAKgpE,OAAO52D,MAAM,GAAIozG,IAAQC,EAAMhkH,OAAS8iH,SAAUkB,IAIxD,MAAOzlH,SA2BTkpE,GAAKuK,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQloB,GAAU0K,YAExDlJ,YAAarB,GAEbE,cAAe,SAAWnnD,GAEzBjiB,KAAKqvE,OAAQptD,EAAQ,GAAIniB,EAAGmiB,EAAQ,GAAIliB,EAExC,KAAM,GAAIiQ,GAAI,EAAGC,EAAIgS,EAAO7hB,OAAQ4P,EAAIC,EAAGD,IAE1ChQ,KAAKsvE,OAAQrtD,EAAQjS,GAAIlQ,EAAGmiB,EAAQjS,GAAIjQ,IAM1CsvE,OAAQ,SAAWvvE,EAAGC,GAErBC,KAAKmpE,aAAaljE,IAAKnG,EAAGC,IAI3BuvE,OAAQ,SAAWxvE,EAAGC,GAErB,GAAI0lH,GAAQ,GAAI/8C,IAAW1oE,KAAKmpE,aAAat+D,QAAS,GAAIhL,GAASC,EAAGC,GACtEC,MAAKgpE,OAAO52D,KAAMqzG,GAElBzlH,KAAKmpE,aAAaljE,IAAKnG,EAAGC,IAI3BwvE,iBAAkB,SAAW22C,EAAMC,EAAMtgD,EAAIC,GAE5C,GAAI2/C,GAAQ,GAAI78C,IACf5oE,KAAKmpE,aAAat+D,QAClB,GAAIhL,GAASqmH,EAAMC,GACnB,GAAItmH,GAASgmE,EAAIC,GAGlB9lE,MAAKgpE,OAAO52D,KAAMqzG,GAElBzlH,KAAKmpE,aAAaljE,IAAK4/D,EAAIC,IAI5B0J,cAAe,SAAW42C,EAAOC,EAAOC,EAAOC,EAAO1gD,EAAIC,GAEzD,GAAI2/C,GAAQ,GAAIn9C,IACftoE,KAAKmpE,aAAat+D,QAClB,GAAIhL,GAASumH,EAAOC,GACpB,GAAIxmH,GAASymH,EAAOC,GACpB,GAAI1mH,GAASgmE,EAAIC,GAGlB9lE,MAAKgpE,OAAO52D,KAAMqzG,GAElBzlH,KAAKmpE,aAAaljE,IAAK4/D,EAAIC,IAI5B0gD,WAAY,SAAWjI,GAEtB,GAAIkI,IAASzmH,KAAKmpE,aAAat+D,SAAUk0D,OAAQw/C,GAE7CkH,EAAQ,GAAI38C,IAAa29C,EAC7BzmH,MAAKgpE,OAAO52D,KAAMqzG,GAElBzlH,KAAKmpE,aAAavqD,KAAM2/F,EAAKA,EAAIn+G,OAAS,KAI3Cu0D,IAAK,SAAWkR,EAAIC,EAAIQ,EAASL,EAAaC,EAAWC,GAExD,GAAIlV,GAAKjxD,KAAKmpE,aAAarpE,EACvBosF,EAAKlsF,KAAKmpE,aAAappE,CAE3BC,MAAK0mH,OAAQ7gD,EAAK5U,EAAI6U,EAAKomB,EAAI5lB,EAC9BL,EAAaC,EAAWC,IAI1BugD,OAAQ,SAAW7gD,EAAIC,EAAIQ,EAASL,EAAaC,EAAWC,GAE3DnmE,KAAK2mH,WAAY9gD,EAAIC,EAAIQ,EAASA,EAASL,EAAaC,EAAWC,IAIpEygD,QAAS,SAAW/gD,EAAIC,EAAIC,EAASC,EAASC,EAAaC,EAAWC,EAAYC,GAEjF,GAAInV,GAAKjxD,KAAKmpE,aAAarpE,EACvBosF,EAAKlsF,KAAKmpE,aAAappE,CAE3BC,MAAK2mH,WAAY9gD,EAAK5U,EAAI6U,EAAKomB,EAAInmB,EAASC,EAASC,EAAaC,EAAWC,EAAYC,IAI1FugD,WAAY,SAAW9gD,EAAIC,EAAIC,EAASC,EAASC,EAAaC,EAAWC,EAAYC,GAEpF,GAAIq/C,GAAQ,GAAI7/C,IAAcC,EAAIC,EAAIC,EAASC,EAASC,EAAaC,EAAWC,EAAYC,EAE5F,IAAKpmE,KAAKgpE,OAAO5oE,OAAS,EAAI,CAG7B,GAAIymH,GAAapB,EAAM1C,SAAU,EAE1B8D,GAAW3mF,OAAQlgC,KAAKmpE,eAE9BnpE,KAAKsvE,OAAQu3C,EAAW/mH,EAAG+mH,EAAW9mH,GAMxCC,KAAKgpE,OAAO52D,KAAMqzG,EAElB,IAAIqB,GAAYrB,EAAM1C,SAAU,EAChC/iH,MAAKmpE,aAAavqD,KAAMkoG,IAIzBloG,KAAM,SAAW8/D,GAMhB,MAJA3V,IAAU0K,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAErC1+E,KAAKmpE,aAAavqD,KAAM8/D,EAAOvV,cAExBnpE,MAIRs/D,OAAQ,WAEP,GAAI56D,GAAOqkE,GAAU0K,UAAUnU,OAAOh7D,KAAMtE,KAI5C,OAFA0E,GAAKykE,aAAenpE,KAAKmpE,aAAarqD,UAE/Bpa,GAIR6/G,SAAU,SAAW93C,GAMpB,MAJA1D,IAAU0K,UAAU8wC,SAASjgH,KAAMtE,KAAMysE,GAEzCzsE,KAAKmpE,aAAajxB,UAAWu0B,EAAKtD,cAE3BnpE,QA6BTqpE,GAAMoK,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQ/nB,GAAKuK,YAEpDlJ,YAAalB,GAEb09C,eAAgB,SAAWrtC,GAI1B,IAAM,GAFFstC,MAEMh3G,EAAI,EAAGC,EAAIjQ,KAAK68D,MAAMz8D,OAAQ4P,EAAIC,EAAGD,IAE9Cg3G,EAAUh3G,GAAMhQ,KAAK68D,MAAO7sD,GAAIkzG,UAAWxpC,EAI5C,OAAOstC,IAMRtoD,cAAe,SAAWgb,GAEzB,OAECvf,MAAOn6D,KAAKkjH,UAAWxpC,GACvB7c,MAAO78D,KAAK+mH,eAAgBrtC,KAM9B96D,KAAM,SAAW8/D,GAEhBxV,GAAKuK,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAEhC1+E,KAAK68D,QAEL,KAAM,GAAI7sD,GAAI,EAAGC,EAAIyuE,EAAO7hB,MAAMz8D,OAAQ4P,EAAIC,EAAGD,IAAO,CAEvD,GAAI0nD,GAAOgnB,EAAO7hB,MAAO7sD,EAEzBhQ,MAAK68D,MAAMzqD,KAAMslD,EAAK7sD,SAIvB,MAAO7K,OAIRs/D,OAAQ,WAEP,GAAI56D,GAAOwkE,GAAKuK,UAAUnU,OAAOh7D,KAAMtE,KAEvC0E,GAAK1C,KAAOhC,KAAKgC,KACjB0C,EAAKm4D,QAEL,KAAM,GAAI7sD,GAAI,EAAGC,EAAIjQ,KAAK68D,MAAMz8D,OAAQ4P,EAAIC,EAAGD,IAAO,CAErD,GAAI0nD,GAAO13D,KAAK68D,MAAO7sD,EACvBtL,GAAKm4D,MAAMzqD,KAAMslD,EAAK4H,UAIvB,MAAO56D,IAIR6/G,SAAU,SAAW93C,GAEpBvD,GAAKuK,UAAU8wC,SAASjgH,KAAMtE,KAAMysE,GAEpCzsE,KAAKgC,KAAOyqE,EAAKzqE,KACjBhC,KAAK68D,QAEL,KAAM,GAAI7sD,GAAI,EAAGC,EAAIw8D,EAAK5P,MAAMz8D,OAAQ4P,EAAIC,EAAGD,IAAO,CAErD,GAAI0nD,GAAO+U,EAAK5P,MAAO7sD,EACvBhQ,MAAK68D,MAAMzqD,MAAM,GAAI82D,KAAOq7C,SAAU7sD,IAIvC,MAAO13D,SAwBTspE,GAAMmK,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQ/mF,EAASupE,YAExDlJ,YAAajB,GAEb/pB,SAAS,EAET3gC,KAAM,SAAW8/D,GAOhB,MALAx0E,GAASupE,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAEpC1+E,KAAKgN,MAAM4R,KAAM8/D,EAAO1xE,OACxBhN,KAAK+3B,UAAY2mD,EAAO3mD,UAEjB/3B,MAIRs/D,OAAQ,SAAW4xB,GAElB,GAAIxsF,GAAOwF,EAASupE,UAAUnU,OAAOh7D,KAAMtE,KAAMkxF,EAcjD,OAZAxsF,GAAK8b,OAAOxT,MAAQhN,KAAKgN,MAAMy7F,SAC/B/jG,EAAK8b,OAAOuX,UAAY/3B,KAAK+3B,UAEHj3B,SAArBd,KAAKq3B,cAA4B3yB,EAAK8b,OAAO6W,YAAcr3B,KAAKq3B,YAAYoxE,UAE1D3nG,SAAlBd,KAAK82B,WAAyBpyB,EAAK8b,OAAOsW,SAAW92B,KAAK82B,UAC3Ch2B,SAAfd,KAAK64B,QAAsBn0B,EAAK8b,OAAOqY,MAAQ74B,KAAK64B,OACrC/3B,SAAfd,KAAKi3B,QAAsBvyB,EAAK8b,OAAOyW,MAAQj3B,KAAKi3B,OAClCn2B,SAAlBd,KAAK84B,WAAyBp0B,EAAK8b,OAAOsY,SAAW94B,KAAK84B,UAE1Ch4B,SAAhBd,KAAK02B,SAAuBhyB,EAAK8b,OAAOkW,OAAS12B,KAAK02B,OAAO4oC,UAE3D56D,KAyBT6kE,GAAgBkK,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQ3nB,GAAMmK,YAE/DlJ,YAAahB,GAEb7vC,mBAAmB,EAEnB9a,KAAM,SAAW8/D,GAMhB,MAJApV,IAAMmK,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAEjC1+E,KAAKq3B,YAAYzY,KAAM8/D,EAAOrnD,aAEvBr3B,QAwBT4B,OAAO48E,OAAQhV,GAAYiK,WAE1B70D,KAAM,SAAW8/D,GAShB,MAPA1+E,MAAKkZ,OAASwlE,EAAOxlE,OAAOrO,QAE5B7K,KAAKu4B,KAAOmmD,EAAOnmD,KACnBv4B,KAAKiF,OAASy5E,EAAOz5E,OAErBjF,KAAKw4B,QAAQ5Z,KAAM8/D,EAAOlmD,SAEnBx4B,MAIR6K,MAAO,WAEN,OAAO,GAAI7K,MAAKuqE,aAAc3rD,KAAM5e,OAIrCs/D,OAAQ,WAEP,GAAI9+C,KASJ,OAPmB,KAAdxgB,KAAKu4B,OAAa/X,EAAO+X,KAAOv4B,KAAKu4B,MACrB,IAAhBv4B,KAAKiF,SAAeub,EAAOvb,OAASjF,KAAKiF,QACtB,MAAnBjF,KAAKw4B,QAAQ14B,GAAgC,MAAnBE,KAAKw4B,QAAQz4B,IAAYygB,EAAOgY,QAAUx4B,KAAKw4B,QAAQ1Z,WAEtF0B,EAAOtH,OAASlZ,KAAKkZ,OAAOomD,QAAQ,GAAQ9+C,aACrCA,GAAOtH,OAAOjW,OAEdud,KAgBTipD,GAAgBgK,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQznB,GAAYiK,YAErElJ,YAAad,GAEb5qC,mBAAmB,EAEnBn1B,OAAQ,SAAW+sB,GAElB,GAAIvd,GAASlZ,KAAKkZ,OAEdg9B,EAAsB,EAAhBj0C,GAAMq+E,QAAc7pD,EAAMoC,MAChCsd,EAASn2C,KAAKw4B,QAAQ70B,MAAQ3D,KAAKw4B,QAAQ50B,OAC3C6I,EAAMgqB,EAAMK,UAAY5d,EAAOzM,GAE9BypC,KAAQh9B,EAAOg9B,KAAOC,IAAWj9B,EAAOi9B,QAAU1pC,IAAQyM,EAAOzM,MAErEyM,EAAOg9B,IAAMA,EACbh9B,EAAOi9B,OAASA,EAChBj9B,EAAOzM,IAAMA,EACbyM,EAAOtM,6BAiDV88D,GAAU+J,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQ3nB,GAAMmK,YAEzDlJ,YAAab,GAEb/wC,aAAa,EAEb/Z,KAAM,SAAW8/D,GAahB,MAXApV,IAAMmK,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAEjC1+E,KAAK82B,SAAW4nD,EAAO5nD,SACvB92B,KAAK64B,MAAQ6lD,EAAO7lD,MACpB74B,KAAK84B,SAAW4lD,EAAO5lD,SACvB94B,KAAKi3B,MAAQynD,EAAOznD,MAEpBj3B,KAAKigB,OAASy+D,EAAOz+D,OAAOpV,QAE5B7K,KAAK02B,OAASgoD,EAAOhoD,OAAO7rB,QAErB7K,QAyCT4pE,GAAW6J,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQ3nB,GAAMmK,YAE1DlJ,YAAaX,GAEbrwC,cAAc;AAEd3a,KAAM,SAAW8/D,GAShB,MAPApV,IAAMmK,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAEjC1+E,KAAK82B,SAAW4nD,EAAO5nD,SACvB92B,KAAKi3B,MAAQynD,EAAOznD,MAEpBj3B,KAAK02B,OAASgoD,EAAOhoD,OAAO7rB,QAErB7K,QAgBT6pE,GAAuB4J,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQznB,GAAYiK,YAE5ElJ,YAAaV,KAwBdC,GAAiB2J,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQ3nB,GAAMmK,YAEhElJ,YAAaT,GAEb7xC,oBAAoB,EAEpBrZ,KAAM,SAAW8/D,GAQhB,MANApV,IAAMmK,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAEjC1+E,KAAKigB,OAASy+D,EAAOz+D,OAAOpV,QAE5B7K,KAAK02B,OAASgoD,EAAOhoD,OAAO7rB,QAErB7K,QAoBT+pE,GAAa0J,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQ3nB,GAAMmK,YAE5DlJ,YAAaR,GAEb/xC,gBAAgB,IAmBjBgyC,GAAcyJ,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQ3nB,GAAMmK,YAE7DlJ,YAAaP,GAEb/wC,iBAAiB,EAEjBra,KAAM,SAAW8/D,GAOhB,MALApV,IAAMmK,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAEjC1+E,KAAK2D,MAAQ+6E,EAAO/6E,MACpB3D,KAAK4D,OAAS86E,EAAO96E,OAEd5D,MAIRs/D,OAAQ,SAAW4xB,GAElB,GAAIxsF,GAAO4kE,GAAMmK,UAAUnU,OAAOh7D,KAAMtE,KAAMkxF,EAK9C,OAHAxsF,GAAK8b,OAAO7c,MAAQ3D,KAAK2D,MACzBe,EAAK8b,OAAO5c,OAAS5D,KAAK4D,OAEnBc,IAYT,IAAI0mE,KAGH67C,WAAY,SAAW5/G,EAAOwmE,EAAMq5C,GAEnC,MAAK97C,IAAe+7C,aAAc9/G,GAI1B,GAAIA,GAAMkjE,YAAaljE,EAAM+B,SAAUykE,EAAa/sE,SAAPomH,EAAmBA,EAAK7/G,EAAMjH,SAI5EiH,EAAMwlD,MAAOghB,EAAMq5C,IAK3B77C,aAAc,SAAWhkE,EAAO5F,EAAM2lH,GAErC,OAAO//G,IACH+/G,GAAc//G,EAAMkjE,cAAgB9oE,EAAc4F,EAEf,gBAA3B5F,GAAKsH,kBAET,GAAItH,GAAM4F,GAIX+F,MAAMqmE,UAAU5mB,MAAMvoD,KAAM+C,IAIpC8/G,aAAc,SAAW3mG,GAExB,MAAO6mG,aAAYC,OAAQ9mG,MACrBA,YAAkB+mG,YAKzBC,iBAAkB,SAAWv8C,GAE5B,QAASw8C,GAAaz3G,EAAGy9B,GAExB,MAAOw9B,GAAOj7D,GAAMi7D,EAAOx9B,GAM5B,IAAM,GAFFzpB,GAAIinD,EAAM7qE,OACVg7B,EAAS,GAAIhuB,OAAO4W,GACdhU,EAAI,EAAGA,IAAMgU,IAAMhU,EAAIorB,EAAQprB,GAAMA,CAI/C,OAFAorB,GAAOrY,KAAM0kG,GAENrsF,GAKRssF,YAAa,SAAWx8C,EAAQtsB,EAAQ/0C,GAKvC,IAAM,GAHF89G,GAAUz8C,EAAO9qE,OACjBg7B,EAAS,GAAI8vC,GAAOX,YAAao9C,GAE3B33G,EAAI,EAAGkO,EAAY,EAAGA,IAAcypG,IAAY33G,EAIzD,IAAM,GAFF43G,GAAY/9G,EAAOmG,GAAM4uC,EAEnBnR,EAAI,EAAGA,IAAMmR,IAAWnR,EAEjCrS,EAAQld,KAAiBgtD,EAAQ08C,EAAYn6E,EAM/C,OAAOrS,IAKRuxC,YAAa,SAAWk7C,EAAU58C,EAAOC,EAAQ48C,GAIhD,IAFA,GAAI93G,GAAI,EAAG2lB,EAAMkyF,EAAU,GAEX/mH,SAAR60B,GAAkD70B,SAA7B60B,EAAKmyF,IAEjCnyF,EAAMkyF,EAAU73G,IAIjB,IAAalP,SAAR60B,EAAL,CAEA,GAAI7zB,GAAQ6zB,EAAKmyF,EACjB,IAAehnH,SAAVgB,EAEL,GAAKsL,MAAMC,QAASvL,IAEnB,EAECA,GAAQ6zB,EAAKmyF,GAEEhnH,SAAVgB,IAEJmpE,EAAM74D,KAAMujB,EAAItvB,MAChB6kE,EAAO94D,KAAKq2B,MAAOyiC,EAAQppE,IAI5B6zB,EAAMkyF,EAAU73G,WAEClP,SAAR60B,OAEJ,IAAuB70B,SAAlBgB,EAAMgd,SAIjB,EAEChd,GAAQ6zB,EAAKmyF,GAEEhnH,SAAVgB,IAEJmpE,EAAM74D,KAAMujB,EAAItvB,MAChBvE,EAAMgd,QAASosD,EAAQA,EAAO9qE,SAI/Bu1B,EAAMkyF,EAAU73G,WAEClP,SAAR60B,OAMV,GAEC7zB,GAAQ6zB,EAAKmyF,GAEEhnH,SAAVgB,IAEJmpE,EAAM74D,KAAMujB,EAAItvB,MAChB6kE,EAAO94D,KAAMtQ,IAId6zB,EAAMkyF,EAAU73G,WAEClP,SAAR60B,KA0Cb/zB,QAAO48E,OAAQvU,GAAYwJ,WAE1Bs0C,SAAU,SAAW31D,GAEpB,GAAI41D,GAAKhoH,KAAKkqE,mBACbsuC,EAAKx4G,KAAKsqE,aAEV7D,EAAKuhD,EAAIxP,GACThyC,EAAKwhD,EAAIxP,EAAK,EAEfyP,GAAmB,CAElBC,EAAM,CAEL,GAAI77G,EAEJ87G,GAAa,CAMZC,EAAc,KAASh2D,EAAIqU,GAAO,CAEjC,IAAM,GAAI4hD,GAAW7P,EAAK,IAAO,CAEhC,GAAY13G,SAAP2lE,EAAmB,CAEvB,GAAKrU,EAAIoU,EAAK,KAAM4hD,EAMpB,OAFA5P,GAAKwP,EAAG5nH,OACRJ,KAAKsqE,aAAekuC,EACbx4G,KAAKsoH,UAAW9P,EAAK,EAAGpmD,EAAGoU,GAInC,GAAKgyC,IAAO6P,EAAW,KAKvB,IAHA7hD,EAAKC,EACLA,EAAKuhD,IAAOxP,GAEPpmD,EAAIqU,EAGR,KAAMyhD,GAOR77G,EAAQ27G,EAAG5nH,MACX,MAAM+nH,GAMP,CAAA,GAAS/1D,GAAKoU,EAiDd,KAAMyhD,EA7CL,IAAIM,GAAWP,EAAI,EAEd51D,GAAIm2D,IAER/P,EAAK,EACLhyC,EAAK+hD,EAMN,KAAM,GAAIF,GAAW7P,EAAK,IAAO,CAEhC,GAAY13G,SAAP0lE,EAKJ,MADAxmE,MAAKsqE,aAAe,EACbtqE,KAAKwoH,aAAc,EAAGp2D,EAAGqU,EAIjC,IAAK+xC,IAAO6P,EAAW,KAKvB,IAHA5hD,EAAKD,EACLA,EAAKwhD,IAAOxP,EAAK,GAEZpmD,GAAKoU,EAGT,KAAM0hD,GAOR77G,EAAQmsG,EACRA,EAAK,GAaP,KAAQA,EAAKnsG,GAAQ,CAEpB,GAAIo8G,GAAQjQ,EAAKnsG,IAAY,CAExB+lD,GAAI41D,EAAIS,GAEZp8G,EAAQo8G,EAIRjQ,EAAKiQ,EAAM,EAWb,GALAhiD,EAAKuhD,EAAIxP,GACThyC,EAAKwhD,EAAIxP,EAAK,GAIF13G,SAAP0lE,EAGJ,MADAxmE,MAAKsqE,aAAe,EACbtqE,KAAKwoH,aAAc,EAAGp2D,EAAGqU,EAIjC,IAAY3lE,SAAP2lE,EAIJ,MAFA+xC,GAAKwP,EAAG5nH,OACRJ,KAAKsqE,aAAekuC,EACbx4G,KAAKsoH,UAAW9P,EAAK,EAAGhyC,EAAIpU,GAMrCpyD,KAAKsqE,aAAekuC,EAEpBx4G,KAAK0oH,iBAAkBlQ,EAAIhyC,EAAIC,GAIhC,MAAOzmE,MAAK2oH,aAAcnQ,EAAIhyC,EAAIpU,EAAGqU,IAItCyO,SAAU,KAKV0zC,oBAEAC,aAAc,WAEb,MAAO7oH,MAAKk1E,UAAYl1E,KAAK4oH,kBAI9BE,iBAAkB,SAAW14G,GAS5B,IAAM,GALFgrB,GAASp7B,KAAKqqE,aACjBa,EAASlrE,KAAKmqE,aACdvrB,EAAS5+C,KAAKwqE,UACd5nE,EAASwN,EAAQwuC,EAER5uC,EAAI,EAAGA,IAAM4uC,IAAW5uC,EAEjCorB,EAAQprB,GAAMk7D,EAAQtoE,EAASoN,EAIhC,OAAOorB,IAMRutF,aAAc,WAEb,KAAM,IAAIr+F,OAAO,4BAKlBo+F,iBAAkB,eASnB9mH,OAAO48E,OAAQvU,GAAYwJ,WAG1B+0C,aAAcv+C,GAAYwJ,UAAUq1C,iBAGpCR,UAAWr+C,GAAYwJ,UAAUq1C,mBAyBlCr+C,GAAiBgJ,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQhnB,GAAYwJ,YAEtElJ,YAAaE,GAEbm+C,kBAEC/zC,YAAaC,GACbC,UAAWD,IAIZ4zC,iBAAkB,SAAWlQ,EAAIhyC,EAAIC,GAEpC,GAAIuhD,GAAKhoH,KAAKkqE,mBACb6+C,EAAQvQ,EAAK,EACbwQ,EAAQxQ,EAAK,EAEbyQ,EAAQjB,EAAIe,GACZG,EAAQlB,EAAIgB,EAEb,IAAeloH,SAAVmoH,EAEJ,OAASjpH,KAAK6oH,eAAeh0C,aAE5B,IAAKsL,IAGJ4oC,EAAQvQ,EACRyQ,EAAQ,EAAIziD,EAAKC,CAEjB,MAED,KAAK2Z,IAGJ2oC,EAAQf,EAAG5nH,OAAS,EACpB6oH,EAAQziD,EAAKwhD,EAAIe,GAAUf,EAAIe,EAAQ,EAEvC,MAED,SAGCA,EAAQvQ,EACRyQ,EAAQxiD,EAMX,GAAe3lE,SAAVooH,EAEJ,OAASlpH,KAAK6oH,eAAe9zC,WAE5B,IAAKoL,IAGJ6oC,EAAQxQ,EACR0Q,EAAQ,EAAIziD,EAAKD,CAEjB,MAED,KAAK4Z,IAGJ4oC,EAAQ,EACRE,EAAQziD,EAAKuhD,EAAI,GAAMA,EAAI,EAE3B,MAED,SAGCgB,EAAQxQ,EAAK,EACb0Q,EAAQ1iD,EAMX,GAAI2iD,GAAuB,IAAZ1iD,EAAKD,GACnB5nB,EAAS5+C,KAAKwqE,SAEfxqE,MAAK0qE,YAAcy+C,GAAW3iD,EAAKyiD,GACnCjpH,KAAK4qE,YAAcu+C,GAAWD,EAAQziD,GACtCzmE,KAAK2qE,YAAco+C,EAAQnqE,EAC3B5+C,KAAK6qE,YAAcm+C,EAAQpqE,GAI5B+pE,aAAc,SAAWnQ,EAAIhyC,EAAIpU,EAAGqU,GAuBnC,IAAM,GArBFrrC,GAASp7B,KAAKqqE,aACjBa,EAASlrE,KAAKmqE,aACdvrB,EAAS5+C,KAAKwqE,UAEd4+C,EAAK5Q,EAAK55D,EAASyqE,EAAKD,EAAKxqE,EAC7B0qE,EAAKtpH,KAAK2qE,YAAc4+C,EAAKvpH,KAAK6qE,YAClC2+C,EAAKxpH,KAAK0qE,YAAa++C,EAAKzpH,KAAK4qE,YAEjCz1C,GAAMi9B,EAAIoU,IAASC,EAAKD,GACxBwhD,EAAK7yF,EAAIA,EACTu0F,EAAM1B,EAAK7yF,EAIRw0F,GAAOH,EAAKE,EAAM,EAAIF,EAAKxB,EAAKwB,EAAKr0F,EACrC2gF,GAAO,EAAI0T,GAAOE,QAAgB,EAAIF,GAAOxB,OAAewB,GAAOr0F,EAAI,EACvEw3D,MAAa88B,GAAOC,GAAQ,IAAMD,GAAOzB,EAAK,GAAM7yF,EACpDy0F,EAAKH,EAAKC,EAAMD,EAAKzB,EAIfh4G,EAAI,EAAGA,IAAM4uC,IAAW5uC,EAEjCorB,EAAQprB,GACN25G,EAAKz+C,EAAQo+C,EAAKt5G,GAClB8lG,EAAK5qC,EAAQm+C,EAAKr5G,GAClB28E,EAAKzhB,EAAQk+C,EAAKp5G,GAClB45G,EAAK1+C,EAAQq+C,EAAKv5G,EAIrB,OAAOorB,MAgBT0vC,GAAkB2I,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQhnB,GAAYwJ,YAEvElJ,YAAaO,GAEb69C,aAAc,SAAWnQ,EAAIhyC,EAAIpU,EAAGqU,GAYnC,IAAM,GAVFrrC,GAASp7B,KAAKqqE,aACjBa,EAASlrE,KAAKmqE,aACdvrB,EAAS5+C,KAAKwqE,UAEdq/C,EAAUrR,EAAK55D,EACfkrE,EAAUD,EAAUjrE,EAEpBmrE,GAAY33D,EAAIoU,IAASC,EAAKD,GAC9BwjD,EAAU,EAAID,EAEL/5G,EAAI,EAAGA,IAAM4uC,IAAW5uC,EAEjCorB,EAAQprB,GACNk7D,EAAQ4+C,EAAU95G,GAAMg6G,EACxB9+C,EAAQ2+C,EAAU75G,GAAM+5G,CAI3B,OAAO3uF,MAoBT2vC,GAAoB0I,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQhnB,GAAYwJ,YAEzElJ,YAAaQ,GAEb49C,aAAc,SAAWnQ,GAExB,MAAOx4G,MAAK8oH,iBAAkBtQ,EAAK,MAgCrC52G,OAAO48E,OAAQxT,IAKd1L,OAAQ,SAAW2qD,GAElB,GAEIx9C,GAFAC,EAAYu9C,EAAM1/C,WAKtB,IAA0BzpE,SAArB4rE,EAAUpN,OAEdmN,EAAOC,EAAUpN,OAAQ2qD,OAEnB,CAGNx9C,GAECtqE,KAAQ8nH,EAAM9nH,KACd8oE,MAASG,GAAeC,aAAc4+C,EAAMh/C,MAAO79D,OACnD89D,OAAUE,GAAeC,aAAc4+C,EAAM/+C,OAAQ99D,OAItD,IAAI+9D,GAAgB8+C,EAAMC,kBAErB/+C,KAAkB8+C,EAAMx+C,uBAE5BgB,EAAKtB,cAAgBA,GAQvB,MAFAsB,GAAKhrE,KAAOwoH,EAAME,cAEX19C,KAMT7qE,OAAO48E,OAAQxT,GAAcyI,WAE5BlJ,YAAaS,GAEbM,eAAgBvjE,aAEhBwjE,gBAAiBxjE,aAEjB0jE,qBAAsBwU,GAEtBmqC,iCAAkC,SAAWhvF,GAE5C,MAAO,IAAI2vC,IAAqB/qE,KAAKirE,MAAOjrE,KAAKkrE,OAAQlrE,KAAKqqH,eAAgBjvF,IAI/EkvF,+BAAgC,SAAWlvF,GAE1C,MAAO,IAAI0vC,IAAmB9qE,KAAKirE,MAAOjrE,KAAKkrE,OAAQlrE,KAAKqqH,eAAgBjvF,IAI7EmvF,+BAAgC,SAAWnvF,GAE1C,MAAO,IAAIqvC,IAAkBzqE,KAAKirE,MAAOjrE,KAAKkrE,OAAQlrE,KAAKqqH,eAAgBjvF,IAI5EowC,iBAAkB,SAAWL,GAE5B,GAAIq/C,EAEJ,QAASr/C,GAER,IAAK6U,IAEJwqC,EAAgBxqH,KAAKoqH,gCAErB,MAED,KAAKnqC,IAEJuqC,EAAgBxqH,KAAKsqH,8BAErB,MAED,KAAKpqC,IAEJsqC,EAAgBxqH,KAAKuqH,+BAMvB,GAAuBzpH,SAAlB0pH,EAA8B,CAElC,GAAIviE,GAAU,iCACbjoD,KAAKmqH,cAAgB,yBAA2BnqH,KAAKmC,IAEtD,IAAgCrB,SAA3Bd,KAAKi1E,kBAAkC,CAG3C,GAAK9J,IAAkBnrE,KAAKyrE,qBAM3B,KAAM,IAAInhD,OAAO29B,EAJjBjoD,MAAKwrE,iBAAkBxrE,KAAKyrE,sBAW9B,MADAprE,SAAQ4H,KAAM,uBAAwBggD,GAC/BjoD,KAMR,MAFAA,MAAKi1E,kBAAoBu1C,EAElBxqH,MAIRkqH,iBAAkB,WAEjB,OAASlqH,KAAKi1E,mBAEb,IAAKj1E,MAAKoqH,iCAET,MAAOpqC,GAER,KAAKhgF,MAAKsqH,+BAET,MAAOrqC,GAER,KAAKjgF,MAAKuqH,+BAET,MAAOrqC,MAMVmqC,aAAc,WAEb,MAAOrqH,MAAKkrE,OAAO9qE,OAASJ,KAAKirE,MAAM7qE,QAKxCqqH,MAAO,SAAWC,GAEjB,GAAoB,IAAfA,EAIJ,IAAM,GAFFz/C,GAAQjrE,KAAKirE,MAEPj7D,EAAI,EAAGgU,EAAIinD,EAAM7qE,OAAQ4P,IAAMgU,IAAMhU,EAE9Ci7D,EAAOj7D,IAAO06G,CAMhB,OAAO1qH,OAKR+K,MAAO,SAAW8qE,GAEjB,GAAmB,IAAdA,EAIJ,IAAM,GAFF5K,GAAQjrE,KAAKirE,MAEPj7D,EAAI,EAAGgU,EAAIinD,EAAM7qE,OAAQ4P,IAAMgU,IAAMhU,EAE9Ci7D,EAAOj7D,IAAO6lE,CAMhB,OAAO71E,OAMR6wB,KAAM,SAAWogD,EAAW05C,GAO3B,IALA,GAAI1/C,GAAQjrE,KAAKirE,MAChB2/C,EAAQ3/C,EAAM7qE,OACdytE,EAAO,EACPq5C,EAAK0D,EAAQ,EAEN/8C,IAAS+8C,GAAS3/C,EAAO4C,GAASoD,KAEtCpD,CAIJ,MAAQq5C,QAAcj8C,EAAOi8C,GAAOyD,KAEhCzD,CAMJ,MAFGA,EAEW,IAATr5C,GAAcq5C,IAAO0D,EAAQ,CAG5B/8C,GAAQq5C,IAAKA,EAAKv0G,KAAK7N,IAAKoiH,EAAI,GAAKr5C,EAAOq5C,EAAK,EAEtD,IAAItoE,GAAS5+C,KAAKqqH,cAClBrqH,MAAKirE,MAAQG,GAAe67C,WAAYh8C,EAAO4C,EAAMq5C,GACrDlnH,KAAKkrE,OAASE,GAAe67C,WAAYjnH,KAAKkrE,OAAQ2C,EAAOjvB,EAAQsoE,EAAKtoE,GAI3E,MAAO5+C,OAKR6qH,SAAU,WAET,GAAIC,IAAQ,EAERtgD,EAAYxqE,KAAKqqH,cAChB7/C,GAAY73D,KAAKC,MAAO43D,KAAgB,IAE5CnqE,QAAQC,MAAO,oDAAqDN,MACpE8qH,GAAQ,EAIT,IAAI7/C,GAAQjrE,KAAKirE,MAChBC,EAASlrE,KAAKkrE,OAEd0/C,EAAQ3/C,EAAM7qE,MAEA,KAAVwqH,IAEJvqH,QAAQC,MAAO,uCAAwCN,MACvD8qH,GAAQ,EAMT,KAAM,GAFFC,GAAW,KAEL/6G,EAAI,EAAGA,IAAM46G,EAAO56G,IAAO,CAEpC,GAAIg7G,GAAW//C,EAAOj7D,EAEtB,IAAyB,gBAAbg7G,IAAyB9W,MAAO8W,GAAa,CAExD3qH,QAAQC,MAAO,mDAAoDN,KAAMgQ,EAAGg7G,GAC5EF,GAAQ,CACR,OAID,GAAkB,OAAbC,GAAqBA,EAAWC,EAAW,CAE/C3qH,QAAQC,MAAO,0CAA2CN,KAAMgQ,EAAGg7G,EAAUD,GAC7ED,GAAQ,CACR,OAIDC,EAAWC,EAIZ,GAAgBlqH,SAAXoqE,GAECE,GAAe+7C,aAAcj8C,GAEjC,IAAM,GAAIl7D,GAAI,EAAGgU,EAAIknD,EAAO9qE,OAAQ4P,IAAMgU,IAAMhU,EAAI,CAEnD,GAAIlO,GAAQopE,EAAQl7D,EAEpB,IAAKkkG,MAAOpyG,GAAU,CAErBzB,QAAQC,MAAO,oDAAqDN,KAAMgQ,EAAGlO,GAC7EgpH,GAAQ,CACR,QAUJ,MAAOA,IAMRG,SAAU,WAWT,IAAM,GATFhgD,GAAQjrE,KAAKirE,MAChBC,EAASlrE,KAAKkrE,OACdtsB,EAAS5+C,KAAKqqH,eAEda,EAAsBlrH,KAAKkqH,qBAAuBhqC,GAElDirC,EAAa,EACb5iG,EAAY0iD,EAAM7qE,OAAS,EAElB4P,EAAI,EAAGA,EAAIuY,IAAcvY,EAAI,CAEtC,GAAIo7G,IAAO,EAEP/kH,EAAO4kE,EAAOj7D,GACdq7G,EAAWpgD,EAAOj7D,EAAI,EAI1B,IAAK3J,IAASglH,IAAoB,IAANr7G,GAAW3J,IAASA,EAAM,IAErD,GAAO6kH,EAwBNE,GAAO,MAhBP,KAAM,GAJFxoH,GAASoN,EAAI4uC,EAChB0sE,EAAU1oH,EAASg8C,EACnB2sE,EAAU3oH,EAASg8C,EAEVnR,EAAI,EAAGA,IAAMmR,IAAWnR,EAAI,CAErC,GAAI3rC,GAAQopE,EAAQtoE,EAAS6qC,EAE7B,IAAK3rC,IAAUopE,EAAQogD,EAAU79E,IAChC3rC,IAAUopE,EAAQqgD,EAAU99E,GAAM,CAElC29E,GAAO,CACP,QAgBJ,GAAKA,EAAO,CAEX,GAAKp7G,IAAMm7G,EAAa,CAEvBlgD,EAAOkgD,GAAelgD,EAAOj7D,EAK7B,KAAM,GAHFw7G,GAAax7G,EAAI4uC,EACpB6sE,EAAcN,EAAavsE,EAElBnR,EAAI,EAAGA,IAAMmR,IAAWnR,EAEjCy9B,EAAQugD,EAAch+E,GAAMy9B,EAAQsgD,EAAa/9E,KAMhD09E,GAQL,GAAK5iG,EAAY,EAAI,CAEpB0iD,EAAOkgD,GAAelgD,EAAO1iD,EAE7B,KAAM,GAAIijG,GAAajjG,EAAYq2B,EAAQ6sE,EAAcN,EAAavsE,EAAQnR,EAAI,EAAGA,IAAMmR,IAAWnR,EAErGy9B,EAAQugD,EAAch+E,GAAMy9B,EAAQsgD,EAAa/9E,KAI/C09E,EAWJ,MAPKA,KAAelgD,EAAM7qE,SAEzBJ,KAAKirE,MAAQG,GAAe67C,WAAYh8C,EAAO,EAAGkgD,GAClDnrH,KAAKkrE,OAASE,GAAe67C,WAAY/7C,EAAQ,EAAGigD,EAAavsE,IAI3D5+C,QAsBT0rE,GAAqB+H,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQjmB,GAAcyI,YAE5ElJ,YAAamB,GAEby+C,cAAe,OACf5+C,gBAAiBn+D,MAEjBq+D,qBAAsBuU,GAEtBsqC,+BAAgCxpH,OAChCypH,+BAAgCzpH,SAwBjC6qE,GAAmB8H,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQjmB,GAAcyI,YAE1ElJ,YAAaoB,GAEbw+C,cAAe,UA0BhBv+C,GAAoB6H,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQjmB,GAAcyI,YAE3ElJ,YAAaqB,GAEbu+C,cAAe,WAoBhBt+C,GAA4B4H,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQhnB,GAAYwJ,YAEjFlJ,YAAasB,GAEb88C,aAAc,SAAWnQ,EAAIhyC,EAAIpU,EAAGqU,GAUnC,IAAM,GARFrrC,GAASp7B,KAAKqqE,aACjBa,EAASlrE,KAAKmqE,aACdvrB,EAAS5+C,KAAKwqE,UAEd5nE,EAAS41G,EAAK55D,EAEdlkC,GAAU03C,EAAIoU,IAASC,EAAKD,GAEnBz5C,EAAMnqB,EAASg8C,EAAQh8C,IAAWmqB,EAAKnqB,GAAU,EAE1DrC,EAAWqrF,UAAWxwD,EAAQ,EAAG8vC,EAAQtoE,EAASg8C,EAAQssB,EAAQtoE,EAAQ8X,EAI3E,OAAO0gB,MAqBT0wC,GAAwB2H,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQjmB,GAAcyI,YAE/ElJ,YAAauB,GAEbq+C,cAAe,aAIf1+C,qBAAsBwU,GAEtBqqC,+BAAgC,SAAWlvF,GAE1C,MAAO,IAAIywC,IAA6B7rE,KAAKirE,MAAOjrE,KAAKkrE,OAAQlrE,KAAKqqH,eAAgBjvF,IAIvFmvF,+BAAgCzpH,SAoBjCirE,GAAoB0H,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQjmB,GAAcyI,YAE3ElJ,YAAawB,GAEbo+C,cAAe,SACf5+C,gBAAiBn+D,MAEjBq+D,qBAAsBuU,GAEtBsqC,+BAAgCxpH,OAEhCypH,+BAAgCzpH,SAoBjCkrE,GAAoByH,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQjmB,GAAcyI,YAE3ElJ,YAAayB,GAEbm+C,cAAe,WA8GhBvoH,OAAO48E,OAAQvS,IAEdW,MAAO,SAAWH,GAMjB,IAAM,GAJFN,MACHu/C,EAAaj/C,EAAKN,OAClBw/C,EAAY,GAAQl/C,EAAKm/C,KAAO,GAEvB57G,EAAI,EAAGgU,EAAI0nG,EAAWtrH,OAAQ4P,IAAMgU,IAAMhU,EAEnDm8D,EAAO/5D,KAAMo6D,GAAoBk/C,EAAY17G,IAAMjF,MAAO4gH,GAI3D,OAAO,IAAI1/C,IAAeQ,EAAKtqE,KAAMsqE,EAAKP,SAAUC,IAIrD7M,OAAQ,SAAW+U,GAclB,IAAM,GAZFlI,MACH0/C,EAAax3C,EAAKlI,OAEfM,GAEHtqE,KAAQkyE,EAAKlyE,KACb+pE,SAAYmI,EAAKnI,SACjBC,OAAUA,EACVnqE,KAAQqyE,EAAKryE,MAIJgO,EAAI,EAAGgU,EAAI6nG,EAAWzrH,OAAQ4P,IAAMgU,IAAMhU,EAEnDm8D,EAAO/5D,KAAM44D,GAAc1L,OAAQusD,EAAY77G,IAIhD,OAAOy8D,IAIRq/C,8BAA+B,SAAW3pH,EAAM4pH,EAAqBH,EAAKI,GAKzE,IAAM,GAHFC,GAAkBF,EAAoB3rH,OACtC+rE,KAEMn8D,EAAI,EAAGA,EAAIi8G,EAAiBj8G,IAAO,CAE5C,GAAIi7D,MACAC,IAEJD,GAAM74D,MACHpC,EAAIi8G,EAAkB,GAAMA,EAC9Bj8G,GACEA,EAAI,GAAMi8G,GAEb/gD,EAAO94D,KAAM,EAAG,EAAG,EAEnB,IAAIvI,GAAQuhE,GAAeo8C,iBAAkBv8C,EAC7CA,GAAQG,GAAes8C,YAAaz8C,EAAO,EAAGphE,GAC9CqhE,EAASE,GAAes8C,YAAax8C,EAAQ,EAAGrhE,GAIzCmiH,GAAyB,IAAf/gD,EAAO,KAEvBA,EAAM74D,KAAM65G,GACZ/gD,EAAO94D,KAAM84D,EAAQ,KAItBiB,EAAO/5D,KACN,GAAIw5D,IACH,0BAA4BmgD,EAAqB/7G,GAAI7N,KAAO,IAC5D8oE,EAAOC,GACNngE,MAAO,EAAM6gH,IAIjB,MAAO,IAAI3/C,IAAe9pE,OAAWgqE,IAItC+/C,WAAY,SAAWC,EAAmBhqH,GAEzC,GAAIiqH,GAAYD,CAEhB,KAAO/+G,MAAMC,QAAS8+G,GAAsB,CAE3C,GAAIh+D,GAAIg+D,CACRC,GAAYj+D,EAAE91C,UAAY81C,EAAE91C,SAASg0G,YAAcl+D,EAAEk+D,WAItD,IAAM,GAAIr8G,GAAI,EAAGA,EAAIo8G,EAAUhsH,OAAQ4P,IAEtC,GAAKo8G,EAAWp8G,GAAI7N,OAASA,EAE5B,MAAOiqH,GAAWp8G,EAMpB,OAAO,OAIRs8G,oCAAqC,SAAWx+G,EAAc89G,EAAKI,GAUlE,IAAM,GARFO,MAIA1/F,EAAU,qBAIJ7c,EAAI,EAAGyuB,EAAK3wB,EAAa1N,OAAQ4P,EAAIyuB,EAAIzuB,IAAO,CAEzD,GAAIkiG,GAAcpkG,EAAckC,GAC5Bw8G,EAAQta,EAAY/vG,KAAKqmB,MAAOqE,EAEpC,IAAK2/F,GAASA,EAAMpsH,OAAS,EAAI,CAEhC,GAAI+B,GAAOqqH,EAAO,GAEdC,EAAwBF,EAAyBpqH,EAC9CsqH,KAENF,EAAyBpqH,GAASsqH,MAInCA,EAAsBr6G,KAAM8/F,IAM9B,GAAIwa,KAEJ,KAAM,GAAIvqH,KAAQoqH,GAEjBG,EAAMt6G,KAAM65D,GAAc6/C,8BAA+B3pH,EAAMoqH,EAAyBpqH,GAAQypH,EAAKI,GAItG,OAAOU,IAKRC,eAAgB,SAAWr1E,EAAWnlB,GAErC,IAAOmlB,EAGN,MADAj3C,SAAQC,MAAO,yDACR,IAkCR,KAAM,GA9BFssH,GAAmB,SAAWlgD,EAAWmgD,EAAWC,EAAeC,EAAcC,GAGpF,GAA8B,IAAzBF,EAAc1sH,OAAe,CAEjC,GAAI6qE,MACAC,IAEJE,IAAeuB,YAAamgD,EAAe7hD,EAAOC,EAAQ6hD,GAGpC,IAAjB9hD,EAAM7qE,QAEV4sH,EAAW56G,KAAM,GAAIs6D,GAAWmgD,EAAW5hD,EAAOC,MAQjDiB,KAEA8gD,EAAW31E,EAAUn1C,MAAQ,UAE7B+pE,EAAW50B,EAAUl3C,WACrBwrH,EAAMt0E,EAAUs0E,KAAO,GAEvBsB,EAAkB51E,EAAU61E,cAEtBxwD,EAAI,EAAGA,EAAIuwD,EAAgB9sH,OAAQu8D,IAAO,CAEnD,GAAImwD,GAAgBI,EAAiBvwD,GAAIhO,IAGzC,IAAOm+D,GAA0C,IAAzBA,EAAc1sH,OAGtC,GAAK0sH,EAAe,GAAIh/G,aAAe,CAKtC,IAAM,GAFFs/G,MAEMrwF,EAAI,EAAGA,EAAI+vF,EAAc1sH,OAAQ28B,IAE1C,GAAK+vF,EAAe/vF,GAAIjvB,aAEvB,IAAM,GAAI8pD,GAAI,EAAGA,EAAIk1D,EAAe/vF,GAAIjvB,aAAa1N,OAAQw3D,IAE5Dw1D,EAAkBN,EAAe/vF,GAAIjvB,aAAc8pD,MAWtD,KAAM,GAAIy1D,KAAmBD,GAAmB,CAK/C,IAAM,GAHFniD,MACAC,KAEMtT,EAAI,EAAGA,IAAMk1D,EAAe/vF,GAAIjvB,aAAa1N,SAAWw3D,EAAI,CAErE,GAAI01D,GAAeR,EAAe/vF,EAElCkuC,GAAM74D,KAAMk7G,EAAajnH,MACzB6kE,EAAO94D,KAAQk7G,EAAapb,cAAgBmb,EAAoB,EAAI,GAIrElhD,EAAO/5D,KAAM,GAAIw5D,IAAqB,yBAA2ByhD,EAAkB,IAAKpiD,EAAOC,IAIhGgB,EAAWkhD,EAAiBhtH,QAAWwrH,GAAO,OAExC,CAIN,GAAI2B,GAAW,UAAYp7F,EAAOwqC,GAAIx6D,KAAO,GAE7CyqH,GACC5gD,GAAqBuhD,EAAW,YAChCT,EAAe,MAAO3gD,GAEvBygD,EACC9gD,GAAyByhD,EAAW,cACpCT,EAAe,MAAO3gD,GAEvBygD,EACC5gD,GAAqBuhD,EAAW,SAChCT,EAAe,MAAO3gD,IAMzB,GAAuB,IAAlBA,EAAO/rE,OAEX,MAAO,KAIR,IAAIi0E,GAAO,GAAIpI,IAAeghD,EAAU/gD,EAAUC,EAElD,OAAOkI,MAMTzyE,OAAO48E,OAAQvS,GAAcwH,WAE5BrH,cAAe,WAId,IAAM,GAFFD,GAASnsE,KAAKmsE,OAAQD,EAAW,EAE3Bl8D,EAAI,EAAGgU,EAAImoD,EAAO/rE,OAAQ4P,IAAMgU,IAAMhU,EAAI,CAEnD,GAAIi6G,GAAQjqH,KAAKmsE,OAAQn8D,EAEzBk8D,GAAWv5D,KAAK7N,IAAKonE,EAAU+9C,EAAMh/C,MAAOg/C,EAAMh/C,MAAM7qE,OAAS,IAMlE,MAFAJ,MAAKksE,SAAWA,EAETlsE,MAIR6wB,KAAM,WAEL,IAAM,GAAI7gB,GAAI,EAAGA,EAAIhQ,KAAKmsE,OAAO/rE,OAAQ4P,IAExChQ,KAAKmsE,OAAQn8D,GAAI6gB,KAAM,EAAG7wB,KAAKksE,SAIhC,OAAOlsE,OAIR6qH,SAAU,WAIT,IAAM,GAFFC,IAAQ,EAEF96G,EAAI,EAAGA,EAAIhQ,KAAKmsE,OAAO/rE,OAAQ4P,IAExC86G,EAAQA,GAAS9qH,KAAKmsE,OAAQn8D,GAAI66G,UAInC,OAAOC,IAIRG,SAAU,WAET,IAAM,GAAIj7G,GAAI,EAAGA,EAAIhQ,KAAKmsE,OAAO/rE,OAAQ4P,IAExChQ,KAAKmsE,OAAQn8D,GAAIi7G,UAIlB,OAAOjrH,SAiBT4B,OAAO48E,OAAQ3R,GAAe4G,WAE7BwsC,KAAM,SAAWt7C,EAAKT,EAAQC,EAAYC,GAEzC,GAAI5xD,GAAQxS,KAERgiH,EAAS,GAAI/8C,IAAYzyD,EAAM0yD,QACnC88C,GAAO/B,KAAMt7C,EAAK,SAAWnF,GAE5B0E,EAAQ1xD,EAAMo6D,MAAOugC,KAAKvgC,MAAOpN,MAE/B2E,EAAYC,IAIhBopD,YAAa,SAAW1rH,GAEvB9B,KAAKmiB,SAAWrgB,GAIjB8qE,MAAO,SAAWH,GAIjB,QAASghD,GAAYtrH,GAQpB,MAN0BrB,UAArBqhB,EAAUhgB,IAEd9B,QAAQ4H,KAAM,0CAA2C9F,GAInDggB,EAAUhgB,GAVlB,GAAIggB,GAAWniB,KAAKmiB,SAchB7J,EAAW,GAAIsnG,IAAWnzC,EAAKhrE,KAgDnC,IA9CmBX,SAAd2rE,EAAKzqE,OAAqBsW,EAAStW,KAAOyqE,EAAKzqE,MACjClB,SAAd2rE,EAAKtqE,OAAqBmW,EAASnW,KAAOsqE,EAAKtqE,MAChCrB,SAAf2rE,EAAKz/D,OAAsBsL,EAAStL,MAAMw6F,OAAQ/6B,EAAKz/D,OACpClM,SAAnB2rE,EAAKjmB,YAA0BluC,EAASkuC,UAAYimB,EAAKjmB,WACtC1lD,SAAnB2rE,EAAKhmB,YAA0BnuC,EAASmuC,UAAYgmB,EAAKhmB,WACvC3lD,SAAlB2rE,EAAKtnB,UAAyB7sC,EAAS6sC,SAASqiD,OAAQ/6B,EAAKtnB,UAC3CrkD,SAAlB2rE,EAAKtmB,UAAyB7tC,EAAS6tC,SAASqhD,OAAQ/6B,EAAKtmB,UAC1CrlD,SAAnB2rE,EAAKrmB,YAA0B9tC,EAAS8tC,UAAYqmB,EAAKrmB,WACtCtlD,SAAnB2rE,EAAK9lB,YAA0BruC,EAASquC,UAAY8lB,EAAK9lB,WAC7B7lD,SAA5B2rE,EAAK7lB,qBAAmCtuC,EAASsuC,mBAAqB6lB,EAAK7lB,oBACrD9lD,SAAtB2rE,EAAKl/D,eAA6B+K,EAAS/K,aAAek/D,EAAKl/D,cAClDzM,SAAb2rE,EAAKl5D,MAAoB+E,EAAS/E,IAAMk5D,EAAKl5D,KACxBzS,SAArB2rE,EAAK54D,cAA4ByE,EAASzE,YAAc44D,EAAK54D,aAC3C/S,SAAlB2rE,EAAKh5D,WAAyB6E,EAAS7E,SAAWg5D,EAAKh5D,UACzC3S,SAAd2rE,EAAK94D,OAAqB2E,EAAS3E,KAAO84D,EAAK94D,MAC9B7S,SAAjB2rE,EAAK14D,UAAwBuE,EAASvE,QAAU04D,EAAK14D,SAChCjT,SAArB2rE,EAAKz4D,cAA4BsE,EAAStE,YAAcy4D,EAAKz4D,aAC1ClT,SAAnB2rE,EAAKj3D,YAA0B8C,EAAS9C,UAAYi3D,EAAKj3D,WACtC1U,SAAnB2rE,EAAK73D,YAA0B0D,EAAS1D,UAAY63D,EAAK73D,WACrC9T,SAApB2rE,EAAK53D,aAA2ByD,EAASzD,WAAa43D,EAAK53D,YACvC/T,SAApB2rE,EAAKv3D,aAA2BoD,EAASpD,WAAau3D,EAAKv3D,YACxCpU,SAAnB2rE,EAAKh2D,YAA0B6B,EAAS7B,UAAYg2D,EAAKh2D,WAC7B3V,SAA5B2rE,EAAK/1D,qBAAmC4B,EAAS5B,mBAAqB+1D,EAAK/1D,oBACjD5V,SAA1B2rE,EAAK91D,mBAAiC2B,EAAS3B,iBAAmB81D,EAAK91D,kBAC5C7V,SAA3B2rE,EAAK71D,oBAAkC0B,EAAS1B,kBAAoB61D,EAAK71D,mBAEvD9V,SAAlB2rE,EAAK1pE,WAAyBuV,EAASvV,SAAW0pE,EAAK1pE,UAEpC,IAAnB0pE,EAAKr1D,YAAkBkB,EAASlB,UAAYq1D,EAAKr1D,WAC/BtW,SAAlB2rE,EAAK/mB,WAAyBptC,EAASotC,SAAW+mB,EAAK/mB,UACtC5kD,SAAjB2rE,EAAK7mB,UAAwBttC,EAASstC,QAAU6mB,EAAK7mB,SACtC9kD,SAAf2rE,EAAK1hE,QAAsBuN,EAASvN,MAAQ0hE,EAAK1hE,OAE1BjK,SAAvB2rE,EAAKr3D,gBAA8BkD,EAASlD,cAAgBq3D,EAAKr3D,eACpCtU,SAA7B2rE,EAAKp3D,sBAAoCiD,EAASjD,oBAAsBo3D,EAAKp3D,qBACjDvU,SAA5B2rE,EAAKn3D,qBAAmCgD,EAAShD,mBAAqBm3D,EAAKn3D,oBAEzDxU,SAAlB2rE,EAAK51D,WAAyByB,EAASzB,SAAW41D,EAAK51D,UACjC/V,SAAtB2rE,EAAK3+D,eAA6BwK,EAASxK,aAAe2+D,EAAK3+D,cAC5ChN,SAAnB2rE,EAAKl3D,YAA0B+C,EAAS/C,UAAYk3D,EAAKl3D,WAExCzU,SAAjB2rE,EAAKhhE,UAAwB6M,EAAS7M,QAAUghE,EAAKhhE,SACnC3K,SAAlB2rE,EAAK3gE,WAAyBwM,EAASxM,SAAW2gE,EAAK3gE,UAIrChL,SAAlB2rE,EAAKx1D,SAET,IAAM,GAAI9U,KAAQsqE,GAAKx1D,SAAW,CAEjC,GAAI2G,GAAU6uD,EAAKx1D,SAAU9U,EAI7B,QAFAmW,EAASrB,SAAU9U,MAEVyb,EAAQnc,MAEhB,IAAK,IACJ6W,EAASrB,SAAU9U,GAAOL,MAAQ2rH,EAAY7vG,EAAQ9b,MACtD,MAED,KAAK,IACJwW,EAASrB,SAAU9U,GAAOL,OAAQ,GAAI+D,IAAQ2hG,OAAQ5pF,EAAQ9b,MAC9D,MAED,KAAK,KACJwW,EAASrB,SAAU9U,GAAOL,OAAQ,GAAIjC,IAAUq4C,UAAWt6B,EAAQ9b,MACnE,MAED,KAAK,KACJwW,EAASrB,SAAU9U,GAAOL,OAAQ,GAAIf,IAAUm3C,UAAWt6B,EAAQ9b,MACnE,MAED,KAAK,KACJwW,EAASrB,SAAU9U,GAAOL,OAAQ,GAAI2B,IAAUy0C,UAAWt6B,EAAQ9b,MACnE,MAED,KAAK,KACJwW,EAASrB,SAAU9U,GAAOL,OAAQ,GAAI7B,IAAUi4C,UAAWt6B,EAAQ9b,MACnE,MAED,SACCwW,EAASrB,SAAU9U,GAAOL,MAAQ8b,EAAQ9b,OAqC9C,GA7BsBhB,SAAjB2rE,EAAKz1D,UAAwBsB,EAAStB,QAAUy1D,EAAKz1D,SAC/BlW,SAAtB2rE,EAAKv1D,eAA6BoB,EAASpB,aAAeu1D,EAAKv1D,cACvCpW,SAAxB2rE,EAAKt1D,iBAA+BmB,EAASnB,eAAiBs1D,EAAKt1D,gBAIlDrW,SAAjB2rE,EAAKihD,UAAwBp1G,EAASzE,YAA+B,IAAjB44D,EAAKihD,SAI3C5sH,SAAd2rE,EAAKxlD,OAAqB3O,EAAS2O,KAAOwlD,EAAKxlD,MACtBnmB,SAAzB2rE,EAAKj9C,kBAAgClX,EAASkX,gBAAkBi9C,EAAKj9C,iBAIxD1uB,SAAb2rE,EAAK52D,MAAoByC,EAASzC,IAAM43G,EAAYhhD,EAAK52D,MAEvC/U,SAAlB2rE,EAAKt2D,WAETmC,EAASnC,SAAWs3G,EAAYhhD,EAAKt2D,UACrCmC,EAAStE,aAAc,GAIFlT,SAAjB2rE,EAAKnhD,UAAwBhT,EAASgT,QAAUmiG,EAAYhhD,EAAKnhD,UAC9CxqB,SAAnB2rE,EAAKpmB,YAA0B/tC,EAAS+tC,UAAYomB,EAAKpmB,WAEtCvlD,SAAnB2rE,EAAKlhD,YAA0BjT,EAASiT,UAAYkiG,EAAYhhD,EAAKlhD,YAC9CzqB,SAAvB2rE,EAAKt4C,gBAA8B7b,EAAS6b,cAAgBs4C,EAAKt4C,eAC5CrzB,SAArB2rE,EAAKnmB,YAA4B,CAErC,GAAIA,GAAcmmB,EAAKnmB,WAElBl5C,OAAMC,QAASi5C,MAAkB,IAIrCA,GAAgBA,EAAaA,IAI9BhuC,EAASguC,aAAc,GAAIzmD,IAAUq4C,UAAWoO,GA4BjD,MAxB8BxlD,UAAzB2rE,EAAKx9C,kBAAgC3W,EAAS2W,gBAAkBw+F,EAAYhhD,EAAKx9C,kBACtDnuB,SAA3B2rE,EAAK/xC,oBAAkCpiB,EAASoiB,kBAAoB+xC,EAAK/xC,mBAC/C55B,SAA1B2rE,EAAK9xC,mBAAiCriB,EAASqiB,iBAAmB8xC,EAAK9xC,kBAEjD75B,SAAtB2rE,EAAKv9C,eAA6B5W,EAAS4W,aAAeu+F,EAAYhhD,EAAKv9C,eACrDpuB,SAAtB2rE,EAAKt9C,eAA6B7W,EAAS6W,aAAes+F,EAAYhhD,EAAKt9C,eAEtDruB,SAArB2rE,EAAKz9C,cAA4B1W,EAAS0W,YAAcy+F,EAAYhhD,EAAKz9C,cAC9CluB,SAA3B2rE,EAAKrnB,oBAAkC9sC,EAAS8sC,kBAAoBqnB,EAAKrnB,mBAEpDtkD,SAArB2rE,EAAKv2D,cAA4BoC,EAASpC,YAAcu3G,EAAYhhD,EAAKv2D,cAEzDpV,SAAhB2rE,EAAKr2D,SAAuBkC,EAASlC,OAASq3G,EAAYhhD,EAAKr2D,SAEzCtV,SAAtB2rE,EAAKl2D,eAA6B+B,EAAS/B,aAAek2D,EAAKl2D,cAE7CzV,SAAlB2rE,EAAK32D,WAAyBwC,EAASxC,SAAW23G,EAAYhhD,EAAK32D,WACxChV,SAA3B2rE,EAAK12D,oBAAkCuC,EAASvC,kBAAoB02D,EAAK12D,mBAE1DjV,SAAf2rE,EAAKz2D,QAAsBsC,EAAStC,MAAQy3G,EAAYhhD,EAAKz2D,QACrClV,SAAxB2rE,EAAKx2D,iBAA+BqC,EAASrC,eAAiBw2D,EAAKx2D,gBAE9CnV,SAArB2rE,EAAKh9C,cAA4BnX,EAASmX,YAAcg+F,EAAYhhD,EAAKh9C,cAEvEnX,KAgBT1W,OAAO48E,OAAQ1R,GAAqB2G,WAEnCwsC,KAAM,SAAWt7C,EAAKT,EAAQC,EAAYC,GAEzC,GAAI5xD,GAAQxS,KAERgiH,EAAS,GAAI/8C,IAAYzyD,EAAM0yD,QACnC88C,GAAO/B,KAAMt7C,EAAK,SAAWnF,GAE5B0E,EAAQ1xD,EAAMo6D,MAAOugC,KAAKvgC,MAAOpN,MAE/B2E,EAAYC,IAIhBwI,MAAO,SAAWH,GAEjB,GAAIp0D,GAAW,GAAInI,GAEfE,EAAQq8D,EAAK/nE,KAAK0L,KAEtB,IAAetP,SAAVsP,EAAsB,CAE1B,GAAIu9G,GAAa,GAAIC,IAAcx9G,EAAM3O,MAAQ2O,EAAM/I,MACvDgR,GAASxF,SAAU,GAAIjE,GAAiB++G,EAAY,IAIrD,GAAIt9G,GAAao8D,EAAK/nE,KAAK2L,UAE3B,KAAM,GAAIslB,KAAOtlB,GAAa,CAE7B,GAAIlJ,GAAYkJ,EAAYslB,GACxBg4F,EAAa,GAAIC,IAAczmH,EAAU1F,MAAQ0F,EAAUE,MAE/DgR,GAASvF,aAAc6iB,EAAK,GAAI/mB,GAAiB++G,EAAYxmH,EAAU0H,SAAU1H,EAAU2H,aAI5F,GAAIgB,GAAS28D,EAAK/nE,KAAKoL,QAAU28D,EAAK/nE,KAAKmpH,WAAaphD,EAAK/nE,KAAKopH,OAElE,IAAgBhtH,SAAXgP,EAEJ,IAAM,GAAIE,GAAI,EAAGgU,EAAIlU,EAAO1P,OAAQ4P,IAAMgU,IAAMhU,EAAI,CAEnD,GAAIimB,GAAQnmB,EAAQE,EAEpBqI,GAAS5F,SAAUwjB,EAAMtvB,MAAOsvB,EAAM/sB,MAAO+sB,EAAMhpB,eAMrD,GAAImB,GAAiBq+D,EAAK/nE,KAAK0J,cAE/B,IAAwBtN,SAAnBsN,EAA+B,CAEnC,GAAItL,GAAS,GAAI/B,EAEcD,UAA1BsN,EAAetL,QAEnBA,EAAOo1C,UAAW9pC,EAAetL,QAIlCuV,EAASjK,eAAiB,GAAIpJ,GAAQlC,EAAQsL,EAAenJ,QAI9D,MAAOoT,KAMT,IAAIu1G,KACHllH,UAAWA,UACXE,WAAYA,WAEZuG,kBAAgD,mBAAtBA,mBAAoCA,kBAAoBvG,WAClFR,WAAYA,WACZF,YAAaA,YACbM,WAAYA,WACZF,YAAaA,YACbP,aAAcA,aACdC,aAAcA,aASf+kE,IAAOghD,UAENC,YAEA3uF,IAAK,SAAW4uF,EAAOjM,GAEtBhiH,KAAKguH,SAAS57G,KAAM67G,EAAOjM,IAI5B34G,IAAK,SAAW02G,GAIf,IAAM,GAFFiO,GAAWhuH,KAAKguH,SAEVh+G,EAAI,EAAGC,EAAI+9G,EAAS5tH,OAAQ4P,EAAIC,EAAGD,GAAK,EAAI,CAErD,GAAIi+G,GAAQD,EAAUh+G,GAClBgyG,EAASgM,EAAUh+G,EAAI,EAE3B,IAAKi+G,EAAMzxF,KAAMujF,GAEhB,MAAOiC,GAMT,MAAO,QAMTpgH,OAAO48E,OAAQzR,GAAO0G,WAErB6uC,YAAa,YAEb4L,YAAa,aAEbC,eAAgB,aAEhBC,eAAgB,aAEhBC,cAAe,SAAWryC,EAAW7O,EAAam1C,GAIjD,IAAM,GAFFj7G,MAEM2I,EAAI,EAAGA,EAAIgsE,EAAU57E,SAAW4P,EAEzC3I,EAAO2I,GAAMhQ,KAAKsuH,eAAgBtyC,EAAWhsE,GAAKm9D,EAAam1C,EAIhE,OAAOj7G,IAIRinH,eAAgB,WAEf,GAAIC,IACH7pF,WAAYA,GACZhxB,eAAgBA,GAChBiyB,iBAAkBA,GAClBE,oBAAqBA,GACrBG,iBAAkBA,GAClBpB,eAAgBA,IAGb53B,EAAQ,GAAInH,GACZ2oH,EAAgB,GAAI/oD,IACpBgpD,EAAiB,GAAI5hD,GAEzB,OAAO,UAAyBjV,EAAGuV,EAAam1C,GAM/C,QAASP,GAAa35F,EAAMvlB,EAAQD,EAAQ0uF,EAAM5vF,GAEjD,GAGIuC,GAHAyqH,EAAWvhD,EAAc/kD,EACzB45F,EAASj1C,GAAOghD,SAAS1kH,IAAKqlH,EAIlB,QAAX1M,EAEJ/9G,EAAU+9G,EAAO/B,KAAMyO,IAIvBF,EAAc7L,eAAgBL,GAC9Br+G,EAAUuqH,EAAcvO,KAAMyO,IAIf5tH,SAAX+B,IAEJoB,EAAQpB,OAAOq1C,UAAWr1C,GAEL,IAAhBA,EAAQ,KAAYoB,EAAQ7C,MAAQyvC,IACpB,IAAhBhuC,EAAQ,KAAYoB,EAAQ5C,MAAQwvC,KAI1B/vC,SAAX8B,GAEJqB,EAAQrB,OAAOs1C,UAAWt1C,GAIb9B,SAATwwF,IAEe,WAAdA,EAAM,KAAmBrtF,EAAQ7C,MAAQyvC,IAC3B,WAAdygD,EAAM,KAAmBrtF,EAAQ7C,MAAQ2vC,IAE3B,WAAdugD,EAAM,KAAmBrtF,EAAQ5C,MAAQwvC,IAC3B,WAAdygD,EAAM,KAAmBrtF,EAAQ5C,MAAQ0vC,KAI3BjwC,SAAfY,IAEJuC,EAAQvC,WAAaA,EAItB,IAAIM,GAAOC,GAAMC,cAIjB,OAFAigB,GAAUngB,GAASiC,EAEZjC,EAvDR,GAAImgB,MA6DAsqD,GACHzqE,KAAMC,GAAMC,eACZT,KAAM,sBAGP,KAAM,GAAIU,KAAQy1D,GAAI,CAErB,GAAI91D,GAAQ81D,EAAGz1D,EAEf,QAASA,GAER,IAAK,WACL,IAAK,WACL,IAAK,iBACL,IAAK,eACJ,KACD,KAAK,UACJsqE,EAAKtqE,KAAOL,CACZ,MACD,KAAK,WACJ2qE,EAAKh5D,SAAW86G,EAAczsH,EAC9B,MACD,KAAK,eACL,IAAK,aACJzB,QAAQ4H,KAAM,+BAAgC9F,EAAM,0BACpD,MACD,KAAK,eACJsqE,EAAKz/D,MAAQA,EAAMkrC,UAAWp2C,GAAQ2mG,QACtC,MACD,KAAK,gBACJh8B,EAAKtmB,SAAWn5C,EAAMkrC,UAAWp2C,GAAQ2mG,QACzC,MACD,KAAK,gBACJh8B,EAAKtnB,SAAWn4C,EAAMkrC,UAAWp2C,GAAQ2mG,QACzC,MACD,KAAK,eACJh8B,EAAKrmB,UAAYtkD,CACjB,MACD,KAAK,UACyB,UAAxBA,EAAMyqE,gBAA4BE,EAAKhrE,KAAO,qBACtB,UAAxBK,EAAMyqE,gBAA4BE,EAAKhrE,KAAO,qBACtB,aAAxBK,EAAMyqE,gBAA+BE,EAAKhrE,KAAO,uBACtD,MACD,KAAK,aACJgrE,EAAK52D,IAAMksG,EAAajgH,EAAO81D,EAAE+2D,iBAAkB/2D,EAAEg3D,iBAAkBh3D,EAAEi3D,eAAgBj3D,EAAEk3D,qBAC3F,MACD,KAAK,mBACL,IAAK,mBACL,IAAK,iBACL,IAAK,uBACJ,KACD,KAAK,cACJriD,EAAKz9C,YAAc+yF,EAAajgH,EAAO81D,EAAEm3D,kBAAmBn3D,EAAEo3D,kBAAmBp3D,EAAEq3D,gBAAiBr3D,EAAEs3D,sBACtG,MACD,KAAK,oBACL,IAAK,oBACL,IAAK,kBACL,IAAK,wBACJ,KACD,KAAK,WACJziD,EAAK32D,SAAWisG,EAAajgH,EAAO81D,EAAEu3D,eAAgBv3D,EAAEw3D,eAAgBx3D,EAAEy3D,aAAcz3D,EAAE03D,mBAC1F,MACD,KAAK,iBACL,IAAK,iBACL,IAAK,eACL,IAAK,qBACJ,KACD,KAAK,QACJ7iD,EAAKz2D,MAAQ+rG,EAAajgH,EAAO81D,EAAE23D,YAAa33D,EAAE43D,YAAa53D,EAAE63D,UAAW73D,EAAE83D,gBAC9E,MACD,KAAK,cACL,IAAK,cACL,IAAK,YACL,IAAK,kBACJ,KACD,KAAK,UACJjjD,EAAKnhD,QAAUy2F,EAAajgH,EAAO81D,EAAE+3D,cAAe/3D,EAAEg4D,cAAeh4D,EAAEi4D,YAAaj4D,EAAEk4D,kBACtF,MACD,KAAK,eACJrjD,EAAKpmB,UAAYvkD,CACjB,MACD,KAAK,gBACL,IAAK,gBACL,IAAK,cACL,IAAK,oBACJ,KACD,KAAK,YACJ2qE,EAAKlhD,UAAYw2F,EAAajgH,EAAO81D,EAAEm4D,gBAAiBn4D,EAAEo4D,gBAAiBp4D,EAAEq4D,cAAer4D,EAAEs4D,oBAC9F,MACD,KAAK,kBACJzjD,EAAKnmB,YAAcxkD,CACnB,MACD,KAAK,kBACL,IAAK,kBACL,IAAK,gBACL,IAAK,sBACJ,KACD,KAAK,cACJ2qE,EAAKv2D,YAAc6rG,EAAajgH,EAAO81D,EAAEu4D,kBAAmBv4D,EAAEw4D,kBAAmBx4D,EAAEy4D,gBAAiBz4D,EAAE04D,sBACtG,MACD,KAAK,oBACL,IAAK,oBACL,IAAK,kBACL,IAAK,wBACJ,KACD,KAAK,eACJ7jD,EAAKt9C,aAAe4yF,EAAajgH,EAAO81D,EAAE24D,mBAAoB34D,EAAE44D,mBAAoB54D,EAAE64D,iBAAkB74D,EAAE84D,uBAC1G,MACD,KAAK,qBACL,IAAK,qBACL,IAAK,mBACL,IAAK,yBACJ,KACD,KAAK,eACJjkD,EAAKv9C,aAAe6yF,EAAajgH,EAAO81D,EAAE+4D,mBAAoB/4D,EAAEg5D,mBAAoBh5D,EAAEi5D,iBAAkBj5D,EAAEk5D,uBAC1G,MACD,KAAK,qBACL,IAAK,qBACL,IAAK,mBACL,IAAK,yBACJ,KACD,KAAK,WACJrkD,EAAKt2D,SAAW4rG,EAAajgH,EAAO81D,EAAEm5D,eAAgBn5D,EAAEo5D,eAAgBp5D,EAAEq5D,aAAcr5D,EAAEs5D,mBAC1F,MACD,KAAK,iBACL,IAAK,iBACL,IAAK,eACL,IAAK,qBACJ,KACD,KAAK,YACJzkD,EAAK94D,KAAOsG,EACZ,MACD,KAAK,cACJwyD,EAAK94D,KAAOmhB,EACZ,MACD,KAAK,eACJz0B,QAAQ4H,KAAM,yEACdwkE,EAAK14D,QAAUjS,CACf,MACD,KAAK,YACL,IAAK,aACL,IAAK,aACL,IAAK,UACL,IAAK,eACL,IAAK,cACL,IAAK,UACL,IAAK,YACJ2qE,EAAMtqE,GAASL,CACf,MACD,KAAK,eACCA,KAAU,IAAO2qE,EAAKl/D,aAAe0rE,IAC3B,SAAVn3E,IAAmB2qE,EAAKl/D,aAAeitE,GAC5C,MACD,SACCn6E,QAAQC,MAAO,2CAA4C6B,EAAML,IAcpE,MAPmB,sBAAd2qE,EAAKhrE,YAAsCgrE,GAAKtnB,SAClC,sBAAdsnB,EAAKhrE,YAAsCgrE,GAAKtmB,SAEhDsmB,EAAK14D,QAAU,IAAI04D,EAAKz4D,aAAc,GAE3Cy6G,EAAejB,YAAarrG,GAErBssG,EAAe7hD,MAAOH,QAYhC,IAAI0kD,KAEHC,WAAY,SAAW/pH,GAEtB,GAA4B,mBAAhBgqH,aAEX,OAAO,GAAIA,cAAcC,OAAQjqH,EASlC,KAAM,GAFF01D,GAAI,GAEE/sD,EAAI,EAAGyuB,EAAKp3B,EAAMjH,OAAQ4P,EAAIyuB,EAAIzuB,IAG3C+sD,GAAK+Q,OAAOyjD,aAAclqH,EAAO2I,GAKlC,OAAOwwG,oBAAoBgR,OAAQz0D,KAIpC00D,eAAgB,SAAW9sD,GAE1B,GAAIv0D,GAAQu0D,EAAI+sD,YAAa,IAE7B,OAAKthH,QAAuB,KAErBu0D,EAAI89C,OAAQ,EAAGryG,EAAQ,IA0BhCxO,QAAO48E,OAAQxR,GAAWyG,WAEzB6uC,YAAa,YAEbrC,KAAM,SAAWt7C,EAAKT,EAAQC,EAAYC,GAEzC,GAAI5xD,GAAQxS,KAERmtE,EAAcntE,KAAKmtE,aAA6C,gBAArBntE,MAAKmtE,YAA6BntE,KAAKmtE,YAAcgkD,GAAYM,eAAgB9sD,GAE5Hq9C,EAAS,GAAI/8C,IAAYjlE,KAAKklE,QAClC88C,GAAOH,mBAAoB7hH,KAAKitE,iBAChC+0C,EAAO/B,KAAMt7C,EAAK,SAAWnF,GAE5B,GAAIiN,GAAO0gC,KAAKvgC,MAAOpN,GACnB4xB,EAAW3kB,EAAK2kB,QAEpB,IAAkBtwF,SAAbswF,EAAyB,CAE7B,GAAI3vF,GAAO2vF,EAAS3vF,IAEpB,IAAcX,SAATW,GAEwB,WAAvBA,EAAK8qE,cAGT,WADAlsE,SAAQC,MAAO,qBAAuBqkE,EAAM,sDAS/C,GAAInkD,GAAShO,EAAMo6D,MAAOH,EAAMU,EAChCjJ,GAAQ1jD,EAAOnI,SAAUmI,EAAOw7D,YAE9B7X,EAAYC,IAIhBu+C,eAAgB,SAAW7gH,GAG1B,MADA9B,MAAKsiH,YAAcxgH,EACZ9B,MAIR2xH,eAAgB,SAAW7vH,GAG1B,MADA9B,MAAKmtE,YAAcrrE,EACZ9B,MAIR4sE,MAAO,WAEN,QAASglD,GAAYnlD,EAAMp0D,GAE1B,QAASw5G,GAAU/vH,EAAOgJ,GAEzB,MAAOhJ,GAAU,GAAKgJ,EAIvB,GAAIkF,GAAGy9B,EAAGqkF,EAETlvH,EAAQmvH,EAERC,EAAYC,EAAaC,EAASjlH,EAElCxL,EACA0wH,EACA1gB,EACAE,EACAC,EAAeC,EACfC,EAAcC,EAEdvjD,EAAQpvB,EAAMgzF,EAAOC,EAAOj6C,EAAKjzE,EAEjCmtH,EAAS16G,EAAI1G,EAAGC,EAEhBvD,EAAQ6+D,EAAK7+D,MACbF,EAAW++D,EAAK/+D,SAChBiC,EAAU88D,EAAK98D,QACfhC,EAAS8+D,EAAK9+D,OAEd5C,EAAQ0hE,EAAK1hE,MAEbwnH,EAAY,CAGb,IAAkBzxH,SAAb2rE,EAAK78D,IAAoB,CAI7B,IAAMI,EAAI,EAAGA,EAAIy8D,EAAK78D,IAAIxP,OAAQ4P,IAE5By8D,EAAK78D,IAAKI,GAAI5P,QAASmyH,GAI7B,KAAMviH,EAAI,EAAGA,EAAIuiH,EAAWviH,IAE3BqI,EAASxK,cAAemC,MAS1B,IAHApN,EAAS,EACTmvH,EAAUrkH,EAAStN,OAEXwC,EAASmvH,GAEhBvjE,EAAS,GAAIztD,GAEbytD,EAAO1uD,EAAI4N,EAAU9K,KAAcmI,EACnCyjD,EAAOzuD,EAAI2N,EAAU9K,KAAcmI,EACnCyjD,EAAOhuD,EAAIkN,EAAU9K,KAAcmI,EAEnCsN,EAAS3K,SAAS0E,KAAMo8C,EAOzB,KAHA5rD,EAAS,EACTmvH,EAAUnkH,EAAMxN,OAERwC,EAASmvH,GAchB,GAZAtwH,EAAOmM,EAAOhL,KAEduvH,EAASN,EAAUpwH,EAAM,GACzBgwG,EAAcogB,EAAUpwH,EAAM,GAC9BkwG,EAAkBkgB,EAAUpwH,EAAM,GAClCmwG,EAAgBigB,EAAUpwH,EAAM,GAChCowG,EAAsBggB,EAAUpwH,EAAM,GACtCqwG,EAAe+f,EAAUpwH,EAAM,GAC/BswG,EAAqB8f,EAAUpwH,EAAM,GAIhC0wH,EAAS,CA0Bb,GAxBAC,EAAQ,GAAIvlH,GACZulH,EAAMtlH,EAAIc,EAAOhL,GACjBwvH,EAAMpsH,EAAI4H,EAAOhL,EAAS,GAC1BwvH,EAAMrlH,EAAIa,EAAOhL,EAAS,GAE1ByvH,EAAQ,GAAIxlH,GACZwlH,EAAMvlH,EAAIc,EAAOhL,EAAS,GAC1ByvH,EAAMrsH,EAAI4H,EAAOhL,EAAS,GAC1ByvH,EAAMtlH,EAAIa,EAAOhL,EAAS,GAE1BA,GAAU,EAEL6uG,IAEJxkG,EAAgBW,EAAOhL,KACvBwvH,EAAMnlH,cAAgBA,EACtBolH,EAAMplH,cAAgBA,GAMvB6kH,EAAKz5G,EAASzK,MAAMxN,OAEfuxG,EAEJ,IAAM3hG,EAAI,EAAGA,EAAIuiH,EAAWviH,IAO3B,IALAsiH,EAAU7lD,EAAK78D,IAAKI,GAEpBqI,EAASxK,cAAemC,GAAK8hH,MAC7Bz5G,EAASxK,cAAemC,GAAK8hH,EAAK,MAE5BrkF,EAAI,EAAGA,EAAI,EAAGA,IAEnBykF,EAAUtkH,EAAOhL,KAEjBsO,EAAIohH,EAAmB,EAAVJ,GACb/gH,EAAImhH,EAAmB,EAAVJ,EAAc,GAE3Bt6G,EAAK,GAAI/X,GAASqR,EAAGC,GAEV,IAANs8B,GAAUp1B,EAASxK,cAAemC,GAAK8hH,GAAK1/G,KAAMwF,GAC5C,IAAN61B,GAAUp1B,EAASxK,cAAemC,GAAK8hH,EAAK,GAAI1/G,KAAMwF,EAsB9D,IAdKg6F,IAEJqgB,EAAmC,EAArBrkH,EAAOhL,KAErBwvH,EAAMjtH,OAAOc,IACZ0J,EAASsiH,KACTtiH,EAASsiH,KACTtiH,EAASsiH,IAGVI,EAAMltH,OAAOyZ,KAAMwzG,EAAMjtH,SAIrB0sG,EAEJ,IAAM7hG,EAAI,EAAGA,EAAI,EAAGA,IAEnBiiH,EAAmC,EAArBrkH,EAAOhL,KAErBuC,EAAS,GAAIpE,GACZ4O,EAASsiH,KACTtiH,EAASsiH,KACTtiH,EAASsiH,IAIC,IAANjiH,GAAUoiH,EAAMjlH,cAAciF,KAAMjN,GAC9B,IAAN6K,GAAUqiH,EAAMllH,cAAciF,KAAMjN,EAkB3C,IAXK2sG,IAEJkgB,EAAapkH,EAAOhL,KACpBw1E,EAAMzqE,EAAQqkH,GAEdI,EAAMplH,MAAMw6F,OAAQpvB,GACpBi6C,EAAMrlH,MAAMw6F,OAAQpvB,IAKhB25B,EAEJ,IAAM/hG,EAAI,EAAGA,EAAI,EAAGA,IAEnBgiH,EAAapkH,EAAOhL,KACpBw1E,EAAMzqE,EAAQqkH,GAEH,IAANhiH,GAAUoiH,EAAM7kH,aAAa6E,KAAM,GAAIvM,GAAOuyE,IACxC,IAANpoE,GAAUqiH,EAAM9kH,aAAa6E,KAAM,GAAIvM,GAAOuyE,GAMrD//D,GAASzK,MAAMwE,KAAMggH,GACrB/5G,EAASzK,MAAMwE,KAAMigH,OAEf,CAkBN,GAhBAjzF,EAAO,GAAIvyB,GACXuyB,EAAKtyB,EAAIc,EAAOhL,KAChBw8B,EAAKp5B,EAAI4H,EAAOhL,KAChBw8B,EAAKryB,EAAIa,EAAOhL,KAEX6uG,IAEJxkG,EAAgBW,EAAOhL,KACvBw8B,EAAKnyB,cAAgBA,GAMtB6kH,EAAKz5G,EAASzK,MAAMxN,OAEfuxG,EAEJ,IAAM3hG,EAAI,EAAGA,EAAIuiH,EAAWviH,IAM3B,IAJAsiH,EAAU7lD,EAAK78D,IAAKI,GAEpBqI,EAASxK,cAAemC,GAAK8hH,MAEvBrkF,EAAI,EAAGA,EAAI,EAAGA,IAEnBykF,EAAUtkH,EAAOhL,KAEjBsO,EAAIohH,EAAmB,EAAVJ,GACb/gH,EAAImhH,EAAmB,EAAVJ,EAAc,GAE3Bt6G,EAAK,GAAI/X,GAASqR,EAAGC,GAErBkH,EAASxK,cAAemC,GAAK8hH,GAAK1/G,KAAMwF,EAoB3C,IAZKg6F,IAEJqgB,EAAmC,EAArBrkH,EAAOhL,KAErBw8B,EAAKj6B,OAAOc,IACX0J,EAASsiH,KACTtiH,EAASsiH,KACTtiH,EAASsiH,KAKNpgB,EAEJ,IAAM7hG,EAAI,EAAGA,EAAI,EAAGA,IAEnBiiH,EAAmC,EAArBrkH,EAAOhL,KAErBuC,EAAS,GAAIpE,GACZ4O,EAASsiH,KACTtiH,EAASsiH,KACTtiH,EAASsiH,IAGV7yF,EAAKjyB,cAAciF,KAAMjN,EAe3B,IARK2sG,IAEJkgB,EAAapkH,EAAOhL,KACpBw8B,EAAKpyB,MAAMw6F,OAAQ75F,EAAQqkH,KAKvBjgB,EAEJ,IAAM/hG,EAAI,EAAGA,EAAI,EAAGA,IAEnBgiH,EAAapkH,EAAOhL,KACpBw8B,EAAK7xB,aAAa6E,KAAM,GAAIvM,GAAO8H,EAAQqkH,IAM7C35G,GAASzK,MAAMwE,KAAMgtB,IAQxB,QAASozF,GAAW/lD,EAAMp0D,GAEzB,GAAIo6G,GAAqD3xH,SAA7B2rE,EAAKgmD,oBAAsChmD,EAAKgmD,oBAAsB,CAElG,IAAKhmD,EAAKz+D,YAET,IAAM,GAAIgC,GAAI,EAAGC,EAAIw8D,EAAKz+D,YAAY5N,OAAQ4P,EAAIC,EAAGD,GAAKyiH,EAAsB,CAE/E,GAAI3yH,GAAI2sE,EAAKz+D,YAAagC,GACtBjQ,EAAM0yH,EAAsB,EAAMhmD,EAAKz+D,YAAagC,EAAI,GAAM,EAC9DxP,EAAMiyH,EAAsB,EAAMhmD,EAAKz+D,YAAagC,EAAI,GAAM,EAC9DvP,EAAMgyH,EAAsB,EAAMhmD,EAAKz+D,YAAagC,EAAI,GAAM,CAElEqI,GAASrK,YAAYoE,KAAM,GAAI3O,GAAS3D,EAAGC,EAAGS,EAAGC,IAMnD,GAAKgsE,EAAKx+D,YAET,IAAM,GAAI+B,GAAI,EAAGC,EAAIw8D,EAAKx+D,YAAY7N,OAAQ4P,EAAIC,EAAGD,GAAKyiH,EAAsB,CAE/E,GAAI3lH,GAAI2/D,EAAKx+D,YAAa+B,GACtBhK,EAAMysH,EAAsB,EAAMhmD,EAAKx+D,YAAa+B,EAAI,GAAM,EAC9DjD,EAAM0lH,EAAsB,EAAMhmD,EAAKx+D,YAAa+B,EAAI,GAAM,EAC9DsC,EAAMmgH,EAAsB,EAAMhmD,EAAKx+D,YAAa+B,EAAI,GAAM,CAElEqI,GAASpK,YAAYmE,KAAM,GAAI3O,GAASqJ,EAAG9G,EAAG+G,EAAGuF,IAMnD+F,EAAS8Z,MAAQs6C,EAAKt6C,MAEjB9Z,EAAS8Z,OAAS9Z,EAAS8Z,MAAM/xB,OAAS,IAAOiY,EAASrK,YAAY5N,SAAWiY,EAASpK,YAAY7N,QAAUiY,EAASpK,YAAY7N,SAAWiY,EAAS3K,SAAStN,SAEtKC,QAAQ4H,KAAM,sCAAwCoQ,EAAS3K,SAAStN,OAAS,mBAChFiY,EAASpK,YAAY7N,OAAS,uBAAyBiY,EAASrK,YAAY5N,OAAS,mBAMxF,QAASsyH,GAAejmD,EAAMp0D,GAE7B,GAAItN,GAAQ0hE,EAAK1hE,KAEjB,IAA2BjK,SAAtB2rE,EAAK3+D,aAET,IAAM,GAAIkC,GAAI,EAAGC,EAAIw8D,EAAK3+D,aAAa1N,OAAQ4P,EAAIC,EAAGD,IAAO,CAE5DqI,EAASvK,aAAckC,MACvBqI,EAASvK,aAAckC,GAAI7N,KAAOsqE,EAAK3+D,aAAckC,GAAI7N,KACzDkW,EAASvK,aAAckC,GAAItC,WAK3B,KAAM,GAHFilH,GAAct6G,EAASvK,aAAckC,GAAItC,SACzCklH,EAAcnmD,EAAK3+D,aAAckC,GAAItC,SAE/ByD,EAAI,EAAGy9F,EAAKgkB,EAAYxyH,OAAQ+Q,EAAIy9F,EAAIz9F,GAAK,EAAI,CAE1D,GAAIq9C,GAAS,GAAIztD,EACjBytD,GAAO1uD,EAAI8yH,EAAazhH,GAAMpG,EAC9ByjD,EAAOzuD,EAAI6yH,EAAazhH,EAAI,GAAMpG,EAClCyjD,EAAOhuD,EAAIoyH,EAAazhH,EAAI,GAAMpG,EAElC4nH,EAAYvgH,KAAMo8C,IAQrB,GAA0B1tD,SAArB2rE,EAAKomD,aAA6BpmD,EAAKomD,YAAYzyH,OAAS,EAAI,CAEpEC,QAAQ4H,KAAM,kFAKd,KAAM,GAHF2F,GAAQyK,EAASzK,MACjBilH,EAAcpmD,EAAKomD,YAAa,GAAIllH,OAE9BqC,EAAI,EAAGC,EAAIrC,EAAMxN,OAAQ4P,EAAIC,EAAGD,IAEzCpC,EAAOoC,GAAIhD,MAAMkrC,UAAW26E,EAAiB,EAAJ7iH,IAQ5C,QAAS8iH,GAAiBrmD,EAAMp0D,GAE/B,GAAI06G,MAGA1G,IAEoBvrH,UAAnB2rE,EAAKn1B,WAET+0E,EAAWj6G,KAAMq6D,EAAKn1B,WAIEx2C,SAApB2rE,EAAK4/C,aAEJ5/C,EAAK4/C,WAAWjsH,OAEpBisH,EAAaA,EAAWttD,OAAQ0N,EAAK4/C,YAIrCA,EAAWj6G,KAAMq6D,EAAK4/C,YAMxB,KAAM,GAAIr8G,GAAI,EAAGA,EAAIq8G,EAAWjsH,OAAQ4P,IAAO,CAE9C,GAAIqkE,GAAOpI,GAAc0gD,eAAgBN,EAAYr8G,GAAKqI,EAAS8Z,MAC9DkiD,IAAO0+C,EAAiB3gH,KAAMiiE,GAKpC,GAAKh8D,EAASvK,aAAe,CAG5B,GAAIklH,GAAsB/mD,GAAcqgD,oCAAqCj0G,EAASvK,aAAc,GACpGilH,GAAmBA,EAAiBh0D,OAAQi0D,GAIxCD,EAAiB3yH,OAAS,IAAIiY,EAASg0G,WAAa0G,GAI1D,MAAO,UAAgBtmD,EAAMU,GAETrsE,SAAd2rE,EAAK/nE,OAGT+nE,EAAOA,EAAK/nE,MAIO5D,SAAf2rE,EAAK1hE,MAET0hE,EAAK1hE,MAAQ,EAAM0hE,EAAK1hE,MAIxB0hE,EAAK1hE,MAAQ,CAId,IAAIsN,GAAW,GAAI7K,EAUnB,IARAokH,EAAYnlD,EAAMp0D,GAClBm6G,EAAW/lD,EAAMp0D,GACjBq6G,EAAejmD,EAAMp0D,GACrBy6G,EAAiBrmD,EAAMp0D,GAEvBA,EAAS+pD,qBACT/pD,EAAS4iE,wBAEen6E,SAAnB2rE,EAAKuP,WAAqD,IAA1BvP,EAAKuP,UAAU57E,OAEnD,OAASiY,SAAUA,EAInB,IAAI2jE,GAAYjP,GAAO0G,UAAU46C,cAAe5hD,EAAKuP,UAAW7O,EAAantE,KAAKsiH,YAElF,QAASjqG,SAAUA,EAAU2jE,UAAWA,SAqB5Cp6E,OAAO48E,OAAQtR,GAAauG,WAE3B6uC,YAAa,YAEbrC,KAAM,SAAWt7C,EAAKT,EAAQC,EAAYC,GAEf,KAArBpkE,KAAKmtE,cAETntE,KAAKmtE,YAAcxI,EAAIsuD,UAAW,EAAGtuD,EAAI+sD,YAAa,KAAQ,GAI/D,IAAIl/G,GAAQxS,KAERgiH,EAAS,GAAI/8C,IAAYzyD,EAAM0yD,QACnC88C,GAAO/B,KAAMt7C,EAAK,SAAWnF,GAE5B,GAAIiN,GAAO,IAEX,KAECA,EAAO0gC,KAAKvgC,MAAOpN,GAElB,MAAQl/D,GAMT,MAJiBQ,UAAZsjE,GAAwBA,EAAS9jE,OAEtCD,SAAQC,MAAO,mCAAsCqkE,EAAM,IAAKrkE,EAAM2nD,SAMvE,GAAImpC,GAAW3kB,EAAK2kB,QAEpB,OAAkBtwF,UAAbswF,GAA4CtwF,SAAlBswF,EAAS3vF,MAAsD,aAAhC2vF,EAAS3vF,KAAK8qE,kBAE3ElsE,SAAQC,MAAO,kCAAqCqkE,EAAM,uCAK3DnyD,GAAMo6D,MAAOH,EAAMvI,IAEjBC,EAAYC,IAIhButD,eAAgB,SAAW7vH,GAG1B,MADA9B,MAAKmtE,YAAcrrE,EACZ9B,MAIR2iH,eAAgB,SAAW7gH,GAG1B,MADA9B,MAAKsiH,YAAcxgH,EACZ9B,MAIR4sE,MAAO,SAAWH,EAAMvI,GAEvB,GAAIlK,GAASh6D,KAAKkzH,WAAYzmD,EAAKzS,QAC/B75C,EAAangB,KAAKmzH,gBAAiB1mD,EAAKtsD,WAAY65C,GAEpDx2C,EAASxjB,KAAKozH,YAAa3mD,EAAKjpD,OAAQ,WAE3B1iB,SAAXojE,GAAuBA,EAAQ1jD,KAIjC2B,EAAWniB,KAAKqzH,cAAe5mD,EAAKtqD,SAAUqB,GAC9Cw4D,EAAYh8E,KAAKszH,eAAgB7mD,EAAKuP,UAAW75D,GAEjD3B,EAASxgB,KAAKuzH,YAAa9mD,EAAKjsD,OAAQL,EAAY67D,EAcxD,OAZKvP,GAAK4/C,aAET7rG,EAAO6rG,WAAarsH,KAAK8yH,gBAAiBrmD,EAAK4/C,aAI3BvrH,SAAhB2rE,EAAKjpD,QAA+C,IAAvBipD,EAAKjpD,OAAOpjB,QAE7BU,SAAXojE,GAAuBA,EAAQ1jD,GAI9BA,GAIR0yG,WAAY,SAAWzmD,GAEtB,GAAIzS,KAEJ,IAAcl5D,SAAT2rE,EAEJ,IAAM,GAAIz8D,GAAI,EAAGC,EAAIw8D,EAAKrsE,OAAQ4P,EAAIC,EAAGD,IAAO,CAE/C,GAAImqD,IAAQ,GAAIkP,KAAQk7C,SAAU93C,EAAMz8D,GAExCgqD,GAAQG,EAAMn4D,MAASm4D,EAMzB,MAAOH,IAIRm5D,gBAAiB,SAAW1mD,EAAMzS,GAEjC,GAAI75C,KAEJ,IAAcrf,SAAT2rE,EAKJ,IAAM,GAHF+mD,GAAiB,GAAIxmD,IACrBymD,EAAuB,GAAI3mD,IAErB98D,EAAI,EAAGC,EAAIw8D,EAAKrsE,OAAQ4P,EAAIC,EAAGD,IAAO,CAE/C,GAAIqI,GACA3T,EAAO+nE,EAAMz8D,EAEjB,QAAStL,EAAKjD,MAEb,IAAK,gBACL,IAAK,sBAEJ4W,EAAW,GAAIqnG,IAAYh7G,EAAKjD,MAC/BiD,EAAKf,MACLe,EAAKd,OACLc,EAAKgM,cACLhM,EAAKiM,eAGN,MAED,KAAK,cACL,IAAK,oBACL,IAAK,eAEJ0H,EAAW,GAAIqnG,IAAYh7G,EAAKjD,MAC/BiD,EAAKf,MACLe,EAAKd,OACLc,EAAK+L,MACL/L,EAAKgM,cACLhM,EAAKiM,eACLjM,EAAKkM,cAGN,MAED,KAAK,iBACL,IAAK,uBAEJyH,EAAW,GAAIqnG,IAAYh7G,EAAKjD,MAC/BiD,EAAKO,OACLP,EAAKs8D,SACLt8D,EAAKs7D,WACLt7D,EAAKu7D,YAGN,MAED,KAAK,mBACL,IAAK,yBAEJ5nD,EAAW,GAAIqnG,IAAYh7G,EAAKjD,MAC/BiD,EAAKg+D,UACLh+D,EAAKi+D,aACLj+D,EAAKd,OACLc,EAAK+tD,eACL/tD,EAAKiM,eACLjM,EAAKk+D,UACLl+D,EAAKs7D,WACLt7D,EAAKu7D,YAGN,MAED,KAAK,eACL,IAAK,qBAEJ5nD,EAAW,GAAIqnG,IAAYh7G,EAAKjD,MAC/BiD,EAAKO,OACLP,EAAKd,OACLc,EAAK+tD,eACL/tD,EAAKiM,eACLjM,EAAKk+D,UACLl+D,EAAKs7D,WACLt7D,EAAKu7D,YAGN,MAED,KAAK,iBACL,IAAK,uBAEJ5nD,EAAW,GAAIqnG,IAAYh7G,EAAKjD,MAC/BiD,EAAKO,OACLP,EAAKgM,cACLhM,EAAKiM,eACLjM,EAAKo7D,SACLp7D,EAAKq7D,UACLr7D,EAAKs7D,WACLt7D,EAAKu7D,YAGN,MAED,KAAK,uBACL,IAAK,6BACL,IAAK,sBACL,IAAK,4BACL,IAAK,qBACL,IAAK,2BACL,IAAK,sBACL,IAAK,4BAEJ5nD,EAAW,GAAIqnG,IAAYh7G,EAAKjD,MAC/BiD,EAAKO,OACLP,EAAKkrD,OAGN,MAED,KAAK,eACL,IAAK,qBAEJv3C,EAAW,GAAIqnG,IAAYh7G,EAAKjD,MAC/BiD,EAAK67D,YACL77D,EAAK87D,YACL97D,EAAK+7D,cACL/7D,EAAKg8D,YACLh8D,EAAKs7D,WACLt7D,EAAKu7D,YAGN,MAED,KAAK,gBACL,IAAK,sBAEJ5nD,EAAW,GAAIqnG,IAAYh7G,EAAKjD,MAC/BiD,EAAKO,OACLP,EAAKivD,KACLjvD,EAAK+tD,eACL/tD,EAAK8tD,gBACL9tD,EAAKiwD,IAGN,MAED,KAAK,oBACL,IAAK,0BAEJt8C,EAAW,GAAIqnG,IAAYh7G,EAAKjD,MAC/BiD,EAAKO,OACLP,EAAKivD,KACLjvD,EAAK8tD,gBACL9tD,EAAK+tD,eACL/tD,EAAKywB,EACLzwB,EAAKkvD,EAGN,MAED,KAAK,gBACL,IAAK,sBAEJv7C,EAAW,GAAIqnG,IAAYh7G,EAAKjD,MAC/BiD,EAAKud,OACLvd,EAAKs8D,SACLt8D,EAAKo7D,SACLp7D,EAAKq7D,UAGN,MAED,KAAK,qBACL,IAAK,2BAEJ1nD,EAAW,GAAIqnG,IAAYh7G,EAAKjD,MAC/BiD,EAAKgJ,SACLhJ,EAAK6N,QACL7N,EAAKO,OACLP,EAAKgvH,QAGN,MAED,KAAK,gBACL,IAAK,sBAIJ,IAAM,GAFFC,MAEMlmF,EAAI,EAAGC,EAAKhpC,EAAKs1D,OAAO55D,OAAQqtC,EAAIC,EAAID,IAAO,CAExD,GAAI0sB,GAAQH,EAAQt1D,EAAKs1D,OAAQvsB,GAEjCkmF,GAAevhH,KAAM+nD,GAItB9hD,EAAW,GAAIqnG,IAAYh7G,EAAKjD,MAC/BkyH,EACAjvH,EAAKk5D,cAGN,MAGD,KAAK,kBACL,IAAK,wBAIJ,IAAM,GAFF+1D,MAEMlmF,EAAI,EAAGC,EAAKhpC,EAAKs1D,OAAO55D,OAAQqtC,EAAIC,EAAID,IAAO,CAExD,GAAI0sB,GAAQH,EAAQt1D,EAAKs1D,OAAQvsB,GAEjCkmF,GAAevhH,KAAM+nD,GAItB,GAAI4D,GAAcr5D,EAAKb,QAAQk6D,WAEVj9D,UAAhBi9D,IAEJr5D,EAAKb,QAAQk6D,aAAc,GAAIynD,IAAQznD,EAAYt8D,OAAS8iH,SAAUxmD,IAIvE1lD,EAAW,GAAIqnG,IAAYh7G,EAAKjD,MAC/BkyH,EACAjvH,EAAKb,QAGN,MAED,KAAK,iBAEJwU,EAAWo7G,EAAqB7mD,MAAOloE,EAEvC,MAED,KAAK,WAEJ2T,EAAWm7G,EAAe5mD,MAAOloE,EAAM1E,KAAKmtE,aAAc90D,QAE1D,MAED,SAEChY,QAAQ4H,KAAM,kDAAoDvD,EAAKjD,KAAO,IAE9E,UAIF4W,EAASrW,KAAO0C,EAAK1C,KAEFlB,SAAd4D,EAAKvC,OAAqBkW,EAASlW,KAAOuC,EAAKvC,MAC/CkW,EAASqI,oBAAqB,GAA0B5f,SAAlB4D,EAAKoH,WAAyBuM,EAASvM,SAAWpH,EAAKoH,UAElGqU,EAAYzb,EAAK1C,MAASqW,EAM5B,MAAO8H,IAIRmzG,eAAgB,SAAW7mD,EAAMtqD,GAEhC,GAAI65D,KAEJ,IAAcl7E,SAAT2rE,EAAqB,CAEzB,GAAIu1C,GAAS,GAAIn1C,GACjBm1C,GAAOwL,YAAarrG,EAEpB,KAAM,GAAInS,GAAI,EAAGC,EAAIw8D,EAAKrsE,OAAQ4P,EAAIC,EAAGD,IAAO,CAE/C,GAAItL,GAAO+nE,EAAMz8D,EAEjB,IAAmB,kBAAdtL,EAAKjD,KAA2B,CAMpC,IAAM,GAFF4F,MAEMomC,EAAI,EAAGA,EAAI/oC,EAAKs3E,UAAU57E,OAAQqtC,IAE3CpmC,EAAM+K,KAAM4vG,EAAOp1C,MAAOloE,EAAKs3E,UAAWvuC,IAI3CuuC,GAAWt3E,EAAK1C,MAASqF,MAIzB20E,GAAWt3E,EAAK1C,MAASggH,EAAOp1C,MAAOloE,IAQ1C,MAAOs3E,IAIR82C,gBAAiB,SAAWrmD,GAI3B,IAAM,GAFF4/C,MAEMr8G,EAAI,EAAGA,EAAIy8D,EAAKrsE,OAAQ4P,IAAO,CAExC,GAAItL,GAAO+nE,EAAMz8D,GAEbqkE,EAAOpI,GAAcW,MAAOloE,EAEb5D,UAAd4D,EAAK1C,OAAqBqyE,EAAKryE,KAAO0C,EAAK1C,MAEhDqqH,EAAWj6G,KAAMiiE,GAIlB,MAAOg4C,IAIR+G,YAAa,SAAW3mD,EAAMvI,GAK7B,QAAS0vD,GAAWjvD,GAInB,MAFAnyD,GAAM0yD,QAAQR,UAAWC,GAElBq9C,EAAO/B,KAAMt7C,EAAK,WAExBnyD,EAAM0yD,QAAQN,QAASD,IAErB7jE,OAAW,WAEb0R,EAAM0yD,QAAQN,QAASD,GACvBnyD,EAAM0yD,QAAQL,UAAWF,KAd3B,GAAInyD,GAAQxS,KACRwjB,IAmBJ,IAAc1iB,SAAT2rE,GAAsBA,EAAKrsE,OAAS,EAAI,CAE5C,GAAI8kE,GAAU,GAAIjB,IAAgBC,GAE9B89C,EAAS,GAAIz8C,IAAaL,EAC9B88C,GAAOW,eAAgB3iH,KAAKsiH,YAE5B,KAAM,GAAItyG,GAAI,EAAGyuB,EAAKguC,EAAKrsE,OAAQ4P,EAAIyuB,EAAIzuB,IAAO,CAEjD,GAAI9O,GAAQurE,EAAMz8D,GACd20D,EAAMzjE,EAAMyjE,GAEhB,IAAKv3D,MAAMC,QAASs3D,GAAQ,CAI3BnhD,EAAQtiB,EAAMc,QAEd,KAAM,GAAIyrC,GAAI,EAAGC,EAAKi3B,EAAIvkE,OAAQqtC,EAAIC,EAAID,IAAO,CAEhD,GAAIomF,GAAalvD,EAAKl3B,GAElBrlB,EAAO,4BAA4BoU,KAAMq3F,GAAeA,EAAarhH,EAAM26D,YAAc0mD,CAE7FrwG,GAAQtiB,EAAMc,MAAOoQ,KAAMwhH,EAAWxrG,SAIjC,CAIN,GAAIA,GAAO,4BAA4BoU,KAAMt7B,EAAMyjE,KAAQzjE,EAAMyjE,IAAMnyD,EAAM26D,YAAcjsE,EAAMyjE,GAEjGnhD,GAAQtiB,EAAMc,MAAS4xH,EAAWxrG,KAQrC,MAAO5E,IAIR6vG,cAAe,SAAW5mD,EAAMjpD,GAE/B,QAASswG,GAAehyH,EAAOL,GAE9B,MAAsB,gBAAVK,GAA4BA,GAExCzB,QAAQ4H,KAAM,uEAAwEnG,GAE/EL,EAAMK,IAId,GAAIqgB,KAEJ,IAAcrhB,SAAT2rE,EAEJ,IAAM,GAAIz8D,GAAI,EAAGC,EAAIw8D,EAAKrsE,OAAQ4P,EAAIC,EAAGD,IAAO,CAE/C,GAAItL,GAAO+nE,EAAMz8D,EAEGlP,UAAf4D,EAAKxD,OAETb,QAAQ4H,KAAM,+CAAgDvD,EAAK1C,MAItClB,SAAzB0iB,EAAQ9e,EAAKxD,QAEjBb,QAAQ4H,KAAM,sCAAuCvD,EAAKxD,MAI3D,IAAI+C,EAIHA,GAFImJ,MAAMC,QAASmW,EAAQ9e,EAAKxD,QAEtB,GAAIqiB,IAAaC,EAAQ9e,EAAKxD,QAI9B,GAAID,GAASuiB,EAAQ9e,EAAKxD,QAIrC+C,EAAQ0R,aAAc,EAEtB1R,EAAQjC,KAAO0C,EAAK1C,KAEDlB,SAAd4D,EAAKvC,OAAqB8B,EAAQ9B,KAAOuC,EAAKvC,MAE7BrB,SAAjB4D,EAAKvD,UAAwB8C,EAAQ9C,QAAU2yH,EAAepvH,EAAKvD,QAAS4yH,KAE5DjzH,SAAhB4D,EAAK9B,QAAuBqB,EAAQrB,OAAOs1C,UAAWxzC,EAAK9B,QAC3C9B,SAAhB4D,EAAK7B,QAAuBoB,EAAQpB,OAAOq1C,UAAWxzC,EAAK7B,QAC3C/B,SAAhB4D,EAAK5B,QAAuBmB,EAAQnB,OAAOo1C,UAAWxzC,EAAK5B,QACzChC,SAAlB4D,EAAK3B,WAAyBkB,EAAQlB,SAAW2B,EAAK3B,UAExCjC,SAAd4D,EAAK4sF,OAETrtF,EAAQ7C,MAAQ0yH,EAAepvH,EAAK4sF,KAAM,GAAK0iC,IAC/C/vH,EAAQ5C,MAAQyyH,EAAepvH,EAAK4sF,KAAM,GAAK0iC;AAI3BlzH,SAAhB4D,EAAKlD,SAAuByC,EAAQzC,OAASkD,EAAKlD,QAE/BV,SAAnB4D,EAAKnD,YAA0B0C,EAAQ1C,UAAYuyH,EAAepvH,EAAKnD,UAAW0yH,KAC/DnzH,SAAnB4D,EAAKpD,YAA0B2C,EAAQ3C,UAAYwyH,EAAepvH,EAAKpD,UAAW2yH,KAC9DnzH,SAApB4D,EAAKhD,aAA2BuC,EAAQvC,WAAagD,EAAKhD,YAE3CZ,SAAf4D,EAAKtB,QAAsBa,EAAQb,MAAQsB,EAAKtB,OAErD+e,EAAUzd,EAAK1C,MAASiC,EAM1B,MAAOke,IAIRoxG,YAAa,SAAW7uH,EAAMyb,EAAY67D,GAIzC,QAASk4C,GAAa/xH,GAQrB,MAN4BrB,UAAvBqf,EAAYhe,IAEhB9B,QAAQ4H,KAAM,yCAA0C9F,GAIlDge,EAAYhe,GAIpB,QAASgyH,GAAahyH,GAErB,GAAcrB,SAATqB,EAAL,CAEA,GAAKiL,MAAMC,QAASlL,GAAS,CAI5B,IAAM,GAFFkF,MAEM2I,EAAI,EAAGC,EAAI9N,EAAK/B,OAAQ4P,EAAIC,EAAGD,IAAO,CAE/C,GAAIhO,GAAOG,EAAM6N,EAEUlP,UAAtBk7E,EAAWh6E,IAEf3B,QAAQ4H,KAAM,yCAA0CjG,GAIzDqF,EAAM+K,KAAM4pE,EAAWh6E,IAIxB,MAAOqF,GAUR,MAN2BvG,UAAtBk7E,EAAW75E,IAEf9B,QAAQ4H,KAAM,yCAA0C9F,GAIlD65E,EAAW75E,IA9CnB,GAAIqe,EAkDJ,QAAS9b,EAAKjD,MAEb,IAAK,QAEJ+e,EAAS,GAAI2rC,IAEYrrD,SAApB4D,EAAK0U,YAEJgiD,OAAOijB,UAAW35E,EAAK0U,cAE3BoH,EAAOpH,WAAa,GAAIvT,GAAOnB,EAAK0U,aAMpBtY,SAAb4D,EAAK6O,MAEc,QAAlB7O,EAAK6O,IAAI9R,KAEb+e,EAAOjN,IAAM,GAAI24C,IAAKxnD,EAAK6O,IAAIvG,MAAOtI,EAAK6O,IAAI/G,KAAM9H,EAAK6O,IAAI9G,KAEjC,YAAlB/H,EAAK6O,IAAI9R,OAEpB+e,EAAOjN,IAAM,GAAI04C,IAASvnD,EAAK6O,IAAIvG,MAAOtI,EAAK6O,IAAI2yC,UAMrD,MAED,KAAK,oBAEJ1lC,EAAS,GAAIy1B,IAAmBvxC,EAAKwxC,IAAKxxC,EAAKyxC,OAAQzxC,EAAK8H,KAAM9H,EAAK+H,KAEnD3L,SAAf4D,EAAK0xC,QAAsB51B,EAAO41B,MAAQ1xC,EAAK0xC,OACjCt1C,SAAd4D,EAAKgI,OAAqB8T,EAAO9T,KAAOhI,EAAKgI,MAC1B5L,SAAnB4D,EAAK2xC,YAA0B71B,EAAO61B,UAAY3xC,EAAK2xC,WACnCv1C,SAApB4D,EAAK4xC,aAA2B91B,EAAO81B,WAAa5xC,EAAK4xC,YAC3Cx1C,SAAd4D,EAAKiI,OAAqB6T,EAAO7T,KAAO/K,OAAO48E,UAAY95E,EAAKiI,MAErE,MAED,KAAK,qBAEJ6T,EAAS,GAAIrU,GAAoBzH,EAAK0H,KAAM1H,EAAK2H,MAAO3H,EAAK4H,IAAK5H,EAAK6H,OAAQ7H,EAAK8H,KAAM9H,EAAK+H,KAE5E3L,SAAd4D,EAAKgI,OAAqB8T,EAAO9T,KAAOhI,EAAKgI,MAC/B5L,SAAd4D,EAAKiI,OAAqB6T,EAAO7T,KAAO/K,OAAO48E,UAAY95E,EAAKiI,MAErE,MAED,KAAK,eAEJ6T,EAAS,GAAIupD,IAAcrlE,EAAKsI,MAAOtI,EAAKqzB,UAE5C,MAED,KAAK,mBAEJvX,EAAS,GAAIspD,IAAkBplE,EAAKsI,MAAOtI,EAAKqzB,UAEhD,MAED,KAAK,aAEJvX,EAAS,GAAIopD,IAAYllE,EAAKsI,MAAOtI,EAAKqzB,UAAWrzB,EAAKoyB,SAAUpyB,EAAKuyB,MAEzE,MAED,KAAK,gBAEJzW,EAAS,GAAIwpD,IAAetlE,EAAKsI,MAAOtI,EAAKqzB,UAAWrzB,EAAKf,MAAOe,EAAKd,OAEzE,MAED,KAAK,YAEJ4c,EAAS,GAAIkpD,IAAWhlE,EAAKsI,MAAOtI,EAAKqzB,UAAWrzB,EAAKoyB,SAAUpyB,EAAKm0B,MAAOn0B,EAAKo0B,SAAUp0B,EAAKuyB,MAEnG,MAED,KAAK,kBAEJzW,EAAS,GAAI+oD,IAAiB7kE,EAAKsI,MAAOtI,EAAK2yB,YAAa3yB,EAAKqzB,UAEjE,MAED,KAAK,cAEJ13B,QAAQ4H,KAAM,qEAEf,KAAK,OAEJ,GAAIoQ,GAAW67G,EAAaxvH,EAAK2T,UAC7BC,EAAW67G,EAAazvH,EAAK4T,SAIhCkI,GAFInI,EAAS8Z,OAAS9Z,EAAS8Z,MAAM/xB,OAAS,EAErC,GAAI4sD,IAAa30C,EAAUC,GAI3B,GAAIF,GAAMC,EAAUC,EAI9B,MAED,KAAK,MAEJkI,EAAS,GAAIisC,GAEb,MAED,KAAK,OAEJjsC,EAAS,GAAIitC,IAAMymE,EAAaxvH,EAAK2T,UAAY87G,EAAazvH,EAAK4T,UAAY5T,EAAKyW,KAEpF,MAED,KAAK,WAEJqF,EAAS,GAAImtC,IAAUumE,EAAaxvH,EAAK2T,UAAY87G,EAAazvH,EAAK4T,UAEvE,MAED,KAAK,eAEJkI,EAAS,GAAIktC,IAAcwmE,EAAaxvH,EAAK2T,UAAY87G,EAAazvH,EAAK4T,UAE3E,MAED,KAAK,aACL,IAAK,SAEJkI,EAAS,GAAIotC,IAAQsmE,EAAaxvH,EAAK2T,UAAY87G,EAAazvH,EAAK4T,UAErE,MAED,KAAK,SAEJkI,EAAS,GAAI+rC,IAAQ4nE,EAAazvH,EAAK4T,UAEvC,MAED,KAAK,QAEJkI,EAAS,GAAIw1B,GAEb,MAED,SAECx1B,EAAS,GAAItW,GA0Cf,GAtCAsW,EAAOxe,KAAO0C,EAAK1C,KAEAlB,SAAd4D,EAAKvC,OAAqBqe,EAAOre,KAAOuC,EAAKvC,MAE7BrB,SAAhB4D,EAAKzB,QAETud,EAAOvd,OAAOi1C,UAAWxzC,EAAKzB,QAECnC,SAA1B4D,EAAK1B,mBAAiCwd,EAAOxd,iBAAmB0B,EAAK1B,kBACrEwd,EAAOxd,kBAAmBwd,EAAOvd,OAAOq1C,UAAW93B,EAAO1V,SAAU0V,EAAOpW,WAAYoW,EAAOzV,SAI5EjK,SAAlB4D,EAAKoG,UAAyB0V,EAAO1V,SAASotC,UAAWxzC,EAAKoG,UAC5ChK,SAAlB4D,EAAK3B,UAAyByd,EAAOzd,SAASm1C,UAAWxzC,EAAK3B,UAC1CjC,SAApB4D,EAAK0F,YAA2BoW,EAAOpW,WAAW8tC,UAAWxzC,EAAK0F,YACnDtJ,SAAf4D,EAAKqG,OAAsByV,EAAOzV,MAAMmtC,UAAWxzC,EAAKqG,QAIrCjK,SAApB4D,EAAKgH,aAA2B8U,EAAO9U,WAAahH,EAAKgH,YAClC5K,SAAvB4D,EAAKiH,gBAA8B6U,EAAO7U,cAAgBjH,EAAKiH,eAE/DjH,EAAKgyB,SAEiB51B,SAArB4D,EAAKgyB,OAAO6B,OAAqB/X,EAAOkW,OAAO6B,KAAO7zB,EAAKgyB,OAAO6B,MAC3Cz3B,SAAvB4D,EAAKgyB,OAAOzxB,SAAuBub,EAAOkW,OAAOzxB,OAASP,EAAKgyB,OAAOzxB,QAC9CnE,SAAxB4D,EAAKgyB,OAAO8B,SAAwBhY,EAAOkW,OAAO8B,QAAQ0f,UAAWxzC,EAAKgyB,OAAO8B,SAC1D13B,SAAvB4D,EAAKgyB,OAAOxd,SAAuBsH,EAAOkW,OAAOxd,OAASlZ,KAAKuzH,YAAa7uH,EAAKgyB,OAAOxd,UAIxEpY,SAAjB4D,EAAK+G,UAAwB+U,EAAO/U,QAAU/G,EAAK+G,SAC5B3K,SAAvB4D,EAAKkH,gBAA8B4U,EAAO5U,cAAgBlH,EAAKkH,eAC1C9K,SAArB4D,EAAKmH,cAA4B2U,EAAO3U,YAAcnH,EAAKmH,aACzC/K,SAAlB4D,EAAKoH,WAAyB0U,EAAO1U,SAAWpH,EAAKoH,UACrChL,SAAhB4D,EAAK8G,SAAuBgV,EAAOhV,OAAOvB,KAAOvF,EAAK8G,QAEpC1K,SAAlB4D,EAAKgG,SAIT,IAAM,GAFFA,GAAWhG,EAAKgG,SAEVsF,EAAI,EAAGA,EAAItF,EAAStK,OAAQ4P,IAErCwQ,EAAO6e,IAAKr/B,KAAKuzH,YAAa7oH,EAAUsF,GAAKmQ,EAAY67D,GAM3D,IAAmB,QAAdt3E,EAAKjD,KAIT,IAAM,GAFFirD,GAAShoD,EAAKgoD,OAERz8C,EAAI,EAAGA,EAAIy8C,EAAOtsD,OAAQ6P,IAAO,CAE1C,GAAI07C,GAAQe,EAAQz8C,GAChBs8F,EAAQ/rF,EAAO6rF,oBAAqB,OAAQ1gD,EAAMnrC,OAEvC1f,UAAVyrG,GAEJ/rF,EAAO67F,SAAU9P,EAAO5gD,EAAM70B,UAQjC,MAAOtW,KAMT,IAAIuzG,KACHn0C,UAAWA,GACXn8D,sBAAuBA,GACvBmK,sBAAuBA,GACvBG,iCAAkCA,GAClCC,iCAAkCA,GAClCC,2BAA4BA,GAC5BJ,wBAAyBA,GACzBC,wBAAyBA,IAGtBkmG,IACHnjF,eAAgBA,GAChBtuC,oBAAqBA,GACrBwuC,uBAAwBA,IAGrBkjF,IACHtvH,cAAeA,GACf2mC,2BAA4BA,GAC5BC,0BAA2BA,GAC3B/oC,aAAcA,GACd2uC,0BAA2BA,GAC3B1uC,yBAA0BA,GA2B3B2qE,IAAkBqG,WAEjBlJ,YAAa6C,GAEbgnD,WAAY,SAAqBvwH,GAIhC,MAFA7D,MAAK6D,QAAUA,EAER7D,MAIRigH,KAAM,SAAWt7C,EAAKT,EAAQC,EAAYC,GAE5BtjE,SAAR6jE,IAAoBA,EAAM,IAEZ7jE,SAAdd,KAAKooB,OAAqBu8C,EAAM3kE,KAAKooB,KAAOu8C,GAEjDA,EAAM3kE,KAAKklE,QAAQJ,WAAYH,EAE/B,IAAInyD,GAAQxS,KAERkgH,EAASL,GAAMx2G,IAAKs7D,EAExB,OAAgB7jE,UAAXo/G,GAEJ1tG,EAAM0yD,QAAQR,UAAWC,GAEzBw7C,WAAY,WAENj8C,GAASA,EAAQg8C,GAEtB1tG,EAAM0yD,QAAQN,QAASD,IAErB,GAEIu7C,OAIR5yC,OAAO3I,GAAMjoB,KAAM,SAAW23E,GAE7B,MAAOA,GAAIC,SAER53E,KAAM,SAAW43E,GAEpB,MAAOjnD,mBAAmBinD,EAAM9hH,EAAM3O,WAEnC64C,KAAM,SAAW63E,GAEpB1U,GAAMxgF,IAAKslC,EAAK4vD,GAEXrwD,GAASA,EAAQqwD,GAEtB/hH,EAAM0yD,QAAQN,QAASD,KAdxB2I,SAgBW,SAAWjf,GAEhB+V,GAAUA,EAAS/V,GAExB77C,EAAM0yD,QAAQN,QAASD,GACvBnyD,EAAM0yD,QAAQL,UAAWF,MAM3Bg+C,eAAgB,WAEf,MAAO3iH,OAIR2hH,QAAS,SAAW7/G,GAGnB,MADA9B,MAAKooB,KAAOtmB,EACL9B,OAsBT4B,OAAO48E,OAAQjR,GAAUkG,WAExBpE,OAAQ,SAAWvvE,EAAGC,GAErBC,KAAKytE,YAAc,GAAIvE,IACvBlpE,KAAKwtE,SAASp7D,KAAMpS,KAAKytE,aACzBztE,KAAKytE,YAAY4B,OAAQvvE,EAAGC,IAI7BuvE,OAAQ,SAAWxvE,EAAGC,GAErBC,KAAKytE,YAAY6B,OAAQxvE,EAAGC,IAI7BwvE,iBAAkB,SAAW22C,EAAMC,EAAMtgD,EAAIC,GAE5C9lE,KAAKytE,YAAY8B,iBAAkB22C,EAAMC,EAAMtgD,EAAIC,IAIpD0J,cAAe,SAAW42C,EAAOC,EAAOC,EAAOC,EAAO1gD,EAAIC,GAEzD9lE,KAAKytE,YAAY+B,cAAe42C,EAAOC,EAAOC,EAAOC,EAAO1gD,EAAIC,IAIjE0gD,WAAY,SAAWjI,GAEtBv+G,KAAKytE,YAAY+4C,WAAYjI,IAI9BiW,SAAU,SAAWC,EAAOC,GAE3B,QAASC,GAAiBC,GAIzB,IAAM,GAFF56D,MAEMhqD,EAAI,EAAGC,EAAI2kH,EAAWx0H,OAAQ4P,EAAIC,EAAGD,IAAO,CAErD,GAAI6kH,GAAUD,EAAY5kH,GAEtB8kH,EAAW,GAAIzrD,GACnByrD,GAAS9rD,OAAS6rD,EAAQ7rD,OAE1BhP,EAAO5nD,KAAM0iH,GAId,MAAO96D,GAIR,QAAS+6D,GAAsBv6D,EAAMw6D,GASpC,IAAM,GAPFC,GAAUD,EAAU50H,OAMpBi5D,GAAS,EACHlkC,EAAI8/F,EAAU,EAAGrhE,EAAI,EAAGA,EAAIqhE,EAAS9/F,EAAIy+B,IAAO,CAEzD,GAAIshE,GAAYF,EAAW7/F,GACvBggG,EAAaH,EAAWphE,GAExBwhE,EAASD,EAAWr1H,EAAIo1H,EAAUp1H,EAClCu1H,EAASF,EAAWp1H,EAAIm1H,EAAUn1H,CAEtC,IAAK4S,KAAK4P,IAAK8yG,GAAWj6D,OAAOC,QAAU,CAS1C,GANKg6D,EAAS,IAEbH,EAAYF,EAAWphE,GAAKwhE,GAAWA,EACvCD,EAAaH,EAAW7/F,GAAKkgG,GAAWA,GAGlC76D,EAAKz6D,EAAIm1H,EAAUn1H,GAASy6D,EAAKz6D,EAAIo1H,EAAWp1H,EAAQ,QAE/D,IAAKy6D,EAAKz6D,IAAMm1H,EAAUn1H,GAEzB,GAAKy6D,EAAK16D,IAAMo1H,EAAUp1H,EAAK,OAAO,MAGhC,CAEN,GAAIw1H,GAAWD,GAAW76D,EAAK16D,EAAIo1H,EAAUp1H,GAAMs1H,GAAW56D,EAAKz6D,EAAIm1H,EAAUn1H,EACjF,IAAkB,IAAbu1H,EAAoB,OAAO,CAChC,IAAKA,EAAW,EAAQ,QACxBj8D,IAAWA,OAIN,CAGN,GAAKmB,EAAKz6D,IAAMm1H,EAAUn1H,EAAM,QAEhC,IAASo1H,EAAWr1H,GAAK06D,EAAK16D,GAAS06D,EAAK16D,GAAKo1H,EAAUp1H,GACrDo1H,EAAUp1H,GAAK06D,EAAK16D,GAAS06D,EAAK16D,GAAKq1H,EAAWr1H,EAAS,OAAO,GAO1E,MAAOu5D,GAIR,GAAIwF,GAAcD,GAAWC,YAEzB2O,EAAWxtE,KAAKwtE,QACpB,IAAyB,IAApBA,EAASptE,OAAe,QAE7B,IAAKs0H,KAAY,EAAO,MAAOC,GAAiBnnD,EAGhD,IAAI+nD,GAAOV,EAASC,EAAU96D,IAE9B,IAAyB,IAApBwT,EAASptE,OAMb,MAJAy0H,GAAUrnD,EAAU,GACpBsnD,EAAW,GAAIzrD,IACfyrD,EAAS9rD,OAAS6rD,EAAQ7rD,OAC1BhP,EAAO5nD,KAAM0iH,GACN96D,CAIR,IAAIw7D,IAAe32D,EAAa2O,EAAU,GAAI01C,YAC9CsS,GAAaf,GAAUe,EAAaA,CAIpC,IAIIC,GAJAC,KACAC,KACAC,KACAC,EAAU,CAGdF,GAAWE,GAAY/0H,OACvB80H,EAAeC,KAEf,KAAM,GAAI7lH,GAAI,EAAGC,EAAIu9D,EAASptE,OAAQ4P,EAAIC,EAAGD,IAE5C6kH,EAAUrnD,EAAUx9D,GACpBylH,EAAYZ,EAAQ3R,YACpBqS,EAAQ12D,EAAa42D,GACrBF,EAAQd,GAAUc,EAAQA,EAErBA,IAEKC,GAAkBG,EAAWE,IAAcA,IAEpDF,EAAWE,IAAc94D,EAAG,GAAIsM,IAASl0C,EAAGsgG,GAC5CE,EAAWE,GAAU94D,EAAEiM,OAAS6rD,EAAQ7rD,OAEnCwsD,GAAaK,IAClBD,EAAeC,OAMfD,EAAeC,GAAUzjH,MAAQuqD,EAAGk4D,EAAS1/F,EAAGsgG,EAAW,IAS7D,KAAOE,EAAW,GAAM,MAAOhB,GAAiBnnD,EAGhD,IAAKmoD,EAAUv1H,OAAS,EAAI,CAK3B,IAAM,GAHF01H,IAAY,EACZC,KAEMC,EAAO,EAAGC,EAAON,EAAUv1H,OAAQ41H,EAAOC,EAAMD,IAEzDN,EAAkBM,KAInB,KAAM,GAAIA,GAAO,EAAGC,EAAON,EAAUv1H,OAAQ41H,EAAOC,EAAMD,IAIzD,IAAM,GAFFE,GAAMN,EAAeI,GAEfG,EAAO,EAAGA,EAAOD,EAAI91H,OAAQ+1H,IAAU,CAKhD,IAAM,GAHFC,GAAKF,EAAKC,GACVE,GAAkB,EAEZC,EAAQ,EAAGA,EAAQX,EAAUv1H,OAAQk2H,IAEzCvB,EAAsBqB,EAAGjhG,EAAGwgG,EAAWW,GAAQnhG,KAE9C6gG,IAASM,GAAQP,EAAS3jH,MAAQmkH,MAAOP,EAAMQ,IAAKF,EAAO5+D,KAAMy+D,IACjEE,GAEJA,GAAkB,EAClBX,EAAkBY,GAAQlkH,KAAMgkH,IAIhCN,GAAY,EAOVO,IAEJX,EAAkBM,GAAO5jH,KAAMgkH,GAQ7BL,EAAS31H,OAAS,IAGf01H,IAAYF,EAAgBF,IAQrC,IAAM,GAFFe,GAEMzmH,EAAI,EAAGyuB,EAAKk3F,EAAUv1H,OAAQ4P,EAAIyuB,EAAIzuB,IAAO,CAEtD8kH,EAAWa,EAAW3lH,GAAI+sD,EAC1B/C,EAAO5nD,KAAM0iH,GACb2B,EAAWb,EAAe5lH,EAE1B,KAAM,GAAIy9B,GAAI,EAAGC,EAAK+oF,EAASr2H,OAAQqtC,EAAIC,EAAID,IAE9CqnF,EAASj4D,MAAMzqD,KAAMqkH,EAAUhpF,GAAIkvB,GAQrC,MAAO3C,MAoBTp4D,OAAO48E,OAAQ9Q,GAAK+F,WAEnB9T,QAAQ,EAERC,eAAgB,SAAWJ,EAAMv4C,GAElBnmB,SAATmmB,IAAqBA,EAAO,IAKjC,KAAM,GAHF+yC,MACAoU,EAAQT,GAAanO,EAAMv4C,EAAMjnB,KAAK0E,MAEhCywB,EAAI,EAAGC,EAAKg5C,EAAMhuE,OAAQ+0B,EAAIC,EAAID,IAE3C/nB,MAAMqmE,UAAUrhE,KAAKq2B,MAAOuxB,EAAQoU,EAAOj5C,GAAIq/F,WAIhD,OAAOx6D,MAyHTp4D,OAAO48E,OAAQ9O,GAAW+D,WAEzBwsC,KAAM,SAAWt7C,EAAKT,EAAQC,EAAYC,GAEzC,GAAI5xD,GAAQxS,KAERgiH,EAAS,GAAI/8C,IAAYjlE,KAAKklE,QAClC88C,GAAOL,QAAS3hH,KAAKooB,MACrB45F,EAAO/B,KAAMt7C,EAAK,SAAWnF,GAE5B,GAAIiN,EAEJ,KAECA,EAAO0gC,KAAKvgC,MAAOpN,GAElB,MAAQnR,GAEThuD,QAAQ4H,KAAM,yFACdwkE,EAAO0gC,KAAKvgC,MAAOpN,EAAKyzD,UAAW,GAAIzzD,EAAKp/D,OAAS,IAItD,GAAIs/D,GAAOltD,EAAMo6D,MAAOH,EAEnBvI,IAASA,EAAQxE,IAEpByE,EAAYC,IAIhBwI,MAAO,SAAWH,GAEjB,MAAO,IAAIiB,IAAMjB,IAIlBk1C,QAAS,SAAW7/G,GAGnB,MADA9B,MAAKooB,KAAOtmB,EACL9B,OAUT,IAAIyG,IAEA8pE,IAEH7mC,WAAY,WAQX,MANiB5oC,UAAZ2F,KAEJA,GAAU,IAAMsyC,OAAOw3B,cAAgBx3B,OAAO29E,qBAIxCjwH,IAIRM,WAAY,SAAWjF,GAEtB2E,GAAU3E,GAgBZF,QAAO48E,OAAQ7O,GAAY8D,WAE1BwsC,KAAM,SAAWt7C,EAAKT,EAAQC,EAAYC,GAEzC,GAAI49C,GAAS,GAAI/8C,IAAYjlE,KAAKklE,QAClC88C,GAAOJ,gBAAiB,eACxBI,EAAO/B,KAAMt7C,EAAK,SAAWj9D,GAI5B,GAAIivH,GAAajvH,EAAOmlD,MAAO,GAE3BpmD,EAAU8pE,GAAa7mC,YAC3BjjC,GAAQmwH,gBAAiBD,EAAY,SAAWE,GAE/C3yD,EAAQ2yD,MAIP1yD,EAAYC,MA4BjBxiE,OAAO48E,OAAQ5O,GAAa6D,WAE3B/pE,OAAQ,WAEP,GAAIotH,GAAU1gF,EAAOF,EAAKC,EAAQ3pC,EAAMC,EAAKC,EAAMmjE,EAE/CknD,EAAW,GAAI92H,GACf+2H,EAAU,GAAI/2H,EAElB,OAAO,UAAiBiZ,GAEvB,GAAIvD,GAAcmhH,IAAa92H,MAAQo2C,IAAUl9B,EAAOk9B,OAASF,IAAQh9B,EAAOg9B,KACvEC,IAAWj9B,EAAOi9B,OAASn2C,KAAKm2C,QAAU3pC,IAAS0M,EAAO1M,MAC1DC,IAAQyM,EAAOzM,KAAOC,IAASwM,EAAOxM,MAAQmjE,IAAW7vE,KAAK6vE,MAEvE,IAAKl6D,EAAc,CAElBmhH,EAAW92H,KACXo2C,EAAQl9B,EAAOk9B,MACfF,EAAMh9B,EAAOg9B,IACbC,EAASj9B,EAAOi9B,OAASn2C,KAAKm2C,OAC9B3pC,EAAO0M,EAAO1M,KACdC,EAAMyM,EAAOzM,IACbC,EAAOwM,EAAOxM,IAKd,IAAIT,GAAmBiN,EAAOjN,iBAAiBpB,OAC/CglE,GAAS7vE,KAAK6vE,OAAS,CACvB,IAEIonD,GAAMC,EAFNC,EAAqBtnD,EAASrjE,EAAO4pC,EACrCghF,EAAS5qH,EAAOmG,KAAKqlD,IAAK/1D,GAAMkgE,QAAUjsB,EAAM,IAAUxpC,CAK9DsqH,GAAQ92H,SAAU,KAAS2vE,EAC3BknD,EAAS72H,SAAU,IAAO2vE,EAI1BonD,GAASG,EAAOjhF,EAASghF,EACzBD,EAAOE,EAAOjhF,EAASghF,EAEvBlrH,EAAiB/L,SAAU,GAAM,EAAIsM,GAAS0qH,EAAOD,GACrDhrH,EAAiB/L,SAAU,IAAQg3H,EAAOD,IAAWC,EAAOD,GAE5Dj3H,KAAKm5C,QAAQltC,iBAAiB2S,KAAM3S,GAIpCgrH,GAASG,EAAOjhF,EAASghF,EACzBD,EAAOE,EAAOjhF,EAASghF,EAEvBlrH,EAAiB/L,SAAU,GAAM,EAAIsM,GAAS0qH,EAAOD,GACrDhrH,EAAiB/L,SAAU,IAAQg3H,EAAOD,IAAWC,EAAOD,GAE5Dj3H,KAAKq5C,QAAQptC,iBAAiB2S,KAAM3S,GAIrCjM,KAAKm5C,QAAQ9tC,YAAYuT,KAAM1F,EAAO7N,aAAc6zB,SAAU83F,GAC9Dh3H,KAAKq5C,QAAQhuC,YAAYuT,KAAM1F,EAAO7N,aAAc6zB,SAAU63F,SA8GjEjnD,GAAW2D,UAAY7xE,OAAOqvF,OAAQ/mF,EAASupE,WAC/C3D,GAAW2D,UAAUlJ,YAAcuF,GAqBnCQ,GAAcmD,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQ/mF,EAASupE,YAEhElJ,YAAa+F,GAEbQ,SAAU,WAET,MAAO9wE,MAAKwwE,MAIb6mD,aAAc,WAWb,MATqB,QAAhBr3H,KAAKyrB,SAETzrB,KAAKwwE,KAAK8mD,WAAYt3H,KAAKyrB,QAC3BzrB,KAAKyrB,OAAO6rG,WAAYt3H,KAAKyG,QAAQkqE,aACrC3wE,KAAKwwE,KAAKE,QAAS1wE,KAAKyG,QAAQkqE,aAChC3wE,KAAKyrB,OAAS,MAIRzrB,MAIRu3H,UAAW,WAEV,MAAOv3H,MAAKyrB,QAIb+rG,UAAW,SAAW11H,GAiBrB,MAfqB,QAAhB9B,KAAKyrB,QAETzrB,KAAKwwE,KAAK8mD,WAAYt3H,KAAKyrB,QAC3BzrB,KAAKyrB,OAAO6rG,WAAYt3H,KAAKyG,QAAQkqE,cAIrC3wE,KAAKwwE,KAAK8mD,WAAYt3H,KAAKyG,QAAQkqE,aAIpC3wE,KAAKyrB,OAAS3pB,EACd9B,KAAKwwE,KAAKE,QAAS1wE,KAAKyrB,QACxBzrB,KAAKyrB,OAAOilD,QAAS1wE,KAAKyG,QAAQkqE,aAE3B3wE,MAIRy3H,gBAAiB,WAEhB,MAAOz3H,MAAKwwE,KAAKA,KAAK1uE,OAIvB41H,gBAAiB,SAAW51H,GAI3B,MAFA9B,MAAKwwE,KAAKA,KAAKmnD,gBAAiB71H,EAAO9B,KAAKyG,QAAQmxH,YAAa,KAE1D53H,MAIRi/B,kBAAmB,WAElB,GAAIn0B,GAAW,GAAI/J,GACfqJ,EAAa,GAAI7J,GACjBwK,EAAQ,GAAIhK,GAEZo3C,EAAc,GAAIp3C,EAEtB,OAAO,UAA4B+rG,GAElC5iG,EAASupE,UAAUx0C,kBAAkB36B,KAAMtE,KAAM8sG,EAEjD,IAAIj8B,GAAW7wE,KAAKyG,QAAQoqE,SACxBlmE,EAAK3K,KAAK2K,EAEd3K,MAAKqL,YAAYitC,UAAWxtC,EAAUV,EAAYW,GAElDotC,EAAYlyC,IAAK,EAAG,MAASm0C,gBAAiBhwC,GAEzCymE,EAASgnD,WAEbhnD,EAASgnD,UAAUC,eAAgBhtH,EAAShL,EAAGE,KAAKyG,QAAQmxH,aAC5D/mD,EAASknD,UAAUD,eAAgBhtH,EAAS/K,EAAGC,KAAKyG,QAAQmxH,aAC5D/mD,EAASmnD,UAAUF,eAAgBhtH,EAAStK,EAAGR,KAAKyG,QAAQmxH,aAC5D/mD,EAASonD,SAASH,eAAgB3/E,EAAYr4C,EAAGE,KAAKyG,QAAQmxH,aAC9D/mD,EAASqnD,SAASJ,eAAgB3/E,EAAYp4C,EAAGC,KAAKyG,QAAQmxH,aAC9D/mD,EAASsnD,SAASL,eAAgB3/E,EAAY33C,EAAGR,KAAKyG,QAAQmxH,aAC9D/mD,EAASunD,IAAIN,eAAgBntH,EAAG7K,EAAGE,KAAKyG,QAAQmxH,aAChD/mD,EAASwnD,IAAIP,eAAgBntH,EAAG5K,EAAGC,KAAKyG,QAAQmxH,aAChD/mD,EAASynD,IAAIR,eAAgBntH,EAAGnK,EAAGR,KAAKyG,QAAQmxH,eAIhD/mD,EAASkY,YAAaj+E,EAAShL,EAAGgL,EAAS/K,EAAG+K,EAAStK,GACvDqwE,EAAS0nD,eAAgBpgF,EAAYr4C,EAAGq4C,EAAYp4C,EAAGo4C,EAAY33C,EAAGmK,EAAG7K,EAAG6K,EAAG5K,EAAG4K,EAAGnK,UAyCzFowE,GAAM6C,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQ/mF,EAASupE,YAExDlJ,YAAaqG,GAEboB,UAAW,WAEV,MAAOhyE,MAAKwwE,MAIbgoD,cAAe,SAAWC,GAOzB,MALAz4H,MAAKoxE,oBAAqB,EAC1BpxE,KAAKqxE,WAAa,YAClBrxE,KAAK0+E,OAAS+5C,EACdz4H,KAAK0wE,UAEE1wE,MAIR04H,sBAAuB,SAAWC,GAOjC,MALA34H,MAAKoxE,oBAAqB,EAC1BpxE,KAAKqxE,WAAa,YAClBrxE,KAAK0+E,OAAS1+E,KAAKyG,QAAQmyH,yBAA0BD,GACrD34H,KAAK0wE,UAEE1wE,MAIR64H,UAAW,SAAWhC,GAOrB,MALA72H,MAAK0H,OAASmvH,EACd72H,KAAKqxE,WAAa,SAEbrxE,KAAK+wE,UAAW/wE,KAAK84H,OAEnB94H,MAIR84H,KAAM,WAEL,GAAK94H,KAAKmxE,aAAc,EAGvB,WADA9wE,SAAQ4H,KAAM,yCAKf,IAAKjI,KAAKoxE,sBAAuB,EAGhC,WADA/wE,SAAQ4H,KAAM,mDAKf,IAAIy2E,GAAS1+E,KAAKyG,QAAQsyH,oBAa1B,OAXAr6C,GAAOh3E,OAAS1H,KAAK0H,OACrBg3E,EAAO1N,KAAOhxE,KAAKgxE,KACnB0N,EAAOs6C,QAAUh5H,KAAKi5H,QAAQ5rE,KAAMrtD,MACpC0+E,EAAOxN,aAAa4mD,eAAgB93H,KAAKkxE,aAAclxE,KAAKixE,WAC5DjxE,KAAKixE,UAAYjxE,KAAKyG,QAAQmxH,YAC9Bl5C,EAAO/3E,MAAO3G,KAAKixE,UAAWjxE,KAAK4C,QAEnC5C,KAAKmxE,WAAY,EAEjBnxE,KAAK0+E,OAASA,EAEP1+E,KAAK0wE,WAIbwoD,MAAO,WAEN,MAAKl5H,MAAKoxE,sBAAuB,MAEhC/wE,SAAQ4H,KAAM,qDAKVjI,KAAKmxE,aAAc,IAEvBnxE,KAAK0+E,OAAO93E,OACZ5G,KAAK0+E,OAAOs6C,QAAU,KACtBh5H,KAAK4C,SAAY5C,KAAKyG,QAAQmxH,YAAc53H,KAAKixE,WAAcjxE,KAAKkxE,aACpElxE,KAAKmxE,WAAY,GAIXnxE,OAIR4G,KAAM,WAEL,MAAK5G,MAAKoxE,sBAAuB,MAEhC/wE,SAAQ4H,KAAM,qDAKfjI,KAAK0+E,OAAO93E,OACZ5G,KAAK0+E,OAAOs6C,QAAU,KACtBh5H,KAAK4C,OAAS,EACd5C,KAAKmxE,WAAY,EAEVnxE,OAIR0wE,QAAS,WAER,GAAK1wE,KAAKsxE,QAAQlxE,OAAS,EAAI,CAE9BJ,KAAK0+E,OAAOhO,QAAS1wE,KAAKsxE,QAAS,GAEnC,KAAM,GAAIthE,GAAI,EAAGC,EAAIjQ,KAAKsxE,QAAQlxE,OAAQ4P,EAAIC,EAAGD,IAEhDhQ,KAAKsxE,QAASthE,EAAI,GAAI0gE,QAAS1wE,KAAKsxE,QAASthE,GAI9ChQ,MAAKsxE,QAAStxE,KAAKsxE,QAAQlxE,OAAS,GAAIswE,QAAS1wE,KAAKgyE,iBAItDhyE,MAAK0+E,OAAOhO,QAAS1wE,KAAKgyE,YAI3B,OAAOhyE,OAIRs3H,WAAY,WAEX,GAAKt3H,KAAKsxE,QAAQlxE,OAAS,EAAI,CAE9BJ,KAAK0+E,OAAO44C,WAAYt3H,KAAKsxE,QAAS,GAEtC,KAAM,GAAIthE,GAAI,EAAGC,EAAIjQ,KAAKsxE,QAAQlxE,OAAQ4P,EAAIC,EAAGD,IAEhDhQ,KAAKsxE,QAASthE,EAAI,GAAIsnH,WAAYt3H,KAAKsxE,QAASthE,GAIjDhQ,MAAKsxE,QAAStxE,KAAKsxE,QAAQlxE,OAAS,GAAIk3H,WAAYt3H,KAAKgyE,iBAIzDhyE,MAAK0+E,OAAO44C,WAAYt3H,KAAKgyE,YAI9B,OAAOhyE,OAIRm5H,WAAY,WAEX,MAAOn5H,MAAKsxE,SAIb8nD,WAAY,SAAWt3H,GAgBtB,MAdOA,KAAQA,MAEV9B,KAAKmxE,aAAc,GAEvBnxE,KAAKs3H,aACLt3H,KAAKsxE,QAAUxvE,EACf9B,KAAK0wE,WAIL1wE,KAAKsxE,QAAUxvE,EAIT9B,MAIRu3H,UAAW,WAEV,MAAOv3H,MAAKm5H,aAAc,IAI3B3B,UAAW,SAAW/rG,GAErB,MAAOzrB,MAAKo5H,WAAY3tG,GAAWA,QAIpC4tG,gBAAiB,SAAWv3H,GAE3B,MAAK9B,MAAKoxE,sBAAuB,MAEhC/wE,SAAQ4H,KAAM,qDAKfjI,KAAKkxE,aAAepvE,EAEf9B,KAAKmxE,aAAc,GAEvBnxE,KAAK0+E,OAAOxN,aAAa4mD,eAAgB93H,KAAKkxE,aAAclxE,KAAKyG,QAAQmxH,aAInE53H,OAIRs5H,gBAAiB,WAEhB,MAAOt5H,MAAKkxE,cAIb+nD,QAAS,WAERj5H,KAAKmxE,WAAY,GAIlBooD,QAAS,WAER,MAAKv5H,MAAKoxE,sBAAuB,GAEhC/wE,QAAQ4H,KAAM,qDACP,GAIDjI,KAAKgxE,MAIbwoD,QAAS,SAAW13H,GAEnB,MAAK9B,MAAKoxE,sBAAuB,MAEhC/wE,SAAQ4H,KAAM,qDAKfjI,KAAKgxE,KAAOlvE,EAEP9B,KAAKmxE,aAAc,IAEvBnxE,KAAK0+E,OAAO1N,KAAOhxE,KAAKgxE,MAIlBhxE,OAIRy5H,UAAW,WAEV,MAAOz5H,MAAKwwE,KAAKA,KAAK1uE,OAIvB43H,UAAW,SAAW53H,GAIrB,MAFA9B,MAAKwwE,KAAKA,KAAKmnD,gBAAiB71H,EAAO9B,KAAKyG,QAAQmxH,YAAa,KAE1D53H,QAmBTuxE,GAAgBkC,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQrgB,GAAM6C,YAE/DlJ,YAAagH,GAEbS,UAAW,WAEV,MAAOhyE,MAAKwxE,QAIbmoD,eAAgB,WAEf,MAAO35H,MAAKwxE,OAAOooD,aAIpBC,eAAgB,SAAW/3H,GAI1B,MAFA9B,MAAKwxE,OAAOooD,YAAc93H,EAEnB9B,MAIR85H,iBAAkB,WAEjB,MAAO95H,MAAKwxE,OAAOuoD,eAIpBC,iBAAkB,SAAWl4H,GAI5B,MAFA9B,MAAKwxE,OAAOuoD,cAAgBj4H,EAErB9B,MAIRi6H,iBAAkB,WAEjB,MAAOj6H,MAAKwxE,OAAO0oD,eAIpBC,iBAAkB,SAAWr4H,GAI5B,MAFA9B,MAAKwxE,OAAO0oD,cAAgBp4H,EAErB9B,MAIRo6H,eAAgB,WAEf,MAAOp6H,MAAKwxE,OAAO6oD,aAIpBC,eAAgB,SAAWx4H,GAI1B,MAFA9B,MAAKwxE,OAAO6oD,YAAcv4H,EAEnB9B,MAIRu6H,mBAAoB,SAAWC,EAAgBC,EAAgBC,GAM9D,MAJA16H,MAAKwxE,OAAOgpD,eAAiBA,EAC7Bx6H,KAAKwxE,OAAOipD,eAAiBA,EAC7Bz6H,KAAKwxE,OAAOkpD,cAAgBA,EAErB16H,MAIRi/B,kBAAmB,WAElB,GAAIn0B,GAAW,GAAI/J,GACfqJ,EAAa,GAAI7J,GACjBwK,EAAQ,GAAIhK,GAEZo3C,EAAc,GAAIp3C,EAEtB,OAAO,UAA4B+rG,GAElC5iG,EAASupE,UAAUx0C,kBAAkB36B,KAAMtE,KAAM8sG,EAEjD,IAAIt7B,GAASxxE,KAAKwxE,MAClBxxE,MAAKqL,YAAYitC,UAAWxtC,EAAUV,EAAYW,GAElDotC,EAAYlyC,IAAK,EAAG,EAAG,GAAIm0C,gBAAiBhwC,GAE5ConE,EAAOuX,YAAaj+E,EAAShL,EAAGgL,EAAS/K,EAAG+K,EAAStK,GACrDgxE,EAAO+mD,eAAgBpgF,EAAYr4C,EAAGq4C,EAAYp4C,EAAGo4C,EAAY33C,SAwBpEoB,OAAO48E,OAAQ9M,GAAc+B,WAE5BknD,iBAAkB,WAIjB,MAFA36H,MAAK6xE,SAAS+oD,qBAAsB56H,KAAK0E,MAElC1E,KAAK0E,MAIbm2H,oBAAqB,WAIpB,IAAM,GAFF/4H,GAAQ,EAAG4C,EAAO1E,KAAK26H,mBAEjB3qH,EAAI,EAAGA,EAAItL,EAAKtE,OAAQ4P,IAEjClO,GAAS4C,EAAMsL,EAIhB,OAAOlO,GAAQ4C,EAAKtE,UA8DtBwB,OAAO48E,OAAQvM,GAAcwB,WAG5BqnD,WAAY,SAAWC,EAAWhlD,GAKjC,GAAIruE,GAAS1H,KAAK0H,OACjBk3C,EAAS5+C,KAAKwqE,UACd5nE,EAASm4H,EAAYn8E,EAASA,EAE9Bo8E,EAAgBh7H,KAAKwyE,gBAEtB,IAAuB,IAAlBwoD,EAAsB,CAI1B,IAAM,GAAIhrH,GAAI,EAAGA,IAAM4uC,IAAW5uC,EAEjCtI,EAAQ9E,EAASoN,GAAMtI,EAAQsI,EAIhCgrH,GAAgBjlD,MAEV,CAINilD,GAAiBjlD,CACjB,IAAIklD,GAAMllD,EAASilD,CACnBh7H,MAAKuyE,iBAAkB7qE,EAAQ9E,EAAQ,EAAGq4H,EAAKr8E,GAIhD5+C,KAAKwyE,iBAAmBwoD,GAKzBvyF,MAAO,SAAWsyF,GAEjB,GAAIn8E,GAAS5+C,KAAKwqE,UACjB9iE,EAAS1H,KAAK0H,OACd9E,EAASm4H,EAAYn8E,EAASA,EAE9Bm3B,EAAS/1E,KAAKwyE,iBAEdN,EAAUlyE,KAAKkyE,OAIhB,IAFAlyE,KAAKwyE,iBAAmB,EAEnBuD,EAAS,EAAI,CAIjB,GAAImlD,GAA+B,EAATt8E,CAE1B5+C,MAAKuyE,iBACJ7qE,EAAQ9E,EAAQs4H,EAAqB,EAAInlD,EAAQn3B,GAInD,IAAM,GAAI5uC,GAAI4uC,EAAQyP,EAAIzP,EAASA,EAAQ5uC,IAAMq+C,IAAMr+C,EAEtD,GAAKtI,EAAQsI,KAAQtI,EAAQsI,EAAI4uC,GAAW,CAI3CszB,EAAQhvD,SAAUxb,EAAQ9E,EAC1B,SASHu4H,kBAAmB,WAElB,GAAIjpD,GAAUlyE,KAAKkyE,QAEfxqE,EAAS1H,KAAK0H,OACjBk3C,EAAS5+C,KAAKwqE,UAEd0wD,EAA+B,EAATt8E,CAEvBszB,GAAQkpD,SAAU1zH,EAAQwzH,EAG1B,KAAM,GAAIlrH,GAAI4uC,EAAQyP,EAAI6sE,EAAqBlrH,IAAMq+C,IAAMr+C,EAE1DtI,EAAQsI,GAAMtI,EAAQwzH,EAAwBlrH,EAAI4uC,EAInD5+C,MAAKwyE,iBAAmB,GAKzB6oD,qBAAsB,WAErB,GAAIH,GAAuC,EAAjBl7H,KAAKwqE,SAC/BxqE,MAAKkyE,QAAQhvD,SAAUljB,KAAK0H,OAAQwzH,IAOrC7oD,QAAS,SAAW3qE,EAAQwW,EAAW0pG,EAAWx1D,EAAGxT,GAEpD,GAAKwT,GAAK,GAET,IAAM,GAAIpiD,GAAI,EAAGA,IAAM4uC,IAAW5uC,EAEjCtI,EAAQwW,EAAYlO,GAAMtI,EAAQkgH,EAAY53G,IAQjDoiE,OAAQ,SAAW1qE,EAAQwW,EAAW0pG,EAAWx1D,GAEhD7xD,EAAWqrF,UAAWlkF,EAAQwW,EAAWxW,EAAQwW,EAAWxW,EAAQkgH,EAAWx1D,IAIhFkgB,MAAO,SAAW5qE,EAAQwW,EAAW0pG,EAAWx1D,EAAGxT,GAIlD,IAAM,GAFFme,GAAI,EAAI3K,EAEFpiD,EAAI,EAAGA,IAAM4uC,IAAW5uC,EAAI,CAErC,GAAIy9B,GAAIvvB,EAAYlO,CAEpBtI,GAAQ+lC,GAAM/lC,EAAQ+lC,GAAMsvB,EAAIr1D,EAAQkgH,EAAY53G,GAAMoiD,KAmB7D,IAAIkpE,IAAoB,eAWxB15H,QAAO48E,OAAQ7L,GAAUc,WAExB2nD,SAAU,SAAW/zH,EAAOzE,GAE3B5C,KAAKqtD,MAEL,IAAIkuE,GAAkBv7H,KAAKizE,aAAaS,gBACvCxB,EAAUlyE,KAAKkzE,UAAWqoD,EAGVz6H,UAAZoxE,GAAwBA,EAAQkpD,SAAU/zH,EAAOzE,IAIvDsgB,SAAU,SAAW7b,EAAOzE,GAI3B,IAAM,GAFF44H,GAAWx7H,KAAKkzE,UAEVljE,EAAIhQ,KAAKizE,aAAaS,gBAC5B1vD,EAAIw3G,EAASp7H,OAAQ4P,IAAMgU,IAAMhU,EAEpCwrH,EAAUxrH,GAAIkT,SAAU7b,EAAOzE,IAMjCyqD,KAAM,WAIL,IAAM,GAFFmuE,GAAWx7H,KAAKkzE,UAEVljE,EAAIhQ,KAAKizE,aAAaS,gBAC5B1vD,EAAIw3G,EAASp7H,OAAQ4P,IAAMgU,IAAMhU,EAEpCwrH,EAAUxrH,GAAIq9C,QAMhBouE,OAAQ,WAIP,IAAM,GAFFD,GAAWx7H,KAAKkzE,UAEVljE,EAAIhQ,KAAKizE,aAAaS,gBAC5B1vD,EAAIw3G,EAASp7H,OAAQ4P,IAAMgU,IAAMhU,EAEpCwrH,EAAUxrH,GAAIyrH,YAoBjB75H,OAAO48E,OAAQzL,IAEdJ,UAAWA,GAEXse,OAAQ,SAAW1a,EAAMnuD,EAAM0qD,GAE9B,MAASyD,IAAQA,EAAKmlD,uBAMd,GAAI3oD,IAAgBJ,UAAW4D,EAAMnuD,EAAM0qD,GAJ3C,GAAIC,IAAiBwD,EAAMnuD,EAAM0qD,IAiB1C6oD,iBAAoB,WAEnB,GAAIC,GAAa,GAAIC,QAAQ,IAAMP,GAAoB,IAAK,IAE5D,OAAO,UAA2Bn5H,GAEjC,MAAOA,GAAK8pB,QAAS,MAAO,KAAMA,QAAS2vG,EAAY,QAMzD5oD,eAAgB,WAKf,GAAI8oD,GAAW,KAAOR,GAAoB,IACtCS,EAAgB,KAAOT,GAAkBrvG,QAAS,MAAO,IAAO,IAIhE+vG,EAAc,kBAAkBt9C,OAAOzyD,QAAS,KAAM6vG,GAGtDG,EAAS,WAAWv9C,OAAOzyD,QAAS,OAAQ8vG,GAI5CG,EAAW,4BAA4Bx9C,OAAOzyD,QAAS,KAAM6vG,GAI7DK,EAAa,uBAAuBz9C,OAAOzyD,QAAS,KAAM6vG,GAE1DM,EAAU,GAAIP,QAAQ,IAEvBG,EACAC,EACAC,EACAC,EACA,KAGCE,GAAyB,WAAY,YAAa,QAEtD,OAAO,UAAyBxP,GAE/B,GAAIyP,GAAUF,EAAQ3zG,KAAMokG,EAE5B,KAAOyP,EAEN,KAAM,IAAIhyG,OAAO,4CAA8CuiG,EAIhE,IAAI0P,IAEHhpD,SAAU+oD,EAAS,GACnBE,WAAYF,EAAS,GACrBG,YAAaH,EAAS,GACtBvP,aAAcuP,EAAS,GACvBI,cAAeJ,EAAS,IAGrBK,EAAUJ,EAAQhpD,UAAYgpD,EAAQhpD,SAASm+C,YAAa,IAEhE,IAAiB5wH,SAAZ67H,GAAyBA,OAAkB,CAE/C,GAAIH,GAAaD,EAAQhpD,SAAS0/C,UAAW0J,EAAU,EAMlDN,GAAqB9mG,QAASinG,UAElCD,EAAQhpD,SAAWgpD,EAAQhpD,SAAS0/C,UAAW,EAAG0J,GAClDJ,EAAQC,WAAaA,GAMvB,GAA8B,OAAzBD,EAAQxP,cAAyD,IAAhCwP,EAAQxP,aAAa3sH,OAE1D,KAAM,IAAIkqB,OAAO,+DAAiEuiG,EAInF,OAAO0P,OAMTjpD,SAAU,SAAWiD,EAAMhD,GAE1B,IAAOA,GAAyB,KAAbA,GAAgC,SAAbA,GAAoC,MAAbA,GAAoBA,QAAoBA,IAAagD,EAAKp0E,MAAQoxE,IAAagD,EAAKv0E,KAEhJ,MAAOu0E,EAKR,IAAKA,EAAKrkD,SAAW,CAEpB,GAAI8mD,GAAOzC,EAAKrkD,SAASwqF,cAAenpC,EAExC,IAAczyE,SAATk4E,EAEJ,MAAOA,GAOT,GAAKzC,EAAK7rE,SAAW,CAEpB,GAAIkyH,GAAoB,SAAWlyH,GAElC,IAAM,GAAIsF,GAAI,EAAGA,EAAItF,EAAStK,OAAQ4P,IAAO,CAE5C,GAAI6sH,GAAYnyH,EAAUsF,EAE1B,IAAK6sH,EAAU16H,OAASoxE,GAAYspD,EAAU76H,OAASuxE,EAEtD,MAAOspD,EAIR,IAAIzhG,GAASwhG,EAAmBC,EAAUnyH,SAE1C,IAAK0wB,EAAS,MAAOA,GAItB,MAAO,OAIJ0hG,EAAcF,EAAmBrmD,EAAK7rE,SAE1C,IAAKoyH,EAEJ,MAAOA,GAMT,MAAO,SAMTl7H,OAAO48E,OAAQzL,GAAgBU,WAG9BspD,sBAAuB,aACvBC,sBAAuB,aAEvBC,aACCC,OAAQ,EACRC,YAAa,EACbC,aAAc,EACdC,eAAgB,GAGjBC,YACCC,KAAM,EACNC,YAAa,EACbC,uBAAwB,GAGzBC,qBAEC,SAA0Bh2H,EAAQ9E,GAEjC8E,EAAQ9E,GAAW5C,KAAKqzE,KAAMrzE,KAAK+sH,eAIpC,SAAyBrlH,EAAQ9E,GAIhC,IAAM,GAFF87E,GAAS1+E,KAAK29H,iBAER3tH,EAAI,EAAGgU,EAAI06D,EAAOt+E,OAAQ4P,IAAMgU,IAAMhU,EAE/CtI,EAAQ9E,KAAc87E,EAAQ1uE,IAMhC,SAAgCtI,EAAQ9E,GAEvC8E,EAAQ9E,GAAW5C,KAAK29H,iBAAkB39H,KAAK08H,gBAIhD,SAA2Bh1H,EAAQ9E,GAElC5C,KAAK29H,iBAAiB7+G,QAASpX,EAAQ9E,KAMzCg7H,mCAKE,SAA0Bl2H,EAAQ9E,GAEjC5C,KAAK69H,aAAc79H,KAAK+sH,cAAiBrlH,EAAQ9E,IAIlD,SAAyC8E,EAAQ9E,GAEhD5C,KAAK69H,aAAc79H,KAAK+sH,cAAiBrlH,EAAQ9E,GACjD5C,KAAK69H,aAAaloH,aAAc,GAIjC,SAAoDjO,EAAQ9E,GAE3D5C,KAAK69H,aAAc79H,KAAK+sH,cAAiBrlH,EAAQ9E,GACjD5C,KAAK69H,aAAatyH,wBAAyB,KAQ5C,SAAyB7D,EAAQ9E,GAIhC,IAAM,GAFFk7H,GAAO99H,KAAK29H,iBAEN3tH,EAAI,EAAGgU,EAAI85G,EAAK19H,OAAQ4P,IAAMgU,IAAMhU,EAE7C8tH,EAAM9tH,GAAMtI,EAAQ9E,MAMtB,SAAwC8E,EAAQ9E,GAI/C,IAAM,GAFFk7H,GAAO99H,KAAK29H,iBAEN3tH,EAAI,EAAGgU,EAAI85G,EAAK19H,OAAQ4P,IAAMgU,IAAMhU,EAE7C8tH,EAAM9tH,GAAMtI,EAAQ9E,IAIrB5C,MAAK69H,aAAaloH,aAAc,GAIjC,SAAmDjO,EAAQ9E,GAI1D,IAAM,GAFFk7H,GAAO99H,KAAK29H,iBAEN3tH,EAAI,EAAGgU,EAAI85G,EAAK19H,OAAQ4P,IAAMgU,IAAMhU,EAE7C8tH,EAAM9tH,GAAMtI,EAAQ9E,IAIrB5C,MAAK69H,aAAatyH,wBAAyB,KAQ5C,SAAgC7D,EAAQ9E,GAEvC5C,KAAK29H,iBAAkB39H,KAAK08H,eAAkBh1H,EAAQ9E,IAIvD,SAA+C8E,EAAQ9E,GAEtD5C,KAAK29H,iBAAkB39H,KAAK08H,eAAkBh1H,EAAQ9E,GACtD5C,KAAK69H,aAAaloH,aAAc,GAIjC,SAA0DjO,EAAQ9E,GAEjE5C,KAAK29H,iBAAkB39H,KAAK08H,eAAkBh1H,EAAQ9E,GACtD5C,KAAK69H,aAAatyH,wBAAyB,KAQ5C,SAA6B7D,EAAQ9E,GAEpC5C,KAAK29H,iBAAiBzlF,UAAWxwC,EAAQ9E,IAI1C,SAA4C8E,EAAQ9E,GAEnD5C,KAAK29H,iBAAiBzlF,UAAWxwC,EAAQ9E,GACzC5C,KAAK69H,aAAaloH,aAAc,GAIjC,SAAuDjO,EAAQ9E,GAE9D5C,KAAK29H,iBAAiBzlF,UAAWxwC,EAAQ9E,GACzC5C,KAAK69H,aAAatyH,wBAAyB,KAQ9C6vH,SAAU,SAA2B2C,EAAan7H,GAEjD5C,KAAKqtD,OACLrtD,KAAKo7H,SAAU2C,EAAan7H,IAU7BsgB,SAAU,SAA2B86G,EAAap7H,GAEjD5C,KAAKqtD,OACLrtD,KAAKkjB,SAAU86G,EAAap7H,IAK7ByqD,KAAM,WAEL,GAAIwwE,GAAe79H,KAAKqzE,KACvBP,EAAa9yE,KAAK8yE,WAElB0pD,EAAa1pD,EAAW0pD,WACxBzP,EAAej6C,EAAWi6C,aAC1B2P,EAAgB5pD,EAAW4pD,aAe5B,IAbOmB,IAENA,EAAe9qD,GAAgBO,SAAUtzE,KAAKozE,SAAUN,EAAWS,WAAcvzE,KAAKozE,SAEtFpzE,KAAKqzE,KAAOwqD,GAKb79H,KAAKo7H,SAAWp7H,KAAK+8H,sBACrB/8H,KAAKkjB,SAAWljB,KAAKg9H,uBAGda,EAGN,WADAx9H,SAAQC,MAAO,2DAA6DN,KAAKooB,KAAO,wBAKzF,IAAKo0G,EAAa,CAEjB,GAAIC,GAAc3pD,EAAW2pD,WAG7B,QAASD,GAER,IAAK,YAEJ,IAAOqB,EAAavlH,SAGnB,WADAjY,SAAQC,MAAO,oFAAqFN,KAKrG,KAAO69H,EAAavlH,SAAS0jE,UAG5B,WADA37E,SAAQC,MAAO,8GAA+GN,KAK/H69H,GAAeA,EAAavlH,SAAS0jE,SAErC,MAED,KAAK,QAEJ,IAAO6hD,EAAa3rG,SAGnB,WADA7xB,SAAQC,MAAO,iFAAkFN,KAQlG69H,GAAeA,EAAa3rG,SAASC,KAGrC,KAAM,GAAIniB,GAAI,EAAGA,EAAI6tH,EAAaz9H,OAAQ4P,IAEzC,GAAK6tH,EAAc7tH,GAAI7N,OAASs6H,EAAc,CAE7CA,EAAczsH,CACd,OAMF,KAED,SAEC,GAAoClP,SAA/B+8H,EAAcrB,GAGlB,WADAn8H,SAAQC,MAAO,uEAAwEN,KAKxF69H,GAAeA,EAAcrB,GAK/B,GAAqB17H,SAAhB27H,EAA4B,CAEhC,GAAqC37H,SAAhC+8H,EAAcpB,GAGlB,WADAp8H,SAAQC,MAAO,wFAAyFN,KAAM69H,EAK/GA,GAAeA,EAAcpB,IAO/B,GAAIwB,GAAeJ,EAAc9Q,EAEjC,IAAsBjsH,SAAjBm9H,EAA6B,CAEjC,GAAI1qD,GAAWT,EAAWS,QAI1B,YAFAlzE,SAAQC,MAAO,+DAAiEizE,EAC/E,IAAMw5C,EAAe,wBAA0B8Q,GAMjD,GAAIK,GAAal+H,KAAKs9H,WAAWC,IAECz8H,UAA7B+8H,EAAaloH,aAEjBuoH,EAAal+H,KAAKs9H,WAAWE,YAC7Bx9H,KAAK69H,aAAeA,GAE+B/8H,SAAxC+8H,EAAatyH,yBAExB2yH,EAAal+H,KAAKs9H,WAAWG,uBAC7Bz9H,KAAK69H,aAAeA,EAKrB,IAAIM,GAAcn+H,KAAKi9H,YAAYC,MAEnC,IAAuBp8H,SAAlB47H,EAA8B,CAIlC,GAAsB,0BAAjB3P,EAA2C,CAK/C,IAAO8Q,EAAaxlH,SAGnB,WADAhY,SAAQC,MAAO,sGAAuGN,KAKvH,IAAK69H,EAAaxlH,SAASqI,iBAAmB,CAE7C,IAAOm9G,EAAaxlH,SAAS/H,gBAG5B,WADAjQ,SAAQC,MAAO,sHAAuHN,KAKvI,KAAM,GAAIgQ,GAAI,EAAGA,EAAIhQ,KAAKqzE,KAAKh7D,SAAS/H,gBAAgBxF,SAAS1K,OAAQ4P,IAExE,GAAK6tH,EAAaxlH,SAAS/H,gBAAgBxF,SAAUkF,GAAI7N,OAASu6H,EAAgB,CAEjFA,EAAgB1sH,CAChB,YAOI,CAEN,IAAO6tH,EAAaxlH,SAASvK,aAG5B,WADAzN,SAAQC,MAAO,mHAAoHN,KAKpI,KAAM,GAAIgQ,GAAI,EAAGA,EAAIhQ,KAAKqzE,KAAKh7D,SAASvK,aAAa1N,OAAQ4P,IAE5D,GAAK6tH,EAAaxlH,SAASvK,aAAckC,GAAI7N,OAASu6H,EAAgB,CAErEA,EAAgB1sH,CAChB,SAUJmuH,EAAcn+H,KAAKi9H,YAAYG,aAE/Bp9H,KAAK29H,iBAAmBM,EACxBj+H,KAAK08H,cAAgBA,MAEiB57H,UAA3Bm9H,EAAa/lF,WAAoDp3C,SAAzBm9H,EAAan/G,SAIhEq/G,EAAcn+H,KAAKi9H,YAAYI,eAE/Br9H,KAAK29H,iBAAmBM,GAEb7wH,MAAMC,QAAS4wH,IAE1BE,EAAcn+H,KAAKi9H,YAAYE,YAE/Bn9H,KAAK29H,iBAAmBM,GAIxBj+H,KAAK+sH,aAAeA,CAKrB/sH,MAAKo7H,SAAWp7H,KAAK09H,oBAAqBS,GAC1Cn+H,KAAKkjB,SAAWljB,KAAK49H,iCAAkCO,GAAeD,IAIvEzC,OAAQ,WAEPz7H,KAAKqzE,KAAO,KAIZrzE,KAAKo7H,SAAWp7H,KAAKo+H,kBACrBp+H,KAAKkjB,SAAWljB,KAAKq+H,qBAOvBz8H,OAAO48E,OAAQzL,GAAgBU,WAG9B2qD,kBAAmBrrD,GAAgBU,UAAU2nD,SAC7CiD,kBAAmBtrD,GAAgBU,UAAUvwD,WAqF9CthB,OAAO48E,OAAQhL,GAAqBC,WAEnCioD,wBAAwB,EAExBr8F,IAAK,WAYJ,IAAM,GAVFvmB,GAAU9Y,KAAKi7B,SAClBqjG,EAAWxlH,EAAQ1Y,OACnBm+H,EAAiBv+H,KAAK0zE,gBACtB8qD,EAAgBx+H,KAAK2zE,eACrBvF,EAAQpuE,KAAK4zE,OACb6qD,EAAcz+H,KAAK6zE,aACnB2nD,EAAWx7H,KAAKkzE,UAChBwrD,EAAYlD,EAASp7H,OACrBu+H,EAAc79H,OAELkP,EAAI,EAAGgU,EAAI7jB,UAAUC,OAAQ4P,IAAMgU,IAAMhU,EAAI,CAEtD,GAAIwQ,GAASrgB,UAAW6P,GACvBhO,EAAOwe,EAAOxe,KACdoO,EAAQouH,EAAex8H,EAExB,IAAelB,SAAVsP,EAAsB,CAI1BA,EAAQkuH,IACRE,EAAex8H,GAASoO,EACxB0I,EAAQ1G,KAAMoO,EAId,KAAM,GAAIitB,GAAI,EAAGmqB,EAAI8mE,EAAWjxF,IAAMmqB,IAAMnqB,EAE3C+tF,EAAU/tF,GAAIr7B,KAAM,GAAI2gE,IAAiBvyD,EAAQ4tD,EAAO3gC,GAAKgxF,EAAahxF,SAIrE,IAAKr9B,EAAQmuH,EAAiB,CAEpCI,EAAc7lH,EAAS1I,EAIvB,IAAIwuH,KAAsBL,EACzBM,EAAmB/lH,EAAS8lH,EAE7BJ,GAAeK,EAAiB78H,MAASoO,EACzC0I,EAAS1I,GAAUyuH,EAEnBL,EAAex8H,GAAS48H,EACxB9lH,EAAS8lH,GAAqBp+G,CAI9B,KAAM,GAAIitB,GAAI,EAAGmqB,EAAI8mE,EAAWjxF,IAAMmqB,IAAMnqB,EAAI,CAE/C,GAAIqxF,GAAkBtD,EAAU/tF,GAC/BsxF,EAAaD,EAAiBF,GAC9B1sD,EAAU4sD,EAAiB1uH,EAE5B0uH,GAAiB1uH,GAAU2uH,EAEVj+H,SAAZoxE,IAMJA,EAAU,GAAIa,IAAiBvyD,EAAQ4tD,EAAO3gC,GAAKgxF,EAAahxF,KAIjEqxF,EAAiBF,GAAqB1sD,OAI5Bp5D,GAAS1I,KAAYuuH,GAEhCt+H,QAAQC,MAAO,sJAOjBN,KAAK0zE,gBAAkB6qD,GAIxB/0H,OAAQ,WAQP,IAAM,GANFsP,GAAU9Y,KAAKi7B,SAClBsjG,EAAiBv+H,KAAK0zE,gBACtB8qD,EAAgBx+H,KAAK2zE,eACrB6nD,EAAWx7H,KAAKkzE,UAChBwrD,EAAYlD,EAASp7H,OAEZ4P,EAAI,EAAGgU,EAAI7jB,UAAUC,OAAQ4P,IAAMgU,IAAMhU,EAAI,CAEtD,GAAIwQ,GAASrgB,UAAW6P,GACvBhO,EAAOwe,EAAOxe,KACdoO,EAAQouH,EAAex8H,EAExB,IAAelB,SAAVsP,GAAuBA,GAASmuH,EAAiB,CAIrD,GAAIS,GAAkBT,IACrBU,EAAoBnmH,EAASkmH,EAE9BR,GAAeS,EAAkBj9H,MAASoO,EAC1C0I,EAAS1I,GAAU6uH,EAEnBT,EAAex8H,GAASg9H,EACxBlmH,EAASkmH,GAAoBx+G,CAI7B,KAAM,GAAIitB,GAAI,EAAGmqB,EAAI8mE,EAAWjxF,IAAMmqB,IAAMnqB,EAAI,CAE/C,GAAIqxF,GAAkBtD,EAAU/tF,GAC/ByxF,EAAcJ,EAAiBE,GAC/B9sD,EAAU4sD,EAAiB1uH,EAE5B0uH,GAAiB1uH,GAAU8uH,EAC3BJ,EAAiBE,GAAoB9sD,IAQxClyE,KAAK0zE,gBAAkB6qD,GAKxBY,QAAS,WASR,IAAM,GAPFrmH,GAAU9Y,KAAKi7B,SAClBqjG,EAAWxlH,EAAQ1Y,OACnBm+H,EAAiBv+H,KAAK0zE,gBACtB8qD,EAAgBx+H,KAAK2zE,eACrB6nD,EAAWx7H,KAAKkzE,UAChBwrD,EAAYlD,EAASp7H,OAEZ4P,EAAI,EAAGgU,EAAI7jB,UAAUC,OAAQ4P,IAAMgU,IAAMhU,EAAI,CAEtD,GAAIwQ,GAASrgB,UAAW6P,GACvBhO,EAAOwe,EAAOxe,KACdoO,EAAQouH,EAAex8H,EAExB,IAAelB,SAAVsP,EAIJ,SAFOouH,GAAex8H,GAEjBoO,EAAQmuH,EAAiB,CAI7B,GAAIK,KAAsBL,EACzBM,EAAmB/lH,EAAS8lH,GAC5Br2G,IAAe+1G,EACfc,EAAatmH,EAASyP,EAGvBi2G,GAAeK,EAAiB78H,MAASoO,EACzC0I,EAAS1I,GAAUyuH,EAGnBL,EAAeY,EAAWp9H,MAAS48H,EACnC9lH,EAAS8lH,GAAqBQ,EAC9BtmH,EAAQ0c,KAIR,KAAM,GAAIiY,GAAI,EAAGmqB,EAAI8mE,EAAWjxF,IAAMmqB,IAAMnqB,EAAI,CAE/C,GAAIqxF,GAAkBtD,EAAU/tF,GAC/BsxF,EAAaD,EAAiBF,GAC9B5pE,EAAO8pE,EAAiBv2G,EAEzBu2G,GAAiB1uH,GAAU2uH,EAC3BD,EAAiBF,GAAqB5pE,EACtC8pE,EAAgBtpG,WAIX,CAIN,GAAIjN,KAAe+1G,EAClBc,EAAatmH,EAASyP,EAEvBi2G,GAAeY,EAAWp9H,MAASoO,EACnC0I,EAAS1I,GAAUgvH,EACnBtmH,EAAQ0c,KAIR,KAAM,GAAIiY,GAAI,EAAGmqB,EAAI8mE,EAAWjxF,IAAMmqB,IAAMnqB,EAAI,CAE/C,GAAIqxF,GAAkBtD,EAAU/tF,EAEhCqxF,GAAiB1uH,GAAU0uH,EAAiBv2G,GAC5Cu2G,EAAgBtpG,QAUpBx1B,KAAK0zE,gBAAkB6qD,GAMxBprD,WAAY,SAAW/qD,EAAM0qD,GAK5B,GAAIusD,GAAgBr/H,KAAK8zE,uBACxB1jE,EAAQivH,EAAej3G,GACvBozG,EAAWx7H,KAAKkzE,SAEjB,IAAepyE,SAAVsP,EAAsB,MAAOorH,GAAUprH,EAE5C,IAAIg+D,GAAQpuE,KAAK4zE,OAChB6qD,EAAcz+H,KAAK6zE,aACnB/6D,EAAU9Y,KAAKi7B,SACfqjG,EAAWxlH,EAAQ1Y,OACnBm+H,EAAiBv+H,KAAK0zE,gBACtBorD,EAAkB,GAAI1xH,OAAOkxH,EAE9BluH,GAAQorH,EAASp7H,OAEjBi/H,EAAej3G,GAAShY,EAExBg+D,EAAMh8D,KAAMgW,GACZq2G,EAAYrsH,KAAM0gE,GAClB0oD,EAASppH,KAAM0sH,EAEf,KAAM,GAAI9uH,GAAIuuH,EAAgBv6G,EAAIlL,EAAQ1Y,OAAQ4P,IAAMgU,IAAMhU,EAAI,CAEjE,GAAIwQ,GAAS1H,EAAS9I,EACtB8uH,GAAiB9uH,GAAM,GAAI+iE,IAAiBvyD,EAAQ4H,EAAM0qD,GAI3D,MAAOgsD,IAIRQ,aAAc,SAAWl3G,GAKxB,GAAIi3G,GAAgBr/H,KAAK8zE,uBACxB1jE,EAAQivH,EAAej3G,EAExB,IAAetnB,SAAVsP,EAAsB,CAE1B,GAAIg+D,GAAQpuE,KAAK4zE,OAChB6qD,EAAcz+H,KAAK6zE,aACnB2nD,EAAWx7H,KAAKkzE,UAChBqsD,EAAoB/D,EAASp7H,OAAS,EACtCo/H,EAAehE,EAAU+D,GACzBE,EAAmBr3G,EAAMm3G,EAE1BF,GAAeI,GAAqBrvH,EAEpCorH,EAAUprH,GAAUovH,EACpBhE,EAAShmG,MAETipG,EAAaruH,GAAUquH,EAAac,GACpCd,EAAYjpG,MAEZ44C,EAAOh+D,GAAUg+D,EAAOmxD,GACxBnxD,EAAM54C,UAoFT5zB,OAAO48E,OAAQrK,GAAgBV,WAI9BqlD,KAAM,WAIL,MAFA94H,MAAKu0E,OAAOmrD,gBAAiB1/H,MAEtBA,MAIR4G,KAAM,WAIL,MAFA5G,MAAKu0E,OAAOorD,kBAAmB3/H,MAExBA,KAAKkiB,SAIbA,MAAO,WASN,MAPAliB,MAAKk2E,QAAS,EACdl2E,KAAKmf,SAAU,EAEfnf,KAAKqG,KAAO,EACZrG,KAAK21E,cACL31E,KAAK41E,WAAa,KAEX51E,KAAK4/H,aAAaC,eAI1BC,UAAW,WAEV,MAAO9/H,MAAKmf,UAAanf,KAAKk2E,QAA6B,IAAnBl2E,KAAK61E,WACvB,OAApB71E,KAAK41E,YAAuB51E,KAAKu0E,OAAOwrD,gBAAiB//H,OAK5DggI,YAAa,WAEZ,MAAOhgI,MAAKu0E,OAAOwrD,gBAAiB//H,OAIrCigI,QAAS,SAAW55H,GAInB,MAFArG,MAAK41E,WAAavvE,EAEXrG,MAIRw5H,QAAS,SAAWr+G,EAAM86D,GAKzB,MAHAj2E,MAAKgxE,KAAO71D,EACZnb,KAAKi2E,YAAcA,EAEZj2E,MASRkgI,mBAAoB,SAAWnqD,GAO9B,MALA/1E,MAAK+1E,OAASA,EAGd/1E,KAAKg2E,iBAAmBh2E,KAAKmf,QAAU42D,EAAS,EAEzC/1E,KAAK4/H,cAKbO,mBAAoB,WAEnB,MAAOngI,MAAKg2E,kBAIboqD,OAAQ,SAAWl0D,GAElB,MAAOlsE,MAAKqgI,gBAAiBn0D,EAAU,EAAG,IAI3Co0D,QAAS,SAAWp0D,GAEnB,MAAOlsE,MAAKqgI,gBAAiBn0D,EAAU,EAAG,IAI3Cq0D,cAAe,SAAWC,EAAet0D,EAAUu0D,GAKlD,GAHAD,EAAcF,QAASp0D,GACvBlsE,KAAKogI,OAAQl0D,GAERu0D,EAAO,CAEX,GAAIC,GAAiB1gI,KAAKw0E,MAAMtI,SAC/By0D,EAAkBH,EAAchsD,MAAMtI,SAEtC00D,EAAgBD,EAAkBD,EAClCG,EAAgBH,EAAiBC,CAElCH,GAAcC,KAAM,EAAKG,EAAe10D,GACxClsE,KAAKygI,KAAMI,EAAe,EAAK30D,GAIhC,MAAOlsE,OAIR8gI,YAAa,SAAWC,EAAc70D,EAAUu0D,GAE/C,MAAOM,GAAaR,cAAevgI,KAAMksE,EAAUu0D,IAIpDb,WAAY,WAEX,GAAIoB,GAAoBhhI,KAAKy1E,kBAS7B,OAP2B,QAAtBurD,IAEJhhI,KAAKy1E,mBAAqB,KAC1Bz1E,KAAKu0E,OAAO0sD,4BAA6BD,IAInChhI,MASRkhI,sBAAuB,SAAWrrD,GAKjC,MAHA71E,MAAK61E,UAAYA,EACjB71E,KAAK81E,oBAAsB91E,KAAKk2E,OAAS,EAAIL,EAEtC71E,KAAK6/H,eAKbsB,sBAAuB,WAEtB,MAAOnhI,MAAK81E,qBAIbsrD,YAAa,SAAWl1D,GAIvB,MAFAlsE,MAAK61E,UAAY71E,KAAKw0E,MAAMtI,SAAWA,EAEhClsE,KAAK6/H,eAIbwB,SAAU,SAAWjyD,GAKpB,MAHApvE,MAAKqG,KAAO+oE,EAAO/oE,KACnBrG,KAAK61E,UAAYzG,EAAOyG,UAEjB71E,KAAK6/H,eAIbyB,KAAM,SAAWp1D,GAEhB,MAAOlsE,MAAKygI,KAAMzgI,KAAK81E,oBAAqB,EAAG5J,IAIhDu0D,KAAM,SAAWc,EAAgBC,EAAct1D,GAE9C,GAAIkI,GAAQp0E,KAAKu0E,OAAQktD,EAAMrtD,EAAM/tE,KACpC2uE,EAAch1E,KAAKw1E,sBAEnBK,EAAY71E,KAAK61E,SAEG,QAAhBb,IAEJA,EAAcZ,EAAMstD,0BACpB1hI,KAAKw1E,sBAAwBR,EAI9B,IAAI/J,GAAQ+J,EAAY9K,mBACvBgB,EAAS8J,EAAY7K,YAQtB,OANAc,GAAO,GAAMw2D,EACbx2D,EAAO,GAAMw2D,EAAMv1D,EAEnBhB,EAAQ,GAAMq2D,EAAiB1rD,EAC/B3K,EAAQ,GAAMs2D,EAAe3rD,EAEtB71E,MAIR6/H,YAAa,WAEZ,GAAI8B,GAAuB3hI,KAAKw1E,qBAShC,OAP8B,QAAzBmsD,IAEJ3hI,KAAKw1E,sBAAwB,KAC7Bx1E,KAAKu0E,OAAO0sD,4BAA6BU,IAInC3hI,MAMR4hI,SAAU,WAET,MAAO5hI,MAAKu0E,QAIbstD,QAAS,WAER,MAAO7hI,MAAKw0E,OAIbstD,QAAS,WAER,MAAO9hI,MAAKy0E,YAAcz0E,KAAKu0E,OAAOiC,OAMvCurD,QAAS,SAAW17H,EAAM27H,EAAWC,EAAelH,GAInD,IAAO/6H,KAAKmf,QAKX,WADAnf,MAAKkiI,cAAe77H,EAKrB,IAAI4qE,GAAYjxE,KAAK41E,UAErB,IAAmB,OAAd3E,EAAqB,CAIzB,GAAIkxD,IAAgB97H,EAAO4qE,GAAcgxD,CACzC,IAAKE,EAAc,GAAuB,IAAlBF,EAEvB,MAMDjiI,MAAK41E,WAAa,KAClBosD,EAAYC,EAAgBE,EAM7BH,GAAahiI,KAAKoiI,iBAAkB/7H,EACpC,IAAIg8H,GAAWriI,KAAKsiI,YAAaN,GAK7BjsD,EAAS/1E,KAAKkiI,cAAe77H,EAEjC,IAAK0vE,EAAS,EAKb,IAAM,GAHFpB,GAAe30E,KAAKo1E,cACpBmtD,EAAiBviI,KAAKq1E,kBAEhB5nC,EAAI,EAAGmqB,EAAI+c,EAAav0E,OAAQqtC,IAAMmqB,IAAMnqB,EAErDknC,EAAclnC,GAAIs6E,SAAUsa,GAC5BE,EAAgB90F,GAAIqtF,WAAYC,EAAWhlD,IAQ9CmsD,cAAe,SAAW77H,GAEzB,GAAI0vE,GAAS,CAEb,IAAK/1E,KAAKmf,QAAU,CAEnB42D,EAAS/1E,KAAK+1E,MACd,IAAIf,GAAch1E,KAAKy1E,kBAEvB,IAAqB,OAAhBT,EAAuB,CAE3B,GAAIwtD,GAAmBxtD,EAAY+yC,SAAU1hH,GAAQ,EAErD0vE,IAAUysD,EAELn8H,EAAO2uE,EAAY9K,mBAAoB,KAE3ClqE,KAAK4/H,aAEqB,IAArB4C,IAGJxiI,KAAKmf,SAAU,KAWnB,MADAnf,MAAKg2E,iBAAmBD,EACjBA,GAIRqsD,iBAAkB,SAAW/7H,GAE5B,GAAIwvE,GAAY,CAEhB,KAAO71E,KAAKk2E,OAAS,CAEpBL,EAAY71E,KAAK61E,SAEjB,IAAIb,GAAch1E,KAAKw1E,qBAEvB,IAAqB,OAAhBR,EAAuB,CAE3B,GAAIwtD,GAAmBxtD,EAAY+yC,SAAU1hH,GAAQ,EAErDwvE,IAAa2sD,EAERn8H,EAAO2uE,EAAY9K,mBAAoB,KAE3ClqE,KAAK6/H,cAEc,IAAdhqD,EAGJ71E,KAAKk2E,QAAS,EAKdl2E,KAAK61E,UAAYA,IAWrB,MADA71E,MAAK81E,oBAAsBD,EACpBA,GAIRysD,YAAa,SAAWN,GAEvB,GAAI37H,GAAOrG,KAAKqG,KAAO27H,EACnB91D,EAAWlsE,KAAKw0E,MAAMtI,SACtB8E,EAAOhxE,KAAKgxE,KACZyxD,EAAYziI,KAAK21E,WAEjB+sD,EAAa1xD,IAAS+O,EAE1B,IAAmB,IAAdiiD,EAEJ,MAAKS,QAA2Bp8H,EAEvBq8H,GAAkC,KAAR,EAAZD,GAA0Bv2D,EAAW7lE,EAAOA,CAIpE,IAAK2qE,IAAS8O,GAAW,CAEnB2iD,SAIJziI,KAAK21E,WAAa,EAClB31E,KAAK2iI,aAAa,GAAM,GAAM,GAI/BC,GAAa,CAEZ,GAAKv8H,GAAQ6lE,EAEZ7lE,EAAO6lE,MAED,CAAA,KAAK7lE,EAAO,GAIZ,KAAMu8H,EAFZv8H,GAAO,EAIHrG,KAAKm2E,kBAAoBn2E,KAAKk2E,QAAS,EACvCl2E,KAAKmf,SAAU,EAEpBnf,KAAKu0E,OAAO57B,eACXl3C,KAAM,WAAY2tE,OAAQpvE,KAC1BkY,UAAW8pH,EAAY,KAAU,SAK7B,CAwBN,GAtBKS,SAICT,GAAa,GAEjBS,EAAY,EAEZziI,KAAK2iI,aAAa,EAA2B,IAArB3iI,KAAKi2E,YAAmBysD,IAQhD1iI,KAAK2iI,YAAkC,IAArB3iI,KAAKi2E,aAAmB,EAAMysD,IAM7Cr8H,GAAQ6lE,GAAY7lE,EAAO,EAAI,CAInC,GAAIw8H,GAAYlwH,KAAKC,MAAOvM,EAAO6lE,EACnC7lE,IAAQ6lE,EAAW22D,EAEnBJ,GAAa9vH,KAAK4P,IAAKsgH,EAEvB,IAAIC,GAAU9iI,KAAKi2E,YAAcwsD,CAEjC,IAAKK,GAAW,EAIV9iI,KAAKm2E,kBAAoBn2E,KAAKk2E,QAAS,EACvCl2E,KAAKmf,SAAU,EAEpB9Y,EAAO27H,EAAY,EAAI91D,EAAW,EAElClsE,KAAKu0E,OAAO57B,eACXl3C,KAAM,WAAY2tE,OAAQpvE,KAC1BkY,UAAW8pH,EAAY,EAAI,WAGtB,CAIN,GAAiB,IAAZc,EAAgB,CAIpB,GAAIC,GAAUf,EAAY,CAC1BhiI,MAAK2iI,YAAaI,GAAWA,EAASL,OAItC1iI,MAAK2iI,aAAa,GAAO,EAAOD,EAIjC1iI,MAAK21E,WAAa8sD,EAElBziI,KAAKu0E,OAAO57B,eACXl3C,KAAM,OAAQ2tE,OAAQpvE,KAAM6iI,UAAWA,KAO1C,GAAKH,GAAkC,KAAR,EAAZD,GAKlB,MADAziI,MAAKqG,KAAOA,EACL6lE,EAAW7lE,EAOpB,MADArG,MAAKqG,KAAOA,EACLA,GAIRs8H,YAAa,SAAWI,EAASC,EAAON,GAEvC,GAAIxtD,GAAWl1E,KAAKm1E,oBAEfutD,IAEJxtD,EAASL,YAAesL,GACxBjL,EAASH,UAAaoL,KAMjB4iD,EAEJ7tD,EAASL,YAAc70E,KAAKo2E,iBAAmB+J,GAAkBrL,GAIjEI,EAASL,YAAcuL,GAInB4iD,EAEJ9tD,EAASH,UAAY/0E,KAAKq2E,eAAiB8J,GAAkBrL,GAI7DI,EAASH,UAAcqL,KAQ1BigD,gBAAiB,SAAWn0D,EAAU+2D,EAAWC,GAEhD,GAAI9uD,GAAQp0E,KAAKu0E,OAAQktD,EAAMrtD,EAAM/tE,KACpC2uE,EAAch1E,KAAKy1E,kBAEC,QAAhBT,IAEJA,EAAcZ,EAAMstD,0BACpB1hI,KAAKy1E,mBAAqBT,EAI3B,IAAI/J,GAAQ+J,EAAY9K,mBACvBgB,EAAS8J,EAAY7K,YAKtB,OAHAc,GAAO,GAAMw2D,EAASv2D,EAAQ,GAAM+3D,EACpCh4D,EAAO,GAAMw2D,EAAMv1D,EAAUhB,EAAQ,GAAMg4D,EAEpCljI,QA4BTs2E,GAAe7C,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQrxF,EAAgB6zE,YAExElJ,YAAa+L,GAEb6sD,YAAa,SAAW/zD,EAAQg0D,GAE/B,GAAI7sD,GAAOnH,EAAOqF,YAAcz0E,KAAKw2E,MACpCrK,EAASiD,EAAOoF,MAAMrI,OACtBuI,EAAUvI,EAAO/rE,OACjBo7H,EAAWpsD,EAAOiG,kBAClBV,EAAevF,EAAOgG,cACtBiuD,EAAW9sD,EAAKv0E,KAChBshI,EAAiBtjI,KAAKujI,uBACtBC,EAAiBF,EAAgBD,EAEVviI,UAAnB0iI,IAEJA,KACAF,EAAgBD,GAAaG,EAI9B,KAAM,GAAIxzH,GAAI,EAAGA,IAAM0kE,IAAY1kE,EAAI,CAEtC,GAAIi6G,GAAQ99C,EAAQn8D,GACnB68G,EAAY5C,EAAM9nH,KAClB+vE,EAAUsxD,EAAgB3W,EAE3B,IAAiB/rH,SAAZoxE,EAEJspD,EAAUxrH,GAAMkiE,MAEV,CAIN,GAFAA,EAAUspD,EAAUxrH,GAEHlP,SAAZoxE,EAAwB,CAIC,OAAxBA,EAAQoD,gBAETpD,EAAQQ,eACX1yE,KAAKyjI,oBAAqBvxD,EAASmxD,EAAUxW,GAI9C,UAID,GAAIzkG,GAAOg7G,GAAmBA,EAC7B/tD,kBAAmBrlE,GAAIkiE,QAAQY,UAEhCZ,GAAU,GAAID,IACbc,GAAgBke,OAAQ1a,EAAMs2C,EAAWzkG,GACzC6hG,EAAME,cAAeF,EAAMI,kBAEzBn4C,EAAQQ,eACX1yE,KAAKyjI,oBAAqBvxD,EAASmxD,EAAUxW,GAE7C2O,EAAUxrH,GAAMkiE,EAIjByC,EAAc3kE,GAAIq6D,aAAe6H,EAAQxqE,SAM3Cg4H,gBAAiB,SAAWtwD,GAE3B,IAAOpvE,KAAK+/H,gBAAiB3wD,GAAW,CAEvC,GAA4B,OAAvBA,EAAOkG,YAAuB,CAKlC,GAAI+tD,IAAaj0D,EAAOqF,YAAcz0E,KAAKw2E,OAAQx0E,KAClD0hI,EAAWt0D,EAAOoF,MAAMxyE,KACxB2hI,EAAiB3jI,KAAK4jI,eAAgBF,EAEvC1jI,MAAKmjI,YAAa/zD,EACjBu0D,GAAkBA,EAAeE,aAAc,IAEhD7jI,KAAK8jI,mBAAoB10D,EAAQs0D,EAAUL,GAO5C,IAAM,GAHF7H,GAAWpsD,EAAOiG,kBAGZrlE,EAAI,EAAGgU,EAAIw3G,EAASp7H,OAAQ4P,IAAMgU,IAAMhU,EAAI,CAErD,GAAIkiE,GAAUspD,EAAUxrH,EAEK,KAAxBkiE,EAAQO,aAEZzyE,KAAK+jI,aAAc7xD,GACnBA,EAAQipD,qBAMVn7H,KAAKgkI,YAAa50D,KAMpBuwD,kBAAmB,SAAWvwD,GAE7B,GAAKpvE,KAAK+/H,gBAAiB3wD,GAAW,CAKrC,IAAM,GAHFosD,GAAWpsD,EAAOiG,kBAGZrlE,EAAI,EAAGgU,EAAIw3G,EAASp7H,OAAQ4P,IAAMgU,IAAMhU,EAAI,CAErD,GAAIkiE,GAAUspD,EAAUxrH,EAEK,OAArBkiE,EAAQO,WAEfP,EAAQmpD,uBACRr7H,KAAKikI,iBAAkB/xD,IAMzBlyE,KAAKkkI,gBAAiB90D,KAQxBqH,mBAAoB,WAEnBz2E,KAAKmkI,YACLnkI,KAAKokI,gBAAkB,EAEvBpkI,KAAK4jI,kBAQL5jI,KAAKkzE,aACLlzE,KAAKqkI,iBAAmB,EAExBrkI,KAAKujI,0BAGLvjI,KAAKskI,wBACLtkI,KAAKukI,4BAA8B,CAEnC,IAAI/xH,GAAQxS,IAEZA,MAAK+zE,OAEJywD,SACCxwD,GAAIA,SAEH,MAAOxhE,GAAM2xH,SAAS/jI,QAGvB6zE,GAAIA,SAEH,MAAOzhE,GAAM4xH,kBAIf5I,UACCxnD,GAAIA,SAEH,MAAOxhE,GAAM0gE,UAAU9yE,QAGxB6zE,GAAIA,SAEH,MAAOzhE,GAAM6xH,mBAIfI,qBACCzwD,GAAIA,SAEH,MAAOxhE,GAAM8xH,qBAAqBlkI,QAGnC6zE,GAAIA,SAEH,MAAOzhE,GAAM+xH,gCAWjBxE,gBAAiB,SAAW3wD,GAE3B,GAAIh/D,GAAQg/D,EAAOkG,WACnB,OAAiB,QAAVllE,GAAkBA,EAAQpQ,KAAKokI,iBAIvCN,mBAAoB,SAAW10D,EAAQs0D,EAAUL,GAEhD,GAAImB,GAAUxkI,KAAKmkI,SAClBO,EAAgB1kI,KAAK4jI,eACrBD,EAAiBe,EAAehB,EAEjC,IAAwB5iI,SAAnB6iI,EAEJA,GAECE,cAAgBz0D,GAChBu1D,iBAIDv1D,EAAOmG,kBAAoB,EAE3BmvD,EAAehB,GAAaC,MAEtB,CAEN,GAAIE,GAAeF,EAAeE,YAElCz0D,GAAOmG,kBAAoBsuD,EAAazjI,OACxCyjI,EAAazxH,KAAMg9D,GAIpBA,EAAOkG,YAAckvD,EAAQpkI,OAC7BokI,EAAQpyH,KAAMg9D,GAEdu0D,EAAegB,aAActB,GAAaj0D,GAI3Cw1D,sBAAuB,SAAWx1D,GAEjC,GAAIo1D,GAAUxkI,KAAKmkI,SAClBU,EAAqBL,EAASA,EAAQpkI,OAAS,GAC/C0kI,EAAa11D,EAAOkG,WAErBuvD,GAAmBvvD,YAAcwvD,EACjCN,EAASM,GAAeD,EACxBL,EAAQhvG,MAER45C,EAAOkG,YAAc,IAGrB,IAAIouD,GAAWt0D,EAAOoF,MAAMxyE,KAC3B0iI,EAAgB1kI,KAAK4jI,eACrBD,EAAiBe,EAAehB,GAChCqB,EAAsBpB,EAAeE,aAErCmB,EACCD,EAAqBA,EAAoB3kI,OAAS,GAEnD6kI,EAAmB71D,EAAOmG,iBAE3ByvD,GAAgBzvD,kBAAoB0vD,EACpCF,EAAqBE,GAAqBD,EAC1CD,EAAoBvvG,MAEpB45C,EAAOmG,kBAAoB,IAG3B,IAAIovD,GAAehB,EAAegB,aACjCtB,GAAaj0D,EAAOqF,YAAcz0E,KAAKw2E,OAAQx0E,WAEzC2iI,GAActB,GAEe,IAA/B0B,EAAoB3kI,cAEjBskI,GAAehB,GAIvB1jI,KAAKklI,iCAAkC91D,IAIxC81D,iCAAkC,SAAW91D,GAG5C,IAAM,GADFosD,GAAWpsD,EAAOiG,kBACZrlE,EAAI,EAAGgU,EAAIw3G,EAASp7H,OAAQ4P,IAAMgU,IAAMhU,EAAI,CAErD,GAAIkiE,GAAUspD,EAAUxrH,EAEW,OAA3BkiE,EAAQQ,gBAEf1yE,KAAKmlI,uBAAwBjzD,KAQhC8xD,YAAa,SAAW50D,GAQvB,GAAIo1D,GAAUxkI,KAAKmkI,SAClBiB,EAAYh2D,EAAOkG,YAEnB+vD,EAAkBrlI,KAAKokI,kBAEvBkB,EAAsBd,EAASa,EAEhCj2D,GAAOkG,YAAc+vD,EACrBb,EAASa,GAAoBj2D,EAE7Bk2D,EAAoBhwD,YAAc8vD,EAClCZ,EAASY,GAAcE,GAIxBpB,gBAAiB,SAAW90D,GAQ3B,GAAIo1D,GAAUxkI,KAAKmkI,SAClBiB,EAAYh2D,EAAOkG,YAEnBiwD,IAAwBvlI,KAAKokI,gBAE7BoB,EAAmBhB,EAASe;AAE7Bn2D,EAAOkG,YAAciwD,EACrBf,EAASe,GAAuBn2D,EAEhCo2D,EAAiBlwD,YAAc8vD,EAC/BZ,EAASY,GAAcI,GAMxB/B,oBAAqB,SAAWvxD,EAASmxD,EAAUxW,GAElD,GAAIyW,GAAiBtjI,KAAKujI,uBACzBkC,EAAgBnC,EAAgBD,GAEhC7H,EAAWx7H,KAAKkzE,SAEMpyE,UAAlB2kI,IAEJA,KACAnC,EAAgBD,GAAaoC,GAI9BA,EAAe5Y,GAAc36C,EAE7BA,EAAQoD,YAAckmD,EAASp7H,OAC/Bo7H,EAASppH,KAAM8/D,IAIhBizD,uBAAwB,SAAWjzD,GAElC,GAAIspD,GAAWx7H,KAAKkzE,UACnBwyD,EAAcxzD,EAAQA,QACtBmxD,EAAWqC,EAAYtyD,SAASpxE,KAChC6qH,EAAY6Y,EAAYt9G,KACxBk7G,EAAiBtjI,KAAKujI,uBACtBkC,EAAgBnC,EAAgBD,GAEhCsC,EAAsBnK,EAAUA,EAASp7H,OAAS,GAClD0kI,EAAa5yD,EAAQoD,WAEtBqwD,GAAoBrwD,YAAcwvD,EAClCtJ,EAAUsJ,GAAea,EACzBnK,EAAShmG,YAEFiwG,GAAe5Y,EAEtB+Y,GAAkB,CAEjB,IAAM,GAAIC,KAAKJ,GAAgB,KAAMG,SAE9BtC,GAAgBD,KAMzBU,aAAc,SAAW7xD,GAExB,GAAIspD,GAAWx7H,KAAKkzE,UACnBkyD,EAAYlzD,EAAQoD,YAEpB+vD,EAAkBrlI,KAAKqkI,mBAEvByB,EAAuBtK,EAAU6J,EAElCnzD,GAAQoD,YAAc+vD,EACtB7J,EAAU6J,GAAoBnzD,EAE9B4zD,EAAqBxwD,YAAc8vD,EACnC5J,EAAU4J,GAAcU,GAIzB7B,iBAAkB,SAAW/xD,GAE5B,GAAIspD,GAAWx7H,KAAKkzE,UACnBkyD,EAAYlzD,EAAQoD,YAEpBiwD,IAAwBvlI,KAAKqkI,iBAE7B0B,EAAoBvK,EAAU+J,EAE/BrzD,GAAQoD,YAAciwD,EACtB/J,EAAU+J,GAAuBrzD,EAEjC6zD,EAAkBzwD,YAAc8vD,EAChC5J,EAAU4J,GAAcW,GAOzBrE,wBAAyB,WAExB,GAAI/sD,GAAe30E,KAAKskI,qBACvBe,EAAkBrlI,KAAKukI,8BACvBvvD,EAAcL,EAAc0wD,EAa7B,OAXqBvkI,UAAhBk0E,IAEJA,EAAc,GAAIlK,IACjB,GAAI/iE,cAAc,GAAK,GAAIA,cAAc,GACzC,EAAG/H,KAAKgmI,kCAEThxD,EAAYixD,aAAeZ,EAC3B1wD,EAAc0wD,GAAoBrwD,GAI5BA,GAIRisD,4BAA6B,SAAWjsD,GAEvC,GAAIL,GAAe30E,KAAKskI,qBACvBc,EAAYpwD,EAAYixD,aAExBV,IAAwBvlI,KAAKukI,4BAE7B2B,EAAwBvxD,EAAc4wD,EAEvCvwD,GAAYixD,aAAeV,EAC3B5wD,EAAc4wD,GAAuBvwD,EAErCkxD,EAAsBD,aAAeb,EACrCzwD,EAAcywD,GAAcc,GAI7BF,iCAAkC,GAAIj+H,cAAc,GAKpDo+H,WAAY,SAAW9xD,EAAM+xD,GAE5B,GAAI7vD,GAAO6vD,GAAgBpmI,KAAKw2E,MAC/B6sD,EAAW9sD,EAAKv0E,KAEhBqkI,EAA6B,gBAAThyD,GACnBpI,GAAcigD,WAAY31C,EAAMlC,GAASA,EAE1CqvD,EAA0B,OAAf2C,EAAsBA,EAAWrkI,KAAOqyE,EAEnDsvD,EAAiB3jI,KAAK4jI,eAAgBF,GACtCN,EAAkB,IAEnB,IAAwBtiI,SAAnB6iI,EAA+B,CAEnC,GAAI2C,GACF3C,EAAegB,aAActB,EAE/B,IAAwBviI,SAAnBwlI,EAEJ,MAAOA,EAMRlD,GAAkBO,EAAeE,aAAc,GAG3B,OAAfwC,IACJA,EAAajD,EAAgB5uD,OAK/B,GAAoB,OAAf6xD,EAAsB,MAAO,KAGlC,IAAIE,GAAY,GAAIpyD,IAAiBn0E,KAAMqmI,EAAYD,EAOvD,OALApmI,MAAKmjI,YAAaoD,EAAWnD,GAG7BpjI,KAAK8jI,mBAAoByC,EAAW7C,EAAUL,GAEvCkD,GAKRD,eAAgB,SAAWjyD,EAAM+xD,GAEhC,GAAI7vD,GAAO6vD,GAAgBpmI,KAAKw2E,MAC/B6sD,EAAW9sD,EAAKv0E,KAEhBqkI,EAA6B,gBAAThyD,GACnBpI,GAAcigD,WAAY31C,EAAMlC,GAASA,EAE1CqvD,EAAW2C,EAAaA,EAAWrkI,KAAOqyE,EAE1CsvD,EAAiB3jI,KAAK4jI,eAAgBF,EAEvC,OAAwB5iI,UAAnB6iI,EAEGA,EAAegB,aAActB,IAAc,KAI5C,MAKRmD,cAAe,WAEd,GAAIhC,GAAUxkI,KAAKmkI,SAClBsC,EAAWzmI,KAAKokI,gBAChB5I,EAAWx7H,KAAKkzE,UAChBwrD,EAAY1+H,KAAKqkI,gBAElBrkI,MAAKokI,gBAAkB,EACvBpkI,KAAKqkI,iBAAmB,CAExB,KAAM,GAAIr0H,GAAI,EAAGA,IAAMy2H,IAAaz2H,EAEnCw0H,EAASx0H,GAAIkS,OAId,KAAM,GAAIlS,GAAI,EAAGA,IAAM0uH,IAAc1uH,EAEpCwrH,EAAUxrH,GAAIyiE,SAAW,CAI1B,OAAOzyE,OAKR0J,OAAQ,SAAWs4H,GAElBA,GAAahiI,KAAK61E,SAYlB,KAAM,GAVF2uD,GAAUxkI,KAAKmkI,SAClBsC,EAAWzmI,KAAKokI,gBAEhB/9H,EAAOrG,KAAKqG,MAAQ27H,EACpBC,EAAgBtvH,KAAKopD,KAAMimE,GAE3BjH,EAAY/6H,KAAK02E,YAAc,EAItB1mE,EAAI,EAAGA,IAAMy2H,IAAaz2H,EAAI,CAEvC,GAAIo/D,GAASo1D,EAASx0H,EAEtBo/D,GAAO2yD,QAAS17H,EAAM27H,EAAWC,EAAelH,GASjD,IAAM,GAHFS,GAAWx7H,KAAKkzE,UACnBwrD,EAAY1+H,KAAKqkI,iBAERr0H,EAAI,EAAGA,IAAM0uH,IAAc1uH,EAEpCwrH,EAAUxrH,GAAIy4B,MAAOsyF,EAItB,OAAO/6H,OAKR8hI,QAAS,WAER,MAAO9hI,MAAKw2E,OAKbkwD,YAAa,SAAWryD,GAEvB,GAAImwD,GAAUxkI,KAAKmkI,SAClBT,EAAWrvD,EAAKryE,KAChB0iI,EAAgB1kI,KAAK4jI,eACrBD,EAAiBe,EAAehB,EAEjC,IAAwB5iI,SAAnB6iI,EAA+B,CAQnC,IAAM,GAFFgD,GAAkBhD,EAAeE,aAE3B7zH,EAAI,EAAGgU,EAAI2iH,EAAgBvmI,OAAQ4P,IAAMgU,IAAMhU,EAAI,CAE5D,GAAIo/D,GAASu3D,EAAiB32H,EAE9BhQ,MAAK2/H,kBAAmBvwD,EAExB,IAAI01D,GAAa11D,EAAOkG,YACvBuvD,EAAqBL,EAASA,EAAQpkI,OAAS,EAEhDgvE,GAAOkG,YAAc,KACrBlG,EAAOmG,kBAAoB,KAE3BsvD,EAAmBvvD,YAAcwvD,EACjCN,EAASM,GAAeD,EACxBL,EAAQhvG,MAERx1B,KAAKklI,iCAAkC91D,SAIjCs1D,GAAehB,KAOxBkD,YAAa,SAAWrwD,GAEvB,GAAI8sD,GAAW9sD,EAAKv0E,KACnB0iI,EAAgB1kI,KAAK4jI,cAEtB,KAAM,GAAIF,KAAYgB,GAAgB,CAErC,GAAIC,GAAeD,EAAehB,GAAWiB,aAC5Cv1D,EAASu1D,EAActB,EAERviI,UAAXsuE,IAEJpvE,KAAK2/H,kBAAmBvwD,GACxBpvE,KAAK4kI,sBAAuBx1D,IAM9B,GAAIk0D,GAAiBtjI,KAAKujI,uBACzBkC,EAAgBnC,EAAgBD,EAEjC,IAAuBviI,SAAlB2kI,EAEJ,IAAM,GAAI5Y,KAAa4Y,GAAgB,CAEtC,GAAIvzD,GAAUuzD,EAAe5Y,EAC7B36C,GAAQmpD,uBACRr7H,KAAKmlI,uBAAwBjzD,KAShC20D,cAAe,SAAWxyD,EAAM+xD,GAE/B,GAAIh3D,GAASpvE,KAAKsmI,eAAgBjyD,EAAM+xD,EAExB,QAAXh3D,IAEJpvE,KAAK2/H,kBAAmBvwD,GACxBpvE,KAAK4kI,sBAAuBx1D,OAyB/BuH,GAAQlD,UAAU5oE,MAAQ,WAEzB,MAAO,IAAI8rE,IAA8B71E,SAArBd,KAAK8B,MAAM+I,MAAsB7K,KAAK8B,MAAQ9B,KAAK8B,MAAM+I,UAiB9E+rE,GAAwBnD,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQ/gF,EAAeujE,YAEhFlJ,YAAaqM,GAEbr4B,2BAA2B,EAE3B3/B,KAAM,SAAW8/D,GAMhB,MAJAxuE,GAAeujE,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAE1C1+E,KAAKwb,kBAAoBkjE,EAAOljE,kBAEzBxb,MAIR6K,MAAO,WAEN,OAAO,GAAI7K,MAAKuqE,aAAc3rD,KAAM5e,SAkBtC62E,GAA2BpD,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQ7kC,GAAkBqnB,YAEtFlJ,YAAasM,GAEbh4B,8BAA8B,EAE9BjgC,KAAM,SAAW8/D,GAMhB,MAJAtyB,IAAkBqnB,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAE7C1+E,KAAK4jC,iBAAmB86C,EAAO96C,iBAExB5jC,QAkBT82E,GAAyBrD,UAAY7xE,OAAO48E,OAAQ58E,OAAOqvF,OAAQriF,EAAgB6kE,YAElFlJ,YAAauM,GAEb/3B,4BAA4B,EAE5BngC,KAAM,SAAW8/D,GAMhB,MAJA9vE,GAAgB6kE,UAAU70D,KAAKta,KAAMtE,KAAM0+E,GAE3C1+E,KAAK4jC,iBAAmB86C,EAAO96C,iBAExB5jC,QAmET4B,OAAO48E,OAAQzH,GAAUtD,WAExB0pC,cAAe,EAEfl3G,IAAK,SAAWgS,EAAQC,GAIvBlY,KAAKg3E,IAAI/wE,IAAKgS,EAAQC,IAIvB4uH,cAAe,SAAWC,EAAQ7tH,GAE1BA,GAAUA,EAAOgiG,qBAEvBl7G,KAAKg3E,IAAI/+D,OAAOkgB,sBAAuBjf,EAAO7N,aAC9CrL,KAAKg3E,IAAI9+D,UAAUjS,IAAK8gI,EAAOjnI,EAAGinI,EAAOhnI,EAAG,IAAMk+E,UAAW/kE,GAASmf,IAAKr4B,KAAKg3E,IAAI/+D,QAAS0hB,aAEhFzgB,GAAUA,EAAOo0F,sBAE9BttG,KAAKg3E,IAAI/+D,OAAOhS,IAAK8gI,EAAOjnI,EAAGinI,EAAOhnI,GAAKmZ,EAAO1M,KAAO0M,EAAOzM,MAAUyM,EAAO1M,KAAO0M,EAAOzM,MAAQwxE,UAAW/kE,GAClHlZ,KAAKg3E,IAAI9+D,UAAUjS,IAAK,EAAG,MAASqyB,mBAAoBpf,EAAO7N,cAI/DhL,QAAQC,MAAO,8CAMjB+2E,gBAAiB,SAAW72D,EAAQ+2D,EAAWyrC,GAE9C,GAAIlsD,GAAaksD,KAMjB,OAJA3rC,IAAiB72D,EAAQxgB,KAAM82D,EAAYygB,GAE3CzgB,EAAW/zC,KAAMq0D,IAEVtgB,GAIRkwE,iBAAkB,SAAWluH,EAASy+D,EAAWyrC,GAEhD,GAAIlsD,GAAaksD,KAEjB,IAAK51G,MAAMC,QAASyL,MAAc,EAGjC,MADAzY,SAAQ4H,KAAM,8DACP6uD,CAIR,KAAM,GAAI9mD,GAAI,EAAGC,EAAI6I,EAAQ1Y,OAAQ4P,EAAIC,EAAGD,IAE3CqnE,GAAiBv+D,EAAS9I,GAAKhQ,KAAM82D,EAAYygB,EAMlD,OAFAzgB,GAAW/zC,KAAMq0D,IAEVtgB,KAsBTl1D,OAAO48E,OAAQ/G,GAAMhE,WAEpB9sE,MAAO,WAEN3G,KAAKixE,WAAqC,mBAAhBg2D,aAA8BC,KAAOD,aAAcxF,MAE7EzhI,KAAK23E,QAAU33E,KAAKixE,UACpBjxE,KAAK43E,YAAc,EACnB53E,KAAK63E,SAAU,GAIhBjxE,KAAM,WAEL5G,KAAKmnI,iBACLnnI,KAAK63E,SAAU,EACf73E,KAAK03E,WAAY,GAIlByvD,eAAgB,WAGf,MADAnnI,MAAKonI,WACEpnI,KAAK43E,aAIbwvD,SAAU,WAET,GAAIx2B,GAAO,CAEX,IAAK5wG,KAAK03E,YAAe13E,KAAK63E,QAG7B,MADA73E,MAAK2G,QACE,CAIR,IAAK3G,KAAK63E,QAAU,CAEnB,GAAIwvD,IAAmC,mBAAhBJ,aAA8BC,KAAOD,aAAcxF,KAE1E7wB,IAASy2B,EAAUrnI,KAAK23E,SAAY,IACpC33E,KAAK23E,QAAU0vD,EAEfrnI,KAAK43E,aAAeg5B,EAIrB,MAAOA,MA0BThvG,OAAO48E,OAAQ1G,GAAUrE,WAExBxtE,IAAK,SAAWhB,EAAQo8D,EAAK4B,GAM5B,MAJAjjE,MAAKiF,OAASA,EACdjF,KAAKqhE,IAAMA,EACXrhE,KAAKijE,MAAQA,EAENjjE,MAIR6K,MAAO,WAEN,OAAO,GAAI7K,MAAKuqE,aAAc3rD,KAAM5e,OAIrC4e,KAAM,SAAW0oH,GAMhB,MAJAtnI,MAAKiF,OAASqiI,EAAMriI,OACpBjF,KAAKqhE,IAAMimE,EAAMjmE,IACjBrhE,KAAKijE,MAAQqkE,EAAMrkE,MAEZjjE,MAKRunI,SAAU,WAET,GAAIl4E,GAAM,IAGV,OAFArvD,MAAKqhE,IAAM1uD,KAAK7N,IAAKuqD,EAAK18C,KAAK9N,IAAK8N,KAAKi+C,GAAKvB,EAAKrvD,KAAKqhE,MAEjDrhE,MAIR6qG,eAAgB,SAAW15F,GAE1B,MAAOnR,MAAKwnI,uBAAwBr2H,EAAErR,EAAGqR,EAAEpR,EAAGoR,EAAE3Q,IAIjDgnI,uBAAwB,SAAW1nI,EAAGC,EAAGS,GAgBxC,MAdAR,MAAKiF,OAAS0N,KAAKmwC,KAAMhjD,EAAIA,EAAIC,EAAIA,EAAIS,EAAIA,GAExB,IAAhBR,KAAKiF,QAETjF,KAAKijE,MAAQ,EACbjjE,KAAKqhE,IAAM,IAIXrhE,KAAKijE,MAAQtwD,KAAKg/C,MAAO7xD,EAAGU,GAC5BR,KAAKqhE,IAAM1uD,KAAKm7E,KAAM7rF,GAAMi/D,MAAOnhE,EAAIC,KAAKiF,UAAa,KAInDjF,QAuBT4B,OAAO48E,OAAQzG,GAAYtE,WAE1BxtE,IAAK,SAAWhB,EAAQg+D,EAAOljE,GAM9B,MAJAC,MAAKiF,OAASA,EACdjF,KAAKijE,MAAQA,EACbjjE,KAAKD,EAAIA,EAEFC,MAIR6K,MAAO,WAEN,OAAO,GAAI7K,MAAKuqE,aAAc3rD,KAAM5e,OAIrC4e,KAAM,SAAW0oH,GAMhB,MAJAtnI,MAAKiF,OAASqiI,EAAMriI,OACpBjF,KAAKijE,MAAQqkE,EAAMrkE,MACnBjjE,KAAKD,EAAIunI,EAAMvnI,EAERC,MAIR6qG,eAAgB,SAAW15F,GAE1B,MAAOnR,MAAKwnI,uBAAwBr2H,EAAErR,EAAGqR,EAAEpR,EAAGoR,EAAE3Q,IAIjDgnI,uBAAwB,SAAW1nI,EAAGC,EAAGS,GAMxC,MAJAR,MAAKiF,OAAS0N,KAAKmwC,KAAMhjD,EAAIA,EAAIU,EAAIA,GACrCR,KAAKijE,MAAQtwD,KAAKg/C,MAAO7xD,EAAGU,GAC5BR,KAAKD,EAAIA,EAEFC,QAiBT4B,OAAO48E,OAAQxG,GAAKvE,WAEnBxtE,IAAK,SAAWpB,EAAKC,GAKpB,MAHA9E,MAAK6E,IAAI+Z,KAAM/Z,GACf7E,KAAK8E,IAAI8Z,KAAM9Z,GAER9E,MAIRopE,cAAe,SAAWnnD,GAEzBjiB,KAAKoyF,WAEL,KAAM,GAAIpiF,GAAI,EAAGyuB,EAAKxc,EAAO7hB,OAAQ4P,EAAIyuB,EAAIzuB,IAE5ChQ,KAAKqyF,cAAepwE,EAAQjS,GAI7B,OAAOhQ,OAIRsyF,qBAAsB,WAErB,GAAI1qB,GAAK,GAAI/nE,EAEb,OAAO,UAA+BiD,EAAQmkB,GAE7C,GAAI2yD,GAAWhS,EAAGhpD,KAAMqI,GAAOiR,eAAgB,GAI/C,OAHAl4B,MAAK6E,IAAI+Z,KAAM9b,GAASu1B,IAAKuhD,GAC7B55E,KAAK8E,IAAI8Z,KAAM9b,GAASu8B,IAAKu6C,GAEtB55E,SAMT6K,MAAO,WAEN,OAAO,GAAI7K,MAAKuqE,aAAc3rD,KAAM5e,OAIrC4e,KAAM,SAAWo8D,GAKhB,MAHAh7E,MAAK6E,IAAI+Z,KAAMo8D,EAAIn2E,KACnB7E,KAAK8E,IAAI8Z,KAAMo8D,EAAIl2E,KAEZ9E,MAIRoyF,UAAW,WAKV,MAHApyF,MAAK6E,IAAI/E,EAAIE,KAAK6E,IAAI9E,IAAMgF,EAAAA,GAC5B/E,KAAK8E,IAAIhF,EAAIE,KAAK8E,IAAI/E,IAAMgF,EAAAA,GAErB/E,MAIRwyF,QAAS,WAIR,MAASxyF,MAAK8E,IAAIhF,EAAIE,KAAK6E,IAAI/E,GAASE,KAAK8E,IAAI/E,EAAIC,KAAK6E,IAAI9E,GAI/D0yF,UAAW,SAAWxyE,GASrB,MAPgBnf,UAAXmf,IAEJ5f,QAAQ4H,KAAM,mDACdgY,EAAS,GAAIpgB,IAIPG,KAAKwyF,UAAYvyE,EAAOha,IAAK,EAAG,GAAMga,EAAOs0C,WAAYv0D,KAAK6E,IAAK7E,KAAK8E,KAAMozB,eAAgB,KAItGkf,QAAS,SAAWn3B,GASnB,MAPgBnf,UAAXmf,IAEJ5f,QAAQ4H,KAAM,iDACdgY,EAAS,GAAIpgB,IAIPG,KAAKwyF,UAAYvyE,EAAOha,IAAK,EAAG,GAAMga,EAAOwvC,WAAYzvD,KAAK8E,IAAK9E,KAAK6E,MAIhFwtF,cAAe,SAAW59D,GAKzB,MAHAz0B,MAAK6E,IAAIA,IAAK4vB,GACdz0B,KAAK8E,IAAIA,IAAK2vB,GAEPz0B,MAIR0yF,eAAgB,SAAWvgF,GAK1B,MAHAnS,MAAK6E,IAAIwzB,IAAKlmB,GACdnS,KAAK8E,IAAIu6B,IAAKltB,GAEPnS,MAIR2yF,eAAgB,SAAW3Q,GAK1B,MAHAhiF,MAAK6E,IAAIw9E,WAAaL,GACtBhiF,KAAK8E,IAAIu9E,UAAWL,GAEbhiF,MAIR4yF,cAAe,SAAWn+D,GAEzB,QAAOA,EAAM30B,EAAIE,KAAK6E,IAAI/E,GAAK20B,EAAM30B,EAAIE,KAAK8E,IAAIhF,GACjD20B,EAAM10B,EAAIC,KAAK6E,IAAI9E,GAAK00B,EAAM10B,EAAIC,KAAK8E,IAAI/E,IAI7C8yF,YAAa,SAAW7X,GAEvB,MAAOh7E,MAAK6E,IAAI/E,GAAKk7E,EAAIn2E,IAAI/E,GAAKk7E,EAAIl2E,IAAIhF,GAAKE,KAAK8E,IAAIhF,GACvDE,KAAK6E,IAAI9E,GAAKi7E,EAAIn2E,IAAI9E,GAAKi7E,EAAIl2E,IAAI/E,GAAKC,KAAK8E,IAAI/E,GAInD6b,aAAc,SAAW6Y,EAAOxU,GAY/B,MAPgBnf,UAAXmf,IAEJ5f,QAAQ4H,KAAM,sDACdgY,EAAS,GAAIpgB,IAIPogB,EAAOha,KACXwuB,EAAM30B,EAAIE,KAAK6E,IAAI/E,IAAQE,KAAK8E,IAAIhF,EAAIE,KAAK6E,IAAI/E,IACjD20B,EAAM10B,EAAIC,KAAK6E,IAAI9E,IAAQC,KAAK8E,IAAI/E,EAAIC,KAAK6E,IAAI9E,KAKrD+yF,cAAe,SAAW9X,GAIzB,QAAOA,EAAIl2E,IAAIhF,EAAIE,KAAK6E,IAAI/E,GAAKk7E,EAAIn2E,IAAI/E,EAAIE,KAAK8E,IAAIhF,GACrDk7E,EAAIl2E,IAAI/E,EAAIC,KAAK6E,IAAI9E,GAAKi7E,EAAIn2E,IAAI9E,EAAIC,KAAK8E,IAAI/E,IAIjDmzF,WAAY,SAAWz+D,EAAOxU,GAS7B,MAPgBnf,UAAXmf,IAEJ5f,QAAQ4H,KAAM,oDACdgY,EAAS,GAAIpgB,IAIPogB,EAAOrB,KAAM6V,GAAQysC,MAAOlhE,KAAK6E,IAAK7E,KAAK8E,MAInDgvF,gBAAiB,WAEhB,GAAIlsB,GAAK,GAAI/nE,EAEb,OAAO,UAA0B40B,GAEhC,GAAIs/D,GAAensB,EAAGhpD,KAAM6V,GAAQysC,MAAOlhE,KAAK6E,IAAK7E,KAAK8E,IAC1D,OAAOivF,GAAa17D,IAAK5D,GAAQr0B,aAMnC6zF,UAAW,SAAWjZ,GAKrB,MAHAh7E,MAAK6E,IAAIC,IAAKk2E,EAAIn2E,KAClB7E,KAAK8E,IAAID,IAAKm2E,EAAIl2E,KAEX9E,MAIRk0F,MAAO,SAAWlZ,GAKjB,MAHAh7E,MAAK6E,IAAIA,IAAKm2E,EAAIn2E,KAClB7E,KAAK8E,IAAIA,IAAKk2E,EAAIl2E,KAEX9E,MAIR07E,UAAW,SAAW94E,GAKrB,MAHA5C,MAAK6E,IAAIw6B,IAAKz8B,GACd5C,KAAK8E,IAAIu6B,IAAKz8B,GAEP5C,MAIRkgC,OAAQ,SAAW86C,GAElB,MAAOA,GAAIn2E,IAAIq7B,OAAQlgC,KAAK6E,MAASm2E,EAAIl2E,IAAIo7B,OAAQlgC,KAAK8E,QAiB5DlD,OAAO48E,OAAQvG,GAAMxE,WAEpBxtE,IAAK,SAAWU,EAAOomB,GAKtB,MAHA/sB,MAAK2G,MAAMiY,KAAMjY,GACjB3G,KAAK+sB,IAAInO,KAAMmO,GAER/sB,MAIR6K,MAAO,WAEN,OAAO,GAAI7K,MAAKuqE,aAAc3rD,KAAM5e,OAIrC4e,KAAM,SAAWy6D,GAKhB,MAHAr5E,MAAK2G,MAAMiY,KAAMy6D,EAAK1yE,OACtB3G,KAAK+sB,IAAInO,KAAMy6D,EAAKtsD,KAEb/sB,MAIRyyF,UAAW,SAAWxyE,GASrB,MAPgBnf,UAAXmf,IAEJ5f,QAAQ4H,KAAM,oDACdgY,EAAS,GAAIlf,IAIPkf,EAAOs0C,WAAYv0D,KAAK2G,MAAO3G,KAAK+sB,KAAMmL,eAAgB,KAIlE88D,MAAO,SAAW/0E,GASjB,MAPgBnf,UAAXmf,IAEJ5f,QAAQ4H,KAAM,gDACdgY,EAAS,GAAIlf,IAIPkf,EAAOwvC,WAAYzvD,KAAK+sB,IAAK/sB,KAAK2G,QAI1C8gI,WAAY,WAEX,MAAOznI,MAAK2G,MAAMy8E,kBAAmBpjF,KAAK+sB,MAI3C+J,SAAU,WAET,MAAO92B,MAAK2G,MAAMw8E,WAAYnjF,KAAK+sB,MAIpCqoF,GAAI,SAAWhjD,EAAGnyC,GASjB,MAPgBnf,UAAXmf,IAEJ5f,QAAQ4H,KAAM,6CACdgY,EAAS,GAAIlf,IAIPf,KAAKg1F,MAAO/0E,GAASiY,eAAgBk6B,GAAI/yB,IAAKr/B,KAAK2G,QAI3D+gI,6BAA8B,WAE7B,GAAIC,GAAS,GAAI5mI,GACb6mI,EAAW,GAAI7mI,EAEnB,OAAO,UAAuC0zB,EAAOozG,GAEpDF,EAAOl4E,WAAYh7B,EAAOz0B,KAAK2G,OAC/BihI,EAASn4E,WAAYzvD,KAAK+sB,IAAK/sB,KAAK2G,MAEpC,IAAImhI,GAAYF,EAASplE,IAAKolE,GAC1BG,EAAkBH,EAASplE,IAAKmlE,GAEhCv1E,EAAI21E,EAAkBD,CAQ1B,OANKD,KAEJz1E,EAAInwD,GAAMi/D,MAAO9O,EAAG,EAAG,IAIjBA,MAMTkjD,oBAAqB,SAAW7gF,EAAOozG,EAAa5nH,GAEnD,GAAImyC,GAAIpyD,KAAK0nI,6BAA8BjzG,EAAOozG,EASlD,OAPgB/mI,UAAXmf,IAEJ5f,QAAQ4H,KAAM,8DACdgY,EAAS,GAAIlf,IAIPf,KAAKg1F,MAAO/0E,GAASiY,eAAgBk6B,GAAI/yB,IAAKr/B,KAAK2G,QAI3DkY,aAAc,SAAW5b,GAKxB,MAHAjD,MAAK2G,MAAMkY,aAAc5b,GACzBjD,KAAK+sB,IAAIlO,aAAc5b,GAEhBjD,MAIRkgC,OAAQ,SAAWm5C,GAElB,MAAOA,GAAK1yE,MAAMu5B,OAAQlgC,KAAK2G,QAAW0yE,EAAKtsD,IAAImT,OAAQlgC,KAAK+sB,QAmBlEmrD,GAAsBzE,UAAY7xE,OAAOqvF,OAAQ/mF,EAASupE,WAC1DyE,GAAsBzE,UAAUlJ,YAAc2N,GAE9CA,GAAsBzE,UAAU5zB,yBAA0B,EAmD1Ds4B,GAAoB1E,UAAY7xE,OAAOqvF,OAAQvjC,GAAa+lB,WAC5D0E,GAAoB1E,UAAUlJ,YAAc4N,GAE5CA,GAAoB1E,UAAU/pE,OAAW,WAExC,GAAIk+D,GAAK,GAAI7mE,GACTwnE,EAAK,GAAIxnE,GACTqK,EAAe,GAAIpK,EAEvB,OAAO,YAEN,GAAI2tD,IAAS,IAAK,IAAK,IAEvB3uD,MAAKwgB,OAAOye,mBAAmB,GAE/B7zB,EAAaqT,gBAAiBze,KAAKwgB,OAAOnV,YAE1C,IAAIA,GAAcrL,KAAKwgB,OAAOnV,YAE1BP,EAAW9K,KAAKqY,SAAShI,WAAWvF,SAIpCwtE,EAAct4E,KAAKwgB,OAAOnI,QAE9B,IAAKigE,GAAeA,EAAY33D,WAQ/B,IAAM,GANFjT,GAAW4qE,EAAY5qE,SAEvBE,EAAQ0qE,EAAY1qE,MAEpB+iG,EAAM,EAEA3gG,EAAI,EAAGC,EAAIrC,EAAMxN,OAAQ4P,EAAIC,EAAGD,IAIzC,IAAM,GAFFovB,GAAOxxB,EAAOoC,GAERy9B,EAAI,EAAGC,EAAKtO,EAAKjyB,cAAc/M,OAAQqtC,EAAIC,EAAID,IAAO,CAE/D,GAAI+gB,GAAS9gD,EAAU0xB,EAAMuvB,EAAMlhB,KAE/BtoC,EAASi6B,EAAKjyB,cAAesgC,EAEjCm6B,GAAGhpD,KAAM4vC,GAAS3vC,aAAcxT,GAEhCk9D,EAAG3pD,KAAMzZ,GAASs9E,aAAcr3E,GAAeuuB,YAAYzB,eAAgBl4B,KAAKinB,MAAOoY,IAAKuoC,GAE5F98D,EAAS89E,OAAQ+nB,EAAK/oC,EAAG9nE,EAAG8nE,EAAG7nE,EAAG6nE,EAAGpnE,GAErCmwG,GAAY,EAEZ7lG,EAAS89E,OAAQ+nB,EAAKpoC,EAAGzoE,EAAGyoE,EAAGxoE,EAAGwoE,EAAG/nE,GAErCmwG,GAAY,MAMR,IAAKr4B,GAAeA,EAAY53D,iBAUtC,IAAM,GARFsnH,GAAS1vD,EAAYjoE,WAAWvF,SAEhCm9H,EAAU3vD,EAAYjoE,WAAWlL,OAEjCwrG,EAAM,EAIAljE,EAAI,EAAGC,EAAKs6F,EAAO9+H,MAAOukC,EAAIC,EAAID,IAE3Cm6B,EAAG3hE,IAAK+hI,EAAOl5E,KAAMrhB,GAAKu6F,EAAOvkD,KAAMh2C,GAAKu6F,EAAOr/C,KAAMl7C,IAAM5uB,aAAcxT,GAE7Ek9D,EAAGtiE,IAAKgiI,EAAQn5E,KAAMrhB,GAAKw6F,EAAQxkD,KAAMh2C,GAAKw6F,EAAQt/C,KAAMl7C,IAE5D86B,EAAGka,aAAcr3E,GAAeuuB,YAAYzB,eAAgBl4B,KAAKinB,MAAOoY,IAAKuoC,GAE7E98D,EAAS89E,OAAQ+nB,EAAK/oC,EAAG9nE,EAAG8nE,EAAG7nE,EAAG6nE,EAAGpnE,GAErCmwG,GAAY,EAEZ7lG,EAAS89E,OAAQ+nB,EAAKpoC,EAAGzoE,EAAGyoE,EAAGxoE,EAAGwoE,EAAG/nE,GAErCmwG,GAAY,CAMd7lG,GAAS6K,aAAc,MAyDzB6iE,GAAgB/E,UAAY7xE,OAAOqvF,OAAQ/mF,EAASupE,WACpD+E,GAAgB/E,UAAUlJ,YAAciO,GAExCA,GAAgB/E,UAAUnwD,QAAU,WAEnCtjB,KAAKy4E,KAAKpgE,SAASiL,UACnBtjB,KAAKy4E,KAAKngE,SAASgL,WAIpBk1D,GAAgB/E,UAAU/pE,OAAS,WAElC,GAAIyI,GAAS,GAAIpR,GACb48D,EAAU,GAAI58D,EAElB,OAAO,YAENf,KAAKy2B,MAAMwI,mBAEX,IAAIipG,GAAaloI,KAAKy2B,MAAMK,SAAW92B,KAAKy2B,MAAMK,SAAW,IACzDqxG,EAAYD,EAAav1H,KAAKqlD,IAAKh4D,KAAKy2B,MAAMoC,MAElD74B,MAAKy4E,KAAK1tE,MAAM9E,IAAKkiI,EAAWA,EAAWD,GAE3C/1H,EAAOgmB,sBAAuBn4B,KAAKy2B,MAAMprB,aACzCsyD,EAAQxlC,sBAAuBn4B,KAAKy2B,MAAMxW,OAAO5U,aAEjDrL,KAAKy4E,KAAKz5C,OAAQ2+B,EAAQtlC,IAAKlmB,IAEXrR,SAAfd,KAAKgN,MAEThN,KAAKy4E,KAAKngE,SAAStL,MAAM/G,IAAKjG,KAAKgN,OAInChN,KAAKy4E,KAAKngE,SAAStL,MAAM4R,KAAM5e,KAAKy2B,MAAMzpB,WA8E7C6rE,GAAepF,UAAY7xE,OAAOqvF,OAAQvjC,GAAa+lB,WACvDoF,GAAepF,UAAUlJ,YAAcsO,GAEvCA,GAAepF,UAAUx0C,kBAAoB,WAE5C,GAAI9sB,GAAS,GAAIpR,GAEbqnI,EAAa,GAAInoI,GACjBooI,EAAiB,GAAIpoI,EAEzB,OAAO,UAA4B6sG,GAElC,GAAI36E,GAAQnyB,KAAKmyB,MAEb9Z,EAAWrY,KAAKqY,SAChBvN,EAAWuN,EAASmhE,aAAc,WAEtC6uD,GAAe9tF,WAAYv6C,KAAKu2E,KAAKlrE,YAErC,KAAM,GAAI2E,GAAI,EAAGy9B,EAAI,EAAGz9B,EAAImiB,EAAM/xB,OAAQ4P,IAAO,CAEhD,GAAIgpE,GAAO7mD,EAAOniB,EAEbgpE,GAAKvuE,QAAUuuE,EAAKvuE,OAAOmuE,SAE/BwvD,EAAWtrG,iBAAkBurG,EAAgBrvD,EAAK3tE,aAClD8G,EAAOgmB,sBAAuBiwG,GAC9Bt9H,EAAS89E,OAAQn7C,EAAGt7B,EAAOrS,EAAGqS,EAAOpS,EAAGoS,EAAO3R,GAE/C4nI,EAAWtrG,iBAAkBurG,EAAgBrvD,EAAKvuE,OAAOY,aACzD8G,EAAOgmB,sBAAuBiwG,GAC9Bt9H,EAAS89E,OAAQn7C,EAAI,EAAGt7B,EAAOrS,EAAGqS,EAAOpS,EAAGoS,EAAO3R,GAEnDitC,GAAK,GAMPp1B,EAASmhE,aAAc,YAAa7jE,aAAc,EAElDzL,EAASupE,UAAUx0C,kBAAkB36B,KAAMtE,KAAM8sG,OAqDnD5zB,GAAiBzF,UAAY7xE,OAAOqvF,OAAQ74E,EAAKq7D,WACjDyF,GAAiBzF,UAAUlJ,YAAc2O,GAEzCA,GAAiBzF,UAAUnwD,QAAU,WAEpCtjB,KAAKqY,SAASiL,UACdtjB,KAAKsY,SAASgL,WAIf41D,GAAiBzF,UAAU/pE,OAAS,WAEf5I,SAAfd,KAAKgN,MAEThN,KAAKsY,SAAStL,MAAM/G,IAAKjG,KAAKgN,OAI9BhN,KAAKsY,SAAStL,MAAM4R,KAAM5e,KAAKy2B,MAAMzpB,QAqDvCosE,GAAoB3F,UAAY7xE,OAAOqvF,OAAQ/mF,EAASupE,WACxD2F,GAAoB3F,UAAUlJ,YAAc6O,GAE5CA,GAAoB3F,UAAUnwD,QAAU,WAEvCtjB,KAAK0K,SAAU,GAAI2N,SAASiL,UAC5BtjB,KAAK0K,SAAU,GAAI4N,SAASgL,WAI7B81D,GAAoB3F,UAAU/pE,OAAS,WAItC,GAAImuD,GAAwB,GAAnB73D,KAAKy2B,MAAM9yB,MAChBm0D,EAAyB,GAApB93D,KAAKy2B,MAAM7yB,OAEhBkH,EAAW9K,KAAKq5E,KAAKhhE,SAAShI,WAAWvF,SACzCzD,EAAQyD,EAASzD,KAIrBA,GAAO,GAAMwwD,EAAIxwD,EAAO,IAAQywD,EAAIzwD,EAAO,GAAM,EACjDA,EAAO,GAAMwwD,EAAIxwD,EAAO,GAAMywD,EAAIzwD,EAAO,GAAM,EAC/CA,EAAO,IAAQwwD,EAAIxwD,EAAO,GAAMywD,EAAIzwD,EAAO,GAAM,EACjDA,EAAO,IAAQwwD,EAAIxwD,EAAO,KAASywD,EAAIzwD,EAAO,IAAO,EACrDA,EAAO,IAAOwwD,EAAIxwD,EAAO,KAASywD,EAAIzwD,EAAO,IAAO,EAEpDyD,EAAS6K,aAAc,EAEH7U,SAAfd,KAAKgN,MAEThN,KAAKq5E,KAAK/gE,SAAStL,MAAM/G,IAAKjG,KAAKgN,OAInChN,KAAKq5E,KAAK/gE,SAAStL,MAAM4R,KAAM5e,KAAKy2B,MAAMzpB,QAyC5CssE,GAAsB7F,UAAY7xE,OAAOqvF,OAAQ/mF,EAASupE,WAC1D6F,GAAsB7F,UAAUlJ,YAAc+O,GAE9CA,GAAsB7F,UAAUnwD,QAAU,WAEzCtjB,KAAK0K,SAAU,GAAI2N,SAASiL,UAC5BtjB,KAAK0K,SAAU,GAAI4N,SAASgL,WAI7Bg2D,GAAsB7F,UAAU/pE,OAAS,WAExC,GAAIyI,GAAS,GAAIpR,GAEb+3E,EAAS,GAAIjzE,GACbkzE,EAAS,GAAIlzE,EAEjB,OAAO,YAEN,GAAIwqG,GAAOrwG,KAAK0K,SAAU,EAE1B,IAAoB5J,SAAfd,KAAKgN,MAEThN,KAAKsY,SAAStL,MAAM/G,IAAKjG,KAAKgN,WAExB,CAEN,GAAIW,GAAS0iG,EAAKh4F,SAASmhE,aAAc,QAEzCV,GAAOl6D,KAAM5e,KAAKy2B,MAAMzpB,OACxB+rE,EAAOn6D,KAAM5e,KAAKy2B,MAAMY,YAExB,KAAM,GAAIrnB,GAAI,EAAGC,EAAItC,EAAOzE,MAAO8G,EAAIC,EAAGD,IAAO,CAEhD,GAAIhD,GAAUgD,EAAMC,EAAI,EAAQ6oE,EAASC,CAEzCprE,GAAOi7E,OAAQ54E,EAAGhD,EAAMlH,EAAGkH,EAAMjH,EAAGiH,EAAMhH,GAI3C2H,EAAOgI,aAAc,EAItB06F,EAAKrxE,OAAQ7sB,EAAOgmB,sBAAuBn4B,KAAKy2B,MAAMprB,aAAck7C,cA+CtEkzB,GAAWhG,UAAY7xE,OAAOqvF,OAAQvjC,GAAa+lB,WACnDgG,GAAWhG,UAAUlJ,YAAckP,GAsFnCI,GAAgBpG,UAAY7xE,OAAOqvF,OAAQvjC,GAAa+lB,WACxDoG,GAAgBpG,UAAUlJ,YAAcsP,GAoDxCG,GAAkBvG,UAAY7xE,OAAOqvF,OAAQvjC,GAAa+lB,WAC1DuG,GAAkBvG,UAAUlJ,YAAcyP,GAE1CA,GAAkBvG,UAAU/pE,OAAW,WAEtC,GAAIk+D,GAAK,GAAI7mE,GACTwnE,EAAK,GAAIxnE,GACTqK,EAAe,GAAIpK,EAEvB,OAAO,YAENhB,KAAKwgB,OAAOye,mBAAmB,GAE/B7zB,EAAaqT,gBAAiBze,KAAKwgB,OAAOnV,YAgB1C,KAAM,GAdFA,GAAcrL,KAAKwgB,OAAOnV,YAE1BP,EAAW9K,KAAKqY,SAAShI,WAAWvF,SAIpCwtE,EAAct4E,KAAKwgB,OAAOnI,SAE1B3K,EAAW4qE,EAAY5qE,SAEvBE,EAAQ0qE,EAAY1qE,MAEpB+iG,EAAM,EAEA3gG,EAAI,EAAGC,EAAIrC,EAAMxN,OAAQ4P,EAAIC,EAAGD,IAAO,CAEhD,GAAIovB,GAAOxxB,EAAOoC,GAEd7K,EAASi6B,EAAKj6B,MAElByiE,GAAGhpD,KAAMlR,EAAU0xB,EAAKtyB,IACtBuyB,IAAK3xB,EAAU0xB,EAAKp5B,IACpBq5B,IAAK3xB,EAAU0xB,EAAKryB,IACpBykD,aAAc,GACd3yC,aAAcxT,GAEhBk9D,EAAG3pD,KAAMzZ,GAASs9E,aAAcr3E,GAAeuuB,YAAYzB,eAAgBl4B,KAAKinB,MAAOoY,IAAKuoC,GAE5F98D,EAAS89E,OAAQ+nB,EAAK/oC,EAAG9nE,EAAG8nE,EAAG7nE,EAAG6nE,EAAGpnE,GAErCmwG,GAAY,EAEZ7lG,EAAS89E,OAAQ+nB,EAAKpoC,EAAGzoE,EAAGyoE,EAAGxoE,EAAGwoE,EAAG/nE,GAErCmwG,GAAY,EAIb7lG,EAAS6K,aAAc,MAkDzBskE,GAAuBxG,UAAY7xE,OAAOqvF,OAAQ/mF,EAASupE,WAC3DwG,GAAuBxG,UAAUlJ,YAAc0P,GAE/CA,GAAuBxG,UAAUnwD,QAAU,WAE1CtjB,KAAKk6E,WAAW7hE,SAASiL,UACzBtjB,KAAKk6E,WAAW5hE,SAASgL,UACzBtjB,KAAKm6E,WAAW9hE,SAASiL,UACzBtjB,KAAKm6E,WAAW7hE,SAASgL,WAI1B22D,GAAuBxG,UAAU/pE,OAAS,WAEzC,GAAIk+D,GAAK,GAAI7mE,GACTwnE,EAAK,GAAIxnE,GACTynE,EAAK,GAAIznE,EAEb,OAAO,YAEN6mE,EAAGzvC,sBAAuBn4B,KAAKy2B,MAAMprB,aACrCk9D,EAAGpwC,sBAAuBn4B,KAAKy2B,MAAMxW,OAAO5U,aAC5Cm9D,EAAG/Y,WAAY8Y,EAAIX,GAEnB5nE,KAAKk6E,WAAWl7C,OAAQwpC,GAEJ1nE,SAAfd,KAAKgN,OAEThN,KAAKk6E,WAAW5hE,SAAStL,MAAM/G,IAAKjG,KAAKgN,OACzChN,KAAKm6E,WAAW7hE,SAAStL,MAAM/G,IAAKjG,KAAKgN,SAIzChN,KAAKk6E,WAAW5hE,SAAStL,MAAM4R,KAAM5e,KAAKy2B,MAAMzpB,OAChDhN,KAAKm6E,WAAW7hE,SAAStL,MAAM4R,KAAM5e,KAAKy2B,MAAMzpB,QAIjDhN,KAAKm6E,WAAWn7C,OAAQwpC,GACxBxoE,KAAKm6E,WAAWpvE,MAAMvK,EAAIgoE,EAAGpoE,aAwH/Bg6E,GAAa3G,UAAY7xE,OAAOqvF,OAAQvjC,GAAa+lB,WACrD2G,GAAa3G,UAAUlJ,YAAc6P,GAErCA,GAAa3G,UAAU/pE,OAAS,WAO/B,QAAS4+H,GAAU7zG,EAAO30B,EAAGC,EAAGS,GAE/B2R,EAAOlM,IAAKnG,EAAGC,EAAGS,GAAIy9E,UAAW/kE,EAEjC,IAAI+I,GAASs4D,EAAU9lD,EAEvB,IAAgB3zB,SAAXmhB,EAIJ,IAAM,GAFFnX,GAAWuN,EAASmhE,aAAc,YAE5BxpE,EAAI,EAAGC,EAAIgS,EAAO7hB,OAAQ4P,EAAIC,EAAGD,IAE1ClF,EAAS89E,OAAQ3mE,EAAQjS,GAAKmC,EAAOrS,EAAGqS,EAAOpS,EAAGoS,EAAO3R,GAjB5D,GAAI6X,GAAUkiE,EAEVpoE,EAAS,GAAIpR,GACbmY,EAAS,GAAInN,EAsBjB,OAAO,YAENsM,EAAWrY,KAAKqY,SAChBkiE,EAAWv6E,KAAKu6E,QAEhB,IAAI95E,GAAI,EAAGk8D,EAAI,CAKfzjD,GAAOjN,iBAAiB2S,KAAM5e,KAAKkZ,OAAOjN,kBAI1Cq8H,EAAU,IAAK,EAAG,MAClBA,EAAU,IAAK,EAAG,EAAG,GAIrBA,EAAU,MAAQ7nI,GAAKk8D,MACvB2rE,EAAU,KAAM7nI,GAAKk8D,MACrB2rE,EAAU,MAAQ7nI,EAAGk8D,MACrB2rE,EAAU,KAAM7nI,EAAGk8D,MAInB2rE,EAAU,MAAQ7nI,GAAKk8D,EAAG,GAC1B2rE,EAAU,KAAM7nI,GAAKk8D,EAAG,GACxB2rE,EAAU,MAAQ7nI,EAAGk8D,EAAG,GACxB2rE,EAAU,KAAM7nI,EAAGk8D,EAAG,GAItB2rE,EAAU,KAAU,GAAJ7nI,EAAa,IAAJk8D,MACzB2rE,EAAU,KAAY,IAAJ7nI,EAAa,IAAJk8D,MAC3B2rE,EAAU,KAAM,EAAO,EAAJ3rE,MAInB2rE,EAAU,OAAS7nI,EAAG,EAAG,GACzB6nI,EAAU,MAAO7nI,EAAG,EAAG,GACvB6nI,EAAU,MAAO,GAAK3rE,EAAG,GACzB2rE,EAAU,MAAO,EAAG3rE,EAAG,GAEvB2rE,EAAU,OAAS7nI,EAAG,MACtB6nI,EAAU,MAAO7nI,EAAG,MACpB6nI,EAAU,MAAO,GAAK3rE,MACtB2rE,EAAU,MAAO,EAAG3rE,MAEpBtkD,EAASmhE,aAAc,YAAa7jE,aAAc,MAgCpDmlE,GAAUrH,UAAY7xE,OAAOqvF,OAAQvjC,GAAa+lB,WAClDqH,GAAUrH,UAAUlJ,YAAcuQ,GAElCA,GAAUrH,UAAU/pE,OAAS,WAE5B,GAAIsxE,GAAM,GAAIp2E,EAEd,OAAO,UAAiB4b,GAcvB,GAZgB1f,SAAX0f,GAEJngB,QAAQ4H,KAAM,uDAIMnH,SAAhBd,KAAKwgB,QAETw6D,EAAIn6D,cAAe7gB,KAAKwgB,SAIpBw6D,EAAIwX,UAAT,CAEA,GAAI3tF,GAAMm2E,EAAIn2E,IACVC,EAAMk2E,EAAIl2E,IAkBVgG,EAAW9K,KAAKqY,SAAShI,WAAWvF,SACpCzD,EAAQyD,EAASzD,KAErBA,GAAO,GAAMvC,EAAIhF,EAAGuH,EAAO,GAAMvC,EAAI/E,EAAGsH,EAAO,GAAMvC,EAAItE,EACzD6G,EAAO,GAAMxC,EAAI/E,EAAGuH,EAAO,GAAMvC,EAAI/E,EAAGsH,EAAO,GAAMvC,EAAItE,EACzD6G,EAAO,GAAMxC,EAAI/E,EAAGuH,EAAO,GAAMxC,EAAI9E,EAAGsH,EAAO,GAAMvC,EAAItE,EACzD6G,EAAO,GAAMvC,EAAIhF,EAAGuH,EAAO,IAAOxC,EAAI9E,EAAGsH,EAAO,IAAOvC,EAAItE,EAC3D6G,EAAO,IAAOvC,EAAIhF,EAAGuH,EAAO,IAAOvC,EAAI/E,EAAGsH,EAAO,IAAOxC,EAAIrE,EAC5D6G,EAAO,IAAOxC,EAAI/E,EAAGuH,EAAO,IAAOvC,EAAI/E,EAAGsH,EAAO,IAAOxC,EAAIrE,EAC5D6G,EAAO,IAAOxC,EAAI/E,EAAGuH,EAAO,IAAOxC,EAAI9E,EAAGsH,EAAO,IAAOxC,EAAIrE,EAC5D6G,EAAO,IAAOvC,EAAIhF,EAAGuH,EAAO,IAAOxC,EAAI9E,EAAGsH,EAAO,IAAOxC,EAAIrE,EAE5DsK,EAAS6K,aAAc,EAEvB3V,KAAKqY,SAAS4iE,6BAMhBH,GAAUrH,UAAU5yD,cAAgB,SAAWL,GAK9C,MAHAxgB,MAAKwgB,OAASA,EACdxgB,KAAK0J,SAEE1J,MAgCR+6E,GAAWtH,UAAY7xE,OAAOqvF,OAAQvjC,GAAa+lB,WACnDsH,GAAWtH,UAAUlJ,YAAcwQ,GAEnCA,GAAWtH,UAAUx0C,kBAAoB,SAAW6tE,GAEnD,GAAI9xB,GAAMh7E,KAAKg7E,GAEVA,GAAIwX,YAETxX,EAAIyX,UAAWzyF,KAAK8K,UAEpBkwE,EAAI5jC,QAASp3C,KAAK+K,OAElB/K,KAAK+K,MAAMmtB,eAAgB,IAE3BhuB,EAASupE,UAAUx0C,kBAAkB36B,KAAMtE,KAAM8sG,KAsClD5xB,GAAYzH,UAAY7xE,OAAOqvF,OAAQxjC,GAAKgmB,WAC5CyH,GAAYzH,UAAUlJ,YAAc2Q,GAEpCA,GAAYzH,UAAUx0C,kBAAoB,SAAW6tE,GAEpD,GAAI/hG,IAAU/K,KAAK2e,MAAMvZ,QAEpBuN,MAAK4P,IAAKxX,GAAU,OAAOA,EAAQ,MAExC/K,KAAK+K,MAAM9E,IAAK,GAAMjG,KAAKinB,KAAM,GAAMjnB,KAAKinB,KAAMlc,GAElD/K,KAAK0K,SAAU,GAAI4N,SAAS3E,KAAS5I,EAAQ,EAAMkP,GAAWrG,GAE9D5T,KAAKg/B,OAAQh/B,KAAK2e,MAAMxZ,QAExB+E,EAASupE,UAAUx0C,kBAAkB36B,KAAMtE,KAAM8sG,GAoBlD,IAAItxB,IAAcC,EAsClBL,IAAY3H,UAAY7xE,OAAOqvF,OAAQ/mF,EAASupE,WAChD2H,GAAY3H,UAAUlJ,YAAc6Q,GAEpCA,GAAY3H,UAAUkI,aAAiB,WAEtC,GACIiG,GADAoI,EAAO,GAAIjpF,EAGf,OAAO,UAAuBs6E,GAIxBA,EAAIt7E,EAAI,OAEZC,KAAKoK,WAAWnE,IAAK,EAAG,EAAG,EAAG,GAEnBo1E,EAAIt7E,UAEfC,KAAKoK,WAAWnE,IAAK,EAAG,EAAG,EAAG,IAI9B+jF,EAAK/jF,IAAKo1E,EAAI76E,EAAG,GAAK66E,EAAIv7E,GAAI65B,YAE9BioD,EAAUjvE,KAAKm7E,KAAMzS,EAAIt7E,GAEzBC,KAAKoK,WAAW0iF,iBAAkB9C,EAAMpI,QAQ3CxG,GAAY3H,UAAUmI,UAAY,SAAWx7E,EAAQk7E,EAAYC,GAE5Cz6E,SAAfw6E,IAA2BA,EAAa,GAAMl7E,GAChCU,SAAdy6E,IAA0BA,EAAY,GAAMD,GAEjDt7E,KAAKq5E,KAAKtuE,MAAM9E,IAAK,EAAG0M,KAAK7N,IAAK,EAAG1E,EAASk7E,GAAc,GAC5Dt7E,KAAKq5E,KAAK7zB,eAEVxlD,KAAKy4E,KAAK1tE,MAAM9E,IAAKs1E,EAAWD,EAAYC,GAC5Cv7E,KAAKy4E,KAAK3tE,SAAS/K,EAAIK,EACvBJ,KAAKy4E,KAAKjzB,gBAIX41B,GAAY3H,UAAU80D,SAAW,SAAWv7H,GAE3ChN,KAAKq5E,KAAK/gE,SAAStL,MAAM4R,KAAM5R,GAC/BhN,KAAKy4E,KAAKngE,SAAStL,MAAM4R,KAAM5R,IAmChC6uE,GAAWpI,UAAY7xE,OAAOqvF,OAAQvjC,GAAa+lB,WACnDoI,GAAWpI,UAAUlJ,YAAcsR,EAanC,IAAI2sD,IAAY,EAEZC,GAAa,CAoJjB/iE,IAAMurB,OAAS,SAAWy3C,EAAW3lB,GAQpC,MANA1iH,SAAQixB,IAAK,4CAEbo3G,EAAUj1D,UAAY7xE,OAAOqvF,OAAQvrB,GAAM+N,WAC3Ci1D,EAAUj1D,UAAUlJ,YAAcm+D,EAClCA,EAAUj1D,UAAUsvC,SAAWA,EAExB2lB,GAMR9mI,OAAO48E,OAAQzV,GAAU0K,WAExBk1D,qBAAsB,SAAWjvD,GAEhCr5E,QAAQ4H,KAAM,uHAId,IAAIs2G,GAAMv+G,KAAKkjH,UAAWxpC,EAC1B,OAAO15E,MAAK4oI,eAAgBrqB,IAI7BsqB,2BAA4B,SAAWnvD,GAEtCr5E,QAAQ4H,KAAM,6HAId,IAAIs2G,GAAMv+G,KAAKw+D,gBAAiBkb,EAChC,OAAO15E,MAAK4oI,eAAgBrqB,IAI7BqqB,eAAgB,SAAW3mH,GAE1B5hB,QAAQ4H,KAAM,iHAId,KAAM,GAFFoQ,GAAW,GAAI7K,GAETwC,EAAI,EAAGC,EAAIgS,EAAO7hB,OAAQ4P,EAAIC,EAAGD,IAAO,CAEjD,GAAIykB,GAAQxS,EAAQjS,EACpBqI,GAAS3K,SAAS0E,KAAM,GAAIrR,GAAS0zB,EAAM30B,EAAG20B,EAAM10B,EAAG00B,EAAMj0B,GAAK,IAInE,MAAO6X,MAQTzW,OAAO48E,OAAQtV,GAAKuK,WAEnBq1D,WAAY,SAAW7mH,GAEtB5hB,QAAQ4H,KAAM,mEACdjI,KAAKopE,cAAennD,MAkBtBm7D,GAAmB3J,UAAY7xE,OAAOqvF,OAAQzpB,GAAiBiM,WAa/D4J,GAAa5J,UAAY7xE,OAAOqvF,OAAQzpB,GAAiBiM,WAazD6J,GAAO7J,UAAY7xE,OAAOqvF,OAAQzpB,GAAiBiM,WAEnD7xE,OAAO48E,OAAQlB,GAAO7J,WAErBs1D,cAAe,WAEd1oI,QAAQC,MAAO,qDAGhB0oI,sBAAuB,WAEtB3oI,QAAQC,MAAO,6DAGhB2oI,yBAA0B,WAEzB5oI,QAAQC,MAAO,kEA6BjBm5E,GAAWhG,UAAUy1D,UAAY,WAEhC7oI,QAAQC,MAAO,6FAIhBu4E,GAAepF,UAAU/pE,OAAS,WAEjCrJ,QAAQC,MAAO,iEAahBsB,OAAO48E,OAAQzR,GAAO0G,WAErBg+C,eAAgB,SAAW9sD,GAG1B,MADAtkE,SAAQ4H,KAAM,wGACPkpH,GAAYM,eAAgB9sD,MAsBrC/iE,OAAO48E,OAAQxG,GAAKvE,WAEnB3wE,OAAQ,SAAWkgH,GAGlB,MADA3iH,SAAQ4H,KAAM,2DACPjI,KAAKyyF,UAAWuwB,IAGxB3uB,MAAO,WAGN,MADAh0F,SAAQ4H,KAAM,wDACPjI,KAAKwyF,WAGb22C,kBAAmB,SAAWnuD,GAG7B,MADA36E,SAAQ4H,KAAM,0EACPjI,KAAK8yF,cAAe9X,IAG5B/zD,KAAM,SAAW+7F,GAGhB,MADA3iH,SAAQ4H,KAAM,uDACPjI,KAAKo3C,QAAS4rE,MAKvBphH,OAAO48E,OAAQ55E,EAAK6uE,WAEnB3wE,OAAQ,SAAWkgH,GAGlB,MADA3iH,SAAQ4H,KAAM,2DACPjI,KAAKyyF,UAAWuwB,IAGxB3uB,MAAO,WAGN,MADAh0F,SAAQ4H,KAAM,wDACPjI,KAAKwyF,WAGb22C,kBAAmB,SAAWnuD,GAG7B,MADA36E,SAAQ4H,KAAM,0EACPjI,KAAK8yF,cAAe9X,IAG5BouD,qBAAsB,SAAWn2C,GAGhC,MADA5yF,SAAQ4H,KAAM,gFACPjI,KAAK+yF,iBAAkBE,IAG/BhsE,KAAM,SAAW+7F,GAGhB,MADA3iH,SAAQ4H,KAAM,uDACPjI,KAAKo3C,QAAS4rE,MAKvB/qC,GAAMxE,UAAU3wE,OAAS,SAAWkgH,GAGnC,MADA3iH,SAAQ4H,KAAM,4DACPjI,KAAKyyF,UAAWuwB,IAIxBphH,OAAO48E,OAAQv8E,IAEdonI,SAAU,WAGT,MADAhpI,SAAQ4H,KAAM,2EACP0K,KAAK4F,UAIb+wH,kBAAmB,SAAWxnI,GAG7B,MADAzB,SAAQ4H,KAAM,4EACPhG,GAAMioC,gBAAiBpoC,IAI/BynI,eAAgB,SAAWznI,GAG1B,MADAzB,SAAQ4H,KAAM,wEACPhG,GAAM8gD,eAAgBjhD,MAM/BF,OAAO48E,OAAQx9E,EAAQyyE,WAEtB+1D,qBAAsB,SAAWniI,EAAOzE,GAGvC,MADAvC,SAAQ4H,KAAM,uFACPjI,KAAK8e,QAASzX,EAAOzE,IAG7B6mI,gBAAiB,SAAWt3H,GAG3B,MADA9R,SAAQ4H,KAAM,kGACPkK,EAAOswE,aAAcziF,OAG7B0pI,qBAAsB,WAErBrpI,QAAQC,MAAO,6DAGhBqpI,cAAe,SAAWjiI,GAGzB,MADArH,SAAQ4H,KAAM,6GACPjI,KAAK0oF,uBAAwBhhF,IAGrCkiI,oBAAqB,WAEpBvpI,QAAQC,MAAO,8DAMjBsB,OAAO48E,OAAQv+E,EAAQwzE,WAEtBo2D,gBAAiB,SAAWjyE,GAG3B,MADAv3D,SAAQ4H,KAAM,0EACPjI,KAAKoa,aAAcw9C,IAG3B4xE,qBAAsB,SAAWniI,EAAOzE,GAGvC,MADAvC,SAAQ4H,KAAM,uFACPjI,KAAK8e,QAASzX,EAAOzE,IAG7BknI,YAAa,WAEZ,GAAIliE,EAEJ,OAAO,YAIN,MAFY9mE,UAAP8mE,IAAmBA,EAAK,GAAI7mE,IACjCV,QAAQ4H,KAAM,wGACP2/D,EAAGsd,oBAAqBllF,KAAM,OAKvCyrG,0BAA2B,SAAW73C,GAGrC,MADAvzD,SAAQ4H,KAAM,kGACPjI,KAAKsmF,2BAA4B1yB,IAGzCm2E,gBAAiB,WAEhB1pI,QAAQ4H,KAAM,wDAGfwhI,gBAAiB,SAAWt3H,GAG3B,MADA9R,SAAQ4H,KAAM,kGACPkK,EAAO0M,aAAc7e,OAG7BgqI,gBAAiB,SAAW73H,GAG3B,MADA9R,SAAQ4H,KAAM,kGACPkK,EAAO0M,aAAc7e,OAG7B0pI,qBAAsB,WAErBrpI,QAAQC,MAAO,6DAGhB2pI,WAAY,SAAW94H,GAEtB9Q,QAAQ4H,KAAM,oGACdkJ,EAAEmnB,mBAAoBt4B,OAGvBkqI,YAAa,SAAW/3H,GAGvB,MADA9R,SAAQ4H,KAAM,8FACPkK,EAAO0M,aAAc7e,OAG7B07E,UAAW,WAEVr7E,QAAQC,MAAO,kDAGhBsrG,QAAS,WAERvrG,QAAQC,MAAO,gDAGhBi5E,QAAS,WAERl5E,QAAQC,MAAO,gDAGhBurG,QAAS,WAERxrG,QAAQC,MAAO,gDAGhB6pI,aAAc,WAEb9pI,QAAQC,MAAO,qDAGhBqpI,cAAe,SAAWjiI,GAGzB,MADArH,SAAQ4H,KAAM,6GACPjI,KAAK0oF,uBAAwBhhF,IAGrCkiI,oBAAqB,WAEpBvpI,QAAQC,MAAO,4DAGhB8pI,YAAa,SAAWh+H,EAAMC,EAAOE,EAAQD,EAAKE,EAAMC,GAGvD,MADApM,SAAQ4H,KAAM,wHACPjI,KAAKsrF,gBAAiBl/E,EAAMC,EAAOC,EAAKC,EAAQC,EAAMC,MAM/DvH,EAAMuuE,UAAU42D,mBAAqB,SAAWhxD,GAG/C,MADAh5E,SAAQ4H,KAAM,6EACPjI,KAAKk1F,eAAgB7b,IAI7B94E,EAAWkzE,UAAUg2D,gBAAkB,SAAWt3H,GAGjD,MADA9R,SAAQ4H,KAAM,mHACPkK,EAAOioC,gBAAiBp6C,OAIhC4B,OAAO48E,OAAQxmE,EAAIy7D,WAElB01D,kBAAmB,SAAWnuD,GAG7B,MADA36E,SAAQ4H,KAAM,yEACPjI,KAAK8yF,cAAe9X,IAG5BsvD,oBAAqB,SAAW3rH,GAG/B,MADAte,SAAQ4H,KAAM,6EACPjI,KAAKmzF,gBAAiBx0E,IAG9ByqH,qBAAsB,SAAWn2C,GAGhC,MADA5yF,SAAQ4H,KAAM,+EACPjI,KAAK+yF,iBAAkBE,MAMhCrxF,OAAO48E,OAAQrmE,EAASs7D,WAEvBle,KAAM,WAGL,MADAl1D,SAAQ4H,KAAM,2DACPjI,KAAK04G,WAGb6xB,mBAAoB,SAAW91G,EAAOxU,GAGrC,MADA5f,SAAQ4H,KAAM,8EACPjI,KAAK83G,aAAcrjF,EAAOxU,IAGlCuqH,SAAU,SAAWvqH,GAGpB,MADA5f,SAAQ4H,KAAM,mEACPjI,KAAK24G,YAAa14F,IAG1B9a,OAAQ,SAAW8a,GAGlB,MADA5f,SAAQ4H,KAAM,+DACPjI,KAAK43G,UAAW33F,IAGxBtB,MAAO,SAAWsB,GAGjB,MADA5f,SAAQ4H,KAAM,6DACPjI,KAAK44G,SAAU34F,MAMxBre,OAAO48E,OAAQrmE,GAEdoyH,mBAAoB,SAAW91G,EAAO3nB,EAAG9G,EAAG+G,EAAGkT,GAG9C,MADA5f,SAAQ4H,KAAM,8EACPkQ,EAAS2/F,aAAcrjF,EAAO3nB,EAAG9G,EAAG+G,EAAGkT,IAG/C9a,OAAQ,SAAW2H,EAAG9G,EAAG+G,EAAGkT,GAG3B,MADA5f,SAAQ4H,KAAM,+DACPkQ,EAASy/F,UAAW9qG,EAAG9G,EAAG+G,EAAGkT,MAMtCre,OAAO48E,OAAQnV,GAAMoK,WAEpBg3D,iBAAkB,SAAW/wD,GAG5B,MADAr5E,SAAQ4H,KAAM,oFACPjI,KAAK0+D,cAAegb,IAG5BgxD,QAAS,SAAW7mI,GAGnB,MADAxD,SAAQ4H,KAAM,4EACP,GAAI8xD,IAAiB/5D,KAAM6D,IAGnC8mI,aAAc,SAAW9mI,GAGxB,MADAxD,SAAQ4H,KAAM,+EACP,GAAIu5D,IAAexhE,KAAM6D,MAMlCjC,OAAO48E,OAAQ3+E,EAAQ4zE,WAEtBm3D,cAAe,SAAWzjI,EAAWiJ,EAAOxN,GAG3C,MADAvC,SAAQ4H,KAAM,+EACPjI,KAAK+uD,oBAAqB5nD,EAAWiJ,EAAOxN,IAGpDioI,oBAAqB,SAAW15H,GAG/B,MADA9Q,SAAQ4H,KAAM,qFACPjI,KAAKujF,oBAAqBpyE,IAGlC25H,gBAAiB,WAGhB,MADAzqI,SAAQ4H,KAAM,6EACPjI,KAAKkjF,qBAMdthF,OAAO48E,OAAQz9E,EAAQ0yE,WAEtBs3D,2BAA4B,WAE3B1qI,QAAQC,MAAO,8GAGhB0qI,uBAAwB,WAEvB3qI,QAAQC,MAAO,sGAGhB2qI,sBAAuB,SAAWrzE,GAGjC,MADAv3D,SAAQ4H,KAAM,yFACPjI,KAAKm4B,sBAAuBy/B,IAGpCszE,mBAAoB,SAAWtzE,GAG9B,MADAv3D,SAAQ4H,KAAM,mFACPjI,KAAKswF,mBAAoB14B,IAGjCuzE,oBAAqB,SAAW/6H,EAAOnN,GAGtC,MADA5C,SAAQ4H,KAAM,qFACPjI,KAAKklF,oBAAqBjiF,EAAQmN,IAG1Cg7H,gBAAiB,SAAWxzE,GAG3B,MADAv3D,SAAQ4H,KAAM,uFACPjI,KAAK6e,aAAc+4C,IAG3BgzE,cAAe,SAAWzjI,EAAWiJ,EAAOxN,GAG3C,MADAvC,SAAQ4H,KAAM,+EACPjI,KAAK+uD,oBAAqB5nD,EAAWiJ,EAAOxN,IAGpDioI,oBAAqB,SAAW15H,GAG/B,MADA9Q,SAAQ4H,KAAM,qFACPjI,KAAKujF,oBAAqBpyE,IAGlC25H,gBAAiB,WAGhB,MADAzqI,SAAQ4H,KAAM,6EACPjI,KAAKkjF,qBAMdthF,OAAO48E,OAAQ/6E,EAAQgwE,WAEtBm3D,cAAe,SAAWzjI,EAAWiJ,EAAOxN,GAG3C,MADAvC,SAAQ4H,KAAM,+EACPjI,KAAK+uD,oBAAqB5nD,EAAWiJ,EAAOxN,IAGpDkoI,gBAAiB,WAGhB,MADAzqI,SAAQ4H,KAAM,6EACPjI,KAAKkjF,qBAQdthF,OAAO48E,OAAQhxE,EAASimE,WAEvB43D,gBAAiB,WAEhBhrI,QAAQC,MAAO,yDAGhB28G,qBAAsB,WAErB58G,QAAQC,MAAO,+GAMjBsB,OAAO48E,OAAQt0E,EAASupE,WAEvB63D,eAAgB,SAAWnpI,GAG1B,MADA9B,SAAQ4H,KAAM,6EACPjI,KAAKssG,gBAAiBnqG,IAG9BopI,YAAa,WAEZlrI,QAAQ4H,KAAM,8EAGfyzE,UAAW,SAAW5kD,EAAUkzD,GAG/B,MADA3pF,SAAQ4H,KAAM,kGACPjI,KAAK8rG,gBAAiB9hB,EAAMlzD,IAGpC00G,iBAAkB,WAEjBnrI,QAAQC,MAAO,qHAMjBsB,OAAOqJ,iBAAkBf,EAASupE,WAEjCg4D,YACCpiI,IAAK,WAGJ,MADAhJ,SAAQ4H,KAAM,uDACPjI,KAAK+C,SAAS8G,OAGtB5D,IAAK,SAAWnE,GAEfzB,QAAQ4H,KAAM,uDACdjI,KAAK+C,SAAS8G,MAAQ/H,IAIxB4pI,eACCriI,IAAK,WAEJhJ,QAAQ4H,KAAM,kGAGfhC,IAAK,WAEJ5F,QAAQ4H,KAAM,qGAOjBrG,OAAOqJ,iBAAkBwhD,GAAIgnB,WAE5B36D,SACCzP,IAAK,WAGJ,MADAhJ,SAAQ4H,KAAM,oDACPjI,KAAK0sD,WAOf9qD,OAAOC,eAAgB8qD,GAAS8mB,UAAW,oBAE1CpqE,IAAK,WAEJhJ,QAAQ4H,KAAM,uDAGfhC,IAAK,WAEJ5F,QAAQ4H,KAAM,yDAMhBrG,OAAOC,eAAgB6jE,GAAM+N,UAAW,wBAEvCpqE,IAAK,WAGJ,MADAhJ,SAAQ4H,KAAM,kEACPjI,KAAK2lE,oBAGb1/D,IAAK,SAAWnE,GAEfzB,QAAQ4H,KAAM,kEACdjI,KAAK2lE,mBAAqB7jE,KAQ5Bm0C,GAAkBw9B,UAAUk4D,QAAU,SAAWvwB,EAAa/kE,GAE7Dh2C,QAAQ4H,KAAM;AAGKnH,SAAdu1C,IAA0Br2C,KAAKq2C,UAAYA,GAChDr2C,KAAKm7G,eAAgBC,IAMtBx5G,OAAOqJ,iBAAkBq+D,GAAMmK,WAC9Bm4D,YACC3lI,IAAK,WAEJ5F,QAAQ4H,KAAM,gDAIhB4jI,iBACC5lI,IAAK,SAAWnE,GAEfzB,QAAQ4H,KAAM,4DACdjI,KAAK02B,OAAOxd,OAAOg9B,IAAMp0C,IAI3BgqI,kBACC7lI,IAAK,SAAWnE,GAEfzB,QAAQ4H,KAAM,8DACdjI,KAAK02B,OAAOxd,OAAO9M,KAAOtK,IAI5BiqI,mBACC9lI,IAAK,SAAWnE,GAEfzB,QAAQ4H,KAAM,gEACdjI,KAAK02B,OAAOxd,OAAO7M,MAAQvK,IAI7BkqI,iBACC/lI,IAAK,SAAWnE,GAEfzB,QAAQ4H,KAAM,4DACdjI,KAAK02B,OAAOxd,OAAO5M,IAAMxK,IAI3BmqI,oBACChmI,IAAK,SAAWnE,GAEfzB,QAAQ4H,KAAM,kEACdjI,KAAK02B,OAAOxd,OAAO3M,OAASzK,IAI9Bo1B,kBACCjxB,IAAK,SAAWnE,GAEfzB,QAAQ4H,KAAM,8DACdjI,KAAK02B,OAAOxd,OAAO1M,KAAO1K,IAI5Bq1B,iBACClxB,IAAK,SAAWnE,GAEfzB,QAAQ4H,KAAM,4DACdjI,KAAK02B,OAAOxd,OAAOzM,IAAM3K,IAI3BoqI,qBACCjmI,IAAK,WAEJ5F,QAAQ4H,KAAM,oHAIhB0uB,YACC1wB,IAAK,SAAWnE,GAEfzB,QAAQ4H,KAAM,iDACdjI,KAAK02B,OAAO6B,KAAOz2B,IAIrBqqI,gBACClmI,IAAK,WAEJ5F,QAAQ4H,KAAM,oDAIhBmkI,gBACCnmI,IAAK,SAAWnE,GAEfzB,QAAQ4H,KAAM,8DACdjI,KAAK02B,OAAO8B,QAAQ70B,MAAQ7B,IAI9BuqI,iBACCpmI,IAAK,SAAWnE,GAEfzB,QAAQ4H,KAAM,gEACdjI,KAAK02B,OAAO8B,QAAQ50B,OAAS9B,MAQhCF,OAAOqJ,iBAAkB2D,EAAgB6kE,WAExCrzE,QACCiJ,IAAK,WAGJ,MADAhJ,SAAQ4H,KAAM,2EACPjI,KAAKqH,MAAMjH,SAIpBksI,iBAAkB,WAEjBjsI,QAAQC,MAAO,mEAMjBsB,OAAO48E,OAAQtuE,EAAeujE,WAE7B84D,SAAU,SAAWn8H,GAEpB/P,QAAQ4H,KAAM,sEACdjI,KAAK6S,SAAUzC,IAGhBo8H,YAAa,SAAW7lI,EAAOuC,EAAOy4D,GAEhB7gE,SAAhB6gE,GAEJthE,QAAQ4H,KAAM,wEAGf5H,QAAQ4H,KAAM,4DACdjI,KAAKyS,SAAU9L,EAAOuC,IAGvBujI,eAAgB,WAEfpsI,QAAQ4H,KAAM,kEACdjI,KAAK4zG,eAGNy3B,gBAAiB,WAEhBhrI,QAAQ4H,KAAM,+DAGfykI,eAAgB,WAEfrsI,QAAQ4H,KAAM,gEAMhBrG,OAAOqJ,iBAAkBiF,EAAeujE,WAEvCo6C,WACCxkH,IAAK,WAGJ,MADAhJ,SAAQC,MAAO,iEACRN,KAAK8P,SAIdg+G,SACCzkH,IAAK,WAGJ,MADAhJ,SAAQ4H,KAAM,+DACPjI,KAAK8P,WASflO,OAAO48E,OAAQvkB,GAAsBwZ,WAEpCk5D,UAAW,WAEVtsI,QAAQC,MAAO,gEAIhBssI,aAAc,WAEbvsI,QAAQC,MAAO,mEAIhB45D,SAAU,WAET75D,QAAQC,MAAO,iEAQjBsB,OAAOqJ,iBAAkB0rE,GAAQlD,WAEhClsE,SACCtB,IAAK,WAEJ5F,QAAQ4H,KAAM,oFAIhBzE,UACC1B,MAAO,WAGN,MADAzB,SAAQ4H,KAAM,qFACPjI,SASV4B,OAAOqJ,iBAAkBoI,EAASogE,WAEjCo5D,YACCxjI,IAAK,WAEJhJ,QAAQ4H,KAAM,kDAGfhC,IAAK,WAEJ5F,QAAQ4H,KAAM,mDAIhB6kI,SACCzjI,IAAK,WAGJ,MADAhJ,SAAQ4H,KAAM,8CACP,GAAIpC,KAKb6nH,SACCrkH,IAAK,WAEJhJ,QAAQC,MAAO,SAAWN,KAAKyB,KAAO,uEAGvCwE,IAAK,SAAWnE,GAEfzB,QAAQ4H,KAAM,SAAWjI,KAAKyB,KAAO,sEACrCzB,KAAK6T,YAAgB/R,IAAU49E,OAOlC99E,OAAOqJ,iBAAkB6nB,GAAkB2gD,WAE1Cs5D,OACC1jI,IAAK,WAGJ,MADAhJ,SAAQ4H,KAAM,8FACP,GAGRhC,IAAK,WAEJ5F,QAAQ4H,KAAM,gGAOjBrG,OAAOqJ,iBAAkB8L,EAAe08D,WAEvCl8D,aACClO,IAAK,WAGJ,MADAhJ,SAAQ4H,KAAM,iFACPjI,KAAKsX,WAAWC,aAGxBtR,IAAK,SAAWnE,GAEfzB,QAAQ4H,KAAM,kFACdjI,KAAKsX,WAAWC,YAAczV,MASjCF,OAAO48E,OAAQ3hC,GAAc42B,WAE5Bu5D,QAAS,SAAWlmI,GAEnBzG,QAAQ4H,KAAM,+DACdjI,KAAK6G,iBAAkBC,IAIxBmmI,uBAAwB,WAGvB,MADA5sI,SAAQ4H,KAAM,6EACPjI,KAAK+zB,mBAIbrY,iBAAkB,WAGjB,MADArb,SAAQ4H,KAAM,qFACPjI,KAAKib,aAAaS,oBAI1BwxH,aAAc,WAGb,MADA7sI,SAAQ4H,KAAM,wEACPjI,KAAKib,aAAa9F,WAI1Bg4H,aAAc,WAGb,MADA9sI,SAAQ4H,KAAM,+DACPjI,KAAK6Y,MAAMqJ,SAInBkrH,sBAAuB,WAGtB,MADA/sI,SAAQ4H,KAAM,gGACPjI,KAAKsX,WAAWjO,IAAK,sBAG7BgkI,0BAA2B,WAG1B,MADAhtI,SAAQ4H,KAAM,yGACPjI,KAAKsX,WAAWjO,IAAK,2BAG7BikI,4BAA6B,WAG5B,MADAjtI,SAAQ4H,KAAM,6GACPjI,KAAKsX,WAAWjO,IAAK,6BAG7BkkI,8BAA+B,WAG9B,MADAltI,SAAQ4H,KAAM,oHACPjI,KAAKsX,WAAWjO,IAAK,kCAG7BmkI,+BAAgC,WAG/B,MADAntI,SAAQ4H,KAAM,sHACPjI,KAAKsX,WAAWjO,IAAK,mCAG7BokI,oBAAqB,WAGpB,MADAptI,SAAQ4H,KAAM,6FACPjI,KAAKsX,WAAWjO,IAAK,qBAG7BulB,uBAAwB,WAGvB,MADAvuB,SAAQ4H,KAAM,uFACPjI,KAAKib,aAAasC,gBAG1BmwH,wBAAyB,WAGxB,MADArtI,SAAQ4H,KAAM,uGACPjI,KAAKsX,WAAWjO,IAAK,2BAG7BskI,kBAAmB,SAAW3kF,GAE7B3oD,QAAQ4H,KAAM,uEACdjI,KAAKu+B,eAAgByqB,IAGtBxI,aAAc,WAEbngD,QAAQ4H,KAAM,2DAGf2lI,aAAc,WAEbvtI,QAAQ4H,KAAM,2DAGf4lI,cAAe,WAEdxtI,QAAQ4H,KAAM,4DAGf6lI,gBAAiB,WAEhBztI,QAAQ4H,KAAM,8DAGf8lI,eAAgB,WAEf1tI,QAAQ4H,KAAM,+DAMhBrG,OAAOqJ,iBAAkB4xC,GAAc42B,WAEtClkD,kBACClmB,IAAK,WAEJ,MAAOrJ,MAAK60B,UAAU1V,SAGvBlZ,IAAK,SAAWnE,GAEfzB,QAAQ4H,KAAM,qEACdjI,KAAK60B,UAAU1V,QAAUrd,IAI3BwrB,eACCjkB,IAAK,WAEJ,MAAOrJ,MAAK60B,UAAUpzB,MAGvBwE,IAAK,SAAWnE,GAEfzB,QAAQ4H,KAAM,+DACdjI,KAAK60B,UAAUpzB,KAAOK,IAIxBksI,mBACC3kI,IAAK,WAEJhJ,QAAQ4H,KAAM,+FAIfhC,IAAK,WAEJ5F,QAAQ4H,KAAM,kGAMjBrG,OAAOqJ,iBAAkB8vB,GAAe04C,WAEvC3sC,UACCz9B,IAAK,WAEJhJ,QAAQ4H,KAAM,gGAIfhC,IAAK,WAEJ5F,QAAQ4H,KAAM,iGAIhBgmI,oBACC5kI,IAAK,WAEJhJ,QAAQ4H,KAAM,0GAIfhC,IAAK,WAEJ5F,QAAQ4H,KAAM,2GAIhBimI,mBACC7kI,IAAK,WAEJhJ,QAAQ4H,KAAM,yGAIfhC,IAAK,WAEJ5F,QAAQ4H,KAAM,4GASjBrG,OAAOqJ,iBAAkBvH,EAAkB+vE,WAE1CryE,OACCiI,IAAK,WAGJ,MADAhJ,SAAQ4H,KAAM,0DACPjI,KAAKiE,QAAQ7C,OAGrB6E,IAAK,SAAWnE,GAEfzB,QAAQ4H,KAAM,0DACdjI,KAAKiE,QAAQ7C,MAAQU,IAIvBT,OACCgI,IAAK,WAGJ,MADAhJ,SAAQ4H,KAAM,0DACPjI,KAAKiE,QAAQ5C,OAGrB4E,IAAK,SAAWnE,GAEfzB,QAAQ4H,KAAM,0DACdjI,KAAKiE,QAAQ5C,MAAQS,IAIvBR,WACC+H,IAAK,WAGJ,MADAhJ,SAAQ4H,KAAM,kEACPjI,KAAKiE,QAAQ3C,WAGrB2E,IAAK,SAAWnE,GAEfzB,QAAQ4H,KAAM,kEACdjI,KAAKiE,QAAQ3C,UAAYQ,IAI3BP,WACC8H,IAAK,WAGJ,MADAhJ,SAAQ4H,KAAM,kEACPjI,KAAKiE,QAAQ1C,WAGrB0E,IAAK,SAAWnE,GAEfzB,QAAQ4H,KAAM,kEACdjI,KAAKiE,QAAQ1C,UAAYO,IAI3BJ,YACC2H,IAAK,WAGJ,MADAhJ,SAAQ4H,KAAM,oEACPjI,KAAKiE,QAAQvC,YAGrBuE,IAAK,SAAWnE,GAEfzB,QAAQ4H,KAAM,oEACdjI,KAAKiE,QAAQvC,WAAaI,IAI5Bc,QACCyG,IAAK,WAGJ,MADAhJ,SAAQ4H,KAAM,4DACPjI,KAAKiE,QAAQrB,QAGrBqD,IAAK,SAAWnE,GAEfzB,QAAQ4H,KAAM,4DACdjI,KAAKiE,QAAQrB,OAASd,IAIxBe,QACCwG,IAAK,WAGJ,MADAhJ,SAAQ4H,KAAM,4DACPjI,KAAKiE,QAAQpB,QAGrBoD,IAAK,SAAWnE,GAEfzB,QAAQ4H,KAAM,4DACdjI,KAAKiE,QAAQpB,OAASf,IAIxBN,QACC6H,IAAK,WAGJ,MADAhJ,SAAQ4H,KAAM,4DACPjI,KAAKiE,QAAQzC,QAGrByE,IAAK,SAAWnE,GAEfzB,QAAQ4H,KAAM,4DACdjI,KAAKiE,QAAQzC,OAASM,IAIxBL,MACC4H,IAAK,WAGJ,MADAhJ,SAAQ4H,KAAM,wDACPjI,KAAKiE,QAAQxC,MAGrBwE,IAAK,SAAWnE,GAEfzB,QAAQ4H,KAAM,wDACdjI,KAAKiE,QAAQxC,KAAOK,IAItBoB,iBACCmG,IAAK,WAGJ,MADAhJ,SAAQ4H,KAAM,8EACPjI,KAAKiE,QAAQf,iBAGrB+C,IAAK,SAAWnE,GAEfzB,QAAQ4H,KAAM,8EACdjI,KAAKiE,QAAQf,gBAAkBpB,MASlCF,OAAOqJ,iBAAkBwrC,GAAag9B,WAErC06D,UACCloI,IAAK,WAEJ5F,QAAQ4H,KAAM,uDASjB2oE,GAAM6C,UAAUwsC,KAAO,SAAWF,GAEjC1/G,QAAQ4H,KAAM,yEACd,IAAIuK,GAAQxS,KACRouI,EAAc,GAAIz+D,GAMtB,OALAy+D,GAAYnuB,KAAMF,EAAM,SAAWr4G,GAElC8K,EAAMqmH,UAAWnxH,KAGX1H,MAIR0xE,GAAc+B,UAAU46D,QAAU,WAGjC,MADAhuI,SAAQ4H,KAAM,+DACPjI,KAAK26H,oBAMb7qD,GAAW2D,UAAU66D,cAAgB,SAAW11H,EAAUK,GAGzD,MADA5Y,SAAQ4H,KAAM,wDACPjI,KAAK0J,OAAQkP,EAAUK,GAM/B,IAAIs1H,KAEHxwC,MAAO,SAAWywC,EAAWvsE,EAAWqtC,GAEvCjvG,QAAQ4H,KAAM,kIACd,IAAIhF,EAECg/D,GAAUxlC,SAEdwlC,EAAUj/D,kBAAoBi/D,EAAUzc,eAExCviD,EAASg/D,EAAUh/D,OACnBg/D,EAAYA,EAAU5pD,UAIvBm2H,EAAUzwC,MAAO97B,EAAWh/D,EAAQqsG,IAIrCxsG,OAAQ,SAAWuV,GAGlB,MADAhY,SAAQ4H,KAAM,6FACPoQ,EAASvV,UAMlB8tF,IAAW0xB,YAAcxhH,OAEzB8vF,GAAWmxB,YAAc,SAAWp9C,EAAKxjE,EAAS+iE,EAAQE,GAEzD/jE,QAAQ4H,KAAM,uFAEd,IAAI+5G,GAAS,GAAIv8C,GACjBu8C,GAAOW,eAAgB3iH,KAAKsiH,YAE5B,IAAIr+G,GAAU+9G,EAAO/B,KAAMt7C,EAAKT,EAAQpjE,OAAWsjE,EAInD,OAFKjjE,KAAU8C,EAAQ9C,QAAUA,GAE1B8C,GAIR2sF,GAAW69C,gBAAkB,SAAW7rB,EAAMzhH,EAAS+iE,EAAQE,GAE9D/jE,QAAQ4H,KAAM,+FAEd,IAAI+5G,GAAS,GAAIx8C,GACjBw8C,GAAOW,eAAgB3iH,KAAKsiH,YAE5B,IAAIr+G,GAAU+9G,EAAO/B,KAAM2C,EAAM1+C,EAAQpjE,OAAWsjE,EAIpD,OAFKjjE,KAAU8C,EAAQ9C,QAAUA,GAE1B8C,GAIR2sF,GAAW89C,sBAAwB,WAElCruI,QAAQC,MAAO,0FAIhBswF,GAAW+9C,0BAA4B,WAEtCtuI,QAAQC,MAAO,6FAgDhB,IAAIsuI,KAEHC,0BAA2B,WAE1BxuI,QAAQC,MAAO,wEAIhBwuI,OAAQ,WAEPzuI,QAAQC,MAAO,wEAIhByuI,OAAQ,WAEP1uI,QAAQC,MAAO,yEAcb0uI,KAmZJ,OAlZAA,IAAQ3qI,sBAAwBA,EAChC2qI,GAAQtrI,kBAAoBA,EAC5BsrI,GAAQnyF,cAAgBA,GACxBmyF,GAAQj1H,UAAYA,GACpBi1H,GAAQnqF,YAAcA,GACtBmqF,GAAQluF,cAAgBA,GACxBkuF,GAAQpiH,YAAcA,GACtBoiH,GAAQ/iF,QAAUA,GAClB+iF,GAAQ9iF,IAAMA,GACd8iF,GAAQ7iF,MAAQA,GAChB6iF,GAAQziF,OAASA,GACjByiF,GAAQviF,IAAMA,GACduiF,GAAQhiF,YAAcA,GACtBgiF,GAAQriF,SAAWA,GACnBqiF,GAAQjiF,KAAOA,GACfiiF,GAAQ52H,KAAOA,EACf42H,GAAQthF,aAAeA,GACvBshF,GAAQrhF,SAAWA,GACnBqhF,GAAQvhF,KAAOA,GACfuhF,GAAQphF,OAASA,GACjBohF,GAAQh5F,MAAQA,GAChBg5F,GAAQnhF,aAAeA,GACvBmhF,GAAQvqI,YAAcA,EACtBuqI,GAAQjhF,kBAAoBA,GAC5BihF,GAAQzrH,YAAcA,GACtByrH,GAAQhhF,cAAgBA,GACxBghF,GAAQ/gF,aAAeA,GACvB+gF,GAAQ/tI,QAAUA,EAClB+tI,GAAQ5pE,wBAA0BA,GAClC4pE,GAAQ1pE,kBAAoBA,GAC5B0pE,GAAQxpE,kBAAoBA,GAC5BwpE,GAAQvpE,cAAgBA,GACxBupE,GAAQ9hE,aAAeA,GACvB8hE,GAAQniE,eAAiBA,GACzBmiE,GAAQliE,qBAAuBA,GAC/BkiE,GAAQ7pE,sBAAwBA,GAChC6pE,GAAQ/qE,eAAiBA,GACzB+qE,GAAQhiE,WAAaA,GACrBgiE,GAAQzpE,YAAcA,GACtBypE,GAAQ5hE,kBAAoBA,GAC5B4hE,GAAQt/D,WAAaA,GACrBs/D,GAAQ/pE,WAAaA,GACrB+pE,GAAQjiE,OAASA,GACjBiiE,GAAQ7d,YAAcA,GACtB6d,GAAQnvB,MAAQA,GAChBmvB,GAAQr/D,YAAcA,GACtBq/D,GAAQvlE,gBAAkBA,GAC1BulE,GAAQtlE,UAAYA,GACpBslE,GAAQplE,WAAaA,GACrBolE,GAAQhlE,cAAgBA,GACxBglE,GAAQzlE,gBAAkBA,GAC1BylE,GAAQnlE,uBAAyBA,GACjCmlE,GAAQllE,iBAAmBA,GAC3BklE,GAAQjlE,aAAeA,GACvBilE,GAAQxlE,YAAcA,GACtBwlE,GAAQ1lE,MAAQA,GAChB0lE,GAAQp/D,aAAeA,GACvBo/D,GAAQ/4F,kBAAoBA,GAC5B+4F,GAAQ7iI,mBAAqBA,EAC7B6iI,GAAQl/D,WAAaA,GACrBk/D,GAAQz4F,YAAcA,GACtBy4F,GAAQjjI,OAASA,EACjBijI,GAAQ1+D,cAAgBA,GACxB0+D,GAAQz9D,gBAAkBA,GAC1By9D,GAAQz+D,aAAeA,GACvBy+D,GAAQt9D,cAAgBA,GACxBs9D,GAAQp+D,MAAQA,GAChBo+D,GAAQhjE,oBAAsBA,GAC9BgjE,GAAQjjE,oBAAsBA,GAC9BijE,GAAQljE,wBAA0BA,GAClCkjE,GAAQpjE,oBAAsBA,GAC9BojE,GAAQrjE,mBAAqBA,GAC7BqjE,GAAQtjE,qBAAuBA,GAC/BsjE,GAAQ/8D,cAAgBA,GACxB+8D,GAAQj8D,gBAAkBA,GAC1Bi8D,GAAQhkE,cAAgBA,GACxBgkE,GAAQ5jE,eAAiBA,GACzB4jE,GAAQx7D,qBAAuBA,GAC/Bw7D,GAAQ14D,eAAiBA,GACzB04D,GAAQ/iE,cAAgBA,GACxB+iE,GAAQr4D,QAAUA,GAClBq4D,GAAQp4D,wBAA0BA,GAClCo4D,GAAQ9+H,eAAiBA,EACzB8+H,GAAQxhI,SAAWA,EACnBwhI,GAAQ3iF,2BAA6BA,GACrC2iF,GAAQn4D,2BAA6BA,GACrCm4D,GAAQ5iF,kBAAoBA,GAC5B4iF,GAAQl4D,yBAA2BA,GACnCk4D,GAAQniI,MAAQA,EAChBmiI,GAAQ9kI,SAAWA,EACnB8kI,GAAQj4D,UAAYA,GACpBi4D,GAAQhlI,OAASA,EACjBglI,GAAQpvI,gBAAkBA,EAC1BovI,GAAQv3D,MAAQA,GAChBu3D,GAAQnjE,4BAA8BA,GACtCmjE,GAAQlkE,kBAAoBA,GAC5BkkE,GAAQjkE,oBAAsBA,GAC9BikE,GAAQvkE,iBAAmBA,GAC3BukE,GAAQ/kE,YAAcA,GACtB+kE,GAAQ72H,SAAWA,EACnB62H,GAAQr8H,KAAO1Q,GACf+sI,GAAQl3D,UAAYA,GACpBk3D,GAAQj3D,YAAcA,GACtBi3D,GAAQ9pI,MAAQA,EAChB8pI,GAAQ3pI,QAAUA,EAClB2pI,GAAQhqI,OAASA,EACjBgqI,GAAQh3H,IAAMA,EACdg3H,GAAQ/uI,QAAUA,EAClB+uI,GAAQhuI,QAAUA,EAClBguI,GAAQpqI,KAAOA,EACfoqI,GAAQh3D,KAAOA,GACfg3D,GAAQ/2D,MAAQA,GAChB+2D,GAAQplI,MAAQA,EAChBolI,GAAQvrI,QAAUA,EAClBurI,GAAQjuI,QAAUA,EAClBiuI,GAAQnvI,QAAUA,EAClBmvI,GAAQzuI,WAAaA,EACrByuI,GAAQnpI,MAAQA,EAChBmpI,GAAQ92D,sBAAwBA,GAChC82D,GAAQ72D,oBAAsBA,GAC9B62D,GAAQx2D,gBAAkBA,GAC1Bw2D,GAAQn2D,eAAiBA,GACzBm2D,GAAQ91D,iBAAmBA,GAC3B81D,GAAQ51D,oBAAsBA,GAC9B41D,GAAQ11D,sBAAwBA,GAChC01D,GAAQv1D,WAAaA,GACrBu1D,GAAQn1D,gBAAkBA,GAC1Bm1D,GAAQh1D,kBAAoBA,GAC5Bg1D,GAAQ/0D,uBAAyBA,GACjC+0D,GAAQ50D,aAAeA,GACvB40D,GAAQl0D,UAAYA,GACpBk0D,GAAQj0D,WAAaA,GACrBi0D,GAAQ9zD,YAAcA,GACtB8zD,GAAQ5zD,YAAcA,GACtB4zD,GAAQnzD,WAAaA,GACrBmzD,GAAQ3lE,MAAQA,GAChB2lE,GAAQ9lE,KAAOA,GACf8lE,GAAQzhE,UAAYA,GACpByhE,GAAQthE,KAAOA,GACfshE,GAAQjmE,UAAYA,GACpBimE,GAAQtpE,MAAQA,GAChBspE,GAAQp+C,WAAaA,GACrBo+C,GAAQpwE,WAAaA,GACrBowE,GAAQp+F,WAAaA,GACrBo+F,GAAQ9gF,kBAAoBA,GAC5B8gF,GAAQhgF,mBAAqBA,GAC7BggF,GAAQ5/E,yBAA2BA,GACnC4/E,GAAQl9E,oBAAsBA,GAC9Bk9E,GAAQj9E,0BAA4BA,GACpCi9E,GAAQh9E,mBAAqBA,GAC7Bg9E,GAAQ/8E,yBAA2BA,GACnC+8E,GAAQ98E,oBAAsBA,GAC9B88E,GAAQ78E,0BAA4BA,GACpC68E,GAAQ38E,qBAAuBA,GAC/B28E,GAAQ18E,2BAA6BA,GACrC08E,GAAQr/E,mBAAqBA,GAC7Bq/E,GAAQn/E,yBAA2BA,GACnCm/E,GAAQz8E,aAAeA,GACvBy8E,GAAQn8E,mBAAqBA,GAC7Bm8E,GAAQt7E,kBAAoBA,GAC5Bs7E,GAAQl7E,wBAA0BA,GAClCk7E,GAAQt6E,cAAgBA,GACxBs6E,GAAQp6E,oBAAsBA,GAC9Bo6E,GAAQzvE,aAAeA,GACvByvE,GAAQvvE,mBAAqBA,GAC7BuvE,GAAQnvE,eAAiBA,GACzBmvE,GAAQ9uE,qBAAuBA,GAC/B8uE,GAAQ1uE,aAAeA,GACvB0uE,GAAQruE,mBAAqBA,GAC7BquE,GAAQj8H,cAAgBA,EACxBi8H,GAAQh8H,oBAAsBA,EAC9Bg8H,GAAQjuE,cAAgBA,GACxBiuE,GAAQ/tE,oBAAsBA,GAC9B+tE,GAAQxtE,cAAgBA,GACxBwtE,GAAQvtE,oBAAsBA,GAC9ButE,GAAQj1E,gBAAkBA,GAC1Bi1E,GAAQ/0E,sBAAwBA,GAChC+0E,GAAQjtE,cAAgBA,GACxBitE,GAAQxrE,aAAeA,GACvBwrE,GAAQvrE,mBAAqBA,GAC7BurE,GAAQvsE,iBAAmBA,GAC3BusE,GAAQnsE,uBAAyBA,GACjCmsE,GAAQtrE,eAAiBA,GACzBsrE,GAAQrrE,qBAAuBA,GAC/BqrE,GAAQx+H,YAAcA,EACtBw+H,GAAQj+H,kBAAoBA,EAC5Bi+H,GAAQ37G,eAAiBA,GACzB27G,GAAQ17G,eAAiBA,GACzB07G,GAAQprE,kBAAoBA,GAC5BorE,GAAQj4H,eAAiBA,EACzBi4H,GAAQ57G,eAAiBA,GACzB47G,GAAQ/7G,qBAAuBA,GAC/B+7G,GAAQh8G,qBAAuBA,GAC/Bg8G,GAAQl8G,kBAAoBA,GAC5Bk8G,GAAQj8G,iBAAmBA,GAC3Bi8G,GAAQp8G,mBAAqBA,GAC7Bo8G,GAAQn8G,oBAAsBA,GAC9Bm8G,GAAQt8G,kBAAoBA,GAC5Bs8G,GAAQr8G,qBAAuBA,GAC/Bq8G,GAAQp5H,kBAAoBA,EAC5Bo5H,GAAQ77G,mBAAqBA,GAC7B67G,GAAQ97G,kBAAoBA,GAC5B87G,GAAQ37H,SAAWA,EACnB27H,GAAQv/H,uBAAyBA,EACjCu/H,GAAQx/H,uBAAyBA,EACjCw/H,GAAQz/H,sBAAwBA,EAChCy/H,GAAQ1/H,qBAAuBA,EAC/B0/H,GAAQ3/H,sBAAwBA,EAChC2/H,GAAQ5/H,qBAAuBA,EAC/B4/H,GAAQ9/H,4BAA8BA,EACtC8/H,GAAQ//H,qBAAuBA,EAC/B+/H,GAAQhgI,oBAAsBA,EAC9BggI,GAAQpgI,gBAAkBA,EAC1BogI,GAAQ3oE,SAAWA,GACnB2oE,GAAQxnE,iBAAmBA,GAC3BwnE,GAAQ1mE,iBAAmBA,GAC3B0mE,GAAQvmE,kBAAoBA,GAC5BumE,GAAQppE,aAAeA,GACvBopE,GAAQtmE,UAAYA,GACpBsmE,GAAQrmE,WAAaA,GACrBqmE,GAAQpmE,qBAAuBA,GAC/BomE,GAAQnmE,sBAAwBA,GAChCmmE,GAAQlmE,YAAcA,GACtBkmE,GAAQloF,SAAWA,GACnBkoF,GAAQ9vD,MAAQA,GAChB8vD,GAAQjoG,aAAeA,GACvBioG,GAAQ/nG,aAAeA,GACvB+nG,GAAQ7nG,cAAgBA,GACxB6nG,GAAQ1vD,kBAAoBA,GAC5B0vD,GAAQzvD,qBAAuBA,GAC/ByvD,GAAQxvD,sBAAwBA,GAChCwvD,GAAQvvD,eAAiBA,GACzBuvD,GAAQzhH,aAAeA,GACvByhH,GAAQxhH,iBAAmBA,GAC3BwhH,GAAQp7H,UAAYA,GACpBo7H,GAAQ/0H,SAAWA,GACnB+0H,GAAQl6G,WAAaA,GACrBk6G,GAAQtvD,YAAcA,GACtBsvD,GAAQrvD,cAAgBA,GACxBqvD,GAAQl7H,SAAWA,GACnBk7H,GAAQx0D,WAAaA,GACrBw0D,GAAQ/1D,aAAeA,GACvB+1D,GAAQtqG,WAAaA,GACrBsqG,GAAQt7H,eAAiBA,GACzBs7H,GAAQrpG,iBAAmBA,GAC3BqpG,GAAQnpG,oBAAsBA,GAC9BmpG,GAAQhpG,iBAAmBA,GAC3BgpG,GAAQpqG,eAAiBA,GACzBoqG,GAAQ16H,YAAcA,GACtB06H,GAAQ18F,iBAAmBA,GAC3B08F,GAAQx8F,wBAA0BA,GAClCw8F,GAAQx5F,YAAcA,GACtBw5F,GAAQv5F,YAAcA,GACtBu5F,GAAQt8F,WAAaA,GACrBs8F,GAAQr8F,UAAYA,GACpBq8F,GAAQp8F,eAAiBA,GACzBo8F,GAAQn8F,uBAAyBA,GACjCm8F,GAAQ96H,eAAiBA,GACzB86H,GAAQ56H,uBAAyBA,GACjC46H,GAAQl8F,eAAiBA,GACzBk8F,GAAQh8F,uBAAyBA,GACjCg8F,GAAQ97F,eAAiBA,GACzB87F,GAAQ57F,uBAAyBA,GACjC47F,GAAQ17F,uBAAyBA,GACjC07F,GAAQruG,WAAaA,GACrBquG,GAAQnuG,YAAcA,GACtBmuG,GAAQjuG,UAAYA,GACpBiuG,GAAQr6H,eAAiBA,GACzBq6H,GAAQ9tG,WAAaA,GACrB8tG,GAAQ5tG,kBAAoBA,GAC5B4tG,GAAQ1tG,aAAeA,GACvB0tG,GAAQxtG,cAAgBA,GACxBwtG,GAAQ14H,kBAAoBA,GAC5B04H,GAAQ9gH,aAAeA,GACvB8gH,GAAQ7gH,aAAeA,GACvB6gH,GAAQr/G,cAAgBA,GACxBq/G,GAAQlkH,kBAAoBA,GAC5BkkH,GAAQjkH,oBAAsBA,GAC9BikH,GAAQhkH,sBAAwBA,GAChCgkH,GAAQ/jH,kBAAoBA,GAC5B+jH,GAAQpvD,UAAYA,GACpBovD,GAAQvrH,sBAAwBA,GAChCurH,GAAQphH,sBAAwBA,GAChCohH,GAAQjhH,iCAAmCA,GAC3CihH,GAAQhhH,iCAAmCA,GAC3CghH,GAAQ/gH,2BAA6BA,GACrC+gH,GAAQnhH,wBAA0BA,GAClCmhH,GAAQlhH,wBAA0BA,GAClCkhH,GAAQn+F,eAAiBA,GACzBm+F,GAAQzsI,oBAAsBA,GAC9BysI,GAAQj+F,uBAAyBA,GACjCi+F,GAAQrqI,cAAgBA,GACxBqqI,GAAQ1jG,2BAA6BA,GACrC0jG,GAAQzjG,0BAA4BA,GACpCyjG,GAAQxsI,aAAeA,GACvBwsI,GAAQ79F,0BAA4BA,GACpC69F,GAAQvsI,yBAA2BA,GACnCusI,GAAQrsI,iBAAmBA,GAC3BqsI,GAAQp9F,SAAWA,GACnBo9F,GAAQn9F,UAAYA,GACpBm9F,GAAQngG,kBAAoBA,GAC5BmgG,GAAQl9F,QAAUA,GAClBk9F,GAAQlgG,gBAAkBA,GAC1BkgG,GAAQ/gG,UAAYA,GACpB+gG,GAAQ9gG,cAAgBA,GACxB8gG,GAAQ19F,sBAAwBA,GAChC09F,GAAQx9F,sBAAwBA,GAChCw9F,GAAQt9F,qBAAuBA,GAC/Bs9F,GAAQ//F,mBAAqBA,GAC7B+/F,GAAQh9F,YAAcA,GACtBg9F,GAAQrhG,UAAYA,GACpBqhG,GAAQtsI,WAAaA,GACrBssI,GAAQ98F,gBAAkBA,GAC1B88F,GAAQ58F,qBAAuBA,GAC/B48F,GAAQnvD,WAAaA,GACrBmvD,GAAQpgG,YAAcA,GACtBogG,GAAQjgG,mBAAqBA,GAC7BigG,GAAQx7F,qBAAuBA,GAC/Bw7F,GAAQv7F,sBAAwBA,GAChCu7F,GAAQt7F,sBAAwBA,GAChCs7F,GAAQr7F,sBAAwBA,GAChCq7F,GAAQh7F,wBAA0BA,GAClCg7F,GAAQ/6F,wBAA0BA,GAClC+6F,GAAQ96F,yBAA2BA,GACnC86F,GAAQ76F,yBAA2BA,GACnC66F,GAAQx6F,gBAAkBA,GAC1Bw6F,GAAQt6F,qBAAuBA,GAC/Bs6F,GAAQr6F,qBAAuBA,GAC/Bq6F,GAAQp6F,qBAAuBA,GAC/Bo6F,GAAQn6F,qBAAuBA,GAC/Bm6F,GAAQl6F,qBAAuBA,GAC/Bk6F,GAAQj6F,qBAAuBA,GAC/Bi6F,GAAQh6F,qBAAuBA,GAC/Bg6F,GAAQ/5F,qBAAuBA,GAC/B+5F,GAAQ95F,sBAAwBA,GAChC85F,GAAQ75F,sBAAwBA,GAChC65F,GAAQ55F,sBAAwBA,GAChC45F,GAAQ35F,uBAAyBA,GACjC25F,GAAQ15F,uBAAyBA,GACjC05F,GAAQz5F,uBAAyBA,GACjCy5F,GAAQlvD,SAAWA,GACnBkvD,GAAQt5D,WAAaA,GACrBs5D,GAAQjvD,aAAeA,GACvBivD,GAAQhvD,oBAAsBA,GAC9BgvD,GAAQ/uD,kBAAoBA,GAC5B+uD,GAAQ9uD,kBAAoBA,GAC5B8uD,GAAQl6D,oBAAsBA,GAC9Bk6D,GAAQ7uD,gBAAkBA,GAC1B6uD,GAAQ5uD,iBAAmBA,GAC3B4uD,GAAQv2H,kBAAoBA,GAC5Bu2H,GAAQzkF,sBAAwBA,GAChCykF,GAAQxkF,oBAAsBA,GAC9BwkF,GAAQ1rI,eAAiBA,GACzB0rI,GAAQhlH,aAAeA,GACvBglH,GAAQ3kH,cAAgBA,GACxB2kH,GAAQ/kH,aAAeA,GACvB+kH,GAAQ3uD,eAAiBA,GACzB2uD,GAAQ9kH,cAAgBA,GACxB8kH,GAAQ7kH,eAAiBA,GACzB6kH,GAAQ5kH,aAAeA,GACvB4kH,GAAQv0G,kBAAoBA,GAC5Bu0G,GAAQjxG,iBAAmBA,GAC3BixG,GAAQlrE,sBAAwBA,GAChCkrE,GAAQ56G,qBAAuBA,GAC/B46G,GAAQC,aAAez+H,EACvBw+H,GAAQlzD,MAAQA,GAChBkzD,GAAQxG,UAAYA,GACpBwG,GAAQvG,WAAaA,GACrBuG,GAAQjzD,iBAAmBA,GAC3BizD,GAAQ/yD,cAAgBA,GACxB+yD,GAAQ73D,WAAaA,GACrB63D,GAAQ7yD,SAAWA,GACnB6yD,GAAQ5yD,eAAiBA,GACzB4yD,GAAQ3yD,mBAAqBA,GAC7B2yD,GAAQ1yD,sBAAwBA,GAChC0yD,GAAQzyD,uBAAyBA,GACjCyyD,GAAQxyD,OAASA,GACjBwyD,GAAQvyD,uBAAyBA,GACjCuyD,GAAQryD,cAAgBA,GACxBqyD,GAAQpyD,eAAiBA,GACzBoyD,GAAQnyD,sBAAwBA,GAChCmyD,GAAQlyD,eAAiBA,GACzBkyD,GAAQjyD,gBAAkBA,GAC1BiyD,GAAQhyD,eAAiBA,GACzBgyD,GAAQ/xD,gBAAkBA,GAC1B+xD,GAAQ9xD,iBAAmBA,GAC3B8xD,GAAQ7xD,iBAAmBA,GAC3B6xD,GAAQ5xD,mBAAqBA,GAC7B4xD,GAAQ3xD,aAAeA,GACvB2xD,GAAQ1xD,OAASA,GACjB0xD,GAAQzxD,WAAaA,GACrByxD,GAAQxxD,kBAAoBA,GAC5BwxD,GAAQvxD,YAAcA,GACtBuxD,GAAQtxD,gBAAkBA,GAC1BsxD,GAAQrxD,UAAYA,GACpBqxD,GAAQpxD,oBAAsBA,GAC9BoxD,GAAQT,cAAgBA,GACxBS,GAAQnxD,UAAYA,GACpBmxD,GAAQ7wD,eAAiBA,GACzB6wD,GAAQJ,WAAaA,GACrBI,GAAQ5wD,UAAYA,GAEb4wD","file":"../../primitives/three.js","sourcesContent":["define([],function() {\r\n\t'use strict';\r\n\r\n\t// Polyfills\r\n\r\n\tif ( Number.EPSILON === undefined ) {\r\n\r\n\t\tNumber.EPSILON = Math.pow( 2, - 52 );\r\n\r\n\t}\r\n\r\n\tif ( Number.isInteger === undefined ) {\r\n\r\n\t\t// Missing in IE\r\n\t\t// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/isInteger\r\n\r\n\t\tNumber.isInteger = function ( value ) {\r\n\r\n\t\t\treturn typeof value === 'number' && isFinite( value ) && Math.floor( value ) === value;\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tif ( Math.sign === undefined ) {\r\n\r\n\t\t// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/sign\r\n\r\n\t\tMath.sign = function ( x ) {\r\n\r\n\t\t\treturn ( x < 0 ) ? - 1 : ( x > 0 ) ? 1 : + x;\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n\tif ( 'name' in Function.prototype === false ) {\r\n\r\n\t\t// Missing in IE\r\n\t\t// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/name\r\n\r\n\t\tObject.defineProperty( Function.prototype, 'name', {\r\n\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\treturn this.toString().match( /^\\s*function\\s*([^\\(\\s]*)/ )[ 1 ];\r\n\r\n\t\t\t}\r\n\r\n\t\t} );\r\n\r\n\t}\r\n\r\n\tif ( Object.assign === undefined ) {\r\n\r\n\t\t// Missing in IE\r\n\t\t// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign\r\n\r\n\t\t( function () {\r\n\r\n\t\t\tObject.assign = function ( target ) {\r\n\r\n\t\t\t\tif ( target === undefined || target === null ) {\r\n\r\n\t\t\t\t\tthrow new TypeError( 'Cannot convert undefined or null to object' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar output = Object( target );\r\n\r\n\t\t\t\tfor ( var index = 1; index < arguments.length; index ++ ) {\r\n\r\n\t\t\t\t\tvar source = arguments[ index ];\r\n\r\n\t\t\t\t\tif ( source !== undefined && source !== null ) {\r\n\r\n\t\t\t\t\t\tfor ( var nextKey in source ) {\r\n\r\n\t\t\t\t\t\t\tif ( Object.prototype.hasOwnProperty.call( source, nextKey ) ) {\r\n\r\n\t\t\t\t\t\t\t\toutput[ nextKey ] = source[ nextKey ];\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn output;\r\n\r\n\t\t\t};\r\n\r\n\t\t} )();\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * https://github.com/mrdoob/eventdispatcher.js/\r\n\t */\r\n\r\n\tfunction EventDispatcher() {}\r\n\r\n\tObject.assign( EventDispatcher.prototype, {\r\n\r\n\t\taddEventListener: function ( type, listener ) {\r\n\r\n\t\t\tif ( this._listeners === undefined ) this._listeners = {};\r\n\r\n\t\t\tvar listeners = this._listeners;\r\n\r\n\t\t\tif ( listeners[ type ] === undefined ) {\r\n\r\n\t\t\t\tlisteners[ type ] = [];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( listeners[ type ].indexOf( listener ) === - 1 ) {\r\n\r\n\t\t\t\tlisteners[ type ].push( listener );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\thasEventListener: function ( type, listener ) {\r\n\r\n\t\t\tif ( this._listeners === undefined ) return false;\r\n\r\n\t\t\tvar listeners = this._listeners;\r\n\r\n\t\t\treturn listeners[ type ] !== undefined && listeners[ type ].indexOf( listener ) !== - 1;\r\n\r\n\t\t},\r\n\r\n\t\tremoveEventListener: function ( type, listener ) {\r\n\r\n\t\t\tif ( this._listeners === undefined ) return;\r\n\r\n\t\t\tvar listeners = this._listeners;\r\n\t\t\tvar listenerArray = listeners[ type ];\r\n\r\n\t\t\tif ( listenerArray !== undefined ) {\r\n\r\n\t\t\t\tvar index = listenerArray.indexOf( listener );\r\n\r\n\t\t\t\tif ( index !== - 1 ) {\r\n\r\n\t\t\t\t\tlistenerArray.splice( index, 1 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tdispatchEvent: function ( event ) {\r\n\r\n\t\t\tif ( this._listeners === undefined ) return;\r\n\r\n\t\t\tvar listeners = this._listeners;\r\n\t\t\tvar listenerArray = listeners[ event.type ];\r\n\r\n\t\t\tif ( listenerArray !== undefined ) {\r\n\r\n\t\t\t\tevent.target = this;\r\n\r\n\t\t\t\tvar array = listenerArray.slice( 0 );\r\n\r\n\t\t\t\tfor ( var i = 0, l = array.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tarray[ i ].call( this, event );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tvar REVISION = '96dev';\r\n\tvar MOUSE = { LEFT: 0, MIDDLE: 1, RIGHT: 2 };\r\n\tvar CullFaceNone = 0;\r\n\tvar CullFaceBack = 1;\r\n\tvar CullFaceFront = 2;\r\n\tvar CullFaceFrontBack = 3;\r\n\tvar FrontFaceDirectionCW = 0;\r\n\tvar FrontFaceDirectionCCW = 1;\r\n\tvar BasicShadowMap = 0;\r\n\tvar PCFShadowMap = 1;\r\n\tvar PCFSoftShadowMap = 2;\r\n\tvar FrontSide = 0;\r\n\tvar BackSide = 1;\r\n\tvar DoubleSide = 2;\r\n\tvar FlatShading = 1;\r\n\tvar SmoothShading = 2;\r\n\tvar NoColors = 0;\r\n\tvar FaceColors = 1;\r\n\tvar VertexColors = 2;\r\n\tvar NoBlending = 0;\r\n\tvar NormalBlending = 1;\r\n\tvar AdditiveBlending = 2;\r\n\tvar SubtractiveBlending = 3;\r\n\tvar MultiplyBlending = 4;\r\n\tvar CustomBlending = 5;\r\n\tvar AddEquation = 100;\r\n\tvar SubtractEquation = 101;\r\n\tvar ReverseSubtractEquation = 102;\r\n\tvar MinEquation = 103;\r\n\tvar MaxEquation = 104;\r\n\tvar ZeroFactor = 200;\r\n\tvar OneFactor = 201;\r\n\tvar SrcColorFactor = 202;\r\n\tvar OneMinusSrcColorFactor = 203;\r\n\tvar SrcAlphaFactor = 204;\r\n\tvar OneMinusSrcAlphaFactor = 205;\r\n\tvar DstAlphaFactor = 206;\r\n\tvar OneMinusDstAlphaFactor = 207;\r\n\tvar DstColorFactor = 208;\r\n\tvar OneMinusDstColorFactor = 209;\r\n\tvar SrcAlphaSaturateFactor = 210;\r\n\tvar NeverDepth = 0;\r\n\tvar AlwaysDepth = 1;\r\n\tvar LessDepth = 2;\r\n\tvar LessEqualDepth = 3;\r\n\tvar EqualDepth = 4;\r\n\tvar GreaterEqualDepth = 5;\r\n\tvar GreaterDepth = 6;\r\n\tvar NotEqualDepth = 7;\r\n\tvar MultiplyOperation = 0;\r\n\tvar MixOperation = 1;\r\n\tvar AddOperation = 2;\r\n\tvar NoToneMapping = 0;\r\n\tvar LinearToneMapping = 1;\r\n\tvar ReinhardToneMapping = 2;\r\n\tvar Uncharted2ToneMapping = 3;\r\n\tvar CineonToneMapping = 4;\r\n\tvar UVMapping = 300;\r\n\tvar CubeReflectionMapping = 301;\r\n\tvar CubeRefractionMapping = 302;\r\n\tvar EquirectangularReflectionMapping = 303;\r\n\tvar EquirectangularRefractionMapping = 304;\r\n\tvar SphericalReflectionMapping = 305;\r\n\tvar CubeUVReflectionMapping = 306;\r\n\tvar CubeUVRefractionMapping = 307;\r\n\tvar RepeatWrapping = 1000;\r\n\tvar ClampToEdgeWrapping = 1001;\r\n\tvar MirroredRepeatWrapping = 1002;\r\n\tvar NearestFilter = 1003;\r\n\tvar NearestMipMapNearestFilter = 1004;\r\n\tvar NearestMipMapLinearFilter = 1005;\r\n\tvar LinearFilter = 1006;\r\n\tvar LinearMipMapNearestFilter = 1007;\r\n\tvar LinearMipMapLinearFilter = 1008;\r\n\tvar UnsignedByteType = 1009;\r\n\tvar ByteType = 1010;\r\n\tvar ShortType = 1011;\r\n\tvar UnsignedShortType = 1012;\r\n\tvar IntType = 1013;\r\n\tvar UnsignedIntType = 1014;\r\n\tvar FloatType = 1015;\r\n\tvar HalfFloatType = 1016;\r\n\tvar UnsignedShort4444Type = 1017;\r\n\tvar UnsignedShort5551Type = 1018;\r\n\tvar UnsignedShort565Type = 1019;\r\n\tvar UnsignedInt248Type = 1020;\r\n\tvar AlphaFormat = 1021;\r\n\tvar RGBFormat = 1022;\r\n\tvar RGBAFormat = 1023;\r\n\tvar LuminanceFormat = 1024;\r\n\tvar LuminanceAlphaFormat = 1025;\r\n\tvar RGBEFormat = RGBAFormat;\r\n\tvar DepthFormat = 1026;\r\n\tvar DepthStencilFormat = 1027;\r\n\tvar RGB_S3TC_DXT1_Format = 33776;\r\n\tvar RGBA_S3TC_DXT1_Format = 33777;\r\n\tvar RGBA_S3TC_DXT3_Format = 33778;\r\n\tvar RGBA_S3TC_DXT5_Format = 33779;\r\n\tvar RGB_PVRTC_4BPPV1_Format = 35840;\r\n\tvar RGB_PVRTC_2BPPV1_Format = 35841;\r\n\tvar RGBA_PVRTC_4BPPV1_Format = 35842;\r\n\tvar RGBA_PVRTC_2BPPV1_Format = 35843;\r\n\tvar RGB_ETC1_Format = 36196;\r\n\tvar RGBA_ASTC_4x4_Format = 37808;\r\n\tvar RGBA_ASTC_5x4_Format = 37809;\r\n\tvar RGBA_ASTC_5x5_Format = 37810;\r\n\tvar RGBA_ASTC_6x5_Format = 37811;\r\n\tvar RGBA_ASTC_6x6_Format = 37812;\r\n\tvar RGBA_ASTC_8x5_Format = 37813;\r\n\tvar RGBA_ASTC_8x6_Format = 37814;\r\n\tvar RGBA_ASTC_8x8_Format = 37815;\r\n\tvar RGBA_ASTC_10x5_Format = 37816;\r\n\tvar RGBA_ASTC_10x6_Format = 37817;\r\n\tvar RGBA_ASTC_10x8_Format = 37818;\r\n\tvar RGBA_ASTC_10x10_Format = 37819;\r\n\tvar RGBA_ASTC_12x10_Format = 37820;\r\n\tvar RGBA_ASTC_12x12_Format = 37821;\r\n\tvar LoopOnce = 2200;\r\n\tvar LoopRepeat = 2201;\r\n\tvar LoopPingPong = 2202;\r\n\tvar InterpolateDiscrete = 2300;\r\n\tvar InterpolateLinear = 2301;\r\n\tvar InterpolateSmooth = 2302;\r\n\tvar ZeroCurvatureEnding = 2400;\r\n\tvar ZeroSlopeEnding = 2401;\r\n\tvar WrapAroundEnding = 2402;\r\n\tvar TrianglesDrawMode = 0;\r\n\tvar TriangleStripDrawMode = 1;\r\n\tvar TriangleFanDrawMode = 2;\r\n\tvar LinearEncoding = 3000;\r\n\tvar sRGBEncoding = 3001;\r\n\tvar GammaEncoding = 3007;\r\n\tvar RGBEEncoding = 3002;\r\n\tvar LogLuvEncoding = 3003;\r\n\tvar RGBM7Encoding = 3004;\r\n\tvar RGBM16Encoding = 3005;\r\n\tvar RGBDEncoding = 3006;\r\n\tvar BasicDepthPacking = 3200;\r\n\tvar RGBADepthPacking = 3201;\r\n\tvar TangentSpaceNormalMap = 0;\r\n\tvar ObjectSpaceNormalMap = 1;\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tvar _Math = {\r\n\r\n\t\tDEG2RAD: Math.PI / 180,\r\n\t\tRAD2DEG: 180 / Math.PI,\r\n\r\n\t\tgenerateUUID: ( function () {\r\n\r\n\t\t\t// http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/21963136#21963136\r\n\r\n\t\t\tvar lut = [];\r\n\r\n\t\t\tfor ( var i = 0; i < 256; i ++ ) {\r\n\r\n\t\t\t\tlut[ i ] = ( i < 16 ? '0' : '' ) + ( i ).toString( 16 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn function generateUUID() {\r\n\r\n\t\t\t\tvar d0 = Math.random() * 0xffffffff | 0;\r\n\t\t\t\tvar d1 = Math.random() * 0xffffffff | 0;\r\n\t\t\t\tvar d2 = Math.random() * 0xffffffff | 0;\r\n\t\t\t\tvar d3 = Math.random() * 0xffffffff | 0;\r\n\t\t\t\tvar uuid = lut[ d0 & 0xff ] + lut[ d0 >> 8 & 0xff ] + lut[ d0 >> 16 & 0xff ] + lut[ d0 >> 24 & 0xff ] + '-' +\r\n\t\t\t\t\tlut[ d1 & 0xff ] + lut[ d1 >> 8 & 0xff ] + '-' + lut[ d1 >> 16 & 0x0f | 0x40 ] + lut[ d1 >> 24 & 0xff ] + '-' +\r\n\t\t\t\t\tlut[ d2 & 0x3f | 0x80 ] + lut[ d2 >> 8 & 0xff ] + '-' + lut[ d2 >> 16 & 0xff ] + lut[ d2 >> 24 & 0xff ] +\r\n\t\t\t\t\tlut[ d3 & 0xff ] + lut[ d3 >> 8 & 0xff ] + lut[ d3 >> 16 & 0xff ] + lut[ d3 >> 24 & 0xff ];\r\n\r\n\t\t\t\t// .toUpperCase() here flattens concatenated strings to save heap memory space.\r\n\t\t\t\treturn uuid.toUpperCase();\r\n\r\n\t\t\t};\r\n\r\n\t\t} )(),\r\n\r\n\t\tclamp: function ( value, min, max ) {\r\n\r\n\t\t\treturn Math.max( min, Math.min( max, value ) );\r\n\r\n\t\t},\r\n\r\n\t\t// compute euclidian modulo of m % n\r\n\t\t// https://en.wikipedia.org/wiki/Modulo_operation\r\n\r\n\t\teuclideanModulo: function ( n, m ) {\r\n\r\n\t\t\treturn ( ( n % m ) + m ) % m;\r\n\r\n\t\t},\r\n\r\n\t\t// Linear mapping from range <a1, a2> to range <b1, b2>\r\n\r\n\t\tmapLinear: function ( x, a1, a2, b1, b2 ) {\r\n\r\n\t\t\treturn b1 + ( x - a1 ) * ( b2 - b1 ) / ( a2 - a1 );\r\n\r\n\t\t},\r\n\r\n\t\t// https://en.wikipedia.org/wiki/Linear_interpolation\r\n\r\n\t\tlerp: function ( x, y, t ) {\r\n\r\n\t\t\treturn ( 1 - t ) * x + t * y;\r\n\r\n\t\t},\r\n\r\n\t\t// http://en.wikipedia.org/wiki/Smoothstep\r\n\r\n\t\tsmoothstep: function ( x, min, max ) {\r\n\r\n\t\t\tif ( x <= min ) return 0;\r\n\t\t\tif ( x >= max ) return 1;\r\n\r\n\t\t\tx = ( x - min ) / ( max - min );\r\n\r\n\t\t\treturn x * x * ( 3 - 2 * x );\r\n\r\n\t\t},\r\n\r\n\t\tsmootherstep: function ( x, min, max ) {\r\n\r\n\t\t\tif ( x <= min ) return 0;\r\n\t\t\tif ( x >= max ) return 1;\r\n\r\n\t\t\tx = ( x - min ) / ( max - min );\r\n\r\n\t\t\treturn x * x * x * ( x * ( x * 6 - 15 ) + 10 );\r\n\r\n\t\t},\r\n\r\n\t\t// Random integer from <low, high> interval\r\n\r\n\t\trandInt: function ( low, high ) {\r\n\r\n\t\t\treturn low + Math.floor( Math.random() * ( high - low + 1 ) );\r\n\r\n\t\t},\r\n\r\n\t\t// Random float from <low, high> interval\r\n\r\n\t\trandFloat: function ( low, high ) {\r\n\r\n\t\t\treturn low + Math.random() * ( high - low );\r\n\r\n\t\t},\r\n\r\n\t\t// Random float from <-range/2, range/2> interval\r\n\r\n\t\trandFloatSpread: function ( range ) {\r\n\r\n\t\t\treturn range * ( 0.5 - Math.random() );\r\n\r\n\t\t},\r\n\r\n\t\tdegToRad: function ( degrees ) {\r\n\r\n\t\t\treturn degrees * _Math.DEG2RAD;\r\n\r\n\t\t},\r\n\r\n\t\tradToDeg: function ( radians ) {\r\n\r\n\t\t\treturn radians * _Math.RAD2DEG;\r\n\r\n\t\t},\r\n\r\n\t\tisPowerOfTwo: function ( value ) {\r\n\r\n\t\t\treturn ( value & ( value - 1 ) ) === 0 && value !== 0;\r\n\r\n\t\t},\r\n\r\n\t\tceilPowerOfTwo: function ( value ) {\r\n\r\n\t\t\treturn Math.pow( 2, Math.ceil( Math.log( value ) / Math.LN2 ) );\r\n\r\n\t\t},\r\n\r\n\t\tfloorPowerOfTwo: function ( value ) {\r\n\r\n\t\t\treturn Math.pow( 2, Math.floor( Math.log( value ) / Math.LN2 ) );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author philogb / http://blog.thejit.org/\r\n\t * @author egraether / http://egraether.com/\r\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\r\n\t */\r\n\r\n\tfunction Vector2( x, y ) {\r\n\r\n\t\tthis.x = x || 0;\r\n\t\tthis.y = y || 0;\r\n\r\n\t}\r\n\r\n\tObject.defineProperties( Vector2.prototype, {\r\n\r\n\t\t\"width\": {\r\n\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\treturn this.x;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tthis.x = value;\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t\"height\": {\r\n\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\treturn this.y;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tthis.y = value;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( Vector2.prototype, {\r\n\r\n\t\tisVector2: true,\r\n\r\n\t\tset: function ( x, y ) {\r\n\r\n\t\t\tthis.x = x;\r\n\t\t\tthis.y = y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetScalar: function ( scalar ) {\r\n\r\n\t\t\tthis.x = scalar;\r\n\t\t\tthis.y = scalar;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetX: function ( x ) {\r\n\r\n\t\t\tthis.x = x;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetY: function ( y ) {\r\n\r\n\t\t\tthis.y = y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetComponent: function ( index, value ) {\r\n\r\n\t\t\tswitch ( index ) {\r\n\r\n\t\t\t\tcase 0: this.x = value; break;\r\n\t\t\t\tcase 1: this.y = value; break;\r\n\t\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetComponent: function ( index ) {\r\n\r\n\t\t\tswitch ( index ) {\r\n\r\n\t\t\t\tcase 0: return this.x;\r\n\t\t\t\tcase 1: return this.y;\r\n\t\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor( this.x, this.y );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( v ) {\r\n\r\n\t\t\tthis.x = v.x;\r\n\t\t\tthis.y = v.y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tadd: function ( v, w ) {\r\n\r\n\t\t\tif ( w !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\r\n\t\t\t\treturn this.addVectors( v, w );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.x += v.x;\r\n\t\t\tthis.y += v.y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\taddScalar: function ( s ) {\r\n\r\n\t\t\tthis.x += s;\r\n\t\t\tthis.y += s;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\taddVectors: function ( a, b ) {\r\n\r\n\t\t\tthis.x = a.x + b.x;\r\n\t\t\tthis.y = a.y + b.y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\taddScaledVector: function ( v, s ) {\r\n\r\n\t\t\tthis.x += v.x * s;\r\n\t\t\tthis.y += v.y * s;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsub: function ( v, w ) {\r\n\r\n\t\t\tif ( w !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.' );\r\n\t\t\t\treturn this.subVectors( v, w );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.x -= v.x;\r\n\t\t\tthis.y -= v.y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsubScalar: function ( s ) {\r\n\r\n\t\t\tthis.x -= s;\r\n\t\t\tthis.y -= s;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsubVectors: function ( a, b ) {\r\n\r\n\t\t\tthis.x = a.x - b.x;\r\n\t\t\tthis.y = a.y - b.y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmultiply: function ( v ) {\r\n\r\n\t\t\tthis.x *= v.x;\r\n\t\t\tthis.y *= v.y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmultiplyScalar: function ( scalar ) {\r\n\r\n\t\t\tthis.x *= scalar;\r\n\t\t\tthis.y *= scalar;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tdivide: function ( v ) {\r\n\r\n\t\t\tthis.x /= v.x;\r\n\t\t\tthis.y /= v.y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tdivideScalar: function ( scalar ) {\r\n\r\n\t\t\treturn this.multiplyScalar( 1 / scalar );\r\n\r\n\t\t},\r\n\r\n\t\tapplyMatrix3: function ( m ) {\r\n\r\n\t\t\tvar x = this.x, y = this.y;\r\n\t\t\tvar e = m.elements;\r\n\r\n\t\t\tthis.x = e[ 0 ] * x + e[ 3 ] * y + e[ 6 ];\r\n\t\t\tthis.y = e[ 1 ] * x + e[ 4 ] * y + e[ 7 ];\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmin: function ( v ) {\r\n\r\n\t\t\tthis.x = Math.min( this.x, v.x );\r\n\t\t\tthis.y = Math.min( this.y, v.y );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmax: function ( v ) {\r\n\r\n\t\t\tthis.x = Math.max( this.x, v.x );\r\n\t\t\tthis.y = Math.max( this.y, v.y );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclamp: function ( min, max ) {\r\n\r\n\t\t\t// assumes min < max, componentwise\r\n\r\n\t\t\tthis.x = Math.max( min.x, Math.min( max.x, this.x ) );\r\n\t\t\tthis.y = Math.max( min.y, Math.min( max.y, this.y ) );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclampScalar: function () {\r\n\r\n\t\t\tvar min = new Vector2();\r\n\t\t\tvar max = new Vector2();\r\n\r\n\t\t\treturn function clampScalar( minVal, maxVal ) {\r\n\r\n\t\t\t\tmin.set( minVal, minVal );\r\n\t\t\t\tmax.set( maxVal, maxVal );\r\n\r\n\t\t\t\treturn this.clamp( min, max );\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tclampLength: function ( min, max ) {\r\n\r\n\t\t\tvar length = this.length();\r\n\r\n\t\t\treturn this.divideScalar( length || 1 ).multiplyScalar( Math.max( min, Math.min( max, length ) ) );\r\n\r\n\t\t},\r\n\r\n\t\tfloor: function () {\r\n\r\n\t\t\tthis.x = Math.floor( this.x );\r\n\t\t\tthis.y = Math.floor( this.y );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tceil: function () {\r\n\r\n\t\t\tthis.x = Math.ceil( this.x );\r\n\t\t\tthis.y = Math.ceil( this.y );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tround: function () {\r\n\r\n\t\t\tthis.x = Math.round( this.x );\r\n\t\t\tthis.y = Math.round( this.y );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\troundToZero: function () {\r\n\r\n\t\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\r\n\t\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tnegate: function () {\r\n\r\n\t\t\tthis.x = - this.x;\r\n\t\t\tthis.y = - this.y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tdot: function ( v ) {\r\n\r\n\t\t\treturn this.x * v.x + this.y * v.y;\r\n\r\n\t\t},\r\n\r\n\t\tcross: function ( v ) {\r\n\r\n\t\t\treturn this.x * v.y - this.y * v.x;\r\n\r\n\t\t},\r\n\r\n\t\tlengthSq: function () {\r\n\r\n\t\t\treturn this.x * this.x + this.y * this.y;\r\n\r\n\t\t},\r\n\r\n\t\tlength: function () {\r\n\r\n\t\t\treturn Math.sqrt( this.x * this.x + this.y * this.y );\r\n\r\n\t\t},\r\n\r\n\t\tmanhattanLength: function () {\r\n\r\n\t\t\treturn Math.abs( this.x ) + Math.abs( this.y );\r\n\r\n\t\t},\r\n\r\n\t\tnormalize: function () {\r\n\r\n\t\t\treturn this.divideScalar( this.length() || 1 );\r\n\r\n\t\t},\r\n\r\n\t\tangle: function () {\r\n\r\n\t\t\t// computes the angle in radians with respect to the positive x-axis\r\n\r\n\t\t\tvar angle = Math.atan2( this.y, this.x );\r\n\r\n\t\t\tif ( angle < 0 ) angle += 2 * Math.PI;\r\n\r\n\t\t\treturn angle;\r\n\r\n\t\t},\r\n\r\n\t\tdistanceTo: function ( v ) {\r\n\r\n\t\t\treturn Math.sqrt( this.distanceToSquared( v ) );\r\n\r\n\t\t},\r\n\r\n\t\tdistanceToSquared: function ( v ) {\r\n\r\n\t\t\tvar dx = this.x - v.x, dy = this.y - v.y;\r\n\t\t\treturn dx * dx + dy * dy;\r\n\r\n\t\t},\r\n\r\n\t\tmanhattanDistanceTo: function ( v ) {\r\n\r\n\t\t\treturn Math.abs( this.x - v.x ) + Math.abs( this.y - v.y );\r\n\r\n\t\t},\r\n\r\n\t\tsetLength: function ( length ) {\r\n\r\n\t\t\treturn this.normalize().multiplyScalar( length );\r\n\r\n\t\t},\r\n\r\n\t\tlerp: function ( v, alpha ) {\r\n\r\n\t\t\tthis.x += ( v.x - this.x ) * alpha;\r\n\t\t\tthis.y += ( v.y - this.y ) * alpha;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tlerpVectors: function ( v1, v2, alpha ) {\r\n\r\n\t\t\treturn this.subVectors( v2, v1 ).multiplyScalar( alpha ).add( v1 );\r\n\r\n\t\t},\r\n\r\n\t\tequals: function ( v ) {\r\n\r\n\t\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) );\r\n\r\n\t\t},\r\n\r\n\t\tfromArray: function ( array, offset ) {\r\n\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\t\tthis.x = array[ offset ];\r\n\t\t\tthis.y = array[ offset + 1 ];\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoArray: function ( array, offset ) {\r\n\r\n\t\t\tif ( array === undefined ) array = [];\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\t\tarray[ offset ] = this.x;\r\n\t\t\tarray[ offset + 1 ] = this.y;\r\n\r\n\t\t\treturn array;\r\n\r\n\t\t},\r\n\r\n\t\tfromBufferAttribute: function ( attribute, index, offset ) {\r\n\r\n\t\t\tif ( offset !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Vector2: offset has been removed from .fromBufferAttribute().' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.x = attribute.getX( index );\r\n\t\t\tthis.y = attribute.getY( index );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\trotateAround: function ( center, angle ) {\r\n\r\n\t\t\tvar c = Math.cos( angle ), s = Math.sin( angle );\r\n\r\n\t\t\tvar x = this.x - center.x;\r\n\t\t\tvar y = this.y - center.y;\r\n\r\n\t\t\tthis.x = x * c - y * s + center.x;\r\n\t\t\tthis.y = x * s + y * c + center.y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author supereggbert / http://www.paulbrunt.co.uk/\r\n\t * @author philogb / http://blog.thejit.org/\r\n\t * @author jordi_ros / http://plattsoft.com\r\n\t * @author D1plo1d / http://github.com/D1plo1d\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author timknip / http://www.floorplanner.com/\r\n\t * @author bhouston / http://clara.io\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t */\r\n\r\n\tfunction Matrix4() {\r\n\r\n\t\tthis.elements = [\r\n\r\n\t\t\t1, 0, 0, 0,\r\n\t\t\t0, 1, 0, 0,\r\n\t\t\t0, 0, 1, 0,\r\n\t\t\t0, 0, 0, 1\r\n\r\n\t\t];\r\n\r\n\t\tif ( arguments.length > 0 ) {\r\n\r\n\t\t\tconsole.error( 'THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.' );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tObject.assign( Matrix4.prototype, {\r\n\r\n\t\tisMatrix4: true,\r\n\r\n\t\tset: function ( n11, n12, n13, n14, n21, n22, n23, n24, n31, n32, n33, n34, n41, n42, n43, n44 ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tte[ 0 ] = n11; te[ 4 ] = n12; te[ 8 ] = n13; te[ 12 ] = n14;\r\n\t\t\tte[ 1 ] = n21; te[ 5 ] = n22; te[ 9 ] = n23; te[ 13 ] = n24;\r\n\t\t\tte[ 2 ] = n31; te[ 6 ] = n32; te[ 10 ] = n33; te[ 14 ] = n34;\r\n\t\t\tte[ 3 ] = n41; te[ 7 ] = n42; te[ 11 ] = n43; te[ 15 ] = n44;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tidentity: function () {\r\n\r\n\t\t\tthis.set(\r\n\r\n\t\t\t\t1, 0, 0, 0,\r\n\t\t\t\t0, 1, 0, 0,\r\n\t\t\t\t0, 0, 1, 0,\r\n\t\t\t\t0, 0, 0, 1\r\n\r\n\t\t\t);\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new Matrix4().fromArray( this.elements );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( m ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\t\t\tvar me = m.elements;\r\n\r\n\t\t\tte[ 0 ] = me[ 0 ]; te[ 1 ] = me[ 1 ]; te[ 2 ] = me[ 2 ]; te[ 3 ] = me[ 3 ];\r\n\t\t\tte[ 4 ] = me[ 4 ]; te[ 5 ] = me[ 5 ]; te[ 6 ] = me[ 6 ]; te[ 7 ] = me[ 7 ];\r\n\t\t\tte[ 8 ] = me[ 8 ]; te[ 9 ] = me[ 9 ]; te[ 10 ] = me[ 10 ]; te[ 11 ] = me[ 11 ];\r\n\t\t\tte[ 12 ] = me[ 12 ]; te[ 13 ] = me[ 13 ]; te[ 14 ] = me[ 14 ]; te[ 15 ] = me[ 15 ];\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcopyPosition: function ( m ) {\r\n\r\n\t\t\tvar te = this.elements, me = m.elements;\r\n\r\n\t\t\tte[ 12 ] = me[ 12 ];\r\n\t\t\tte[ 13 ] = me[ 13 ];\r\n\t\t\tte[ 14 ] = me[ 14 ];\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\textractBasis: function ( xAxis, yAxis, zAxis ) {\r\n\r\n\t\t\txAxis.setFromMatrixColumn( this, 0 );\r\n\t\t\tyAxis.setFromMatrixColumn( this, 1 );\r\n\t\t\tzAxis.setFromMatrixColumn( this, 2 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmakeBasis: function ( xAxis, yAxis, zAxis ) {\r\n\r\n\t\t\tthis.set(\r\n\t\t\t\txAxis.x, yAxis.x, zAxis.x, 0,\r\n\t\t\t\txAxis.y, yAxis.y, zAxis.y, 0,\r\n\t\t\t\txAxis.z, yAxis.z, zAxis.z, 0,\r\n\t\t\t\t0, 0, 0, 1\r\n\t\t\t);\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\textractRotation: function () {\r\n\r\n\t\t\tvar v1 = new Vector3();\r\n\r\n\t\t\treturn function extractRotation( m ) {\r\n\r\n\t\t\t\t// this method does not support reflection matrices\r\n\r\n\t\t\t\tvar te = this.elements;\r\n\t\t\t\tvar me = m.elements;\r\n\r\n\t\t\t\tvar scaleX = 1 / v1.setFromMatrixColumn( m, 0 ).length();\r\n\t\t\t\tvar scaleY = 1 / v1.setFromMatrixColumn( m, 1 ).length();\r\n\t\t\t\tvar scaleZ = 1 / v1.setFromMatrixColumn( m, 2 ).length();\r\n\r\n\t\t\t\tte[ 0 ] = me[ 0 ] * scaleX;\r\n\t\t\t\tte[ 1 ] = me[ 1 ] * scaleX;\r\n\t\t\t\tte[ 2 ] = me[ 2 ] * scaleX;\r\n\t\t\t\tte[ 3 ] = 0;\r\n\r\n\t\t\t\tte[ 4 ] = me[ 4 ] * scaleY;\r\n\t\t\t\tte[ 5 ] = me[ 5 ] * scaleY;\r\n\t\t\t\tte[ 6 ] = me[ 6 ] * scaleY;\r\n\t\t\t\tte[ 7 ] = 0;\r\n\r\n\t\t\t\tte[ 8 ] = me[ 8 ] * scaleZ;\r\n\t\t\t\tte[ 9 ] = me[ 9 ] * scaleZ;\r\n\t\t\t\tte[ 10 ] = me[ 10 ] * scaleZ;\r\n\t\t\t\tte[ 11 ] = 0;\r\n\r\n\t\t\t\tte[ 12 ] = 0;\r\n\t\t\t\tte[ 13 ] = 0;\r\n\t\t\t\tte[ 14 ] = 0;\r\n\t\t\t\tte[ 15 ] = 1;\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tmakeRotationFromEuler: function ( euler ) {\r\n\r\n\t\t\tif ( ! ( euler && euler.isEuler ) ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tvar x = euler.x, y = euler.y, z = euler.z;\r\n\t\t\tvar a = Math.cos( x ), b = Math.sin( x );\r\n\t\t\tvar c = Math.cos( y ), d = Math.sin( y );\r\n\t\t\tvar e = Math.cos( z ), f = Math.sin( z );\r\n\r\n\t\t\tif ( euler.order === 'XYZ' ) {\r\n\r\n\t\t\t\tvar ae = a * e, af = a * f, be = b * e, bf = b * f;\r\n\r\n\t\t\t\tte[ 0 ] = c * e;\r\n\t\t\t\tte[ 4 ] = - c * f;\r\n\t\t\t\tte[ 8 ] = d;\r\n\r\n\t\t\t\tte[ 1 ] = af + be * d;\r\n\t\t\t\tte[ 5 ] = ae - bf * d;\r\n\t\t\t\tte[ 9 ] = - b * c;\r\n\r\n\t\t\t\tte[ 2 ] = bf - ae * d;\r\n\t\t\t\tte[ 6 ] = be + af * d;\r\n\t\t\t\tte[ 10 ] = a * c;\r\n\r\n\t\t\t} else if ( euler.order === 'YXZ' ) {\r\n\r\n\t\t\t\tvar ce = c * e, cf = c * f, de = d * e, df = d * f;\r\n\r\n\t\t\t\tte[ 0 ] = ce + df * b;\r\n\t\t\t\tte[ 4 ] = de * b - cf;\r\n\t\t\t\tte[ 8 ] = a * d;\r\n\r\n\t\t\t\tte[ 1 ] = a * f;\r\n\t\t\t\tte[ 5 ] = a * e;\r\n\t\t\t\tte[ 9 ] = - b;\r\n\r\n\t\t\t\tte[ 2 ] = cf * b - de;\r\n\t\t\t\tte[ 6 ] = df + ce * b;\r\n\t\t\t\tte[ 10 ] = a * c;\r\n\r\n\t\t\t} else if ( euler.order === 'ZXY' ) {\r\n\r\n\t\t\t\tvar ce = c * e, cf = c * f, de = d * e, df = d * f;\r\n\r\n\t\t\t\tte[ 0 ] = ce - df * b;\r\n\t\t\t\tte[ 4 ] = - a * f;\r\n\t\t\t\tte[ 8 ] = de + cf * b;\r\n\r\n\t\t\t\tte[ 1 ] = cf + de * b;\r\n\t\t\t\tte[ 5 ] = a * e;\r\n\t\t\t\tte[ 9 ] = df - ce * b;\r\n\r\n\t\t\t\tte[ 2 ] = - a * d;\r\n\t\t\t\tte[ 6 ] = b;\r\n\t\t\t\tte[ 10 ] = a * c;\r\n\r\n\t\t\t} else if ( euler.order === 'ZYX' ) {\r\n\r\n\t\t\t\tvar ae = a * e, af = a * f, be = b * e, bf = b * f;\r\n\r\n\t\t\t\tte[ 0 ] = c * e;\r\n\t\t\t\tte[ 4 ] = be * d - af;\r\n\t\t\t\tte[ 8 ] = ae * d + bf;\r\n\r\n\t\t\t\tte[ 1 ] = c * f;\r\n\t\t\t\tte[ 5 ] = bf * d + ae;\r\n\t\t\t\tte[ 9 ] = af * d - be;\r\n\r\n\t\t\t\tte[ 2 ] = - d;\r\n\t\t\t\tte[ 6 ] = b * c;\r\n\t\t\t\tte[ 10 ] = a * c;\r\n\r\n\t\t\t} else if ( euler.order === 'YZX' ) {\r\n\r\n\t\t\t\tvar ac = a * c, ad = a * d, bc = b * c, bd = b * d;\r\n\r\n\t\t\t\tte[ 0 ] = c * e;\r\n\t\t\t\tte[ 4 ] = bd - ac * f;\r\n\t\t\t\tte[ 8 ] = bc * f + ad;\r\n\r\n\t\t\t\tte[ 1 ] = f;\r\n\t\t\t\tte[ 5 ] = a * e;\r\n\t\t\t\tte[ 9 ] = - b * e;\r\n\r\n\t\t\t\tte[ 2 ] = - d * e;\r\n\t\t\t\tte[ 6 ] = ad * f + bc;\r\n\t\t\t\tte[ 10 ] = ac - bd * f;\r\n\r\n\t\t\t} else if ( euler.order === 'XZY' ) {\r\n\r\n\t\t\t\tvar ac = a * c, ad = a * d, bc = b * c, bd = b * d;\r\n\r\n\t\t\t\tte[ 0 ] = c * e;\r\n\t\t\t\tte[ 4 ] = - f;\r\n\t\t\t\tte[ 8 ] = d * e;\r\n\r\n\t\t\t\tte[ 1 ] = ac * f + bd;\r\n\t\t\t\tte[ 5 ] = a * e;\r\n\t\t\t\tte[ 9 ] = ad * f - bc;\r\n\r\n\t\t\t\tte[ 2 ] = bc * f - ad;\r\n\t\t\t\tte[ 6 ] = b * e;\r\n\t\t\t\tte[ 10 ] = bd * f + ac;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// bottom row\r\n\t\t\tte[ 3 ] = 0;\r\n\t\t\tte[ 7 ] = 0;\r\n\t\t\tte[ 11 ] = 0;\r\n\r\n\t\t\t// last column\r\n\t\t\tte[ 12 ] = 0;\r\n\t\t\tte[ 13 ] = 0;\r\n\t\t\tte[ 14 ] = 0;\r\n\t\t\tte[ 15 ] = 1;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmakeRotationFromQuaternion: function () {\r\n\r\n\t\t\tvar zero = new Vector3( 0, 0, 0 );\r\n\t\t\tvar one = new Vector3( 1, 1, 1 );\r\n\r\n\t\t\treturn function makeRotationFromQuaternion( q ) {\r\n\r\n\t\t\t\treturn this.compose( zero, q, one );\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tlookAt: function () {\r\n\r\n\t\t\tvar x = new Vector3();\r\n\t\t\tvar y = new Vector3();\r\n\t\t\tvar z = new Vector3();\r\n\r\n\t\t\treturn function lookAt( eye, target, up ) {\r\n\r\n\t\t\t\tvar te = this.elements;\r\n\r\n\t\t\t\tz.subVectors( eye, target );\r\n\r\n\t\t\t\tif ( z.lengthSq() === 0 ) {\r\n\r\n\t\t\t\t\t// eye and target are in the same position\r\n\r\n\t\t\t\t\tz.z = 1;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tz.normalize();\r\n\t\t\t\tx.crossVectors( up, z );\r\n\r\n\t\t\t\tif ( x.lengthSq() === 0 ) {\r\n\r\n\t\t\t\t\t// up and z are parallel\r\n\r\n\t\t\t\t\tif ( Math.abs( up.z ) === 1 ) {\r\n\r\n\t\t\t\t\t\tz.x += 0.0001;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tz.z += 0.0001;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tz.normalize();\r\n\t\t\t\t\tx.crossVectors( up, z );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tx.normalize();\r\n\t\t\t\ty.crossVectors( z, x );\r\n\r\n\t\t\t\tte[ 0 ] = x.x; te[ 4 ] = y.x; te[ 8 ] = z.x;\r\n\t\t\t\tte[ 1 ] = x.y; te[ 5 ] = y.y; te[ 9 ] = z.y;\r\n\t\t\t\tte[ 2 ] = x.z; te[ 6 ] = y.z; te[ 10 ] = z.z;\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tmultiply: function ( m, n ) {\r\n\r\n\t\t\tif ( n !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead.' );\r\n\t\t\t\treturn this.multiplyMatrices( m, n );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this.multiplyMatrices( this, m );\r\n\r\n\t\t},\r\n\r\n\t\tpremultiply: function ( m ) {\r\n\r\n\t\t\treturn this.multiplyMatrices( m, this );\r\n\r\n\t\t},\r\n\r\n\t\tmultiplyMatrices: function ( a, b ) {\r\n\r\n\t\t\tvar ae = a.elements;\r\n\t\t\tvar be = b.elements;\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tvar a11 = ae[ 0 ], a12 = ae[ 4 ], a13 = ae[ 8 ], a14 = ae[ 12 ];\r\n\t\t\tvar a21 = ae[ 1 ], a22 = ae[ 5 ], a23 = ae[ 9 ], a24 = ae[ 13 ];\r\n\t\t\tvar a31 = ae[ 2 ], a32 = ae[ 6 ], a33 = ae[ 10 ], a34 = ae[ 14 ];\r\n\t\t\tvar a41 = ae[ 3 ], a42 = ae[ 7 ], a43 = ae[ 11 ], a44 = ae[ 15 ];\r\n\r\n\t\t\tvar b11 = be[ 0 ], b12 = be[ 4 ], b13 = be[ 8 ], b14 = be[ 12 ];\r\n\t\t\tvar b21 = be[ 1 ], b22 = be[ 5 ], b23 = be[ 9 ], b24 = be[ 13 ];\r\n\t\t\tvar b31 = be[ 2 ], b32 = be[ 6 ], b33 = be[ 10 ], b34 = be[ 14 ];\r\n\t\t\tvar b41 = be[ 3 ], b42 = be[ 7 ], b43 = be[ 11 ], b44 = be[ 15 ];\r\n\r\n\t\t\tte[ 0 ] = a11 * b11 + a12 * b21 + a13 * b31 + a14 * b41;\r\n\t\t\tte[ 4 ] = a11 * b12 + a12 * b22 + a13 * b32 + a14 * b42;\r\n\t\t\tte[ 8 ] = a11 * b13 + a12 * b23 + a13 * b33 + a14 * b43;\r\n\t\t\tte[ 12 ] = a11 * b14 + a12 * b24 + a13 * b34 + a14 * b44;\r\n\r\n\t\t\tte[ 1 ] = a21 * b11 + a22 * b21 + a23 * b31 + a24 * b41;\r\n\t\t\tte[ 5 ] = a21 * b12 + a22 * b22 + a23 * b32 + a24 * b42;\r\n\t\t\tte[ 9 ] = a21 * b13 + a22 * b23 + a23 * b33 + a24 * b43;\r\n\t\t\tte[ 13 ] = a21 * b14 + a22 * b24 + a23 * b34 + a24 * b44;\r\n\r\n\t\t\tte[ 2 ] = a31 * b11 + a32 * b21 + a33 * b31 + a34 * b41;\r\n\t\t\tte[ 6 ] = a31 * b12 + a32 * b22 + a33 * b32 + a34 * b42;\r\n\t\t\tte[ 10 ] = a31 * b13 + a32 * b23 + a33 * b33 + a34 * b43;\r\n\t\t\tte[ 14 ] = a31 * b14 + a32 * b24 + a33 * b34 + a34 * b44;\r\n\r\n\t\t\tte[ 3 ] = a41 * b11 + a42 * b21 + a43 * b31 + a44 * b41;\r\n\t\t\tte[ 7 ] = a41 * b12 + a42 * b22 + a43 * b32 + a44 * b42;\r\n\t\t\tte[ 11 ] = a41 * b13 + a42 * b23 + a43 * b33 + a44 * b43;\r\n\t\t\tte[ 15 ] = a41 * b14 + a42 * b24 + a43 * b34 + a44 * b44;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmultiplyScalar: function ( s ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tte[ 0 ] *= s; te[ 4 ] *= s; te[ 8 ] *= s; te[ 12 ] *= s;\r\n\t\t\tte[ 1 ] *= s; te[ 5 ] *= s; te[ 9 ] *= s; te[ 13 ] *= s;\r\n\t\t\tte[ 2 ] *= s; te[ 6 ] *= s; te[ 10 ] *= s; te[ 14 ] *= s;\r\n\t\t\tte[ 3 ] *= s; te[ 7 ] *= s; te[ 11 ] *= s; te[ 15 ] *= s;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tapplyToBufferAttribute: function () {\r\n\r\n\t\t\tvar v1 = new Vector3();\r\n\r\n\t\t\treturn function applyToBufferAttribute( attribute ) {\r\n\r\n\t\t\t\tfor ( var i = 0, l = attribute.count; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tv1.x = attribute.getX( i );\r\n\t\t\t\t\tv1.y = attribute.getY( i );\r\n\t\t\t\t\tv1.z = attribute.getZ( i );\r\n\r\n\t\t\t\t\tv1.applyMatrix4( this );\r\n\r\n\t\t\t\t\tattribute.setXYZ( i, v1.x, v1.y, v1.z );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn attribute;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tdeterminant: function () {\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tvar n11 = te[ 0 ], n12 = te[ 4 ], n13 = te[ 8 ], n14 = te[ 12 ];\r\n\t\t\tvar n21 = te[ 1 ], n22 = te[ 5 ], n23 = te[ 9 ], n24 = te[ 13 ];\r\n\t\t\tvar n31 = te[ 2 ], n32 = te[ 6 ], n33 = te[ 10 ], n34 = te[ 14 ];\r\n\t\t\tvar n41 = te[ 3 ], n42 = te[ 7 ], n43 = te[ 11 ], n44 = te[ 15 ];\r\n\r\n\t\t\t//TODO: make this more efficient\r\n\t\t\t//( based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm )\r\n\r\n\t\t\treturn (\r\n\t\t\t\tn41 * (\r\n\t\t\t\t\t+ n14 * n23 * n32\r\n\t\t\t\t\t - n13 * n24 * n32\r\n\t\t\t\t\t - n14 * n22 * n33\r\n\t\t\t\t\t + n12 * n24 * n33\r\n\t\t\t\t\t + n13 * n22 * n34\r\n\t\t\t\t\t - n12 * n23 * n34\r\n\t\t\t\t) +\r\n\t\t\t\tn42 * (\r\n\t\t\t\t\t+ n11 * n23 * n34\r\n\t\t\t\t\t - n11 * n24 * n33\r\n\t\t\t\t\t + n14 * n21 * n33\r\n\t\t\t\t\t - n13 * n21 * n34\r\n\t\t\t\t\t + n13 * n24 * n31\r\n\t\t\t\t\t - n14 * n23 * n31\r\n\t\t\t\t) +\r\n\t\t\t\tn43 * (\r\n\t\t\t\t\t+ n11 * n24 * n32\r\n\t\t\t\t\t - n11 * n22 * n34\r\n\t\t\t\t\t - n14 * n21 * n32\r\n\t\t\t\t\t + n12 * n21 * n34\r\n\t\t\t\t\t + n14 * n22 * n31\r\n\t\t\t\t\t - n12 * n24 * n31\r\n\t\t\t\t) +\r\n\t\t\t\tn44 * (\r\n\t\t\t\t\t- n13 * n22 * n31\r\n\t\t\t\t\t - n11 * n23 * n32\r\n\t\t\t\t\t + n11 * n22 * n33\r\n\t\t\t\t\t + n13 * n21 * n32\r\n\t\t\t\t\t - n12 * n21 * n33\r\n\t\t\t\t\t + n12 * n23 * n31\r\n\t\t\t\t)\r\n\r\n\t\t\t);\r\n\r\n\t\t},\r\n\r\n\t\ttranspose: function () {\r\n\r\n\t\t\tvar te = this.elements;\r\n\t\t\tvar tmp;\r\n\r\n\t\t\ttmp = te[ 1 ]; te[ 1 ] = te[ 4 ]; te[ 4 ] = tmp;\r\n\t\t\ttmp = te[ 2 ]; te[ 2 ] = te[ 8 ]; te[ 8 ] = tmp;\r\n\t\t\ttmp = te[ 6 ]; te[ 6 ] = te[ 9 ]; te[ 9 ] = tmp;\r\n\r\n\t\t\ttmp = te[ 3 ]; te[ 3 ] = te[ 12 ]; te[ 12 ] = tmp;\r\n\t\t\ttmp = te[ 7 ]; te[ 7 ] = te[ 13 ]; te[ 13 ] = tmp;\r\n\t\t\ttmp = te[ 11 ]; te[ 11 ] = te[ 14 ]; te[ 14 ] = tmp;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetPosition: function ( v ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tte[ 12 ] = v.x;\r\n\t\t\tte[ 13 ] = v.y;\r\n\t\t\tte[ 14 ] = v.z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetInverse: function ( m, throwOnDegenerate ) {\r\n\r\n\t\t\t// based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm\r\n\t\t\tvar te = this.elements,\r\n\t\t\t\tme = m.elements,\r\n\r\n\t\t\t\tn11 = me[ 0 ], n21 = me[ 1 ], n31 = me[ 2 ], n41 = me[ 3 ],\r\n\t\t\t\tn12 = me[ 4 ], n22 = me[ 5 ], n32 = me[ 6 ], n42 = me[ 7 ],\r\n\t\t\t\tn13 = me[ 8 ], n23 = me[ 9 ], n33 = me[ 10 ], n43 = me[ 11 ],\r\n\t\t\t\tn14 = me[ 12 ], n24 = me[ 13 ], n34 = me[ 14 ], n44 = me[ 15 ],\r\n\r\n\t\t\t\tt11 = n23 * n34 * n42 - n24 * n33 * n42 + n24 * n32 * n43 - n22 * n34 * n43 - n23 * n32 * n44 + n22 * n33 * n44,\r\n\t\t\t\tt12 = n14 * n33 * n42 - n13 * n34 * n42 - n14 * n32 * n43 + n12 * n34 * n43 + n13 * n32 * n44 - n12 * n33 * n44,\r\n\t\t\t\tt13 = n13 * n24 * n42 - n14 * n23 * n42 + n14 * n22 * n43 - n12 * n24 * n43 - n13 * n22 * n44 + n12 * n23 * n44,\r\n\t\t\t\tt14 = n14 * n23 * n32 - n13 * n24 * n32 - n14 * n22 * n33 + n12 * n24 * n33 + n13 * n22 * n34 - n12 * n23 * n34;\r\n\r\n\t\t\tvar det = n11 * t11 + n21 * t12 + n31 * t13 + n41 * t14;\r\n\r\n\t\t\tif ( det === 0 ) {\r\n\r\n\t\t\t\tvar msg = \"THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0\";\r\n\r\n\t\t\t\tif ( throwOnDegenerate === true ) {\r\n\r\n\t\t\t\t\tthrow new Error( msg );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tconsole.warn( msg );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn this.identity();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar detInv = 1 / det;\r\n\r\n\t\t\tte[ 0 ] = t11 * detInv;\r\n\t\t\tte[ 1 ] = ( n24 * n33 * n41 - n23 * n34 * n41 - n24 * n31 * n43 + n21 * n34 * n43 + n23 * n31 * n44 - n21 * n33 * n44 ) * detInv;\r\n\t\t\tte[ 2 ] = ( n22 * n34 * n41 - n24 * n32 * n41 + n24 * n31 * n42 - n21 * n34 * n42 - n22 * n31 * n44 + n21 * n32 * n44 ) * detInv;\r\n\t\t\tte[ 3 ] = ( n23 * n32 * n41 - n22 * n33 * n41 - n23 * n31 * n42 + n21 * n33 * n42 + n22 * n31 * n43 - n21 * n32 * n43 ) * detInv;\r\n\r\n\t\t\tte[ 4 ] = t12 * detInv;\r\n\t\t\tte[ 5 ] = ( n13 * n34 * n41 - n14 * n33 * n41 + n14 * n31 * n43 - n11 * n34 * n43 - n13 * n31 * n44 + n11 * n33 * n44 ) * detInv;\r\n\t\t\tte[ 6 ] = ( n14 * n32 * n41 - n12 * n34 * n41 - n14 * n31 * n42 + n11 * n34 * n42 + n12 * n31 * n44 - n11 * n32 * n44 ) * detInv;\r\n\t\t\tte[ 7 ] = ( n12 * n33 * n41 - n13 * n32 * n41 + n13 * n31 * n42 - n11 * n33 * n42 - n12 * n31 * n43 + n11 * n32 * n43 ) * detInv;\r\n\r\n\t\t\tte[ 8 ] = t13 * detInv;\r\n\t\t\tte[ 9 ] = ( n14 * n23 * n41 - n13 * n24 * n41 - n14 * n21 * n43 + n11 * n24 * n43 + n13 * n21 * n44 - n11 * n23 * n44 ) * detInv;\r\n\t\t\tte[ 10 ] = ( n12 * n24 * n41 - n14 * n22 * n41 + n14 * n21 * n42 - n11 * n24 * n42 - n12 * n21 * n44 + n11 * n22 * n44 ) * detInv;\r\n\t\t\tte[ 11 ] = ( n13 * n22 * n41 - n12 * n23 * n41 - n13 * n21 * n42 + n11 * n23 * n42 + n12 * n21 * n43 - n11 * n22 * n43 ) * detInv;\r\n\r\n\t\t\tte[ 12 ] = t14 * detInv;\r\n\t\t\tte[ 13 ] = ( n13 * n24 * n31 - n14 * n23 * n31 + n14 * n21 * n33 - n11 * n24 * n33 - n13 * n21 * n34 + n11 * n23 * n34 ) * detInv;\r\n\t\t\tte[ 14 ] = ( n14 * n22 * n31 - n12 * n24 * n31 - n14 * n21 * n32 + n11 * n24 * n32 + n12 * n21 * n34 - n11 * n22 * n34 ) * detInv;\r\n\t\t\tte[ 15 ] = ( n12 * n23 * n31 - n13 * n22 * n31 + n13 * n21 * n32 - n11 * n23 * n32 - n12 * n21 * n33 + n11 * n22 * n33 ) * detInv;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tscale: function ( v ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\t\t\tvar x = v.x, y = v.y, z = v.z;\r\n\r\n\t\t\tte[ 0 ] *= x; te[ 4 ] *= y; te[ 8 ] *= z;\r\n\t\t\tte[ 1 ] *= x; te[ 5 ] *= y; te[ 9 ] *= z;\r\n\t\t\tte[ 2 ] *= x; te[ 6 ] *= y; te[ 10 ] *= z;\r\n\t\t\tte[ 3 ] *= x; te[ 7 ] *= y; te[ 11 ] *= z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetMaxScaleOnAxis: function () {\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tvar scaleXSq = te[ 0 ] * te[ 0 ] + te[ 1 ] * te[ 1 ] + te[ 2 ] * te[ 2 ];\r\n\t\t\tvar scaleYSq = te[ 4 ] * te[ 4 ] + te[ 5 ] * te[ 5 ] + te[ 6 ] * te[ 6 ];\r\n\t\t\tvar scaleZSq = te[ 8 ] * te[ 8 ] + te[ 9 ] * te[ 9 ] + te[ 10 ] * te[ 10 ];\r\n\r\n\t\t\treturn Math.sqrt( Math.max( scaleXSq, scaleYSq, scaleZSq ) );\r\n\r\n\t\t},\r\n\r\n\t\tmakeTranslation: function ( x, y, z ) {\r\n\r\n\t\t\tthis.set(\r\n\r\n\t\t\t\t1, 0, 0, x,\r\n\t\t\t\t0, 1, 0, y,\r\n\t\t\t\t0, 0, 1, z,\r\n\t\t\t\t0, 0, 0, 1\r\n\r\n\t\t\t);\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmakeRotationX: function ( theta ) {\r\n\r\n\t\t\tvar c = Math.cos( theta ), s = Math.sin( theta );\r\n\r\n\t\t\tthis.set(\r\n\r\n\t\t\t\t1, 0, 0, 0,\r\n\t\t\t\t0, c, - s, 0,\r\n\t\t\t\t0, s, c, 0,\r\n\t\t\t\t0, 0, 0, 1\r\n\r\n\t\t\t);\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmakeRotationY: function ( theta ) {\r\n\r\n\t\t\tvar c = Math.cos( theta ), s = Math.sin( theta );\r\n\r\n\t\t\tthis.set(\r\n\r\n\t\t\t\t c, 0, s, 0,\r\n\t\t\t\t 0, 1, 0, 0,\r\n\t\t\t\t- s, 0, c, 0,\r\n\t\t\t\t 0, 0, 0, 1\r\n\r\n\t\t\t);\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmakeRotationZ: function ( theta ) {\r\n\r\n\t\t\tvar c = Math.cos( theta ), s = Math.sin( theta );\r\n\r\n\t\t\tthis.set(\r\n\r\n\t\t\t\tc, - s, 0, 0,\r\n\t\t\t\ts, c, 0, 0,\r\n\t\t\t\t0, 0, 1, 0,\r\n\t\t\t\t0, 0, 0, 1\r\n\r\n\t\t\t);\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmakeRotationAxis: function ( axis, angle ) {\r\n\r\n\t\t\t// Based on http://www.gamedev.net/reference/articles/article1199.asp\r\n\r\n\t\t\tvar c = Math.cos( angle );\r\n\t\t\tvar s = Math.sin( angle );\r\n\t\t\tvar t = 1 - c;\r\n\t\t\tvar x = axis.x, y = axis.y, z = axis.z;\r\n\t\t\tvar tx = t * x, ty = t * y;\r\n\r\n\t\t\tthis.set(\r\n\r\n\t\t\t\ttx * x + c, tx * y - s * z, tx * z + s * y, 0,\r\n\t\t\t\ttx * y + s * z, ty * y + c, ty * z - s * x, 0,\r\n\t\t\t\ttx * z - s * y, ty * z + s * x, t * z * z + c, 0,\r\n\t\t\t\t0, 0, 0, 1\r\n\r\n\t\t\t);\r\n\r\n\t\t\t return this;\r\n\r\n\t\t},\r\n\r\n\t\tmakeScale: function ( x, y, z ) {\r\n\r\n\t\t\tthis.set(\r\n\r\n\t\t\t\tx, 0, 0, 0,\r\n\t\t\t\t0, y, 0, 0,\r\n\t\t\t\t0, 0, z, 0,\r\n\t\t\t\t0, 0, 0, 1\r\n\r\n\t\t\t);\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmakeShear: function ( x, y, z ) {\r\n\r\n\t\t\tthis.set(\r\n\r\n\t\t\t\t1, y, z, 0,\r\n\t\t\t\tx, 1, z, 0,\r\n\t\t\t\tx, y, 1, 0,\r\n\t\t\t\t0, 0, 0, 1\r\n\r\n\t\t\t);\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcompose: function ( position, quaternion, scale ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tvar x = quaternion._x, y = quaternion._y, z = quaternion._z, w = quaternion._w;\r\n\t\t\tvar x2 = x + x,\ty2 = y + y, z2 = z + z;\r\n\t\t\tvar xx = x * x2, xy = x * y2, xz = x * z2;\r\n\t\t\tvar yy = y * y2, yz = y * z2, zz = z * z2;\r\n\t\t\tvar wx = w * x2, wy = w * y2, wz = w * z2;\r\n\r\n\t\t\tvar sx = scale.x, sy = scale.y, sz = scale.z;\r\n\r\n\t\t        te[ 0 ] = ( 1 - ( yy + zz ) ) * sx;\r\n\t\t        te[ 1 ] = ( xy + wz ) * sx;\r\n\t\t        te[ 2 ] = ( xz - wy ) * sx;\r\n\t\t        te[ 3 ] = 0;\r\n\r\n\t\t        te[ 4 ] = ( xy - wz ) * sy;\r\n\t\t        te[ 5 ] = ( 1 - ( xx + zz ) ) * sy;\r\n\t\t        te[ 6 ] = ( yz + wx ) * sy;\r\n\t\t        te[ 7 ] = 0;\r\n\r\n\t\t        te[ 8 ] = ( xz + wy ) * sz;\r\n\t\t        te[ 9 ] = ( yz - wx ) * sz;\r\n\t\t        te[ 10 ] = ( 1 - ( xx + yy ) ) * sz;\r\n\t\t        te[ 11 ] = 0;\r\n\r\n\t\t        te[ 12 ] = position.x;\r\n\t\t        te[ 13 ] = position.y;\r\n\t\t        te[ 14 ] = position.z;\r\n\t\t        te[ 15 ] = 1;\r\n\r\n\t\t        return this;\r\n\r\n\t\t},\r\n\r\n\t\tdecompose: function () {\r\n\r\n\t\t\tvar vector = new Vector3();\r\n\t\t\tvar matrix = new Matrix4();\r\n\r\n\t\t\treturn function decompose( position, quaternion, scale ) {\r\n\r\n\t\t\t\tvar te = this.elements;\r\n\r\n\t\t\t\tvar sx = vector.set( te[ 0 ], te[ 1 ], te[ 2 ] ).length();\r\n\t\t\t\tvar sy = vector.set( te[ 4 ], te[ 5 ], te[ 6 ] ).length();\r\n\t\t\t\tvar sz = vector.set( te[ 8 ], te[ 9 ], te[ 10 ] ).length();\r\n\r\n\t\t\t\t// if determine is negative, we need to invert one scale\r\n\t\t\t\tvar det = this.determinant();\r\n\t\t\t\tif ( det < 0 ) sx = - sx;\r\n\r\n\t\t\t\tposition.x = te[ 12 ];\r\n\t\t\t\tposition.y = te[ 13 ];\r\n\t\t\t\tposition.z = te[ 14 ];\r\n\r\n\t\t\t\t// scale the rotation part\r\n\t\t\t\tmatrix.copy( this );\r\n\r\n\t\t\t\tvar invSX = 1 / sx;\r\n\t\t\t\tvar invSY = 1 / sy;\r\n\t\t\t\tvar invSZ = 1 / sz;\r\n\r\n\t\t\t\tmatrix.elements[ 0 ] *= invSX;\r\n\t\t\t\tmatrix.elements[ 1 ] *= invSX;\r\n\t\t\t\tmatrix.elements[ 2 ] *= invSX;\r\n\r\n\t\t\t\tmatrix.elements[ 4 ] *= invSY;\r\n\t\t\t\tmatrix.elements[ 5 ] *= invSY;\r\n\t\t\t\tmatrix.elements[ 6 ] *= invSY;\r\n\r\n\t\t\t\tmatrix.elements[ 8 ] *= invSZ;\r\n\t\t\t\tmatrix.elements[ 9 ] *= invSZ;\r\n\t\t\t\tmatrix.elements[ 10 ] *= invSZ;\r\n\r\n\t\t\t\tquaternion.setFromRotationMatrix( matrix );\r\n\r\n\t\t\t\tscale.x = sx;\r\n\t\t\t\tscale.y = sy;\r\n\t\t\t\tscale.z = sz;\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tmakePerspective: function ( left, right, top, bottom, near, far ) {\r\n\r\n\t\t\tif ( far === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar te = this.elements;\r\n\t\t\tvar x = 2 * near / ( right - left );\r\n\t\t\tvar y = 2 * near / ( top - bottom );\r\n\r\n\t\t\tvar a = ( right + left ) / ( right - left );\r\n\t\t\tvar b = ( top + bottom ) / ( top - bottom );\r\n\t\t\tvar c = - ( far + near ) / ( far - near );\r\n\t\t\tvar d = - 2 * far * near / ( far - near );\r\n\r\n\t\t\tte[ 0 ] = x;\tte[ 4 ] = 0;\tte[ 8 ] = a;\tte[ 12 ] = 0;\r\n\t\t\tte[ 1 ] = 0;\tte[ 5 ] = y;\tte[ 9 ] = b;\tte[ 13 ] = 0;\r\n\t\t\tte[ 2 ] = 0;\tte[ 6 ] = 0;\tte[ 10 ] = c;\tte[ 14 ] = d;\r\n\t\t\tte[ 3 ] = 0;\tte[ 7 ] = 0;\tte[ 11 ] = - 1;\tte[ 15 ] = 0;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmakeOrthographic: function ( left, right, top, bottom, near, far ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\t\t\tvar w = 1.0 / ( right - left );\r\n\t\t\tvar h = 1.0 / ( top - bottom );\r\n\t\t\tvar p = 1.0 / ( far - near );\r\n\r\n\t\t\tvar x = ( right + left ) * w;\r\n\t\t\tvar y = ( top + bottom ) * h;\r\n\t\t\tvar z = ( far + near ) * p;\r\n\r\n\t\t\tte[ 0 ] = 2 * w;\tte[ 4 ] = 0;\tte[ 8 ] = 0;\tte[ 12 ] = - x;\r\n\t\t\tte[ 1 ] = 0;\tte[ 5 ] = 2 * h;\tte[ 9 ] = 0;\tte[ 13 ] = - y;\r\n\t\t\tte[ 2 ] = 0;\tte[ 6 ] = 0;\tte[ 10 ] = - 2 * p;\tte[ 14 ] = - z;\r\n\t\t\tte[ 3 ] = 0;\tte[ 7 ] = 0;\tte[ 11 ] = 0;\tte[ 15 ] = 1;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tequals: function ( matrix ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\t\t\tvar me = matrix.elements;\r\n\r\n\t\t\tfor ( var i = 0; i < 16; i ++ ) {\r\n\r\n\t\t\t\tif ( te[ i ] !== me[ i ] ) return false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t},\r\n\r\n\t\tfromArray: function ( array, offset ) {\r\n\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\t\tfor ( var i = 0; i < 16; i ++ ) {\r\n\r\n\t\t\t\tthis.elements[ i ] = array[ i + offset ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoArray: function ( array, offset ) {\r\n\r\n\t\t\tif ( array === undefined ) array = [];\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tarray[ offset ] = te[ 0 ];\r\n\t\t\tarray[ offset + 1 ] = te[ 1 ];\r\n\t\t\tarray[ offset + 2 ] = te[ 2 ];\r\n\t\t\tarray[ offset + 3 ] = te[ 3 ];\r\n\r\n\t\t\tarray[ offset + 4 ] = te[ 4 ];\r\n\t\t\tarray[ offset + 5 ] = te[ 5 ];\r\n\t\t\tarray[ offset + 6 ] = te[ 6 ];\r\n\t\t\tarray[ offset + 7 ] = te[ 7 ];\r\n\r\n\t\t\tarray[ offset + 8 ] = te[ 8 ];\r\n\t\t\tarray[ offset + 9 ] = te[ 9 ];\r\n\t\t\tarray[ offset + 10 ] = te[ 10 ];\r\n\t\t\tarray[ offset + 11 ] = te[ 11 ];\r\n\r\n\t\t\tarray[ offset + 12 ] = te[ 12 ];\r\n\t\t\tarray[ offset + 13 ] = te[ 13 ];\r\n\t\t\tarray[ offset + 14 ] = te[ 14 ];\r\n\t\t\tarray[ offset + 15 ] = te[ 15 ];\r\n\r\n\t\t\treturn array;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t * @author bhouston / http://clara.io\r\n\t */\r\n\r\n\tfunction Quaternion( x, y, z, w ) {\r\n\r\n\t\tthis._x = x || 0;\r\n\t\tthis._y = y || 0;\r\n\t\tthis._z = z || 0;\r\n\t\tthis._w = ( w !== undefined ) ? w : 1;\r\n\r\n\t}\r\n\r\n\tObject.assign( Quaternion, {\r\n\r\n\t\tslerp: function ( qa, qb, qm, t ) {\r\n\r\n\t\t\treturn qm.copy( qa ).slerp( qb, t );\r\n\r\n\t\t},\r\n\r\n\t\tslerpFlat: function ( dst, dstOffset, src0, srcOffset0, src1, srcOffset1, t ) {\r\n\r\n\t\t\t// fuzz-free, array-based Quaternion SLERP operation\r\n\r\n\t\t\tvar x0 = src0[ srcOffset0 + 0 ],\r\n\t\t\t\ty0 = src0[ srcOffset0 + 1 ],\r\n\t\t\t\tz0 = src0[ srcOffset0 + 2 ],\r\n\t\t\t\tw0 = src0[ srcOffset0 + 3 ],\r\n\r\n\t\t\t\tx1 = src1[ srcOffset1 + 0 ],\r\n\t\t\t\ty1 = src1[ srcOffset1 + 1 ],\r\n\t\t\t\tz1 = src1[ srcOffset1 + 2 ],\r\n\t\t\t\tw1 = src1[ srcOffset1 + 3 ];\r\n\r\n\t\t\tif ( w0 !== w1 || x0 !== x1 || y0 !== y1 || z0 !== z1 ) {\r\n\r\n\t\t\t\tvar s = 1 - t,\r\n\r\n\t\t\t\t\tcos = x0 * x1 + y0 * y1 + z0 * z1 + w0 * w1,\r\n\r\n\t\t\t\t\tdir = ( cos >= 0 ? 1 : - 1 ),\r\n\t\t\t\t\tsqrSin = 1 - cos * cos;\r\n\r\n\t\t\t\t// Skip the Slerp for tiny steps to avoid numeric problems:\r\n\t\t\t\tif ( sqrSin > Number.EPSILON ) {\r\n\r\n\t\t\t\t\tvar sin = Math.sqrt( sqrSin ),\r\n\t\t\t\t\t\tlen = Math.atan2( sin, cos * dir );\r\n\r\n\t\t\t\t\ts = Math.sin( s * len ) / sin;\r\n\t\t\t\t\tt = Math.sin( t * len ) / sin;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar tDir = t * dir;\r\n\r\n\t\t\t\tx0 = x0 * s + x1 * tDir;\r\n\t\t\t\ty0 = y0 * s + y1 * tDir;\r\n\t\t\t\tz0 = z0 * s + z1 * tDir;\r\n\t\t\t\tw0 = w0 * s + w1 * tDir;\r\n\r\n\t\t\t\t// Normalize in case we just did a lerp:\r\n\t\t\t\tif ( s === 1 - t ) {\r\n\r\n\t\t\t\t\tvar f = 1 / Math.sqrt( x0 * x0 + y0 * y0 + z0 * z0 + w0 * w0 );\r\n\r\n\t\t\t\t\tx0 *= f;\r\n\t\t\t\t\ty0 *= f;\r\n\t\t\t\t\tz0 *= f;\r\n\t\t\t\t\tw0 *= f;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tdst[ dstOffset ] = x0;\r\n\t\t\tdst[ dstOffset + 1 ] = y0;\r\n\t\t\tdst[ dstOffset + 2 ] = z0;\r\n\t\t\tdst[ dstOffset + 3 ] = w0;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.defineProperties( Quaternion.prototype, {\r\n\r\n\t\tx: {\r\n\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\treturn this._x;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tthis._x = value;\r\n\t\t\t\tthis.onChangeCallback();\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\ty: {\r\n\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\treturn this._y;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tthis._y = value;\r\n\t\t\t\tthis.onChangeCallback();\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tz: {\r\n\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\treturn this._z;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tthis._z = value;\r\n\t\t\t\tthis.onChangeCallback();\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tw: {\r\n\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\treturn this._w;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tthis._w = value;\r\n\t\t\t\tthis.onChangeCallback();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( Quaternion.prototype, {\r\n\r\n\t\tset: function ( x, y, z, w ) {\r\n\r\n\t\t\tthis._x = x;\r\n\t\t\tthis._y = y;\r\n\t\t\tthis._z = z;\r\n\t\t\tthis._w = w;\r\n\r\n\t\t\tthis.onChangeCallback();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor( this._x, this._y, this._z, this._w );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( quaternion ) {\r\n\r\n\t\t\tthis._x = quaternion.x;\r\n\t\t\tthis._y = quaternion.y;\r\n\t\t\tthis._z = quaternion.z;\r\n\t\t\tthis._w = quaternion.w;\r\n\r\n\t\t\tthis.onChangeCallback();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromEuler: function ( euler, update ) {\r\n\r\n\t\t\tif ( ! ( euler && euler.isEuler ) ) {\r\n\r\n\t\t\t\tthrow new Error( 'THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar x = euler._x, y = euler._y, z = euler._z, order = euler.order;\r\n\r\n\t\t\t// http://www.mathworks.com/matlabcentral/fileexchange/\r\n\t\t\t// \t20696-function-to-convert-between-dcm-euler-angles-quaternions-and-euler-vectors/\r\n\t\t\t//\tcontent/SpinCalc.m\r\n\r\n\t\t\tvar cos = Math.cos;\r\n\t\t\tvar sin = Math.sin;\r\n\r\n\t\t\tvar c1 = cos( x / 2 );\r\n\t\t\tvar c2 = cos( y / 2 );\r\n\t\t\tvar c3 = cos( z / 2 );\r\n\r\n\t\t\tvar s1 = sin( x / 2 );\r\n\t\t\tvar s2 = sin( y / 2 );\r\n\t\t\tvar s3 = sin( z / 2 );\r\n\r\n\t\t\tif ( order === 'XYZ' ) {\r\n\r\n\t\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\r\n\t\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\r\n\t\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\r\n\t\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\r\n\r\n\t\t\t} else if ( order === 'YXZ' ) {\r\n\r\n\t\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\r\n\t\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\r\n\t\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\r\n\t\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\r\n\r\n\t\t\t} else if ( order === 'ZXY' ) {\r\n\r\n\t\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\r\n\t\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\r\n\t\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\r\n\t\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\r\n\r\n\t\t\t} else if ( order === 'ZYX' ) {\r\n\r\n\t\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\r\n\t\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\r\n\t\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\r\n\t\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\r\n\r\n\t\t\t} else if ( order === 'YZX' ) {\r\n\r\n\t\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\r\n\t\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\r\n\t\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\r\n\t\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\r\n\r\n\t\t\t} else if ( order === 'XZY' ) {\r\n\r\n\t\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\r\n\t\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\r\n\t\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\r\n\t\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( update !== false ) this.onChangeCallback();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromAxisAngle: function ( axis, angle ) {\r\n\r\n\t\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/angleToQuaternion/index.htm\r\n\r\n\t\t\t// assumes axis is normalized\r\n\r\n\t\t\tvar halfAngle = angle / 2, s = Math.sin( halfAngle );\r\n\r\n\t\t\tthis._x = axis.x * s;\r\n\t\t\tthis._y = axis.y * s;\r\n\t\t\tthis._z = axis.z * s;\r\n\t\t\tthis._w = Math.cos( halfAngle );\r\n\r\n\t\t\tthis.onChangeCallback();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromRotationMatrix: function ( m ) {\r\n\r\n\t\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToQuaternion/index.htm\r\n\r\n\t\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\r\n\t\t\tvar te = m.elements,\r\n\r\n\t\t\t\tm11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ],\r\n\t\t\t\tm21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ],\r\n\t\t\t\tm31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ],\r\n\r\n\t\t\t\ttrace = m11 + m22 + m33,\r\n\t\t\t\ts;\r\n\r\n\t\t\tif ( trace > 0 ) {\r\n\r\n\t\t\t\ts = 0.5 / Math.sqrt( trace + 1.0 );\r\n\r\n\t\t\t\tthis._w = 0.25 / s;\r\n\t\t\t\tthis._x = ( m32 - m23 ) * s;\r\n\t\t\t\tthis._y = ( m13 - m31 ) * s;\r\n\t\t\t\tthis._z = ( m21 - m12 ) * s;\r\n\r\n\t\t\t} else if ( m11 > m22 && m11 > m33 ) {\r\n\r\n\t\t\t\ts = 2.0 * Math.sqrt( 1.0 + m11 - m22 - m33 );\r\n\r\n\t\t\t\tthis._w = ( m32 - m23 ) / s;\r\n\t\t\t\tthis._x = 0.25 * s;\r\n\t\t\t\tthis._y = ( m12 + m21 ) / s;\r\n\t\t\t\tthis._z = ( m13 + m31 ) / s;\r\n\r\n\t\t\t} else if ( m22 > m33 ) {\r\n\r\n\t\t\t\ts = 2.0 * Math.sqrt( 1.0 + m22 - m11 - m33 );\r\n\r\n\t\t\t\tthis._w = ( m13 - m31 ) / s;\r\n\t\t\t\tthis._x = ( m12 + m21 ) / s;\r\n\t\t\t\tthis._y = 0.25 * s;\r\n\t\t\t\tthis._z = ( m23 + m32 ) / s;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\ts = 2.0 * Math.sqrt( 1.0 + m33 - m11 - m22 );\r\n\r\n\t\t\t\tthis._w = ( m21 - m12 ) / s;\r\n\t\t\t\tthis._x = ( m13 + m31 ) / s;\r\n\t\t\t\tthis._y = ( m23 + m32 ) / s;\r\n\t\t\t\tthis._z = 0.25 * s;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.onChangeCallback();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromUnitVectors: function () {\r\n\r\n\t\t\t// assumes direction vectors vFrom and vTo are normalized\r\n\r\n\t\t\tvar v1 = new Vector3();\r\n\t\t\tvar r;\r\n\r\n\t\t\tvar EPS = 0.000001;\r\n\r\n\t\t\treturn function setFromUnitVectors( vFrom, vTo ) {\r\n\r\n\t\t\t\tif ( v1 === undefined ) v1 = new Vector3();\r\n\r\n\t\t\t\tr = vFrom.dot( vTo ) + 1;\r\n\r\n\t\t\t\tif ( r < EPS ) {\r\n\r\n\t\t\t\t\tr = 0;\r\n\r\n\t\t\t\t\tif ( Math.abs( vFrom.x ) > Math.abs( vFrom.z ) ) {\r\n\r\n\t\t\t\t\t\tv1.set( - vFrom.y, vFrom.x, 0 );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tv1.set( 0, - vFrom.z, vFrom.y );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tv1.crossVectors( vFrom, vTo );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._x = v1.x;\r\n\t\t\t\tthis._y = v1.y;\r\n\t\t\t\tthis._z = v1.z;\r\n\t\t\t\tthis._w = r;\r\n\r\n\t\t\t\treturn this.normalize();\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tangleTo: function ( q ) {\r\n\r\n\t\t\treturn 2 * Math.acos( Math.abs( _Math.clamp( this.dot( q ), - 1, 1 ) ) );\r\n\r\n\t\t},\r\n\r\n\t\trotateTowards: function ( q, step ) {\r\n\r\n\t\t\tvar angle = this.angleTo( q );\r\n\r\n\t\t\tif ( angle === 0 ) return this;\r\n\r\n\t\t\tvar t = Math.min( 1, step / angle );\r\n\r\n\t\t\tthis.slerp( q, t );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tinverse: function () {\r\n\r\n\t\t\t// quaternion is assumed to have unit length\r\n\r\n\t\t\treturn this.conjugate();\r\n\r\n\t\t},\r\n\r\n\t\tconjugate: function () {\r\n\r\n\t\t\tthis._x *= - 1;\r\n\t\t\tthis._y *= - 1;\r\n\t\t\tthis._z *= - 1;\r\n\r\n\t\t\tthis.onChangeCallback();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tdot: function ( v ) {\r\n\r\n\t\t\treturn this._x * v._x + this._y * v._y + this._z * v._z + this._w * v._w;\r\n\r\n\t\t},\r\n\r\n\t\tlengthSq: function () {\r\n\r\n\t\t\treturn this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w;\r\n\r\n\t\t},\r\n\r\n\t\tlength: function () {\r\n\r\n\t\t\treturn Math.sqrt( this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w );\r\n\r\n\t\t},\r\n\r\n\t\tnormalize: function () {\r\n\r\n\t\t\tvar l = this.length();\r\n\r\n\t\t\tif ( l === 0 ) {\r\n\r\n\t\t\t\tthis._x = 0;\r\n\t\t\t\tthis._y = 0;\r\n\t\t\t\tthis._z = 0;\r\n\t\t\t\tthis._w = 1;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tl = 1 / l;\r\n\r\n\t\t\t\tthis._x = this._x * l;\r\n\t\t\t\tthis._y = this._y * l;\r\n\t\t\t\tthis._z = this._z * l;\r\n\t\t\t\tthis._w = this._w * l;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.onChangeCallback();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmultiply: function ( q, p ) {\r\n\r\n\t\t\tif ( p !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead.' );\r\n\t\t\t\treturn this.multiplyQuaternions( q, p );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this.multiplyQuaternions( this, q );\r\n\r\n\t\t},\r\n\r\n\t\tpremultiply: function ( q ) {\r\n\r\n\t\t\treturn this.multiplyQuaternions( q, this );\r\n\r\n\t\t},\r\n\r\n\t\tmultiplyQuaternions: function ( a, b ) {\r\n\r\n\t\t\t// from http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/code/index.htm\r\n\r\n\t\t\tvar qax = a._x, qay = a._y, qaz = a._z, qaw = a._w;\r\n\t\t\tvar qbx = b._x, qby = b._y, qbz = b._z, qbw = b._w;\r\n\r\n\t\t\tthis._x = qax * qbw + qaw * qbx + qay * qbz - qaz * qby;\r\n\t\t\tthis._y = qay * qbw + qaw * qby + qaz * qbx - qax * qbz;\r\n\t\t\tthis._z = qaz * qbw + qaw * qbz + qax * qby - qay * qbx;\r\n\t\t\tthis._w = qaw * qbw - qax * qbx - qay * qby - qaz * qbz;\r\n\r\n\t\t\tthis.onChangeCallback();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tslerp: function ( qb, t ) {\r\n\r\n\t\t\tif ( t === 0 ) return this;\r\n\t\t\tif ( t === 1 ) return this.copy( qb );\r\n\r\n\t\t\tvar x = this._x, y = this._y, z = this._z, w = this._w;\r\n\r\n\t\t\t// http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/slerp/\r\n\r\n\t\t\tvar cosHalfTheta = w * qb._w + x * qb._x + y * qb._y + z * qb._z;\r\n\r\n\t\t\tif ( cosHalfTheta < 0 ) {\r\n\r\n\t\t\t\tthis._w = - qb._w;\r\n\t\t\t\tthis._x = - qb._x;\r\n\t\t\t\tthis._y = - qb._y;\r\n\t\t\t\tthis._z = - qb._z;\r\n\r\n\t\t\t\tcosHalfTheta = - cosHalfTheta;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.copy( qb );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( cosHalfTheta >= 1.0 ) {\r\n\r\n\t\t\t\tthis._w = w;\r\n\t\t\t\tthis._x = x;\r\n\t\t\t\tthis._y = y;\r\n\t\t\t\tthis._z = z;\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar sqrSinHalfTheta = 1.0 - cosHalfTheta * cosHalfTheta;\r\n\r\n\t\t\tif ( sqrSinHalfTheta <= Number.EPSILON ) {\r\n\r\n\t\t\t\tvar s = 1 - t;\r\n\t\t\t\tthis._w = s * w + t * this._w;\r\n\t\t\t\tthis._x = s * x + t * this._x;\r\n\t\t\t\tthis._y = s * y + t * this._y;\r\n\t\t\t\tthis._z = s * z + t * this._z;\r\n\r\n\t\t\t\treturn this.normalize();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar sinHalfTheta = Math.sqrt( sqrSinHalfTheta );\r\n\t\t\tvar halfTheta = Math.atan2( sinHalfTheta, cosHalfTheta );\r\n\t\t\tvar ratioA = Math.sin( ( 1 - t ) * halfTheta ) / sinHalfTheta,\r\n\t\t\t\tratioB = Math.sin( t * halfTheta ) / sinHalfTheta;\r\n\r\n\t\t\tthis._w = ( w * ratioA + this._w * ratioB );\r\n\t\t\tthis._x = ( x * ratioA + this._x * ratioB );\r\n\t\t\tthis._y = ( y * ratioA + this._y * ratioB );\r\n\t\t\tthis._z = ( z * ratioA + this._z * ratioB );\r\n\r\n\t\t\tthis.onChangeCallback();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tequals: function ( quaternion ) {\r\n\r\n\t\t\treturn ( quaternion._x === this._x ) && ( quaternion._y === this._y ) && ( quaternion._z === this._z ) && ( quaternion._w === this._w );\r\n\r\n\t\t},\r\n\r\n\t\tfromArray: function ( array, offset ) {\r\n\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\t\tthis._x = array[ offset ];\r\n\t\t\tthis._y = array[ offset + 1 ];\r\n\t\t\tthis._z = array[ offset + 2 ];\r\n\t\t\tthis._w = array[ offset + 3 ];\r\n\r\n\t\t\tthis.onChangeCallback();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoArray: function ( array, offset ) {\r\n\r\n\t\t\tif ( array === undefined ) array = [];\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\t\tarray[ offset ] = this._x;\r\n\t\t\tarray[ offset + 1 ] = this._y;\r\n\t\t\tarray[ offset + 2 ] = this._z;\r\n\t\t\tarray[ offset + 3 ] = this._w;\r\n\r\n\t\t\treturn array;\r\n\r\n\t\t},\r\n\r\n\t\tonChange: function ( callback ) {\r\n\r\n\t\t\tthis.onChangeCallback = callback;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tonChangeCallback: function () {}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author kile / http://kile.stravaganza.org/\r\n\t * @author philogb / http://blog.thejit.org/\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author egraether / http://egraether.com/\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t */\r\n\r\n\tfunction Vector3( x, y, z ) {\r\n\r\n\t\tthis.x = x || 0;\r\n\t\tthis.y = y || 0;\r\n\t\tthis.z = z || 0;\r\n\r\n\t}\r\n\r\n\tObject.assign( Vector3.prototype, {\r\n\r\n\t\tisVector3: true,\r\n\r\n\t\tset: function ( x, y, z ) {\r\n\r\n\t\t\tthis.x = x;\r\n\t\t\tthis.y = y;\r\n\t\t\tthis.z = z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetScalar: function ( scalar ) {\r\n\r\n\t\t\tthis.x = scalar;\r\n\t\t\tthis.y = scalar;\r\n\t\t\tthis.z = scalar;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetX: function ( x ) {\r\n\r\n\t\t\tthis.x = x;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetY: function ( y ) {\r\n\r\n\t\t\tthis.y = y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetZ: function ( z ) {\r\n\r\n\t\t\tthis.z = z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetComponent: function ( index, value ) {\r\n\r\n\t\t\tswitch ( index ) {\r\n\r\n\t\t\t\tcase 0: this.x = value; break;\r\n\t\t\t\tcase 1: this.y = value; break;\r\n\t\t\t\tcase 2: this.z = value; break;\r\n\t\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetComponent: function ( index ) {\r\n\r\n\t\t\tswitch ( index ) {\r\n\r\n\t\t\t\tcase 0: return this.x;\r\n\t\t\t\tcase 1: return this.y;\r\n\t\t\t\tcase 2: return this.z;\r\n\t\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor( this.x, this.y, this.z );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( v ) {\r\n\r\n\t\t\tthis.x = v.x;\r\n\t\t\tthis.y = v.y;\r\n\t\t\tthis.z = v.z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tadd: function ( v, w ) {\r\n\r\n\t\t\tif ( w !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\r\n\t\t\t\treturn this.addVectors( v, w );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.x += v.x;\r\n\t\t\tthis.y += v.y;\r\n\t\t\tthis.z += v.z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\taddScalar: function ( s ) {\r\n\r\n\t\t\tthis.x += s;\r\n\t\t\tthis.y += s;\r\n\t\t\tthis.z += s;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\taddVectors: function ( a, b ) {\r\n\r\n\t\t\tthis.x = a.x + b.x;\r\n\t\t\tthis.y = a.y + b.y;\r\n\t\t\tthis.z = a.z + b.z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\taddScaledVector: function ( v, s ) {\r\n\r\n\t\t\tthis.x += v.x * s;\r\n\t\t\tthis.y += v.y * s;\r\n\t\t\tthis.z += v.z * s;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsub: function ( v, w ) {\r\n\r\n\t\t\tif ( w !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.' );\r\n\t\t\t\treturn this.subVectors( v, w );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.x -= v.x;\r\n\t\t\tthis.y -= v.y;\r\n\t\t\tthis.z -= v.z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsubScalar: function ( s ) {\r\n\r\n\t\t\tthis.x -= s;\r\n\t\t\tthis.y -= s;\r\n\t\t\tthis.z -= s;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsubVectors: function ( a, b ) {\r\n\r\n\t\t\tthis.x = a.x - b.x;\r\n\t\t\tthis.y = a.y - b.y;\r\n\t\t\tthis.z = a.z - b.z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmultiply: function ( v, w ) {\r\n\r\n\t\t\tif ( w !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead.' );\r\n\t\t\t\treturn this.multiplyVectors( v, w );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.x *= v.x;\r\n\t\t\tthis.y *= v.y;\r\n\t\t\tthis.z *= v.z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmultiplyScalar: function ( scalar ) {\r\n\r\n\t\t\tthis.x *= scalar;\r\n\t\t\tthis.y *= scalar;\r\n\t\t\tthis.z *= scalar;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmultiplyVectors: function ( a, b ) {\r\n\r\n\t\t\tthis.x = a.x * b.x;\r\n\t\t\tthis.y = a.y * b.y;\r\n\t\t\tthis.z = a.z * b.z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tapplyEuler: function () {\r\n\r\n\t\t\tvar quaternion = new Quaternion();\r\n\r\n\t\t\treturn function applyEuler( euler ) {\r\n\r\n\t\t\t\tif ( ! ( euler && euler.isEuler ) ) {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order.' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn this.applyQuaternion( quaternion.setFromEuler( euler ) );\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tapplyAxisAngle: function () {\r\n\r\n\t\t\tvar quaternion = new Quaternion();\r\n\r\n\t\t\treturn function applyAxisAngle( axis, angle ) {\r\n\r\n\t\t\t\treturn this.applyQuaternion( quaternion.setFromAxisAngle( axis, angle ) );\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tapplyMatrix3: function ( m ) {\r\n\r\n\t\t\tvar x = this.x, y = this.y, z = this.z;\r\n\t\t\tvar e = m.elements;\r\n\r\n\t\t\tthis.x = e[ 0 ] * x + e[ 3 ] * y + e[ 6 ] * z;\r\n\t\t\tthis.y = e[ 1 ] * x + e[ 4 ] * y + e[ 7 ] * z;\r\n\t\t\tthis.z = e[ 2 ] * x + e[ 5 ] * y + e[ 8 ] * z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tapplyMatrix4: function ( m ) {\r\n\r\n\t\t\tvar x = this.x, y = this.y, z = this.z;\r\n\t\t\tvar e = m.elements;\r\n\r\n\t\t\tvar w = 1 / ( e[ 3 ] * x + e[ 7 ] * y + e[ 11 ] * z + e[ 15 ] );\r\n\r\n\t\t\tthis.x = ( e[ 0 ] * x + e[ 4 ] * y + e[ 8 ] * z + e[ 12 ] ) * w;\r\n\t\t\tthis.y = ( e[ 1 ] * x + e[ 5 ] * y + e[ 9 ] * z + e[ 13 ] ) * w;\r\n\t\t\tthis.z = ( e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ] ) * w;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tapplyQuaternion: function ( q ) {\r\n\r\n\t\t\tvar x = this.x, y = this.y, z = this.z;\r\n\t\t\tvar qx = q.x, qy = q.y, qz = q.z, qw = q.w;\r\n\r\n\t\t\t// calculate quat * vector\r\n\r\n\t\t\tvar ix = qw * x + qy * z - qz * y;\r\n\t\t\tvar iy = qw * y + qz * x - qx * z;\r\n\t\t\tvar iz = qw * z + qx * y - qy * x;\r\n\t\t\tvar iw = - qx * x - qy * y - qz * z;\r\n\r\n\t\t\t// calculate result * inverse quat\r\n\r\n\t\t\tthis.x = ix * qw + iw * - qx + iy * - qz - iz * - qy;\r\n\t\t\tthis.y = iy * qw + iw * - qy + iz * - qx - ix * - qz;\r\n\t\t\tthis.z = iz * qw + iw * - qz + ix * - qy - iy * - qx;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tproject: function ( camera ) {\r\n\r\n\t\t\treturn this.applyMatrix4( camera.matrixWorldInverse ).applyMatrix4( camera.projectionMatrix );\r\n\r\n\t\t},\r\n\r\n\t\tunproject: function () {\r\n\r\n\t\t\tvar matrix = new Matrix4();\r\n\r\n\t\t\treturn function unproject( camera ) {\r\n\r\n\t\t\t\treturn this.applyMatrix4( matrix.getInverse( camera.projectionMatrix ) ).applyMatrix4( camera.matrixWorld );\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\ttransformDirection: function ( m ) {\r\n\r\n\t\t\t// input: THREE.Matrix4 affine matrix\r\n\t\t\t// vector interpreted as a direction\r\n\r\n\t\t\tvar x = this.x, y = this.y, z = this.z;\r\n\t\t\tvar e = m.elements;\r\n\r\n\t\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ] * z;\r\n\t\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ] * z;\r\n\t\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z;\r\n\r\n\t\t\treturn this.normalize();\r\n\r\n\t\t},\r\n\r\n\t\tdivide: function ( v ) {\r\n\r\n\t\t\tthis.x /= v.x;\r\n\t\t\tthis.y /= v.y;\r\n\t\t\tthis.z /= v.z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tdivideScalar: function ( scalar ) {\r\n\r\n\t\t\treturn this.multiplyScalar( 1 / scalar );\r\n\r\n\t\t},\r\n\r\n\t\tmin: function ( v ) {\r\n\r\n\t\t\tthis.x = Math.min( this.x, v.x );\r\n\t\t\tthis.y = Math.min( this.y, v.y );\r\n\t\t\tthis.z = Math.min( this.z, v.z );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmax: function ( v ) {\r\n\r\n\t\t\tthis.x = Math.max( this.x, v.x );\r\n\t\t\tthis.y = Math.max( this.y, v.y );\r\n\t\t\tthis.z = Math.max( this.z, v.z );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclamp: function ( min, max ) {\r\n\r\n\t\t\t// assumes min < max, componentwise\r\n\r\n\t\t\tthis.x = Math.max( min.x, Math.min( max.x, this.x ) );\r\n\t\t\tthis.y = Math.max( min.y, Math.min( max.y, this.y ) );\r\n\t\t\tthis.z = Math.max( min.z, Math.min( max.z, this.z ) );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclampScalar: function () {\r\n\r\n\t\t\tvar min = new Vector3();\r\n\t\t\tvar max = new Vector3();\r\n\r\n\t\t\treturn function clampScalar( minVal, maxVal ) {\r\n\r\n\t\t\t\tmin.set( minVal, minVal, minVal );\r\n\t\t\t\tmax.set( maxVal, maxVal, maxVal );\r\n\r\n\t\t\t\treturn this.clamp( min, max );\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tclampLength: function ( min, max ) {\r\n\r\n\t\t\tvar length = this.length();\r\n\r\n\t\t\treturn this.divideScalar( length || 1 ).multiplyScalar( Math.max( min, Math.min( max, length ) ) );\r\n\r\n\t\t},\r\n\r\n\t\tfloor: function () {\r\n\r\n\t\t\tthis.x = Math.floor( this.x );\r\n\t\t\tthis.y = Math.floor( this.y );\r\n\t\t\tthis.z = Math.floor( this.z );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tceil: function () {\r\n\r\n\t\t\tthis.x = Math.ceil( this.x );\r\n\t\t\tthis.y = Math.ceil( this.y );\r\n\t\t\tthis.z = Math.ceil( this.z );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tround: function () {\r\n\r\n\t\t\tthis.x = Math.round( this.x );\r\n\t\t\tthis.y = Math.round( this.y );\r\n\t\t\tthis.z = Math.round( this.z );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\troundToZero: function () {\r\n\r\n\t\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\r\n\t\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\r\n\t\t\tthis.z = ( this.z < 0 ) ? Math.ceil( this.z ) : Math.floor( this.z );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tnegate: function () {\r\n\r\n\t\t\tthis.x = - this.x;\r\n\t\t\tthis.y = - this.y;\r\n\t\t\tthis.z = - this.z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tdot: function ( v ) {\r\n\r\n\t\t\treturn this.x * v.x + this.y * v.y + this.z * v.z;\r\n\r\n\t\t},\r\n\r\n\t\t// TODO lengthSquared?\r\n\r\n\t\tlengthSq: function () {\r\n\r\n\t\t\treturn this.x * this.x + this.y * this.y + this.z * this.z;\r\n\r\n\t\t},\r\n\r\n\t\tlength: function () {\r\n\r\n\t\t\treturn Math.sqrt( this.x * this.x + this.y * this.y + this.z * this.z );\r\n\r\n\t\t},\r\n\r\n\t\tmanhattanLength: function () {\r\n\r\n\t\t\treturn Math.abs( this.x ) + Math.abs( this.y ) + Math.abs( this.z );\r\n\r\n\t\t},\r\n\r\n\t\tnormalize: function () {\r\n\r\n\t\t\treturn this.divideScalar( this.length() || 1 );\r\n\r\n\t\t},\r\n\r\n\t\tsetLength: function ( length ) {\r\n\r\n\t\t\treturn this.normalize().multiplyScalar( length );\r\n\r\n\t\t},\r\n\r\n\t\tlerp: function ( v, alpha ) {\r\n\r\n\t\t\tthis.x += ( v.x - this.x ) * alpha;\r\n\t\t\tthis.y += ( v.y - this.y ) * alpha;\r\n\t\t\tthis.z += ( v.z - this.z ) * alpha;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tlerpVectors: function ( v1, v2, alpha ) {\r\n\r\n\t\t\treturn this.subVectors( v2, v1 ).multiplyScalar( alpha ).add( v1 );\r\n\r\n\t\t},\r\n\r\n\t\tcross: function ( v, w ) {\r\n\r\n\t\t\tif ( w !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead.' );\r\n\t\t\t\treturn this.crossVectors( v, w );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this.crossVectors( this, v );\r\n\r\n\t\t},\r\n\r\n\t\tcrossVectors: function ( a, b ) {\r\n\r\n\t\t\tvar ax = a.x, ay = a.y, az = a.z;\r\n\t\t\tvar bx = b.x, by = b.y, bz = b.z;\r\n\r\n\t\t\tthis.x = ay * bz - az * by;\r\n\t\t\tthis.y = az * bx - ax * bz;\r\n\t\t\tthis.z = ax * by - ay * bx;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tprojectOnVector: function ( vector ) {\r\n\r\n\t\t\tvar scalar = vector.dot( this ) / vector.lengthSq();\r\n\r\n\t\t\treturn this.copy( vector ).multiplyScalar( scalar );\r\n\r\n\t\t},\r\n\r\n\t\tprojectOnPlane: function () {\r\n\r\n\t\t\tvar v1 = new Vector3();\r\n\r\n\t\t\treturn function projectOnPlane( planeNormal ) {\r\n\r\n\t\t\t\tv1.copy( this ).projectOnVector( planeNormal );\r\n\r\n\t\t\t\treturn this.sub( v1 );\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\treflect: function () {\r\n\r\n\t\t\t// reflect incident vector off plane orthogonal to normal\r\n\t\t\t// normal is assumed to have unit length\r\n\r\n\t\t\tvar v1 = new Vector3();\r\n\r\n\t\t\treturn function reflect( normal ) {\r\n\r\n\t\t\t\treturn this.sub( v1.copy( normal ).multiplyScalar( 2 * this.dot( normal ) ) );\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tangleTo: function ( v ) {\r\n\r\n\t\t\tvar theta = this.dot( v ) / ( Math.sqrt( this.lengthSq() * v.lengthSq() ) );\r\n\r\n\t\t\t// clamp, to handle numerical problems\r\n\r\n\t\t\treturn Math.acos( _Math.clamp( theta, - 1, 1 ) );\r\n\r\n\t\t},\r\n\r\n\t\tdistanceTo: function ( v ) {\r\n\r\n\t\t\treturn Math.sqrt( this.distanceToSquared( v ) );\r\n\r\n\t\t},\r\n\r\n\t\tdistanceToSquared: function ( v ) {\r\n\r\n\t\t\tvar dx = this.x - v.x, dy = this.y - v.y, dz = this.z - v.z;\r\n\r\n\t\t\treturn dx * dx + dy * dy + dz * dz;\r\n\r\n\t\t},\r\n\r\n\t\tmanhattanDistanceTo: function ( v ) {\r\n\r\n\t\t\treturn Math.abs( this.x - v.x ) + Math.abs( this.y - v.y ) + Math.abs( this.z - v.z );\r\n\r\n\t\t},\r\n\r\n\t\tsetFromSpherical: function ( s ) {\r\n\r\n\t\t\treturn this.setFromSphericalCoords( s.radius, s.phi, s.theta );\r\n\r\n\t\t},\r\n\r\n\t\tsetFromSphericalCoords: function ( radius, phi, theta ) {\r\n\r\n\t\t\tvar sinPhiRadius = Math.sin( phi ) * radius;\r\n\r\n\t\t\tthis.x = sinPhiRadius * Math.sin( theta );\r\n\t\t\tthis.y = Math.cos( phi ) * radius;\r\n\t\t\tthis.z = sinPhiRadius * Math.cos( theta );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromCylindrical: function ( c ) {\r\n\r\n\t\t\treturn this.setFromCylindricalCoords( c.radius, c.theta, c.y );\r\n\r\n\t\t},\r\n\r\n\t\tsetFromCylindricalCoords: function ( radius, theta, y ) {\r\n\r\n\t\t\tthis.x = radius * Math.sin( theta );\r\n\t\t\tthis.y = y;\r\n\t\t\tthis.z = radius * Math.cos( theta );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromMatrixPosition: function ( m ) {\r\n\r\n\t\t\tvar e = m.elements;\r\n\r\n\t\t\tthis.x = e[ 12 ];\r\n\t\t\tthis.y = e[ 13 ];\r\n\t\t\tthis.z = e[ 14 ];\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromMatrixScale: function ( m ) {\r\n\r\n\t\t\tvar sx = this.setFromMatrixColumn( m, 0 ).length();\r\n\t\t\tvar sy = this.setFromMatrixColumn( m, 1 ).length();\r\n\t\t\tvar sz = this.setFromMatrixColumn( m, 2 ).length();\r\n\r\n\t\t\tthis.x = sx;\r\n\t\t\tthis.y = sy;\r\n\t\t\tthis.z = sz;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromMatrixColumn: function ( m, index ) {\r\n\r\n\t\t\treturn this.fromArray( m.elements, index * 4 );\r\n\r\n\t\t},\r\n\r\n\t\tequals: function ( v ) {\r\n\r\n\t\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) && ( v.z === this.z ) );\r\n\r\n\t\t},\r\n\r\n\t\tfromArray: function ( array, offset ) {\r\n\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\t\tthis.x = array[ offset ];\r\n\t\t\tthis.y = array[ offset + 1 ];\r\n\t\t\tthis.z = array[ offset + 2 ];\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoArray: function ( array, offset ) {\r\n\r\n\t\t\tif ( array === undefined ) array = [];\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\t\tarray[ offset ] = this.x;\r\n\t\t\tarray[ offset + 1 ] = this.y;\r\n\t\t\tarray[ offset + 2 ] = this.z;\r\n\r\n\t\t\treturn array;\r\n\r\n\t\t},\r\n\r\n\t\tfromBufferAttribute: function ( attribute, index, offset ) {\r\n\r\n\t\t\tif ( offset !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Vector3: offset has been removed from .fromBufferAttribute().' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.x = attribute.getX( index );\r\n\t\t\tthis.y = attribute.getY( index );\r\n\t\t\tthis.z = attribute.getZ( index );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t * @author bhouston / http://clara.io\r\n\t * @author tschw\r\n\t */\r\n\r\n\tfunction Matrix3() {\r\n\r\n\t\tthis.elements = [\r\n\r\n\t\t\t1, 0, 0,\r\n\t\t\t0, 1, 0,\r\n\t\t\t0, 0, 1\r\n\r\n\t\t];\r\n\r\n\t\tif ( arguments.length > 0 ) {\r\n\r\n\t\t\tconsole.error( 'THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.' );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tObject.assign( Matrix3.prototype, {\r\n\r\n\t\tisMatrix3: true,\r\n\r\n\t\tset: function ( n11, n12, n13, n21, n22, n23, n31, n32, n33 ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tte[ 0 ] = n11; te[ 1 ] = n21; te[ 2 ] = n31;\r\n\t\t\tte[ 3 ] = n12; te[ 4 ] = n22; te[ 5 ] = n32;\r\n\t\t\tte[ 6 ] = n13; te[ 7 ] = n23; te[ 8 ] = n33;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tidentity: function () {\r\n\r\n\t\t\tthis.set(\r\n\r\n\t\t\t\t1, 0, 0,\r\n\t\t\t\t0, 1, 0,\r\n\t\t\t\t0, 0, 1\r\n\r\n\t\t\t);\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().fromArray( this.elements );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( m ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\t\t\tvar me = m.elements;\r\n\r\n\t\t\tte[ 0 ] = me[ 0 ]; te[ 1 ] = me[ 1 ]; te[ 2 ] = me[ 2 ];\r\n\t\t\tte[ 3 ] = me[ 3 ]; te[ 4 ] = me[ 4 ]; te[ 5 ] = me[ 5 ];\r\n\t\t\tte[ 6 ] = me[ 6 ]; te[ 7 ] = me[ 7 ]; te[ 8 ] = me[ 8 ];\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromMatrix4: function ( m ) {\r\n\r\n\t\t\tvar me = m.elements;\r\n\r\n\t\t\tthis.set(\r\n\r\n\t\t\t\tme[ 0 ], me[ 4 ], me[ 8 ],\r\n\t\t\t\tme[ 1 ], me[ 5 ], me[ 9 ],\r\n\t\t\t\tme[ 2 ], me[ 6 ], me[ 10 ]\r\n\r\n\t\t\t);\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tapplyToBufferAttribute: function () {\r\n\r\n\t\t\tvar v1 = new Vector3();\r\n\r\n\t\t\treturn function applyToBufferAttribute( attribute ) {\r\n\r\n\t\t\t\tfor ( var i = 0, l = attribute.count; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tv1.x = attribute.getX( i );\r\n\t\t\t\t\tv1.y = attribute.getY( i );\r\n\t\t\t\t\tv1.z = attribute.getZ( i );\r\n\r\n\t\t\t\t\tv1.applyMatrix3( this );\r\n\r\n\t\t\t\t\tattribute.setXYZ( i, v1.x, v1.y, v1.z );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn attribute;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tmultiply: function ( m ) {\r\n\r\n\t\t\treturn this.multiplyMatrices( this, m );\r\n\r\n\t\t},\r\n\r\n\t\tpremultiply: function ( m ) {\r\n\r\n\t\t\treturn this.multiplyMatrices( m, this );\r\n\r\n\t\t},\r\n\r\n\t\tmultiplyMatrices: function ( a, b ) {\r\n\r\n\t\t\tvar ae = a.elements;\r\n\t\t\tvar be = b.elements;\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tvar a11 = ae[ 0 ], a12 = ae[ 3 ], a13 = ae[ 6 ];\r\n\t\t\tvar a21 = ae[ 1 ], a22 = ae[ 4 ], a23 = ae[ 7 ];\r\n\t\t\tvar a31 = ae[ 2 ], a32 = ae[ 5 ], a33 = ae[ 8 ];\r\n\r\n\t\t\tvar b11 = be[ 0 ], b12 = be[ 3 ], b13 = be[ 6 ];\r\n\t\t\tvar b21 = be[ 1 ], b22 = be[ 4 ], b23 = be[ 7 ];\r\n\t\t\tvar b31 = be[ 2 ], b32 = be[ 5 ], b33 = be[ 8 ];\r\n\r\n\t\t\tte[ 0 ] = a11 * b11 + a12 * b21 + a13 * b31;\r\n\t\t\tte[ 3 ] = a11 * b12 + a12 * b22 + a13 * b32;\r\n\t\t\tte[ 6 ] = a11 * b13 + a12 * b23 + a13 * b33;\r\n\r\n\t\t\tte[ 1 ] = a21 * b11 + a22 * b21 + a23 * b31;\r\n\t\t\tte[ 4 ] = a21 * b12 + a22 * b22 + a23 * b32;\r\n\t\t\tte[ 7 ] = a21 * b13 + a22 * b23 + a23 * b33;\r\n\r\n\t\t\tte[ 2 ] = a31 * b11 + a32 * b21 + a33 * b31;\r\n\t\t\tte[ 5 ] = a31 * b12 + a32 * b22 + a33 * b32;\r\n\t\t\tte[ 8 ] = a31 * b13 + a32 * b23 + a33 * b33;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmultiplyScalar: function ( s ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tte[ 0 ] *= s; te[ 3 ] *= s; te[ 6 ] *= s;\r\n\t\t\tte[ 1 ] *= s; te[ 4 ] *= s; te[ 7 ] *= s;\r\n\t\t\tte[ 2 ] *= s; te[ 5 ] *= s; te[ 8 ] *= s;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tdeterminant: function () {\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tvar a = te[ 0 ], b = te[ 1 ], c = te[ 2 ],\r\n\t\t\t\td = te[ 3 ], e = te[ 4 ], f = te[ 5 ],\r\n\t\t\t\tg = te[ 6 ], h = te[ 7 ], i = te[ 8 ];\r\n\r\n\t\t\treturn a * e * i - a * f * h - b * d * i + b * f * g + c * d * h - c * e * g;\r\n\r\n\t\t},\r\n\r\n\t\tgetInverse: function ( matrix, throwOnDegenerate ) {\r\n\r\n\t\t\tif ( matrix && matrix.isMatrix4 ) {\r\n\r\n\t\t\t\tconsole.error( \"THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.\" );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar me = matrix.elements,\r\n\t\t\t\tte = this.elements,\r\n\r\n\t\t\t\tn11 = me[ 0 ], n21 = me[ 1 ], n31 = me[ 2 ],\r\n\t\t\t\tn12 = me[ 3 ], n22 = me[ 4 ], n32 = me[ 5 ],\r\n\t\t\t\tn13 = me[ 6 ], n23 = me[ 7 ], n33 = me[ 8 ],\r\n\r\n\t\t\t\tt11 = n33 * n22 - n32 * n23,\r\n\t\t\t\tt12 = n32 * n13 - n33 * n12,\r\n\t\t\t\tt13 = n23 * n12 - n22 * n13,\r\n\r\n\t\t\t\tdet = n11 * t11 + n21 * t12 + n31 * t13;\r\n\r\n\t\t\tif ( det === 0 ) {\r\n\r\n\t\t\t\tvar msg = \"THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0\";\r\n\r\n\t\t\t\tif ( throwOnDegenerate === true ) {\r\n\r\n\t\t\t\t\tthrow new Error( msg );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tconsole.warn( msg );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn this.identity();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar detInv = 1 / det;\r\n\r\n\t\t\tte[ 0 ] = t11 * detInv;\r\n\t\t\tte[ 1 ] = ( n31 * n23 - n33 * n21 ) * detInv;\r\n\t\t\tte[ 2 ] = ( n32 * n21 - n31 * n22 ) * detInv;\r\n\r\n\t\t\tte[ 3 ] = t12 * detInv;\r\n\t\t\tte[ 4 ] = ( n33 * n11 - n31 * n13 ) * detInv;\r\n\t\t\tte[ 5 ] = ( n31 * n12 - n32 * n11 ) * detInv;\r\n\r\n\t\t\tte[ 6 ] = t13 * detInv;\r\n\t\t\tte[ 7 ] = ( n21 * n13 - n23 * n11 ) * detInv;\r\n\t\t\tte[ 8 ] = ( n22 * n11 - n21 * n12 ) * detInv;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttranspose: function () {\r\n\r\n\t\t\tvar tmp, m = this.elements;\r\n\r\n\t\t\ttmp = m[ 1 ]; m[ 1 ] = m[ 3 ]; m[ 3 ] = tmp;\r\n\t\t\ttmp = m[ 2 ]; m[ 2 ] = m[ 6 ]; m[ 6 ] = tmp;\r\n\t\t\ttmp = m[ 5 ]; m[ 5 ] = m[ 7 ]; m[ 7 ] = tmp;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetNormalMatrix: function ( matrix4 ) {\r\n\r\n\t\t\treturn this.setFromMatrix4( matrix4 ).getInverse( this ).transpose();\r\n\r\n\t\t},\r\n\r\n\t\ttransposeIntoArray: function ( r ) {\r\n\r\n\t\t\tvar m = this.elements;\r\n\r\n\t\t\tr[ 0 ] = m[ 0 ];\r\n\t\t\tr[ 1 ] = m[ 3 ];\r\n\t\t\tr[ 2 ] = m[ 6 ];\r\n\t\t\tr[ 3 ] = m[ 1 ];\r\n\t\t\tr[ 4 ] = m[ 4 ];\r\n\t\t\tr[ 5 ] = m[ 7 ];\r\n\t\t\tr[ 6 ] = m[ 2 ];\r\n\t\t\tr[ 7 ] = m[ 5 ];\r\n\t\t\tr[ 8 ] = m[ 8 ];\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetUvTransform: function ( tx, ty, sx, sy, rotation, cx, cy ) {\r\n\r\n\t\t\tvar c = Math.cos( rotation );\r\n\t\t\tvar s = Math.sin( rotation );\r\n\r\n\t\t\tthis.set(\r\n\t\t\t\tsx * c, sx * s, - sx * ( c * cx + s * cy ) + cx + tx,\r\n\t\t\t\t- sy * s, sy * c, - sy * ( - s * cx + c * cy ) + cy + ty,\r\n\t\t\t\t0, 0, 1\r\n\t\t\t);\r\n\r\n\t\t},\r\n\r\n\t\tscale: function ( sx, sy ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tte[ 0 ] *= sx; te[ 3 ] *= sx; te[ 6 ] *= sx;\r\n\t\t\tte[ 1 ] *= sy; te[ 4 ] *= sy; te[ 7 ] *= sy;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\trotate: function ( theta ) {\r\n\r\n\t\t\tvar c = Math.cos( theta );\r\n\t\t\tvar s = Math.sin( theta );\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tvar a11 = te[ 0 ], a12 = te[ 3 ], a13 = te[ 6 ];\r\n\t\t\tvar a21 = te[ 1 ], a22 = te[ 4 ], a23 = te[ 7 ];\r\n\r\n\t\t\tte[ 0 ] = c * a11 + s * a21;\r\n\t\t\tte[ 3 ] = c * a12 + s * a22;\r\n\t\t\tte[ 6 ] = c * a13 + s * a23;\r\n\r\n\t\t\tte[ 1 ] = - s * a11 + c * a21;\r\n\t\t\tte[ 4 ] = - s * a12 + c * a22;\r\n\t\t\tte[ 7 ] = - s * a13 + c * a23;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttranslate: function ( tx, ty ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tte[ 0 ] += tx * te[ 2 ]; te[ 3 ] += tx * te[ 5 ]; te[ 6 ] += tx * te[ 8 ];\r\n\t\t\tte[ 1 ] += ty * te[ 2 ]; te[ 4 ] += ty * te[ 5 ]; te[ 7 ] += ty * te[ 8 ];\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tequals: function ( matrix ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\t\t\tvar me = matrix.elements;\r\n\r\n\t\t\tfor ( var i = 0; i < 9; i ++ ) {\r\n\r\n\t\t\t\tif ( te[ i ] !== me[ i ] ) return false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t},\r\n\r\n\t\tfromArray: function ( array, offset ) {\r\n\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\t\tfor ( var i = 0; i < 9; i ++ ) {\r\n\r\n\t\t\t\tthis.elements[ i ] = array[ i + offset ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoArray: function ( array, offset ) {\r\n\r\n\t\t\tif ( array === undefined ) array = [];\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tarray[ offset ] = te[ 0 ];\r\n\t\t\tarray[ offset + 1 ] = te[ 1 ];\r\n\t\t\tarray[ offset + 2 ] = te[ 2 ];\r\n\r\n\t\t\tarray[ offset + 3 ] = te[ 3 ];\r\n\t\t\tarray[ offset + 4 ] = te[ 4 ];\r\n\t\t\tarray[ offset + 5 ] = te[ 5 ];\r\n\r\n\t\t\tarray[ offset + 6 ] = te[ 6 ];\r\n\t\t\tarray[ offset + 7 ] = te[ 7 ];\r\n\t\t\tarray[ offset + 8 ] = te[ 8 ];\r\n\r\n\t\t\treturn array;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author szimek / https://github.com/szimek/\r\n\t */\r\n\r\n\tvar ImageUtils = {\r\n\r\n\t\tgetDataURL: function ( image ) {\r\n\r\n\t\t\tvar canvas;\r\n\r\n\t\t\tif ( image instanceof HTMLCanvasElement ) {\r\n\r\n\t\t\t\tcanvas = image;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tcanvas = document.createElementNS( 'http://www.w3.org/1999/xhtml', 'canvas' );\r\n\t\t\t\tcanvas.width = image.width;\r\n\t\t\t\tcanvas.height = image.height;\r\n\r\n\t\t\t\tvar context = canvas.getContext( '2d' );\r\n\r\n\t\t\t\tif ( image instanceof ImageData ) {\r\n\r\n\t\t\t\t\tcontext.putImageData( image, 0, 0 );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tcontext.drawImage( image, 0, 0, image.width, image.height );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( canvas.width > 2048 || canvas.height > 2048 ) {\r\n\r\n\t\t\t\treturn canvas.toDataURL( 'image/jpeg', 0.6 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\treturn canvas.toDataURL( 'image/png' );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author szimek / https://github.com/szimek/\r\n\t */\r\n\r\n\tvar textureId = 0;\r\n\r\n\tfunction Texture( image, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, encoding ) {\r\n\r\n\t\tObject.defineProperty( this, 'id', { value: textureId ++ } );\r\n\r\n\t\tthis.uuid = _Math.generateUUID();\r\n\r\n\t\tthis.name = '';\r\n\r\n\t\tthis.image = image !== undefined ? image : Texture.DEFAULT_IMAGE;\r\n\t\tthis.mipmaps = [];\r\n\r\n\t\tthis.mapping = mapping !== undefined ? mapping : Texture.DEFAULT_MAPPING;\r\n\r\n\t\tthis.wrapS = wrapS !== undefined ? wrapS : ClampToEdgeWrapping;\r\n\t\tthis.wrapT = wrapT !== undefined ? wrapT : ClampToEdgeWrapping;\r\n\r\n\t\tthis.magFilter = magFilter !== undefined ? magFilter : LinearFilter;\r\n\t\tthis.minFilter = minFilter !== undefined ? minFilter : LinearMipMapLinearFilter;\r\n\r\n\t\tthis.anisotropy = anisotropy !== undefined ? anisotropy : 1;\r\n\r\n\t\tthis.format = format !== undefined ? format : RGBAFormat;\r\n\t\tthis.type = type !== undefined ? type : UnsignedByteType;\r\n\r\n\t\tthis.offset = new Vector2( 0, 0 );\r\n\t\tthis.repeat = new Vector2( 1, 1 );\r\n\t\tthis.center = new Vector2( 0, 0 );\r\n\t\tthis.rotation = 0;\r\n\r\n\t\tthis.matrixAutoUpdate = true;\r\n\t\tthis.matrix = new Matrix3();\r\n\r\n\t\tthis.generateMipmaps = true;\r\n\t\tthis.premultiplyAlpha = false;\r\n\t\tthis.flipY = true;\r\n\t\tthis.unpackAlignment = 4;\t// valid values: 1, 2, 4, 8 (see http://www.khronos.org/opengles/sdk/docs/man/xhtml/glPixelStorei.xml)\r\n\r\n\t\t// Values of encoding !== THREE.LinearEncoding only supported on map, envMap and emissiveMap.\r\n\t\t//\r\n\t\t// Also changing the encoding after already used by a Material will not automatically make the Material\r\n\t\t// update.  You need to explicitly call Material.needsUpdate to trigger it to recompile.\r\n\t\tthis.encoding = encoding !== undefined ? encoding : LinearEncoding;\r\n\r\n\t\tthis.version = 0;\r\n\t\tthis.onUpdate = null;\r\n\r\n\t}\r\n\r\n\tTexture.DEFAULT_IMAGE = undefined;\r\n\tTexture.DEFAULT_MAPPING = UVMapping;\r\n\r\n\tTexture.prototype = Object.assign( Object.create( EventDispatcher.prototype ), {\r\n\r\n\t\tconstructor: Texture,\r\n\r\n\t\tisTexture: true,\r\n\r\n\t\tupdateMatrix: function () {\r\n\r\n\t\t\tthis.matrix.setUvTransform( this.offset.x, this.offset.y, this.repeat.x, this.repeat.y, this.rotation, this.center.x, this.center.y );\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tthis.name = source.name;\r\n\r\n\t\t\tthis.image = source.image;\r\n\t\t\tthis.mipmaps = source.mipmaps.slice( 0 );\r\n\r\n\t\t\tthis.mapping = source.mapping;\r\n\r\n\t\t\tthis.wrapS = source.wrapS;\r\n\t\t\tthis.wrapT = source.wrapT;\r\n\r\n\t\t\tthis.magFilter = source.magFilter;\r\n\t\t\tthis.minFilter = source.minFilter;\r\n\r\n\t\t\tthis.anisotropy = source.anisotropy;\r\n\r\n\t\t\tthis.format = source.format;\r\n\t\t\tthis.type = source.type;\r\n\r\n\t\t\tthis.offset.copy( source.offset );\r\n\t\t\tthis.repeat.copy( source.repeat );\r\n\t\t\tthis.center.copy( source.center );\r\n\t\t\tthis.rotation = source.rotation;\r\n\r\n\t\t\tthis.matrixAutoUpdate = source.matrixAutoUpdate;\r\n\t\t\tthis.matrix.copy( source.matrix );\r\n\r\n\t\t\tthis.generateMipmaps = source.generateMipmaps;\r\n\t\t\tthis.premultiplyAlpha = source.premultiplyAlpha;\r\n\t\t\tthis.flipY = source.flipY;\r\n\t\t\tthis.unpackAlignment = source.unpackAlignment;\r\n\t\t\tthis.encoding = source.encoding;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function ( meta ) {\r\n\r\n\t\t\tvar isRootObject = ( meta === undefined || typeof meta === 'string' );\r\n\r\n\t\t\tif ( ! isRootObject && meta.textures[ this.uuid ] !== undefined ) {\r\n\r\n\t\t\t\treturn meta.textures[ this.uuid ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar output = {\r\n\r\n\t\t\t\tmetadata: {\r\n\t\t\t\t\tversion: 4.5,\r\n\t\t\t\t\ttype: 'Texture',\r\n\t\t\t\t\tgenerator: 'Texture.toJSON'\r\n\t\t\t\t},\r\n\r\n\t\t\t\tuuid: this.uuid,\r\n\t\t\t\tname: this.name,\r\n\r\n\t\t\t\tmapping: this.mapping,\r\n\r\n\t\t\t\trepeat: [ this.repeat.x, this.repeat.y ],\r\n\t\t\t\toffset: [ this.offset.x, this.offset.y ],\r\n\t\t\t\tcenter: [ this.center.x, this.center.y ],\r\n\t\t\t\trotation: this.rotation,\r\n\r\n\t\t\t\twrap: [ this.wrapS, this.wrapT ],\r\n\r\n\t\t\t\tformat: this.format,\r\n\t\t\t\tminFilter: this.minFilter,\r\n\t\t\t\tmagFilter: this.magFilter,\r\n\t\t\t\tanisotropy: this.anisotropy,\r\n\r\n\t\t\t\tflipY: this.flipY\r\n\r\n\t\t\t};\r\n\r\n\t\t\tif ( this.image !== undefined ) {\r\n\r\n\t\t\t\t// TODO: Move to THREE.Image\r\n\r\n\t\t\t\tvar image = this.image;\r\n\r\n\t\t\t\tif ( image.uuid === undefined ) {\r\n\r\n\t\t\t\t\timage.uuid = _Math.generateUUID(); // UGH\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( ! isRootObject && meta.images[ image.uuid ] === undefined ) {\r\n\r\n\t\t\t\t\tvar url;\r\n\r\n\t\t\t\t\tif ( Array.isArray( image ) ) {\r\n\r\n\t\t\t\t\t\t// process array of images e.g. CubeTexture\r\n\r\n\t\t\t\t\t\turl = [];\r\n\r\n\t\t\t\t\t\tfor ( var i = 0, l = image.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\t\t\turl.push( ImageUtils.getDataURL( image[ i ] ) );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// process single image\r\n\r\n\t\t\t\t\t\turl = ImageUtils.getDataURL( image );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tmeta.images[ image.uuid ] = {\r\n\t\t\t\t\t\tuuid: image.uuid,\r\n\t\t\t\t\t\turl: url\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\toutput.image = image.uuid;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( ! isRootObject ) {\r\n\r\n\t\t\t\tmeta.textures[ this.uuid ] = output;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn output;\r\n\r\n\t\t},\r\n\r\n\t\tdispose: function () {\r\n\r\n\t\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\r\n\t\t},\r\n\r\n\t\ttransformUv: function ( uv ) {\r\n\r\n\t\t\tif ( this.mapping !== UVMapping ) return;\r\n\r\n\t\t\tuv.applyMatrix3( this.matrix );\r\n\r\n\t\t\tif ( uv.x < 0 || uv.x > 1 ) {\r\n\r\n\t\t\t\tswitch ( this.wrapS ) {\r\n\r\n\t\t\t\t\tcase RepeatWrapping:\r\n\r\n\t\t\t\t\t\tuv.x = uv.x - Math.floor( uv.x );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase ClampToEdgeWrapping:\r\n\r\n\t\t\t\t\t\tuv.x = uv.x < 0 ? 0 : 1;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase MirroredRepeatWrapping:\r\n\r\n\t\t\t\t\t\tif ( Math.abs( Math.floor( uv.x ) % 2 ) === 1 ) {\r\n\r\n\t\t\t\t\t\t\tuv.x = Math.ceil( uv.x ) - uv.x;\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tuv.x = uv.x - Math.floor( uv.x );\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( uv.y < 0 || uv.y > 1 ) {\r\n\r\n\t\t\t\tswitch ( this.wrapT ) {\r\n\r\n\t\t\t\t\tcase RepeatWrapping:\r\n\r\n\t\t\t\t\t\tuv.y = uv.y - Math.floor( uv.y );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase ClampToEdgeWrapping:\r\n\r\n\t\t\t\t\t\tuv.y = uv.y < 0 ? 0 : 1;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase MirroredRepeatWrapping:\r\n\r\n\t\t\t\t\t\tif ( Math.abs( Math.floor( uv.y ) % 2 ) === 1 ) {\r\n\r\n\t\t\t\t\t\t\tuv.y = Math.ceil( uv.y ) - uv.y;\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tuv.y = uv.y - Math.floor( uv.y );\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.flipY ) {\r\n\r\n\t\t\t\tuv.y = 1 - uv.y;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.defineProperty( Texture.prototype, \"needsUpdate\", {\r\n\r\n\t\tset: function ( value ) {\r\n\r\n\t\t\tif ( value === true ) this.version ++;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author supereggbert / http://www.paulbrunt.co.uk/\r\n\t * @author philogb / http://blog.thejit.org/\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author egraether / http://egraether.com/\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t */\r\n\r\n\tfunction Vector4( x, y, z, w ) {\r\n\r\n\t\tthis.x = x || 0;\r\n\t\tthis.y = y || 0;\r\n\t\tthis.z = z || 0;\r\n\t\tthis.w = ( w !== undefined ) ? w : 1;\r\n\r\n\t}\r\n\r\n\tObject.assign( Vector4.prototype, {\r\n\r\n\t\tisVector4: true,\r\n\r\n\t\tset: function ( x, y, z, w ) {\r\n\r\n\t\t\tthis.x = x;\r\n\t\t\tthis.y = y;\r\n\t\t\tthis.z = z;\r\n\t\t\tthis.w = w;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetScalar: function ( scalar ) {\r\n\r\n\t\t\tthis.x = scalar;\r\n\t\t\tthis.y = scalar;\r\n\t\t\tthis.z = scalar;\r\n\t\t\tthis.w = scalar;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetX: function ( x ) {\r\n\r\n\t\t\tthis.x = x;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetY: function ( y ) {\r\n\r\n\t\t\tthis.y = y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetZ: function ( z ) {\r\n\r\n\t\t\tthis.z = z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetW: function ( w ) {\r\n\r\n\t\t\tthis.w = w;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetComponent: function ( index, value ) {\r\n\r\n\t\t\tswitch ( index ) {\r\n\r\n\t\t\t\tcase 0: this.x = value; break;\r\n\t\t\t\tcase 1: this.y = value; break;\r\n\t\t\t\tcase 2: this.z = value; break;\r\n\t\t\t\tcase 3: this.w = value; break;\r\n\t\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetComponent: function ( index ) {\r\n\r\n\t\t\tswitch ( index ) {\r\n\r\n\t\t\t\tcase 0: return this.x;\r\n\t\t\t\tcase 1: return this.y;\r\n\t\t\t\tcase 2: return this.z;\r\n\t\t\t\tcase 3: return this.w;\r\n\t\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor( this.x, this.y, this.z, this.w );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( v ) {\r\n\r\n\t\t\tthis.x = v.x;\r\n\t\t\tthis.y = v.y;\r\n\t\t\tthis.z = v.z;\r\n\t\t\tthis.w = ( v.w !== undefined ) ? v.w : 1;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tadd: function ( v, w ) {\r\n\r\n\t\t\tif ( w !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\r\n\t\t\t\treturn this.addVectors( v, w );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.x += v.x;\r\n\t\t\tthis.y += v.y;\r\n\t\t\tthis.z += v.z;\r\n\t\t\tthis.w += v.w;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\taddScalar: function ( s ) {\r\n\r\n\t\t\tthis.x += s;\r\n\t\t\tthis.y += s;\r\n\t\t\tthis.z += s;\r\n\t\t\tthis.w += s;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\taddVectors: function ( a, b ) {\r\n\r\n\t\t\tthis.x = a.x + b.x;\r\n\t\t\tthis.y = a.y + b.y;\r\n\t\t\tthis.z = a.z + b.z;\r\n\t\t\tthis.w = a.w + b.w;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\taddScaledVector: function ( v, s ) {\r\n\r\n\t\t\tthis.x += v.x * s;\r\n\t\t\tthis.y += v.y * s;\r\n\t\t\tthis.z += v.z * s;\r\n\t\t\tthis.w += v.w * s;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsub: function ( v, w ) {\r\n\r\n\t\t\tif ( w !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.' );\r\n\t\t\t\treturn this.subVectors( v, w );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.x -= v.x;\r\n\t\t\tthis.y -= v.y;\r\n\t\t\tthis.z -= v.z;\r\n\t\t\tthis.w -= v.w;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsubScalar: function ( s ) {\r\n\r\n\t\t\tthis.x -= s;\r\n\t\t\tthis.y -= s;\r\n\t\t\tthis.z -= s;\r\n\t\t\tthis.w -= s;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsubVectors: function ( a, b ) {\r\n\r\n\t\t\tthis.x = a.x - b.x;\r\n\t\t\tthis.y = a.y - b.y;\r\n\t\t\tthis.z = a.z - b.z;\r\n\t\t\tthis.w = a.w - b.w;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmultiplyScalar: function ( scalar ) {\r\n\r\n\t\t\tthis.x *= scalar;\r\n\t\t\tthis.y *= scalar;\r\n\t\t\tthis.z *= scalar;\r\n\t\t\tthis.w *= scalar;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tapplyMatrix4: function ( m ) {\r\n\r\n\t\t\tvar x = this.x, y = this.y, z = this.z, w = this.w;\r\n\t\t\tvar e = m.elements;\r\n\r\n\t\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ] * z + e[ 12 ] * w;\r\n\t\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ] * z + e[ 13 ] * w;\r\n\t\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ] * w;\r\n\t\t\tthis.w = e[ 3 ] * x + e[ 7 ] * y + e[ 11 ] * z + e[ 15 ] * w;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tdivideScalar: function ( scalar ) {\r\n\r\n\t\t\treturn this.multiplyScalar( 1 / scalar );\r\n\r\n\t\t},\r\n\r\n\t\tsetAxisAngleFromQuaternion: function ( q ) {\r\n\r\n\t\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/quaternionToAngle/index.htm\r\n\r\n\t\t\t// q is assumed to be normalized\r\n\r\n\t\t\tthis.w = 2 * Math.acos( q.w );\r\n\r\n\t\t\tvar s = Math.sqrt( 1 - q.w * q.w );\r\n\r\n\t\t\tif ( s < 0.0001 ) {\r\n\r\n\t\t\t\tthis.x = 1;\r\n\t\t\t\tthis.y = 0;\r\n\t\t\t\tthis.z = 0;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.x = q.x / s;\r\n\t\t\t\tthis.y = q.y / s;\r\n\t\t\t\tthis.z = q.z / s;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetAxisAngleFromRotationMatrix: function ( m ) {\r\n\r\n\t\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToAngle/index.htm\r\n\r\n\t\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\r\n\t\t\tvar angle, x, y, z,\t\t// variables for result\r\n\t\t\t\tepsilon = 0.01,\t\t// margin to allow for rounding errors\r\n\t\t\t\tepsilon2 = 0.1,\t\t// margin to distinguish between 0 and 180 degrees\r\n\r\n\t\t\t\tte = m.elements,\r\n\r\n\t\t\t\tm11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ],\r\n\t\t\t\tm21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ],\r\n\t\t\t\tm31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ];\r\n\r\n\t\t\tif ( ( Math.abs( m12 - m21 ) < epsilon ) &&\r\n\t\t\t     ( Math.abs( m13 - m31 ) < epsilon ) &&\r\n\t\t\t     ( Math.abs( m23 - m32 ) < epsilon ) ) {\r\n\r\n\t\t\t\t// singularity found\r\n\t\t\t\t// first check for identity matrix which must have +1 for all terms\r\n\t\t\t\t// in leading diagonal and zero in other terms\r\n\r\n\t\t\t\tif ( ( Math.abs( m12 + m21 ) < epsilon2 ) &&\r\n\t\t\t\t     ( Math.abs( m13 + m31 ) < epsilon2 ) &&\r\n\t\t\t\t     ( Math.abs( m23 + m32 ) < epsilon2 ) &&\r\n\t\t\t\t     ( Math.abs( m11 + m22 + m33 - 3 ) < epsilon2 ) ) {\r\n\r\n\t\t\t\t\t// this singularity is identity matrix so angle = 0\r\n\r\n\t\t\t\t\tthis.set( 1, 0, 0, 0 );\r\n\r\n\t\t\t\t\treturn this; // zero angle, arbitrary axis\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// otherwise this singularity is angle = 180\r\n\r\n\t\t\t\tangle = Math.PI;\r\n\r\n\t\t\t\tvar xx = ( m11 + 1 ) / 2;\r\n\t\t\t\tvar yy = ( m22 + 1 ) / 2;\r\n\t\t\t\tvar zz = ( m33 + 1 ) / 2;\r\n\t\t\t\tvar xy = ( m12 + m21 ) / 4;\r\n\t\t\t\tvar xz = ( m13 + m31 ) / 4;\r\n\t\t\t\tvar yz = ( m23 + m32 ) / 4;\r\n\r\n\t\t\t\tif ( ( xx > yy ) && ( xx > zz ) ) {\r\n\r\n\t\t\t\t\t// m11 is the largest diagonal term\r\n\r\n\t\t\t\t\tif ( xx < epsilon ) {\r\n\r\n\t\t\t\t\t\tx = 0;\r\n\t\t\t\t\t\ty = 0.707106781;\r\n\t\t\t\t\t\tz = 0.707106781;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tx = Math.sqrt( xx );\r\n\t\t\t\t\t\ty = xy / x;\r\n\t\t\t\t\t\tz = xz / x;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else if ( yy > zz ) {\r\n\r\n\t\t\t\t\t// m22 is the largest diagonal term\r\n\r\n\t\t\t\t\tif ( yy < epsilon ) {\r\n\r\n\t\t\t\t\t\tx = 0.707106781;\r\n\t\t\t\t\t\ty = 0;\r\n\t\t\t\t\t\tz = 0.707106781;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\ty = Math.sqrt( yy );\r\n\t\t\t\t\t\tx = xy / y;\r\n\t\t\t\t\t\tz = yz / y;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// m33 is the largest diagonal term so base result on this\r\n\r\n\t\t\t\t\tif ( zz < epsilon ) {\r\n\r\n\t\t\t\t\t\tx = 0.707106781;\r\n\t\t\t\t\t\ty = 0.707106781;\r\n\t\t\t\t\t\tz = 0;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tz = Math.sqrt( zz );\r\n\t\t\t\t\t\tx = xz / z;\r\n\t\t\t\t\t\ty = yz / z;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.set( x, y, z, angle );\r\n\r\n\t\t\t\treturn this; // return 180 deg rotation\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// as we have reached here there are no singularities so we can handle normally\r\n\r\n\t\t\tvar s = Math.sqrt( ( m32 - m23 ) * ( m32 - m23 ) +\r\n\t\t\t                   ( m13 - m31 ) * ( m13 - m31 ) +\r\n\t\t\t                   ( m21 - m12 ) * ( m21 - m12 ) ); // used to normalize\r\n\r\n\t\t\tif ( Math.abs( s ) < 0.001 ) s = 1;\r\n\r\n\t\t\t// prevent divide by zero, should not happen if matrix is orthogonal and should be\r\n\t\t\t// caught by singularity test above, but I've left it in just in case\r\n\r\n\t\t\tthis.x = ( m32 - m23 ) / s;\r\n\t\t\tthis.y = ( m13 - m31 ) / s;\r\n\t\t\tthis.z = ( m21 - m12 ) / s;\r\n\t\t\tthis.w = Math.acos( ( m11 + m22 + m33 - 1 ) / 2 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmin: function ( v ) {\r\n\r\n\t\t\tthis.x = Math.min( this.x, v.x );\r\n\t\t\tthis.y = Math.min( this.y, v.y );\r\n\t\t\tthis.z = Math.min( this.z, v.z );\r\n\t\t\tthis.w = Math.min( this.w, v.w );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmax: function ( v ) {\r\n\r\n\t\t\tthis.x = Math.max( this.x, v.x );\r\n\t\t\tthis.y = Math.max( this.y, v.y );\r\n\t\t\tthis.z = Math.max( this.z, v.z );\r\n\t\t\tthis.w = Math.max( this.w, v.w );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclamp: function ( min, max ) {\r\n\r\n\t\t\t// assumes min < max, componentwise\r\n\r\n\t\t\tthis.x = Math.max( min.x, Math.min( max.x, this.x ) );\r\n\t\t\tthis.y = Math.max( min.y, Math.min( max.y, this.y ) );\r\n\t\t\tthis.z = Math.max( min.z, Math.min( max.z, this.z ) );\r\n\t\t\tthis.w = Math.max( min.w, Math.min( max.w, this.w ) );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclampScalar: function () {\r\n\r\n\t\t\tvar min, max;\r\n\r\n\t\t\treturn function clampScalar( minVal, maxVal ) {\r\n\r\n\t\t\t\tif ( min === undefined ) {\r\n\r\n\t\t\t\t\tmin = new Vector4();\r\n\t\t\t\t\tmax = new Vector4();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tmin.set( minVal, minVal, minVal, minVal );\r\n\t\t\t\tmax.set( maxVal, maxVal, maxVal, maxVal );\r\n\r\n\t\t\t\treturn this.clamp( min, max );\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tclampLength: function ( min, max ) {\r\n\r\n\t\t\tvar length = this.length();\r\n\r\n\t\t\treturn this.divideScalar( length || 1 ).multiplyScalar( Math.max( min, Math.min( max, length ) ) );\r\n\r\n\t\t},\r\n\r\n\t\tfloor: function () {\r\n\r\n\t\t\tthis.x = Math.floor( this.x );\r\n\t\t\tthis.y = Math.floor( this.y );\r\n\t\t\tthis.z = Math.floor( this.z );\r\n\t\t\tthis.w = Math.floor( this.w );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tceil: function () {\r\n\r\n\t\t\tthis.x = Math.ceil( this.x );\r\n\t\t\tthis.y = Math.ceil( this.y );\r\n\t\t\tthis.z = Math.ceil( this.z );\r\n\t\t\tthis.w = Math.ceil( this.w );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tround: function () {\r\n\r\n\t\t\tthis.x = Math.round( this.x );\r\n\t\t\tthis.y = Math.round( this.y );\r\n\t\t\tthis.z = Math.round( this.z );\r\n\t\t\tthis.w = Math.round( this.w );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\troundToZero: function () {\r\n\r\n\t\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\r\n\t\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\r\n\t\t\tthis.z = ( this.z < 0 ) ? Math.ceil( this.z ) : Math.floor( this.z );\r\n\t\t\tthis.w = ( this.w < 0 ) ? Math.ceil( this.w ) : Math.floor( this.w );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tnegate: function () {\r\n\r\n\t\t\tthis.x = - this.x;\r\n\t\t\tthis.y = - this.y;\r\n\t\t\tthis.z = - this.z;\r\n\t\t\tthis.w = - this.w;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tdot: function ( v ) {\r\n\r\n\t\t\treturn this.x * v.x + this.y * v.y + this.z * v.z + this.w * v.w;\r\n\r\n\t\t},\r\n\r\n\t\tlengthSq: function () {\r\n\r\n\t\t\treturn this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w;\r\n\r\n\t\t},\r\n\r\n\t\tlength: function () {\r\n\r\n\t\t\treturn Math.sqrt( this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w );\r\n\r\n\t\t},\r\n\r\n\t\tmanhattanLength: function () {\r\n\r\n\t\t\treturn Math.abs( this.x ) + Math.abs( this.y ) + Math.abs( this.z ) + Math.abs( this.w );\r\n\r\n\t\t},\r\n\r\n\t\tnormalize: function () {\r\n\r\n\t\t\treturn this.divideScalar( this.length() || 1 );\r\n\r\n\t\t},\r\n\r\n\t\tsetLength: function ( length ) {\r\n\r\n\t\t\treturn this.normalize().multiplyScalar( length );\r\n\r\n\t\t},\r\n\r\n\t\tlerp: function ( v, alpha ) {\r\n\r\n\t\t\tthis.x += ( v.x - this.x ) * alpha;\r\n\t\t\tthis.y += ( v.y - this.y ) * alpha;\r\n\t\t\tthis.z += ( v.z - this.z ) * alpha;\r\n\t\t\tthis.w += ( v.w - this.w ) * alpha;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tlerpVectors: function ( v1, v2, alpha ) {\r\n\r\n\t\t\treturn this.subVectors( v2, v1 ).multiplyScalar( alpha ).add( v1 );\r\n\r\n\t\t},\r\n\r\n\t\tequals: function ( v ) {\r\n\r\n\t\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) && ( v.z === this.z ) && ( v.w === this.w ) );\r\n\r\n\t\t},\r\n\r\n\t\tfromArray: function ( array, offset ) {\r\n\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\t\tthis.x = array[ offset ];\r\n\t\t\tthis.y = array[ offset + 1 ];\r\n\t\t\tthis.z = array[ offset + 2 ];\r\n\t\t\tthis.w = array[ offset + 3 ];\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoArray: function ( array, offset ) {\r\n\r\n\t\t\tif ( array === undefined ) array = [];\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\t\tarray[ offset ] = this.x;\r\n\t\t\tarray[ offset + 1 ] = this.y;\r\n\t\t\tarray[ offset + 2 ] = this.z;\r\n\t\t\tarray[ offset + 3 ] = this.w;\r\n\r\n\t\t\treturn array;\r\n\r\n\t\t},\r\n\r\n\t\tfromBufferAttribute: function ( attribute, index, offset ) {\r\n\r\n\t\t\tif ( offset !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Vector4: offset has been removed from .fromBufferAttribute().' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.x = attribute.getX( index );\r\n\t\t\tthis.y = attribute.getY( index );\r\n\t\t\tthis.z = attribute.getZ( index );\r\n\t\t\tthis.w = attribute.getW( index );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author szimek / https://github.com/szimek/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author Marius Kintel / https://github.com/kintel\r\n\t */\r\n\r\n\t/*\r\n\t In options, we can specify:\r\n\t * Texture parameters for an auto-generated target texture\r\n\t * depthBuffer/stencilBuffer: Booleans to indicate if we should generate these buffers\r\n\t*/\r\n\tfunction WebGLRenderTarget( width, height, options ) {\r\n\r\n\t\tthis.width = width;\r\n\t\tthis.height = height;\r\n\r\n\t\tthis.scissor = new Vector4( 0, 0, width, height );\r\n\t\tthis.scissorTest = false;\r\n\r\n\t\tthis.viewport = new Vector4( 0, 0, width, height );\r\n\r\n\t\toptions = options || {};\r\n\r\n\t\tif ( options.minFilter === undefined ) options.minFilter = LinearFilter;\r\n\r\n\t\tthis.texture = new Texture( undefined, undefined, options.wrapS, options.wrapT, options.magFilter, options.minFilter, options.format, options.type, options.anisotropy, options.encoding );\r\n\r\n\t\tthis.texture.generateMipmaps = options.generateMipmaps !== undefined ? options.generateMipmaps : true;\r\n\r\n\t\tthis.depthBuffer = options.depthBuffer !== undefined ? options.depthBuffer : true;\r\n\t\tthis.stencilBuffer = options.stencilBuffer !== undefined ? options.stencilBuffer : true;\r\n\t\tthis.depthTexture = options.depthTexture !== undefined ? options.depthTexture : null;\r\n\r\n\t}\r\n\r\n\tWebGLRenderTarget.prototype = Object.assign( Object.create( EventDispatcher.prototype ), {\r\n\r\n\t\tconstructor: WebGLRenderTarget,\r\n\r\n\t\tisWebGLRenderTarget: true,\r\n\r\n\t\tsetSize: function ( width, height ) {\r\n\r\n\t\t\tif ( this.width !== width || this.height !== height ) {\r\n\r\n\t\t\t\tthis.width = width;\r\n\t\t\t\tthis.height = height;\r\n\r\n\t\t\t\tthis.dispose();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.viewport.set( 0, 0, width, height );\r\n\t\t\tthis.scissor.set( 0, 0, width, height );\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tthis.width = source.width;\r\n\t\t\tthis.height = source.height;\r\n\r\n\t\t\tthis.viewport.copy( source.viewport );\r\n\r\n\t\t\tthis.texture = source.texture.clone();\r\n\r\n\t\t\tthis.depthBuffer = source.depthBuffer;\r\n\t\t\tthis.stencilBuffer = source.stencilBuffer;\r\n\t\t\tthis.depthTexture = source.depthTexture;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tdispose: function () {\r\n\r\n\t\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com\r\n\t */\r\n\r\n\tfunction WebGLRenderTargetCube( width, height, options ) {\r\n\r\n\t\tWebGLRenderTarget.call( this, width, height, options );\r\n\r\n\t\tthis.activeCubeFace = 0; // PX 0, NX 1, PY 2, NY 3, PZ 4, NZ 5\r\n\t\tthis.activeMipMapLevel = 0;\r\n\r\n\t}\r\n\r\n\tWebGLRenderTargetCube.prototype = Object.create( WebGLRenderTarget.prototype );\r\n\tWebGLRenderTargetCube.prototype.constructor = WebGLRenderTargetCube;\r\n\r\n\tWebGLRenderTargetCube.prototype.isWebGLRenderTargetCube = true;\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\r\n\tfunction DataTexture( data, width, height, format, type, mapping, wrapS, wrapT, magFilter, minFilter, anisotropy, encoding ) {\r\n\r\n\t\tTexture.call( this, null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, encoding );\r\n\r\n\t\tthis.image = { data: data, width: width, height: height };\r\n\r\n\t\tthis.magFilter = magFilter !== undefined ? magFilter : NearestFilter;\r\n\t\tthis.minFilter = minFilter !== undefined ? minFilter : NearestFilter;\r\n\r\n\t\tthis.generateMipmaps = false;\r\n\t\tthis.flipY = false;\r\n\t\tthis.unpackAlignment = 1;\r\n\r\n\t}\r\n\r\n\tDataTexture.prototype = Object.create( Texture.prototype );\r\n\tDataTexture.prototype.constructor = DataTexture;\r\n\r\n\tDataTexture.prototype.isDataTexture = true;\r\n\r\n\t/**\r\n\t * @author bhouston / http://clara.io\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t */\r\n\r\n\tfunction Box3( min, max ) {\r\n\r\n\t\tthis.min = ( min !== undefined ) ? min : new Vector3( + Infinity, + Infinity, + Infinity );\r\n\t\tthis.max = ( max !== undefined ) ? max : new Vector3( - Infinity, - Infinity, - Infinity );\r\n\r\n\t}\r\n\r\n\tObject.assign( Box3.prototype, {\r\n\r\n\t\tisBox3: true,\r\n\r\n\t\tset: function ( min, max ) {\r\n\r\n\t\t\tthis.min.copy( min );\r\n\t\t\tthis.max.copy( max );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromArray: function ( array ) {\r\n\r\n\t\t\tvar minX = + Infinity;\r\n\t\t\tvar minY = + Infinity;\r\n\t\t\tvar minZ = + Infinity;\r\n\r\n\t\t\tvar maxX = - Infinity;\r\n\t\t\tvar maxY = - Infinity;\r\n\t\t\tvar maxZ = - Infinity;\r\n\r\n\t\t\tfor ( var i = 0, l = array.length; i < l; i += 3 ) {\r\n\r\n\t\t\t\tvar x = array[ i ];\r\n\t\t\t\tvar y = array[ i + 1 ];\r\n\t\t\t\tvar z = array[ i + 2 ];\r\n\r\n\t\t\t\tif ( x < minX ) minX = x;\r\n\t\t\t\tif ( y < minY ) minY = y;\r\n\t\t\t\tif ( z < minZ ) minZ = z;\r\n\r\n\t\t\t\tif ( x > maxX ) maxX = x;\r\n\t\t\t\tif ( y > maxY ) maxY = y;\r\n\t\t\t\tif ( z > maxZ ) maxZ = z;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.min.set( minX, minY, minZ );\r\n\t\t\tthis.max.set( maxX, maxY, maxZ );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromBufferAttribute: function ( attribute ) {\r\n\r\n\t\t\tvar minX = + Infinity;\r\n\t\t\tvar minY = + Infinity;\r\n\t\t\tvar minZ = + Infinity;\r\n\r\n\t\t\tvar maxX = - Infinity;\r\n\t\t\tvar maxY = - Infinity;\r\n\t\t\tvar maxZ = - Infinity;\r\n\r\n\t\t\tfor ( var i = 0, l = attribute.count; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar x = attribute.getX( i );\r\n\t\t\t\tvar y = attribute.getY( i );\r\n\t\t\t\tvar z = attribute.getZ( i );\r\n\r\n\t\t\t\tif ( x < minX ) minX = x;\r\n\t\t\t\tif ( y < minY ) minY = y;\r\n\t\t\t\tif ( z < minZ ) minZ = z;\r\n\r\n\t\t\t\tif ( x > maxX ) maxX = x;\r\n\t\t\t\tif ( y > maxY ) maxY = y;\r\n\t\t\t\tif ( z > maxZ ) maxZ = z;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.min.set( minX, minY, minZ );\r\n\t\t\tthis.max.set( maxX, maxY, maxZ );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromPoints: function ( points ) {\r\n\r\n\t\t\tthis.makeEmpty();\r\n\r\n\t\t\tfor ( var i = 0, il = points.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tthis.expandByPoint( points[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromCenterAndSize: function () {\r\n\r\n\t\t\tvar v1 = new Vector3();\r\n\r\n\t\t\treturn function setFromCenterAndSize( center, size ) {\r\n\r\n\t\t\t\tvar halfSize = v1.copy( size ).multiplyScalar( 0.5 );\r\n\r\n\t\t\t\tthis.min.copy( center ).sub( halfSize );\r\n\t\t\t\tthis.max.copy( center ).add( halfSize );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tsetFromObject: function ( object ) {\r\n\r\n\t\t\tthis.makeEmpty();\r\n\r\n\t\t\treturn this.expandByObject( object );\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( box ) {\r\n\r\n\t\t\tthis.min.copy( box.min );\r\n\t\t\tthis.max.copy( box.max );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmakeEmpty: function () {\r\n\r\n\t\t\tthis.min.x = this.min.y = this.min.z = + Infinity;\r\n\t\t\tthis.max.x = this.max.y = this.max.z = - Infinity;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tisEmpty: function () {\r\n\r\n\t\t\t// this is a more robust check for empty than ( volume <= 0 ) because volume can get positive with two negative axes\r\n\r\n\t\t\treturn ( this.max.x < this.min.x ) || ( this.max.y < this.min.y ) || ( this.max.z < this.min.z );\r\n\r\n\t\t},\r\n\r\n\t\tgetCenter: function ( target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Box3: .getCenter() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this.isEmpty() ? target.set( 0, 0, 0 ) : target.addVectors( this.min, this.max ).multiplyScalar( 0.5 );\r\n\r\n\t\t},\r\n\r\n\t\tgetSize: function ( target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Box3: .getSize() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this.isEmpty() ? target.set( 0, 0, 0 ) : target.subVectors( this.max, this.min );\r\n\r\n\t\t},\r\n\r\n\t\texpandByPoint: function ( point ) {\r\n\r\n\t\t\tthis.min.min( point );\r\n\t\t\tthis.max.max( point );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\texpandByVector: function ( vector ) {\r\n\r\n\t\t\tthis.min.sub( vector );\r\n\t\t\tthis.max.add( vector );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\texpandByScalar: function ( scalar ) {\r\n\r\n\t\t\tthis.min.addScalar( - scalar );\r\n\t\t\tthis.max.addScalar( scalar );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\texpandByObject: function () {\r\n\r\n\t\t\t// Computes the world-axis-aligned bounding box of an object (including its children),\r\n\t\t\t// accounting for both the object's, and children's, world transforms\r\n\r\n\t\t\tvar scope, i, l;\r\n\r\n\t\t\tvar v1 = new Vector3();\r\n\r\n\t\t\tfunction traverse( node ) {\r\n\r\n\t\t\t\tvar geometry = node.geometry;\r\n\r\n\t\t\t\tif ( geometry !== undefined ) {\r\n\r\n\t\t\t\t\tif ( geometry.isGeometry ) {\r\n\r\n\t\t\t\t\t\tvar vertices = geometry.vertices;\r\n\r\n\t\t\t\t\t\tfor ( i = 0, l = vertices.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tv1.copy( vertices[ i ] );\r\n\t\t\t\t\t\t\tv1.applyMatrix4( node.matrixWorld );\r\n\r\n\t\t\t\t\t\t\tscope.expandByPoint( v1 );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else if ( geometry.isBufferGeometry ) {\r\n\r\n\t\t\t\t\t\tvar attribute = geometry.attributes.position;\r\n\r\n\t\t\t\t\t\tif ( attribute !== undefined ) {\r\n\r\n\t\t\t\t\t\t\tfor ( i = 0, l = attribute.count; i < l; i ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tv1.fromBufferAttribute( attribute, i ).applyMatrix4( node.matrixWorld );\r\n\r\n\t\t\t\t\t\t\t\tscope.expandByPoint( v1 );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn function expandByObject( object ) {\r\n\r\n\t\t\t\tscope = this;\r\n\r\n\t\t\t\tobject.updateMatrixWorld( true );\r\n\r\n\t\t\t\tobject.traverse( traverse );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tcontainsPoint: function ( point ) {\r\n\r\n\t\t\treturn point.x < this.min.x || point.x > this.max.x ||\r\n\t\t\t\tpoint.y < this.min.y || point.y > this.max.y ||\r\n\t\t\t\tpoint.z < this.min.z || point.z > this.max.z ? false : true;\r\n\r\n\t\t},\r\n\r\n\t\tcontainsBox: function ( box ) {\r\n\r\n\t\t\treturn this.min.x <= box.min.x && box.max.x <= this.max.x &&\r\n\t\t\t\tthis.min.y <= box.min.y && box.max.y <= this.max.y &&\r\n\t\t\t\tthis.min.z <= box.min.z && box.max.z <= this.max.z;\r\n\r\n\t\t},\r\n\r\n\t\tgetParameter: function ( point, target ) {\r\n\r\n\t\t\t// This can potentially have a divide by zero if the box\r\n\t\t\t// has a size dimension of 0.\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Box3: .getParameter() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn target.set(\r\n\t\t\t\t( point.x - this.min.x ) / ( this.max.x - this.min.x ),\r\n\t\t\t\t( point.y - this.min.y ) / ( this.max.y - this.min.y ),\r\n\t\t\t\t( point.z - this.min.z ) / ( this.max.z - this.min.z )\r\n\t\t\t);\r\n\r\n\t\t},\r\n\r\n\t\tintersectsBox: function ( box ) {\r\n\r\n\t\t\t// using 6 splitting planes to rule out intersections.\r\n\t\t\treturn box.max.x < this.min.x || box.min.x > this.max.x ||\r\n\t\t\t\tbox.max.y < this.min.y || box.min.y > this.max.y ||\r\n\t\t\t\tbox.max.z < this.min.z || box.min.z > this.max.z ? false : true;\r\n\r\n\t\t},\r\n\r\n\t\tintersectsSphere: ( function () {\r\n\r\n\t\t\tvar closestPoint = new Vector3();\r\n\r\n\t\t\treturn function intersectsSphere( sphere ) {\r\n\r\n\t\t\t\t// Find the point on the AABB closest to the sphere center.\r\n\t\t\t\tthis.clampPoint( sphere.center, closestPoint );\r\n\r\n\t\t\t\t// If that point is inside the sphere, the AABB and sphere intersect.\r\n\t\t\t\treturn closestPoint.distanceToSquared( sphere.center ) <= ( sphere.radius * sphere.radius );\r\n\r\n\t\t\t};\r\n\r\n\t\t} )(),\r\n\r\n\t\tintersectsPlane: function ( plane ) {\r\n\r\n\t\t\t// We compute the minimum and maximum dot product values. If those values\r\n\t\t\t// are on the same side (back or front) of the plane, then there is no intersection.\r\n\r\n\t\t\tvar min, max;\r\n\r\n\t\t\tif ( plane.normal.x > 0 ) {\r\n\r\n\t\t\t\tmin = plane.normal.x * this.min.x;\r\n\t\t\t\tmax = plane.normal.x * this.max.x;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tmin = plane.normal.x * this.max.x;\r\n\t\t\t\tmax = plane.normal.x * this.min.x;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( plane.normal.y > 0 ) {\r\n\r\n\t\t\t\tmin += plane.normal.y * this.min.y;\r\n\t\t\t\tmax += plane.normal.y * this.max.y;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tmin += plane.normal.y * this.max.y;\r\n\t\t\t\tmax += plane.normal.y * this.min.y;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( plane.normal.z > 0 ) {\r\n\r\n\t\t\t\tmin += plane.normal.z * this.min.z;\r\n\t\t\t\tmax += plane.normal.z * this.max.z;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tmin += plane.normal.z * this.max.z;\r\n\t\t\t\tmax += plane.normal.z * this.min.z;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn ( min <= plane.constant && max >= plane.constant );\r\n\r\n\t\t},\r\n\r\n\t\tintersectsTriangle: ( function () {\r\n\r\n\t\t\t// triangle centered vertices\r\n\t\t\tvar v0 = new Vector3();\r\n\t\t\tvar v1 = new Vector3();\r\n\t\t\tvar v2 = new Vector3();\r\n\r\n\t\t\t// triangle edge vectors\r\n\t\t\tvar f0 = new Vector3();\r\n\t\t\tvar f1 = new Vector3();\r\n\t\t\tvar f2 = new Vector3();\r\n\r\n\t\t\tvar testAxis = new Vector3();\r\n\r\n\t\t\tvar center = new Vector3();\r\n\t\t\tvar extents = new Vector3();\r\n\r\n\t\t\tvar triangleNormal = new Vector3();\r\n\r\n\t\t\tfunction satForAxes( axes ) {\r\n\r\n\t\t\t\tvar i, j;\r\n\r\n\t\t\t\tfor ( i = 0, j = axes.length - 3; i <= j; i += 3 ) {\r\n\r\n\t\t\t\t\ttestAxis.fromArray( axes, i );\r\n\t\t\t\t\t// project the aabb onto the seperating axis\r\n\t\t\t\t\tvar r = extents.x * Math.abs( testAxis.x ) + extents.y * Math.abs( testAxis.y ) + extents.z * Math.abs( testAxis.z );\r\n\t\t\t\t\t// project all 3 vertices of the triangle onto the seperating axis\r\n\t\t\t\t\tvar p0 = v0.dot( testAxis );\r\n\t\t\t\t\tvar p1 = v1.dot( testAxis );\r\n\t\t\t\t\tvar p2 = v2.dot( testAxis );\r\n\t\t\t\t\t// actual test, basically see if either of the most extreme of the triangle points intersects r\r\n\t\t\t\t\tif ( Math.max( - Math.max( p0, p1, p2 ), Math.min( p0, p1, p2 ) ) > r ) {\r\n\r\n\t\t\t\t\t\t// points of the projected triangle are outside the projected half-length of the aabb\r\n\t\t\t\t\t\t// the axis is seperating and we can exit\r\n\t\t\t\t\t\treturn false;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn function intersectsTriangle( triangle ) {\r\n\r\n\t\t\t\tif ( this.isEmpty() ) {\r\n\r\n\t\t\t\t\treturn false;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// compute box center and extents\r\n\t\t\t\tthis.getCenter( center );\r\n\t\t\t\textents.subVectors( this.max, center );\r\n\r\n\t\t\t\t// translate triangle to aabb origin\r\n\t\t\t\tv0.subVectors( triangle.a, center );\r\n\t\t\t\tv1.subVectors( triangle.b, center );\r\n\t\t\t\tv2.subVectors( triangle.c, center );\r\n\r\n\t\t\t\t// compute edge vectors for triangle\r\n\t\t\t\tf0.subVectors( v1, v0 );\r\n\t\t\t\tf1.subVectors( v2, v1 );\r\n\t\t\t\tf2.subVectors( v0, v2 );\r\n\r\n\t\t\t\t// test against axes that are given by cross product combinations of the edges of the triangle and the edges of the aabb\r\n\t\t\t\t// make an axis testing of each of the 3 sides of the aabb against each of the 3 sides of the triangle = 9 axis of separation\r\n\t\t\t\t// axis_ij = u_i x f_j (u0, u1, u2 = face normals of aabb = x,y,z axes vectors since aabb is axis aligned)\r\n\t\t\t\tvar axes = [\r\n\t\t\t\t\t0, - f0.z, f0.y, 0, - f1.z, f1.y, 0, - f2.z, f2.y,\r\n\t\t\t\t\tf0.z, 0, - f0.x, f1.z, 0, - f1.x, f2.z, 0, - f2.x,\r\n\t\t\t\t\t- f0.y, f0.x, 0, - f1.y, f1.x, 0, - f2.y, f2.x, 0\r\n\t\t\t\t];\r\n\t\t\t\tif ( ! satForAxes( axes ) ) {\r\n\r\n\t\t\t\t\treturn false;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// test 3 face normals from the aabb\r\n\t\t\t\taxes = [ 1, 0, 0, 0, 1, 0, 0, 0, 1 ];\r\n\t\t\t\tif ( ! satForAxes( axes ) ) {\r\n\r\n\t\t\t\t\treturn false;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// finally testing the face normal of the triangle\r\n\t\t\t\t// use already existing triangle edge vectors here\r\n\t\t\t\ttriangleNormal.crossVectors( f0, f1 );\r\n\t\t\t\taxes = [ triangleNormal.x, triangleNormal.y, triangleNormal.z ];\r\n\t\t\t\treturn satForAxes( axes );\r\n\r\n\t\t\t};\r\n\r\n\t\t} )(),\r\n\r\n\t\tclampPoint: function ( point, target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Box3: .clampPoint() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn target.copy( point ).clamp( this.min, this.max );\r\n\r\n\t\t},\r\n\r\n\t\tdistanceToPoint: function () {\r\n\r\n\t\t\tvar v1 = new Vector3();\r\n\r\n\t\t\treturn function distanceToPoint( point ) {\r\n\r\n\t\t\t\tvar clampedPoint = v1.copy( point ).clamp( this.min, this.max );\r\n\t\t\t\treturn clampedPoint.sub( point ).length();\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tgetBoundingSphere: function () {\r\n\r\n\t\t\tvar v1 = new Vector3();\r\n\r\n\t\t\treturn function getBoundingSphere( target ) {\r\n\r\n\t\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.Box3: .getBoundingSphere() target is now required' );\r\n\t\t\t\t\ttarget = new Sphere();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.getCenter( target.center );\r\n\r\n\t\t\t\ttarget.radius = this.getSize( v1 ).length() * 0.5;\r\n\r\n\t\t\t\treturn target;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tintersect: function ( box ) {\r\n\r\n\t\t\tthis.min.max( box.min );\r\n\t\t\tthis.max.min( box.max );\r\n\r\n\t\t\t// ensure that if there is no overlap, the result is fully empty, not slightly empty with non-inf/+inf values that will cause subsequence intersects to erroneously return valid values.\r\n\t\t\tif ( this.isEmpty() ) this.makeEmpty();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tunion: function ( box ) {\r\n\r\n\t\t\tthis.min.min( box.min );\r\n\t\t\tthis.max.max( box.max );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tapplyMatrix4: function () {\r\n\r\n\t\t\tvar points = [\r\n\t\t\t\tnew Vector3(),\r\n\t\t\t\tnew Vector3(),\r\n\t\t\t\tnew Vector3(),\r\n\t\t\t\tnew Vector3(),\r\n\t\t\t\tnew Vector3(),\r\n\t\t\t\tnew Vector3(),\r\n\t\t\t\tnew Vector3(),\r\n\t\t\t\tnew Vector3()\r\n\t\t\t];\r\n\r\n\t\t\treturn function applyMatrix4( matrix ) {\r\n\r\n\t\t\t\t// transform of empty box is an empty box.\r\n\t\t\t\tif ( this.isEmpty() ) return this;\r\n\r\n\t\t\t\t// NOTE: I am using a binary pattern to specify all 2^3 combinations below\r\n\t\t\t\tpoints[ 0 ].set( this.min.x, this.min.y, this.min.z ).applyMatrix4( matrix ); // 000\r\n\t\t\t\tpoints[ 1 ].set( this.min.x, this.min.y, this.max.z ).applyMatrix4( matrix ); // 001\r\n\t\t\t\tpoints[ 2 ].set( this.min.x, this.max.y, this.min.z ).applyMatrix4( matrix ); // 010\r\n\t\t\t\tpoints[ 3 ].set( this.min.x, this.max.y, this.max.z ).applyMatrix4( matrix ); // 011\r\n\t\t\t\tpoints[ 4 ].set( this.max.x, this.min.y, this.min.z ).applyMatrix4( matrix ); // 100\r\n\t\t\t\tpoints[ 5 ].set( this.max.x, this.min.y, this.max.z ).applyMatrix4( matrix ); // 101\r\n\t\t\t\tpoints[ 6 ].set( this.max.x, this.max.y, this.min.z ).applyMatrix4( matrix ); // 110\r\n\t\t\t\tpoints[ 7 ].set( this.max.x, this.max.y, this.max.z ).applyMatrix4( matrix ); // 111\r\n\r\n\t\t\t\tthis.setFromPoints( points );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\ttranslate: function ( offset ) {\r\n\r\n\t\t\tthis.min.add( offset );\r\n\t\t\tthis.max.add( offset );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tequals: function ( box ) {\r\n\r\n\t\t\treturn box.min.equals( this.min ) && box.max.equals( this.max );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author bhouston / http://clara.io\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction Sphere( center, radius ) {\r\n\r\n\t\tthis.center = ( center !== undefined ) ? center : new Vector3();\r\n\t\tthis.radius = ( radius !== undefined ) ? radius : 0;\r\n\r\n\t}\r\n\r\n\tObject.assign( Sphere.prototype, {\r\n\r\n\t\tset: function ( center, radius ) {\r\n\r\n\t\t\tthis.center.copy( center );\r\n\t\t\tthis.radius = radius;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromPoints: function () {\r\n\r\n\t\t\tvar box = new Box3();\r\n\r\n\t\t\treturn function setFromPoints( points, optionalCenter ) {\r\n\r\n\t\t\t\tvar center = this.center;\r\n\r\n\t\t\t\tif ( optionalCenter !== undefined ) {\r\n\r\n\t\t\t\t\tcenter.copy( optionalCenter );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tbox.setFromPoints( points ).getCenter( center );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar maxRadiusSq = 0;\r\n\r\n\t\t\t\tfor ( var i = 0, il = points.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( points[ i ] ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.radius = Math.sqrt( maxRadiusSq );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( sphere ) {\r\n\r\n\t\t\tthis.center.copy( sphere.center );\r\n\t\t\tthis.radius = sphere.radius;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tempty: function () {\r\n\r\n\t\t\treturn ( this.radius <= 0 );\r\n\r\n\t\t},\r\n\r\n\t\tcontainsPoint: function ( point ) {\r\n\r\n\t\t\treturn ( point.distanceToSquared( this.center ) <= ( this.radius * this.radius ) );\r\n\r\n\t\t},\r\n\r\n\t\tdistanceToPoint: function ( point ) {\r\n\r\n\t\t\treturn ( point.distanceTo( this.center ) - this.radius );\r\n\r\n\t\t},\r\n\r\n\t\tintersectsSphere: function ( sphere ) {\r\n\r\n\t\t\tvar radiusSum = this.radius + sphere.radius;\r\n\r\n\t\t\treturn sphere.center.distanceToSquared( this.center ) <= ( radiusSum * radiusSum );\r\n\r\n\t\t},\r\n\r\n\t\tintersectsBox: function ( box ) {\r\n\r\n\t\t\treturn box.intersectsSphere( this );\r\n\r\n\t\t},\r\n\r\n\t\tintersectsPlane: function ( plane ) {\r\n\r\n\t\t\treturn Math.abs( plane.distanceToPoint( this.center ) ) <= this.radius;\r\n\r\n\t\t},\r\n\r\n\t\tclampPoint: function ( point, target ) {\r\n\r\n\t\t\tvar deltaLengthSq = this.center.distanceToSquared( point );\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Sphere: .clampPoint() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\ttarget.copy( point );\r\n\r\n\t\t\tif ( deltaLengthSq > ( this.radius * this.radius ) ) {\r\n\r\n\t\t\t\ttarget.sub( this.center ).normalize();\r\n\t\t\t\ttarget.multiplyScalar( this.radius ).add( this.center );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn target;\r\n\r\n\t\t},\r\n\r\n\t\tgetBoundingBox: function ( target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Sphere: .getBoundingBox() target is now required' );\r\n\t\t\t\ttarget = new Box3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\ttarget.set( this.center, this.center );\r\n\t\t\ttarget.expandByScalar( this.radius );\r\n\r\n\t\t\treturn target;\r\n\r\n\t\t},\r\n\r\n\t\tapplyMatrix4: function ( matrix ) {\r\n\r\n\t\t\tthis.center.applyMatrix4( matrix );\r\n\t\t\tthis.radius = this.radius * matrix.getMaxScaleOnAxis();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttranslate: function ( offset ) {\r\n\r\n\t\t\tthis.center.add( offset );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tequals: function ( sphere ) {\r\n\r\n\t\t\treturn sphere.center.equals( this.center ) && ( sphere.radius === this.radius );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author bhouston / http://clara.io\r\n\t */\r\n\r\n\tfunction Plane( normal, constant ) {\r\n\r\n\t\t// normal is assumed to be normalized\r\n\r\n\t\tthis.normal = ( normal !== undefined ) ? normal : new Vector3( 1, 0, 0 );\r\n\t\tthis.constant = ( constant !== undefined ) ? constant : 0;\r\n\r\n\t}\r\n\r\n\tObject.assign( Plane.prototype, {\r\n\r\n\t\tset: function ( normal, constant ) {\r\n\r\n\t\t\tthis.normal.copy( normal );\r\n\t\t\tthis.constant = constant;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetComponents: function ( x, y, z, w ) {\r\n\r\n\t\t\tthis.normal.set( x, y, z );\r\n\t\t\tthis.constant = w;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromNormalAndCoplanarPoint: function ( normal, point ) {\r\n\r\n\t\t\tthis.normal.copy( normal );\r\n\t\t\tthis.constant = - point.dot( this.normal );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromCoplanarPoints: function () {\r\n\r\n\t\t\tvar v1 = new Vector3();\r\n\t\t\tvar v2 = new Vector3();\r\n\r\n\t\t\treturn function setFromCoplanarPoints( a, b, c ) {\r\n\r\n\t\t\t\tvar normal = v1.subVectors( c, b ).cross( v2.subVectors( a, b ) ).normalize();\r\n\r\n\t\t\t\t// Q: should an error be thrown if normal is zero (e.g. degenerate plane)?\r\n\r\n\t\t\t\tthis.setFromNormalAndCoplanarPoint( normal, a );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( plane ) {\r\n\r\n\t\t\tthis.normal.copy( plane.normal );\r\n\t\t\tthis.constant = plane.constant;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tnormalize: function () {\r\n\r\n\t\t\t// Note: will lead to a divide by zero if the plane is invalid.\r\n\r\n\t\t\tvar inverseNormalLength = 1.0 / this.normal.length();\r\n\t\t\tthis.normal.multiplyScalar( inverseNormalLength );\r\n\t\t\tthis.constant *= inverseNormalLength;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tnegate: function () {\r\n\r\n\t\t\tthis.constant *= - 1;\r\n\t\t\tthis.normal.negate();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tdistanceToPoint: function ( point ) {\r\n\r\n\t\t\treturn this.normal.dot( point ) + this.constant;\r\n\r\n\t\t},\r\n\r\n\t\tdistanceToSphere: function ( sphere ) {\r\n\r\n\t\t\treturn this.distanceToPoint( sphere.center ) - sphere.radius;\r\n\r\n\t\t},\r\n\r\n\t\tprojectPoint: function ( point, target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Plane: .projectPoint() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn target.copy( this.normal ).multiplyScalar( - this.distanceToPoint( point ) ).add( point );\r\n\r\n\t\t},\r\n\r\n\t\tintersectLine: function () {\r\n\r\n\t\t\tvar v1 = new Vector3();\r\n\r\n\t\t\treturn function intersectLine( line, target ) {\r\n\r\n\t\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.Plane: .intersectLine() target is now required' );\r\n\t\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar direction = line.delta( v1 );\r\n\r\n\t\t\t\tvar denominator = this.normal.dot( direction );\r\n\r\n\t\t\t\tif ( denominator === 0 ) {\r\n\r\n\t\t\t\t\t// line is coplanar, return origin\r\n\t\t\t\t\tif ( this.distanceToPoint( line.start ) === 0 ) {\r\n\r\n\t\t\t\t\t\treturn target.copy( line.start );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Unsure if this is the correct method to handle this case.\r\n\t\t\t\t\treturn undefined;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar t = - ( line.start.dot( this.normal ) + this.constant ) / denominator;\r\n\r\n\t\t\t\tif ( t < 0 || t > 1 ) {\r\n\r\n\t\t\t\t\treturn undefined;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn target.copy( direction ).multiplyScalar( t ).add( line.start );\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tintersectsLine: function ( line ) {\r\n\r\n\t\t\t// Note: this tests if a line intersects the plane, not whether it (or its end-points) are coplanar with it.\r\n\r\n\t\t\tvar startSign = this.distanceToPoint( line.start );\r\n\t\t\tvar endSign = this.distanceToPoint( line.end );\r\n\r\n\t\t\treturn ( startSign < 0 && endSign > 0 ) || ( endSign < 0 && startSign > 0 );\r\n\r\n\t\t},\r\n\r\n\t\tintersectsBox: function ( box ) {\r\n\r\n\t\t\treturn box.intersectsPlane( this );\r\n\r\n\t\t},\r\n\r\n\t\tintersectsSphere: function ( sphere ) {\r\n\r\n\t\t\treturn sphere.intersectsPlane( this );\r\n\r\n\t\t},\r\n\r\n\t\tcoplanarPoint: function ( target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Plane: .coplanarPoint() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn target.copy( this.normal ).multiplyScalar( - this.constant );\r\n\r\n\t\t},\r\n\r\n\t\tapplyMatrix4: function () {\r\n\r\n\t\t\tvar v1 = new Vector3();\r\n\t\t\tvar m1 = new Matrix3();\r\n\r\n\t\t\treturn function applyMatrix4( matrix, optionalNormalMatrix ) {\r\n\r\n\t\t\t\tvar normalMatrix = optionalNormalMatrix || m1.getNormalMatrix( matrix );\r\n\r\n\t\t\t\tvar referencePoint = this.coplanarPoint( v1 ).applyMatrix4( matrix );\r\n\r\n\t\t\t\tvar normal = this.normal.applyMatrix3( normalMatrix ).normalize();\r\n\r\n\t\t\t\tthis.constant = - referencePoint.dot( normal );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\ttranslate: function ( offset ) {\r\n\r\n\t\t\tthis.constant -= offset.dot( this.normal );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tequals: function ( plane ) {\r\n\r\n\t\t\treturn plane.normal.equals( this.normal ) && ( plane.constant === this.constant );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author bhouston / http://clara.io\r\n\t */\r\n\r\n\tfunction Frustum( p0, p1, p2, p3, p4, p5 ) {\r\n\r\n\t\tthis.planes = [\r\n\r\n\t\t\t( p0 !== undefined ) ? p0 : new Plane(),\r\n\t\t\t( p1 !== undefined ) ? p1 : new Plane(),\r\n\t\t\t( p2 !== undefined ) ? p2 : new Plane(),\r\n\t\t\t( p3 !== undefined ) ? p3 : new Plane(),\r\n\t\t\t( p4 !== undefined ) ? p4 : new Plane(),\r\n\t\t\t( p5 !== undefined ) ? p5 : new Plane()\r\n\r\n\t\t];\r\n\r\n\t}\r\n\r\n\tObject.assign( Frustum.prototype, {\r\n\r\n\t\tset: function ( p0, p1, p2, p3, p4, p5 ) {\r\n\r\n\t\t\tvar planes = this.planes;\r\n\r\n\t\t\tplanes[ 0 ].copy( p0 );\r\n\t\t\tplanes[ 1 ].copy( p1 );\r\n\t\t\tplanes[ 2 ].copy( p2 );\r\n\t\t\tplanes[ 3 ].copy( p3 );\r\n\t\t\tplanes[ 4 ].copy( p4 );\r\n\t\t\tplanes[ 5 ].copy( p5 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( frustum ) {\r\n\r\n\t\t\tvar planes = this.planes;\r\n\r\n\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\tplanes[ i ].copy( frustum.planes[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromMatrix: function ( m ) {\r\n\r\n\t\t\tvar planes = this.planes;\r\n\t\t\tvar me = m.elements;\r\n\t\t\tvar me0 = me[ 0 ], me1 = me[ 1 ], me2 = me[ 2 ], me3 = me[ 3 ];\r\n\t\t\tvar me4 = me[ 4 ], me5 = me[ 5 ], me6 = me[ 6 ], me7 = me[ 7 ];\r\n\t\t\tvar me8 = me[ 8 ], me9 = me[ 9 ], me10 = me[ 10 ], me11 = me[ 11 ];\r\n\t\t\tvar me12 = me[ 12 ], me13 = me[ 13 ], me14 = me[ 14 ], me15 = me[ 15 ];\r\n\r\n\t\t\tplanes[ 0 ].setComponents( me3 - me0, me7 - me4, me11 - me8, me15 - me12 ).normalize();\r\n\t\t\tplanes[ 1 ].setComponents( me3 + me0, me7 + me4, me11 + me8, me15 + me12 ).normalize();\r\n\t\t\tplanes[ 2 ].setComponents( me3 + me1, me7 + me5, me11 + me9, me15 + me13 ).normalize();\r\n\t\t\tplanes[ 3 ].setComponents( me3 - me1, me7 - me5, me11 - me9, me15 - me13 ).normalize();\r\n\t\t\tplanes[ 4 ].setComponents( me3 - me2, me7 - me6, me11 - me10, me15 - me14 ).normalize();\r\n\t\t\tplanes[ 5 ].setComponents( me3 + me2, me7 + me6, me11 + me10, me15 + me14 ).normalize();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tintersectsObject: function () {\r\n\r\n\t\t\tvar sphere = new Sphere();\r\n\r\n\t\t\treturn function intersectsObject( object ) {\r\n\r\n\t\t\t\tvar geometry = object.geometry;\r\n\r\n\t\t\t\tif ( geometry.boundingSphere === null )\r\n\t\t\t\t\tgeometry.computeBoundingSphere();\r\n\r\n\t\t\t\tsphere.copy( geometry.boundingSphere )\r\n\t\t\t\t\t.applyMatrix4( object.matrixWorld );\r\n\r\n\t\t\t\treturn this.intersectsSphere( sphere );\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tintersectsSprite: function () {\r\n\r\n\t\t\tvar sphere = new Sphere();\r\n\r\n\t\t\treturn function intersectsSprite( sprite ) {\r\n\r\n\t\t\t\tsphere.center.set( 0, 0, 0 );\r\n\t\t\t\tsphere.radius = 0.7071067811865476;\r\n\t\t\t\tsphere.applyMatrix4( sprite.matrixWorld );\r\n\r\n\t\t\t\treturn this.intersectsSphere( sphere );\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tintersectsSphere: function ( sphere ) {\r\n\r\n\t\t\tvar planes = this.planes;\r\n\t\t\tvar center = sphere.center;\r\n\t\t\tvar negRadius = - sphere.radius;\r\n\r\n\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\tvar distance = planes[ i ].distanceToPoint( center );\r\n\r\n\t\t\t\tif ( distance < negRadius ) {\r\n\r\n\t\t\t\t\treturn false;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t},\r\n\r\n\t\tintersectsBox: function () {\r\n\r\n\t\t\tvar p = new Vector3();\r\n\r\n\t\t\treturn function intersectsBox( box ) {\r\n\r\n\t\t\t\tvar planes = this.planes;\r\n\r\n\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\t\tvar plane = planes[ i ];\r\n\r\n\t\t\t\t\t// corner at max distance\r\n\r\n\t\t\t\t\tp.x = plane.normal.x > 0 ? box.max.x : box.min.x;\r\n\t\t\t\t\tp.y = plane.normal.y > 0 ? box.max.y : box.min.y;\r\n\t\t\t\t\tp.z = plane.normal.z > 0 ? box.max.z : box.min.z;\r\n\r\n\t\t\t\t\tif ( plane.distanceToPoint( p ) < 0 ) {\r\n\r\n\t\t\t\t\t\treturn false;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn true;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tcontainsPoint: function ( point ) {\r\n\r\n\t\t\tvar planes = this.planes;\r\n\r\n\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\tif ( planes[ i ].distanceToPoint( point ) < 0 ) {\r\n\r\n\t\t\t\t\treturn false;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tvar alphamap_fragment = \"#ifdef USE_ALPHAMAP\\n\\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\\n#endif\\n\";\r\n\r\n\tvar alphamap_pars_fragment = \"#ifdef USE_ALPHAMAP\\n\\tuniform sampler2D alphaMap;\\n#endif\\n\";\r\n\r\n\tvar alphatest_fragment = \"#ifdef ALPHATEST\\n\\tif ( diffuseColor.a < ALPHATEST ) discard;\\n#endif\\n\";\r\n\r\n\tvar aomap_fragment = \"#ifdef USE_AOMAP\\n\\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\\n\\treflectedLight.indirectDiffuse *= ambientOcclusion;\\n\\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\\n\\t\\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\\n\\t\\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\\n\\t#endif\\n#endif\\n\";\r\n\r\n\tvar aomap_pars_fragment = \"#ifdef USE_AOMAP\\n\\tuniform sampler2D aoMap;\\n\\tuniform float aoMapIntensity;\\n#endif\";\r\n\r\n\tvar begin_vertex = \"\\nvec3 transformed = vec3( position );\\n\";\r\n\r\n\tvar beginnormal_vertex = \"\\nvec3 objectNormal = vec3( normal );\\n\";\r\n\r\n\tvar bsdfs = \"float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\\n\\tif( decayExponent > 0.0 ) {\\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\\n\\t\\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\\n\\t\\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\\n\\t\\treturn distanceFalloff * maxDistanceCutoffFactor;\\n#else\\n\\t\\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\\n#endif\\n\\t}\\n\\treturn 1.0;\\n}\\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\\n\\treturn RECIPROCAL_PI * diffuseColor;\\n}\\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\\n\\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\\n\\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\\n}\\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\\n\\tfloat a2 = pow2( alpha );\\n\\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\\n\\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\\n\\treturn 1.0 / ( gl * gv );\\n}\\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\\n\\tfloat a2 = pow2( alpha );\\n\\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\\n\\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\\n\\treturn 0.5 / max( gv + gl, EPSILON );\\n}\\nfloat D_GGX( const in float alpha, const in float dotNH ) {\\n\\tfloat a2 = pow2( alpha );\\n\\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\\n\\treturn RECIPROCAL_PI * a2 / pow2( denom );\\n}\\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\\n\\tfloat alpha = pow2( roughness );\\n\\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\\n\\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\\n\\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\\n\\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\\n\\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\\n\\tvec3 F = F_Schlick( specularColor, dotLH );\\n\\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\\n\\tfloat D = D_GGX( alpha, dotNH );\\n\\treturn F * ( G * D );\\n}\\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\\n\\tconst float LUT_SIZE  = 64.0;\\n\\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\\n\\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\\n\\tfloat dotNV = saturate( dot( N, V ) );\\n\\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\\n\\tuv = uv * LUT_SCALE + LUT_BIAS;\\n\\treturn uv;\\n}\\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\\n\\tfloat l = length( f );\\n\\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\\n}\\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\\n\\tfloat x = dot( v1, v2 );\\n\\tfloat y = abs( x );\\n\\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\\n\\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\\n\\tfloat v = a / b;\\n\\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\\n\\treturn cross( v1, v2 ) * theta_sintheta;\\n}\\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\\n\\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\\n\\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\\n\\tvec3 lightNormal = cross( v1, v2 );\\n\\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\\n\\tvec3 T1, T2;\\n\\tT1 = normalize( V - N * dot( V, N ) );\\n\\tT2 = - cross( N, T1 );\\n\\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\\n\\tvec3 coords[ 4 ];\\n\\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\\n\\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\\n\\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\\n\\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\\n\\tcoords[ 0 ] = normalize( coords[ 0 ] );\\n\\tcoords[ 1 ] = normalize( coords[ 1 ] );\\n\\tcoords[ 2 ] = normalize( coords[ 2 ] );\\n\\tcoords[ 3 ] = normalize( coords[ 3 ] );\\n\\tvec3 vectorFormFactor = vec3( 0.0 );\\n\\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\\n\\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\\n\\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\\n\\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\\n\\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\\n\\treturn vec3( result );\\n}\\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\\n\\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\\n\\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\\n\\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\\n\\tvec4 r = roughness * c0 + c1;\\n\\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\\n\\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\\n\\treturn specularColor * AB.x + AB.y;\\n}\\nfloat G_BlinnPhong_Implicit( ) {\\n\\treturn 0.25;\\n}\\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\\n\\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\\n}\\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\\n\\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\\n\\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\\n\\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\\n\\tvec3 F = F_Schlick( specularColor, dotLH );\\n\\tfloat G = G_BlinnPhong_Implicit( );\\n\\tfloat D = D_BlinnPhong( shininess, dotNH );\\n\\treturn F * ( G * D );\\n}\\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\\n\\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\\n}\\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\\n\\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\\n}\\n\";\r\n\r\n\tvar bumpmap_pars_fragment = \"#ifdef USE_BUMPMAP\\n\\tuniform sampler2D bumpMap;\\n\\tuniform float bumpScale;\\n\\tvec2 dHdxy_fwd() {\\n\\t\\tvec2 dSTdx = dFdx( vUv );\\n\\t\\tvec2 dSTdy = dFdy( vUv );\\n\\t\\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\\n\\t\\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\\n\\t\\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\\n\\t\\treturn vec2( dBx, dBy );\\n\\t}\\n\\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\\n\\t\\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\\n\\t\\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\\n\\t\\tvec3 vN = surf_norm;\\n\\t\\tvec3 R1 = cross( vSigmaY, vN );\\n\\t\\tvec3 R2 = cross( vN, vSigmaX );\\n\\t\\tfloat fDet = dot( vSigmaX, R1 );\\n\\t\\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\\n\\t\\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\\n\\t\\treturn normalize( abs( fDet ) * surf_norm - vGrad );\\n\\t}\\n#endif\\n\";\r\n\r\n\tvar clipping_planes_fragment = \"#if NUM_CLIPPING_PLANES > 0\\n\\tvec4 plane;\\n\\t#pragma unroll_loop\\n\\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\\n\\t\\tplane = clippingPlanes[ i ];\\n\\t\\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\\n\\t}\\n\\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\\n\\t\\tbool clipped = true;\\n\\t\\t#pragma unroll_loop\\n\\t\\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\\n\\t\\t\\tplane = clippingPlanes[ i ];\\n\\t\\t\\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\\n\\t\\t}\\n\\t\\tif ( clipped ) discard;\\n\\t#endif\\n#endif\\n\";\r\n\r\n\tvar clipping_planes_pars_fragment = \"#if NUM_CLIPPING_PLANES > 0\\n\\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\\n\\t\\tvarying vec3 vViewPosition;\\n\\t#endif\\n\\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\\n#endif\\n\";\r\n\r\n\tvar clipping_planes_pars_vertex = \"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\\n\\tvarying vec3 vViewPosition;\\n#endif\\n\";\r\n\r\n\tvar clipping_planes_vertex = \"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\\n\\tvViewPosition = - mvPosition.xyz;\\n#endif\\n\";\r\n\r\n\tvar color_fragment = \"#ifdef USE_COLOR\\n\\tdiffuseColor.rgb *= vColor;\\n#endif\";\r\n\r\n\tvar color_pars_fragment = \"#ifdef USE_COLOR\\n\\tvarying vec3 vColor;\\n#endif\\n\";\r\n\r\n\tvar color_pars_vertex = \"#ifdef USE_COLOR\\n\\tvarying vec3 vColor;\\n#endif\";\r\n\r\n\tvar color_vertex = \"#ifdef USE_COLOR\\n\\tvColor.xyz = color.xyz;\\n#endif\";\r\n\r\n\tvar common = \"#define PI 3.14159265359\\n#define PI2 6.28318530718\\n#define PI_HALF 1.5707963267949\\n#define RECIPROCAL_PI 0.31830988618\\n#define RECIPROCAL_PI2 0.15915494\\n#define LOG2 1.442695\\n#define EPSILON 1e-6\\n#define saturate(a) clamp( a, 0.0, 1.0 )\\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\\nfloat pow2( const in float x ) { return x*x; }\\nfloat pow3( const in float x ) { return x*x*x; }\\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\\nhighp float rand( const in vec2 uv ) {\\n\\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\\n\\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\\n\\treturn fract(sin(sn) * c);\\n}\\nstruct IncidentLight {\\n\\tvec3 color;\\n\\tvec3 direction;\\n\\tbool visible;\\n};\\nstruct ReflectedLight {\\n\\tvec3 directDiffuse;\\n\\tvec3 directSpecular;\\n\\tvec3 indirectDiffuse;\\n\\tvec3 indirectSpecular;\\n};\\nstruct GeometricContext {\\n\\tvec3 position;\\n\\tvec3 normal;\\n\\tvec3 viewDir;\\n};\\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\\n\\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\\n}\\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\\n\\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\\n}\\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\\tfloat distance = dot( planeNormal, point - pointOnPlane );\\n\\treturn - distance * planeNormal + point;\\n}\\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\\treturn sign( dot( point - pointOnPlane, planeNormal ) );\\n}\\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\\n}\\nmat3 transposeMat3( const in mat3 m ) {\\n\\tmat3 tmp;\\n\\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\\n\\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\\n\\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\\n\\treturn tmp;\\n}\\nfloat linearToRelativeLuminance( const in vec3 color ) {\\n\\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\\n\\treturn dot( weights, color.rgb );\\n}\\n\";\r\n\r\n\tvar cube_uv_reflection_fragment = \"#ifdef ENVMAP_TYPE_CUBE_UV\\n#define cubeUV_textureSize (1024.0)\\nint getFaceFromDirection(vec3 direction) {\\n\\tvec3 absDirection = abs(direction);\\n\\tint face = -1;\\n\\tif( absDirection.x > absDirection.z ) {\\n\\t\\tif(absDirection.x > absDirection.y )\\n\\t\\t\\tface = direction.x > 0.0 ? 0 : 3;\\n\\t\\telse\\n\\t\\t\\tface = direction.y > 0.0 ? 1 : 4;\\n\\t}\\n\\telse {\\n\\t\\tif(absDirection.z > absDirection.y )\\n\\t\\t\\tface = direction.z > 0.0 ? 2 : 5;\\n\\t\\telse\\n\\t\\t\\tface = direction.y > 0.0 ? 1 : 4;\\n\\t}\\n\\treturn face;\\n}\\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\\n\\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\\n\\tfloat dxRoughness = dFdx(roughness);\\n\\tfloat dyRoughness = dFdy(roughness);\\n\\tvec3 dx = dFdx( vec * scale * dxRoughness );\\n\\tvec3 dy = dFdy( vec * scale * dyRoughness );\\n\\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\\n\\td = clamp(d, 1.0, cubeUV_rangeClamp);\\n\\tfloat mipLevel = 0.5 * log2(d);\\n\\treturn vec2(floor(mipLevel), fract(mipLevel));\\n}\\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\\n\\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\\n\\tfloat a = 16.0 * cubeUV_rcpTextureSize;\\n\\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\\n\\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\\n\\tfloat powScale = exp2_packed.x * exp2_packed.y;\\n\\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\\n\\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\\n\\tbool bRes = mipLevel == 0.0;\\n\\tscale =  bRes && (scale < a) ? a : scale;\\n\\tvec3 r;\\n\\tvec2 offset;\\n\\tint face = getFaceFromDirection(direction);\\n\\tfloat rcpPowScale = 1.0 / powScale;\\n\\tif( face == 0) {\\n\\t\\tr = vec3(direction.x, -direction.z, direction.y);\\n\\t\\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\\n\\t\\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\\n\\t}\\n\\telse if( face == 1) {\\n\\t\\tr = vec3(direction.y, direction.x, direction.z);\\n\\t\\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\\n\\t\\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\\n\\t}\\n\\telse if( face == 2) {\\n\\t\\tr = vec3(direction.z, direction.x, direction.y);\\n\\t\\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\\n\\t\\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\\n\\t}\\n\\telse if( face == 3) {\\n\\t\\tr = vec3(direction.x, direction.z, direction.y);\\n\\t\\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\\n\\t\\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\\n\\t}\\n\\telse if( face == 4) {\\n\\t\\tr = vec3(direction.y, direction.x, -direction.z);\\n\\t\\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\\n\\t\\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\\n\\t}\\n\\telse {\\n\\t\\tr = vec3(direction.z, -direction.x, direction.y);\\n\\t\\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\\n\\t\\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\\n\\t}\\n\\tr = normalize(r);\\n\\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\\n\\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\\n\\tvec2 base = offset + vec2( texelOffset );\\n\\treturn base + s * ( scale - 2.0 * texelOffset );\\n}\\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\\nvec4 textureCubeUV( sampler2D envMap, vec3 reflectedDirection, float roughness ) {\\n\\tfloat roughnessVal = roughness* cubeUV_maxLods3;\\n\\tfloat r1 = floor(roughnessVal);\\n\\tfloat r2 = r1 + 1.0;\\n\\tfloat t = fract(roughnessVal);\\n\\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\\n\\tfloat s = mipInfo.y;\\n\\tfloat level0 = mipInfo.x;\\n\\tfloat level1 = level0 + 1.0;\\n\\tlevel1 = level1 > 5.0 ? 5.0 : level1;\\n\\tlevel0 += min( floor( s + 0.5 ), 5.0 );\\n\\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\\n\\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\\n\\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\\n\\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\\n\\tvec4 result = mix(color10, color20, t);\\n\\treturn vec4(result.rgb, 1.0);\\n}\\n#endif\\n\";\r\n\r\n\tvar defaultnormal_vertex = \"vec3 transformedNormal = normalMatrix * objectNormal;\\n#ifdef FLIP_SIDED\\n\\ttransformedNormal = - transformedNormal;\\n#endif\\n\";\r\n\r\n\tvar displacementmap_pars_vertex = \"#ifdef USE_DISPLACEMENTMAP\\n\\tuniform sampler2D displacementMap;\\n\\tuniform float displacementScale;\\n\\tuniform float displacementBias;\\n#endif\\n\";\r\n\r\n\tvar displacementmap_vertex = \"#ifdef USE_DISPLACEMENTMAP\\n\\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\\n#endif\\n\";\r\n\r\n\tvar emissivemap_fragment = \"#ifdef USE_EMISSIVEMAP\\n\\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\\n\\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\\n\\ttotalEmissiveRadiance *= emissiveColor.rgb;\\n#endif\\n\";\r\n\r\n\tvar emissivemap_pars_fragment = \"#ifdef USE_EMISSIVEMAP\\n\\tuniform sampler2D emissiveMap;\\n#endif\\n\";\r\n\r\n\tvar encodings_fragment = \"  gl_FragColor = linearToOutputTexel( gl_FragColor );\\n\";\r\n\r\n\tvar encodings_pars_fragment = \"\\nvec4 LinearToLinear( in vec4 value ) {\\n\\treturn value;\\n}\\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\\n\\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\\n}\\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\\n\\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\\n}\\nvec4 sRGBToLinear( in vec4 value ) {\\n\\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\\n}\\nvec4 LinearTosRGB( in vec4 value ) {\\n\\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\\n}\\nvec4 RGBEToLinear( in vec4 value ) {\\n\\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\\n}\\nvec4 LinearToRGBE( in vec4 value ) {\\n\\tfloat maxComponent = max( max( value.r, value.g ), value.b );\\n\\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\\n\\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\\n}\\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\\n\\treturn vec4( value.xyz * value.w * maxRange, 1.0 );\\n}\\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\\n\\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\\n\\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\\n\\tM            = ceil( M * 255.0 ) / 255.0;\\n\\treturn vec4( value.rgb / ( M * maxRange ), M );\\n}\\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\\n\\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\\n}\\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\\n\\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\\n\\tfloat D      = max( maxRange / maxRGB, 1.0 );\\n\\tD            = min( floor( D ) / 255.0, 1.0 );\\n\\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\\n}\\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\\nvec4 LinearToLogLuv( in vec4 value )  {\\n\\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\\n\\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\\n\\tvec4 vResult;\\n\\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\\n\\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\\n\\tvResult.w = fract(Le);\\n\\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\\n\\treturn vResult;\\n}\\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\\nvec4 LogLuvToLinear( in vec4 value ) {\\n\\tfloat Le = value.z * 255.0 + value.w;\\n\\tvec3 Xp_Y_XYZp;\\n\\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\\n\\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\\n\\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\\n\\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\\n\\treturn vec4( max(vRGB, 0.0), 1.0 );\\n}\\n\";\r\n\r\n\tvar envmap_fragment = \"#ifdef USE_ENVMAP\\n\\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\\n\\t\\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\\n\\t\\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\\n\\t\\t#ifdef ENVMAP_MODE_REFLECTION\\n\\t\\t\\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\\n\\t\\t#else\\n\\t\\t\\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\\n\\t\\t#endif\\n\\t#else\\n\\t\\tvec3 reflectVec = vReflect;\\n\\t#endif\\n\\t#ifdef ENVMAP_TYPE_CUBE\\n\\t\\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\\n\\t#elif defined( ENVMAP_TYPE_EQUIREC )\\n\\t\\tvec2 sampleUV;\\n\\t\\treflectVec = normalize( reflectVec );\\n\\t\\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\\n\\t\\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\\n\\t\\tvec4 envColor = texture2D( envMap, sampleUV );\\n\\t#elif defined( ENVMAP_TYPE_SPHERE )\\n\\t\\treflectVec = normalize( reflectVec );\\n\\t\\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\\n\\t\\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\\n\\t#else\\n\\t\\tvec4 envColor = vec4( 0.0 );\\n\\t#endif\\n\\tenvColor = envMapTexelToLinear( envColor );\\n\\t#ifdef ENVMAP_BLENDING_MULTIPLY\\n\\t\\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\\n\\t#elif defined( ENVMAP_BLENDING_MIX )\\n\\t\\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\\n\\t#elif defined( ENVMAP_BLENDING_ADD )\\n\\t\\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\\n\\t#endif\\n#endif\\n\";\r\n\r\n\tvar envmap_pars_fragment = \"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\\n\\tuniform float reflectivity;\\n\\tuniform float envMapIntensity;\\n#endif\\n#ifdef USE_ENVMAP\\n\\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\\n\\t\\tvarying vec3 vWorldPosition;\\n\\t#endif\\n\\t#ifdef ENVMAP_TYPE_CUBE\\n\\t\\tuniform samplerCube envMap;\\n\\t#else\\n\\t\\tuniform sampler2D envMap;\\n\\t#endif\\n\\tuniform float flipEnvMap;\\n\\tuniform int maxMipLevel;\\n\\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\\n\\t\\tuniform float refractionRatio;\\n\\t#else\\n\\t\\tvarying vec3 vReflect;\\n\\t#endif\\n#endif\\n\";\r\n\r\n\tvar envmap_pars_vertex = \"#ifdef USE_ENVMAP\\n\\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\\n\\t\\tvarying vec3 vWorldPosition;\\n\\t#else\\n\\t\\tvarying vec3 vReflect;\\n\\t\\tuniform float refractionRatio;\\n\\t#endif\\n#endif\\n\";\r\n\r\n\tvar envmap_vertex = \"#ifdef USE_ENVMAP\\n\\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\\n\\t\\tvWorldPosition = worldPosition.xyz;\\n\\t#else\\n\\t\\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\\n\\t\\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\\n\\t\\t#ifdef ENVMAP_MODE_REFLECTION\\n\\t\\t\\tvReflect = reflect( cameraToVertex, worldNormal );\\n\\t\\t#else\\n\\t\\t\\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\\n\\t\\t#endif\\n\\t#endif\\n#endif\\n\";\r\n\r\n\tvar fog_vertex = \"#ifdef USE_FOG\\n\\tvFogPosition = mvPosition.xyz;\\n#endif\\n\";\r\n\r\n\tvar fog_pars_vertex = \"#ifdef USE_FOG\\n\\tvarying vec3 vFogPosition;\\n#endif\\n\";\r\n\r\n\tvar fog_fragment = \"#ifdef USE_FOG\\n\\tfloat fogDepth = length( vFogPosition );\\n\\t#ifdef FOG_EXP2\\n\\t\\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\\n\\t#else\\n\\t\\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\\n\\t#endif\\n\\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\\n#endif\\n\";\r\n\r\n\tvar fog_pars_fragment = \"#ifdef USE_FOG\\n\\tuniform vec3 fogColor;\\n\\tvarying vec3 vFogPosition;\\n\\t#ifdef FOG_EXP2\\n\\t\\tuniform float fogDensity;\\n\\t#else\\n\\t\\tuniform float fogNear;\\n\\t\\tuniform float fogFar;\\n\\t#endif\\n#endif\\n\";\r\n\r\n\tvar gradientmap_pars_fragment = \"#ifdef TOON\\n\\tuniform sampler2D gradientMap;\\n\\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\\n\\t\\tfloat dotNL = dot( normal, lightDirection );\\n\\t\\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\\n\\t\\t#ifdef USE_GRADIENTMAP\\n\\t\\t\\treturn texture2D( gradientMap, coord ).rgb;\\n\\t\\t#else\\n\\t\\t\\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\\n\\t\\t#endif\\n\\t}\\n#endif\\n\";\r\n\r\n\tvar lightmap_fragment = \"#ifdef USE_LIGHTMAP\\n\\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\\n#endif\\n\";\r\n\r\n\tvar lightmap_pars_fragment = \"#ifdef USE_LIGHTMAP\\n\\tuniform sampler2D lightMap;\\n\\tuniform float lightMapIntensity;\\n#endif\";\r\n\r\n\tvar lights_lambert_vertex = \"vec3 diffuse = vec3( 1.0 );\\nGeometricContext geometry;\\ngeometry.position = mvPosition.xyz;\\ngeometry.normal = normalize( transformedNormal );\\ngeometry.viewDir = normalize( -mvPosition.xyz );\\nGeometricContext backGeometry;\\nbackGeometry.position = geometry.position;\\nbackGeometry.normal = -geometry.normal;\\nbackGeometry.viewDir = geometry.viewDir;\\nvLightFront = vec3( 0.0 );\\n#ifdef DOUBLE_SIDED\\n\\tvLightBack = vec3( 0.0 );\\n#endif\\nIncidentLight directLight;\\nfloat dotNL;\\nvec3 directLightColor_Diffuse;\\n#if NUM_POINT_LIGHTS > 0\\n\\t#pragma unroll_loop\\n\\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\\n\\t\\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\\n\\t\\tdotNL = dot( geometry.normal, directLight.direction );\\n\\t\\tdirectLightColor_Diffuse = PI * directLight.color;\\n\\t\\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\\n\\t\\t#ifdef DOUBLE_SIDED\\n\\t\\t\\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\\n\\t\\t#endif\\n\\t}\\n#endif\\n#if NUM_SPOT_LIGHTS > 0\\n\\t#pragma unroll_loop\\n\\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\\n\\t\\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\\n\\t\\tdotNL = dot( geometry.normal, directLight.direction );\\n\\t\\tdirectLightColor_Diffuse = PI * directLight.color;\\n\\t\\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\\n\\t\\t#ifdef DOUBLE_SIDED\\n\\t\\t\\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\\n\\t\\t#endif\\n\\t}\\n#endif\\n#if NUM_DIR_LIGHTS > 0\\n\\t#pragma unroll_loop\\n\\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\\n\\t\\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\\n\\t\\tdotNL = dot( geometry.normal, directLight.direction );\\n\\t\\tdirectLightColor_Diffuse = PI * directLight.color;\\n\\t\\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\\n\\t\\t#ifdef DOUBLE_SIDED\\n\\t\\t\\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\\n\\t\\t#endif\\n\\t}\\n#endif\\n#if NUM_HEMI_LIGHTS > 0\\n\\t#pragma unroll_loop\\n\\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\\n\\t\\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\\n\\t\\t#ifdef DOUBLE_SIDED\\n\\t\\t\\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\\n\\t\\t#endif\\n\\t}\\n#endif\\n\";\r\n\r\n\tvar lights_pars_begin = \"uniform vec3 ambientLightColor;\\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\\n\\tvec3 irradiance = ambientLightColor;\\n\\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\n\\t\\tirradiance *= PI;\\n\\t#endif\\n\\treturn irradiance;\\n}\\n#if NUM_DIR_LIGHTS > 0\\n\\tstruct DirectionalLight {\\n\\t\\tvec3 direction;\\n\\t\\tvec3 color;\\n\\t\\tint shadow;\\n\\t\\tfloat shadowBias;\\n\\t\\tfloat shadowRadius;\\n\\t\\tvec2 shadowMapSize;\\n\\t};\\n\\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\\n\\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\\n\\t\\tdirectLight.color = directionalLight.color;\\n\\t\\tdirectLight.direction = directionalLight.direction;\\n\\t\\tdirectLight.visible = true;\\n\\t}\\n#endif\\n#if NUM_POINT_LIGHTS > 0\\n\\tstruct PointLight {\\n\\t\\tvec3 position;\\n\\t\\tvec3 color;\\n\\t\\tfloat distance;\\n\\t\\tfloat decay;\\n\\t\\tint shadow;\\n\\t\\tfloat shadowBias;\\n\\t\\tfloat shadowRadius;\\n\\t\\tvec2 shadowMapSize;\\n\\t\\tfloat shadowCameraNear;\\n\\t\\tfloat shadowCameraFar;\\n\\t};\\n\\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\\n\\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\\n\\t\\tvec3 lVector = pointLight.position - geometry.position;\\n\\t\\tdirectLight.direction = normalize( lVector );\\n\\t\\tfloat lightDistance = length( lVector );\\n\\t\\tdirectLight.color = pointLight.color;\\n\\t\\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\\n\\t\\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\\n\\t}\\n#endif\\n#if NUM_SPOT_LIGHTS > 0\\n\\tstruct SpotLight {\\n\\t\\tvec3 position;\\n\\t\\tvec3 direction;\\n\\t\\tvec3 color;\\n\\t\\tfloat distance;\\n\\t\\tfloat decay;\\n\\t\\tfloat coneCos;\\n\\t\\tfloat penumbraCos;\\n\\t\\tint shadow;\\n\\t\\tfloat shadowBias;\\n\\t\\tfloat shadowRadius;\\n\\t\\tvec2 shadowMapSize;\\n\\t};\\n\\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\\n\\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\\n\\t\\tvec3 lVector = spotLight.position - geometry.position;\\n\\t\\tdirectLight.direction = normalize( lVector );\\n\\t\\tfloat lightDistance = length( lVector );\\n\\t\\tfloat angleCos = dot( directLight.direction, spotLight.direction );\\n\\t\\tif ( angleCos > spotLight.coneCos ) {\\n\\t\\t\\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\\n\\t\\t\\tdirectLight.color = spotLight.color;\\n\\t\\t\\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\\n\\t\\t\\tdirectLight.visible = true;\\n\\t\\t} else {\\n\\t\\t\\tdirectLight.color = vec3( 0.0 );\\n\\t\\t\\tdirectLight.visible = false;\\n\\t\\t}\\n\\t}\\n#endif\\n#if NUM_RECT_AREA_LIGHTS > 0\\n\\tstruct RectAreaLight {\\n\\t\\tvec3 color;\\n\\t\\tvec3 position;\\n\\t\\tvec3 halfWidth;\\n\\t\\tvec3 halfHeight;\\n\\t};\\n\\tuniform sampler2D ltc_1;\\tuniform sampler2D ltc_2;\\n\\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\\n#endif\\n#if NUM_HEMI_LIGHTS > 0\\n\\tstruct HemisphereLight {\\n\\t\\tvec3 direction;\\n\\t\\tvec3 skyColor;\\n\\t\\tvec3 groundColor;\\n\\t};\\n\\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\\n\\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\\n\\t\\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\\n\\t\\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\\n\\t\\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\\n\\t\\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\n\\t\\t\\tirradiance *= PI;\\n\\t\\t#endif\\n\\t\\treturn irradiance;\\n\\t}\\n#endif\\n\";\r\n\r\n\tvar envmap_physical_pars_fragment = \"#if defined( USE_ENVMAP ) && defined( PHYSICAL )\\n\\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\\n\\t\\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\\n\\t\\t#ifdef ENVMAP_TYPE_CUBE\\n\\t\\t\\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\\n\\t\\t\\t#ifdef TEXTURE_LOD_EXT\\n\\t\\t\\t\\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\\n\\t\\t\\t#else\\n\\t\\t\\t\\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\\n\\t\\t\\t#endif\\n\\t\\t\\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\\n\\t\\t#elif defined( ENVMAP_TYPE_CUBE_UV )\\n\\t\\t\\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\\n\\t\\t\\tvec4 envMapColor = textureCubeUV( envMap, queryVec, 1.0 );\\n\\t\\t#else\\n\\t\\t\\tvec4 envMapColor = vec4( 0.0 );\\n\\t\\t#endif\\n\\t\\treturn PI * envMapColor.rgb * envMapIntensity;\\n\\t}\\n\\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\\n\\t\\tfloat maxMIPLevelScalar = float( maxMIPLevel );\\n\\t\\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\\n\\t\\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\\n\\t}\\n\\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\\n\\t\\t#ifdef ENVMAP_MODE_REFLECTION\\n\\t\\t\\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\\n\\t\\t#else\\n\\t\\t\\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\\n\\t\\t#endif\\n\\t\\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\\n\\t\\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\\n\\t\\t#ifdef ENVMAP_TYPE_CUBE\\n\\t\\t\\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\\n\\t\\t\\t#ifdef TEXTURE_LOD_EXT\\n\\t\\t\\t\\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\\n\\t\\t\\t#else\\n\\t\\t\\t\\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\\n\\t\\t\\t#endif\\n\\t\\t\\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\\n\\t\\t#elif defined( ENVMAP_TYPE_CUBE_UV )\\n\\t\\t\\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\\n\\t\\t\\tvec4 envMapColor = textureCubeUV( envMap, queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent ));\\n\\t\\t#elif defined( ENVMAP_TYPE_EQUIREC )\\n\\t\\t\\tvec2 sampleUV;\\n\\t\\t\\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\\n\\t\\t\\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\\n\\t\\t\\t#ifdef TEXTURE_LOD_EXT\\n\\t\\t\\t\\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\\n\\t\\t\\t#else\\n\\t\\t\\t\\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\\n\\t\\t\\t#endif\\n\\t\\t\\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\\n\\t\\t#elif defined( ENVMAP_TYPE_SPHERE )\\n\\t\\t\\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\\n\\t\\t\\t#ifdef TEXTURE_LOD_EXT\\n\\t\\t\\t\\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\\n\\t\\t\\t#else\\n\\t\\t\\t\\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\\n\\t\\t\\t#endif\\n\\t\\t\\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\\n\\t\\t#endif\\n\\t\\treturn envMapColor.rgb * envMapIntensity;\\n\\t}\\n#endif\\n\";\r\n\r\n\tvar lights_phong_fragment = \"BlinnPhongMaterial material;\\nmaterial.diffuseColor = diffuseColor.rgb;\\nmaterial.specularColor = specular;\\nmaterial.specularShininess = shininess;\\nmaterial.specularStrength = specularStrength;\\n\";\r\n\r\n\tvar lights_phong_pars_fragment = \"varying vec3 vViewPosition;\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n#endif\\nstruct BlinnPhongMaterial {\\n\\tvec3\\tdiffuseColor;\\n\\tvec3\\tspecularColor;\\n\\tfloat\\tspecularShininess;\\n\\tfloat\\tspecularStrength;\\n};\\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\\n\\t#ifdef TOON\\n\\t\\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\\n\\t#else\\n\\t\\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\\n\\t\\tvec3 irradiance = dotNL * directLight.color;\\n\\t#endif\\n\\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\n\\t\\tirradiance *= PI;\\n\\t#endif\\n\\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\\n\\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\\n}\\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\\n\\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\\n}\\n#define RE_Direct\\t\\t\\t\\tRE_Direct_BlinnPhong\\n#define RE_IndirectDiffuse\\t\\tRE_IndirectDiffuse_BlinnPhong\\n#define Material_LightProbeLOD( material )\\t(0)\\n\";\r\n\r\n\tvar lights_physical_fragment = \"PhysicalMaterial material;\\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\\n#ifdef STANDARD\\n\\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\\n#else\\n\\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\\n\\tmaterial.clearCoat = saturate( clearCoat );\\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\\n#endif\\n\";\r\n\r\n\tvar lights_physical_pars_fragment = \"struct PhysicalMaterial {\\n\\tvec3\\tdiffuseColor;\\n\\tfloat\\tspecularRoughness;\\n\\tvec3\\tspecularColor;\\n\\t#ifndef STANDARD\\n\\t\\tfloat clearCoat;\\n\\t\\tfloat clearCoatRoughness;\\n\\t#endif\\n};\\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\\n\\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\\n}\\n#if NUM_RECT_AREA_LIGHTS > 0\\n\\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\\n\\t\\tvec3 normal = geometry.normal;\\n\\t\\tvec3 viewDir = geometry.viewDir;\\n\\t\\tvec3 position = geometry.position;\\n\\t\\tvec3 lightPos = rectAreaLight.position;\\n\\t\\tvec3 halfWidth = rectAreaLight.halfWidth;\\n\\t\\tvec3 halfHeight = rectAreaLight.halfHeight;\\n\\t\\tvec3 lightColor = rectAreaLight.color;\\n\\t\\tfloat roughness = material.specularRoughness;\\n\\t\\tvec3 rectCoords[ 4 ];\\n\\t\\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\\t\\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\\n\\t\\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\\n\\t\\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\\n\\t\\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\\n\\t\\tvec4 t1 = texture2D( ltc_1, uv );\\n\\t\\tvec4 t2 = texture2D( ltc_2, uv );\\n\\t\\tmat3 mInv = mat3(\\n\\t\\t\\tvec3( t1.x, 0, t1.y ),\\n\\t\\t\\tvec3(    0, 1,    0 ),\\n\\t\\t\\tvec3( t1.z, 0, t1.w )\\n\\t\\t);\\n\\t\\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\\n\\t\\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\\n\\t\\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\\n\\t}\\n#endif\\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\\n\\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\\n\\tvec3 irradiance = dotNL * directLight.color;\\n\\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\n\\t\\tirradiance *= PI;\\n\\t#endif\\n\\t#ifndef STANDARD\\n\\t\\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\\n\\t#else\\n\\t\\tfloat clearCoatDHR = 0.0;\\n\\t#endif\\n\\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\\n\\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\\n\\t#ifndef STANDARD\\n\\t\\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\\n\\t#endif\\n}\\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\\n\\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\\n}\\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\\n\\t#ifndef STANDARD\\n\\t\\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\\n\\t\\tfloat dotNL = dotNV;\\n\\t\\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\\n\\t#else\\n\\t\\tfloat clearCoatDHR = 0.0;\\n\\t#endif\\n\\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\\n\\t#ifndef STANDARD\\n\\t\\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\\n\\t#endif\\n}\\n#define RE_Direct\\t\\t\\t\\tRE_Direct_Physical\\n#define RE_Direct_RectArea\\t\\tRE_Direct_RectArea_Physical\\n#define RE_IndirectDiffuse\\t\\tRE_IndirectDiffuse_Physical\\n#define RE_IndirectSpecular\\t\\tRE_IndirectSpecular_Physical\\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\\n\\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\\n}\\n\";\r\n\r\n\tvar lights_fragment_begin = \"\\nGeometricContext geometry;\\ngeometry.position = - vViewPosition;\\ngeometry.normal = normal;\\ngeometry.viewDir = normalize( vViewPosition );\\nIncidentLight directLight;\\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\\n\\tPointLight pointLight;\\n\\t#pragma unroll_loop\\n\\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\\n\\t\\tpointLight = pointLights[ i ];\\n\\t\\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\\n\\t\\t#ifdef USE_SHADOWMAP\\n\\t\\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\\n\\t\\t#endif\\n\\t\\tRE_Direct( directLight, geometry, material, reflectedLight );\\n\\t}\\n#endif\\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\\n\\tSpotLight spotLight;\\n\\t#pragma unroll_loop\\n\\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\\n\\t\\tspotLight = spotLights[ i ];\\n\\t\\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\\n\\t\\t#ifdef USE_SHADOWMAP\\n\\t\\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\\n\\t\\t#endif\\n\\t\\tRE_Direct( directLight, geometry, material, reflectedLight );\\n\\t}\\n#endif\\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\\n\\tDirectionalLight directionalLight;\\n\\t#pragma unroll_loop\\n\\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\\n\\t\\tdirectionalLight = directionalLights[ i ];\\n\\t\\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\\n\\t\\t#ifdef USE_SHADOWMAP\\n\\t\\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\\n\\t\\t#endif\\n\\t\\tRE_Direct( directLight, geometry, material, reflectedLight );\\n\\t}\\n#endif\\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\\n\\tRectAreaLight rectAreaLight;\\n\\t#pragma unroll_loop\\n\\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\\n\\t\\trectAreaLight = rectAreaLights[ i ];\\n\\t\\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\\n\\t}\\n#endif\\n#if defined( RE_IndirectDiffuse )\\n\\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\\n\\t#if ( NUM_HEMI_LIGHTS > 0 )\\n\\t\\t#pragma unroll_loop\\n\\t\\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\\n\\t\\t\\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\\n\\t\\t}\\n\\t#endif\\n#endif\\n#if defined( RE_IndirectSpecular )\\n\\tvec3 radiance = vec3( 0.0 );\\n\\tvec3 clearCoatRadiance = vec3( 0.0 );\\n#endif\\n\";\r\n\r\n\tvar lights_fragment_maps = \"#if defined( RE_IndirectDiffuse )\\n\\t#ifdef USE_LIGHTMAP\\n\\t\\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\\n\\t\\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\n\\t\\t\\tlightMapIrradiance *= PI;\\n\\t\\t#endif\\n\\t\\tirradiance += lightMapIrradiance;\\n\\t#endif\\n\\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\\n\\t\\tirradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\\n\\t#endif\\n#endif\\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\\n\\tradiance += getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), maxMipLevel );\\n\\t#ifndef STANDARD\\n\\t\\tclearCoatRadiance += getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\\n\\t#endif\\n#endif\\n\";\r\n\r\n\tvar lights_fragment_end = \"#if defined( RE_IndirectDiffuse )\\n\\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\\n#endif\\n#if defined( RE_IndirectSpecular )\\n\\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\\n#endif\\n\";\r\n\r\n\tvar logdepthbuf_fragment = \"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\\n\\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\\n#endif\";\r\n\r\n\tvar logdepthbuf_pars_fragment = \"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\\n\\tuniform float logDepthBufFC;\\n\\tvarying float vFragDepth;\\n#endif\\n\";\r\n\r\n\tvar logdepthbuf_pars_vertex = \"#ifdef USE_LOGDEPTHBUF\\n\\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\t\\tvarying float vFragDepth;\\n\\t#else\\n\\t\\tuniform float logDepthBufFC;\\n\\t#endif\\n#endif\\n\";\r\n\r\n\tvar logdepthbuf_vertex = \"#ifdef USE_LOGDEPTHBUF\\n\\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\t\\tvFragDepth = 1.0 + gl_Position.w;\\n\\t#else\\n\\t\\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\\n\\t\\tgl_Position.z *= gl_Position.w;\\n\\t#endif\\n#endif\\n\";\r\n\r\n\tvar map_fragment = \"#ifdef USE_MAP\\n\\tvec4 texelColor = texture2D( map, vUv );\\n\\ttexelColor = mapTexelToLinear( texelColor );\\n\\tdiffuseColor *= texelColor;\\n#endif\\n\";\r\n\r\n\tvar map_pars_fragment = \"#ifdef USE_MAP\\n\\tuniform sampler2D map;\\n#endif\\n\";\r\n\r\n\tvar map_particle_fragment = \"#ifdef USE_MAP\\n\\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\\n\\tvec4 mapTexel = texture2D( map, uv );\\n\\tdiffuseColor *= mapTexelToLinear( mapTexel );\\n#endif\\n\";\r\n\r\n\tvar map_particle_pars_fragment = \"#ifdef USE_MAP\\n\\tuniform mat3 uvTransform;\\n\\tuniform sampler2D map;\\n#endif\\n\";\r\n\r\n\tvar metalnessmap_fragment = \"float metalnessFactor = metalness;\\n#ifdef USE_METALNESSMAP\\n\\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\\n\\tmetalnessFactor *= texelMetalness.b;\\n#endif\\n\";\r\n\r\n\tvar metalnessmap_pars_fragment = \"#ifdef USE_METALNESSMAP\\n\\tuniform sampler2D metalnessMap;\\n#endif\";\r\n\r\n\tvar morphnormal_vertex = \"#ifdef USE_MORPHNORMALS\\n\\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\\n\\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\\n\\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\\n\\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\\n#endif\\n\";\r\n\r\n\tvar morphtarget_pars_vertex = \"#ifdef USE_MORPHTARGETS\\n\\t#ifndef USE_MORPHNORMALS\\n\\tuniform float morphTargetInfluences[ 8 ];\\n\\t#else\\n\\tuniform float morphTargetInfluences[ 4 ];\\n\\t#endif\\n#endif\";\r\n\r\n\tvar morphtarget_vertex = \"#ifdef USE_MORPHTARGETS\\n\\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\\n\\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\\n\\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\\n\\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\\n\\t#ifndef USE_MORPHNORMALS\\n\\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\\n\\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\\n\\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\\n\\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\\n\\t#endif\\n#endif\\n\";\r\n\r\n\tvar normal_fragment_begin = \"#ifdef FLAT_SHADED\\n\\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\\n\\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\\n\\tvec3 normal = normalize( cross( fdx, fdy ) );\\n#else\\n\\tvec3 normal = normalize( vNormal );\\n\\t#ifdef DOUBLE_SIDED\\n\\t\\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\\n\\t#endif\\n#endif\\n\";\r\n\r\n\tvar normal_fragment_maps = \"#ifdef USE_NORMALMAP\\n\\t#ifdef OBJECTSPACE_NORMALMAP\\n\\t\\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\\n\\t\\t#ifdef FLIP_SIDED\\n\\t\\t\\tnormal = - normal;\\n\\t\\t#endif\\n\\t\\t#ifdef DOUBLE_SIDED\\n\\t\\t\\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\\n\\t\\t#endif\\n\\t\\tnormal = normalize( normalMatrix * normal );\\n\\t#else\\n\\t\\tnormal = perturbNormal2Arb( -vViewPosition, normal );\\n\\t#endif\\n#elif defined( USE_BUMPMAP )\\n\\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\\n#endif\\n\";\r\n\r\n\tvar normalmap_pars_fragment = \"#ifdef USE_NORMALMAP\\n\\tuniform sampler2D normalMap;\\n\\tuniform vec2 normalScale;\\n\\t#ifdef OBJECTSPACE_NORMALMAP\\n\\t\\tuniform mat3 normalMatrix;\\n\\t#else\\n\\t\\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\\n\\t\\t\\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\\n\\t\\t\\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\\n\\t\\t\\tvec2 st0 = dFdx( vUv.st );\\n\\t\\t\\tvec2 st1 = dFdy( vUv.st );\\n\\t\\t\\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\\n\\t\\t\\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\\n\\t\\t\\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\\n\\t\\t\\tvec3 N = normalize( surf_norm );\\n\\t\\t\\tmat3 tsn = mat3( S, T, N );\\n\\t\\t\\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\\n\\t\\t\\tmapN.xy *= normalScale;\\n\\t\\t\\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\\n\\t\\t\\treturn normalize( tsn * mapN );\\n\\t\\t}\\n\\t#endif\\n#endif\\n\";\r\n\r\n\tvar packing = \"vec3 packNormalToRGB( const in vec3 normal ) {\\n\\treturn normalize( normal ) * 0.5 + 0.5;\\n}\\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\\n\\treturn 2.0 * rgb.xyz - 1.0;\\n}\\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\\nconst float ShiftRight8 = 1. / 256.;\\nvec4 packDepthToRGBA( const in float v ) {\\n\\tvec4 r = vec4( fract( v * PackFactors ), v );\\n\\tr.yzw -= r.xyz * ShiftRight8;\\treturn r * PackUpscale;\\n}\\nfloat unpackRGBAToDepth( const in vec4 v ) {\\n\\treturn dot( v, UnpackFactors );\\n}\\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\\n\\treturn ( viewZ + near ) / ( near - far );\\n}\\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\\n\\treturn linearClipZ * ( near - far ) - near;\\n}\\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\\n\\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\\n}\\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\\n\\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\\n}\\n\";\r\n\r\n\tvar premultiplied_alpha_fragment = \"#ifdef PREMULTIPLIED_ALPHA\\n\\tgl_FragColor.rgb *= gl_FragColor.a;\\n#endif\\n\";\r\n\r\n\tvar project_vertex = \"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\\ngl_Position = projectionMatrix * mvPosition;\\n\";\r\n\r\n\tvar dithering_fragment = \"#if defined( DITHERING )\\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\\n#endif\\n\";\r\n\r\n\tvar dithering_pars_fragment = \"#if defined( DITHERING )\\n\\tvec3 dithering( vec3 color ) {\\n\\t\\tfloat grid_position = rand( gl_FragCoord.xy );\\n\\t\\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\\n\\t\\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\\n\\t\\treturn color + dither_shift_RGB;\\n\\t}\\n#endif\\n\";\r\n\r\n\tvar roughnessmap_fragment = \"float roughnessFactor = roughness;\\n#ifdef USE_ROUGHNESSMAP\\n\\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\\n\\troughnessFactor *= texelRoughness.g;\\n#endif\\n\";\r\n\r\n\tvar roughnessmap_pars_fragment = \"#ifdef USE_ROUGHNESSMAP\\n\\tuniform sampler2D roughnessMap;\\n#endif\";\r\n\r\n\tvar shadowmap_pars_fragment = \"#ifdef USE_SHADOWMAP\\n\\t#if NUM_DIR_LIGHTS > 0\\n\\t\\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\\n\\t\\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\\n\\t#endif\\n\\t#if NUM_SPOT_LIGHTS > 0\\n\\t\\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\\n\\t\\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\\n\\t#endif\\n\\t#if NUM_POINT_LIGHTS > 0\\n\\t\\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\\n\\t\\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\\n\\t#endif\\n\\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\\n\\t\\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\\n\\t}\\n\\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\\n\\t\\tconst vec2 offset = vec2( 0.0, 1.0 );\\n\\t\\tvec2 texelSize = vec2( 1.0 ) / size;\\n\\t\\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\\n\\t\\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\\n\\t\\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\\n\\t\\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\\n\\t\\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\\n\\t\\tvec2 f = fract( uv * size + 0.5 );\\n\\t\\tfloat a = mix( lb, lt, f.y );\\n\\t\\tfloat b = mix( rb, rt, f.y );\\n\\t\\tfloat c = mix( a, b, f.x );\\n\\t\\treturn c;\\n\\t}\\n\\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\\n\\t\\tfloat shadow = 1.0;\\n\\t\\tshadowCoord.xyz /= shadowCoord.w;\\n\\t\\tshadowCoord.z += shadowBias;\\n\\t\\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\\n\\t\\tbool inFrustum = all( inFrustumVec );\\n\\t\\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\\n\\t\\tbool frustumTest = all( frustumTestVec );\\n\\t\\tif ( frustumTest ) {\\n\\t\\t#if defined( SHADOWMAP_TYPE_PCF )\\n\\t\\t\\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\\n\\t\\t\\tfloat dx0 = - texelSize.x * shadowRadius;\\n\\t\\t\\tfloat dy0 = - texelSize.y * shadowRadius;\\n\\t\\t\\tfloat dx1 = + texelSize.x * shadowRadius;\\n\\t\\t\\tfloat dy1 = + texelSize.y * shadowRadius;\\n\\t\\t\\tshadow = (\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\\n\\t\\t\\t) * ( 1.0 / 9.0 );\\n\\t\\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\\n\\t\\t\\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\\n\\t\\t\\tfloat dx0 = - texelSize.x * shadowRadius;\\n\\t\\t\\tfloat dy0 = - texelSize.y * shadowRadius;\\n\\t\\t\\tfloat dx1 = + texelSize.x * shadowRadius;\\n\\t\\t\\tfloat dy1 = + texelSize.y * shadowRadius;\\n\\t\\t\\tshadow = (\\n\\t\\t\\t\\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\\n\\t\\t\\t) * ( 1.0 / 9.0 );\\n\\t\\t#else\\n\\t\\t\\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\\n\\t\\t#endif\\n\\t\\t}\\n\\t\\treturn shadow;\\n\\t}\\n\\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\\n\\t\\tvec3 absV = abs( v );\\n\\t\\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\\n\\t\\tabsV *= scaleToCube;\\n\\t\\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\\n\\t\\tvec2 planar = v.xy;\\n\\t\\tfloat almostATexel = 1.5 * texelSizeY;\\n\\t\\tfloat almostOne = 1.0 - almostATexel;\\n\\t\\tif ( absV.z >= almostOne ) {\\n\\t\\t\\tif ( v.z > 0.0 )\\n\\t\\t\\t\\tplanar.x = 4.0 - v.x;\\n\\t\\t} else if ( absV.x >= almostOne ) {\\n\\t\\t\\tfloat signX = sign( v.x );\\n\\t\\t\\tplanar.x = v.z * signX + 2.0 * signX;\\n\\t\\t} else if ( absV.y >= almostOne ) {\\n\\t\\t\\tfloat signY = sign( v.y );\\n\\t\\t\\tplanar.x = v.x + 2.0 * signY + 2.0;\\n\\t\\t\\tplanar.y = v.z * signY - 2.0;\\n\\t\\t}\\n\\t\\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\\n\\t}\\n\\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\\n\\t\\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\\n\\t\\tvec3 lightToPosition = shadowCoord.xyz;\\n\\t\\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\\t\\tdp += shadowBias;\\n\\t\\tvec3 bd3D = normalize( lightToPosition );\\n\\t\\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\\n\\t\\t\\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\\n\\t\\t\\treturn (\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\\n\\t\\t\\t) * ( 1.0 / 9.0 );\\n\\t\\t#else\\n\\t\\t\\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\\n\\t\\t#endif\\n\\t}\\n#endif\\n\";\r\n\r\n\tvar shadowmap_pars_vertex = \"#ifdef USE_SHADOWMAP\\n\\t#if NUM_DIR_LIGHTS > 0\\n\\t\\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\\n\\t\\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\\n\\t#endif\\n\\t#if NUM_SPOT_LIGHTS > 0\\n\\t\\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\\n\\t\\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\\n\\t#endif\\n\\t#if NUM_POINT_LIGHTS > 0\\n\\t\\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\\n\\t\\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\\n\\t#endif\\n#endif\\n\";\r\n\r\n\tvar shadowmap_vertex = \"#ifdef USE_SHADOWMAP\\n\\t#if NUM_DIR_LIGHTS > 0\\n\\t#pragma unroll_loop\\n\\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\\n\\t\\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\\n\\t}\\n\\t#endif\\n\\t#if NUM_SPOT_LIGHTS > 0\\n\\t#pragma unroll_loop\\n\\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\\n\\t\\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\\n\\t}\\n\\t#endif\\n\\t#if NUM_POINT_LIGHTS > 0\\n\\t#pragma unroll_loop\\n\\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\\n\\t\\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\\n\\t}\\n\\t#endif\\n#endif\\n\";\r\n\r\n\tvar shadowmask_pars_fragment = \"float getShadowMask() {\\n\\tfloat shadow = 1.0;\\n\\t#ifdef USE_SHADOWMAP\\n\\t#if NUM_DIR_LIGHTS > 0\\n\\tDirectionalLight directionalLight;\\n\\t#pragma unroll_loop\\n\\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\\n\\t\\tdirectionalLight = directionalLights[ i ];\\n\\t\\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\\n\\t}\\n\\t#endif\\n\\t#if NUM_SPOT_LIGHTS > 0\\n\\tSpotLight spotLight;\\n\\t#pragma unroll_loop\\n\\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\\n\\t\\tspotLight = spotLights[ i ];\\n\\t\\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\\n\\t}\\n\\t#endif\\n\\t#if NUM_POINT_LIGHTS > 0\\n\\tPointLight pointLight;\\n\\t#pragma unroll_loop\\n\\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\\n\\t\\tpointLight = pointLights[ i ];\\n\\t\\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\\n\\t}\\n\\t#endif\\n\\t#endif\\n\\treturn shadow;\\n}\\n\";\r\n\r\n\tvar skinbase_vertex = \"#ifdef USE_SKINNING\\n\\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\\n\\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\\n\\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\\n\\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\\n#endif\";\r\n\r\n\tvar skinning_pars_vertex = \"#ifdef USE_SKINNING\\n\\tuniform mat4 bindMatrix;\\n\\tuniform mat4 bindMatrixInverse;\\n\\t#ifdef BONE_TEXTURE\\n\\t\\tuniform sampler2D boneTexture;\\n\\t\\tuniform int boneTextureSize;\\n\\t\\tmat4 getBoneMatrix( const in float i ) {\\n\\t\\t\\tfloat j = i * 4.0;\\n\\t\\t\\tfloat x = mod( j, float( boneTextureSize ) );\\n\\t\\t\\tfloat y = floor( j / float( boneTextureSize ) );\\n\\t\\t\\tfloat dx = 1.0 / float( boneTextureSize );\\n\\t\\t\\tfloat dy = 1.0 / float( boneTextureSize );\\n\\t\\t\\ty = dy * ( y + 0.5 );\\n\\t\\t\\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\\n\\t\\t\\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\\n\\t\\t\\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\\n\\t\\t\\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\\n\\t\\t\\tmat4 bone = mat4( v1, v2, v3, v4 );\\n\\t\\t\\treturn bone;\\n\\t\\t}\\n\\t#else\\n\\t\\tuniform mat4 boneMatrices[ MAX_BONES ];\\n\\t\\tmat4 getBoneMatrix( const in float i ) {\\n\\t\\t\\tmat4 bone = boneMatrices[ int(i) ];\\n\\t\\t\\treturn bone;\\n\\t\\t}\\n\\t#endif\\n#endif\\n\";\r\n\r\n\tvar skinning_vertex = \"#ifdef USE_SKINNING\\n\\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\\n\\tvec4 skinned = vec4( 0.0 );\\n\\tskinned += boneMatX * skinVertex * skinWeight.x;\\n\\tskinned += boneMatY * skinVertex * skinWeight.y;\\n\\tskinned += boneMatZ * skinVertex * skinWeight.z;\\n\\tskinned += boneMatW * skinVertex * skinWeight.w;\\n\\ttransformed = ( bindMatrixInverse * skinned ).xyz;\\n#endif\\n\";\r\n\r\n\tvar skinnormal_vertex = \"#ifdef USE_SKINNING\\n\\tmat4 skinMatrix = mat4( 0.0 );\\n\\tskinMatrix += skinWeight.x * boneMatX;\\n\\tskinMatrix += skinWeight.y * boneMatY;\\n\\tskinMatrix += skinWeight.z * boneMatZ;\\n\\tskinMatrix += skinWeight.w * boneMatW;\\n\\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\\n\\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\\n#endif\\n\";\r\n\r\n\tvar specularmap_fragment = \"float specularStrength;\\n#ifdef USE_SPECULARMAP\\n\\tvec4 texelSpecular = texture2D( specularMap, vUv );\\n\\tspecularStrength = texelSpecular.r;\\n#else\\n\\tspecularStrength = 1.0;\\n#endif\";\r\n\r\n\tvar specularmap_pars_fragment = \"#ifdef USE_SPECULARMAP\\n\\tuniform sampler2D specularMap;\\n#endif\";\r\n\r\n\tvar tonemapping_fragment = \"#if defined( TONE_MAPPING )\\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\\n#endif\\n\";\r\n\r\n\tvar tonemapping_pars_fragment = \"#ifndef saturate\\n\\t#define saturate(a) clamp( a, 0.0, 1.0 )\\n#endif\\nuniform float toneMappingExposure;\\nuniform float toneMappingWhitePoint;\\nvec3 LinearToneMapping( vec3 color ) {\\n\\treturn toneMappingExposure * color;\\n}\\nvec3 ReinhardToneMapping( vec3 color ) {\\n\\tcolor *= toneMappingExposure;\\n\\treturn saturate( color / ( vec3( 1.0 ) + color ) );\\n}\\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\\nvec3 Uncharted2ToneMapping( vec3 color ) {\\n\\tcolor *= toneMappingExposure;\\n\\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\\n}\\nvec3 OptimizedCineonToneMapping( vec3 color ) {\\n\\tcolor *= toneMappingExposure;\\n\\tcolor = max( vec3( 0.0 ), color - 0.004 );\\n\\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\\n}\\n\";\r\n\r\n\tvar uv_pars_fragment = \"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\\n\\tvarying vec2 vUv;\\n#endif\";\r\n\r\n\tvar uv_pars_vertex = \"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\\n\\tvarying vec2 vUv;\\n\\tuniform mat3 uvTransform;\\n#endif\\n\";\r\n\r\n\tvar uv_vertex = \"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\\n\\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\\n#endif\";\r\n\r\n\tvar uv2_pars_fragment = \"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\\tvarying vec2 vUv2;\\n#endif\";\r\n\r\n\tvar uv2_pars_vertex = \"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\\tattribute vec2 uv2;\\n\\tvarying vec2 vUv2;\\n#endif\";\r\n\r\n\tvar uv2_vertex = \"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\\tvUv2 = uv2;\\n#endif\";\r\n\r\n\tvar worldpos_vertex = \"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\\n\\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\\n#endif\\n\";\r\n\r\n\tvar cube_frag = \"uniform samplerCube tCube;\\nuniform float tFlip;\\nuniform float opacity;\\nvarying vec3 vWorldPosition;\\nvoid main() {\\n\\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\\n\\tgl_FragColor.a *= opacity;\\n}\\n\";\r\n\r\n\tvar cube_vert = \"varying vec3 vWorldPosition;\\n#include <common>\\nvoid main() {\\n\\tvWorldPosition = transformDirection( position, modelMatrix );\\n\\t#include <begin_vertex>\\n\\t#include <project_vertex>\\n\\tgl_Position.z = gl_Position.w;\\n}\\n\";\r\n\r\n\tvar depth_frag = \"#if DEPTH_PACKING == 3200\\n\\tuniform float opacity;\\n#endif\\n#include <common>\\n#include <packing>\\n#include <uv_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec4 diffuseColor = vec4( 1.0 );\\n\\t#if DEPTH_PACKING == 3200\\n\\t\\tdiffuseColor.a = opacity;\\n\\t#endif\\n\\t#include <map_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\t#include <logdepthbuf_fragment>\\n\\t#if DEPTH_PACKING == 3200\\n\\t\\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\\n\\t#elif DEPTH_PACKING == 3201\\n\\t\\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\\n\\t#endif\\n}\\n\";\r\n\r\n\tvar depth_vert = \"#include <common>\\n#include <uv_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#ifdef USE_DISPLACEMENTMAP\\n\\t\\t#include <beginnormal_vertex>\\n\\t\\t#include <morphnormal_vertex>\\n\\t\\t#include <skinnormal_vertex>\\n\\t#endif\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <displacementmap_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n}\\n\";\r\n\r\n\tvar distanceRGBA_frag = \"#define DISTANCE\\nuniform vec3 referencePosition;\\nuniform float nearDistance;\\nuniform float farDistance;\\nvarying vec3 vWorldPosition;\\n#include <common>\\n#include <packing>\\n#include <uv_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main () {\\n\\t#include <clipping_planes_fragment>\\n\\tvec4 diffuseColor = vec4( 1.0 );\\n\\t#include <map_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\tfloat dist = length( vWorldPosition - referencePosition );\\n\\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\\n\\tdist = saturate( dist );\\n\\tgl_FragColor = packDepthToRGBA( dist );\\n}\\n\";\r\n\r\n\tvar distanceRGBA_vert = \"#define DISTANCE\\nvarying vec3 vWorldPosition;\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#ifdef USE_DISPLACEMENTMAP\\n\\t\\t#include <beginnormal_vertex>\\n\\t\\t#include <morphnormal_vertex>\\n\\t\\t#include <skinnormal_vertex>\\n\\t#endif\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <displacementmap_vertex>\\n\\t#include <project_vertex>\\n\\t#include <worldpos_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\tvWorldPosition = worldPosition.xyz;\\n}\\n\";\r\n\r\n\tvar equirect_frag = \"uniform sampler2D tEquirect;\\nvarying vec3 vWorldPosition;\\n#include <common>\\nvoid main() {\\n\\tvec3 direction = normalize( vWorldPosition );\\n\\tvec2 sampleUV;\\n\\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\\n\\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\\n\\tgl_FragColor = texture2D( tEquirect, sampleUV );\\n}\\n\";\r\n\r\n\tvar equirect_vert = \"varying vec3 vWorldPosition;\\n#include <common>\\nvoid main() {\\n\\tvWorldPosition = transformDirection( position, modelMatrix );\\n\\t#include <begin_vertex>\\n\\t#include <project_vertex>\\n}\\n\";\r\n\r\n\tvar linedashed_frag = \"uniform vec3 diffuse;\\nuniform float opacity;\\nuniform float dashSize;\\nuniform float totalSize;\\nvarying float vLineDistance;\\n#include <common>\\n#include <color_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\\n\\t\\tdiscard;\\n\\t}\\n\\tvec3 outgoingLight = vec3( 0.0 );\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <color_fragment>\\n\\toutgoingLight = diffuseColor.rgb;\\n\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\\t#include <premultiplied_alpha_fragment>\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n}\\n\";\r\n\r\n\tvar linedashed_vert = \"uniform float scale;\\nattribute float lineDistance;\\nvarying float vLineDistance;\\n#include <common>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <color_vertex>\\n\\tvLineDistance = scale * lineDistance;\\n\\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\\n\\tgl_Position = projectionMatrix * mvPosition;\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\t#include <fog_vertex>\\n}\\n\";\r\n\r\n\tvar meshbasic_frag = \"uniform vec3 diffuse;\\nuniform float opacity;\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n#endif\\n#include <common>\\n#include <color_pars_fragment>\\n#include <uv_pars_fragment>\\n#include <uv2_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <aomap_pars_fragment>\\n#include <lightmap_pars_fragment>\\n#include <envmap_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <specularmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_fragment>\\n\\t#include <color_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\t#include <specularmap_fragment>\\n\\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n\\t#ifdef USE_LIGHTMAP\\n\\t\\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\\n\\t#else\\n\\t\\treflectedLight.indirectDiffuse += vec3( 1.0 );\\n\\t#endif\\n\\t#include <aomap_fragment>\\n\\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\\n\\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\\n\\t#include <envmap_fragment>\\n\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\\t#include <premultiplied_alpha_fragment>\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n}\\n\";\r\n\r\n\tvar meshbasic_vert = \"#include <common>\\n#include <uv_pars_vertex>\\n#include <uv2_pars_vertex>\\n#include <envmap_pars_vertex>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <uv2_vertex>\\n\\t#include <color_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#ifdef USE_ENVMAP\\n\\t#include <beginnormal_vertex>\\n\\t#include <morphnormal_vertex>\\n\\t#include <skinnormal_vertex>\\n\\t#include <defaultnormal_vertex>\\n\\t#endif\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <worldpos_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\t#include <envmap_vertex>\\n\\t#include <fog_vertex>\\n}\\n\";\r\n\r\n\tvar meshlambert_frag = \"uniform vec3 diffuse;\\nuniform vec3 emissive;\\nuniform float opacity;\\nvarying vec3 vLightFront;\\n#ifdef DOUBLE_SIDED\\n\\tvarying vec3 vLightBack;\\n#endif\\n#include <common>\\n#include <packing>\\n#include <dithering_pars_fragment>\\n#include <color_pars_fragment>\\n#include <uv_pars_fragment>\\n#include <uv2_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <aomap_pars_fragment>\\n#include <lightmap_pars_fragment>\\n#include <emissivemap_pars_fragment>\\n#include <envmap_pars_fragment>\\n#include <bsdfs>\\n#include <lights_pars_begin>\\n#include <fog_pars_fragment>\\n#include <shadowmap_pars_fragment>\\n#include <shadowmask_pars_fragment>\\n#include <specularmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n\\tvec3 totalEmissiveRadiance = emissive;\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_fragment>\\n\\t#include <color_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\t#include <specularmap_fragment>\\n\\t#include <emissivemap_fragment>\\n\\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\\n\\t#include <lightmap_fragment>\\n\\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\\n\\t#ifdef DOUBLE_SIDED\\n\\t\\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\\n\\t#else\\n\\t\\treflectedLight.directDiffuse = vLightFront;\\n\\t#endif\\n\\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\\n\\t#include <aomap_fragment>\\n\\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\\n\\t#include <envmap_fragment>\\n\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n\\t#include <premultiplied_alpha_fragment>\\n\\t#include <dithering_fragment>\\n}\\n\";\r\n\r\n\tvar meshlambert_vert = \"#define LAMBERT\\nvarying vec3 vLightFront;\\n#ifdef DOUBLE_SIDED\\n\\tvarying vec3 vLightBack;\\n#endif\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <uv2_pars_vertex>\\n#include <envmap_pars_vertex>\\n#include <bsdfs>\\n#include <lights_pars_begin>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <shadowmap_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <uv2_vertex>\\n\\t#include <color_vertex>\\n\\t#include <beginnormal_vertex>\\n\\t#include <morphnormal_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#include <skinnormal_vertex>\\n\\t#include <defaultnormal_vertex>\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\t#include <worldpos_vertex>\\n\\t#include <envmap_vertex>\\n\\t#include <lights_lambert_vertex>\\n\\t#include <shadowmap_vertex>\\n\\t#include <fog_vertex>\\n}\\n\";\r\n\r\n\tvar meshphong_frag = \"#define PHONG\\nuniform vec3 diffuse;\\nuniform vec3 emissive;\\nuniform vec3 specular;\\nuniform float shininess;\\nuniform float opacity;\\n#include <common>\\n#include <packing>\\n#include <dithering_pars_fragment>\\n#include <color_pars_fragment>\\n#include <uv_pars_fragment>\\n#include <uv2_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <aomap_pars_fragment>\\n#include <lightmap_pars_fragment>\\n#include <emissivemap_pars_fragment>\\n#include <envmap_pars_fragment>\\n#include <gradientmap_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <bsdfs>\\n#include <lights_pars_begin>\\n#include <lights_phong_pars_fragment>\\n#include <shadowmap_pars_fragment>\\n#include <bumpmap_pars_fragment>\\n#include <normalmap_pars_fragment>\\n#include <specularmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n\\tvec3 totalEmissiveRadiance = emissive;\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_fragment>\\n\\t#include <color_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\t#include <specularmap_fragment>\\n\\t#include <normal_fragment_begin>\\n\\t#include <normal_fragment_maps>\\n\\t#include <emissivemap_fragment>\\n\\t#include <lights_phong_fragment>\\n\\t#include <lights_fragment_begin>\\n\\t#include <lights_fragment_maps>\\n\\t#include <lights_fragment_end>\\n\\t#include <aomap_fragment>\\n\\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\\n\\t#include <envmap_fragment>\\n\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n\\t#include <premultiplied_alpha_fragment>\\n\\t#include <dithering_fragment>\\n}\\n\";\r\n\r\n\tvar meshphong_vert = \"#define PHONG\\nvarying vec3 vViewPosition;\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n#endif\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <uv2_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <envmap_pars_vertex>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <shadowmap_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <uv2_vertex>\\n\\t#include <color_vertex>\\n\\t#include <beginnormal_vertex>\\n\\t#include <morphnormal_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#include <skinnormal_vertex>\\n\\t#include <defaultnormal_vertex>\\n#ifndef FLAT_SHADED\\n\\tvNormal = normalize( transformedNormal );\\n#endif\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <displacementmap_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\tvViewPosition = - mvPosition.xyz;\\n\\t#include <worldpos_vertex>\\n\\t#include <envmap_vertex>\\n\\t#include <shadowmap_vertex>\\n\\t#include <fog_vertex>\\n}\\n\";\r\n\r\n\tvar meshphysical_frag = \"#define PHYSICAL\\nuniform vec3 diffuse;\\nuniform vec3 emissive;\\nuniform float roughness;\\nuniform float metalness;\\nuniform float opacity;\\n#ifndef STANDARD\\n\\tuniform float clearCoat;\\n\\tuniform float clearCoatRoughness;\\n#endif\\nvarying vec3 vViewPosition;\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n#endif\\n#include <common>\\n#include <packing>\\n#include <dithering_pars_fragment>\\n#include <color_pars_fragment>\\n#include <uv_pars_fragment>\\n#include <uv2_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <aomap_pars_fragment>\\n#include <lightmap_pars_fragment>\\n#include <emissivemap_pars_fragment>\\n#include <bsdfs>\\n#include <cube_uv_reflection_fragment>\\n#include <envmap_pars_fragment>\\n#include <envmap_physical_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <lights_pars_begin>\\n#include <lights_physical_pars_fragment>\\n#include <shadowmap_pars_fragment>\\n#include <bumpmap_pars_fragment>\\n#include <normalmap_pars_fragment>\\n#include <roughnessmap_pars_fragment>\\n#include <metalnessmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n\\tvec3 totalEmissiveRadiance = emissive;\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_fragment>\\n\\t#include <color_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\t#include <roughnessmap_fragment>\\n\\t#include <metalnessmap_fragment>\\n\\t#include <normal_fragment_begin>\\n\\t#include <normal_fragment_maps>\\n\\t#include <emissivemap_fragment>\\n\\t#include <lights_physical_fragment>\\n\\t#include <lights_fragment_begin>\\n\\t#include <lights_fragment_maps>\\n\\t#include <lights_fragment_end>\\n\\t#include <aomap_fragment>\\n\\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\\n\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n\\t#include <premultiplied_alpha_fragment>\\n\\t#include <dithering_fragment>\\n}\\n\";\r\n\r\n\tvar meshphysical_vert = \"#define PHYSICAL\\nvarying vec3 vViewPosition;\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n#endif\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <uv2_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <shadowmap_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <uv2_vertex>\\n\\t#include <color_vertex>\\n\\t#include <beginnormal_vertex>\\n\\t#include <morphnormal_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#include <skinnormal_vertex>\\n\\t#include <defaultnormal_vertex>\\n#ifndef FLAT_SHADED\\n\\tvNormal = normalize( transformedNormal );\\n#endif\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <displacementmap_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\tvViewPosition = - mvPosition.xyz;\\n\\t#include <worldpos_vertex>\\n\\t#include <shadowmap_vertex>\\n\\t#include <fog_vertex>\\n}\\n\";\r\n\r\n\tvar normal_frag = \"#define NORMAL\\nuniform float opacity;\\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\\n\\tvarying vec3 vViewPosition;\\n#endif\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n#endif\\n#include <packing>\\n#include <uv_pars_fragment>\\n#include <bumpmap_pars_fragment>\\n#include <normalmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\nvoid main() {\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <normal_fragment_begin>\\n\\t#include <normal_fragment_maps>\\n\\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\\n}\\n\";\r\n\r\n\tvar normal_vert = \"#define NORMAL\\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\\n\\tvarying vec3 vViewPosition;\\n#endif\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n#endif\\n#include <uv_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <beginnormal_vertex>\\n\\t#include <morphnormal_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#include <skinnormal_vertex>\\n\\t#include <defaultnormal_vertex>\\n#ifndef FLAT_SHADED\\n\\tvNormal = normalize( transformedNormal );\\n#endif\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <displacementmap_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\\n\\tvViewPosition = - mvPosition.xyz;\\n#endif\\n}\\n\";\r\n\r\n\tvar points_frag = \"uniform vec3 diffuse;\\nuniform float opacity;\\n#include <common>\\n#include <color_pars_fragment>\\n#include <map_particle_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec3 outgoingLight = vec3( 0.0 );\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_particle_fragment>\\n\\t#include <color_fragment>\\n\\t#include <alphatest_fragment>\\n\\toutgoingLight = diffuseColor.rgb;\\n\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\\t#include <premultiplied_alpha_fragment>\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n}\\n\";\r\n\r\n\tvar points_vert = \"uniform float size;\\nuniform float scale;\\n#include <common>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <color_vertex>\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <project_vertex>\\n\\tgl_PointSize = size;\\n\\t#ifdef USE_SIZEATTENUATION\\n\\t\\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\\n\\t\\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\\n\\t#endif\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\t#include <worldpos_vertex>\\n\\t#include <fog_vertex>\\n}\\n\";\r\n\r\n\tvar shadow_frag = \"uniform vec3 color;\\nuniform float opacity;\\n#include <common>\\n#include <packing>\\n#include <fog_pars_fragment>\\n#include <bsdfs>\\n#include <lights_pars_begin>\\n#include <shadowmap_pars_fragment>\\n#include <shadowmask_pars_fragment>\\nvoid main() {\\n\\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\\n\\t#include <fog_fragment>\\n}\\n\";\r\n\r\n\tvar shadow_vert = \"#include <fog_pars_vertex>\\n#include <shadowmap_pars_vertex>\\nvoid main() {\\n\\t#include <begin_vertex>\\n\\t#include <project_vertex>\\n\\t#include <worldpos_vertex>\\n\\t#include <shadowmap_vertex>\\n\\t#include <fog_vertex>\\n}\\n\";\r\n\r\n\tvar sprite_frag = \"uniform vec3 diffuse;\\nuniform float opacity;\\n#include <common>\\n#include <uv_pars_fragment>\\n#include <map_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec3 outgoingLight = vec3( 0.0 );\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_fragment>\\n\\t#include <alphatest_fragment>\\n\\toutgoingLight = diffuseColor.rgb;\\n\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n}\\n\";\r\n\r\n\tvar sprite_vert = \"uniform float rotation;\\nuniform vec2 center;\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\\n\\tvec2 scale;\\n\\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\\n\\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\\n\\t#ifndef USE_SIZEATTENUATION\\n\\t\\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\\n\\t\\tif ( isPerspective ) scale *= - mvPosition.z;\\n\\t#endif\\n\\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\\n\\tvec2 rotatedPosition;\\n\\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\\n\\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\\n\\tmvPosition.xy += rotatedPosition;\\n\\tgl_Position = projectionMatrix * mvPosition;\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\t#include <fog_vertex>\\n}\\n\";\r\n\r\n\tvar ShaderChunk = {\r\n\t\talphamap_fragment: alphamap_fragment,\r\n\t\talphamap_pars_fragment: alphamap_pars_fragment,\r\n\t\talphatest_fragment: alphatest_fragment,\r\n\t\taomap_fragment: aomap_fragment,\r\n\t\taomap_pars_fragment: aomap_pars_fragment,\r\n\t\tbegin_vertex: begin_vertex,\r\n\t\tbeginnormal_vertex: beginnormal_vertex,\r\n\t\tbsdfs: bsdfs,\r\n\t\tbumpmap_pars_fragment: bumpmap_pars_fragment,\r\n\t\tclipping_planes_fragment: clipping_planes_fragment,\r\n\t\tclipping_planes_pars_fragment: clipping_planes_pars_fragment,\r\n\t\tclipping_planes_pars_vertex: clipping_planes_pars_vertex,\r\n\t\tclipping_planes_vertex: clipping_planes_vertex,\r\n\t\tcolor_fragment: color_fragment,\r\n\t\tcolor_pars_fragment: color_pars_fragment,\r\n\t\tcolor_pars_vertex: color_pars_vertex,\r\n\t\tcolor_vertex: color_vertex,\r\n\t\tcommon: common,\r\n\t\tcube_uv_reflection_fragment: cube_uv_reflection_fragment,\r\n\t\tdefaultnormal_vertex: defaultnormal_vertex,\r\n\t\tdisplacementmap_pars_vertex: displacementmap_pars_vertex,\r\n\t\tdisplacementmap_vertex: displacementmap_vertex,\r\n\t\temissivemap_fragment: emissivemap_fragment,\r\n\t\temissivemap_pars_fragment: emissivemap_pars_fragment,\r\n\t\tencodings_fragment: encodings_fragment,\r\n\t\tencodings_pars_fragment: encodings_pars_fragment,\r\n\t\tenvmap_fragment: envmap_fragment,\r\n\t\tenvmap_pars_fragment: envmap_pars_fragment,\r\n\t\tenvmap_pars_vertex: envmap_pars_vertex,\r\n\t\tenvmap_physical_pars_fragment: envmap_physical_pars_fragment,\r\n\t\tenvmap_vertex: envmap_vertex,\r\n\t\tfog_vertex: fog_vertex,\r\n\t\tfog_pars_vertex: fog_pars_vertex,\r\n\t\tfog_fragment: fog_fragment,\r\n\t\tfog_pars_fragment: fog_pars_fragment,\r\n\t\tgradientmap_pars_fragment: gradientmap_pars_fragment,\r\n\t\tlightmap_fragment: lightmap_fragment,\r\n\t\tlightmap_pars_fragment: lightmap_pars_fragment,\r\n\t\tlights_lambert_vertex: lights_lambert_vertex,\r\n\t\tlights_pars_begin: lights_pars_begin,\r\n\t\tlights_phong_fragment: lights_phong_fragment,\r\n\t\tlights_phong_pars_fragment: lights_phong_pars_fragment,\r\n\t\tlights_physical_fragment: lights_physical_fragment,\r\n\t\tlights_physical_pars_fragment: lights_physical_pars_fragment,\r\n\t\tlights_fragment_begin: lights_fragment_begin,\r\n\t\tlights_fragment_maps: lights_fragment_maps,\r\n\t\tlights_fragment_end: lights_fragment_end,\r\n\t\tlogdepthbuf_fragment: logdepthbuf_fragment,\r\n\t\tlogdepthbuf_pars_fragment: logdepthbuf_pars_fragment,\r\n\t\tlogdepthbuf_pars_vertex: logdepthbuf_pars_vertex,\r\n\t\tlogdepthbuf_vertex: logdepthbuf_vertex,\r\n\t\tmap_fragment: map_fragment,\r\n\t\tmap_pars_fragment: map_pars_fragment,\r\n\t\tmap_particle_fragment: map_particle_fragment,\r\n\t\tmap_particle_pars_fragment: map_particle_pars_fragment,\r\n\t\tmetalnessmap_fragment: metalnessmap_fragment,\r\n\t\tmetalnessmap_pars_fragment: metalnessmap_pars_fragment,\r\n\t\tmorphnormal_vertex: morphnormal_vertex,\r\n\t\tmorphtarget_pars_vertex: morphtarget_pars_vertex,\r\n\t\tmorphtarget_vertex: morphtarget_vertex,\r\n\t\tnormal_fragment_begin: normal_fragment_begin,\r\n\t\tnormal_fragment_maps: normal_fragment_maps,\r\n\t\tnormalmap_pars_fragment: normalmap_pars_fragment,\r\n\t\tpacking: packing,\r\n\t\tpremultiplied_alpha_fragment: premultiplied_alpha_fragment,\r\n\t\tproject_vertex: project_vertex,\r\n\t\tdithering_fragment: dithering_fragment,\r\n\t\tdithering_pars_fragment: dithering_pars_fragment,\r\n\t\troughnessmap_fragment: roughnessmap_fragment,\r\n\t\troughnessmap_pars_fragment: roughnessmap_pars_fragment,\r\n\t\tshadowmap_pars_fragment: shadowmap_pars_fragment,\r\n\t\tshadowmap_pars_vertex: shadowmap_pars_vertex,\r\n\t\tshadowmap_vertex: shadowmap_vertex,\r\n\t\tshadowmask_pars_fragment: shadowmask_pars_fragment,\r\n\t\tskinbase_vertex: skinbase_vertex,\r\n\t\tskinning_pars_vertex: skinning_pars_vertex,\r\n\t\tskinning_vertex: skinning_vertex,\r\n\t\tskinnormal_vertex: skinnormal_vertex,\r\n\t\tspecularmap_fragment: specularmap_fragment,\r\n\t\tspecularmap_pars_fragment: specularmap_pars_fragment,\r\n\t\ttonemapping_fragment: tonemapping_fragment,\r\n\t\ttonemapping_pars_fragment: tonemapping_pars_fragment,\r\n\t\tuv_pars_fragment: uv_pars_fragment,\r\n\t\tuv_pars_vertex: uv_pars_vertex,\r\n\t\tuv_vertex: uv_vertex,\r\n\t\tuv2_pars_fragment: uv2_pars_fragment,\r\n\t\tuv2_pars_vertex: uv2_pars_vertex,\r\n\t\tuv2_vertex: uv2_vertex,\r\n\t\tworldpos_vertex: worldpos_vertex,\r\n\r\n\t\tcube_frag: cube_frag,\r\n\t\tcube_vert: cube_vert,\r\n\t\tdepth_frag: depth_frag,\r\n\t\tdepth_vert: depth_vert,\r\n\t\tdistanceRGBA_frag: distanceRGBA_frag,\r\n\t\tdistanceRGBA_vert: distanceRGBA_vert,\r\n\t\tequirect_frag: equirect_frag,\r\n\t\tequirect_vert: equirect_vert,\r\n\t\tlinedashed_frag: linedashed_frag,\r\n\t\tlinedashed_vert: linedashed_vert,\r\n\t\tmeshbasic_frag: meshbasic_frag,\r\n\t\tmeshbasic_vert: meshbasic_vert,\r\n\t\tmeshlambert_frag: meshlambert_frag,\r\n\t\tmeshlambert_vert: meshlambert_vert,\r\n\t\tmeshphong_frag: meshphong_frag,\r\n\t\tmeshphong_vert: meshphong_vert,\r\n\t\tmeshphysical_frag: meshphysical_frag,\r\n\t\tmeshphysical_vert: meshphysical_vert,\r\n\t\tnormal_frag: normal_frag,\r\n\t\tnormal_vert: normal_vert,\r\n\t\tpoints_frag: points_frag,\r\n\t\tpoints_vert: points_vert,\r\n\t\tshadow_frag: shadow_frag,\r\n\t\tshadow_vert: shadow_vert,\r\n\t\tsprite_frag: sprite_frag,\r\n\t\tsprite_vert: sprite_vert\r\n\t};\r\n\r\n\t/**\r\n\t * Uniform Utilities\r\n\t */\r\n\r\n\tvar UniformsUtils = {\r\n\r\n\t\tmerge: function ( uniforms ) {\r\n\r\n\t\t\tvar merged = {};\r\n\r\n\t\t\tfor ( var u = 0; u < uniforms.length; u ++ ) {\r\n\r\n\t\t\t\tvar tmp = this.clone( uniforms[ u ] );\r\n\r\n\t\t\t\tfor ( var p in tmp ) {\r\n\r\n\t\t\t\t\tmerged[ p ] = tmp[ p ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn merged;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function ( uniforms_src ) {\r\n\r\n\t\t\tvar uniforms_dst = {};\r\n\r\n\t\t\tfor ( var u in uniforms_src ) {\r\n\r\n\t\t\t\tuniforms_dst[ u ] = {};\r\n\r\n\t\t\t\tfor ( var p in uniforms_src[ u ] ) {\r\n\r\n\t\t\t\t\tvar parameter_src = uniforms_src[ u ][ p ];\r\n\r\n\t\t\t\t\tif ( parameter_src && ( parameter_src.isColor ||\r\n\t\t\t\t\t\tparameter_src.isMatrix3 || parameter_src.isMatrix4 ||\r\n\t\t\t\t\t\tparameter_src.isVector2 || parameter_src.isVector3 || parameter_src.isVector4 ||\r\n\t\t\t\t\t\tparameter_src.isTexture ) ) {\r\n\r\n\t\t\t\t\t\tuniforms_dst[ u ][ p ] = parameter_src.clone();\r\n\r\n\t\t\t\t\t} else if ( Array.isArray( parameter_src ) ) {\r\n\r\n\t\t\t\t\t\tuniforms_dst[ u ][ p ] = parameter_src.slice();\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tuniforms_dst[ u ][ p ] = parameter_src;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn uniforms_dst;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tvar ColorKeywords = { 'aliceblue': 0xF0F8FF, 'antiquewhite': 0xFAEBD7, 'aqua': 0x00FFFF, 'aquamarine': 0x7FFFD4, 'azure': 0xF0FFFF,\r\n\t\t'beige': 0xF5F5DC, 'bisque': 0xFFE4C4, 'black': 0x000000, 'blanchedalmond': 0xFFEBCD, 'blue': 0x0000FF, 'blueviolet': 0x8A2BE2,\r\n\t\t'brown': 0xA52A2A, 'burlywood': 0xDEB887, 'cadetblue': 0x5F9EA0, 'chartreuse': 0x7FFF00, 'chocolate': 0xD2691E, 'coral': 0xFF7F50,\r\n\t\t'cornflowerblue': 0x6495ED, 'cornsilk': 0xFFF8DC, 'crimson': 0xDC143C, 'cyan': 0x00FFFF, 'darkblue': 0x00008B, 'darkcyan': 0x008B8B,\r\n\t\t'darkgoldenrod': 0xB8860B, 'darkgray': 0xA9A9A9, 'darkgreen': 0x006400, 'darkgrey': 0xA9A9A9, 'darkkhaki': 0xBDB76B, 'darkmagenta': 0x8B008B,\r\n\t\t'darkolivegreen': 0x556B2F, 'darkorange': 0xFF8C00, 'darkorchid': 0x9932CC, 'darkred': 0x8B0000, 'darksalmon': 0xE9967A, 'darkseagreen': 0x8FBC8F,\r\n\t\t'darkslateblue': 0x483D8B, 'darkslategray': 0x2F4F4F, 'darkslategrey': 0x2F4F4F, 'darkturquoise': 0x00CED1, 'darkviolet': 0x9400D3,\r\n\t\t'deeppink': 0xFF1493, 'deepskyblue': 0x00BFFF, 'dimgray': 0x696969, 'dimgrey': 0x696969, 'dodgerblue': 0x1E90FF, 'firebrick': 0xB22222,\r\n\t\t'floralwhite': 0xFFFAF0, 'forestgreen': 0x228B22, 'fuchsia': 0xFF00FF, 'gainsboro': 0xDCDCDC, 'ghostwhite': 0xF8F8FF, 'gold': 0xFFD700,\r\n\t\t'goldenrod': 0xDAA520, 'gray': 0x808080, 'green': 0x008000, 'greenyellow': 0xADFF2F, 'grey': 0x808080, 'honeydew': 0xF0FFF0, 'hotpink': 0xFF69B4,\r\n\t\t'indianred': 0xCD5C5C, 'indigo': 0x4B0082, 'ivory': 0xFFFFF0, 'khaki': 0xF0E68C, 'lavender': 0xE6E6FA, 'lavenderblush': 0xFFF0F5, 'lawngreen': 0x7CFC00,\r\n\t\t'lemonchiffon': 0xFFFACD, 'lightblue': 0xADD8E6, 'lightcoral': 0xF08080, 'lightcyan': 0xE0FFFF, 'lightgoldenrodyellow': 0xFAFAD2, 'lightgray': 0xD3D3D3,\r\n\t\t'lightgreen': 0x90EE90, 'lightgrey': 0xD3D3D3, 'lightpink': 0xFFB6C1, 'lightsalmon': 0xFFA07A, 'lightseagreen': 0x20B2AA, 'lightskyblue': 0x87CEFA,\r\n\t\t'lightslategray': 0x778899, 'lightslategrey': 0x778899, 'lightsteelblue': 0xB0C4DE, 'lightyellow': 0xFFFFE0, 'lime': 0x00FF00, 'limegreen': 0x32CD32,\r\n\t\t'linen': 0xFAF0E6, 'magenta': 0xFF00FF, 'maroon': 0x800000, 'mediumaquamarine': 0x66CDAA, 'mediumblue': 0x0000CD, 'mediumorchid': 0xBA55D3,\r\n\t\t'mediumpurple': 0x9370DB, 'mediumseagreen': 0x3CB371, 'mediumslateblue': 0x7B68EE, 'mediumspringgreen': 0x00FA9A, 'mediumturquoise': 0x48D1CC,\r\n\t\t'mediumvioletred': 0xC71585, 'midnightblue': 0x191970, 'mintcream': 0xF5FFFA, 'mistyrose': 0xFFE4E1, 'moccasin': 0xFFE4B5, 'navajowhite': 0xFFDEAD,\r\n\t\t'navy': 0x000080, 'oldlace': 0xFDF5E6, 'olive': 0x808000, 'olivedrab': 0x6B8E23, 'orange': 0xFFA500, 'orangered': 0xFF4500, 'orchid': 0xDA70D6,\r\n\t\t'palegoldenrod': 0xEEE8AA, 'palegreen': 0x98FB98, 'paleturquoise': 0xAFEEEE, 'palevioletred': 0xDB7093, 'papayawhip': 0xFFEFD5, 'peachpuff': 0xFFDAB9,\r\n\t\t'peru': 0xCD853F, 'pink': 0xFFC0CB, 'plum': 0xDDA0DD, 'powderblue': 0xB0E0E6, 'purple': 0x800080, 'rebeccapurple': 0x663399, 'red': 0xFF0000, 'rosybrown': 0xBC8F8F,\r\n\t\t'royalblue': 0x4169E1, 'saddlebrown': 0x8B4513, 'salmon': 0xFA8072, 'sandybrown': 0xF4A460, 'seagreen': 0x2E8B57, 'seashell': 0xFFF5EE,\r\n\t\t'sienna': 0xA0522D, 'silver': 0xC0C0C0, 'skyblue': 0x87CEEB, 'slateblue': 0x6A5ACD, 'slategray': 0x708090, 'slategrey': 0x708090, 'snow': 0xFFFAFA,\r\n\t\t'springgreen': 0x00FF7F, 'steelblue': 0x4682B4, 'tan': 0xD2B48C, 'teal': 0x008080, 'thistle': 0xD8BFD8, 'tomato': 0xFF6347, 'turquoise': 0x40E0D0,\r\n\t\t'violet': 0xEE82EE, 'wheat': 0xF5DEB3, 'white': 0xFFFFFF, 'whitesmoke': 0xF5F5F5, 'yellow': 0xFFFF00, 'yellowgreen': 0x9ACD32 };\r\n\r\n\tfunction Color( r, g, b ) {\r\n\r\n\t\tif ( g === undefined && b === undefined ) {\r\n\r\n\t\t\t// r is THREE.Color, hex or string\r\n\t\t\treturn this.set( r );\r\n\r\n\t\t}\r\n\r\n\t\treturn this.setRGB( r, g, b );\r\n\r\n\t}\r\n\r\n\tObject.assign( Color.prototype, {\r\n\r\n\t\tisColor: true,\r\n\r\n\t\tr: 1, g: 1, b: 1,\r\n\r\n\t\tset: function ( value ) {\r\n\r\n\t\t\tif ( value && value.isColor ) {\r\n\r\n\t\t\t\tthis.copy( value );\r\n\r\n\t\t\t} else if ( typeof value === 'number' ) {\r\n\r\n\t\t\t\tthis.setHex( value );\r\n\r\n\t\t\t} else if ( typeof value === 'string' ) {\r\n\r\n\t\t\t\tthis.setStyle( value );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetScalar: function ( scalar ) {\r\n\r\n\t\t\tthis.r = scalar;\r\n\t\t\tthis.g = scalar;\r\n\t\t\tthis.b = scalar;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetHex: function ( hex ) {\r\n\r\n\t\t\thex = Math.floor( hex );\r\n\r\n\t\t\tthis.r = ( hex >> 16 & 255 ) / 255;\r\n\t\t\tthis.g = ( hex >> 8 & 255 ) / 255;\r\n\t\t\tthis.b = ( hex & 255 ) / 255;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetRGB: function ( r, g, b ) {\r\n\r\n\t\t\tthis.r = r;\r\n\t\t\tthis.g = g;\r\n\t\t\tthis.b = b;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetHSL: function () {\r\n\r\n\t\t\tfunction hue2rgb( p, q, t ) {\r\n\r\n\t\t\t\tif ( t < 0 ) t += 1;\r\n\t\t\t\tif ( t > 1 ) t -= 1;\r\n\t\t\t\tif ( t < 1 / 6 ) return p + ( q - p ) * 6 * t;\r\n\t\t\t\tif ( t < 1 / 2 ) return q;\r\n\t\t\t\tif ( t < 2 / 3 ) return p + ( q - p ) * 6 * ( 2 / 3 - t );\r\n\t\t\t\treturn p;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn function setHSL( h, s, l ) {\r\n\r\n\t\t\t\t// h,s,l ranges are in 0.0 - 1.0\r\n\t\t\t\th = _Math.euclideanModulo( h, 1 );\r\n\t\t\t\ts = _Math.clamp( s, 0, 1 );\r\n\t\t\t\tl = _Math.clamp( l, 0, 1 );\r\n\r\n\t\t\t\tif ( s === 0 ) {\r\n\r\n\t\t\t\t\tthis.r = this.g = this.b = l;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tvar p = l <= 0.5 ? l * ( 1 + s ) : l + s - ( l * s );\r\n\t\t\t\t\tvar q = ( 2 * l ) - p;\r\n\r\n\t\t\t\t\tthis.r = hue2rgb( q, p, h + 1 / 3 );\r\n\t\t\t\t\tthis.g = hue2rgb( q, p, h );\r\n\t\t\t\t\tthis.b = hue2rgb( q, p, h - 1 / 3 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tsetStyle: function ( style ) {\r\n\r\n\t\t\tfunction handleAlpha( string ) {\r\n\r\n\t\t\t\tif ( string === undefined ) return;\r\n\r\n\t\t\t\tif ( parseFloat( string ) < 1 ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.Color: Alpha component of ' + style + ' will be ignored.' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\tvar m;\r\n\r\n\t\t\tif ( m = /^((?:rgb|hsl)a?)\\(\\s*([^\\)]*)\\)/.exec( style ) ) {\r\n\r\n\t\t\t\t// rgb / hsl\r\n\r\n\t\t\t\tvar color;\r\n\t\t\t\tvar name = m[ 1 ];\r\n\t\t\t\tvar components = m[ 2 ];\r\n\r\n\t\t\t\tswitch ( name ) {\r\n\r\n\t\t\t\t\tcase 'rgb':\r\n\t\t\t\t\tcase 'rgba':\r\n\r\n\t\t\t\t\t\tif ( color = /^(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*(,\\s*([0-9]*\\.?[0-9]+)\\s*)?$/.exec( components ) ) {\r\n\r\n\t\t\t\t\t\t\t// rgb(255,0,0) rgba(255,0,0,0.5)\r\n\t\t\t\t\t\t\tthis.r = Math.min( 255, parseInt( color[ 1 ], 10 ) ) / 255;\r\n\t\t\t\t\t\t\tthis.g = Math.min( 255, parseInt( color[ 2 ], 10 ) ) / 255;\r\n\t\t\t\t\t\t\tthis.b = Math.min( 255, parseInt( color[ 3 ], 10 ) ) / 255;\r\n\r\n\t\t\t\t\t\t\thandleAlpha( color[ 5 ] );\r\n\r\n\t\t\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif ( color = /^(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*(,\\s*([0-9]*\\.?[0-9]+)\\s*)?$/.exec( components ) ) {\r\n\r\n\t\t\t\t\t\t\t// rgb(100%,0%,0%) rgba(100%,0%,0%,0.5)\r\n\t\t\t\t\t\t\tthis.r = Math.min( 100, parseInt( color[ 1 ], 10 ) ) / 100;\r\n\t\t\t\t\t\t\tthis.g = Math.min( 100, parseInt( color[ 2 ], 10 ) ) / 100;\r\n\t\t\t\t\t\t\tthis.b = Math.min( 100, parseInt( color[ 3 ], 10 ) ) / 100;\r\n\r\n\t\t\t\t\t\t\thandleAlpha( color[ 5 ] );\r\n\r\n\t\t\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'hsl':\r\n\t\t\t\t\tcase 'hsla':\r\n\r\n\t\t\t\t\t\tif ( color = /^([0-9]*\\.?[0-9]+)\\s*,\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*(,\\s*([0-9]*\\.?[0-9]+)\\s*)?$/.exec( components ) ) {\r\n\r\n\t\t\t\t\t\t\t// hsl(120,50%,50%) hsla(120,50%,50%,0.5)\r\n\t\t\t\t\t\t\tvar h = parseFloat( color[ 1 ] ) / 360;\r\n\t\t\t\t\t\t\tvar s = parseInt( color[ 2 ], 10 ) / 100;\r\n\t\t\t\t\t\t\tvar l = parseInt( color[ 3 ], 10 ) / 100;\r\n\r\n\t\t\t\t\t\t\thandleAlpha( color[ 5 ] );\r\n\r\n\t\t\t\t\t\t\treturn this.setHSL( h, s, l );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( m = /^\\#([A-Fa-f0-9]+)$/.exec( style ) ) {\r\n\r\n\t\t\t\t// hex color\r\n\r\n\t\t\t\tvar hex = m[ 1 ];\r\n\t\t\t\tvar size = hex.length;\r\n\r\n\t\t\t\tif ( size === 3 ) {\r\n\r\n\t\t\t\t\t// #ff0\r\n\t\t\t\t\tthis.r = parseInt( hex.charAt( 0 ) + hex.charAt( 0 ), 16 ) / 255;\r\n\t\t\t\t\tthis.g = parseInt( hex.charAt( 1 ) + hex.charAt( 1 ), 16 ) / 255;\r\n\t\t\t\t\tthis.b = parseInt( hex.charAt( 2 ) + hex.charAt( 2 ), 16 ) / 255;\r\n\r\n\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t} else if ( size === 6 ) {\r\n\r\n\t\t\t\t\t// #ff0000\r\n\t\t\t\t\tthis.r = parseInt( hex.charAt( 0 ) + hex.charAt( 1 ), 16 ) / 255;\r\n\t\t\t\t\tthis.g = parseInt( hex.charAt( 2 ) + hex.charAt( 3 ), 16 ) / 255;\r\n\t\t\t\t\tthis.b = parseInt( hex.charAt( 4 ) + hex.charAt( 5 ), 16 ) / 255;\r\n\r\n\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( style && style.length > 0 ) {\r\n\r\n\t\t\t\t// color keywords\r\n\t\t\t\tvar hex = ColorKeywords[ style ];\r\n\r\n\t\t\t\tif ( hex !== undefined ) {\r\n\r\n\t\t\t\t\t// red\r\n\t\t\t\t\tthis.setHex( hex );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// unknown color\r\n\t\t\t\t\tconsole.warn( 'THREE.Color: Unknown color ' + style );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor( this.r, this.g, this.b );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( color ) {\r\n\r\n\t\t\tthis.r = color.r;\r\n\t\t\tthis.g = color.g;\r\n\t\t\tthis.b = color.b;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcopyGammaToLinear: function ( color, gammaFactor ) {\r\n\r\n\t\t\tif ( gammaFactor === undefined ) gammaFactor = 2.0;\r\n\r\n\t\t\tthis.r = Math.pow( color.r, gammaFactor );\r\n\t\t\tthis.g = Math.pow( color.g, gammaFactor );\r\n\t\t\tthis.b = Math.pow( color.b, gammaFactor );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcopyLinearToGamma: function ( color, gammaFactor ) {\r\n\r\n\t\t\tif ( gammaFactor === undefined ) gammaFactor = 2.0;\r\n\r\n\t\t\tvar safeInverse = ( gammaFactor > 0 ) ? ( 1.0 / gammaFactor ) : 1.0;\r\n\r\n\t\t\tthis.r = Math.pow( color.r, safeInverse );\r\n\t\t\tthis.g = Math.pow( color.g, safeInverse );\r\n\t\t\tthis.b = Math.pow( color.b, safeInverse );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tconvertGammaToLinear: function ( gammaFactor ) {\r\n\r\n\t\t\tthis.copyGammaToLinear( this, gammaFactor );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tconvertLinearToGamma: function ( gammaFactor ) {\r\n\r\n\t\t\tthis.copyLinearToGamma( this, gammaFactor );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcopySRGBToLinear: function () {\r\n\r\n\t\t\tfunction SRGBToLinear( c ) {\r\n\r\n\t\t\t\treturn ( c < 0.04045 ) ? c * 0.0773993808 : Math.pow( c * 0.9478672986 + 0.0521327014, 2.4 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn function copySRGBToLinear( color ) {\r\n\r\n\t\t\t\tthis.r = SRGBToLinear( color.r );\r\n\t\t\t\tthis.g = SRGBToLinear( color.g );\r\n\t\t\t\tthis.b = SRGBToLinear( color.b );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tcopyLinearToSRGB: function () {\r\n\r\n\t\t\tfunction LinearToSRGB( c ) {\r\n\r\n\t\t\t\treturn ( c < 0.0031308 ) ? c * 12.92 : 1.055 * ( Math.pow( c, 0.41666 ) ) - 0.055;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn function copyLinearToSRGB( color ) {\r\n\r\n\t\t\t\tthis.r = LinearToSRGB( color.r );\r\n\t\t\t\tthis.g = LinearToSRGB( color.g );\r\n\t\t\t\tthis.b = LinearToSRGB( color.b );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tconvertSRGBToLinear: function () {\r\n\r\n\t\t\tthis.copySRGBToLinear( this );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tconvertLinearToSRGB: function () {\r\n\r\n\t\t\tthis.copyLinearToSRGB( this );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetHex: function () {\r\n\r\n\t\t\treturn ( this.r * 255 ) << 16 ^ ( this.g * 255 ) << 8 ^ ( this.b * 255 ) << 0;\r\n\r\n\t\t},\r\n\r\n\t\tgetHexString: function () {\r\n\r\n\t\t\treturn ( '000000' + this.getHex().toString( 16 ) ).slice( - 6 );\r\n\r\n\t\t},\r\n\r\n\t\tgetHSL: function ( target ) {\r\n\r\n\t\t\t// h,s,l ranges are in 0.0 - 1.0\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Color: .getHSL() target is now required' );\r\n\t\t\t\ttarget = { h: 0, s: 0, l: 0 };\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar r = this.r, g = this.g, b = this.b;\r\n\r\n\t\t\tvar max = Math.max( r, g, b );\r\n\t\t\tvar min = Math.min( r, g, b );\r\n\r\n\t\t\tvar hue, saturation;\r\n\t\t\tvar lightness = ( min + max ) / 2.0;\r\n\r\n\t\t\tif ( min === max ) {\r\n\r\n\t\t\t\thue = 0;\r\n\t\t\t\tsaturation = 0;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvar delta = max - min;\r\n\r\n\t\t\t\tsaturation = lightness <= 0.5 ? delta / ( max + min ) : delta / ( 2 - max - min );\r\n\r\n\t\t\t\tswitch ( max ) {\r\n\r\n\t\t\t\t\tcase r: hue = ( g - b ) / delta + ( g < b ? 6 : 0 ); break;\r\n\t\t\t\t\tcase g: hue = ( b - r ) / delta + 2; break;\r\n\t\t\t\t\tcase b: hue = ( r - g ) / delta + 4; break;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\thue /= 6;\r\n\r\n\t\t\t}\r\n\r\n\t\t\ttarget.h = hue;\r\n\t\t\ttarget.s = saturation;\r\n\t\t\ttarget.l = lightness;\r\n\r\n\t\t\treturn target;\r\n\r\n\t\t},\r\n\r\n\t\tgetStyle: function () {\r\n\r\n\t\t\treturn 'rgb(' + ( ( this.r * 255 ) | 0 ) + ',' + ( ( this.g * 255 ) | 0 ) + ',' + ( ( this.b * 255 ) | 0 ) + ')';\r\n\r\n\t\t},\r\n\r\n\t\toffsetHSL: function () {\r\n\r\n\t\t\tvar hsl = {};\r\n\r\n\t\t\treturn function ( h, s, l ) {\r\n\r\n\t\t\t\tthis.getHSL( hsl );\r\n\r\n\t\t\t\thsl.h += h; hsl.s += s; hsl.l += l;\r\n\r\n\t\t\t\tthis.setHSL( hsl.h, hsl.s, hsl.l );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tadd: function ( color ) {\r\n\r\n\t\t\tthis.r += color.r;\r\n\t\t\tthis.g += color.g;\r\n\t\t\tthis.b += color.b;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\taddColors: function ( color1, color2 ) {\r\n\r\n\t\t\tthis.r = color1.r + color2.r;\r\n\t\t\tthis.g = color1.g + color2.g;\r\n\t\t\tthis.b = color1.b + color2.b;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\taddScalar: function ( s ) {\r\n\r\n\t\t\tthis.r += s;\r\n\t\t\tthis.g += s;\r\n\t\t\tthis.b += s;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsub: function ( color ) {\r\n\r\n\t\t\tthis.r = Math.max( 0, this.r - color.r );\r\n\t\t\tthis.g = Math.max( 0, this.g - color.g );\r\n\t\t\tthis.b = Math.max( 0, this.b - color.b );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmultiply: function ( color ) {\r\n\r\n\t\t\tthis.r *= color.r;\r\n\t\t\tthis.g *= color.g;\r\n\t\t\tthis.b *= color.b;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmultiplyScalar: function ( s ) {\r\n\r\n\t\t\tthis.r *= s;\r\n\t\t\tthis.g *= s;\r\n\t\t\tthis.b *= s;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tlerp: function ( color, alpha ) {\r\n\r\n\t\t\tthis.r += ( color.r - this.r ) * alpha;\r\n\t\t\tthis.g += ( color.g - this.g ) * alpha;\r\n\t\t\tthis.b += ( color.b - this.b ) * alpha;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tlerpHSL: function () {\r\n\r\n\t\t\tvar hslA = { h: 0, s: 0, l: 0 };\r\n\t\t\tvar hslB = { h: 0, s: 0, l: 0 };\r\n\r\n\t\t\treturn function lerpHSL( color, alpha ) {\r\n\r\n\t\t\t\tthis.getHSL( hslA );\r\n\t\t\t\tcolor.getHSL( hslB );\r\n\r\n\t\t\t\tvar h = _Math.lerp( hslA.h, hslB.h, alpha );\r\n\t\t\t\tvar s = _Math.lerp( hslA.s, hslB.s, alpha );\r\n\t\t\t\tvar l = _Math.lerp( hslA.l, hslB.l, alpha );\r\n\r\n\t\t\t\tthis.setHSL( h, s, l );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tequals: function ( c ) {\r\n\r\n\t\t\treturn ( c.r === this.r ) && ( c.g === this.g ) && ( c.b === this.b );\r\n\r\n\t\t},\r\n\r\n\t\tfromArray: function ( array, offset ) {\r\n\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\t\tthis.r = array[ offset ];\r\n\t\t\tthis.g = array[ offset + 1 ];\r\n\t\t\tthis.b = array[ offset + 2 ];\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoArray: function ( array, offset ) {\r\n\r\n\t\t\tif ( array === undefined ) array = [];\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\t\tarray[ offset ] = this.r;\r\n\t\t\tarray[ offset + 1 ] = this.g;\r\n\t\t\tarray[ offset + 2 ] = this.b;\r\n\r\n\t\t\treturn array;\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function () {\r\n\r\n\t\t\treturn this.getHex();\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * Uniforms library for shared webgl shaders\r\n\t */\r\n\r\n\tvar UniformsLib = {\r\n\r\n\t\tcommon: {\r\n\r\n\t\t\tdiffuse: { value: new Color( 0xeeeeee ) },\r\n\t\t\topacity: { value: 1.0 },\r\n\r\n\t\t\tmap: { value: null },\r\n\t\t\tuvTransform: { value: new Matrix3() },\r\n\r\n\t\t\talphaMap: { value: null },\r\n\r\n\t\t},\r\n\r\n\t\tspecularmap: {\r\n\r\n\t\t\tspecularMap: { value: null },\r\n\r\n\t\t},\r\n\r\n\t\tenvmap: {\r\n\r\n\t\t\tenvMap: { value: null },\r\n\t\t\tflipEnvMap: { value: - 1 },\r\n\t\t\treflectivity: { value: 1.0 },\r\n\t\t\trefractionRatio: { value: 0.98 },\r\n\t\t\tmaxMipLevel: { value: 0 }\r\n\r\n\t\t},\r\n\r\n\t\taomap: {\r\n\r\n\t\t\taoMap: { value: null },\r\n\t\t\taoMapIntensity: { value: 1 }\r\n\r\n\t\t},\r\n\r\n\t\tlightmap: {\r\n\r\n\t\t\tlightMap: { value: null },\r\n\t\t\tlightMapIntensity: { value: 1 }\r\n\r\n\t\t},\r\n\r\n\t\temissivemap: {\r\n\r\n\t\t\temissiveMap: { value: null }\r\n\r\n\t\t},\r\n\r\n\t\tbumpmap: {\r\n\r\n\t\t\tbumpMap: { value: null },\r\n\t\t\tbumpScale: { value: 1 }\r\n\r\n\t\t},\r\n\r\n\t\tnormalmap: {\r\n\r\n\t\t\tnormalMap: { value: null },\r\n\t\t\tnormalScale: { value: new Vector2( 1, 1 ) }\r\n\r\n\t\t},\r\n\r\n\t\tdisplacementmap: {\r\n\r\n\t\t\tdisplacementMap: { value: null },\r\n\t\t\tdisplacementScale: { value: 1 },\r\n\t\t\tdisplacementBias: { value: 0 }\r\n\r\n\t\t},\r\n\r\n\t\troughnessmap: {\r\n\r\n\t\t\troughnessMap: { value: null }\r\n\r\n\t\t},\r\n\r\n\t\tmetalnessmap: {\r\n\r\n\t\t\tmetalnessMap: { value: null }\r\n\r\n\t\t},\r\n\r\n\t\tgradientmap: {\r\n\r\n\t\t\tgradientMap: { value: null }\r\n\r\n\t\t},\r\n\r\n\t\tfog: {\r\n\r\n\t\t\tfogDensity: { value: 0.00025 },\r\n\t\t\tfogNear: { value: 1 },\r\n\t\t\tfogFar: { value: 2000 },\r\n\t\t\tfogColor: { value: new Color( 0xffffff ) }\r\n\r\n\t\t},\r\n\r\n\t\tlights: {\r\n\r\n\t\t\tambientLightColor: { value: [] },\r\n\r\n\t\t\tdirectionalLights: { value: [], properties: {\r\n\t\t\t\tdirection: {},\r\n\t\t\t\tcolor: {},\r\n\r\n\t\t\t\tshadow: {},\r\n\t\t\t\tshadowBias: {},\r\n\t\t\t\tshadowRadius: {},\r\n\t\t\t\tshadowMapSize: {}\r\n\t\t\t} },\r\n\r\n\t\t\tdirectionalShadowMap: { value: [] },\r\n\t\t\tdirectionalShadowMatrix: { value: [] },\r\n\r\n\t\t\tspotLights: { value: [], properties: {\r\n\t\t\t\tcolor: {},\r\n\t\t\t\tposition: {},\r\n\t\t\t\tdirection: {},\r\n\t\t\t\tdistance: {},\r\n\t\t\t\tconeCos: {},\r\n\t\t\t\tpenumbraCos: {},\r\n\t\t\t\tdecay: {},\r\n\r\n\t\t\t\tshadow: {},\r\n\t\t\t\tshadowBias: {},\r\n\t\t\t\tshadowRadius: {},\r\n\t\t\t\tshadowMapSize: {}\r\n\t\t\t} },\r\n\r\n\t\t\tspotShadowMap: { value: [] },\r\n\t\t\tspotShadowMatrix: { value: [] },\r\n\r\n\t\t\tpointLights: { value: [], properties: {\r\n\t\t\t\tcolor: {},\r\n\t\t\t\tposition: {},\r\n\t\t\t\tdecay: {},\r\n\t\t\t\tdistance: {},\r\n\r\n\t\t\t\tshadow: {},\r\n\t\t\t\tshadowBias: {},\r\n\t\t\t\tshadowRadius: {},\r\n\t\t\t\tshadowMapSize: {},\r\n\t\t\t\tshadowCameraNear: {},\r\n\t\t\t\tshadowCameraFar: {}\r\n\t\t\t} },\r\n\r\n\t\t\tpointShadowMap: { value: [] },\r\n\t\t\tpointShadowMatrix: { value: [] },\r\n\r\n\t\t\themisphereLights: { value: [], properties: {\r\n\t\t\t\tdirection: {},\r\n\t\t\t\tskyColor: {},\r\n\t\t\t\tgroundColor: {}\r\n\t\t\t} },\r\n\r\n\t\t\t// TODO (abelnation): RectAreaLight BRDF data needs to be moved from example to main src\r\n\t\t\trectAreaLights: { value: [], properties: {\r\n\t\t\t\tcolor: {},\r\n\t\t\t\tposition: {},\r\n\t\t\t\twidth: {},\r\n\t\t\t\theight: {}\r\n\t\t\t} }\r\n\r\n\t\t},\r\n\r\n\t\tpoints: {\r\n\r\n\t\t\tdiffuse: { value: new Color( 0xeeeeee ) },\r\n\t\t\topacity: { value: 1.0 },\r\n\t\t\tsize: { value: 1.0 },\r\n\t\t\tscale: { value: 1.0 },\r\n\t\t\tmap: { value: null },\r\n\t\t\tuvTransform: { value: new Matrix3() }\r\n\r\n\t\t},\r\n\r\n\t\tsprite: {\r\n\r\n\t\t\tdiffuse: { value: new Color( 0xeeeeee ) },\r\n\t\t\topacity: { value: 1.0 },\r\n\t\t\tcenter: { value: new Vector2( 0.5, 0.5 ) },\r\n\t\t\trotation: { value: 0.0 },\r\n\t\t\tmap: { value: null },\r\n\t\t\tuvTransform: { value: new Matrix3() }\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t */\r\n\r\n\tvar ShaderLib = {\r\n\r\n\t\tbasic: {\r\n\r\n\t\t\tuniforms: UniformsUtils.merge( [\r\n\t\t\t\tUniformsLib.common,\r\n\t\t\t\tUniformsLib.specularmap,\r\n\t\t\t\tUniformsLib.envmap,\r\n\t\t\t\tUniformsLib.aomap,\r\n\t\t\t\tUniformsLib.lightmap,\r\n\t\t\t\tUniformsLib.fog\r\n\t\t\t] ),\r\n\r\n\t\t\tvertexShader: ShaderChunk.meshbasic_vert,\r\n\t\t\tfragmentShader: ShaderChunk.meshbasic_frag\r\n\r\n\t\t},\r\n\r\n\t\tlambert: {\r\n\r\n\t\t\tuniforms: UniformsUtils.merge( [\r\n\t\t\t\tUniformsLib.common,\r\n\t\t\t\tUniformsLib.specularmap,\r\n\t\t\t\tUniformsLib.envmap,\r\n\t\t\t\tUniformsLib.aomap,\r\n\t\t\t\tUniformsLib.lightmap,\r\n\t\t\t\tUniformsLib.emissivemap,\r\n\t\t\t\tUniformsLib.fog,\r\n\t\t\t\tUniformsLib.lights,\r\n\t\t\t\t{\r\n\t\t\t\t\temissive: { value: new Color( 0x000000 ) }\r\n\t\t\t\t}\r\n\t\t\t] ),\r\n\r\n\t\t\tvertexShader: ShaderChunk.meshlambert_vert,\r\n\t\t\tfragmentShader: ShaderChunk.meshlambert_frag\r\n\r\n\t\t},\r\n\r\n\t\tphong: {\r\n\r\n\t\t\tuniforms: UniformsUtils.merge( [\r\n\t\t\t\tUniformsLib.common,\r\n\t\t\t\tUniformsLib.specularmap,\r\n\t\t\t\tUniformsLib.envmap,\r\n\t\t\t\tUniformsLib.aomap,\r\n\t\t\t\tUniformsLib.lightmap,\r\n\t\t\t\tUniformsLib.emissivemap,\r\n\t\t\t\tUniformsLib.bumpmap,\r\n\t\t\t\tUniformsLib.normalmap,\r\n\t\t\t\tUniformsLib.displacementmap,\r\n\t\t\t\tUniformsLib.gradientmap,\r\n\t\t\t\tUniformsLib.fog,\r\n\t\t\t\tUniformsLib.lights,\r\n\t\t\t\t{\r\n\t\t\t\t\temissive: { value: new Color( 0x000000 ) },\r\n\t\t\t\t\tspecular: { value: new Color( 0x111111 ) },\r\n\t\t\t\t\tshininess: { value: 30 }\r\n\t\t\t\t}\r\n\t\t\t] ),\r\n\r\n\t\t\tvertexShader: ShaderChunk.meshphong_vert,\r\n\t\t\tfragmentShader: ShaderChunk.meshphong_frag\r\n\r\n\t\t},\r\n\r\n\t\tstandard: {\r\n\r\n\t\t\tuniforms: UniformsUtils.merge( [\r\n\t\t\t\tUniformsLib.common,\r\n\t\t\t\tUniformsLib.envmap,\r\n\t\t\t\tUniformsLib.aomap,\r\n\t\t\t\tUniformsLib.lightmap,\r\n\t\t\t\tUniformsLib.emissivemap,\r\n\t\t\t\tUniformsLib.bumpmap,\r\n\t\t\t\tUniformsLib.normalmap,\r\n\t\t\t\tUniformsLib.displacementmap,\r\n\t\t\t\tUniformsLib.roughnessmap,\r\n\t\t\t\tUniformsLib.metalnessmap,\r\n\t\t\t\tUniformsLib.fog,\r\n\t\t\t\tUniformsLib.lights,\r\n\t\t\t\t{\r\n\t\t\t\t\temissive: { value: new Color( 0x000000 ) },\r\n\t\t\t\t\troughness: { value: 0.5 },\r\n\t\t\t\t\tmetalness: { value: 0.5 },\r\n\t\t\t\t\tenvMapIntensity: { value: 1 } // temporary\r\n\t\t\t\t}\r\n\t\t\t] ),\r\n\r\n\t\t\tvertexShader: ShaderChunk.meshphysical_vert,\r\n\t\t\tfragmentShader: ShaderChunk.meshphysical_frag\r\n\r\n\t\t},\r\n\r\n\t\tpoints: {\r\n\r\n\t\t\tuniforms: UniformsUtils.merge( [\r\n\t\t\t\tUniformsLib.points,\r\n\t\t\t\tUniformsLib.fog\r\n\t\t\t] ),\r\n\r\n\t\t\tvertexShader: ShaderChunk.points_vert,\r\n\t\t\tfragmentShader: ShaderChunk.points_frag\r\n\r\n\t\t},\r\n\r\n\t\tdashed: {\r\n\r\n\t\t\tuniforms: UniformsUtils.merge( [\r\n\t\t\t\tUniformsLib.common,\r\n\t\t\t\tUniformsLib.fog,\r\n\t\t\t\t{\r\n\t\t\t\t\tscale: { value: 1 },\r\n\t\t\t\t\tdashSize: { value: 1 },\r\n\t\t\t\t\ttotalSize: { value: 2 }\r\n\t\t\t\t}\r\n\t\t\t] ),\r\n\r\n\t\t\tvertexShader: ShaderChunk.linedashed_vert,\r\n\t\t\tfragmentShader: ShaderChunk.linedashed_frag\r\n\r\n\t\t},\r\n\r\n\t\tdepth: {\r\n\r\n\t\t\tuniforms: UniformsUtils.merge( [\r\n\t\t\t\tUniformsLib.common,\r\n\t\t\t\tUniformsLib.displacementmap\r\n\t\t\t] ),\r\n\r\n\t\t\tvertexShader: ShaderChunk.depth_vert,\r\n\t\t\tfragmentShader: ShaderChunk.depth_frag\r\n\r\n\t\t},\r\n\r\n\t\tnormal: {\r\n\r\n\t\t\tuniforms: UniformsUtils.merge( [\r\n\t\t\t\tUniformsLib.common,\r\n\t\t\t\tUniformsLib.bumpmap,\r\n\t\t\t\tUniformsLib.normalmap,\r\n\t\t\t\tUniformsLib.displacementmap,\r\n\t\t\t\t{\r\n\t\t\t\t\topacity: { value: 1.0 }\r\n\t\t\t\t}\r\n\t\t\t] ),\r\n\r\n\t\t\tvertexShader: ShaderChunk.normal_vert,\r\n\t\t\tfragmentShader: ShaderChunk.normal_frag\r\n\r\n\t\t},\r\n\r\n\t\tsprite: {\r\n\r\n\t\t\tuniforms: UniformsUtils.merge( [\r\n\t\t\t\tUniformsLib.sprite,\r\n\t\t\t\tUniformsLib.fog\r\n\t\t\t] ),\r\n\r\n\t\t\tvertexShader: ShaderChunk.sprite_vert,\r\n\t\t\tfragmentShader: ShaderChunk.sprite_frag\r\n\r\n\t\t},\r\n\r\n\t\t/* -------------------------------------------------------------------------\r\n\t\t//\tCube map shader\r\n\t\t ------------------------------------------------------------------------- */\r\n\r\n\t\tcube: {\r\n\r\n\t\t\tuniforms: {\r\n\t\t\t\ttCube: { value: null },\r\n\t\t\t\ttFlip: { value: - 1 },\r\n\t\t\t\topacity: { value: 1.0 }\r\n\t\t\t},\r\n\r\n\t\t\tvertexShader: ShaderChunk.cube_vert,\r\n\t\t\tfragmentShader: ShaderChunk.cube_frag\r\n\r\n\t\t},\r\n\r\n\t\tequirect: {\r\n\r\n\t\t\tuniforms: {\r\n\t\t\t\ttEquirect: { value: null },\r\n\t\t\t},\r\n\r\n\t\t\tvertexShader: ShaderChunk.equirect_vert,\r\n\t\t\tfragmentShader: ShaderChunk.equirect_frag\r\n\r\n\t\t},\r\n\r\n\t\tdistanceRGBA: {\r\n\r\n\t\t\tuniforms: UniformsUtils.merge( [\r\n\t\t\t\tUniformsLib.common,\r\n\t\t\t\tUniformsLib.displacementmap,\r\n\t\t\t\t{\r\n\t\t\t\t\treferencePosition: { value: new Vector3() },\r\n\t\t\t\t\tnearDistance: { value: 1 },\r\n\t\t\t\t\tfarDistance: { value: 1000 }\r\n\t\t\t\t}\r\n\t\t\t] ),\r\n\r\n\t\t\tvertexShader: ShaderChunk.distanceRGBA_vert,\r\n\t\t\tfragmentShader: ShaderChunk.distanceRGBA_frag\r\n\r\n\t\t},\r\n\r\n\t\tshadow: {\r\n\r\n\t\t\tuniforms: UniformsUtils.merge( [\r\n\t\t\t\tUniformsLib.lights,\r\n\t\t\t\tUniformsLib.fog,\r\n\t\t\t\t{\r\n\t\t\t\t\tcolor: { value: new Color( 0x00000 ) },\r\n\t\t\t\t\topacity: { value: 1.0 }\r\n\t\t\t\t},\r\n\t\t\t] ),\r\n\r\n\t\t\tvertexShader: ShaderChunk.shadow_vert,\r\n\t\t\tfragmentShader: ShaderChunk.shadow_frag\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tShaderLib.physical = {\r\n\r\n\t\tuniforms: UniformsUtils.merge( [\r\n\t\t\tShaderLib.standard.uniforms,\r\n\t\t\t{\r\n\t\t\t\tclearCoat: { value: 0 },\r\n\t\t\t\tclearCoatRoughness: { value: 0 }\r\n\t\t\t}\r\n\t\t] ),\r\n\r\n\t\tvertexShader: ShaderChunk.meshphysical_vert,\r\n\t\tfragmentShader: ShaderChunk.meshphysical_frag\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction WebGLAnimation() {\r\n\r\n\t\tvar context = null;\r\n\t\tvar isAnimating = false;\r\n\t\tvar animationLoop = null;\r\n\r\n\t\tfunction onAnimationFrame( time, frame ) {\r\n\r\n\t\t\tif ( isAnimating === false ) return;\r\n\r\n\t\t\tanimationLoop( time, frame );\r\n\r\n\t\t\tcontext.requestAnimationFrame( onAnimationFrame );\r\n\r\n\t\t}\r\n\r\n\t\treturn {\r\n\r\n\t\t\tstart: function () {\r\n\r\n\t\t\t\tif ( isAnimating === true ) return;\r\n\t\t\t\tif ( animationLoop === null ) return;\r\n\r\n\t\t\t\tcontext.requestAnimationFrame( onAnimationFrame );\r\n\r\n\t\t\t\tisAnimating = true;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tstop: function () {\r\n\r\n\t\t\t\tisAnimating = false;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tsetAnimationLoop: function ( callback ) {\r\n\r\n\t\t\t\tanimationLoop = callback;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tsetContext: function ( value ) {\r\n\r\n\t\t\t\tcontext = value;\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction WebGLAttributes( gl ) {\r\n\r\n\t\tvar buffers = new WeakMap();\r\n\r\n\t\tfunction createBuffer( attribute, bufferType ) {\r\n\r\n\t\t\tvar array = attribute.array;\r\n\t\t\tvar usage = attribute.dynamic ? gl.DYNAMIC_DRAW : gl.STATIC_DRAW;\r\n\r\n\t\t\tvar buffer = gl.createBuffer();\r\n\r\n\t\t\tgl.bindBuffer( bufferType, buffer );\r\n\t\t\tgl.bufferData( bufferType, array, usage );\r\n\r\n\t\t\tattribute.onUploadCallback();\r\n\r\n\t\t\tvar type = gl.FLOAT;\r\n\r\n\t\t\tif ( array instanceof Float32Array ) {\r\n\r\n\t\t\t\ttype = gl.FLOAT;\r\n\r\n\t\t\t} else if ( array instanceof Float64Array ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLAttributes: Unsupported data buffer format: Float64Array.' );\r\n\r\n\t\t\t} else if ( array instanceof Uint16Array ) {\r\n\r\n\t\t\t\ttype = gl.UNSIGNED_SHORT;\r\n\r\n\t\t\t} else if ( array instanceof Int16Array ) {\r\n\r\n\t\t\t\ttype = gl.SHORT;\r\n\r\n\t\t\t} else if ( array instanceof Uint32Array ) {\r\n\r\n\t\t\t\ttype = gl.UNSIGNED_INT;\r\n\r\n\t\t\t} else if ( array instanceof Int32Array ) {\r\n\r\n\t\t\t\ttype = gl.INT;\r\n\r\n\t\t\t} else if ( array instanceof Int8Array ) {\r\n\r\n\t\t\t\ttype = gl.BYTE;\r\n\r\n\t\t\t} else if ( array instanceof Uint8Array ) {\r\n\r\n\t\t\t\ttype = gl.UNSIGNED_BYTE;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn {\r\n\t\t\t\tbuffer: buffer,\r\n\t\t\t\ttype: type,\r\n\t\t\t\tbytesPerElement: array.BYTES_PER_ELEMENT,\r\n\t\t\t\tversion: attribute.version\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t\tfunction updateBuffer( buffer, attribute, bufferType ) {\r\n\r\n\t\t\tvar array = attribute.array;\r\n\t\t\tvar updateRange = attribute.updateRange;\r\n\r\n\t\t\tgl.bindBuffer( bufferType, buffer );\r\n\r\n\t\t\tif ( attribute.dynamic === false ) {\r\n\r\n\t\t\t\tgl.bufferData( bufferType, array, gl.STATIC_DRAW );\r\n\r\n\t\t\t} else if ( updateRange.count === - 1 ) {\r\n\r\n\t\t\t\t// Not using update ranges\r\n\r\n\t\t\t\tgl.bufferSubData( bufferType, 0, array );\r\n\r\n\t\t\t} else if ( updateRange.count === 0 ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually.' );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tgl.bufferSubData( bufferType, updateRange.offset * array.BYTES_PER_ELEMENT,\r\n\t\t\t\t\tarray.subarray( updateRange.offset, updateRange.offset + updateRange.count ) );\r\n\r\n\t\t\t\tupdateRange.count = - 1; // reset range\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tfunction get( attribute ) {\r\n\r\n\t\t\tif ( attribute.isInterleavedBufferAttribute ) attribute = attribute.data;\r\n\r\n\t\t\treturn buffers.get( attribute );\r\n\r\n\t\t}\r\n\r\n\t\tfunction remove( attribute ) {\r\n\r\n\t\t\tif ( attribute.isInterleavedBufferAttribute ) attribute = attribute.data;\r\n\r\n\t\t\tvar data = buffers.get( attribute );\r\n\r\n\t\t\tif ( data ) {\r\n\r\n\t\t\t\tgl.deleteBuffer( data.buffer );\r\n\r\n\t\t\t\tbuffers.delete( attribute );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction update( attribute, bufferType ) {\r\n\r\n\t\t\tif ( attribute.isInterleavedBufferAttribute ) attribute = attribute.data;\r\n\r\n\t\t\tvar data = buffers.get( attribute );\r\n\r\n\t\t\tif ( data === undefined ) {\r\n\r\n\t\t\t\tbuffers.set( attribute, createBuffer( attribute, bufferType ) );\r\n\r\n\t\t\t} else if ( data.version < attribute.version ) {\r\n\r\n\t\t\t\tupdateBuffer( data.buffer, attribute, bufferType );\r\n\r\n\t\t\t\tdata.version = attribute.version;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn {\r\n\r\n\t\t\tget: get,\r\n\t\t\tremove: remove,\r\n\t\t\tupdate: update\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t * @author bhouston / http://clara.io\r\n\t */\r\n\r\n\tfunction Euler( x, y, z, order ) {\r\n\r\n\t\tthis._x = x || 0;\r\n\t\tthis._y = y || 0;\r\n\t\tthis._z = z || 0;\r\n\t\tthis._order = order || Euler.DefaultOrder;\r\n\r\n\t}\r\n\r\n\tEuler.RotationOrders = [ 'XYZ', 'YZX', 'ZXY', 'XZY', 'YXZ', 'ZYX' ];\r\n\r\n\tEuler.DefaultOrder = 'XYZ';\r\n\r\n\tObject.defineProperties( Euler.prototype, {\r\n\r\n\t\tx: {\r\n\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\treturn this._x;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tthis._x = value;\r\n\t\t\t\tthis.onChangeCallback();\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\ty: {\r\n\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\treturn this._y;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tthis._y = value;\r\n\t\t\t\tthis.onChangeCallback();\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tz: {\r\n\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\treturn this._z;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tthis._z = value;\r\n\t\t\t\tthis.onChangeCallback();\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\torder: {\r\n\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\treturn this._order;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tthis._order = value;\r\n\t\t\t\tthis.onChangeCallback();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( Euler.prototype, {\r\n\r\n\t\tisEuler: true,\r\n\r\n\t\tset: function ( x, y, z, order ) {\r\n\r\n\t\t\tthis._x = x;\r\n\t\t\tthis._y = y;\r\n\t\t\tthis._z = z;\r\n\t\t\tthis._order = order || this._order;\r\n\r\n\t\t\tthis.onChangeCallback();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor( this._x, this._y, this._z, this._order );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( euler ) {\r\n\r\n\t\t\tthis._x = euler._x;\r\n\t\t\tthis._y = euler._y;\r\n\t\t\tthis._z = euler._z;\r\n\t\t\tthis._order = euler._order;\r\n\r\n\t\t\tthis.onChangeCallback();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromRotationMatrix: function ( m, order, update ) {\r\n\r\n\t\t\tvar clamp = _Math.clamp;\r\n\r\n\t\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\r\n\t\t\tvar te = m.elements;\r\n\t\t\tvar m11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ];\r\n\t\t\tvar m21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ];\r\n\t\t\tvar m31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ];\r\n\r\n\t\t\torder = order || this._order;\r\n\r\n\t\t\tif ( order === 'XYZ' ) {\r\n\r\n\t\t\t\tthis._y = Math.asin( clamp( m13, - 1, 1 ) );\r\n\r\n\t\t\t\tif ( Math.abs( m13 ) < 0.99999 ) {\r\n\r\n\t\t\t\t\tthis._x = Math.atan2( - m23, m33 );\r\n\t\t\t\t\tthis._z = Math.atan2( - m12, m11 );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tthis._x = Math.atan2( m32, m22 );\r\n\t\t\t\t\tthis._z = 0;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( order === 'YXZ' ) {\r\n\r\n\t\t\t\tthis._x = Math.asin( - clamp( m23, - 1, 1 ) );\r\n\r\n\t\t\t\tif ( Math.abs( m23 ) < 0.99999 ) {\r\n\r\n\t\t\t\t\tthis._y = Math.atan2( m13, m33 );\r\n\t\t\t\t\tthis._z = Math.atan2( m21, m22 );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tthis._y = Math.atan2( - m31, m11 );\r\n\t\t\t\t\tthis._z = 0;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( order === 'ZXY' ) {\r\n\r\n\t\t\t\tthis._x = Math.asin( clamp( m32, - 1, 1 ) );\r\n\r\n\t\t\t\tif ( Math.abs( m32 ) < 0.99999 ) {\r\n\r\n\t\t\t\t\tthis._y = Math.atan2( - m31, m33 );\r\n\t\t\t\t\tthis._z = Math.atan2( - m12, m22 );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tthis._y = 0;\r\n\t\t\t\t\tthis._z = Math.atan2( m21, m11 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( order === 'ZYX' ) {\r\n\r\n\t\t\t\tthis._y = Math.asin( - clamp( m31, - 1, 1 ) );\r\n\r\n\t\t\t\tif ( Math.abs( m31 ) < 0.99999 ) {\r\n\r\n\t\t\t\t\tthis._x = Math.atan2( m32, m33 );\r\n\t\t\t\t\tthis._z = Math.atan2( m21, m11 );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tthis._x = 0;\r\n\t\t\t\t\tthis._z = Math.atan2( - m12, m22 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( order === 'YZX' ) {\r\n\r\n\t\t\t\tthis._z = Math.asin( clamp( m21, - 1, 1 ) );\r\n\r\n\t\t\t\tif ( Math.abs( m21 ) < 0.99999 ) {\r\n\r\n\t\t\t\t\tthis._x = Math.atan2( - m23, m22 );\r\n\t\t\t\t\tthis._y = Math.atan2( - m31, m11 );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tthis._x = 0;\r\n\t\t\t\t\tthis._y = Math.atan2( m13, m33 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( order === 'XZY' ) {\r\n\r\n\t\t\t\tthis._z = Math.asin( - clamp( m12, - 1, 1 ) );\r\n\r\n\t\t\t\tif ( Math.abs( m12 ) < 0.99999 ) {\r\n\r\n\t\t\t\t\tthis._x = Math.atan2( m32, m22 );\r\n\t\t\t\t\tthis._y = Math.atan2( m13, m11 );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tthis._x = Math.atan2( - m23, m33 );\r\n\t\t\t\t\tthis._y = 0;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Euler: .setFromRotationMatrix() given unsupported order: ' + order );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis._order = order;\r\n\r\n\t\t\tif ( update !== false ) this.onChangeCallback();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromQuaternion: function () {\r\n\r\n\t\t\tvar matrix = new Matrix4();\r\n\r\n\t\t\treturn function setFromQuaternion( q, order, update ) {\r\n\r\n\t\t\t\tmatrix.makeRotationFromQuaternion( q );\r\n\r\n\t\t\t\treturn this.setFromRotationMatrix( matrix, order, update );\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tsetFromVector3: function ( v, order ) {\r\n\r\n\t\t\treturn this.set( v.x, v.y, v.z, order || this._order );\r\n\r\n\t\t},\r\n\r\n\t\treorder: function () {\r\n\r\n\t\t\t// WARNING: this discards revolution information -bhouston\r\n\r\n\t\t\tvar q = new Quaternion();\r\n\r\n\t\t\treturn function reorder( newOrder ) {\r\n\r\n\t\t\t\tq.setFromEuler( this );\r\n\r\n\t\t\t\treturn this.setFromQuaternion( q, newOrder );\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tequals: function ( euler ) {\r\n\r\n\t\t\treturn ( euler._x === this._x ) && ( euler._y === this._y ) && ( euler._z === this._z ) && ( euler._order === this._order );\r\n\r\n\t\t},\r\n\r\n\t\tfromArray: function ( array ) {\r\n\r\n\t\t\tthis._x = array[ 0 ];\r\n\t\t\tthis._y = array[ 1 ];\r\n\t\t\tthis._z = array[ 2 ];\r\n\t\t\tif ( array[ 3 ] !== undefined ) this._order = array[ 3 ];\r\n\r\n\t\t\tthis.onChangeCallback();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoArray: function ( array, offset ) {\r\n\r\n\t\t\tif ( array === undefined ) array = [];\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\t\tarray[ offset ] = this._x;\r\n\t\t\tarray[ offset + 1 ] = this._y;\r\n\t\t\tarray[ offset + 2 ] = this._z;\r\n\t\t\tarray[ offset + 3 ] = this._order;\r\n\r\n\t\t\treturn array;\r\n\r\n\t\t},\r\n\r\n\t\ttoVector3: function ( optionalResult ) {\r\n\r\n\t\t\tif ( optionalResult ) {\r\n\r\n\t\t\t\treturn optionalResult.set( this._x, this._y, this._z );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\treturn new Vector3( this._x, this._y, this._z );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tonChange: function ( callback ) {\r\n\r\n\t\t\tthis.onChangeCallback = callback;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tonChangeCallback: function () {}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction Layers() {\r\n\r\n\t\tthis.mask = 1 | 0;\r\n\r\n\t}\r\n\r\n\tObject.assign( Layers.prototype, {\r\n\r\n\t\tset: function ( channel ) {\r\n\r\n\t\t\tthis.mask = 1 << channel | 0;\r\n\r\n\t\t},\r\n\r\n\t\tenable: function ( channel ) {\r\n\r\n\t\t\tthis.mask |= 1 << channel | 0;\r\n\r\n\t\t},\r\n\r\n\t\ttoggle: function ( channel ) {\r\n\r\n\t\t\tthis.mask ^= 1 << channel | 0;\r\n\r\n\t\t},\r\n\r\n\t\tdisable: function ( channel ) {\r\n\r\n\t\t\tthis.mask &= ~ ( 1 << channel | 0 );\r\n\r\n\t\t},\r\n\r\n\t\ttest: function ( layers ) {\r\n\r\n\t\t\treturn ( this.mask & layers.mask ) !== 0;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t * @author elephantatwork / www.elephantatwork.ch\r\n\t */\r\n\r\n\tvar object3DId = 0;\r\n\r\n\tfunction Object3D() {\r\n\r\n\t\tObject.defineProperty( this, 'id', { value: object3DId ++ } );\r\n\r\n\t\tthis.uuid = _Math.generateUUID();\r\n\r\n\t\tthis.name = '';\r\n\t\tthis.type = 'Object3D';\r\n\r\n\t\tthis.parent = null;\r\n\t\tthis.children = [];\r\n\r\n\t\tthis.up = Object3D.DefaultUp.clone();\r\n\r\n\t\tvar position = new Vector3();\r\n\t\tvar rotation = new Euler();\r\n\t\tvar quaternion = new Quaternion();\r\n\t\tvar scale = new Vector3( 1, 1, 1 );\r\n\r\n\t\tfunction onRotationChange() {\r\n\r\n\t\t\tquaternion.setFromEuler( rotation, false );\r\n\r\n\t\t}\r\n\r\n\t\tfunction onQuaternionChange() {\r\n\r\n\t\t\trotation.setFromQuaternion( quaternion, undefined, false );\r\n\r\n\t\t}\r\n\r\n\t\trotation.onChange( onRotationChange );\r\n\t\tquaternion.onChange( onQuaternionChange );\r\n\r\n\t\tObject.defineProperties( this, {\r\n\t\t\tposition: {\r\n\t\t\t\tenumerable: true,\r\n\t\t\t\tvalue: position\r\n\t\t\t},\r\n\t\t\trotation: {\r\n\t\t\t\tenumerable: true,\r\n\t\t\t\tvalue: rotation\r\n\t\t\t},\r\n\t\t\tquaternion: {\r\n\t\t\t\tenumerable: true,\r\n\t\t\t\tvalue: quaternion\r\n\t\t\t},\r\n\t\t\tscale: {\r\n\t\t\t\tenumerable: true,\r\n\t\t\t\tvalue: scale\r\n\t\t\t},\r\n\t\t\tmodelViewMatrix: {\r\n\t\t\t\tvalue: new Matrix4()\r\n\t\t\t},\r\n\t\t\tnormalMatrix: {\r\n\t\t\t\tvalue: new Matrix3()\r\n\t\t\t}\r\n\t\t} );\r\n\r\n\t\tthis.matrix = new Matrix4();\r\n\t\tthis.matrixWorld = new Matrix4();\r\n\r\n\t\tthis.matrixAutoUpdate = Object3D.DefaultMatrixAutoUpdate;\r\n\t\tthis.matrixWorldNeedsUpdate = false;\r\n\r\n\t\tthis.layers = new Layers();\r\n\t\tthis.visible = true;\r\n\r\n\t\tthis.castShadow = false;\r\n\t\tthis.receiveShadow = false;\r\n\r\n\t\tthis.frustumCulled = true;\r\n\t\tthis.renderOrder = 0;\r\n\r\n\t\tthis.userData = {};\r\n\r\n\t}\r\n\r\n\tObject3D.DefaultUp = new Vector3( 0, 1, 0 );\r\n\tObject3D.DefaultMatrixAutoUpdate = true;\r\n\r\n\tObject3D.prototype = Object.assign( Object.create( EventDispatcher.prototype ), {\r\n\r\n\t\tconstructor: Object3D,\r\n\r\n\t\tisObject3D: true,\r\n\r\n\t\tonBeforeRender: function () {},\r\n\t\tonAfterRender: function () {},\r\n\r\n\t\tapplyMatrix: function ( matrix ) {\r\n\r\n\t\t\tthis.matrix.multiplyMatrices( matrix, this.matrix );\r\n\r\n\t\t\tthis.matrix.decompose( this.position, this.quaternion, this.scale );\r\n\r\n\t\t},\r\n\r\n\t\tapplyQuaternion: function ( q ) {\r\n\r\n\t\t\tthis.quaternion.premultiply( q );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetRotationFromAxisAngle: function ( axis, angle ) {\r\n\r\n\t\t\t// assumes axis is normalized\r\n\r\n\t\t\tthis.quaternion.setFromAxisAngle( axis, angle );\r\n\r\n\t\t},\r\n\r\n\t\tsetRotationFromEuler: function ( euler ) {\r\n\r\n\t\t\tthis.quaternion.setFromEuler( euler, true );\r\n\r\n\t\t},\r\n\r\n\t\tsetRotationFromMatrix: function ( m ) {\r\n\r\n\t\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\r\n\t\t\tthis.quaternion.setFromRotationMatrix( m );\r\n\r\n\t\t},\r\n\r\n\t\tsetRotationFromQuaternion: function ( q ) {\r\n\r\n\t\t\t// assumes q is normalized\r\n\r\n\t\t\tthis.quaternion.copy( q );\r\n\r\n\t\t},\r\n\r\n\t\trotateOnAxis: function () {\r\n\r\n\t\t\t// rotate object on axis in object space\r\n\t\t\t// axis is assumed to be normalized\r\n\r\n\t\t\tvar q1 = new Quaternion();\r\n\r\n\t\t\treturn function rotateOnAxis( axis, angle ) {\r\n\r\n\t\t\t\tq1.setFromAxisAngle( axis, angle );\r\n\r\n\t\t\t\tthis.quaternion.multiply( q1 );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\trotateOnWorldAxis: function () {\r\n\r\n\t\t\t// rotate object on axis in world space\r\n\t\t\t// axis is assumed to be normalized\r\n\t\t\t// method assumes no rotated parent\r\n\r\n\t\t\tvar q1 = new Quaternion();\r\n\r\n\t\t\treturn function rotateOnWorldAxis( axis, angle ) {\r\n\r\n\t\t\t\tq1.setFromAxisAngle( axis, angle );\r\n\r\n\t\t\t\tthis.quaternion.premultiply( q1 );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\trotateX: function () {\r\n\r\n\t\t\tvar v1 = new Vector3( 1, 0, 0 );\r\n\r\n\t\t\treturn function rotateX( angle ) {\r\n\r\n\t\t\t\treturn this.rotateOnAxis( v1, angle );\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\trotateY: function () {\r\n\r\n\t\t\tvar v1 = new Vector3( 0, 1, 0 );\r\n\r\n\t\t\treturn function rotateY( angle ) {\r\n\r\n\t\t\t\treturn this.rotateOnAxis( v1, angle );\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\trotateZ: function () {\r\n\r\n\t\t\tvar v1 = new Vector3( 0, 0, 1 );\r\n\r\n\t\t\treturn function rotateZ( angle ) {\r\n\r\n\t\t\t\treturn this.rotateOnAxis( v1, angle );\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\ttranslateOnAxis: function () {\r\n\r\n\t\t\t// translate object by distance along axis in object space\r\n\t\t\t// axis is assumed to be normalized\r\n\r\n\t\t\tvar v1 = new Vector3();\r\n\r\n\t\t\treturn function translateOnAxis( axis, distance ) {\r\n\r\n\t\t\t\tv1.copy( axis ).applyQuaternion( this.quaternion );\r\n\r\n\t\t\t\tthis.position.add( v1.multiplyScalar( distance ) );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\ttranslateX: function () {\r\n\r\n\t\t\tvar v1 = new Vector3( 1, 0, 0 );\r\n\r\n\t\t\treturn function translateX( distance ) {\r\n\r\n\t\t\t\treturn this.translateOnAxis( v1, distance );\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\ttranslateY: function () {\r\n\r\n\t\t\tvar v1 = new Vector3( 0, 1, 0 );\r\n\r\n\t\t\treturn function translateY( distance ) {\r\n\r\n\t\t\t\treturn this.translateOnAxis( v1, distance );\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\ttranslateZ: function () {\r\n\r\n\t\t\tvar v1 = new Vector3( 0, 0, 1 );\r\n\r\n\t\t\treturn function translateZ( distance ) {\r\n\r\n\t\t\t\treturn this.translateOnAxis( v1, distance );\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tlocalToWorld: function ( vector ) {\r\n\r\n\t\t\treturn vector.applyMatrix4( this.matrixWorld );\r\n\r\n\t\t},\r\n\r\n\t\tworldToLocal: function () {\r\n\r\n\t\t\tvar m1 = new Matrix4();\r\n\r\n\t\t\treturn function worldToLocal( vector ) {\r\n\r\n\t\t\t\treturn vector.applyMatrix4( m1.getInverse( this.matrixWorld ) );\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tlookAt: function () {\r\n\r\n\t\t\t// This method does not support objects with rotated and/or translated parent(s)\r\n\r\n\t\t\tvar m1 = new Matrix4();\r\n\t\t\tvar vector = new Vector3();\r\n\r\n\t\t\treturn function lookAt( x, y, z ) {\r\n\r\n\t\t\t\tif ( x.isVector3 ) {\r\n\r\n\t\t\t\t\tvector.copy( x );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tvector.set( x, y, z );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( this.isCamera ) {\r\n\r\n\t\t\t\t\tm1.lookAt( this.position, vector, this.up );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tm1.lookAt( vector, this.position, this.up );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.quaternion.setFromRotationMatrix( m1 );\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tadd: function ( object ) {\r\n\r\n\t\t\tif ( arguments.length > 1 ) {\r\n\r\n\t\t\t\tfor ( var i = 0; i < arguments.length; i ++ ) {\r\n\r\n\t\t\t\t\tthis.add( arguments[ i ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( object === this ) {\r\n\r\n\t\t\t\tconsole.error( \"THREE.Object3D.add: object can't be added as a child of itself.\", object );\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( ( object && object.isObject3D ) ) {\r\n\r\n\t\t\t\tif ( object.parent !== null ) {\r\n\r\n\t\t\t\t\tobject.parent.remove( object );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tobject.parent = this;\r\n\t\t\t\tobject.dispatchEvent( { type: 'added' } );\r\n\r\n\t\t\t\tthis.children.push( object );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconsole.error( \"THREE.Object3D.add: object not an instance of THREE.Object3D.\", object );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tremove: function ( object ) {\r\n\r\n\t\t\tif ( arguments.length > 1 ) {\r\n\r\n\t\t\t\tfor ( var i = 0; i < arguments.length; i ++ ) {\r\n\r\n\t\t\t\t\tthis.remove( arguments[ i ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar index = this.children.indexOf( object );\r\n\r\n\t\t\tif ( index !== - 1 ) {\r\n\r\n\t\t\t\tobject.parent = null;\r\n\r\n\t\t\t\tobject.dispatchEvent( { type: 'removed' } );\r\n\r\n\t\t\t\tthis.children.splice( index, 1 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetObjectById: function ( id ) {\r\n\r\n\t\t\treturn this.getObjectByProperty( 'id', id );\r\n\r\n\t\t},\r\n\r\n\t\tgetObjectByName: function ( name ) {\r\n\r\n\t\t\treturn this.getObjectByProperty( 'name', name );\r\n\r\n\t\t},\r\n\r\n\t\tgetObjectByProperty: function ( name, value ) {\r\n\r\n\t\t\tif ( this[ name ] === value ) return this;\r\n\r\n\t\t\tfor ( var i = 0, l = this.children.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar child = this.children[ i ];\r\n\t\t\t\tvar object = child.getObjectByProperty( name, value );\r\n\r\n\t\t\t\tif ( object !== undefined ) {\r\n\r\n\t\t\t\t\treturn object;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn undefined;\r\n\r\n\t\t},\r\n\r\n\t\tgetWorldPosition: function ( target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Object3D: .getWorldPosition() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.updateMatrixWorld( true );\r\n\r\n\t\t\treturn target.setFromMatrixPosition( this.matrixWorld );\r\n\r\n\t\t},\r\n\r\n\t\tgetWorldQuaternion: function () {\r\n\r\n\t\t\tvar position = new Vector3();\r\n\t\t\tvar scale = new Vector3();\r\n\r\n\t\t\treturn function getWorldQuaternion( target ) {\r\n\r\n\t\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.Object3D: .getWorldQuaternion() target is now required' );\r\n\t\t\t\t\ttarget = new Quaternion();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.updateMatrixWorld( true );\r\n\r\n\t\t\t\tthis.matrixWorld.decompose( position, target, scale );\r\n\r\n\t\t\t\treturn target;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tgetWorldScale: function () {\r\n\r\n\t\t\tvar position = new Vector3();\r\n\t\t\tvar quaternion = new Quaternion();\r\n\r\n\t\t\treturn function getWorldScale( target ) {\r\n\r\n\t\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.Object3D: .getWorldScale() target is now required' );\r\n\t\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.updateMatrixWorld( true );\r\n\r\n\t\t\t\tthis.matrixWorld.decompose( position, quaternion, target );\r\n\r\n\t\t\t\treturn target;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tgetWorldDirection: function ( target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Object3D: .getWorldDirection() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.updateMatrixWorld( true );\r\n\r\n\t\t\tvar e = this.matrixWorld.elements;\r\n\r\n\t\t\treturn target.set( e[ 8 ], e[ 9 ], e[ 10 ] ).normalize();\r\n\r\n\t\t},\r\n\r\n\t\traycast: function () {},\r\n\r\n\t\ttraverse: function ( callback ) {\r\n\r\n\t\t\tcallback( this );\r\n\r\n\t\t\tvar children = this.children;\r\n\r\n\t\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tchildren[ i ].traverse( callback );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\ttraverseVisible: function ( callback ) {\r\n\r\n\t\t\tif ( this.visible === false ) return;\r\n\r\n\t\t\tcallback( this );\r\n\r\n\t\t\tvar children = this.children;\r\n\r\n\t\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tchildren[ i ].traverseVisible( callback );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\ttraverseAncestors: function ( callback ) {\r\n\r\n\t\t\tvar parent = this.parent;\r\n\r\n\t\t\tif ( parent !== null ) {\r\n\r\n\t\t\t\tcallback( parent );\r\n\r\n\t\t\t\tparent.traverseAncestors( callback );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tupdateMatrix: function () {\r\n\r\n\t\t\tthis.matrix.compose( this.position, this.quaternion, this.scale );\r\n\r\n\t\t\tthis.matrixWorldNeedsUpdate = true;\r\n\r\n\t\t},\r\n\r\n\t\tupdateMatrixWorld: function ( force ) {\r\n\r\n\t\t\tif ( this.matrixAutoUpdate ) this.updateMatrix();\r\n\r\n\t\t\tif ( this.matrixWorldNeedsUpdate || force ) {\r\n\r\n\t\t\t\tif ( this.parent === null ) {\r\n\r\n\t\t\t\t\tthis.matrixWorld.copy( this.matrix );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tthis.matrixWorld.multiplyMatrices( this.parent.matrixWorld, this.matrix );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.matrixWorldNeedsUpdate = false;\r\n\r\n\t\t\t\tforce = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// update children\r\n\r\n\t\t\tvar children = this.children;\r\n\r\n\t\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tchildren[ i ].updateMatrixWorld( force );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function ( meta ) {\r\n\r\n\t\t\t// meta is a string when called from JSON.stringify\r\n\t\t\tvar isRootObject = ( meta === undefined || typeof meta === 'string' );\r\n\r\n\t\t\tvar output = {};\r\n\r\n\t\t\t// meta is a hash used to collect geometries, materials.\r\n\t\t\t// not providing it implies that this is the root object\r\n\t\t\t// being serialized.\r\n\t\t\tif ( isRootObject ) {\r\n\r\n\t\t\t\t// initialize meta obj\r\n\t\t\t\tmeta = {\r\n\t\t\t\t\tgeometries: {},\r\n\t\t\t\t\tmaterials: {},\r\n\t\t\t\t\ttextures: {},\r\n\t\t\t\t\timages: {},\r\n\t\t\t\t\tshapes: {}\r\n\t\t\t\t};\r\n\r\n\t\t\t\toutput.metadata = {\r\n\t\t\t\t\tversion: 4.5,\r\n\t\t\t\t\ttype: 'Object',\r\n\t\t\t\t\tgenerator: 'Object3D.toJSON'\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// standard Object3D serialization\r\n\r\n\t\t\tvar object = {};\r\n\r\n\t\t\tobject.uuid = this.uuid;\r\n\t\t\tobject.type = this.type;\r\n\r\n\t\t\tif ( this.name !== '' ) object.name = this.name;\r\n\t\t\tif ( this.castShadow === true ) object.castShadow = true;\r\n\t\t\tif ( this.receiveShadow === true ) object.receiveShadow = true;\r\n\t\t\tif ( this.visible === false ) object.visible = false;\r\n\t\t\tif ( this.frustumCulled === false ) object.frustumCulled = false;\r\n\t\t\tif ( this.renderOrder !== 0 ) object.renderOrder = this.renderOrder;\r\n\t\t\tif ( JSON.stringify( this.userData ) !== '{}' ) object.userData = this.userData;\r\n\r\n\t\t\tobject.layers = this.layers.mask;\r\n\t\t\tobject.matrix = this.matrix.toArray();\r\n\r\n\t\t\tif ( this.matrixAutoUpdate === false ) object.matrixAutoUpdate = false;\r\n\r\n\t\t\t//\r\n\r\n\t\t\tfunction serialize( library, element ) {\r\n\r\n\t\t\t\tif ( library[ element.uuid ] === undefined ) {\r\n\r\n\t\t\t\t\tlibrary[ element.uuid ] = element.toJSON( meta );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn element.uuid;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.isMesh || this.isLine || this.isPoints ) {\r\n\r\n\t\t\t\tobject.geometry = serialize( meta.geometries, this.geometry );\r\n\r\n\t\t\t\tvar parameters = this.geometry.parameters;\r\n\r\n\t\t\t\tif ( parameters !== undefined && parameters.shapes !== undefined ) {\r\n\r\n\t\t\t\t\tvar shapes = parameters.shapes;\r\n\r\n\t\t\t\t\tif ( Array.isArray( shapes ) ) {\r\n\r\n\t\t\t\t\t\tfor ( var i = 0, l = shapes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tvar shape = shapes[ i ];\r\n\r\n\t\t\t\t\t\t\tserialize( meta.shapes, shape );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tserialize( meta.shapes, shapes );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.material !== undefined ) {\r\n\r\n\t\t\t\tif ( Array.isArray( this.material ) ) {\r\n\r\n\t\t\t\t\tvar uuids = [];\r\n\r\n\t\t\t\t\tfor ( var i = 0, l = this.material.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\t\tuuids.push( serialize( meta.materials, this.material[ i ] ) );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tobject.material = uuids;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tobject.material = serialize( meta.materials, this.material );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tif ( this.children.length > 0 ) {\r\n\r\n\t\t\t\tobject.children = [];\r\n\r\n\t\t\t\tfor ( var i = 0; i < this.children.length; i ++ ) {\r\n\r\n\t\t\t\t\tobject.children.push( this.children[ i ].toJSON( meta ).object );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( isRootObject ) {\r\n\r\n\t\t\t\tvar geometries = extractFromCache( meta.geometries );\r\n\t\t\t\tvar materials = extractFromCache( meta.materials );\r\n\t\t\t\tvar textures = extractFromCache( meta.textures );\r\n\t\t\t\tvar images = extractFromCache( meta.images );\r\n\t\t\t\tvar shapes = extractFromCache( meta.shapes );\r\n\r\n\t\t\t\tif ( geometries.length > 0 ) output.geometries = geometries;\r\n\t\t\t\tif ( materials.length > 0 ) output.materials = materials;\r\n\t\t\t\tif ( textures.length > 0 ) output.textures = textures;\r\n\t\t\t\tif ( images.length > 0 ) output.images = images;\r\n\t\t\t\tif ( shapes.length > 0 ) output.shapes = shapes;\r\n\r\n\t\t\t}\r\n\r\n\t\t\toutput.object = object;\r\n\r\n\t\t\treturn output;\r\n\r\n\t\t\t// extract data from the cache hash\r\n\t\t\t// remove metadata on each item\r\n\t\t\t// and return as array\r\n\t\t\tfunction extractFromCache( cache ) {\r\n\r\n\t\t\t\tvar values = [];\r\n\t\t\t\tfor ( var key in cache ) {\r\n\r\n\t\t\t\t\tvar data = cache[ key ];\r\n\t\t\t\t\tdelete data.metadata;\r\n\t\t\t\t\tvalues.push( data );\r\n\r\n\t\t\t\t}\r\n\t\t\t\treturn values;\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tclone: function ( recursive ) {\r\n\r\n\t\t\treturn new this.constructor().copy( this, recursive );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( source, recursive ) {\r\n\r\n\t\t\tif ( recursive === undefined ) recursive = true;\r\n\r\n\t\t\tthis.name = source.name;\r\n\r\n\t\t\tthis.up.copy( source.up );\r\n\r\n\t\t\tthis.position.copy( source.position );\r\n\t\t\tthis.quaternion.copy( source.quaternion );\r\n\t\t\tthis.scale.copy( source.scale );\r\n\r\n\t\t\tthis.matrix.copy( source.matrix );\r\n\t\t\tthis.matrixWorld.copy( source.matrixWorld );\r\n\r\n\t\t\tthis.matrixAutoUpdate = source.matrixAutoUpdate;\r\n\t\t\tthis.matrixWorldNeedsUpdate = source.matrixWorldNeedsUpdate;\r\n\r\n\t\t\tthis.layers.mask = source.layers.mask;\r\n\t\t\tthis.visible = source.visible;\r\n\r\n\t\t\tthis.castShadow = source.castShadow;\r\n\t\t\tthis.receiveShadow = source.receiveShadow;\r\n\r\n\t\t\tthis.frustumCulled = source.frustumCulled;\r\n\t\t\tthis.renderOrder = source.renderOrder;\r\n\r\n\t\t\tthis.userData = JSON.parse( JSON.stringify( source.userData ) );\r\n\r\n\t\t\tif ( recursive === true ) {\r\n\r\n\t\t\t\tfor ( var i = 0; i < source.children.length; i ++ ) {\r\n\r\n\t\t\t\t\tvar child = source.children[ i ];\r\n\t\t\t\t\tthis.add( child.clone() );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t*/\r\n\r\n\tfunction Camera() {\r\n\r\n\t\tObject3D.call( this );\r\n\r\n\t\tthis.type = 'Camera';\r\n\r\n\t\tthis.matrixWorldInverse = new Matrix4();\r\n\r\n\t\tthis.projectionMatrix = new Matrix4();\r\n\t\tthis.projectionMatrixInverse = new Matrix4();\r\n\r\n\t}\r\n\r\n\tCamera.prototype = Object.assign( Object.create( Object3D.prototype ), {\r\n\r\n\t\tconstructor: Camera,\r\n\r\n\t\tisCamera: true,\r\n\r\n\t\tcopy: function ( source, recursive ) {\r\n\r\n\t\t\tObject3D.prototype.copy.call( this, source, recursive );\r\n\r\n\t\t\tthis.matrixWorldInverse.copy( source.matrixWorldInverse );\r\n\r\n\t\t\tthis.projectionMatrix.copy( source.projectionMatrix );\r\n\t\t\tthis.projectionMatrixInverse.copy( source.projectionMatrixInverse );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetWorldDirection: function ( target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Camera: .getWorldDirection() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.updateMatrixWorld( true );\r\n\r\n\t\t\tvar e = this.matrixWorld.elements;\r\n\r\n\t\t\treturn target.set( - e[ 8 ], - e[ 9 ], - e[ 10 ] ).normalize();\r\n\r\n\t\t},\r\n\r\n\t\tupdateMatrixWorld: function ( force ) {\r\n\r\n\t\t\tObject3D.prototype.updateMatrixWorld.call( this, force );\r\n\r\n\t\t\tthis.matrixWorldInverse.getInverse( this.matrixWorld );\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author arose / http://github.com/arose\r\n\t */\r\n\r\n\tfunction OrthographicCamera( left, right, top, bottom, near, far ) {\r\n\r\n\t\tCamera.call( this );\r\n\r\n\t\tthis.type = 'OrthographicCamera';\r\n\r\n\t\tthis.zoom = 1;\r\n\t\tthis.view = null;\r\n\r\n\t\tthis.left = left;\r\n\t\tthis.right = right;\r\n\t\tthis.top = top;\r\n\t\tthis.bottom = bottom;\r\n\r\n\t\tthis.near = ( near !== undefined ) ? near : 0.1;\r\n\t\tthis.far = ( far !== undefined ) ? far : 2000;\r\n\r\n\t\tthis.updateProjectionMatrix();\r\n\r\n\t}\r\n\r\n\tOrthographicCamera.prototype = Object.assign( Object.create( Camera.prototype ), {\r\n\r\n\t\tconstructor: OrthographicCamera,\r\n\r\n\t\tisOrthographicCamera: true,\r\n\r\n\t\tcopy: function ( source, recursive ) {\r\n\r\n\t\t\tCamera.prototype.copy.call( this, source, recursive );\r\n\r\n\t\t\tthis.left = source.left;\r\n\t\t\tthis.right = source.right;\r\n\t\t\tthis.top = source.top;\r\n\t\t\tthis.bottom = source.bottom;\r\n\t\t\tthis.near = source.near;\r\n\t\t\tthis.far = source.far;\r\n\r\n\t\t\tthis.zoom = source.zoom;\r\n\t\t\tthis.view = source.view === null ? null : Object.assign( {}, source.view );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetViewOffset: function ( fullWidth, fullHeight, x, y, width, height ) {\r\n\r\n\t\t\tif ( this.view === null ) {\r\n\r\n\t\t\t\tthis.view = {\r\n\t\t\t\t\tenabled: true,\r\n\t\t\t\t\tfullWidth: 1,\r\n\t\t\t\t\tfullHeight: 1,\r\n\t\t\t\t\toffsetX: 0,\r\n\t\t\t\t\toffsetY: 0,\r\n\t\t\t\t\twidth: 1,\r\n\t\t\t\t\theight: 1\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.view.enabled = true;\r\n\t\t\tthis.view.fullWidth = fullWidth;\r\n\t\t\tthis.view.fullHeight = fullHeight;\r\n\t\t\tthis.view.offsetX = x;\r\n\t\t\tthis.view.offsetY = y;\r\n\t\t\tthis.view.width = width;\r\n\t\t\tthis.view.height = height;\r\n\r\n\t\t\tthis.updateProjectionMatrix();\r\n\r\n\t\t},\r\n\r\n\t\tclearViewOffset: function () {\r\n\r\n\t\t\tif ( this.view !== null ) {\r\n\r\n\t\t\t\tthis.view.enabled = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.updateProjectionMatrix();\r\n\r\n\t\t},\r\n\r\n\t\tupdateProjectionMatrix: function () {\r\n\r\n\t\t\tvar dx = ( this.right - this.left ) / ( 2 * this.zoom );\r\n\t\t\tvar dy = ( this.top - this.bottom ) / ( 2 * this.zoom );\r\n\t\t\tvar cx = ( this.right + this.left ) / 2;\r\n\t\t\tvar cy = ( this.top + this.bottom ) / 2;\r\n\r\n\t\t\tvar left = cx - dx;\r\n\t\t\tvar right = cx + dx;\r\n\t\t\tvar top = cy + dy;\r\n\t\t\tvar bottom = cy - dy;\r\n\r\n\t\t\tif ( this.view !== null && this.view.enabled ) {\r\n\r\n\t\t\t\tvar zoomW = this.zoom / ( this.view.width / this.view.fullWidth );\r\n\t\t\t\tvar zoomH = this.zoom / ( this.view.height / this.view.fullHeight );\r\n\t\t\t\tvar scaleW = ( this.right - this.left ) / this.view.width;\r\n\t\t\t\tvar scaleH = ( this.top - this.bottom ) / this.view.height;\r\n\r\n\t\t\t\tleft += scaleW * ( this.view.offsetX / zoomW );\r\n\t\t\t\tright = left + scaleW * ( this.view.width / zoomW );\r\n\t\t\t\ttop -= scaleH * ( this.view.offsetY / zoomH );\r\n\t\t\t\tbottom = top - scaleH * ( this.view.height / zoomH );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.projectionMatrix.makeOrthographic( left, right, top, bottom, this.near, this.far );\r\n\r\n\t\t\tthis.projectionMatrixInverse.getInverse( this.projectionMatrix );\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function ( meta ) {\r\n\r\n\t\t\tvar data = Object3D.prototype.toJSON.call( this, meta );\r\n\r\n\t\t\tdata.object.zoom = this.zoom;\r\n\t\t\tdata.object.left = this.left;\r\n\t\t\tdata.object.right = this.right;\r\n\t\t\tdata.object.top = this.top;\r\n\t\t\tdata.object.bottom = this.bottom;\r\n\t\t\tdata.object.near = this.near;\r\n\t\t\tdata.object.far = this.far;\r\n\r\n\t\t\tif ( this.view !== null ) data.object.view = Object.assign( {}, this.view );\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\r\n\tfunction Face3( a, b, c, normal, color, materialIndex ) {\r\n\r\n\t\tthis.a = a;\r\n\t\tthis.b = b;\r\n\t\tthis.c = c;\r\n\r\n\t\tthis.normal = ( normal && normal.isVector3 ) ? normal : new Vector3();\r\n\t\tthis.vertexNormals = Array.isArray( normal ) ? normal : [];\r\n\r\n\t\tthis.color = ( color && color.isColor ) ? color : new Color();\r\n\t\tthis.vertexColors = Array.isArray( color ) ? color : [];\r\n\r\n\t\tthis.materialIndex = materialIndex !== undefined ? materialIndex : 0;\r\n\r\n\t}\r\n\r\n\tObject.assign( Face3.prototype, {\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tthis.a = source.a;\r\n\t\t\tthis.b = source.b;\r\n\t\t\tthis.c = source.c;\r\n\r\n\t\t\tthis.normal.copy( source.normal );\r\n\t\t\tthis.color.copy( source.color );\r\n\r\n\t\t\tthis.materialIndex = source.materialIndex;\r\n\r\n\t\t\tfor ( var i = 0, il = source.vertexNormals.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tthis.vertexNormals[ i ] = source.vertexNormals[ i ].clone();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var i = 0, il = source.vertexColors.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tthis.vertexColors[ i ] = source.vertexColors[ i ].clone();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author kile / http://kile.stravaganza.org/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\r\n\t * @author bhouston / http://clara.io\r\n\t */\r\n\r\n\tvar geometryId = 0; // Geometry uses even numbers as Id\r\n\r\n\tfunction Geometry() {\r\n\r\n\t\tObject.defineProperty( this, 'id', { value: geometryId += 2 } );\r\n\r\n\t\tthis.uuid = _Math.generateUUID();\r\n\r\n\t\tthis.name = '';\r\n\t\tthis.type = 'Geometry';\r\n\r\n\t\tthis.vertices = [];\r\n\t\tthis.colors = [];\r\n\t\tthis.faces = [];\r\n\t\tthis.faceVertexUvs = [[]];\r\n\r\n\t\tthis.morphTargets = [];\r\n\t\tthis.morphNormals = [];\r\n\r\n\t\tthis.skinWeights = [];\r\n\t\tthis.skinIndices = [];\r\n\r\n\t\tthis.lineDistances = [];\r\n\r\n\t\tthis.boundingBox = null;\r\n\t\tthis.boundingSphere = null;\r\n\r\n\t\t// update flags\r\n\r\n\t\tthis.elementsNeedUpdate = false;\r\n\t\tthis.verticesNeedUpdate = false;\r\n\t\tthis.uvsNeedUpdate = false;\r\n\t\tthis.normalsNeedUpdate = false;\r\n\t\tthis.colorsNeedUpdate = false;\r\n\t\tthis.lineDistancesNeedUpdate = false;\r\n\t\tthis.groupsNeedUpdate = false;\r\n\r\n\t}\r\n\r\n\tGeometry.prototype = Object.assign( Object.create( EventDispatcher.prototype ), {\r\n\r\n\t\tconstructor: Geometry,\r\n\r\n\t\tisGeometry: true,\r\n\r\n\t\tapplyMatrix: function ( matrix ) {\r\n\r\n\t\t\tvar normalMatrix = new Matrix3().getNormalMatrix( matrix );\r\n\r\n\t\t\tfor ( var i = 0, il = this.vertices.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvar vertex = this.vertices[ i ];\r\n\t\t\t\tvertex.applyMatrix4( matrix );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var i = 0, il = this.faces.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvar face = this.faces[ i ];\r\n\t\t\t\tface.normal.applyMatrix3( normalMatrix ).normalize();\r\n\r\n\t\t\t\tfor ( var j = 0, jl = face.vertexNormals.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\tface.vertexNormals[ j ].applyMatrix3( normalMatrix ).normalize();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.boundingBox !== null ) {\r\n\r\n\t\t\t\tthis.computeBoundingBox();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.boundingSphere !== null ) {\r\n\r\n\t\t\t\tthis.computeBoundingSphere();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.verticesNeedUpdate = true;\r\n\t\t\tthis.normalsNeedUpdate = true;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\trotateX: function () {\r\n\r\n\t\t\t// rotate geometry around world x-axis\r\n\r\n\t\t\tvar m1 = new Matrix4();\r\n\r\n\t\t\treturn function rotateX( angle ) {\r\n\r\n\t\t\t\tm1.makeRotationX( angle );\r\n\r\n\t\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\trotateY: function () {\r\n\r\n\t\t\t// rotate geometry around world y-axis\r\n\r\n\t\t\tvar m1 = new Matrix4();\r\n\r\n\t\t\treturn function rotateY( angle ) {\r\n\r\n\t\t\t\tm1.makeRotationY( angle );\r\n\r\n\t\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\trotateZ: function () {\r\n\r\n\t\t\t// rotate geometry around world z-axis\r\n\r\n\t\t\tvar m1 = new Matrix4();\r\n\r\n\t\t\treturn function rotateZ( angle ) {\r\n\r\n\t\t\t\tm1.makeRotationZ( angle );\r\n\r\n\t\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\ttranslate: function () {\r\n\r\n\t\t\t// translate geometry\r\n\r\n\t\t\tvar m1 = new Matrix4();\r\n\r\n\t\t\treturn function translate( x, y, z ) {\r\n\r\n\t\t\t\tm1.makeTranslation( x, y, z );\r\n\r\n\t\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tscale: function () {\r\n\r\n\t\t\t// scale geometry\r\n\r\n\t\t\tvar m1 = new Matrix4();\r\n\r\n\t\t\treturn function scale( x, y, z ) {\r\n\r\n\t\t\t\tm1.makeScale( x, y, z );\r\n\r\n\t\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tlookAt: function () {\r\n\r\n\t\t\tvar obj = new Object3D();\r\n\r\n\t\t\treturn function lookAt( vector ) {\r\n\r\n\t\t\t\tobj.lookAt( vector );\r\n\r\n\t\t\t\tobj.updateMatrix();\r\n\r\n\t\t\t\tthis.applyMatrix( obj.matrix );\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tfromBufferGeometry: function ( geometry ) {\r\n\r\n\t\t\tvar scope = this;\r\n\r\n\t\t\tvar indices = geometry.index !== null ? geometry.index.array : undefined;\r\n\t\t\tvar attributes = geometry.attributes;\r\n\r\n\t\t\tvar positions = attributes.position.array;\r\n\t\t\tvar normals = attributes.normal !== undefined ? attributes.normal.array : undefined;\r\n\t\t\tvar colors = attributes.color !== undefined ? attributes.color.array : undefined;\r\n\t\t\tvar uvs = attributes.uv !== undefined ? attributes.uv.array : undefined;\r\n\t\t\tvar uvs2 = attributes.uv2 !== undefined ? attributes.uv2.array : undefined;\r\n\r\n\t\t\tif ( uvs2 !== undefined ) this.faceVertexUvs[ 1 ] = [];\r\n\r\n\t\t\tvar tempNormals = [];\r\n\t\t\tvar tempUVs = [];\r\n\t\t\tvar tempUVs2 = [];\r\n\r\n\t\t\tfor ( var i = 0, j = 0; i < positions.length; i += 3, j += 2 ) {\r\n\r\n\t\t\t\tscope.vertices.push( new Vector3( positions[ i ], positions[ i + 1 ], positions[ i + 2 ] ) );\r\n\r\n\t\t\t\tif ( normals !== undefined ) {\r\n\r\n\t\t\t\t\ttempNormals.push( new Vector3( normals[ i ], normals[ i + 1 ], normals[ i + 2 ] ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( colors !== undefined ) {\r\n\r\n\t\t\t\t\tscope.colors.push( new Color( colors[ i ], colors[ i + 1 ], colors[ i + 2 ] ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( uvs !== undefined ) {\r\n\r\n\t\t\t\t\ttempUVs.push( new Vector2( uvs[ j ], uvs[ j + 1 ] ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( uvs2 !== undefined ) {\r\n\r\n\t\t\t\t\ttempUVs2.push( new Vector2( uvs2[ j ], uvs2[ j + 1 ] ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction addFace( a, b, c, materialIndex ) {\r\n\r\n\t\t\t\tvar vertexNormals = normals !== undefined ? [ tempNormals[ a ].clone(), tempNormals[ b ].clone(), tempNormals[ c ].clone() ] : [];\r\n\t\t\t\tvar vertexColors = colors !== undefined ? [ scope.colors[ a ].clone(), scope.colors[ b ].clone(), scope.colors[ c ].clone() ] : [];\r\n\r\n\t\t\t\tvar face = new Face3( a, b, c, vertexNormals, vertexColors, materialIndex );\r\n\r\n\t\t\t\tscope.faces.push( face );\r\n\r\n\t\t\t\tif ( uvs !== undefined ) {\r\n\r\n\t\t\t\t\tscope.faceVertexUvs[ 0 ].push( [ tempUVs[ a ].clone(), tempUVs[ b ].clone(), tempUVs[ c ].clone() ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( uvs2 !== undefined ) {\r\n\r\n\t\t\t\t\tscope.faceVertexUvs[ 1 ].push( [ tempUVs2[ a ].clone(), tempUVs2[ b ].clone(), tempUVs2[ c ].clone() ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar groups = geometry.groups;\r\n\r\n\t\t\tif ( groups.length > 0 ) {\r\n\r\n\t\t\t\tfor ( var i = 0; i < groups.length; i ++ ) {\r\n\r\n\t\t\t\t\tvar group = groups[ i ];\r\n\r\n\t\t\t\t\tvar start = group.start;\r\n\t\t\t\t\tvar count = group.count;\r\n\r\n\t\t\t\t\tfor ( var j = start, jl = start + count; j < jl; j += 3 ) {\r\n\r\n\t\t\t\t\t\tif ( indices !== undefined ) {\r\n\r\n\t\t\t\t\t\t\taddFace( indices[ j ], indices[ j + 1 ], indices[ j + 2 ], group.materialIndex );\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\taddFace( j, j + 1, j + 2, group.materialIndex );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif ( indices !== undefined ) {\r\n\r\n\t\t\t\t\tfor ( var i = 0; i < indices.length; i += 3 ) {\r\n\r\n\t\t\t\t\t\taddFace( indices[ i ], indices[ i + 1 ], indices[ i + 2 ] );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tfor ( var i = 0; i < positions.length / 3; i += 3 ) {\r\n\r\n\t\t\t\t\t\taddFace( i, i + 1, i + 2 );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.computeFaceNormals();\r\n\r\n\t\t\tif ( geometry.boundingBox !== null ) {\r\n\r\n\t\t\t\tthis.boundingBox = geometry.boundingBox.clone();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( geometry.boundingSphere !== null ) {\r\n\r\n\t\t\t\tthis.boundingSphere = geometry.boundingSphere.clone();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcenter: function () {\r\n\r\n\t\t\tvar offset = new Vector3();\r\n\r\n\t\t\treturn function center() {\r\n\r\n\t\t\t\tthis.computeBoundingBox();\r\n\r\n\t\t\t\tthis.boundingBox.getCenter( offset ).negate();\r\n\r\n\t\t\t\tthis.translate( offset.x, offset.y, offset.z );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tnormalize: function () {\r\n\r\n\t\t\tthis.computeBoundingSphere();\r\n\r\n\t\t\tvar center = this.boundingSphere.center;\r\n\t\t\tvar radius = this.boundingSphere.radius;\r\n\r\n\t\t\tvar s = radius === 0 ? 1 : 1.0 / radius;\r\n\r\n\t\t\tvar matrix = new Matrix4();\r\n\t\t\tmatrix.set(\r\n\t\t\t\ts, 0, 0, - s * center.x,\r\n\t\t\t\t0, s, 0, - s * center.y,\r\n\t\t\t\t0, 0, s, - s * center.z,\r\n\t\t\t\t0, 0, 0, 1\r\n\t\t\t);\r\n\r\n\t\t\tthis.applyMatrix( matrix );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcomputeFaceNormals: function () {\r\n\r\n\t\t\tvar cb = new Vector3(), ab = new Vector3();\r\n\r\n\t\t\tfor ( var f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\tvar face = this.faces[ f ];\r\n\r\n\t\t\t\tvar vA = this.vertices[ face.a ];\r\n\t\t\t\tvar vB = this.vertices[ face.b ];\r\n\t\t\t\tvar vC = this.vertices[ face.c ];\r\n\r\n\t\t\t\tcb.subVectors( vC, vB );\r\n\t\t\t\tab.subVectors( vA, vB );\r\n\t\t\t\tcb.cross( ab );\r\n\r\n\t\t\t\tcb.normalize();\r\n\r\n\t\t\t\tface.normal.copy( cb );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tcomputeVertexNormals: function ( areaWeighted ) {\r\n\r\n\t\t\tif ( areaWeighted === undefined ) areaWeighted = true;\r\n\r\n\t\t\tvar v, vl, f, fl, face, vertices;\r\n\r\n\t\t\tvertices = new Array( this.vertices.length );\r\n\r\n\t\t\tfor ( v = 0, vl = this.vertices.length; v < vl; v ++ ) {\r\n\r\n\t\t\t\tvertices[ v ] = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( areaWeighted ) {\r\n\r\n\t\t\t\t// vertex normals weighted by triangle areas\r\n\t\t\t\t// http://www.iquilezles.org/www/articles/normals/normals.htm\r\n\r\n\t\t\t\tvar vA, vB, vC;\r\n\t\t\t\tvar cb = new Vector3(), ab = new Vector3();\r\n\r\n\t\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\t\t\tvA = this.vertices[ face.a ];\r\n\t\t\t\t\tvB = this.vertices[ face.b ];\r\n\t\t\t\t\tvC = this.vertices[ face.c ];\r\n\r\n\t\t\t\t\tcb.subVectors( vC, vB );\r\n\t\t\t\t\tab.subVectors( vA, vB );\r\n\t\t\t\t\tcb.cross( ab );\r\n\r\n\t\t\t\t\tvertices[ face.a ].add( cb );\r\n\t\t\t\t\tvertices[ face.b ].add( cb );\r\n\t\t\t\t\tvertices[ face.c ].add( cb );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.computeFaceNormals();\r\n\r\n\t\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\t\t\tvertices[ face.a ].add( face.normal );\r\n\t\t\t\t\tvertices[ face.b ].add( face.normal );\r\n\t\t\t\t\tvertices[ face.c ].add( face.normal );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( v = 0, vl = this.vertices.length; v < vl; v ++ ) {\r\n\r\n\t\t\t\tvertices[ v ].normalize();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\t\tvar vertexNormals = face.vertexNormals;\r\n\r\n\t\t\t\tif ( vertexNormals.length === 3 ) {\r\n\r\n\t\t\t\t\tvertexNormals[ 0 ].copy( vertices[ face.a ] );\r\n\t\t\t\t\tvertexNormals[ 1 ].copy( vertices[ face.b ] );\r\n\t\t\t\t\tvertexNormals[ 2 ].copy( vertices[ face.c ] );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tvertexNormals[ 0 ] = vertices[ face.a ].clone();\r\n\t\t\t\t\tvertexNormals[ 1 ] = vertices[ face.b ].clone();\r\n\t\t\t\t\tvertexNormals[ 2 ] = vertices[ face.c ].clone();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.faces.length > 0 ) {\r\n\r\n\t\t\t\tthis.normalsNeedUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tcomputeFlatVertexNormals: function () {\r\n\r\n\t\t\tvar f, fl, face;\r\n\r\n\t\t\tthis.computeFaceNormals();\r\n\r\n\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\t\tvar vertexNormals = face.vertexNormals;\r\n\r\n\t\t\t\tif ( vertexNormals.length === 3 ) {\r\n\r\n\t\t\t\t\tvertexNormals[ 0 ].copy( face.normal );\r\n\t\t\t\t\tvertexNormals[ 1 ].copy( face.normal );\r\n\t\t\t\t\tvertexNormals[ 2 ].copy( face.normal );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tvertexNormals[ 0 ] = face.normal.clone();\r\n\t\t\t\t\tvertexNormals[ 1 ] = face.normal.clone();\r\n\t\t\t\t\tvertexNormals[ 2 ] = face.normal.clone();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.faces.length > 0 ) {\r\n\r\n\t\t\t\tthis.normalsNeedUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tcomputeMorphNormals: function () {\r\n\r\n\t\t\tvar i, il, f, fl, face;\r\n\r\n\t\t\t// save original normals\r\n\t\t\t// - create temp variables on first access\r\n\t\t\t//   otherwise just copy (for faster repeated calls)\r\n\r\n\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\t\tif ( ! face.__originalFaceNormal ) {\r\n\r\n\t\t\t\t\tface.__originalFaceNormal = face.normal.clone();\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tface.__originalFaceNormal.copy( face.normal );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( ! face.__originalVertexNormals ) face.__originalVertexNormals = [];\r\n\r\n\t\t\t\tfor ( i = 0, il = face.vertexNormals.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\tif ( ! face.__originalVertexNormals[ i ] ) {\r\n\r\n\t\t\t\t\t\tface.__originalVertexNormals[ i ] = face.vertexNormals[ i ].clone();\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tface.__originalVertexNormals[ i ].copy( face.vertexNormals[ i ] );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// use temp geometry to compute face and vertex normals for each morph\r\n\r\n\t\t\tvar tmpGeo = new Geometry();\r\n\t\t\ttmpGeo.faces = this.faces;\r\n\r\n\t\t\tfor ( i = 0, il = this.morphTargets.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t// create on first access\r\n\r\n\t\t\t\tif ( ! this.morphNormals[ i ] ) {\r\n\r\n\t\t\t\t\tthis.morphNormals[ i ] = {};\r\n\t\t\t\t\tthis.morphNormals[ i ].faceNormals = [];\r\n\t\t\t\t\tthis.morphNormals[ i ].vertexNormals = [];\r\n\r\n\t\t\t\t\tvar dstNormalsFace = this.morphNormals[ i ].faceNormals;\r\n\t\t\t\t\tvar dstNormalsVertex = this.morphNormals[ i ].vertexNormals;\r\n\r\n\t\t\t\t\tvar faceNormal, vertexNormals;\r\n\r\n\t\t\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\t\t\tfaceNormal = new Vector3();\r\n\t\t\t\t\t\tvertexNormals = { a: new Vector3(), b: new Vector3(), c: new Vector3() };\r\n\r\n\t\t\t\t\t\tdstNormalsFace.push( faceNormal );\r\n\t\t\t\t\t\tdstNormalsVertex.push( vertexNormals );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar morphNormals = this.morphNormals[ i ];\r\n\r\n\t\t\t\t// set vertices to morph target\r\n\r\n\t\t\t\ttmpGeo.vertices = this.morphTargets[ i ].vertices;\r\n\r\n\t\t\t\t// compute morph normals\r\n\r\n\t\t\t\ttmpGeo.computeFaceNormals();\r\n\t\t\t\ttmpGeo.computeVertexNormals();\r\n\r\n\t\t\t\t// store morph normals\r\n\r\n\t\t\t\tvar faceNormal, vertexNormals;\r\n\r\n\t\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\t\t\tfaceNormal = morphNormals.faceNormals[ f ];\r\n\t\t\t\t\tvertexNormals = morphNormals.vertexNormals[ f ];\r\n\r\n\t\t\t\t\tfaceNormal.copy( face.normal );\r\n\r\n\t\t\t\t\tvertexNormals.a.copy( face.vertexNormals[ 0 ] );\r\n\t\t\t\t\tvertexNormals.b.copy( face.vertexNormals[ 1 ] );\r\n\t\t\t\t\tvertexNormals.c.copy( face.vertexNormals[ 2 ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// restore original normals\r\n\r\n\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\t\tface.normal = face.__originalFaceNormal;\r\n\t\t\t\tface.vertexNormals = face.__originalVertexNormals;\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tcomputeBoundingBox: function () {\r\n\r\n\t\t\tif ( this.boundingBox === null ) {\r\n\r\n\t\t\t\tthis.boundingBox = new Box3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.boundingBox.setFromPoints( this.vertices );\r\n\r\n\t\t},\r\n\r\n\t\tcomputeBoundingSphere: function () {\r\n\r\n\t\t\tif ( this.boundingSphere === null ) {\r\n\r\n\t\t\t\tthis.boundingSphere = new Sphere();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.boundingSphere.setFromPoints( this.vertices );\r\n\r\n\t\t},\r\n\r\n\t\tmerge: function ( geometry, matrix, materialIndexOffset ) {\r\n\r\n\t\t\tif ( ! ( geometry && geometry.isGeometry ) ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.', geometry );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar normalMatrix,\r\n\t\t\t\tvertexOffset = this.vertices.length,\r\n\t\t\t\tvertices1 = this.vertices,\r\n\t\t\t\tvertices2 = geometry.vertices,\r\n\t\t\t\tfaces1 = this.faces,\r\n\t\t\t\tfaces2 = geometry.faces,\r\n\t\t\t\tuvs1 = this.faceVertexUvs[ 0 ],\r\n\t\t\t\tuvs2 = geometry.faceVertexUvs[ 0 ],\r\n\t\t\t\tcolors1 = this.colors,\r\n\t\t\t\tcolors2 = geometry.colors;\r\n\r\n\t\t\tif ( materialIndexOffset === undefined ) materialIndexOffset = 0;\r\n\r\n\t\t\tif ( matrix !== undefined ) {\r\n\r\n\t\t\t\tnormalMatrix = new Matrix3().getNormalMatrix( matrix );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// vertices\r\n\r\n\t\t\tfor ( var i = 0, il = vertices2.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvar vertex = vertices2[ i ];\r\n\r\n\t\t\t\tvar vertexCopy = vertex.clone();\r\n\r\n\t\t\t\tif ( matrix !== undefined ) vertexCopy.applyMatrix4( matrix );\r\n\r\n\t\t\t\tvertices1.push( vertexCopy );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// colors\r\n\r\n\t\t\tfor ( var i = 0, il = colors2.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tcolors1.push( colors2[ i ].clone() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// faces\r\n\r\n\t\t\tfor ( i = 0, il = faces2.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvar face = faces2[ i ], faceCopy, normal, color,\r\n\t\t\t\t\tfaceVertexNormals = face.vertexNormals,\r\n\t\t\t\t\tfaceVertexColors = face.vertexColors;\r\n\r\n\t\t\t\tfaceCopy = new Face3( face.a + vertexOffset, face.b + vertexOffset, face.c + vertexOffset );\r\n\t\t\t\tfaceCopy.normal.copy( face.normal );\r\n\r\n\t\t\t\tif ( normalMatrix !== undefined ) {\r\n\r\n\t\t\t\t\tfaceCopy.normal.applyMatrix3( normalMatrix ).normalize();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor ( var j = 0, jl = faceVertexNormals.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\tnormal = faceVertexNormals[ j ].clone();\r\n\r\n\t\t\t\t\tif ( normalMatrix !== undefined ) {\r\n\r\n\t\t\t\t\t\tnormal.applyMatrix3( normalMatrix ).normalize();\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfaceCopy.vertexNormals.push( normal );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfaceCopy.color.copy( face.color );\r\n\r\n\t\t\t\tfor ( var j = 0, jl = faceVertexColors.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\tcolor = faceVertexColors[ j ];\r\n\t\t\t\t\tfaceCopy.vertexColors.push( color.clone() );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfaceCopy.materialIndex = face.materialIndex + materialIndexOffset;\r\n\r\n\t\t\t\tfaces1.push( faceCopy );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// uvs\r\n\r\n\t\t\tfor ( i = 0, il = uvs2.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvar uv = uvs2[ i ], uvCopy = [];\r\n\r\n\t\t\t\tif ( uv === undefined ) {\r\n\r\n\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor ( var j = 0, jl = uv.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\tuvCopy.push( uv[ j ].clone() );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tuvs1.push( uvCopy );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tmergeMesh: function ( mesh ) {\r\n\r\n\t\t\tif ( ! ( mesh && mesh.isMesh ) ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.', mesh );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( mesh.matrixAutoUpdate ) mesh.updateMatrix();\r\n\r\n\t\t\tthis.merge( mesh.geometry, mesh.matrix );\r\n\r\n\t\t},\r\n\r\n\t\t/*\r\n\t\t * Checks for duplicate vertices with hashmap.\r\n\t\t * Duplicated vertices are removed\r\n\t\t * and faces' vertices are updated.\r\n\t\t */\r\n\r\n\t\tmergeVertices: function () {\r\n\r\n\t\t\tvar verticesMap = {}; // Hashmap for looking up vertices by position coordinates (and making sure they are unique)\r\n\t\t\tvar unique = [], changes = [];\r\n\r\n\t\t\tvar v, key;\r\n\t\t\tvar precisionPoints = 4; // number of decimal points, e.g. 4 for epsilon of 0.0001\r\n\t\t\tvar precision = Math.pow( 10, precisionPoints );\r\n\t\t\tvar i, il, face;\r\n\t\t\tvar indices, j, jl;\r\n\r\n\t\t\tfor ( i = 0, il = this.vertices.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tv = this.vertices[ i ];\r\n\t\t\t\tkey = Math.round( v.x * precision ) + '_' + Math.round( v.y * precision ) + '_' + Math.round( v.z * precision );\r\n\r\n\t\t\t\tif ( verticesMap[ key ] === undefined ) {\r\n\r\n\t\t\t\t\tverticesMap[ key ] = i;\r\n\t\t\t\t\tunique.push( this.vertices[ i ] );\r\n\t\t\t\t\tchanges[ i ] = unique.length - 1;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t//console.log('Duplicate vertex found. ', i, ' could be using ', verticesMap[key]);\r\n\t\t\t\t\tchanges[ i ] = changes[ verticesMap[ key ] ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\t// if faces are completely degenerate after merging vertices, we\r\n\t\t\t// have to remove them from the geometry.\r\n\t\t\tvar faceIndicesToRemove = [];\r\n\r\n\t\t\tfor ( i = 0, il = this.faces.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tface = this.faces[ i ];\r\n\r\n\t\t\t\tface.a = changes[ face.a ];\r\n\t\t\t\tface.b = changes[ face.b ];\r\n\t\t\t\tface.c = changes[ face.c ];\r\n\r\n\t\t\t\tindices = [ face.a, face.b, face.c ];\r\n\r\n\t\t\t\t// if any duplicate vertices are found in a Face3\r\n\t\t\t\t// we have to remove the face as nothing can be saved\r\n\t\t\t\tfor ( var n = 0; n < 3; n ++ ) {\r\n\r\n\t\t\t\t\tif ( indices[ n ] === indices[ ( n + 1 ) % 3 ] ) {\r\n\r\n\t\t\t\t\t\tfaceIndicesToRemove.push( i );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( i = faceIndicesToRemove.length - 1; i >= 0; i -- ) {\r\n\r\n\t\t\t\tvar idx = faceIndicesToRemove[ i ];\r\n\r\n\t\t\t\tthis.faces.splice( idx, 1 );\r\n\r\n\t\t\t\tfor ( j = 0, jl = this.faceVertexUvs.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\tthis.faceVertexUvs[ j ].splice( idx, 1 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Use unique set of vertices\r\n\r\n\t\t\tvar diff = this.vertices.length - unique.length;\r\n\t\t\tthis.vertices = unique;\r\n\t\t\treturn diff;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromPoints: function ( points ) {\r\n\r\n\t\t\tthis.vertices = [];\r\n\r\n\t\t\tfor ( var i = 0, l = points.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar point = points[ i ];\r\n\t\t\t\tthis.vertices.push( new Vector3( point.x, point.y, point.z || 0 ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsortFacesByMaterialIndex: function () {\r\n\r\n\t\t\tvar faces = this.faces;\r\n\t\t\tvar length = faces.length;\r\n\r\n\t\t\t// tag faces\r\n\r\n\t\t\tfor ( var i = 0; i < length; i ++ ) {\r\n\r\n\t\t\t\tfaces[ i ]._id = i;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// sort faces\r\n\r\n\t\t\tfunction materialIndexSort( a, b ) {\r\n\r\n\t\t\t\treturn a.materialIndex - b.materialIndex;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfaces.sort( materialIndexSort );\r\n\r\n\t\t\t// sort uvs\r\n\r\n\t\t\tvar uvs1 = this.faceVertexUvs[ 0 ];\r\n\t\t\tvar uvs2 = this.faceVertexUvs[ 1 ];\r\n\r\n\t\t\tvar newUvs1, newUvs2;\r\n\r\n\t\t\tif ( uvs1 && uvs1.length === length ) newUvs1 = [];\r\n\t\t\tif ( uvs2 && uvs2.length === length ) newUvs2 = [];\r\n\r\n\t\t\tfor ( var i = 0; i < length; i ++ ) {\r\n\r\n\t\t\t\tvar id = faces[ i ]._id;\r\n\r\n\t\t\t\tif ( newUvs1 ) newUvs1.push( uvs1[ id ] );\r\n\t\t\t\tif ( newUvs2 ) newUvs2.push( uvs2[ id ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( newUvs1 ) this.faceVertexUvs[ 0 ] = newUvs1;\r\n\t\t\tif ( newUvs2 ) this.faceVertexUvs[ 1 ] = newUvs2;\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function () {\r\n\r\n\t\t\tvar data = {\r\n\t\t\t\tmetadata: {\r\n\t\t\t\t\tversion: 4.5,\r\n\t\t\t\t\ttype: 'Geometry',\r\n\t\t\t\t\tgenerator: 'Geometry.toJSON'\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\t// standard Geometry serialization\r\n\r\n\t\t\tdata.uuid = this.uuid;\r\n\t\t\tdata.type = this.type;\r\n\t\t\tif ( this.name !== '' ) data.name = this.name;\r\n\r\n\t\t\tif ( this.parameters !== undefined ) {\r\n\r\n\t\t\t\tvar parameters = this.parameters;\r\n\r\n\t\t\t\tfor ( var key in parameters ) {\r\n\r\n\t\t\t\t\tif ( parameters[ key ] !== undefined ) data[ key ] = parameters[ key ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn data;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar vertices = [];\r\n\r\n\t\t\tfor ( var i = 0; i < this.vertices.length; i ++ ) {\r\n\r\n\t\t\t\tvar vertex = this.vertices[ i ];\r\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar faces = [];\r\n\t\t\tvar normals = [];\r\n\t\t\tvar normalsHash = {};\r\n\t\t\tvar colors = [];\r\n\t\t\tvar colorsHash = {};\r\n\t\t\tvar uvs = [];\r\n\t\t\tvar uvsHash = {};\r\n\r\n\t\t\tfor ( var i = 0; i < this.faces.length; i ++ ) {\r\n\r\n\t\t\t\tvar face = this.faces[ i ];\r\n\r\n\t\t\t\tvar hasMaterial = true;\r\n\t\t\t\tvar hasFaceUv = false; // deprecated\r\n\t\t\t\tvar hasFaceVertexUv = this.faceVertexUvs[ 0 ][ i ] !== undefined;\r\n\t\t\t\tvar hasFaceNormal = face.normal.length() > 0;\r\n\t\t\t\tvar hasFaceVertexNormal = face.vertexNormals.length > 0;\r\n\t\t\t\tvar hasFaceColor = face.color.r !== 1 || face.color.g !== 1 || face.color.b !== 1;\r\n\t\t\t\tvar hasFaceVertexColor = face.vertexColors.length > 0;\r\n\r\n\t\t\t\tvar faceType = 0;\r\n\r\n\t\t\t\tfaceType = setBit( faceType, 0, 0 ); // isQuad\r\n\t\t\t\tfaceType = setBit( faceType, 1, hasMaterial );\r\n\t\t\t\tfaceType = setBit( faceType, 2, hasFaceUv );\r\n\t\t\t\tfaceType = setBit( faceType, 3, hasFaceVertexUv );\r\n\t\t\t\tfaceType = setBit( faceType, 4, hasFaceNormal );\r\n\t\t\t\tfaceType = setBit( faceType, 5, hasFaceVertexNormal );\r\n\t\t\t\tfaceType = setBit( faceType, 6, hasFaceColor );\r\n\t\t\t\tfaceType = setBit( faceType, 7, hasFaceVertexColor );\r\n\r\n\t\t\t\tfaces.push( faceType );\r\n\t\t\t\tfaces.push( face.a, face.b, face.c );\r\n\t\t\t\tfaces.push( face.materialIndex );\r\n\r\n\t\t\t\tif ( hasFaceVertexUv ) {\r\n\r\n\t\t\t\t\tvar faceVertexUvs = this.faceVertexUvs[ 0 ][ i ];\r\n\r\n\t\t\t\t\tfaces.push(\r\n\t\t\t\t\t\tgetUvIndex( faceVertexUvs[ 0 ] ),\r\n\t\t\t\t\t\tgetUvIndex( faceVertexUvs[ 1 ] ),\r\n\t\t\t\t\t\tgetUvIndex( faceVertexUvs[ 2 ] )\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( hasFaceNormal ) {\r\n\r\n\t\t\t\t\tfaces.push( getNormalIndex( face.normal ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( hasFaceVertexNormal ) {\r\n\r\n\t\t\t\t\tvar vertexNormals = face.vertexNormals;\r\n\r\n\t\t\t\t\tfaces.push(\r\n\t\t\t\t\t\tgetNormalIndex( vertexNormals[ 0 ] ),\r\n\t\t\t\t\t\tgetNormalIndex( vertexNormals[ 1 ] ),\r\n\t\t\t\t\t\tgetNormalIndex( vertexNormals[ 2 ] )\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( hasFaceColor ) {\r\n\r\n\t\t\t\t\tfaces.push( getColorIndex( face.color ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( hasFaceVertexColor ) {\r\n\r\n\t\t\t\t\tvar vertexColors = face.vertexColors;\r\n\r\n\t\t\t\t\tfaces.push(\r\n\t\t\t\t\t\tgetColorIndex( vertexColors[ 0 ] ),\r\n\t\t\t\t\t\tgetColorIndex( vertexColors[ 1 ] ),\r\n\t\t\t\t\t\tgetColorIndex( vertexColors[ 2 ] )\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction setBit( value, position, enabled ) {\r\n\r\n\t\t\t\treturn enabled ? value | ( 1 << position ) : value & ( ~ ( 1 << position ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction getNormalIndex( normal ) {\r\n\r\n\t\t\t\tvar hash = normal.x.toString() + normal.y.toString() + normal.z.toString();\r\n\r\n\t\t\t\tif ( normalsHash[ hash ] !== undefined ) {\r\n\r\n\t\t\t\t\treturn normalsHash[ hash ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tnormalsHash[ hash ] = normals.length / 3;\r\n\t\t\t\tnormals.push( normal.x, normal.y, normal.z );\r\n\r\n\t\t\t\treturn normalsHash[ hash ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction getColorIndex( color ) {\r\n\r\n\t\t\t\tvar hash = color.r.toString() + color.g.toString() + color.b.toString();\r\n\r\n\t\t\t\tif ( colorsHash[ hash ] !== undefined ) {\r\n\r\n\t\t\t\t\treturn colorsHash[ hash ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcolorsHash[ hash ] = colors.length;\r\n\t\t\t\tcolors.push( color.getHex() );\r\n\r\n\t\t\t\treturn colorsHash[ hash ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction getUvIndex( uv ) {\r\n\r\n\t\t\t\tvar hash = uv.x.toString() + uv.y.toString();\r\n\r\n\t\t\t\tif ( uvsHash[ hash ] !== undefined ) {\r\n\r\n\t\t\t\t\treturn uvsHash[ hash ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tuvsHash[ hash ] = uvs.length / 2;\r\n\t\t\t\tuvs.push( uv.x, uv.y );\r\n\r\n\t\t\t\treturn uvsHash[ hash ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tdata.data = {};\r\n\r\n\t\t\tdata.data.vertices = vertices;\r\n\t\t\tdata.data.normals = normals;\r\n\t\t\tif ( colors.length > 0 ) data.data.colors = colors;\r\n\t\t\tif ( uvs.length > 0 ) data.data.uvs = [ uvs ]; // temporal backward compatibility\r\n\t\t\tdata.data.faces = faces;\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\t/*\r\n\t\t\t // Handle primitives\r\n\r\n\t\t\t var parameters = this.parameters;\r\n\r\n\t\t\t if ( parameters !== undefined ) {\r\n\r\n\t\t\t var values = [];\r\n\r\n\t\t\t for ( var key in parameters ) {\r\n\r\n\t\t\t values.push( parameters[ key ] );\r\n\r\n\t\t\t }\r\n\r\n\t\t\t var geometry = Object.create( this.constructor.prototype );\r\n\t\t\t this.constructor.apply( geometry, values );\r\n\t\t\t return geometry;\r\n\r\n\t\t\t }\r\n\r\n\t\t\t return new this.constructor().copy( this );\r\n\t\t\t */\r\n\r\n\t\t\treturn new Geometry().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tvar i, il, j, jl, k, kl;\r\n\r\n\t\t\t// reset\r\n\r\n\t\t\tthis.vertices = [];\r\n\t\t\tthis.colors = [];\r\n\t\t\tthis.faces = [];\r\n\t\t\tthis.faceVertexUvs = [[]];\r\n\t\t\tthis.morphTargets = [];\r\n\t\t\tthis.morphNormals = [];\r\n\t\t\tthis.skinWeights = [];\r\n\t\t\tthis.skinIndices = [];\r\n\t\t\tthis.lineDistances = [];\r\n\t\t\tthis.boundingBox = null;\r\n\t\t\tthis.boundingSphere = null;\r\n\r\n\t\t\t// name\r\n\r\n\t\t\tthis.name = source.name;\r\n\r\n\t\t\t// vertices\r\n\r\n\t\t\tvar vertices = source.vertices;\r\n\r\n\t\t\tfor ( i = 0, il = vertices.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tthis.vertices.push( vertices[ i ].clone() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// colors\r\n\r\n\t\t\tvar colors = source.colors;\r\n\r\n\t\t\tfor ( i = 0, il = colors.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tthis.colors.push( colors[ i ].clone() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// faces\r\n\r\n\t\t\tvar faces = source.faces;\r\n\r\n\t\t\tfor ( i = 0, il = faces.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tthis.faces.push( faces[ i ].clone() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// face vertex uvs\r\n\r\n\t\t\tfor ( i = 0, il = source.faceVertexUvs.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvar faceVertexUvs = source.faceVertexUvs[ i ];\r\n\r\n\t\t\t\tif ( this.faceVertexUvs[ i ] === undefined ) {\r\n\r\n\t\t\t\t\tthis.faceVertexUvs[ i ] = [];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor ( j = 0, jl = faceVertexUvs.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\tvar uvs = faceVertexUvs[ j ], uvsCopy = [];\r\n\r\n\t\t\t\t\tfor ( k = 0, kl = uvs.length; k < kl; k ++ ) {\r\n\r\n\t\t\t\t\t\tvar uv = uvs[ k ];\r\n\r\n\t\t\t\t\t\tuvsCopy.push( uv.clone() );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.faceVertexUvs[ i ].push( uvsCopy );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// morph targets\r\n\r\n\t\t\tvar morphTargets = source.morphTargets;\r\n\r\n\t\t\tfor ( i = 0, il = morphTargets.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvar morphTarget = {};\r\n\t\t\t\tmorphTarget.name = morphTargets[ i ].name;\r\n\r\n\t\t\t\t// vertices\r\n\r\n\t\t\t\tif ( morphTargets[ i ].vertices !== undefined ) {\r\n\r\n\t\t\t\t\tmorphTarget.vertices = [];\r\n\r\n\t\t\t\t\tfor ( j = 0, jl = morphTargets[ i ].vertices.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\t\tmorphTarget.vertices.push( morphTargets[ i ].vertices[ j ].clone() );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// normals\r\n\r\n\t\t\t\tif ( morphTargets[ i ].normals !== undefined ) {\r\n\r\n\t\t\t\t\tmorphTarget.normals = [];\r\n\r\n\t\t\t\t\tfor ( j = 0, jl = morphTargets[ i ].normals.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\t\tmorphTarget.normals.push( morphTargets[ i ].normals[ j ].clone() );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.morphTargets.push( morphTarget );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// morph normals\r\n\r\n\t\t\tvar morphNormals = source.morphNormals;\r\n\r\n\t\t\tfor ( i = 0, il = morphNormals.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvar morphNormal = {};\r\n\r\n\t\t\t\t// vertex normals\r\n\r\n\t\t\t\tif ( morphNormals[ i ].vertexNormals !== undefined ) {\r\n\r\n\t\t\t\t\tmorphNormal.vertexNormals = [];\r\n\r\n\t\t\t\t\tfor ( j = 0, jl = morphNormals[ i ].vertexNormals.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\t\tvar srcVertexNormal = morphNormals[ i ].vertexNormals[ j ];\r\n\t\t\t\t\t\tvar destVertexNormal = {};\r\n\r\n\t\t\t\t\t\tdestVertexNormal.a = srcVertexNormal.a.clone();\r\n\t\t\t\t\t\tdestVertexNormal.b = srcVertexNormal.b.clone();\r\n\t\t\t\t\t\tdestVertexNormal.c = srcVertexNormal.c.clone();\r\n\r\n\t\t\t\t\t\tmorphNormal.vertexNormals.push( destVertexNormal );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// face normals\r\n\r\n\t\t\t\tif ( morphNormals[ i ].faceNormals !== undefined ) {\r\n\r\n\t\t\t\t\tmorphNormal.faceNormals = [];\r\n\r\n\t\t\t\t\tfor ( j = 0, jl = morphNormals[ i ].faceNormals.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\t\tmorphNormal.faceNormals.push( morphNormals[ i ].faceNormals[ j ].clone() );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.morphNormals.push( morphNormal );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// skin weights\r\n\r\n\t\t\tvar skinWeights = source.skinWeights;\r\n\r\n\t\t\tfor ( i = 0, il = skinWeights.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tthis.skinWeights.push( skinWeights[ i ].clone() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// skin indices\r\n\r\n\t\t\tvar skinIndices = source.skinIndices;\r\n\r\n\t\t\tfor ( i = 0, il = skinIndices.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tthis.skinIndices.push( skinIndices[ i ].clone() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// line distances\r\n\r\n\t\t\tvar lineDistances = source.lineDistances;\r\n\r\n\t\t\tfor ( i = 0, il = lineDistances.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tthis.lineDistances.push( lineDistances[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// bounding box\r\n\r\n\t\t\tvar boundingBox = source.boundingBox;\r\n\r\n\t\t\tif ( boundingBox !== null ) {\r\n\r\n\t\t\t\tthis.boundingBox = boundingBox.clone();\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// bounding sphere\r\n\r\n\t\t\tvar boundingSphere = source.boundingSphere;\r\n\r\n\t\t\tif ( boundingSphere !== null ) {\r\n\r\n\t\t\t\tthis.boundingSphere = boundingSphere.clone();\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// update flags\r\n\r\n\t\t\tthis.elementsNeedUpdate = source.elementsNeedUpdate;\r\n\t\t\tthis.verticesNeedUpdate = source.verticesNeedUpdate;\r\n\t\t\tthis.uvsNeedUpdate = source.uvsNeedUpdate;\r\n\t\t\tthis.normalsNeedUpdate = source.normalsNeedUpdate;\r\n\t\t\tthis.colorsNeedUpdate = source.colorsNeedUpdate;\r\n\t\t\tthis.lineDistancesNeedUpdate = source.lineDistancesNeedUpdate;\r\n\t\t\tthis.groupsNeedUpdate = source.groupsNeedUpdate;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tdispose: function () {\r\n\r\n\t\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction BufferAttribute( array, itemSize, normalized ) {\r\n\r\n\t\tif ( Array.isArray( array ) ) {\r\n\r\n\t\t\tthrow new TypeError( 'THREE.BufferAttribute: array should be a Typed Array.' );\r\n\r\n\t\t}\r\n\r\n\t\tthis.name = '';\r\n\r\n\t\tthis.array = array;\r\n\t\tthis.itemSize = itemSize;\r\n\t\tthis.count = array !== undefined ? array.length / itemSize : 0;\r\n\t\tthis.normalized = normalized === true;\r\n\r\n\t\tthis.dynamic = false;\r\n\t\tthis.updateRange = { offset: 0, count: - 1 };\r\n\r\n\t\tthis.version = 0;\r\n\r\n\t}\r\n\r\n\tObject.defineProperty( BufferAttribute.prototype, 'needsUpdate', {\r\n\r\n\t\tset: function ( value ) {\r\n\r\n\t\t\tif ( value === true ) this.version ++;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( BufferAttribute.prototype, {\r\n\r\n\t\tisBufferAttribute: true,\r\n\r\n\t\tonUploadCallback: function () {},\r\n\r\n\t\tsetArray: function ( array ) {\r\n\r\n\t\t\tif ( Array.isArray( array ) ) {\r\n\r\n\t\t\t\tthrow new TypeError( 'THREE.BufferAttribute: array should be a Typed Array.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.count = array !== undefined ? array.length / this.itemSize : 0;\r\n\t\t\tthis.array = array;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetDynamic: function ( value ) {\r\n\r\n\t\t\tthis.dynamic = value;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tthis.name = source.name;\r\n\t\t\tthis.array = new source.array.constructor( source.array );\r\n\t\t\tthis.itemSize = source.itemSize;\r\n\t\t\tthis.count = source.count;\r\n\t\t\tthis.normalized = source.normalized;\r\n\r\n\t\t\tthis.dynamic = source.dynamic;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcopyAt: function ( index1, attribute, index2 ) {\r\n\r\n\t\t\tindex1 *= this.itemSize;\r\n\t\t\tindex2 *= attribute.itemSize;\r\n\r\n\t\t\tfor ( var i = 0, l = this.itemSize; i < l; i ++ ) {\r\n\r\n\t\t\t\tthis.array[ index1 + i ] = attribute.array[ index2 + i ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcopyArray: function ( array ) {\r\n\r\n\t\t\tthis.array.set( array );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcopyColorsArray: function ( colors ) {\r\n\r\n\t\t\tvar array = this.array, offset = 0;\r\n\r\n\t\t\tfor ( var i = 0, l = colors.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar color = colors[ i ];\r\n\r\n\t\t\t\tif ( color === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyColorsArray(): color is undefined', i );\r\n\t\t\t\t\tcolor = new Color();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tarray[ offset ++ ] = color.r;\r\n\t\t\t\tarray[ offset ++ ] = color.g;\r\n\t\t\t\tarray[ offset ++ ] = color.b;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcopyVector2sArray: function ( vectors ) {\r\n\r\n\t\t\tvar array = this.array, offset = 0;\r\n\r\n\t\t\tfor ( var i = 0, l = vectors.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar vector = vectors[ i ];\r\n\r\n\t\t\t\tif ( vector === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyVector2sArray(): vector is undefined', i );\r\n\t\t\t\t\tvector = new Vector2();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tarray[ offset ++ ] = vector.x;\r\n\t\t\t\tarray[ offset ++ ] = vector.y;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcopyVector3sArray: function ( vectors ) {\r\n\r\n\t\t\tvar array = this.array, offset = 0;\r\n\r\n\t\t\tfor ( var i = 0, l = vectors.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar vector = vectors[ i ];\r\n\r\n\t\t\t\tif ( vector === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyVector3sArray(): vector is undefined', i );\r\n\t\t\t\t\tvector = new Vector3();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tarray[ offset ++ ] = vector.x;\r\n\t\t\t\tarray[ offset ++ ] = vector.y;\r\n\t\t\t\tarray[ offset ++ ] = vector.z;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcopyVector4sArray: function ( vectors ) {\r\n\r\n\t\t\tvar array = this.array, offset = 0;\r\n\r\n\t\t\tfor ( var i = 0, l = vectors.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar vector = vectors[ i ];\r\n\r\n\t\t\t\tif ( vector === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyVector4sArray(): vector is undefined', i );\r\n\t\t\t\t\tvector = new Vector4();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tarray[ offset ++ ] = vector.x;\r\n\t\t\t\tarray[ offset ++ ] = vector.y;\r\n\t\t\t\tarray[ offset ++ ] = vector.z;\r\n\t\t\t\tarray[ offset ++ ] = vector.w;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tset: function ( value, offset ) {\r\n\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\t\tthis.array.set( value, offset );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetX: function ( index ) {\r\n\r\n\t\t\treturn this.array[ index * this.itemSize ];\r\n\r\n\t\t},\r\n\r\n\t\tsetX: function ( index, x ) {\r\n\r\n\t\t\tthis.array[ index * this.itemSize ] = x;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetY: function ( index ) {\r\n\r\n\t\t\treturn this.array[ index * this.itemSize + 1 ];\r\n\r\n\t\t},\r\n\r\n\t\tsetY: function ( index, y ) {\r\n\r\n\t\t\tthis.array[ index * this.itemSize + 1 ] = y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetZ: function ( index ) {\r\n\r\n\t\t\treturn this.array[ index * this.itemSize + 2 ];\r\n\r\n\t\t},\r\n\r\n\t\tsetZ: function ( index, z ) {\r\n\r\n\t\t\tthis.array[ index * this.itemSize + 2 ] = z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetW: function ( index ) {\r\n\r\n\t\t\treturn this.array[ index * this.itemSize + 3 ];\r\n\r\n\t\t},\r\n\r\n\t\tsetW: function ( index, w ) {\r\n\r\n\t\t\tthis.array[ index * this.itemSize + 3 ] = w;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetXY: function ( index, x, y ) {\r\n\r\n\t\t\tindex *= this.itemSize;\r\n\r\n\t\t\tthis.array[ index + 0 ] = x;\r\n\t\t\tthis.array[ index + 1 ] = y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetXYZ: function ( index, x, y, z ) {\r\n\r\n\t\t\tindex *= this.itemSize;\r\n\r\n\t\t\tthis.array[ index + 0 ] = x;\r\n\t\t\tthis.array[ index + 1 ] = y;\r\n\t\t\tthis.array[ index + 2 ] = z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetXYZW: function ( index, x, y, z, w ) {\r\n\r\n\t\t\tindex *= this.itemSize;\r\n\r\n\t\t\tthis.array[ index + 0 ] = x;\r\n\t\t\tthis.array[ index + 1 ] = y;\r\n\t\t\tthis.array[ index + 2 ] = z;\r\n\t\t\tthis.array[ index + 3 ] = w;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tonUpload: function ( callback ) {\r\n\r\n\t\t\tthis.onUploadCallback = callback;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor( this.array, this.itemSize ).copy( this );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t//\r\n\r\n\tfunction Int8BufferAttribute( array, itemSize, normalized ) {\r\n\r\n\t\tBufferAttribute.call( this, new Int8Array( array ), itemSize, normalized );\r\n\r\n\t}\r\n\r\n\tInt8BufferAttribute.prototype = Object.create( BufferAttribute.prototype );\r\n\tInt8BufferAttribute.prototype.constructor = Int8BufferAttribute;\r\n\r\n\r\n\tfunction Uint8BufferAttribute( array, itemSize, normalized ) {\r\n\r\n\t\tBufferAttribute.call( this, new Uint8Array( array ), itemSize, normalized );\r\n\r\n\t}\r\n\r\n\tUint8BufferAttribute.prototype = Object.create( BufferAttribute.prototype );\r\n\tUint8BufferAttribute.prototype.constructor = Uint8BufferAttribute;\r\n\r\n\r\n\tfunction Uint8ClampedBufferAttribute( array, itemSize, normalized ) {\r\n\r\n\t\tBufferAttribute.call( this, new Uint8ClampedArray( array ), itemSize, normalized );\r\n\r\n\t}\r\n\r\n\tUint8ClampedBufferAttribute.prototype = Object.create( BufferAttribute.prototype );\r\n\tUint8ClampedBufferAttribute.prototype.constructor = Uint8ClampedBufferAttribute;\r\n\r\n\r\n\tfunction Int16BufferAttribute( array, itemSize, normalized ) {\r\n\r\n\t\tBufferAttribute.call( this, new Int16Array( array ), itemSize, normalized );\r\n\r\n\t}\r\n\r\n\tInt16BufferAttribute.prototype = Object.create( BufferAttribute.prototype );\r\n\tInt16BufferAttribute.prototype.constructor = Int16BufferAttribute;\r\n\r\n\r\n\tfunction Uint16BufferAttribute( array, itemSize, normalized ) {\r\n\r\n\t\tBufferAttribute.call( this, new Uint16Array( array ), itemSize, normalized );\r\n\r\n\t}\r\n\r\n\tUint16BufferAttribute.prototype = Object.create( BufferAttribute.prototype );\r\n\tUint16BufferAttribute.prototype.constructor = Uint16BufferAttribute;\r\n\r\n\r\n\tfunction Int32BufferAttribute( array, itemSize, normalized ) {\r\n\r\n\t\tBufferAttribute.call( this, new Int32Array( array ), itemSize, normalized );\r\n\r\n\t}\r\n\r\n\tInt32BufferAttribute.prototype = Object.create( BufferAttribute.prototype );\r\n\tInt32BufferAttribute.prototype.constructor = Int32BufferAttribute;\r\n\r\n\r\n\tfunction Uint32BufferAttribute( array, itemSize, normalized ) {\r\n\r\n\t\tBufferAttribute.call( this, new Uint32Array( array ), itemSize, normalized );\r\n\r\n\t}\r\n\r\n\tUint32BufferAttribute.prototype = Object.create( BufferAttribute.prototype );\r\n\tUint32BufferAttribute.prototype.constructor = Uint32BufferAttribute;\r\n\r\n\r\n\tfunction Float32BufferAttribute( array, itemSize, normalized ) {\r\n\r\n\t\tBufferAttribute.call( this, new Float32Array( array ), itemSize, normalized );\r\n\r\n\t}\r\n\r\n\tFloat32BufferAttribute.prototype = Object.create( BufferAttribute.prototype );\r\n\tFloat32BufferAttribute.prototype.constructor = Float32BufferAttribute;\r\n\r\n\r\n\tfunction Float64BufferAttribute( array, itemSize, normalized ) {\r\n\r\n\t\tBufferAttribute.call( this, new Float64Array( array ), itemSize, normalized );\r\n\r\n\t}\r\n\r\n\tFloat64BufferAttribute.prototype = Object.create( BufferAttribute.prototype );\r\n\tFloat64BufferAttribute.prototype.constructor = Float64BufferAttribute;\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction DirectGeometry() {\r\n\r\n\t\tthis.vertices = [];\r\n\t\tthis.normals = [];\r\n\t\tthis.colors = [];\r\n\t\tthis.uvs = [];\r\n\t\tthis.uvs2 = [];\r\n\r\n\t\tthis.groups = [];\r\n\r\n\t\tthis.morphTargets = {};\r\n\r\n\t\tthis.skinWeights = [];\r\n\t\tthis.skinIndices = [];\r\n\r\n\t\t// this.lineDistances = [];\r\n\r\n\t\tthis.boundingBox = null;\r\n\t\tthis.boundingSphere = null;\r\n\r\n\t\t// update flags\r\n\r\n\t\tthis.verticesNeedUpdate = false;\r\n\t\tthis.normalsNeedUpdate = false;\r\n\t\tthis.colorsNeedUpdate = false;\r\n\t\tthis.uvsNeedUpdate = false;\r\n\t\tthis.groupsNeedUpdate = false;\r\n\r\n\t}\r\n\r\n\tObject.assign( DirectGeometry.prototype, {\r\n\r\n\t\tcomputeGroups: function ( geometry ) {\r\n\r\n\t\t\tvar group;\r\n\t\t\tvar groups = [];\r\n\t\t\tvar materialIndex = undefined;\r\n\r\n\t\t\tvar faces = geometry.faces;\r\n\r\n\t\t\tfor ( var i = 0; i < faces.length; i ++ ) {\r\n\r\n\t\t\t\tvar face = faces[ i ];\r\n\r\n\t\t\t\t// materials\r\n\r\n\t\t\t\tif ( face.materialIndex !== materialIndex ) {\r\n\r\n\t\t\t\t\tmaterialIndex = face.materialIndex;\r\n\r\n\t\t\t\t\tif ( group !== undefined ) {\r\n\r\n\t\t\t\t\t\tgroup.count = ( i * 3 ) - group.start;\r\n\t\t\t\t\t\tgroups.push( group );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tgroup = {\r\n\t\t\t\t\t\tstart: i * 3,\r\n\t\t\t\t\t\tmaterialIndex: materialIndex\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( group !== undefined ) {\r\n\r\n\t\t\t\tgroup.count = ( i * 3 ) - group.start;\r\n\t\t\t\tgroups.push( group );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.groups = groups;\r\n\r\n\t\t},\r\n\r\n\t\tfromGeometry: function ( geometry ) {\r\n\r\n\t\t\tvar faces = geometry.faces;\r\n\t\t\tvar vertices = geometry.vertices;\r\n\t\t\tvar faceVertexUvs = geometry.faceVertexUvs;\r\n\r\n\t\t\tvar hasFaceVertexUv = faceVertexUvs[ 0 ] && faceVertexUvs[ 0 ].length > 0;\r\n\t\t\tvar hasFaceVertexUv2 = faceVertexUvs[ 1 ] && faceVertexUvs[ 1 ].length > 0;\r\n\r\n\t\t\t// morphs\r\n\r\n\t\t\tvar morphTargets = geometry.morphTargets;\r\n\t\t\tvar morphTargetsLength = morphTargets.length;\r\n\r\n\t\t\tvar morphTargetsPosition;\r\n\r\n\t\t\tif ( morphTargetsLength > 0 ) {\r\n\r\n\t\t\t\tmorphTargetsPosition = [];\r\n\r\n\t\t\t\tfor ( var i = 0; i < morphTargetsLength; i ++ ) {\r\n\r\n\t\t\t\t\tmorphTargetsPosition[ i ] = {\r\n\t\t\t\t\t\tname: morphTargets[ i ].name,\r\n\t\t\t\t\t \tdata: []\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.morphTargets.position = morphTargetsPosition;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar morphNormals = geometry.morphNormals;\r\n\t\t\tvar morphNormalsLength = morphNormals.length;\r\n\r\n\t\t\tvar morphTargetsNormal;\r\n\r\n\t\t\tif ( morphNormalsLength > 0 ) {\r\n\r\n\t\t\t\tmorphTargetsNormal = [];\r\n\r\n\t\t\t\tfor ( var i = 0; i < morphNormalsLength; i ++ ) {\r\n\r\n\t\t\t\t\tmorphTargetsNormal[ i ] = {\r\n\t\t\t\t\t\tname: morphNormals[ i ].name,\r\n\t\t\t\t\t \tdata: []\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.morphTargets.normal = morphTargetsNormal;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// skins\r\n\r\n\t\t\tvar skinIndices = geometry.skinIndices;\r\n\t\t\tvar skinWeights = geometry.skinWeights;\r\n\r\n\t\t\tvar hasSkinIndices = skinIndices.length === vertices.length;\r\n\t\t\tvar hasSkinWeights = skinWeights.length === vertices.length;\r\n\r\n\t\t\t//\r\n\r\n\t\t\tif ( vertices.length > 0 && faces.length === 0 ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.DirectGeometry: Faceless geometries are not supported.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var i = 0; i < faces.length; i ++ ) {\r\n\r\n\t\t\t\tvar face = faces[ i ];\r\n\r\n\t\t\t\tthis.vertices.push( vertices[ face.a ], vertices[ face.b ], vertices[ face.c ] );\r\n\r\n\t\t\t\tvar vertexNormals = face.vertexNormals;\r\n\r\n\t\t\t\tif ( vertexNormals.length === 3 ) {\r\n\r\n\t\t\t\t\tthis.normals.push( vertexNormals[ 0 ], vertexNormals[ 1 ], vertexNormals[ 2 ] );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tvar normal = face.normal;\r\n\r\n\t\t\t\t\tthis.normals.push( normal, normal, normal );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar vertexColors = face.vertexColors;\r\n\r\n\t\t\t\tif ( vertexColors.length === 3 ) {\r\n\r\n\t\t\t\t\tthis.colors.push( vertexColors[ 0 ], vertexColors[ 1 ], vertexColors[ 2 ] );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tvar color = face.color;\r\n\r\n\t\t\t\t\tthis.colors.push( color, color, color );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( hasFaceVertexUv === true ) {\r\n\r\n\t\t\t\t\tvar vertexUvs = faceVertexUvs[ 0 ][ i ];\r\n\r\n\t\t\t\t\tif ( vertexUvs !== undefined ) {\r\n\r\n\t\t\t\t\t\tthis.uvs.push( vertexUvs[ 0 ], vertexUvs[ 1 ], vertexUvs[ 2 ] );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tconsole.warn( 'THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ', i );\r\n\r\n\t\t\t\t\t\tthis.uvs.push( new Vector2(), new Vector2(), new Vector2() );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( hasFaceVertexUv2 === true ) {\r\n\r\n\t\t\t\t\tvar vertexUvs = faceVertexUvs[ 1 ][ i ];\r\n\r\n\t\t\t\t\tif ( vertexUvs !== undefined ) {\r\n\r\n\t\t\t\t\t\tthis.uvs2.push( vertexUvs[ 0 ], vertexUvs[ 1 ], vertexUvs[ 2 ] );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tconsole.warn( 'THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ', i );\r\n\r\n\t\t\t\t\t\tthis.uvs2.push( new Vector2(), new Vector2(), new Vector2() );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// morphs\r\n\r\n\t\t\t\tfor ( var j = 0; j < morphTargetsLength; j ++ ) {\r\n\r\n\t\t\t\t\tvar morphTarget = morphTargets[ j ].vertices;\r\n\r\n\t\t\t\t\tmorphTargetsPosition[ j ].data.push( morphTarget[ face.a ], morphTarget[ face.b ], morphTarget[ face.c ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor ( var j = 0; j < morphNormalsLength; j ++ ) {\r\n\r\n\t\t\t\t\tvar morphNormal = morphNormals[ j ].vertexNormals[ i ];\r\n\r\n\t\t\t\t\tmorphTargetsNormal[ j ].data.push( morphNormal.a, morphNormal.b, morphNormal.c );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// skins\r\n\r\n\t\t\t\tif ( hasSkinIndices ) {\r\n\r\n\t\t\t\t\tthis.skinIndices.push( skinIndices[ face.a ], skinIndices[ face.b ], skinIndices[ face.c ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( hasSkinWeights ) {\r\n\r\n\t\t\t\t\tthis.skinWeights.push( skinWeights[ face.a ], skinWeights[ face.b ], skinWeights[ face.c ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.computeGroups( geometry );\r\n\r\n\t\t\tthis.verticesNeedUpdate = geometry.verticesNeedUpdate;\r\n\t\t\tthis.normalsNeedUpdate = geometry.normalsNeedUpdate;\r\n\t\t\tthis.colorsNeedUpdate = geometry.colorsNeedUpdate;\r\n\t\t\tthis.uvsNeedUpdate = geometry.uvsNeedUpdate;\r\n\t\t\tthis.groupsNeedUpdate = geometry.groupsNeedUpdate;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction arrayMax( array ) {\r\n\r\n\t\tif ( array.length === 0 ) return - Infinity;\r\n\r\n\t\tvar max = array[ 0 ];\r\n\r\n\t\tfor ( var i = 1, l = array.length; i < l; ++ i ) {\r\n\r\n\t\t\tif ( array[ i ] > max ) max = array[ i ];\r\n\r\n\t\t}\r\n\r\n\t\treturn max;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tvar bufferGeometryId = 1; // BufferGeometry uses odd numbers as Id\r\n\r\n\tfunction BufferGeometry() {\r\n\r\n\t\tObject.defineProperty( this, 'id', { value: bufferGeometryId += 2 } );\r\n\r\n\t\tthis.uuid = _Math.generateUUID();\r\n\r\n\t\tthis.name = '';\r\n\t\tthis.type = 'BufferGeometry';\r\n\r\n\t\tthis.index = null;\r\n\t\tthis.attributes = {};\r\n\r\n\t\tthis.morphAttributes = {};\r\n\r\n\t\tthis.groups = [];\r\n\r\n\t\tthis.boundingBox = null;\r\n\t\tthis.boundingSphere = null;\r\n\r\n\t\tthis.drawRange = { start: 0, count: Infinity };\r\n\r\n\t\tthis.userData = {};\r\n\r\n\t}\r\n\r\n\tBufferGeometry.prototype = Object.assign( Object.create( EventDispatcher.prototype ), {\r\n\r\n\t\tconstructor: BufferGeometry,\r\n\r\n\t\tisBufferGeometry: true,\r\n\r\n\t\tgetIndex: function () {\r\n\r\n\t\t\treturn this.index;\r\n\r\n\t\t},\r\n\r\n\t\tsetIndex: function ( index ) {\r\n\r\n\t\t\tif ( Array.isArray( index ) ) {\r\n\r\n\t\t\t\tthis.index = new ( arrayMax( index ) > 65535 ? Uint32BufferAttribute : Uint16BufferAttribute )( index, 1 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.index = index;\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\taddAttribute: function ( name, attribute ) {\r\n\r\n\t\t\tif ( ! ( attribute && attribute.isBufferAttribute ) && ! ( attribute && attribute.isInterleavedBufferAttribute ) ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.BufferGeometry: .addAttribute() now expects ( name, attribute ).' );\r\n\r\n\t\t\t\treturn this.addAttribute( name, new BufferAttribute( arguments[ 1 ], arguments[ 2 ] ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( name === 'index' ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute.' );\r\n\t\t\t\tthis.setIndex( attribute );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.attributes[ name ] = attribute;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetAttribute: function ( name ) {\r\n\r\n\t\t\treturn this.attributes[ name ];\r\n\r\n\t\t},\r\n\r\n\t\tremoveAttribute: function ( name ) {\r\n\r\n\t\t\tdelete this.attributes[ name ];\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\taddGroup: function ( start, count, materialIndex ) {\r\n\r\n\t\t\tthis.groups.push( {\r\n\r\n\t\t\t\tstart: start,\r\n\t\t\t\tcount: count,\r\n\t\t\t\tmaterialIndex: materialIndex !== undefined ? materialIndex : 0\r\n\r\n\t\t\t} );\r\n\r\n\t\t},\r\n\r\n\t\tclearGroups: function () {\r\n\r\n\t\t\tthis.groups = [];\r\n\r\n\t\t},\r\n\r\n\t\tsetDrawRange: function ( start, count ) {\r\n\r\n\t\t\tthis.drawRange.start = start;\r\n\t\t\tthis.drawRange.count = count;\r\n\r\n\t\t},\r\n\r\n\t\tapplyMatrix: function ( matrix ) {\r\n\r\n\t\t\tvar position = this.attributes.position;\r\n\r\n\t\t\tif ( position !== undefined ) {\r\n\r\n\t\t\t\tmatrix.applyToBufferAttribute( position );\r\n\t\t\t\tposition.needsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar normal = this.attributes.normal;\r\n\r\n\t\t\tif ( normal !== undefined ) {\r\n\r\n\t\t\t\tvar normalMatrix = new Matrix3().getNormalMatrix( matrix );\r\n\r\n\t\t\t\tnormalMatrix.applyToBufferAttribute( normal );\r\n\t\t\t\tnormal.needsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.boundingBox !== null ) {\r\n\r\n\t\t\t\tthis.computeBoundingBox();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.boundingSphere !== null ) {\r\n\r\n\t\t\t\tthis.computeBoundingSphere();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\trotateX: function () {\r\n\r\n\t\t\t// rotate geometry around world x-axis\r\n\r\n\t\t\tvar m1 = new Matrix4();\r\n\r\n\t\t\treturn function rotateX( angle ) {\r\n\r\n\t\t\t\tm1.makeRotationX( angle );\r\n\r\n\t\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\trotateY: function () {\r\n\r\n\t\t\t// rotate geometry around world y-axis\r\n\r\n\t\t\tvar m1 = new Matrix4();\r\n\r\n\t\t\treturn function rotateY( angle ) {\r\n\r\n\t\t\t\tm1.makeRotationY( angle );\r\n\r\n\t\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\trotateZ: function () {\r\n\r\n\t\t\t// rotate geometry around world z-axis\r\n\r\n\t\t\tvar m1 = new Matrix4();\r\n\r\n\t\t\treturn function rotateZ( angle ) {\r\n\r\n\t\t\t\tm1.makeRotationZ( angle );\r\n\r\n\t\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\ttranslate: function () {\r\n\r\n\t\t\t// translate geometry\r\n\r\n\t\t\tvar m1 = new Matrix4();\r\n\r\n\t\t\treturn function translate( x, y, z ) {\r\n\r\n\t\t\t\tm1.makeTranslation( x, y, z );\r\n\r\n\t\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tscale: function () {\r\n\r\n\t\t\t// scale geometry\r\n\r\n\t\t\tvar m1 = new Matrix4();\r\n\r\n\t\t\treturn function scale( x, y, z ) {\r\n\r\n\t\t\t\tm1.makeScale( x, y, z );\r\n\r\n\t\t\t\tthis.applyMatrix( m1 );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tlookAt: function () {\r\n\r\n\t\t\tvar obj = new Object3D();\r\n\r\n\t\t\treturn function lookAt( vector ) {\r\n\r\n\t\t\t\tobj.lookAt( vector );\r\n\r\n\t\t\t\tobj.updateMatrix();\r\n\r\n\t\t\t\tthis.applyMatrix( obj.matrix );\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tcenter: function () {\r\n\r\n\t\t\tvar offset = new Vector3();\r\n\r\n\t\t\treturn function center() {\r\n\r\n\t\t\t\tthis.computeBoundingBox();\r\n\r\n\t\t\t\tthis.boundingBox.getCenter( offset ).negate();\r\n\r\n\t\t\t\tthis.translate( offset.x, offset.y, offset.z );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tsetFromObject: function ( object ) {\r\n\r\n\t\t\t// console.log( 'THREE.BufferGeometry.setFromObject(). Converting', object, this );\r\n\r\n\t\t\tvar geometry = object.geometry;\r\n\r\n\t\t\tif ( object.isPoints || object.isLine ) {\r\n\r\n\t\t\t\tvar positions = new Float32BufferAttribute( geometry.vertices.length * 3, 3 );\r\n\t\t\t\tvar colors = new Float32BufferAttribute( geometry.colors.length * 3, 3 );\r\n\r\n\t\t\t\tthis.addAttribute( 'position', positions.copyVector3sArray( geometry.vertices ) );\r\n\t\t\t\tthis.addAttribute( 'color', colors.copyColorsArray( geometry.colors ) );\r\n\r\n\t\t\t\tif ( geometry.lineDistances && geometry.lineDistances.length === geometry.vertices.length ) {\r\n\r\n\t\t\t\t\tvar lineDistances = new Float32BufferAttribute( geometry.lineDistances.length, 1 );\r\n\r\n\t\t\t\t\tthis.addAttribute( 'lineDistance', lineDistances.copyArray( geometry.lineDistances ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( geometry.boundingSphere !== null ) {\r\n\r\n\t\t\t\t\tthis.boundingSphere = geometry.boundingSphere.clone();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( geometry.boundingBox !== null ) {\r\n\r\n\t\t\t\t\tthis.boundingBox = geometry.boundingBox.clone();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( object.isMesh ) {\r\n\r\n\t\t\t\tif ( geometry && geometry.isGeometry ) {\r\n\r\n\t\t\t\t\tthis.fromGeometry( geometry );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromPoints: function ( points ) {\r\n\r\n\t\t\tvar position = [];\r\n\r\n\t\t\tfor ( var i = 0, l = points.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar point = points[ i ];\r\n\t\t\t\tposition.push( point.x, point.y, point.z || 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.addAttribute( 'position', new Float32BufferAttribute( position, 3 ) );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tupdateFromObject: function ( object ) {\r\n\r\n\t\t\tvar geometry = object.geometry;\r\n\r\n\t\t\tif ( object.isMesh ) {\r\n\r\n\t\t\t\tvar direct = geometry.__directGeometry;\r\n\r\n\t\t\t\tif ( geometry.elementsNeedUpdate === true ) {\r\n\r\n\t\t\t\t\tdirect = undefined;\r\n\t\t\t\t\tgeometry.elementsNeedUpdate = false;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( direct === undefined ) {\r\n\r\n\t\t\t\t\treturn this.fromGeometry( geometry );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdirect.verticesNeedUpdate = geometry.verticesNeedUpdate;\r\n\t\t\t\tdirect.normalsNeedUpdate = geometry.normalsNeedUpdate;\r\n\t\t\t\tdirect.colorsNeedUpdate = geometry.colorsNeedUpdate;\r\n\t\t\t\tdirect.uvsNeedUpdate = geometry.uvsNeedUpdate;\r\n\t\t\t\tdirect.groupsNeedUpdate = geometry.groupsNeedUpdate;\r\n\r\n\t\t\t\tgeometry.verticesNeedUpdate = false;\r\n\t\t\t\tgeometry.normalsNeedUpdate = false;\r\n\t\t\t\tgeometry.colorsNeedUpdate = false;\r\n\t\t\t\tgeometry.uvsNeedUpdate = false;\r\n\t\t\t\tgeometry.groupsNeedUpdate = false;\r\n\r\n\t\t\t\tgeometry = direct;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar attribute;\r\n\r\n\t\t\tif ( geometry.verticesNeedUpdate === true ) {\r\n\r\n\t\t\t\tattribute = this.attributes.position;\r\n\r\n\t\t\t\tif ( attribute !== undefined ) {\r\n\r\n\t\t\t\t\tattribute.copyVector3sArray( geometry.vertices );\r\n\t\t\t\t\tattribute.needsUpdate = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgeometry.verticesNeedUpdate = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( geometry.normalsNeedUpdate === true ) {\r\n\r\n\t\t\t\tattribute = this.attributes.normal;\r\n\r\n\t\t\t\tif ( attribute !== undefined ) {\r\n\r\n\t\t\t\t\tattribute.copyVector3sArray( geometry.normals );\r\n\t\t\t\t\tattribute.needsUpdate = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgeometry.normalsNeedUpdate = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( geometry.colorsNeedUpdate === true ) {\r\n\r\n\t\t\t\tattribute = this.attributes.color;\r\n\r\n\t\t\t\tif ( attribute !== undefined ) {\r\n\r\n\t\t\t\t\tattribute.copyColorsArray( geometry.colors );\r\n\t\t\t\t\tattribute.needsUpdate = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgeometry.colorsNeedUpdate = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( geometry.uvsNeedUpdate ) {\r\n\r\n\t\t\t\tattribute = this.attributes.uv;\r\n\r\n\t\t\t\tif ( attribute !== undefined ) {\r\n\r\n\t\t\t\t\tattribute.copyVector2sArray( geometry.uvs );\r\n\t\t\t\t\tattribute.needsUpdate = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgeometry.uvsNeedUpdate = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( geometry.lineDistancesNeedUpdate ) {\r\n\r\n\t\t\t\tattribute = this.attributes.lineDistance;\r\n\r\n\t\t\t\tif ( attribute !== undefined ) {\r\n\r\n\t\t\t\t\tattribute.copyArray( geometry.lineDistances );\r\n\t\t\t\t\tattribute.needsUpdate = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgeometry.lineDistancesNeedUpdate = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( geometry.groupsNeedUpdate ) {\r\n\r\n\t\t\t\tgeometry.computeGroups( object.geometry );\r\n\t\t\t\tthis.groups = geometry.groups;\r\n\r\n\t\t\t\tgeometry.groupsNeedUpdate = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tfromGeometry: function ( geometry ) {\r\n\r\n\t\t\tgeometry.__directGeometry = new DirectGeometry().fromGeometry( geometry );\r\n\r\n\t\t\treturn this.fromDirectGeometry( geometry.__directGeometry );\r\n\r\n\t\t},\r\n\r\n\t\tfromDirectGeometry: function ( geometry ) {\r\n\r\n\t\t\tvar positions = new Float32Array( geometry.vertices.length * 3 );\r\n\t\t\tthis.addAttribute( 'position', new BufferAttribute( positions, 3 ).copyVector3sArray( geometry.vertices ) );\r\n\r\n\t\t\tif ( geometry.normals.length > 0 ) {\r\n\r\n\t\t\t\tvar normals = new Float32Array( geometry.normals.length * 3 );\r\n\t\t\t\tthis.addAttribute( 'normal', new BufferAttribute( normals, 3 ).copyVector3sArray( geometry.normals ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( geometry.colors.length > 0 ) {\r\n\r\n\t\t\t\tvar colors = new Float32Array( geometry.colors.length * 3 );\r\n\t\t\t\tthis.addAttribute( 'color', new BufferAttribute( colors, 3 ).copyColorsArray( geometry.colors ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( geometry.uvs.length > 0 ) {\r\n\r\n\t\t\t\tvar uvs = new Float32Array( geometry.uvs.length * 2 );\r\n\t\t\t\tthis.addAttribute( 'uv', new BufferAttribute( uvs, 2 ).copyVector2sArray( geometry.uvs ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( geometry.uvs2.length > 0 ) {\r\n\r\n\t\t\t\tvar uvs2 = new Float32Array( geometry.uvs2.length * 2 );\r\n\t\t\t\tthis.addAttribute( 'uv2', new BufferAttribute( uvs2, 2 ).copyVector2sArray( geometry.uvs2 ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// groups\r\n\r\n\t\t\tthis.groups = geometry.groups;\r\n\r\n\t\t\t// morphs\r\n\r\n\t\t\tfor ( var name in geometry.morphTargets ) {\r\n\r\n\t\t\t\tvar array = [];\r\n\t\t\t\tvar morphTargets = geometry.morphTargets[ name ];\r\n\r\n\t\t\t\tfor ( var i = 0, l = morphTargets.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tvar morphTarget = morphTargets[ i ];\r\n\r\n\t\t\t\t\tvar attribute = new Float32BufferAttribute( morphTarget.data.length * 3, 3 );\r\n\t\t\t\t\tattribute.name = morphTarget.name;\r\n\r\n\t\t\t\t\tarray.push( attribute.copyVector3sArray( morphTarget.data ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.morphAttributes[ name ] = array;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// skinning\r\n\r\n\t\t\tif ( geometry.skinIndices.length > 0 ) {\r\n\r\n\t\t\t\tvar skinIndices = new Float32BufferAttribute( geometry.skinIndices.length * 4, 4 );\r\n\t\t\t\tthis.addAttribute( 'skinIndex', skinIndices.copyVector4sArray( geometry.skinIndices ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( geometry.skinWeights.length > 0 ) {\r\n\r\n\t\t\t\tvar skinWeights = new Float32BufferAttribute( geometry.skinWeights.length * 4, 4 );\r\n\t\t\t\tthis.addAttribute( 'skinWeight', skinWeights.copyVector4sArray( geometry.skinWeights ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tif ( geometry.boundingSphere !== null ) {\r\n\r\n\t\t\t\tthis.boundingSphere = geometry.boundingSphere.clone();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( geometry.boundingBox !== null ) {\r\n\r\n\t\t\t\tthis.boundingBox = geometry.boundingBox.clone();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcomputeBoundingBox: function () {\r\n\r\n\t\t\tif ( this.boundingBox === null ) {\r\n\r\n\t\t\t\tthis.boundingBox = new Box3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar position = this.attributes.position;\r\n\r\n\t\t\tif ( position !== undefined ) {\r\n\r\n\t\t\t\tthis.boundingBox.setFromBufferAttribute( position );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.boundingBox.makeEmpty();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( isNaN( this.boundingBox.min.x ) || isNaN( this.boundingBox.min.y ) || isNaN( this.boundingBox.min.z ) ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The \"position\" attribute is likely to have NaN values.', this );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tcomputeBoundingSphere: function () {\r\n\r\n\t\t\tvar box = new Box3();\r\n\t\t\tvar vector = new Vector3();\r\n\r\n\t\t\treturn function computeBoundingSphere() {\r\n\r\n\t\t\t\tif ( this.boundingSphere === null ) {\r\n\r\n\t\t\t\t\tthis.boundingSphere = new Sphere();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar position = this.attributes.position;\r\n\r\n\t\t\t\tif ( position ) {\r\n\r\n\t\t\t\t\tvar center = this.boundingSphere.center;\r\n\r\n\t\t\t\t\tbox.setFromBufferAttribute( position );\r\n\t\t\t\t\tbox.getCenter( center );\r\n\r\n\t\t\t\t\t// hoping to find a boundingSphere with a radius smaller than the\r\n\t\t\t\t\t// boundingSphere of the boundingBox: sqrt(3) smaller in the best case\r\n\r\n\t\t\t\t\tvar maxRadiusSq = 0;\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = position.count; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\tvector.x = position.getX( i );\r\n\t\t\t\t\t\tvector.y = position.getY( i );\r\n\t\t\t\t\t\tvector.z = position.getZ( i );\r\n\t\t\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( vector ) );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.boundingSphere.radius = Math.sqrt( maxRadiusSq );\r\n\r\n\t\t\t\t\tif ( isNaN( this.boundingSphere.radius ) ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The \"position\" attribute is likely to have NaN values.', this );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tcomputeFaceNormals: function () {\r\n\r\n\t\t\t// backwards compatibility\r\n\r\n\t\t},\r\n\r\n\t\tcomputeVertexNormals: function () {\r\n\r\n\t\t\tvar index = this.index;\r\n\t\t\tvar attributes = this.attributes;\r\n\r\n\t\t\tif ( attributes.position ) {\r\n\r\n\t\t\t\tvar positions = attributes.position.array;\r\n\r\n\t\t\t\tif ( attributes.normal === undefined ) {\r\n\r\n\t\t\t\t\tthis.addAttribute( 'normal', new BufferAttribute( new Float32Array( positions.length ), 3 ) );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// reset existing normals to zero\r\n\r\n\t\t\t\t\tvar array = attributes.normal.array;\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = array.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\tarray[ i ] = 0;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar normals = attributes.normal.array;\r\n\r\n\t\t\t\tvar vA, vB, vC;\r\n\t\t\t\tvar pA = new Vector3(), pB = new Vector3(), pC = new Vector3();\r\n\t\t\t\tvar cb = new Vector3(), ab = new Vector3();\r\n\r\n\t\t\t\t// indexed elements\r\n\r\n\t\t\t\tif ( index ) {\r\n\r\n\t\t\t\t\tvar indices = index.array;\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = index.count; i < il; i += 3 ) {\r\n\r\n\t\t\t\t\t\tvA = indices[ i + 0 ] * 3;\r\n\t\t\t\t\t\tvB = indices[ i + 1 ] * 3;\r\n\t\t\t\t\t\tvC = indices[ i + 2 ] * 3;\r\n\r\n\t\t\t\t\t\tpA.fromArray( positions, vA );\r\n\t\t\t\t\t\tpB.fromArray( positions, vB );\r\n\t\t\t\t\t\tpC.fromArray( positions, vC );\r\n\r\n\t\t\t\t\t\tcb.subVectors( pC, pB );\r\n\t\t\t\t\t\tab.subVectors( pA, pB );\r\n\t\t\t\t\t\tcb.cross( ab );\r\n\r\n\t\t\t\t\t\tnormals[ vA ] += cb.x;\r\n\t\t\t\t\t\tnormals[ vA + 1 ] += cb.y;\r\n\t\t\t\t\t\tnormals[ vA + 2 ] += cb.z;\r\n\r\n\t\t\t\t\t\tnormals[ vB ] += cb.x;\r\n\t\t\t\t\t\tnormals[ vB + 1 ] += cb.y;\r\n\t\t\t\t\t\tnormals[ vB + 2 ] += cb.z;\r\n\r\n\t\t\t\t\t\tnormals[ vC ] += cb.x;\r\n\t\t\t\t\t\tnormals[ vC + 1 ] += cb.y;\r\n\t\t\t\t\t\tnormals[ vC + 2 ] += cb.z;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// non-indexed elements (unconnected triangle soup)\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = positions.length; i < il; i += 9 ) {\r\n\r\n\t\t\t\t\t\tpA.fromArray( positions, i );\r\n\t\t\t\t\t\tpB.fromArray( positions, i + 3 );\r\n\t\t\t\t\t\tpC.fromArray( positions, i + 6 );\r\n\r\n\t\t\t\t\t\tcb.subVectors( pC, pB );\r\n\t\t\t\t\t\tab.subVectors( pA, pB );\r\n\t\t\t\t\t\tcb.cross( ab );\r\n\r\n\t\t\t\t\t\tnormals[ i ] = cb.x;\r\n\t\t\t\t\t\tnormals[ i + 1 ] = cb.y;\r\n\t\t\t\t\t\tnormals[ i + 2 ] = cb.z;\r\n\r\n\t\t\t\t\t\tnormals[ i + 3 ] = cb.x;\r\n\t\t\t\t\t\tnormals[ i + 4 ] = cb.y;\r\n\t\t\t\t\t\tnormals[ i + 5 ] = cb.z;\r\n\r\n\t\t\t\t\t\tnormals[ i + 6 ] = cb.x;\r\n\t\t\t\t\t\tnormals[ i + 7 ] = cb.y;\r\n\t\t\t\t\t\tnormals[ i + 8 ] = cb.z;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.normalizeNormals();\r\n\r\n\t\t\t\tattributes.normal.needsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tmerge: function ( geometry, offset ) {\r\n\r\n\t\t\tif ( ! ( geometry && geometry.isBufferGeometry ) ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.', geometry );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( offset === undefined ) {\r\n\r\n\t\t\t\toffset = 0;\r\n\r\n\t\t\t\tconsole.warn(\r\n\t\t\t\t\t'THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. '\r\n\t\t\t\t\t+ 'Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge.'\r\n\t\t\t\t);\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar attributes = this.attributes;\r\n\r\n\t\t\tfor ( var key in attributes ) {\r\n\r\n\t\t\t\tif ( geometry.attributes[ key ] === undefined ) continue;\r\n\r\n\t\t\t\tvar attribute1 = attributes[ key ];\r\n\t\t\t\tvar attributeArray1 = attribute1.array;\r\n\r\n\t\t\t\tvar attribute2 = geometry.attributes[ key ];\r\n\t\t\t\tvar attributeArray2 = attribute2.array;\r\n\r\n\t\t\t\tvar attributeSize = attribute2.itemSize;\r\n\r\n\t\t\t\tfor ( var i = 0, j = attributeSize * offset; i < attributeArray2.length; i ++, j ++ ) {\r\n\r\n\t\t\t\t\tattributeArray1[ j ] = attributeArray2[ i ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tnormalizeNormals: function () {\r\n\r\n\t\t\tvar vector = new Vector3();\r\n\r\n\t\t\treturn function normalizeNormals() {\r\n\r\n\t\t\t\tvar normals = this.attributes.normal;\r\n\r\n\t\t\t\tfor ( var i = 0, il = normals.count; i < il; i ++ ) {\r\n\r\n\t\t\t\t\tvector.x = normals.getX( i );\r\n\t\t\t\t\tvector.y = normals.getY( i );\r\n\t\t\t\t\tvector.z = normals.getZ( i );\r\n\r\n\t\t\t\t\tvector.normalize();\r\n\r\n\t\t\t\t\tnormals.setXYZ( i, vector.x, vector.y, vector.z );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\ttoNonIndexed: function () {\r\n\r\n\t\t\tif ( this.index === null ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed.' );\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar geometry2 = new BufferGeometry();\r\n\r\n\t\t\tvar indices = this.index.array;\r\n\t\t\tvar attributes = this.attributes;\r\n\r\n\t\t\tfor ( var name in attributes ) {\r\n\r\n\t\t\t\tvar attribute = attributes[ name ];\r\n\r\n\t\t\t\tvar array = attribute.array;\r\n\t\t\t\tvar itemSize = attribute.itemSize;\r\n\r\n\t\t\t\tvar array2 = new array.constructor( indices.length * itemSize );\r\n\r\n\t\t\t\tvar index = 0, index2 = 0;\r\n\r\n\t\t\t\tfor ( var i = 0, l = indices.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tindex = indices[ i ] * itemSize;\r\n\r\n\t\t\t\t\tfor ( var j = 0; j < itemSize; j ++ ) {\r\n\r\n\t\t\t\t\t\tarray2[ index2 ++ ] = array[ index ++ ];\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgeometry2.addAttribute( name, new BufferAttribute( array2, itemSize ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar groups = this.groups;\r\n\r\n\t\t\tfor ( var i = 0, l = groups.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar group = groups[ i ];\r\n\t\t\t\tgeometry2.addGroup( group.start, group.count, group.materialIndex );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn geometry2;\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function () {\r\n\r\n\t\t\tvar data = {\r\n\t\t\t\tmetadata: {\r\n\t\t\t\t\tversion: 4.5,\r\n\t\t\t\t\ttype: 'BufferGeometry',\r\n\t\t\t\t\tgenerator: 'BufferGeometry.toJSON'\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\t// standard BufferGeometry serialization\r\n\r\n\t\t\tdata.uuid = this.uuid;\r\n\t\t\tdata.type = this.type;\r\n\t\t\tif ( this.name !== '' ) data.name = this.name;\r\n\t\t\tif ( Object.keys( this.userData ).length > 0 ) data.userData = this.userData;\r\n\r\n\t\t\tif ( this.parameters !== undefined ) {\r\n\r\n\t\t\t\tvar parameters = this.parameters;\r\n\r\n\t\t\t\tfor ( var key in parameters ) {\r\n\r\n\t\t\t\t\tif ( parameters[ key ] !== undefined ) data[ key ] = parameters[ key ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn data;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tdata.data = { attributes: {} };\r\n\r\n\t\t\tvar index = this.index;\r\n\r\n\t\t\tif ( index !== null ) {\r\n\r\n\t\t\t\tvar array = Array.prototype.slice.call( index.array );\r\n\r\n\t\t\t\tdata.data.index = {\r\n\t\t\t\t\ttype: index.array.constructor.name,\r\n\t\t\t\t\tarray: array\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar attributes = this.attributes;\r\n\r\n\t\t\tfor ( var key in attributes ) {\r\n\r\n\t\t\t\tvar attribute = attributes[ key ];\r\n\r\n\t\t\t\tvar array = Array.prototype.slice.call( attribute.array );\r\n\r\n\t\t\t\tdata.data.attributes[ key ] = {\r\n\t\t\t\t\titemSize: attribute.itemSize,\r\n\t\t\t\t\ttype: attribute.array.constructor.name,\r\n\t\t\t\t\tarray: array,\r\n\t\t\t\t\tnormalized: attribute.normalized\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar groups = this.groups;\r\n\r\n\t\t\tif ( groups.length > 0 ) {\r\n\r\n\t\t\t\tdata.data.groups = JSON.parse( JSON.stringify( groups ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar boundingSphere = this.boundingSphere;\r\n\r\n\t\t\tif ( boundingSphere !== null ) {\r\n\r\n\t\t\t\tdata.data.boundingSphere = {\r\n\t\t\t\t\tcenter: boundingSphere.center.toArray(),\r\n\t\t\t\t\tradius: boundingSphere.radius\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\t/*\r\n\t\t\t // Handle primitives\r\n\r\n\t\t\t var parameters = this.parameters;\r\n\r\n\t\t\t if ( parameters !== undefined ) {\r\n\r\n\t\t\t var values = [];\r\n\r\n\t\t\t for ( var key in parameters ) {\r\n\r\n\t\t\t values.push( parameters[ key ] );\r\n\r\n\t\t\t }\r\n\r\n\t\t\t var geometry = Object.create( this.constructor.prototype );\r\n\t\t\t this.constructor.apply( geometry, values );\r\n\t\t\t return geometry;\r\n\r\n\t\t\t }\r\n\r\n\t\t\t return new this.constructor().copy( this );\r\n\t\t\t */\r\n\r\n\t\t\treturn new BufferGeometry().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tvar name, i, l;\r\n\r\n\t\t\t// reset\r\n\r\n\t\t\tthis.index = null;\r\n\t\t\tthis.attributes = {};\r\n\t\t\tthis.morphAttributes = {};\r\n\t\t\tthis.groups = [];\r\n\t\t\tthis.boundingBox = null;\r\n\t\t\tthis.boundingSphere = null;\r\n\r\n\t\t\t// name\r\n\r\n\t\t\tthis.name = source.name;\r\n\r\n\t\t\t// index\r\n\r\n\t\t\tvar index = source.index;\r\n\r\n\t\t\tif ( index !== null ) {\r\n\r\n\t\t\t\tthis.setIndex( index.clone() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// attributes\r\n\r\n\t\t\tvar attributes = source.attributes;\r\n\r\n\t\t\tfor ( name in attributes ) {\r\n\r\n\t\t\t\tvar attribute = attributes[ name ];\r\n\t\t\t\tthis.addAttribute( name, attribute.clone() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// morph attributes\r\n\r\n\t\t\tvar morphAttributes = source.morphAttributes;\r\n\r\n\t\t\tfor ( name in morphAttributes ) {\r\n\r\n\t\t\t\tvar array = [];\r\n\t\t\t\tvar morphAttribute = morphAttributes[ name ]; // morphAttribute: array of Float32BufferAttributes\r\n\r\n\t\t\t\tfor ( i = 0, l = morphAttribute.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tarray.push( morphAttribute[ i ].clone() );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.morphAttributes[ name ] = array;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// groups\r\n\r\n\t\t\tvar groups = source.groups;\r\n\r\n\t\t\tfor ( i = 0, l = groups.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar group = groups[ i ];\r\n\t\t\t\tthis.addGroup( group.start, group.count, group.materialIndex );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// bounding box\r\n\r\n\t\t\tvar boundingBox = source.boundingBox;\r\n\r\n\t\t\tif ( boundingBox !== null ) {\r\n\r\n\t\t\t\tthis.boundingBox = boundingBox.clone();\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// bounding sphere\r\n\r\n\t\t\tvar boundingSphere = source.boundingSphere;\r\n\r\n\t\t\tif ( boundingSphere !== null ) {\r\n\r\n\t\t\t\tthis.boundingSphere = boundingSphere.clone();\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// draw range\r\n\r\n\t\t\tthis.drawRange.start = source.drawRange.start;\r\n\t\t\tthis.drawRange.count = source.drawRange.count;\r\n\r\n\t\t\t// user data\r\n\r\n\t\t\tthis.userData = source.userData;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tdispose: function () {\r\n\r\n\t\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t */\r\n\r\n\t// BoxGeometry\r\n\r\n\tfunction BoxGeometry( width, height, depth, widthSegments, heightSegments, depthSegments ) {\r\n\r\n\t\tGeometry.call( this );\r\n\r\n\t\tthis.type = 'BoxGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\twidth: width,\r\n\t\t\theight: height,\r\n\t\t\tdepth: depth,\r\n\t\t\twidthSegments: widthSegments,\r\n\t\t\theightSegments: heightSegments,\r\n\t\t\tdepthSegments: depthSegments\r\n\t\t};\r\n\r\n\t\tthis.fromBufferGeometry( new BoxBufferGeometry( width, height, depth, widthSegments, heightSegments, depthSegments ) );\r\n\t\tthis.mergeVertices();\r\n\r\n\t}\r\n\r\n\tBoxGeometry.prototype = Object.create( Geometry.prototype );\r\n\tBoxGeometry.prototype.constructor = BoxGeometry;\r\n\r\n\t// BoxBufferGeometry\r\n\r\n\tfunction BoxBufferGeometry( width, height, depth, widthSegments, heightSegments, depthSegments ) {\r\n\r\n\t\tBufferGeometry.call( this );\r\n\r\n\t\tthis.type = 'BoxBufferGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\twidth: width,\r\n\t\t\theight: height,\r\n\t\t\tdepth: depth,\r\n\t\t\twidthSegments: widthSegments,\r\n\t\t\theightSegments: heightSegments,\r\n\t\t\tdepthSegments: depthSegments\r\n\t\t};\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\twidth = width || 1;\r\n\t\theight = height || 1;\r\n\t\tdepth = depth || 1;\r\n\r\n\t\t// segments\r\n\r\n\t\twidthSegments = Math.floor( widthSegments ) || 1;\r\n\t\theightSegments = Math.floor( heightSegments ) || 1;\r\n\t\tdepthSegments = Math.floor( depthSegments ) || 1;\r\n\r\n\t\t// buffers\r\n\r\n\t\tvar indices = [];\r\n\t\tvar vertices = [];\r\n\t\tvar normals = [];\r\n\t\tvar uvs = [];\r\n\r\n\t\t// helper variables\r\n\r\n\t\tvar numberOfVertices = 0;\r\n\t\tvar groupStart = 0;\r\n\r\n\t\t// build each side of the box geometry\r\n\r\n\t\tbuildPlane( 'z', 'y', 'x', - 1, - 1, depth, height, width, depthSegments, heightSegments, 0 ); // px\r\n\t\tbuildPlane( 'z', 'y', 'x', 1, - 1, depth, height, - width, depthSegments, heightSegments, 1 ); // nx\r\n\t\tbuildPlane( 'x', 'z', 'y', 1, 1, width, depth, height, widthSegments, depthSegments, 2 ); // py\r\n\t\tbuildPlane( 'x', 'z', 'y', 1, - 1, width, depth, - height, widthSegments, depthSegments, 3 ); // ny\r\n\t\tbuildPlane( 'x', 'y', 'z', 1, - 1, width, height, depth, widthSegments, heightSegments, 4 ); // pz\r\n\t\tbuildPlane( 'x', 'y', 'z', - 1, - 1, width, height, - depth, widthSegments, heightSegments, 5 ); // nz\r\n\r\n\t\t// build geometry\r\n\r\n\t\tthis.setIndex( indices );\r\n\t\tthis.addAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\t\tthis.addAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\r\n\t\tthis.addAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\r\n\r\n\t\tfunction buildPlane( u, v, w, udir, vdir, width, height, depth, gridX, gridY, materialIndex ) {\r\n\r\n\t\t\tvar segmentWidth = width / gridX;\r\n\t\t\tvar segmentHeight = height / gridY;\r\n\r\n\t\t\tvar widthHalf = width / 2;\r\n\t\t\tvar heightHalf = height / 2;\r\n\t\t\tvar depthHalf = depth / 2;\r\n\r\n\t\t\tvar gridX1 = gridX + 1;\r\n\t\t\tvar gridY1 = gridY + 1;\r\n\r\n\t\t\tvar vertexCounter = 0;\r\n\t\t\tvar groupCount = 0;\r\n\r\n\t\t\tvar ix, iy;\r\n\r\n\t\t\tvar vector = new Vector3();\r\n\r\n\t\t\t// generate vertices, normals and uvs\r\n\r\n\t\t\tfor ( iy = 0; iy < gridY1; iy ++ ) {\r\n\r\n\t\t\t\tvar y = iy * segmentHeight - heightHalf;\r\n\r\n\t\t\t\tfor ( ix = 0; ix < gridX1; ix ++ ) {\r\n\r\n\t\t\t\t\tvar x = ix * segmentWidth - widthHalf;\r\n\r\n\t\t\t\t\t// set values to correct vector component\r\n\r\n\t\t\t\t\tvector[ u ] = x * udir;\r\n\t\t\t\t\tvector[ v ] = y * vdir;\r\n\t\t\t\t\tvector[ w ] = depthHalf;\r\n\r\n\t\t\t\t\t// now apply vector to vertex buffer\r\n\r\n\t\t\t\t\tvertices.push( vector.x, vector.y, vector.z );\r\n\r\n\t\t\t\t\t// set values to correct vector component\r\n\r\n\t\t\t\t\tvector[ u ] = 0;\r\n\t\t\t\t\tvector[ v ] = 0;\r\n\t\t\t\t\tvector[ w ] = depth > 0 ? 1 : - 1;\r\n\r\n\t\t\t\t\t// now apply vector to normal buffer\r\n\r\n\t\t\t\t\tnormals.push( vector.x, vector.y, vector.z );\r\n\r\n\t\t\t\t\t// uvs\r\n\r\n\t\t\t\t\tuvs.push( ix / gridX );\r\n\t\t\t\t\tuvs.push( 1 - ( iy / gridY ) );\r\n\r\n\t\t\t\t\t// counters\r\n\r\n\t\t\t\t\tvertexCounter += 1;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// indices\r\n\r\n\t\t\t// 1. you need three indices to draw a single face\r\n\t\t\t// 2. a single segment consists of two faces\r\n\t\t\t// 3. so we need to generate six (2*3) indices per segment\r\n\r\n\t\t\tfor ( iy = 0; iy < gridY; iy ++ ) {\r\n\r\n\t\t\t\tfor ( ix = 0; ix < gridX; ix ++ ) {\r\n\r\n\t\t\t\t\tvar a = numberOfVertices + ix + gridX1 * iy;\r\n\t\t\t\t\tvar b = numberOfVertices + ix + gridX1 * ( iy + 1 );\r\n\t\t\t\t\tvar c = numberOfVertices + ( ix + 1 ) + gridX1 * ( iy + 1 );\r\n\t\t\t\t\tvar d = numberOfVertices + ( ix + 1 ) + gridX1 * iy;\r\n\r\n\t\t\t\t\t// faces\r\n\r\n\t\t\t\t\tindices.push( a, b, d );\r\n\t\t\t\t\tindices.push( b, c, d );\r\n\r\n\t\t\t\t\t// increase counter\r\n\r\n\t\t\t\t\tgroupCount += 6;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// add a group to the geometry. this will ensure multi material support\r\n\r\n\t\t\tscope.addGroup( groupStart, groupCount, materialIndex );\r\n\r\n\t\t\t// calculate new start value for groups\r\n\r\n\t\t\tgroupStart += groupCount;\r\n\r\n\t\t\t// update total number of vertices\r\n\r\n\t\t\tnumberOfVertices += vertexCounter;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tBoxBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\r\n\tBoxBufferGeometry.prototype.constructor = BoxBufferGeometry;\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t */\r\n\r\n\t// PlaneGeometry\r\n\r\n\tfunction PlaneGeometry( width, height, widthSegments, heightSegments ) {\r\n\r\n\t\tGeometry.call( this );\r\n\r\n\t\tthis.type = 'PlaneGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\twidth: width,\r\n\t\t\theight: height,\r\n\t\t\twidthSegments: widthSegments,\r\n\t\t\theightSegments: heightSegments\r\n\t\t};\r\n\r\n\t\tthis.fromBufferGeometry( new PlaneBufferGeometry( width, height, widthSegments, heightSegments ) );\r\n\t\tthis.mergeVertices();\r\n\r\n\t}\r\n\r\n\tPlaneGeometry.prototype = Object.create( Geometry.prototype );\r\n\tPlaneGeometry.prototype.constructor = PlaneGeometry;\r\n\r\n\t// PlaneBufferGeometry\r\n\r\n\tfunction PlaneBufferGeometry( width, height, widthSegments, heightSegments ) {\r\n\r\n\t\tBufferGeometry.call( this );\r\n\r\n\t\tthis.type = 'PlaneBufferGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\twidth: width,\r\n\t\t\theight: height,\r\n\t\t\twidthSegments: widthSegments,\r\n\t\t\theightSegments: heightSegments\r\n\t\t};\r\n\r\n\t\twidth = width || 1;\r\n\t\theight = height || 1;\r\n\r\n\t\tvar width_half = width / 2;\r\n\t\tvar height_half = height / 2;\r\n\r\n\t\tvar gridX = Math.floor( widthSegments ) || 1;\r\n\t\tvar gridY = Math.floor( heightSegments ) || 1;\r\n\r\n\t\tvar gridX1 = gridX + 1;\r\n\t\tvar gridY1 = gridY + 1;\r\n\r\n\t\tvar segment_width = width / gridX;\r\n\t\tvar segment_height = height / gridY;\r\n\r\n\t\tvar ix, iy;\r\n\r\n\t\t// buffers\r\n\r\n\t\tvar indices = [];\r\n\t\tvar vertices = [];\r\n\t\tvar normals = [];\r\n\t\tvar uvs = [];\r\n\r\n\t\t// generate vertices, normals and uvs\r\n\r\n\t\tfor ( iy = 0; iy < gridY1; iy ++ ) {\r\n\r\n\t\t\tvar y = iy * segment_height - height_half;\r\n\r\n\t\t\tfor ( ix = 0; ix < gridX1; ix ++ ) {\r\n\r\n\t\t\t\tvar x = ix * segment_width - width_half;\r\n\r\n\t\t\t\tvertices.push( x, - y, 0 );\r\n\r\n\t\t\t\tnormals.push( 0, 0, 1 );\r\n\r\n\t\t\t\tuvs.push( ix / gridX );\r\n\t\t\t\tuvs.push( 1 - ( iy / gridY ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// indices\r\n\r\n\t\tfor ( iy = 0; iy < gridY; iy ++ ) {\r\n\r\n\t\t\tfor ( ix = 0; ix < gridX; ix ++ ) {\r\n\r\n\t\t\t\tvar a = ix + gridX1 * iy;\r\n\t\t\t\tvar b = ix + gridX1 * ( iy + 1 );\r\n\t\t\t\tvar c = ( ix + 1 ) + gridX1 * ( iy + 1 );\r\n\t\t\t\tvar d = ( ix + 1 ) + gridX1 * iy;\r\n\r\n\t\t\t\t// faces\r\n\r\n\t\t\t\tindices.push( a, b, d );\r\n\t\t\t\tindices.push( b, c, d );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// build geometry\r\n\r\n\t\tthis.setIndex( indices );\r\n\t\tthis.addAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\t\tthis.addAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\r\n\t\tthis.addAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\r\n\r\n\t}\r\n\r\n\tPlaneBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\r\n\tPlaneBufferGeometry.prototype.constructor = PlaneBufferGeometry;\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\r\n\tvar materialId = 0;\r\n\r\n\tfunction Material() {\r\n\r\n\t\tObject.defineProperty( this, 'id', { value: materialId ++ } );\r\n\r\n\t\tthis.uuid = _Math.generateUUID();\r\n\r\n\t\tthis.name = '';\r\n\t\tthis.type = 'Material';\r\n\r\n\t\tthis.fog = true;\r\n\t\tthis.lights = true;\r\n\r\n\t\tthis.blending = NormalBlending;\r\n\t\tthis.side = FrontSide;\r\n\t\tthis.flatShading = false;\r\n\t\tthis.vertexColors = NoColors; // THREE.NoColors, THREE.VertexColors, THREE.FaceColors\r\n\r\n\t\tthis.opacity = 1;\r\n\t\tthis.transparent = false;\r\n\r\n\t\tthis.blendSrc = SrcAlphaFactor;\r\n\t\tthis.blendDst = OneMinusSrcAlphaFactor;\r\n\t\tthis.blendEquation = AddEquation;\r\n\t\tthis.blendSrcAlpha = null;\r\n\t\tthis.blendDstAlpha = null;\r\n\t\tthis.blendEquationAlpha = null;\r\n\r\n\t\tthis.depthFunc = LessEqualDepth;\r\n\t\tthis.depthTest = true;\r\n\t\tthis.depthWrite = true;\r\n\r\n\t\tthis.clippingPlanes = null;\r\n\t\tthis.clipIntersection = false;\r\n\t\tthis.clipShadows = false;\r\n\r\n\t\tthis.shadowSide = null;\r\n\r\n\t\tthis.colorWrite = true;\r\n\r\n\t\tthis.precision = null; // override the renderer's default precision for this material\r\n\r\n\t\tthis.polygonOffset = false;\r\n\t\tthis.polygonOffsetFactor = 0;\r\n\t\tthis.polygonOffsetUnits = 0;\r\n\r\n\t\tthis.dithering = false;\r\n\r\n\t\tthis.alphaTest = 0;\r\n\t\tthis.premultipliedAlpha = false;\r\n\r\n\t\tthis.overdraw = 0; // Overdrawn pixels (typically between 0 and 1) for fixing antialiasing gaps in CanvasRenderer\r\n\r\n\t\tthis.visible = true;\r\n\r\n\t\tthis.userData = {};\r\n\r\n\t\tthis.needsUpdate = true;\r\n\r\n\t}\r\n\r\n\tMaterial.prototype = Object.assign( Object.create( EventDispatcher.prototype ), {\r\n\r\n\t\tconstructor: Material,\r\n\r\n\t\tisMaterial: true,\r\n\r\n\t\tonBeforeCompile: function () {},\r\n\r\n\t\tsetValues: function ( values ) {\r\n\r\n\t\t\tif ( values === undefined ) return;\r\n\r\n\t\t\tfor ( var key in values ) {\r\n\r\n\t\t\t\tvar newValue = values[ key ];\r\n\r\n\t\t\t\tif ( newValue === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( \"THREE.Material: '\" + key + \"' parameter is undefined.\" );\r\n\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// for backward compatability if shading is set in the constructor\r\n\t\t\t\tif ( key === 'shading' ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.' + this.type + ': .shading has been removed. Use the boolean .flatShading instead.' );\r\n\t\t\t\t\tthis.flatShading = ( newValue === FlatShading ) ? true : false;\r\n\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar currentValue = this[ key ];\r\n\r\n\t\t\t\tif ( currentValue === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( \"THREE.\" + this.type + \": '\" + key + \"' is not a property of this material.\" );\r\n\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( currentValue && currentValue.isColor ) {\r\n\r\n\t\t\t\t\tcurrentValue.set( newValue );\r\n\r\n\t\t\t\t} else if ( ( currentValue && currentValue.isVector3 ) && ( newValue && newValue.isVector3 ) ) {\r\n\r\n\t\t\t\t\tcurrentValue.copy( newValue );\r\n\r\n\t\t\t\t} else if ( key === 'overdraw' ) {\r\n\r\n\t\t\t\t\t// ensure overdraw is backwards-compatible with legacy boolean type\r\n\t\t\t\t\tthis[ key ] = Number( newValue );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tthis[ key ] = newValue;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function ( meta ) {\r\n\r\n\t\t\tvar isRoot = ( meta === undefined || typeof meta === 'string' );\r\n\r\n\t\t\tif ( isRoot ) {\r\n\r\n\t\t\t\tmeta = {\r\n\t\t\t\t\ttextures: {},\r\n\t\t\t\t\timages: {}\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar data = {\r\n\t\t\t\tmetadata: {\r\n\t\t\t\t\tversion: 4.5,\r\n\t\t\t\t\ttype: 'Material',\r\n\t\t\t\t\tgenerator: 'Material.toJSON'\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\t// standard Material serialization\r\n\t\t\tdata.uuid = this.uuid;\r\n\t\t\tdata.type = this.type;\r\n\r\n\t\t\tif ( this.name !== '' ) data.name = this.name;\r\n\r\n\t\t\tif ( this.color && this.color.isColor ) data.color = this.color.getHex();\r\n\r\n\t\t\tif ( this.roughness !== undefined ) data.roughness = this.roughness;\r\n\t\t\tif ( this.metalness !== undefined ) data.metalness = this.metalness;\r\n\r\n\t\t\tif ( this.emissive && this.emissive.isColor ) data.emissive = this.emissive.getHex();\r\n\t\t\tif ( this.emissiveIntensity !== 1 ) data.emissiveIntensity = this.emissiveIntensity;\r\n\r\n\t\t\tif ( this.specular && this.specular.isColor ) data.specular = this.specular.getHex();\r\n\t\t\tif ( this.shininess !== undefined ) data.shininess = this.shininess;\r\n\t\t\tif ( this.clearCoat !== undefined ) data.clearCoat = this.clearCoat;\r\n\t\t\tif ( this.clearCoatRoughness !== undefined ) data.clearCoatRoughness = this.clearCoatRoughness;\r\n\r\n\t\t\tif ( this.map && this.map.isTexture ) data.map = this.map.toJSON( meta ).uuid;\r\n\t\t\tif ( this.alphaMap && this.alphaMap.isTexture ) data.alphaMap = this.alphaMap.toJSON( meta ).uuid;\r\n\t\t\tif ( this.lightMap && this.lightMap.isTexture ) data.lightMap = this.lightMap.toJSON( meta ).uuid;\r\n\r\n\t\t\tif ( this.aoMap && this.aoMap.isTexture ) {\r\n\r\n\t\t\t\tdata.aoMap = this.aoMap.toJSON( meta ).uuid;\r\n\t\t\t\tdata.aoMapIntensity = this.aoMapIntensity;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.bumpMap && this.bumpMap.isTexture ) {\r\n\r\n\t\t\t\tdata.bumpMap = this.bumpMap.toJSON( meta ).uuid;\r\n\t\t\t\tdata.bumpScale = this.bumpScale;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.normalMap && this.normalMap.isTexture ) {\r\n\r\n\t\t\t\tdata.normalMap = this.normalMap.toJSON( meta ).uuid;\r\n\t\t\t\tdata.normalMapType = this.normalMapType;\r\n\t\t\t\tdata.normalScale = this.normalScale.toArray();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.displacementMap && this.displacementMap.isTexture ) {\r\n\r\n\t\t\t\tdata.displacementMap = this.displacementMap.toJSON( meta ).uuid;\r\n\t\t\t\tdata.displacementScale = this.displacementScale;\r\n\t\t\t\tdata.displacementBias = this.displacementBias;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.roughnessMap && this.roughnessMap.isTexture ) data.roughnessMap = this.roughnessMap.toJSON( meta ).uuid;\r\n\t\t\tif ( this.metalnessMap && this.metalnessMap.isTexture ) data.metalnessMap = this.metalnessMap.toJSON( meta ).uuid;\r\n\r\n\t\t\tif ( this.emissiveMap && this.emissiveMap.isTexture ) data.emissiveMap = this.emissiveMap.toJSON( meta ).uuid;\r\n\t\t\tif ( this.specularMap && this.specularMap.isTexture ) data.specularMap = this.specularMap.toJSON( meta ).uuid;\r\n\r\n\t\t\tif ( this.envMap && this.envMap.isTexture ) {\r\n\r\n\t\t\t\tdata.envMap = this.envMap.toJSON( meta ).uuid;\r\n\t\t\t\tdata.reflectivity = this.reflectivity; // Scale behind envMap\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.gradientMap && this.gradientMap.isTexture ) {\r\n\r\n\t\t\t\tdata.gradientMap = this.gradientMap.toJSON( meta ).uuid;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.size !== undefined ) data.size = this.size;\r\n\t\t\tif ( this.sizeAttenuation !== undefined ) data.sizeAttenuation = this.sizeAttenuation;\r\n\r\n\t\t\tif ( this.blending !== NormalBlending ) data.blending = this.blending;\r\n\t\t\tif ( this.flatShading === true ) data.flatShading = this.flatShading;\r\n\t\t\tif ( this.side !== FrontSide ) data.side = this.side;\r\n\t\t\tif ( this.vertexColors !== NoColors ) data.vertexColors = this.vertexColors;\r\n\r\n\t\t\tif ( this.opacity < 1 ) data.opacity = this.opacity;\r\n\t\t\tif ( this.transparent === true ) data.transparent = this.transparent;\r\n\r\n\t\t\tdata.depthFunc = this.depthFunc;\r\n\t\t\tdata.depthTest = this.depthTest;\r\n\t\t\tdata.depthWrite = this.depthWrite;\r\n\r\n\t\t\t// rotation (SpriteMaterial)\r\n\t\t\tif ( this.rotation !== 0 ) data.rotation = this.rotation;\r\n\r\n\t\t\tif ( this.linewidth !== 1 ) data.linewidth = this.linewidth;\r\n\t\t\tif ( this.dashSize !== undefined ) data.dashSize = this.dashSize;\r\n\t\t\tif ( this.gapSize !== undefined ) data.gapSize = this.gapSize;\r\n\t\t\tif ( this.scale !== undefined ) data.scale = this.scale;\r\n\r\n\t\t\tif ( this.dithering === true ) data.dithering = true;\r\n\r\n\t\t\tif ( this.alphaTest > 0 ) data.alphaTest = this.alphaTest;\r\n\t\t\tif ( this.premultipliedAlpha === true ) data.premultipliedAlpha = this.premultipliedAlpha;\r\n\r\n\t\t\tif ( this.wireframe === true ) data.wireframe = this.wireframe;\r\n\t\t\tif ( this.wireframeLinewidth > 1 ) data.wireframeLinewidth = this.wireframeLinewidth;\r\n\t\t\tif ( this.wireframeLinecap !== 'round' ) data.wireframeLinecap = this.wireframeLinecap;\r\n\t\t\tif ( this.wireframeLinejoin !== 'round' ) data.wireframeLinejoin = this.wireframeLinejoin;\r\n\r\n\t\t\tif ( this.morphTargets === true ) data.morphTargets = true;\r\n\t\t\tif ( this.skinning === true ) data.skinning = true;\r\n\r\n\t\t\tif ( this.visible === false ) data.visible = false;\r\n\t\t\tif ( JSON.stringify( this.userData ) !== '{}' ) data.userData = this.userData;\r\n\r\n\t\t\t// TODO: Copied from Object3D.toJSON\r\n\r\n\t\t\tfunction extractFromCache( cache ) {\r\n\r\n\t\t\t\tvar values = [];\r\n\r\n\t\t\t\tfor ( var key in cache ) {\r\n\r\n\t\t\t\t\tvar data = cache[ key ];\r\n\t\t\t\t\tdelete data.metadata;\r\n\t\t\t\t\tvalues.push( data );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn values;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( isRoot ) {\r\n\r\n\t\t\t\tvar textures = extractFromCache( meta.textures );\r\n\t\t\t\tvar images = extractFromCache( meta.images );\r\n\r\n\t\t\t\tif ( textures.length > 0 ) data.textures = textures;\r\n\t\t\t\tif ( images.length > 0 ) data.images = images;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tthis.name = source.name;\r\n\r\n\t\t\tthis.fog = source.fog;\r\n\t\t\tthis.lights = source.lights;\r\n\r\n\t\t\tthis.blending = source.blending;\r\n\t\t\tthis.side = source.side;\r\n\t\t\tthis.flatShading = source.flatShading;\r\n\t\t\tthis.vertexColors = source.vertexColors;\r\n\r\n\t\t\tthis.opacity = source.opacity;\r\n\t\t\tthis.transparent = source.transparent;\r\n\r\n\t\t\tthis.blendSrc = source.blendSrc;\r\n\t\t\tthis.blendDst = source.blendDst;\r\n\t\t\tthis.blendEquation = source.blendEquation;\r\n\t\t\tthis.blendSrcAlpha = source.blendSrcAlpha;\r\n\t\t\tthis.blendDstAlpha = source.blendDstAlpha;\r\n\t\t\tthis.blendEquationAlpha = source.blendEquationAlpha;\r\n\r\n\t\t\tthis.depthFunc = source.depthFunc;\r\n\t\t\tthis.depthTest = source.depthTest;\r\n\t\t\tthis.depthWrite = source.depthWrite;\r\n\r\n\t\t\tthis.colorWrite = source.colorWrite;\r\n\r\n\t\t\tthis.precision = source.precision;\r\n\r\n\t\t\tthis.polygonOffset = source.polygonOffset;\r\n\t\t\tthis.polygonOffsetFactor = source.polygonOffsetFactor;\r\n\t\t\tthis.polygonOffsetUnits = source.polygonOffsetUnits;\r\n\r\n\t\t\tthis.dithering = source.dithering;\r\n\r\n\t\t\tthis.alphaTest = source.alphaTest;\r\n\t\t\tthis.premultipliedAlpha = source.premultipliedAlpha;\r\n\r\n\t\t\tthis.overdraw = source.overdraw;\r\n\r\n\t\t\tthis.visible = source.visible;\r\n\t\t\tthis.userData = JSON.parse( JSON.stringify( source.userData ) );\r\n\r\n\t\t\tthis.clipShadows = source.clipShadows;\r\n\t\t\tthis.clipIntersection = source.clipIntersection;\r\n\r\n\t\t\tvar srcPlanes = source.clippingPlanes,\r\n\t\t\t\tdstPlanes = null;\r\n\r\n\t\t\tif ( srcPlanes !== null ) {\r\n\r\n\t\t\t\tvar n = srcPlanes.length;\r\n\t\t\t\tdstPlanes = new Array( n );\r\n\r\n\t\t\t\tfor ( var i = 0; i !== n; ++ i )\r\n\t\t\t\t\tdstPlanes[ i ] = srcPlanes[ i ].clone();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.clippingPlanes = dstPlanes;\r\n\r\n\t\t\tthis.shadowSide = source.shadowSide;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tdispose: function () {\r\n\r\n\t\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t *\r\n\t * parameters = {\r\n\t *  color: <hex>,\r\n\t *  opacity: <float>,\r\n\t *  map: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  lightMap: new THREE.Texture( <Image> ),\r\n\t *  lightMapIntensity: <float>\r\n\t *\r\n\t *  aoMap: new THREE.Texture( <Image> ),\r\n\t *  aoMapIntensity: <float>\r\n\t *\r\n\t *  specularMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  alphaMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  envMap: new THREE.CubeTexture( [posx, negx, posy, negy, posz, negz] ),\r\n\t *  combine: THREE.Multiply,\r\n\t *  reflectivity: <float>,\r\n\t *  refractionRatio: <float>,\r\n\t *\r\n\t *  depthTest: <bool>,\r\n\t *  depthWrite: <bool>,\r\n\t *\r\n\t *  wireframe: <boolean>,\r\n\t *  wireframeLinewidth: <float>,\r\n\t *\r\n\t *  skinning: <bool>,\r\n\t *  morphTargets: <bool>\r\n\t * }\r\n\t */\r\n\r\n\tfunction MeshBasicMaterial( parameters ) {\r\n\r\n\t\tMaterial.call( this );\r\n\r\n\t\tthis.type = 'MeshBasicMaterial';\r\n\r\n\t\tthis.color = new Color( 0xffffff ); // emissive\r\n\r\n\t\tthis.map = null;\r\n\r\n\t\tthis.lightMap = null;\r\n\t\tthis.lightMapIntensity = 1.0;\r\n\r\n\t\tthis.aoMap = null;\r\n\t\tthis.aoMapIntensity = 1.0;\r\n\r\n\t\tthis.specularMap = null;\r\n\r\n\t\tthis.alphaMap = null;\r\n\r\n\t\tthis.envMap = null;\r\n\t\tthis.combine = MultiplyOperation;\r\n\t\tthis.reflectivity = 1;\r\n\t\tthis.refractionRatio = 0.98;\r\n\r\n\t\tthis.wireframe = false;\r\n\t\tthis.wireframeLinewidth = 1;\r\n\t\tthis.wireframeLinecap = 'round';\r\n\t\tthis.wireframeLinejoin = 'round';\r\n\r\n\t\tthis.skinning = false;\r\n\t\tthis.morphTargets = false;\r\n\r\n\t\tthis.lights = false;\r\n\r\n\t\tthis.setValues( parameters );\r\n\r\n\t}\r\n\r\n\tMeshBasicMaterial.prototype = Object.create( Material.prototype );\r\n\tMeshBasicMaterial.prototype.constructor = MeshBasicMaterial;\r\n\r\n\tMeshBasicMaterial.prototype.isMeshBasicMaterial = true;\r\n\r\n\tMeshBasicMaterial.prototype.copy = function ( source ) {\r\n\r\n\t\tMaterial.prototype.copy.call( this, source );\r\n\r\n\t\tthis.color.copy( source.color );\r\n\r\n\t\tthis.map = source.map;\r\n\r\n\t\tthis.lightMap = source.lightMap;\r\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\r\n\r\n\t\tthis.aoMap = source.aoMap;\r\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\r\n\r\n\t\tthis.specularMap = source.specularMap;\r\n\r\n\t\tthis.alphaMap = source.alphaMap;\r\n\r\n\t\tthis.envMap = source.envMap;\r\n\t\tthis.combine = source.combine;\r\n\t\tthis.reflectivity = source.reflectivity;\r\n\t\tthis.refractionRatio = source.refractionRatio;\r\n\r\n\t\tthis.wireframe = source.wireframe;\r\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\r\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\r\n\r\n\t\tthis.skinning = source.skinning;\r\n\t\tthis.morphTargets = source.morphTargets;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t *\r\n\t * parameters = {\r\n\t *  defines: { \"label\" : \"value\" },\r\n\t *  uniforms: { \"parameter1\": { value: 1.0 }, \"parameter2\": { value2: 2 } },\r\n\t *\r\n\t *  fragmentShader: <string>,\r\n\t *  vertexShader: <string>,\r\n\t *\r\n\t *  wireframe: <boolean>,\r\n\t *  wireframeLinewidth: <float>,\r\n\t *\r\n\t *  lights: <bool>,\r\n\t *\r\n\t *  skinning: <bool>,\r\n\t *  morphTargets: <bool>,\r\n\t *  morphNormals: <bool>\r\n\t * }\r\n\t */\r\n\r\n\tfunction ShaderMaterial( parameters ) {\r\n\r\n\t\tMaterial.call( this );\r\n\r\n\t\tthis.type = 'ShaderMaterial';\r\n\r\n\t\tthis.defines = {};\r\n\t\tthis.uniforms = {};\r\n\r\n\t\tthis.vertexShader = 'void main() {\\n\\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n}';\r\n\t\tthis.fragmentShader = 'void main() {\\n\\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\\n}';\r\n\r\n\t\tthis.linewidth = 1;\r\n\r\n\t\tthis.wireframe = false;\r\n\t\tthis.wireframeLinewidth = 1;\r\n\r\n\t\tthis.fog = false; // set to use scene fog\r\n\t\tthis.lights = false; // set to use scene lights\r\n\t\tthis.clipping = false; // set to use user-defined clipping planes\r\n\r\n\t\tthis.skinning = false; // set to use skinning attribute streams\r\n\t\tthis.morphTargets = false; // set to use morph targets\r\n\t\tthis.morphNormals = false; // set to use morph normals\r\n\r\n\t\tthis.extensions = {\r\n\t\t\tderivatives: false, // set to use derivatives\r\n\t\t\tfragDepth: false, // set to use fragment depth values\r\n\t\t\tdrawBuffers: false, // set to use draw buffers\r\n\t\t\tshaderTextureLOD: false // set to use shader texture LOD\r\n\t\t};\r\n\r\n\t\t// When rendered geometry doesn't include these attributes but the material does,\r\n\t\t// use these default values in WebGL. This avoids errors when buffer data is missing.\r\n\t\tthis.defaultAttributeValues = {\r\n\t\t\t'color': [ 1, 1, 1 ],\r\n\t\t\t'uv': [ 0, 0 ],\r\n\t\t\t'uv2': [ 0, 0 ]\r\n\t\t};\r\n\r\n\t\tthis.index0AttributeName = undefined;\r\n\t\tthis.uniformsNeedUpdate = false;\r\n\r\n\t\tif ( parameters !== undefined ) {\r\n\r\n\t\t\tif ( parameters.attributes !== undefined ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.setValues( parameters );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tShaderMaterial.prototype = Object.create( Material.prototype );\r\n\tShaderMaterial.prototype.constructor = ShaderMaterial;\r\n\r\n\tShaderMaterial.prototype.isShaderMaterial = true;\r\n\r\n\tShaderMaterial.prototype.copy = function ( source ) {\r\n\r\n\t\tMaterial.prototype.copy.call( this, source );\r\n\r\n\t\tthis.fragmentShader = source.fragmentShader;\r\n\t\tthis.vertexShader = source.vertexShader;\r\n\r\n\t\tthis.uniforms = UniformsUtils.clone( source.uniforms );\r\n\r\n\t\tthis.defines = Object.assign( {}, source.defines );\r\n\r\n\t\tthis.wireframe = source.wireframe;\r\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\r\n\t\tthis.lights = source.lights;\r\n\t\tthis.clipping = source.clipping;\r\n\r\n\t\tthis.skinning = source.skinning;\r\n\r\n\t\tthis.morphTargets = source.morphTargets;\r\n\t\tthis.morphNormals = source.morphNormals;\r\n\r\n\t\tthis.extensions = source.extensions;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tShaderMaterial.prototype.toJSON = function ( meta ) {\r\n\r\n\t\tvar data = Material.prototype.toJSON.call( this, meta );\r\n\r\n\t\tdata.uniforms = {};\r\n\r\n\t\tfor ( var name in this.uniforms ) {\r\n\r\n\t\t\tvar uniform = this.uniforms[ name ];\r\n\t\t\tvar value = uniform.value;\r\n\r\n\t\t\tif ( value.isTexture ) {\r\n\r\n\t\t\t\tdata.uniforms[ name ] = {\r\n\t\t\t\t\ttype: 't',\r\n\t\t\t\t\tvalue: value.toJSON( meta ).uuid\r\n\t\t\t\t};\r\n\r\n\t\t\t} else if ( value.isColor ) {\r\n\r\n\t\t\t\tdata.uniforms[ name ] = {\r\n\t\t\t\t\ttype: 'c',\r\n\t\t\t\t\tvalue: value.getHex()\r\n\t\t\t\t};\r\n\r\n\t\t\t} else if ( value.isVector2 ) {\r\n\r\n\t\t\t\tdata.uniforms[ name ] = {\r\n\t\t\t\t\ttype: 'v2',\r\n\t\t\t\t\tvalue: value.toArray()\r\n\t\t\t\t};\r\n\r\n\t\t\t} else if ( value.isVector3 ) {\r\n\r\n\t\t\t\tdata.uniforms[ name ] = {\r\n\t\t\t\t\ttype: 'v3',\r\n\t\t\t\t\tvalue: value.toArray()\r\n\t\t\t\t};\r\n\r\n\t\t\t} else if ( value.isVector4 ) {\r\n\r\n\t\t\t\tdata.uniforms[ name ] = {\r\n\t\t\t\t\ttype: 'v4',\r\n\t\t\t\t\tvalue: value.toArray()\r\n\t\t\t\t};\r\n\r\n\t\t\t} else if ( value.isMatrix4 ) {\r\n\r\n\t\t\t\tdata.uniforms[ name ] = {\r\n\t\t\t\t\ttype: 'm4',\r\n\t\t\t\t\tvalue: value.toArray()\r\n\t\t\t\t};\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tdata.uniforms[ name ] = {\r\n\t\t\t\t\tvalue: value\r\n\t\t\t\t};\r\n\r\n\t\t\t\t// note: the array variants v2v, v3v, v4v, m4v and tv are not supported so far\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( Object.keys( this.defines ).length > 0 ) data.defines = this.defines;\r\n\r\n\t\tdata.vertexShader = this.vertexShader;\r\n\t\tdata.fragmentShader = this.fragmentShader;\r\n\r\n\t\treturn data;\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author bhouston / http://clara.io\r\n\t */\r\n\r\n\tfunction Ray( origin, direction ) {\r\n\r\n\t\tthis.origin = ( origin !== undefined ) ? origin : new Vector3();\r\n\t\tthis.direction = ( direction !== undefined ) ? direction : new Vector3();\r\n\r\n\t}\r\n\r\n\tObject.assign( Ray.prototype, {\r\n\r\n\t\tset: function ( origin, direction ) {\r\n\r\n\t\t\tthis.origin.copy( origin );\r\n\t\t\tthis.direction.copy( direction );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( ray ) {\r\n\r\n\t\t\tthis.origin.copy( ray.origin );\r\n\t\t\tthis.direction.copy( ray.direction );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tat: function ( t, target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Ray: .at() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn target.copy( this.direction ).multiplyScalar( t ).add( this.origin );\r\n\r\n\t\t},\r\n\r\n\t\tlookAt: function ( v ) {\r\n\r\n\t\t\tthis.direction.copy( v ).sub( this.origin ).normalize();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\trecast: function () {\r\n\r\n\t\t\tvar v1 = new Vector3();\r\n\r\n\t\t\treturn function recast( t ) {\r\n\r\n\t\t\t\tthis.origin.copy( this.at( t, v1 ) );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tclosestPointToPoint: function ( point, target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Ray: .closestPointToPoint() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\ttarget.subVectors( point, this.origin );\r\n\r\n\t\t\tvar directionDistance = target.dot( this.direction );\r\n\r\n\t\t\tif ( directionDistance < 0 ) {\r\n\r\n\t\t\t\treturn target.copy( this.origin );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn target.copy( this.direction ).multiplyScalar( directionDistance ).add( this.origin );\r\n\r\n\t\t},\r\n\r\n\t\tdistanceToPoint: function ( point ) {\r\n\r\n\t\t\treturn Math.sqrt( this.distanceSqToPoint( point ) );\r\n\r\n\t\t},\r\n\r\n\t\tdistanceSqToPoint: function () {\r\n\r\n\t\t\tvar v1 = new Vector3();\r\n\r\n\t\t\treturn function distanceSqToPoint( point ) {\r\n\r\n\t\t\t\tvar directionDistance = v1.subVectors( point, this.origin ).dot( this.direction );\r\n\r\n\t\t\t\t// point behind the ray\r\n\r\n\t\t\t\tif ( directionDistance < 0 ) {\r\n\r\n\t\t\t\t\treturn this.origin.distanceToSquared( point );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tv1.copy( this.direction ).multiplyScalar( directionDistance ).add( this.origin );\r\n\r\n\t\t\t\treturn v1.distanceToSquared( point );\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tdistanceSqToSegment: function () {\r\n\r\n\t\t\tvar segCenter = new Vector3();\r\n\t\t\tvar segDir = new Vector3();\r\n\t\t\tvar diff = new Vector3();\r\n\r\n\t\t\treturn function distanceSqToSegment( v0, v1, optionalPointOnRay, optionalPointOnSegment ) {\r\n\r\n\t\t\t\t// from http://www.geometrictools.com/GTEngine/Include/Mathematics/GteDistRaySegment.h\r\n\t\t\t\t// It returns the min distance between the ray and the segment\r\n\t\t\t\t// defined by v0 and v1\r\n\t\t\t\t// It can also set two optional targets :\r\n\t\t\t\t// - The closest point on the ray\r\n\t\t\t\t// - The closest point on the segment\r\n\r\n\t\t\t\tsegCenter.copy( v0 ).add( v1 ).multiplyScalar( 0.5 );\r\n\t\t\t\tsegDir.copy( v1 ).sub( v0 ).normalize();\r\n\t\t\t\tdiff.copy( this.origin ).sub( segCenter );\r\n\r\n\t\t\t\tvar segExtent = v0.distanceTo( v1 ) * 0.5;\r\n\t\t\t\tvar a01 = - this.direction.dot( segDir );\r\n\t\t\t\tvar b0 = diff.dot( this.direction );\r\n\t\t\t\tvar b1 = - diff.dot( segDir );\r\n\t\t\t\tvar c = diff.lengthSq();\r\n\t\t\t\tvar det = Math.abs( 1 - a01 * a01 );\r\n\t\t\t\tvar s0, s1, sqrDist, extDet;\r\n\r\n\t\t\t\tif ( det > 0 ) {\r\n\r\n\t\t\t\t\t// The ray and segment are not parallel.\r\n\r\n\t\t\t\t\ts0 = a01 * b1 - b0;\r\n\t\t\t\t\ts1 = a01 * b0 - b1;\r\n\t\t\t\t\textDet = segExtent * det;\r\n\r\n\t\t\t\t\tif ( s0 >= 0 ) {\r\n\r\n\t\t\t\t\t\tif ( s1 >= - extDet ) {\r\n\r\n\t\t\t\t\t\t\tif ( s1 <= extDet ) {\r\n\r\n\t\t\t\t\t\t\t\t// region 0\r\n\t\t\t\t\t\t\t\t// Minimum at interior points of ray and segment.\r\n\r\n\t\t\t\t\t\t\t\tvar invDet = 1 / det;\r\n\t\t\t\t\t\t\t\ts0 *= invDet;\r\n\t\t\t\t\t\t\t\ts1 *= invDet;\r\n\t\t\t\t\t\t\t\tsqrDist = s0 * ( s0 + a01 * s1 + 2 * b0 ) + s1 * ( a01 * s0 + s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\t// region 1\r\n\r\n\t\t\t\t\t\t\t\ts1 = segExtent;\r\n\t\t\t\t\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\r\n\t\t\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t// region 5\r\n\r\n\t\t\t\t\t\t\ts1 = - segExtent;\r\n\t\t\t\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\r\n\t\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tif ( s1 <= - extDet ) {\r\n\r\n\t\t\t\t\t\t\t// region 4\r\n\r\n\t\t\t\t\t\t\ts0 = Math.max( 0, - ( - a01 * segExtent + b0 ) );\r\n\t\t\t\t\t\t\ts1 = ( s0 > 0 ) ? - segExtent : Math.min( Math.max( - segExtent, - b1 ), segExtent );\r\n\t\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t\t\t\t} else if ( s1 <= extDet ) {\r\n\r\n\t\t\t\t\t\t\t// region 3\r\n\r\n\t\t\t\t\t\t\ts0 = 0;\r\n\t\t\t\t\t\t\ts1 = Math.min( Math.max( - segExtent, - b1 ), segExtent );\r\n\t\t\t\t\t\t\tsqrDist = s1 * ( s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t// region 2\r\n\r\n\t\t\t\t\t\t\ts0 = Math.max( 0, - ( a01 * segExtent + b0 ) );\r\n\t\t\t\t\t\t\ts1 = ( s0 > 0 ) ? segExtent : Math.min( Math.max( - segExtent, - b1 ), segExtent );\r\n\t\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// Ray and segment are parallel.\r\n\r\n\t\t\t\t\ts1 = ( a01 > 0 ) ? - segExtent : segExtent;\r\n\t\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\r\n\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( optionalPointOnRay ) {\r\n\r\n\t\t\t\t\toptionalPointOnRay.copy( this.direction ).multiplyScalar( s0 ).add( this.origin );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( optionalPointOnSegment ) {\r\n\r\n\t\t\t\t\toptionalPointOnSegment.copy( segDir ).multiplyScalar( s1 ).add( segCenter );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn sqrDist;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tintersectSphere: function () {\r\n\r\n\t\t\tvar v1 = new Vector3();\r\n\r\n\t\t\treturn function intersectSphere( sphere, target ) {\r\n\r\n\t\t\t\tv1.subVectors( sphere.center, this.origin );\r\n\t\t\t\tvar tca = v1.dot( this.direction );\r\n\t\t\t\tvar d2 = v1.dot( v1 ) - tca * tca;\r\n\t\t\t\tvar radius2 = sphere.radius * sphere.radius;\r\n\r\n\t\t\t\tif ( d2 > radius2 ) return null;\r\n\r\n\t\t\t\tvar thc = Math.sqrt( radius2 - d2 );\r\n\r\n\t\t\t\t// t0 = first intersect point - entrance on front of sphere\r\n\t\t\t\tvar t0 = tca - thc;\r\n\r\n\t\t\t\t// t1 = second intersect point - exit point on back of sphere\r\n\t\t\t\tvar t1 = tca + thc;\r\n\r\n\t\t\t\t// test to see if both t0 and t1 are behind the ray - if so, return null\r\n\t\t\t\tif ( t0 < 0 && t1 < 0 ) return null;\r\n\r\n\t\t\t\t// test to see if t0 is behind the ray:\r\n\t\t\t\t// if it is, the ray is inside the sphere, so return the second exit point scaled by t1,\r\n\t\t\t\t// in order to always return an intersect point that is in front of the ray.\r\n\t\t\t\tif ( t0 < 0 ) return this.at( t1, target );\r\n\r\n\t\t\t\t// else t0 is in front of the ray, so return the first collision point scaled by t0\r\n\t\t\t\treturn this.at( t0, target );\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tintersectsSphere: function ( sphere ) {\r\n\r\n\t\t\treturn this.distanceToPoint( sphere.center ) <= sphere.radius;\r\n\r\n\t\t},\r\n\r\n\t\tdistanceToPlane: function ( plane ) {\r\n\r\n\t\t\tvar denominator = plane.normal.dot( this.direction );\r\n\r\n\t\t\tif ( denominator === 0 ) {\r\n\r\n\t\t\t\t// line is coplanar, return origin\r\n\t\t\t\tif ( plane.distanceToPoint( this.origin ) === 0 ) {\r\n\r\n\t\t\t\t\treturn 0;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Null is preferable to undefined since undefined means.... it is undefined\r\n\r\n\t\t\t\treturn null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar t = - ( this.origin.dot( plane.normal ) + plane.constant ) / denominator;\r\n\r\n\t\t\t// Return if the ray never intersects the plane\r\n\r\n\t\t\treturn t >= 0 ? t : null;\r\n\r\n\t\t},\r\n\r\n\t\tintersectPlane: function ( plane, target ) {\r\n\r\n\t\t\tvar t = this.distanceToPlane( plane );\r\n\r\n\t\t\tif ( t === null ) {\r\n\r\n\t\t\t\treturn null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this.at( t, target );\r\n\r\n\t\t},\r\n\r\n\t\tintersectsPlane: function ( plane ) {\r\n\r\n\t\t\t// check if the ray lies on the plane first\r\n\r\n\t\t\tvar distToPoint = plane.distanceToPoint( this.origin );\r\n\r\n\t\t\tif ( distToPoint === 0 ) {\r\n\r\n\t\t\t\treturn true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar denominator = plane.normal.dot( this.direction );\r\n\r\n\t\t\tif ( denominator * distToPoint < 0 ) {\r\n\r\n\t\t\t\treturn true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// ray origin is behind the plane (and is pointing behind it)\r\n\r\n\t\t\treturn false;\r\n\r\n\t\t},\r\n\r\n\t\tintersectBox: function ( box, target ) {\r\n\r\n\t\t\tvar tmin, tmax, tymin, tymax, tzmin, tzmax;\r\n\r\n\t\t\tvar invdirx = 1 / this.direction.x,\r\n\t\t\t\tinvdiry = 1 / this.direction.y,\r\n\t\t\t\tinvdirz = 1 / this.direction.z;\r\n\r\n\t\t\tvar origin = this.origin;\r\n\r\n\t\t\tif ( invdirx >= 0 ) {\r\n\r\n\t\t\t\ttmin = ( box.min.x - origin.x ) * invdirx;\r\n\t\t\t\ttmax = ( box.max.x - origin.x ) * invdirx;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\ttmin = ( box.max.x - origin.x ) * invdirx;\r\n\t\t\t\ttmax = ( box.min.x - origin.x ) * invdirx;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( invdiry >= 0 ) {\r\n\r\n\t\t\t\ttymin = ( box.min.y - origin.y ) * invdiry;\r\n\t\t\t\ttymax = ( box.max.y - origin.y ) * invdiry;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\ttymin = ( box.max.y - origin.y ) * invdiry;\r\n\t\t\t\ttymax = ( box.min.y - origin.y ) * invdiry;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( ( tmin > tymax ) || ( tymin > tmax ) ) return null;\r\n\r\n\t\t\t// These lines also handle the case where tmin or tmax is NaN\r\n\t\t\t// (result of 0 * Infinity). x !== x returns true if x is NaN\r\n\r\n\t\t\tif ( tymin > tmin || tmin !== tmin ) tmin = tymin;\r\n\r\n\t\t\tif ( tymax < tmax || tmax !== tmax ) tmax = tymax;\r\n\r\n\t\t\tif ( invdirz >= 0 ) {\r\n\r\n\t\t\t\ttzmin = ( box.min.z - origin.z ) * invdirz;\r\n\t\t\t\ttzmax = ( box.max.z - origin.z ) * invdirz;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\ttzmin = ( box.max.z - origin.z ) * invdirz;\r\n\t\t\t\ttzmax = ( box.min.z - origin.z ) * invdirz;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( ( tmin > tzmax ) || ( tzmin > tmax ) ) return null;\r\n\r\n\t\t\tif ( tzmin > tmin || tmin !== tmin ) tmin = tzmin;\r\n\r\n\t\t\tif ( tzmax < tmax || tmax !== tmax ) tmax = tzmax;\r\n\r\n\t\t\t//return point closest to the ray (positive side)\r\n\r\n\t\t\tif ( tmax < 0 ) return null;\r\n\r\n\t\t\treturn this.at( tmin >= 0 ? tmin : tmax, target );\r\n\r\n\t\t},\r\n\r\n\t\tintersectsBox: ( function () {\r\n\r\n\t\t\tvar v = new Vector3();\r\n\r\n\t\t\treturn function intersectsBox( box ) {\r\n\r\n\t\t\t\treturn this.intersectBox( box, v ) !== null;\r\n\r\n\t\t\t};\r\n\r\n\t\t} )(),\r\n\r\n\t\tintersectTriangle: function () {\r\n\r\n\t\t\t// Compute the offset origin, edges, and normal.\r\n\t\t\tvar diff = new Vector3();\r\n\t\t\tvar edge1 = new Vector3();\r\n\t\t\tvar edge2 = new Vector3();\r\n\t\t\tvar normal = new Vector3();\r\n\r\n\t\t\treturn function intersectTriangle( a, b, c, backfaceCulling, target ) {\r\n\r\n\t\t\t\t// from http://www.geometrictools.com/GTEngine/Include/Mathematics/GteIntrRay3Triangle3.h\r\n\r\n\t\t\t\tedge1.subVectors( b, a );\r\n\t\t\t\tedge2.subVectors( c, a );\r\n\t\t\t\tnormal.crossVectors( edge1, edge2 );\r\n\r\n\t\t\t\t// Solve Q + t*D = b1*E1 + b2*E2 (Q = kDiff, D = ray direction,\r\n\t\t\t\t// E1 = kEdge1, E2 = kEdge2, N = Cross(E1,E2)) by\r\n\t\t\t\t//   |Dot(D,N)|*b1 = sign(Dot(D,N))*Dot(D,Cross(Q,E2))\r\n\t\t\t\t//   |Dot(D,N)|*b2 = sign(Dot(D,N))*Dot(D,Cross(E1,Q))\r\n\t\t\t\t//   |Dot(D,N)|*t = -sign(Dot(D,N))*Dot(Q,N)\r\n\t\t\t\tvar DdN = this.direction.dot( normal );\r\n\t\t\t\tvar sign;\r\n\r\n\t\t\t\tif ( DdN > 0 ) {\r\n\r\n\t\t\t\t\tif ( backfaceCulling ) return null;\r\n\t\t\t\t\tsign = 1;\r\n\r\n\t\t\t\t} else if ( DdN < 0 ) {\r\n\r\n\t\t\t\t\tsign = - 1;\r\n\t\t\t\t\tDdN = - DdN;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\treturn null;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdiff.subVectors( this.origin, a );\r\n\t\t\t\tvar DdQxE2 = sign * this.direction.dot( edge2.crossVectors( diff, edge2 ) );\r\n\r\n\t\t\t\t// b1 < 0, no intersection\r\n\t\t\t\tif ( DdQxE2 < 0 ) {\r\n\r\n\t\t\t\t\treturn null;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar DdE1xQ = sign * this.direction.dot( edge1.cross( diff ) );\r\n\r\n\t\t\t\t// b2 < 0, no intersection\r\n\t\t\t\tif ( DdE1xQ < 0 ) {\r\n\r\n\t\t\t\t\treturn null;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// b1+b2 > 1, no intersection\r\n\t\t\t\tif ( DdQxE2 + DdE1xQ > DdN ) {\r\n\r\n\t\t\t\t\treturn null;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Line intersects triangle, check if ray does.\r\n\t\t\t\tvar QdN = - sign * diff.dot( normal );\r\n\r\n\t\t\t\t// t < 0, no intersection\r\n\t\t\t\tif ( QdN < 0 ) {\r\n\r\n\t\t\t\t\treturn null;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Ray intersects triangle.\r\n\t\t\t\treturn this.at( QdN / DdN, target );\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tapplyMatrix4: function ( matrix4 ) {\r\n\r\n\t\t\tthis.origin.applyMatrix4( matrix4 );\r\n\t\t\tthis.direction.transformDirection( matrix4 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tequals: function ( ray ) {\r\n\r\n\t\t\treturn ray.origin.equals( this.origin ) && ray.direction.equals( this.direction );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author bhouston / http://clara.io\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction Triangle( a, b, c ) {\r\n\r\n\t\tthis.a = ( a !== undefined ) ? a : new Vector3();\r\n\t\tthis.b = ( b !== undefined ) ? b : new Vector3();\r\n\t\tthis.c = ( c !== undefined ) ? c : new Vector3();\r\n\r\n\t}\r\n\r\n\tObject.assign( Triangle, {\r\n\r\n\t\tgetNormal: function () {\r\n\r\n\t\t\tvar v0 = new Vector3();\r\n\r\n\t\t\treturn function getNormal( a, b, c, target ) {\r\n\r\n\t\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.Triangle: .getNormal() target is now required' );\r\n\t\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttarget.subVectors( c, b );\r\n\t\t\t\tv0.subVectors( a, b );\r\n\t\t\t\ttarget.cross( v0 );\r\n\r\n\t\t\t\tvar targetLengthSq = target.lengthSq();\r\n\t\t\t\tif ( targetLengthSq > 0 ) {\r\n\r\n\t\t\t\t\treturn target.multiplyScalar( 1 / Math.sqrt( targetLengthSq ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn target.set( 0, 0, 0 );\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\t// static/instance method to calculate barycentric coordinates\r\n\t\t// based on: http://www.blackpawn.com/texts/pointinpoly/default.html\r\n\t\tgetBarycoord: function () {\r\n\r\n\t\t\tvar v0 = new Vector3();\r\n\t\t\tvar v1 = new Vector3();\r\n\t\t\tvar v2 = new Vector3();\r\n\r\n\t\t\treturn function getBarycoord( point, a, b, c, target ) {\r\n\r\n\t\t\t\tv0.subVectors( c, a );\r\n\t\t\t\tv1.subVectors( b, a );\r\n\t\t\t\tv2.subVectors( point, a );\r\n\r\n\t\t\t\tvar dot00 = v0.dot( v0 );\r\n\t\t\t\tvar dot01 = v0.dot( v1 );\r\n\t\t\t\tvar dot02 = v0.dot( v2 );\r\n\t\t\t\tvar dot11 = v1.dot( v1 );\r\n\t\t\t\tvar dot12 = v1.dot( v2 );\r\n\r\n\t\t\t\tvar denom = ( dot00 * dot11 - dot01 * dot01 );\r\n\r\n\t\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.Triangle: .getBarycoord() target is now required' );\r\n\t\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// collinear or singular triangle\r\n\t\t\t\tif ( denom === 0 ) {\r\n\r\n\t\t\t\t\t// arbitrary location outside of triangle?\r\n\t\t\t\t\t// not sure if this is the best idea, maybe should be returning undefined\r\n\t\t\t\t\treturn target.set( - 2, - 1, - 1 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar invDenom = 1 / denom;\r\n\t\t\t\tvar u = ( dot11 * dot02 - dot01 * dot12 ) * invDenom;\r\n\t\t\t\tvar v = ( dot00 * dot12 - dot01 * dot02 ) * invDenom;\r\n\r\n\t\t\t\t// barycentric coordinates must always sum to 1\r\n\t\t\t\treturn target.set( 1 - u - v, v, u );\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tcontainsPoint: function () {\r\n\r\n\t\t\tvar v1 = new Vector3();\r\n\r\n\t\t\treturn function containsPoint( point, a, b, c ) {\r\n\r\n\t\t\t\tTriangle.getBarycoord( point, a, b, c, v1 );\r\n\r\n\t\t\t\treturn ( v1.x >= 0 ) && ( v1.y >= 0 ) && ( ( v1.x + v1.y ) <= 1 );\r\n\r\n\t\t\t};\r\n\r\n\t\t}()\r\n\r\n\t} );\r\n\r\n\tObject.assign( Triangle.prototype, {\r\n\r\n\t\tset: function ( a, b, c ) {\r\n\r\n\t\t\tthis.a.copy( a );\r\n\t\t\tthis.b.copy( b );\r\n\t\t\tthis.c.copy( c );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromPointsAndIndices: function ( points, i0, i1, i2 ) {\r\n\r\n\t\t\tthis.a.copy( points[ i0 ] );\r\n\t\t\tthis.b.copy( points[ i1 ] );\r\n\t\t\tthis.c.copy( points[ i2 ] );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( triangle ) {\r\n\r\n\t\t\tthis.a.copy( triangle.a );\r\n\t\t\tthis.b.copy( triangle.b );\r\n\t\t\tthis.c.copy( triangle.c );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetArea: function () {\r\n\r\n\t\t\tvar v0 = new Vector3();\r\n\t\t\tvar v1 = new Vector3();\r\n\r\n\t\t\treturn function getArea() {\r\n\r\n\t\t\t\tv0.subVectors( this.c, this.b );\r\n\t\t\t\tv1.subVectors( this.a, this.b );\r\n\r\n\t\t\t\treturn v0.cross( v1 ).length() * 0.5;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tgetMidpoint: function ( target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Triangle: .getMidpoint() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn target.addVectors( this.a, this.b ).add( this.c ).multiplyScalar( 1 / 3 );\r\n\r\n\t\t},\r\n\r\n\t\tgetNormal: function ( target ) {\r\n\r\n\t\t\treturn Triangle.getNormal( this.a, this.b, this.c, target );\r\n\r\n\t\t},\r\n\r\n\t\tgetPlane: function ( target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Triangle: .getPlane() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn target.setFromCoplanarPoints( this.a, this.b, this.c );\r\n\r\n\t\t},\r\n\r\n\t\tgetBarycoord: function ( point, target ) {\r\n\r\n\t\t\treturn Triangle.getBarycoord( point, this.a, this.b, this.c, target );\r\n\r\n\t\t},\r\n\r\n\t\tcontainsPoint: function ( point ) {\r\n\r\n\t\t\treturn Triangle.containsPoint( point, this.a, this.b, this.c );\r\n\r\n\t\t},\r\n\r\n\t\tintersectsBox: function ( box ) {\r\n\r\n\t\t\treturn box.intersectsTriangle( this );\r\n\r\n\t\t},\r\n\r\n\t\tclosestPointToPoint: function () {\r\n\r\n\t\t\tvar vab = new Vector3();\r\n\t\t\tvar vac = new Vector3();\r\n\t\t\tvar vbc = new Vector3();\r\n\t\t\tvar vap = new Vector3();\r\n\t\t\tvar vbp = new Vector3();\r\n\t\t\tvar vcp = new Vector3();\r\n\r\n\t\t\treturn function closestPointToPoint( p, target ) {\r\n\r\n\t\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.Triangle: .closestPointToPoint() target is now required' );\r\n\t\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar a = this.a, b = this.b, c = this.c;\r\n\t\t\t\tvar v, w;\r\n\r\n\t\t\t\t// algorithm thanks to Real-Time Collision Detection by Christer Ericson,\r\n\t\t\t\t// published by Morgan Kaufmann Publishers, (c) 2005 Elsevier Inc.,\r\n\t\t\t\t// under the accompanying license; see chapter 5.1.5 for detailed explanation.\r\n\t\t\t\t// basically, we're distinguishing which of the voronoi regions of the triangle\r\n\t\t\t\t// the point lies in with the minimum amount of redundant computation.\r\n\r\n\t\t\t\tvab.subVectors( b, a );\r\n\t\t\t\tvac.subVectors( c, a );\r\n\t\t\t\tvap.subVectors( p, a );\r\n\t\t\t\tvar d1 = vab.dot( vap );\r\n\t\t\t\tvar d2 = vac.dot( vap );\r\n\t\t\t\tif ( d1 <= 0 && d2 <= 0 ) {\r\n\r\n\t\t\t\t\t// vertex region of A; barycentric coords (1, 0, 0)\r\n\t\t\t\t\treturn target.copy( a );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvbp.subVectors( p, b );\r\n\t\t\t\tvar d3 = vab.dot( vbp );\r\n\t\t\t\tvar d4 = vac.dot( vbp );\r\n\t\t\t\tif ( d3 >= 0 && d4 <= d3 ) {\r\n\r\n\t\t\t\t\t// vertex region of B; barycentric coords (0, 1, 0)\r\n\t\t\t\t\treturn target.copy( b );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar vc = d1 * d4 - d3 * d2;\r\n\t\t\t\tif ( vc <= 0 && d1 >= 0 && d3 <= 0 ) {\r\n\r\n\t\t\t\t\tv = d1 / ( d1 - d3 );\r\n\t\t\t\t\t// edge region of AB; barycentric coords (1-v, v, 0)\r\n\t\t\t\t\treturn target.copy( a ).addScaledVector( vab, v );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvcp.subVectors( p, c );\r\n\t\t\t\tvar d5 = vab.dot( vcp );\r\n\t\t\t\tvar d6 = vac.dot( vcp );\r\n\t\t\t\tif ( d6 >= 0 && d5 <= d6 ) {\r\n\r\n\t\t\t\t\t// vertex region of C; barycentric coords (0, 0, 1)\r\n\t\t\t\t\treturn target.copy( c );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar vb = d5 * d2 - d1 * d6;\r\n\t\t\t\tif ( vb <= 0 && d2 >= 0 && d6 <= 0 ) {\r\n\r\n\t\t\t\t\tw = d2 / ( d2 - d6 );\r\n\t\t\t\t\t// edge region of AC; barycentric coords (1-w, 0, w)\r\n\t\t\t\t\treturn target.copy( a ).addScaledVector( vac, w );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar va = d3 * d6 - d5 * d4;\r\n\t\t\t\tif ( va <= 0 && ( d4 - d3 ) >= 0 && ( d5 - d6 ) >= 0 ) {\r\n\r\n\t\t\t\t\tvbc.subVectors( c, b );\r\n\t\t\t\t\tw = ( d4 - d3 ) / ( ( d4 - d3 ) + ( d5 - d6 ) );\r\n\t\t\t\t\t// edge region of BC; barycentric coords (0, 1-w, w)\r\n\t\t\t\t\treturn target.copy( b ).addScaledVector( vbc, w ); // edge region of BC\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// face region\r\n\t\t\t\tvar denom = 1 / ( va + vb + vc );\r\n\t\t\t\t// u = va * denom\r\n\t\t\t\tv = vb * denom;\r\n\t\t\t\tw = vc * denom;\r\n\t\t\t\treturn target.copy( a ).addScaledVector( vab, v ).addScaledVector( vac, w );\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tequals: function ( triangle ) {\r\n\r\n\t\t\treturn triangle.a.equals( this.a ) && triangle.b.equals( this.b ) && triangle.c.equals( this.c );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author jonobr1 / http://jonobr1.com/\r\n\t */\r\n\r\n\tfunction Mesh( geometry, material ) {\r\n\r\n\t\tObject3D.call( this );\r\n\r\n\t\tthis.type = 'Mesh';\r\n\r\n\t\tthis.geometry = geometry !== undefined ? geometry : new BufferGeometry();\r\n\t\tthis.material = material !== undefined ? material : new MeshBasicMaterial( { color: Math.random() * 0xffffff } );\r\n\r\n\t\tthis.drawMode = TrianglesDrawMode;\r\n\r\n\t\tthis.updateMorphTargets();\r\n\r\n\t}\r\n\r\n\tMesh.prototype = Object.assign( Object.create( Object3D.prototype ), {\r\n\r\n\t\tconstructor: Mesh,\r\n\r\n\t\tisMesh: true,\r\n\r\n\t\tsetDrawMode: function ( value ) {\r\n\r\n\t\t\tthis.drawMode = value;\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tObject3D.prototype.copy.call( this, source );\r\n\r\n\t\t\tthis.drawMode = source.drawMode;\r\n\r\n\t\t\tif ( source.morphTargetInfluences !== undefined ) {\r\n\r\n\t\t\t\tthis.morphTargetInfluences = source.morphTargetInfluences.slice();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( source.morphTargetDictionary !== undefined ) {\r\n\r\n\t\t\t\tthis.morphTargetDictionary = Object.assign( {}, source.morphTargetDictionary );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tupdateMorphTargets: function () {\r\n\r\n\t\t\tvar geometry = this.geometry;\r\n\t\t\tvar m, ml, name;\r\n\r\n\t\t\tif ( geometry.isBufferGeometry ) {\r\n\r\n\t\t\t\tvar morphAttributes = geometry.morphAttributes;\r\n\t\t\t\tvar keys = Object.keys( morphAttributes );\r\n\r\n\t\t\t\tif ( keys.length > 0 ) {\r\n\r\n\t\t\t\t\tvar morphAttribute = morphAttributes[ keys[ 0 ] ];\r\n\r\n\t\t\t\t\tif ( morphAttribute !== undefined ) {\r\n\r\n\t\t\t\t\t\tthis.morphTargetInfluences = [];\r\n\t\t\t\t\t\tthis.morphTargetDictionary = {};\r\n\r\n\t\t\t\t\t\tfor ( m = 0, ml = morphAttribute.length; m < ml; m ++ ) {\r\n\r\n\t\t\t\t\t\t\tname = morphAttribute[ m ].name || String( m );\r\n\r\n\t\t\t\t\t\t\tthis.morphTargetInfluences.push( 0 );\r\n\t\t\t\t\t\t\tthis.morphTargetDictionary[ name ] = m;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvar morphTargets = geometry.morphTargets;\r\n\r\n\t\t\t\tif ( morphTargets !== undefined && morphTargets.length > 0 ) {\r\n\r\n\t\t\t\t\tthis.morphTargetInfluences = [];\r\n\t\t\t\t\tthis.morphTargetDictionary = {};\r\n\r\n\t\t\t\t\tfor ( m = 0, ml = morphTargets.length; m < ml; m ++ ) {\r\n\r\n\t\t\t\t\t\tname = morphTargets[ m ].name || String( m );\r\n\r\n\t\t\t\t\t\tthis.morphTargetInfluences.push( 0 );\r\n\t\t\t\t\t\tthis.morphTargetDictionary[ name ] = m;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\traycast: ( function () {\r\n\r\n\t\t\tvar inverseMatrix = new Matrix4();\r\n\t\t\tvar ray = new Ray();\r\n\t\t\tvar sphere = new Sphere();\r\n\r\n\t\t\tvar vA = new Vector3();\r\n\t\t\tvar vB = new Vector3();\r\n\t\t\tvar vC = new Vector3();\r\n\r\n\t\t\tvar tempA = new Vector3();\r\n\t\t\tvar tempB = new Vector3();\r\n\t\t\tvar tempC = new Vector3();\r\n\r\n\t\t\tvar uvA = new Vector2();\r\n\t\t\tvar uvB = new Vector2();\r\n\t\t\tvar uvC = new Vector2();\r\n\r\n\t\t\tvar barycoord = new Vector3();\r\n\r\n\t\t\tvar intersectionPoint = new Vector3();\r\n\t\t\tvar intersectionPointWorld = new Vector3();\r\n\r\n\t\t\tfunction uvIntersection( point, p1, p2, p3, uv1, uv2, uv3 ) {\r\n\r\n\t\t\t\tTriangle.getBarycoord( point, p1, p2, p3, barycoord );\r\n\r\n\t\t\t\tuv1.multiplyScalar( barycoord.x );\r\n\t\t\t\tuv2.multiplyScalar( barycoord.y );\r\n\t\t\t\tuv3.multiplyScalar( barycoord.z );\r\n\r\n\t\t\t\tuv1.add( uv2 ).add( uv3 );\r\n\r\n\t\t\t\treturn uv1.clone();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction checkIntersection( object, material, raycaster, ray, pA, pB, pC, point ) {\r\n\r\n\t\t\t\tvar intersect;\r\n\r\n\t\t\t\tif ( material.side === BackSide ) {\r\n\r\n\t\t\t\t\tintersect = ray.intersectTriangle( pC, pB, pA, true, point );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tintersect = ray.intersectTriangle( pA, pB, pC, material.side !== DoubleSide, point );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( intersect === null ) return null;\r\n\r\n\t\t\t\tintersectionPointWorld.copy( point );\r\n\t\t\t\tintersectionPointWorld.applyMatrix4( object.matrixWorld );\r\n\r\n\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( intersectionPointWorld );\r\n\r\n\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) return null;\r\n\r\n\t\t\t\treturn {\r\n\t\t\t\t\tdistance: distance,\r\n\t\t\t\t\tpoint: intersectionPointWorld.clone(),\r\n\t\t\t\t\tobject: object\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction checkBufferGeometryIntersection( object, material, raycaster, ray, position, uv, a, b, c ) {\r\n\r\n\t\t\t\tvA.fromBufferAttribute( position, a );\r\n\t\t\t\tvB.fromBufferAttribute( position, b );\r\n\t\t\t\tvC.fromBufferAttribute( position, c );\r\n\r\n\t\t\t\tvar intersection = checkIntersection( object, material, raycaster, ray, vA, vB, vC, intersectionPoint );\r\n\r\n\t\t\t\tif ( intersection ) {\r\n\r\n\t\t\t\t\tif ( uv ) {\r\n\r\n\t\t\t\t\t\tuvA.fromBufferAttribute( uv, a );\r\n\t\t\t\t\t\tuvB.fromBufferAttribute( uv, b );\r\n\t\t\t\t\t\tuvC.fromBufferAttribute( uv, c );\r\n\r\n\t\t\t\t\t\tintersection.uv = uvIntersection( intersectionPoint, vA, vB, vC, uvA, uvB, uvC );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar face = new Face3( a, b, c );\r\n\t\t\t\t\tTriangle.getNormal( vA, vB, vC, face.normal );\r\n\r\n\t\t\t\t\tintersection.face = face;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn intersection;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn function raycast( raycaster, intersects ) {\r\n\r\n\t\t\t\tvar geometry = this.geometry;\r\n\t\t\t\tvar material = this.material;\r\n\t\t\t\tvar matrixWorld = this.matrixWorld;\r\n\r\n\t\t\t\tif ( material === undefined ) return;\r\n\r\n\t\t\t\t// Checking boundingSphere distance to ray\r\n\r\n\t\t\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\r\n\r\n\t\t\t\tsphere.copy( geometry.boundingSphere );\r\n\t\t\t\tsphere.applyMatrix4( matrixWorld );\r\n\r\n\t\t\t\tif ( raycaster.ray.intersectsSphere( sphere ) === false ) return;\r\n\r\n\t\t\t\t//\r\n\r\n\t\t\t\tinverseMatrix.getInverse( matrixWorld );\r\n\t\t\t\tray.copy( raycaster.ray ).applyMatrix4( inverseMatrix );\r\n\r\n\t\t\t\t// Check boundingBox before continuing\r\n\r\n\t\t\t\tif ( geometry.boundingBox !== null ) {\r\n\r\n\t\t\t\t\tif ( ray.intersectsBox( geometry.boundingBox ) === false ) return;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar intersection;\r\n\r\n\t\t\t\tif ( geometry.isBufferGeometry ) {\r\n\r\n\t\t\t\t\tvar a, b, c;\r\n\t\t\t\t\tvar index = geometry.index;\r\n\t\t\t\t\tvar position = geometry.attributes.position;\r\n\t\t\t\t\tvar uv = geometry.attributes.uv;\r\n\t\t\t\t\tvar groups = geometry.groups;\r\n\t\t\t\t\tvar drawRange = geometry.drawRange;\r\n\t\t\t\t\tvar i, j, il, jl;\r\n\t\t\t\t\tvar group, groupMaterial;\r\n\t\t\t\t\tvar start, end;\r\n\r\n\t\t\t\t\tif ( index !== null ) {\r\n\r\n\t\t\t\t\t\t// indexed buffer geometry\r\n\r\n\t\t\t\t\t\tif ( Array.isArray( material ) ) {\r\n\r\n\t\t\t\t\t\t\tfor ( i = 0, il = groups.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tgroup = groups[ i ];\r\n\t\t\t\t\t\t\t\tgroupMaterial = material[ group.materialIndex ];\r\n\r\n\t\t\t\t\t\t\t\tstart = Math.max( group.start, drawRange.start );\r\n\t\t\t\t\t\t\t\tend = Math.min( ( group.start + group.count ), ( drawRange.start + drawRange.count ) );\r\n\r\n\t\t\t\t\t\t\t\tfor ( j = start, jl = end; j < jl; j += 3 ) {\r\n\r\n\t\t\t\t\t\t\t\t\ta = index.getX( j );\r\n\t\t\t\t\t\t\t\t\tb = index.getX( j + 1 );\r\n\t\t\t\t\t\t\t\t\tc = index.getX( j + 2 );\r\n\r\n\t\t\t\t\t\t\t\t\tintersection = checkBufferGeometryIntersection( this, groupMaterial, raycaster, ray, position, uv, a, b, c );\r\n\r\n\t\t\t\t\t\t\t\t\tif ( intersection ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tintersection.faceIndex = Math.floor( j / 3 ); // triangle number in indexed buffer semantics\r\n\t\t\t\t\t\t\t\t\t\tintersects.push( intersection );\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tstart = Math.max( 0, drawRange.start );\r\n\t\t\t\t\t\t\tend = Math.min( index.count, ( drawRange.start + drawRange.count ) );\r\n\r\n\t\t\t\t\t\t\tfor ( i = start, il = end; i < il; i += 3 ) {\r\n\r\n\t\t\t\t\t\t\t\ta = index.getX( i );\r\n\t\t\t\t\t\t\t\tb = index.getX( i + 1 );\r\n\t\t\t\t\t\t\t\tc = index.getX( i + 2 );\r\n\r\n\t\t\t\t\t\t\t\tintersection = checkBufferGeometryIntersection( this, material, raycaster, ray, position, uv, a, b, c );\r\n\r\n\t\t\t\t\t\t\t\tif ( intersection ) {\r\n\r\n\t\t\t\t\t\t\t\t\tintersection.faceIndex = Math.floor( i / 3 ); // triangle number in indexed buffer semantics\r\n\t\t\t\t\t\t\t\t\tintersects.push( intersection );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else if ( position !== undefined ) {\r\n\r\n\t\t\t\t\t\t// non-indexed buffer geometry\r\n\r\n\t\t\t\t\t\tif ( Array.isArray( material ) ) {\r\n\r\n\t\t\t\t\t\t\tfor ( i = 0, il = groups.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tgroup = groups[ i ];\r\n\t\t\t\t\t\t\t\tgroupMaterial = material[ group.materialIndex ];\r\n\r\n\t\t\t\t\t\t\t\tstart = Math.max( group.start, drawRange.start );\r\n\t\t\t\t\t\t\t\tend = Math.min( ( group.start + group.count ), ( drawRange.start + drawRange.count ) );\r\n\r\n\t\t\t\t\t\t\t\tfor ( j = start, jl = end; j < jl; j += 3 ) {\r\n\r\n\t\t\t\t\t\t\t\t\ta = j;\r\n\t\t\t\t\t\t\t\t\tb = j + 1;\r\n\t\t\t\t\t\t\t\t\tc = j + 2;\r\n\r\n\t\t\t\t\t\t\t\t\tintersection = checkBufferGeometryIntersection( this, groupMaterial, raycaster, ray, position, uv, a, b, c );\r\n\r\n\t\t\t\t\t\t\t\t\tif ( intersection ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tintersection.faceIndex = Math.floor( j / 3 ); // triangle number in non-indexed buffer semantics\r\n\t\t\t\t\t\t\t\t\t\tintersects.push( intersection );\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tstart = Math.max( 0, drawRange.start );\r\n\t\t\t\t\t\t\tend = Math.min( position.count, ( drawRange.start + drawRange.count ) );\r\n\r\n\t\t\t\t\t\t\tfor ( i = start, il = end; i < il; i += 3 ) {\r\n\r\n\t\t\t\t\t\t\t\ta = i;\r\n\t\t\t\t\t\t\t\tb = i + 1;\r\n\t\t\t\t\t\t\t\tc = i + 2;\r\n\r\n\t\t\t\t\t\t\t\tintersection = checkBufferGeometryIntersection( this, material, raycaster, ray, position, uv, a, b, c );\r\n\r\n\t\t\t\t\t\t\t\tif ( intersection ) {\r\n\r\n\t\t\t\t\t\t\t\t\tintersection.faceIndex = Math.floor( i / 3 ); // triangle number in non-indexed buffer semantics\r\n\t\t\t\t\t\t\t\t\tintersects.push( intersection );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else if ( geometry.isGeometry ) {\r\n\r\n\t\t\t\t\tvar fvA, fvB, fvC;\r\n\t\t\t\t\tvar isMultiMaterial = Array.isArray( material );\r\n\r\n\t\t\t\t\tvar vertices = geometry.vertices;\r\n\t\t\t\t\tvar faces = geometry.faces;\r\n\t\t\t\t\tvar uvs;\r\n\r\n\t\t\t\t\tvar faceVertexUvs = geometry.faceVertexUvs[ 0 ];\r\n\t\t\t\t\tif ( faceVertexUvs.length > 0 ) uvs = faceVertexUvs;\r\n\r\n\t\t\t\t\tfor ( var f = 0, fl = faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\t\t\tvar face = faces[ f ];\r\n\t\t\t\t\t\tvar faceMaterial = isMultiMaterial ? material[ face.materialIndex ] : material;\r\n\r\n\t\t\t\t\t\tif ( faceMaterial === undefined ) continue;\r\n\r\n\t\t\t\t\t\tfvA = vertices[ face.a ];\r\n\t\t\t\t\t\tfvB = vertices[ face.b ];\r\n\t\t\t\t\t\tfvC = vertices[ face.c ];\r\n\r\n\t\t\t\t\t\tif ( faceMaterial.morphTargets === true ) {\r\n\r\n\t\t\t\t\t\t\tvar morphTargets = geometry.morphTargets;\r\n\t\t\t\t\t\t\tvar morphInfluences = this.morphTargetInfluences;\r\n\r\n\t\t\t\t\t\t\tvA.set( 0, 0, 0 );\r\n\t\t\t\t\t\t\tvB.set( 0, 0, 0 );\r\n\t\t\t\t\t\t\tvC.set( 0, 0, 0 );\r\n\r\n\t\t\t\t\t\t\tfor ( var t = 0, tl = morphTargets.length; t < tl; t ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tvar influence = morphInfluences[ t ];\r\n\r\n\t\t\t\t\t\t\t\tif ( influence === 0 ) continue;\r\n\r\n\t\t\t\t\t\t\t\tvar targets = morphTargets[ t ].vertices;\r\n\r\n\t\t\t\t\t\t\t\tvA.addScaledVector( tempA.subVectors( targets[ face.a ], fvA ), influence );\r\n\t\t\t\t\t\t\t\tvB.addScaledVector( tempB.subVectors( targets[ face.b ], fvB ), influence );\r\n\t\t\t\t\t\t\t\tvC.addScaledVector( tempC.subVectors( targets[ face.c ], fvC ), influence );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tvA.add( fvA );\r\n\t\t\t\t\t\t\tvB.add( fvB );\r\n\t\t\t\t\t\t\tvC.add( fvC );\r\n\r\n\t\t\t\t\t\t\tfvA = vA;\r\n\t\t\t\t\t\t\tfvB = vB;\r\n\t\t\t\t\t\t\tfvC = vC;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tintersection = checkIntersection( this, faceMaterial, raycaster, ray, fvA, fvB, fvC, intersectionPoint );\r\n\r\n\t\t\t\t\t\tif ( intersection ) {\r\n\r\n\t\t\t\t\t\t\tif ( uvs && uvs[ f ] ) {\r\n\r\n\t\t\t\t\t\t\t\tvar uvs_f = uvs[ f ];\r\n\t\t\t\t\t\t\t\tuvA.copy( uvs_f[ 0 ] );\r\n\t\t\t\t\t\t\t\tuvB.copy( uvs_f[ 1 ] );\r\n\t\t\t\t\t\t\t\tuvC.copy( uvs_f[ 2 ] );\r\n\r\n\t\t\t\t\t\t\t\tintersection.uv = uvIntersection( intersectionPoint, fvA, fvB, fvC, uvA, uvB, uvC );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tintersection.face = face;\r\n\t\t\t\t\t\t\tintersection.faceIndex = f;\r\n\t\t\t\t\t\t\tintersects.push( intersection );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\r\n\t\t}() ),\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor( this.geometry, this.material ).copy( this );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction WebGLBackground( renderer, state, objects, premultipliedAlpha ) {\r\n\r\n\t\tvar clearColor = new Color( 0x000000 );\r\n\t\tvar clearAlpha = 0;\r\n\r\n\t\tvar planeCamera, planeMesh;\r\n\t\tvar boxMesh;\r\n\r\n\t\tfunction render( renderList, scene, camera, forceClear ) {\r\n\r\n\t\t\tvar background = scene.background;\r\n\r\n\t\t\tif ( background === null ) {\r\n\r\n\t\t\t\tsetClear( clearColor, clearAlpha );\r\n\r\n\t\t\t} else if ( background && background.isColor ) {\r\n\r\n\t\t\t\tsetClear( background, 1 );\r\n\t\t\t\tforceClear = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( renderer.autoClear || forceClear ) {\r\n\r\n\t\t\t\trenderer.clear( renderer.autoClearColor, renderer.autoClearDepth, renderer.autoClearStencil );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( background && background.isCubeTexture ) {\r\n\r\n\t\t\t\tif ( boxMesh === undefined ) {\r\n\r\n\t\t\t\t\tboxMesh = new Mesh(\r\n\t\t\t\t\t\tnew BoxBufferGeometry( 1, 1, 1 ),\r\n\t\t\t\t\t\tnew ShaderMaterial( {\r\n\t\t\t\t\t\t\tuniforms: ShaderLib.cube.uniforms,\r\n\t\t\t\t\t\t\tvertexShader: ShaderLib.cube.vertexShader,\r\n\t\t\t\t\t\t\tfragmentShader: ShaderLib.cube.fragmentShader,\r\n\t\t\t\t\t\t\tside: BackSide,\r\n\t\t\t\t\t\t\tdepthTest: true,\r\n\t\t\t\t\t\t\tdepthWrite: false,\r\n\t\t\t\t\t\t\tfog: false\r\n\t\t\t\t\t\t} )\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tboxMesh.geometry.removeAttribute( 'normal' );\r\n\t\t\t\t\tboxMesh.geometry.removeAttribute( 'uv' );\r\n\r\n\t\t\t\t\tboxMesh.onBeforeRender = function ( renderer, scene, camera ) {\r\n\r\n\t\t\t\t\t\tthis.matrixWorld.copyPosition( camera.matrixWorld );\r\n\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tobjects.update( boxMesh );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tboxMesh.material.uniforms.tCube.value = background;\r\n\r\n\t\t\t\trenderList.push( boxMesh, boxMesh.geometry, boxMesh.material, 0, null );\r\n\r\n\t\t\t} else if ( background && background.isTexture ) {\r\n\r\n\t\t\t\tif ( planeCamera === undefined ) {\r\n\r\n\t\t\t\t\tplaneCamera = new OrthographicCamera( - 1, 1, 1, - 1, 0, 1 );\r\n\r\n\t\t\t\t\tplaneMesh = new Mesh(\r\n\t\t\t\t\t\tnew PlaneBufferGeometry( 2, 2 ),\r\n\t\t\t\t\t\tnew MeshBasicMaterial( { depthTest: false, depthWrite: false, fog: false } )\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tobjects.update( planeMesh );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tplaneMesh.material.map = background;\r\n\r\n\t\t\t\t// TODO Push this to renderList\r\n\r\n\t\t\t\trenderer.renderBufferDirect( planeCamera, null, planeMesh.geometry, planeMesh.material, planeMesh, null );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction setClear( color, alpha ) {\r\n\r\n\t\t\tstate.buffers.color.setClear( color.r, color.g, color.b, alpha, premultipliedAlpha );\r\n\r\n\t\t}\r\n\r\n\t\treturn {\r\n\r\n\t\t\tgetClearColor: function () {\r\n\r\n\t\t\t\treturn clearColor;\r\n\r\n\t\t\t},\r\n\t\t\tsetClearColor: function ( color, alpha ) {\r\n\r\n\t\t\t\tclearColor.set( color );\r\n\t\t\t\tclearAlpha = alpha !== undefined ? alpha : 1;\r\n\t\t\t\tsetClear( clearColor, clearAlpha );\r\n\r\n\t\t\t},\r\n\t\t\tgetClearAlpha: function () {\r\n\r\n\t\t\t\treturn clearAlpha;\r\n\r\n\t\t\t},\r\n\t\t\tsetClearAlpha: function ( alpha ) {\r\n\r\n\t\t\t\tclearAlpha = alpha;\r\n\t\t\t\tsetClear( clearColor, clearAlpha );\r\n\r\n\t\t\t},\r\n\t\t\trender: render\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction WebGLBufferRenderer( gl, extensions, info, capabilities ) {\r\n\r\n\t\tvar mode;\r\n\r\n\t\tfunction setMode( value ) {\r\n\r\n\t\t\tmode = value;\r\n\r\n\t\t}\r\n\r\n\t\tfunction render( start, count ) {\r\n\r\n\t\t\tgl.drawArrays( mode, start, count );\r\n\r\n\t\t\tinfo.update( count, mode );\r\n\r\n\t\t}\r\n\r\n\t\tfunction renderInstances( geometry, start, count ) {\r\n\r\n\t\t\tvar extension;\r\n\r\n\t\t\tif ( capabilities.isWebGL2 ) {\r\n\r\n\t\t\t\textension = gl;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\textension = extensions.get( 'ANGLE_instanced_arrays' );\r\n\r\n\t\t\t\tif ( extension === null ) {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.' );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\textension[ capabilities.isWebGL2 ? 'drawArraysInstanced' : 'drawArraysInstancedANGLE' ]( mode, start, count, geometry.maxInstancedCount );\r\n\r\n\t\t\tinfo.update( count, mode, geometry.maxInstancedCount );\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tthis.setMode = setMode;\r\n\t\tthis.render = render;\r\n\t\tthis.renderInstances = renderInstances;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction WebGLCapabilities( gl, extensions, parameters ) {\r\n\r\n\t\tvar maxAnisotropy;\r\n\r\n\t\tfunction getMaxAnisotropy() {\r\n\r\n\t\t\tif ( maxAnisotropy !== undefined ) return maxAnisotropy;\r\n\r\n\t\t\tvar extension = extensions.get( 'EXT_texture_filter_anisotropic' );\r\n\r\n\t\t\tif ( extension !== null ) {\r\n\r\n\t\t\t\tmaxAnisotropy = gl.getParameter( extension.MAX_TEXTURE_MAX_ANISOTROPY_EXT );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tmaxAnisotropy = 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn maxAnisotropy;\r\n\r\n\t\t}\r\n\r\n\t\tfunction getMaxPrecision( precision ) {\r\n\r\n\t\t\tif ( precision === 'highp' ) {\r\n\r\n\t\t\t\tif ( gl.getShaderPrecisionFormat( gl.VERTEX_SHADER, gl.HIGH_FLOAT ).precision > 0 &&\r\n\t\t\t\t     gl.getShaderPrecisionFormat( gl.FRAGMENT_SHADER, gl.HIGH_FLOAT ).precision > 0 ) {\r\n\r\n\t\t\t\t\treturn 'highp';\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tprecision = 'mediump';\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( precision === 'mediump' ) {\r\n\r\n\t\t\t\tif ( gl.getShaderPrecisionFormat( gl.VERTEX_SHADER, gl.MEDIUM_FLOAT ).precision > 0 &&\r\n\t\t\t\t     gl.getShaderPrecisionFormat( gl.FRAGMENT_SHADER, gl.MEDIUM_FLOAT ).precision > 0 ) {\r\n\r\n\t\t\t\t\treturn 'mediump';\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn 'lowp';\r\n\r\n\t\t}\r\n\r\n\t\tvar isWebGL2 = typeof WebGL2RenderingContext !== 'undefined' && gl instanceof WebGL2RenderingContext;\r\n\r\n\t\tvar precision = parameters.precision !== undefined ? parameters.precision : 'highp';\r\n\t\tvar maxPrecision = getMaxPrecision( precision );\r\n\r\n\t\tif ( maxPrecision !== precision ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer:', precision, 'not supported, using', maxPrecision, 'instead.' );\r\n\t\t\tprecision = maxPrecision;\r\n\r\n\t\t}\r\n\r\n\t\tvar logarithmicDepthBuffer = parameters.logarithmicDepthBuffer === true;\r\n\r\n\t\tvar maxTextures = gl.getParameter( gl.MAX_TEXTURE_IMAGE_UNITS );\r\n\t\tvar maxVertexTextures = gl.getParameter( gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS );\r\n\t\tvar maxTextureSize = gl.getParameter( gl.MAX_TEXTURE_SIZE );\r\n\t\tvar maxCubemapSize = gl.getParameter( gl.MAX_CUBE_MAP_TEXTURE_SIZE );\r\n\r\n\t\tvar maxAttributes = gl.getParameter( gl.MAX_VERTEX_ATTRIBS );\r\n\t\tvar maxVertexUniforms = gl.getParameter( gl.MAX_VERTEX_UNIFORM_VECTORS );\r\n\t\tvar maxVaryings = gl.getParameter( gl.MAX_VARYING_VECTORS );\r\n\t\tvar maxFragmentUniforms = gl.getParameter( gl.MAX_FRAGMENT_UNIFORM_VECTORS );\r\n\r\n\t\tvar vertexTextures = maxVertexTextures > 0;\r\n\t\tvar floatFragmentTextures = isWebGL2 || !! extensions.get( 'OES_texture_float' );\r\n\t\tvar floatVertexTextures = vertexTextures && floatFragmentTextures;\r\n\r\n\t\treturn {\r\n\r\n\t\t\tisWebGL2: isWebGL2,\r\n\r\n\t\t\tgetMaxAnisotropy: getMaxAnisotropy,\r\n\t\t\tgetMaxPrecision: getMaxPrecision,\r\n\r\n\t\t\tprecision: precision,\r\n\t\t\tlogarithmicDepthBuffer: logarithmicDepthBuffer,\r\n\r\n\t\t\tmaxTextures: maxTextures,\r\n\t\t\tmaxVertexTextures: maxVertexTextures,\r\n\t\t\tmaxTextureSize: maxTextureSize,\r\n\t\t\tmaxCubemapSize: maxCubemapSize,\r\n\r\n\t\t\tmaxAttributes: maxAttributes,\r\n\t\t\tmaxVertexUniforms: maxVertexUniforms,\r\n\t\t\tmaxVaryings: maxVaryings,\r\n\t\t\tmaxFragmentUniforms: maxFragmentUniforms,\r\n\r\n\t\t\tvertexTextures: vertexTextures,\r\n\t\t\tfloatFragmentTextures: floatFragmentTextures,\r\n\t\t\tfloatVertexTextures: floatVertexTextures\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author tschw\r\n\t */\r\n\r\n\tfunction WebGLClipping() {\r\n\r\n\t\tvar scope = this,\r\n\r\n\t\t\tglobalState = null,\r\n\t\t\tnumGlobalPlanes = 0,\r\n\t\t\tlocalClippingEnabled = false,\r\n\t\t\trenderingShadows = false,\r\n\r\n\t\t\tplane = new Plane(),\r\n\t\t\tviewNormalMatrix = new Matrix3(),\r\n\r\n\t\t\tuniform = { value: null, needsUpdate: false };\r\n\r\n\t\tthis.uniform = uniform;\r\n\t\tthis.numPlanes = 0;\r\n\t\tthis.numIntersection = 0;\r\n\r\n\t\tthis.init = function ( planes, enableLocalClipping, camera ) {\r\n\r\n\t\t\tvar enabled =\r\n\t\t\t\tplanes.length !== 0 ||\r\n\t\t\t\tenableLocalClipping ||\r\n\t\t\t\t// enable state of previous frame - the clipping code has to\r\n\t\t\t\t// run another frame in order to reset the state:\r\n\t\t\t\tnumGlobalPlanes !== 0 ||\r\n\t\t\t\tlocalClippingEnabled;\r\n\r\n\t\t\tlocalClippingEnabled = enableLocalClipping;\r\n\r\n\t\t\tglobalState = projectPlanes( planes, camera, 0 );\r\n\t\t\tnumGlobalPlanes = planes.length;\r\n\r\n\t\t\treturn enabled;\r\n\r\n\t\t};\r\n\r\n\t\tthis.beginShadows = function () {\r\n\r\n\t\t\trenderingShadows = true;\r\n\t\t\tprojectPlanes( null );\r\n\r\n\t\t};\r\n\r\n\t\tthis.endShadows = function () {\r\n\r\n\t\t\trenderingShadows = false;\r\n\t\t\tresetGlobalState();\r\n\r\n\t\t};\r\n\r\n\t\tthis.setState = function ( planes, clipIntersection, clipShadows, camera, cache, fromCache ) {\r\n\r\n\t\t\tif ( ! localClippingEnabled || planes === null || planes.length === 0 || renderingShadows && ! clipShadows ) {\r\n\r\n\t\t\t\t// there's no local clipping\r\n\r\n\t\t\t\tif ( renderingShadows ) {\r\n\r\n\t\t\t\t\t// there's no global clipping\r\n\r\n\t\t\t\t\tprojectPlanes( null );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tresetGlobalState();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvar nGlobal = renderingShadows ? 0 : numGlobalPlanes,\r\n\t\t\t\t\tlGlobal = nGlobal * 4,\r\n\r\n\t\t\t\t\tdstArray = cache.clippingState || null;\r\n\r\n\t\t\t\tuniform.value = dstArray; // ensure unique state\r\n\r\n\t\t\t\tdstArray = projectPlanes( planes, camera, lGlobal, fromCache );\r\n\r\n\t\t\t\tfor ( var i = 0; i !== lGlobal; ++ i ) {\r\n\r\n\t\t\t\t\tdstArray[ i ] = globalState[ i ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcache.clippingState = dstArray;\r\n\t\t\t\tthis.numIntersection = clipIntersection ? this.numPlanes : 0;\r\n\t\t\t\tthis.numPlanes += nGlobal;\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t};\r\n\r\n\t\tfunction resetGlobalState() {\r\n\r\n\t\t\tif ( uniform.value !== globalState ) {\r\n\r\n\t\t\t\tuniform.value = globalState;\r\n\t\t\t\tuniform.needsUpdate = numGlobalPlanes > 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tscope.numPlanes = numGlobalPlanes;\r\n\t\t\tscope.numIntersection = 0;\r\n\r\n\t\t}\r\n\r\n\t\tfunction projectPlanes( planes, camera, dstOffset, skipTransform ) {\r\n\r\n\t\t\tvar nPlanes = planes !== null ? planes.length : 0,\r\n\t\t\t\tdstArray = null;\r\n\r\n\t\t\tif ( nPlanes !== 0 ) {\r\n\r\n\t\t\t\tdstArray = uniform.value;\r\n\r\n\t\t\t\tif ( skipTransform !== true || dstArray === null ) {\r\n\r\n\t\t\t\t\tvar flatSize = dstOffset + nPlanes * 4,\r\n\t\t\t\t\t\tviewMatrix = camera.matrixWorldInverse;\r\n\r\n\t\t\t\t\tviewNormalMatrix.getNormalMatrix( viewMatrix );\r\n\r\n\t\t\t\t\tif ( dstArray === null || dstArray.length < flatSize ) {\r\n\r\n\t\t\t\t\t\tdstArray = new Float32Array( flatSize );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfor ( var i = 0, i4 = dstOffset; i !== nPlanes; ++ i, i4 += 4 ) {\r\n\r\n\t\t\t\t\t\tplane.copy( planes[ i ] ).applyMatrix4( viewMatrix, viewNormalMatrix );\r\n\r\n\t\t\t\t\t\tplane.normal.toArray( dstArray, i4 );\r\n\t\t\t\t\t\tdstArray[ i4 + 3 ] = plane.constant;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tuniform.value = dstArray;\r\n\t\t\t\tuniform.needsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tscope.numPlanes = nPlanes;\r\n\r\n\t\t\treturn dstArray;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction WebGLExtensions( gl ) {\r\n\r\n\t\tvar extensions = {};\r\n\r\n\t\treturn {\r\n\r\n\t\t\tget: function ( name ) {\r\n\r\n\t\t\t\tif ( extensions[ name ] !== undefined ) {\r\n\r\n\t\t\t\t\treturn extensions[ name ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar extension;\r\n\r\n\t\t\t\tswitch ( name ) {\r\n\r\n\t\t\t\t\tcase 'WEBGL_depth_texture':\r\n\t\t\t\t\t\textension = gl.getExtension( 'WEBGL_depth_texture' ) || gl.getExtension( 'MOZ_WEBGL_depth_texture' ) || gl.getExtension( 'WEBKIT_WEBGL_depth_texture' );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'EXT_texture_filter_anisotropic':\r\n\t\t\t\t\t\textension = gl.getExtension( 'EXT_texture_filter_anisotropic' ) || gl.getExtension( 'MOZ_EXT_texture_filter_anisotropic' ) || gl.getExtension( 'WEBKIT_EXT_texture_filter_anisotropic' );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'WEBGL_compressed_texture_s3tc':\r\n\t\t\t\t\t\textension = gl.getExtension( 'WEBGL_compressed_texture_s3tc' ) || gl.getExtension( 'MOZ_WEBGL_compressed_texture_s3tc' ) || gl.getExtension( 'WEBKIT_WEBGL_compressed_texture_s3tc' );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'WEBGL_compressed_texture_pvrtc':\r\n\t\t\t\t\t\textension = gl.getExtension( 'WEBGL_compressed_texture_pvrtc' ) || gl.getExtension( 'WEBKIT_WEBGL_compressed_texture_pvrtc' );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\textension = gl.getExtension( name );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( extension === null ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: ' + name + ' extension not supported.' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\textensions[ name ] = extension;\r\n\r\n\t\t\t\treturn extension;\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction WebGLGeometries( gl, attributes, info ) {\r\n\r\n\t\tvar geometries = {};\r\n\t\tvar wireframeAttributes = {};\r\n\r\n\t\tfunction onGeometryDispose( event ) {\r\n\r\n\t\t\tvar geometry = event.target;\r\n\t\t\tvar buffergeometry = geometries[ geometry.id ];\r\n\r\n\t\t\tif ( buffergeometry.index !== null ) {\r\n\r\n\t\t\t\tattributes.remove( buffergeometry.index );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var name in buffergeometry.attributes ) {\r\n\r\n\t\t\t\tattributes.remove( buffergeometry.attributes[ name ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry.removeEventListener( 'dispose', onGeometryDispose );\r\n\r\n\t\t\tdelete geometries[ geometry.id ];\r\n\r\n\t\t\tvar attribute = wireframeAttributes[ buffergeometry.id ];\r\n\r\n\t\t\tif ( attribute ) {\r\n\r\n\t\t\t\tattributes.remove( attribute );\r\n\t\t\t\tdelete wireframeAttributes[ buffergeometry.id ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tinfo.memory.geometries --;\r\n\r\n\t\t}\r\n\r\n\t\tfunction get( object, geometry ) {\r\n\r\n\t\t\tvar buffergeometry = geometries[ geometry.id ];\r\n\r\n\t\t\tif ( buffergeometry ) return buffergeometry;\r\n\r\n\t\t\tgeometry.addEventListener( 'dispose', onGeometryDispose );\r\n\r\n\t\t\tif ( geometry.isBufferGeometry ) {\r\n\r\n\t\t\t\tbuffergeometry = geometry;\r\n\r\n\t\t\t} else if ( geometry.isGeometry ) {\r\n\r\n\t\t\t\tif ( geometry._bufferGeometry === undefined ) {\r\n\r\n\t\t\t\t\tgeometry._bufferGeometry = new BufferGeometry().setFromObject( object );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbuffergeometry = geometry._bufferGeometry;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometries[ geometry.id ] = buffergeometry;\r\n\r\n\t\t\tinfo.memory.geometries ++;\r\n\r\n\t\t\treturn buffergeometry;\r\n\r\n\t\t}\r\n\r\n\t\tfunction update( geometry ) {\r\n\r\n\t\t\tvar index = geometry.index;\r\n\t\t\tvar geometryAttributes = geometry.attributes;\r\n\r\n\t\t\tif ( index !== null ) {\r\n\r\n\t\t\t\tattributes.update( index, gl.ELEMENT_ARRAY_BUFFER );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var name in geometryAttributes ) {\r\n\r\n\t\t\t\tattributes.update( geometryAttributes[ name ], gl.ARRAY_BUFFER );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// morph targets\r\n\r\n\t\t\tvar morphAttributes = geometry.morphAttributes;\r\n\r\n\t\t\tfor ( var name in morphAttributes ) {\r\n\r\n\t\t\t\tvar array = morphAttributes[ name ];\r\n\r\n\t\t\t\tfor ( var i = 0, l = array.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tattributes.update( array[ i ], gl.ARRAY_BUFFER );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction getWireframeAttribute( geometry ) {\r\n\r\n\t\t\tvar attribute = wireframeAttributes[ geometry.id ];\r\n\r\n\t\t\tif ( attribute ) return attribute;\r\n\r\n\t\t\tvar indices = [];\r\n\r\n\t\t\tvar geometryIndex = geometry.index;\r\n\t\t\tvar geometryAttributes = geometry.attributes;\r\n\r\n\t\t\t// console.time( 'wireframe' );\r\n\r\n\t\t\tif ( geometryIndex !== null ) {\r\n\r\n\t\t\t\tvar array = geometryIndex.array;\r\n\r\n\t\t\t\tfor ( var i = 0, l = array.length; i < l; i += 3 ) {\r\n\r\n\t\t\t\t\tvar a = array[ i + 0 ];\r\n\t\t\t\t\tvar b = array[ i + 1 ];\r\n\t\t\t\t\tvar c = array[ i + 2 ];\r\n\r\n\t\t\t\t\tindices.push( a, b, b, c, c, a );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvar array = geometryAttributes.position.array;\r\n\r\n\t\t\t\tfor ( var i = 0, l = ( array.length / 3 ) - 1; i < l; i += 3 ) {\r\n\r\n\t\t\t\t\tvar a = i + 0;\r\n\t\t\t\t\tvar b = i + 1;\r\n\t\t\t\t\tvar c = i + 2;\r\n\r\n\t\t\t\t\tindices.push( a, b, b, c, c, a );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// console.timeEnd( 'wireframe' );\r\n\r\n\t\t\tattribute = new ( arrayMax( indices ) > 65535 ? Uint32BufferAttribute : Uint16BufferAttribute )( indices, 1 );\r\n\r\n\t\t\tattributes.update( attribute, gl.ELEMENT_ARRAY_BUFFER );\r\n\r\n\t\t\twireframeAttributes[ geometry.id ] = attribute;\r\n\r\n\t\t\treturn attribute;\r\n\r\n\t\t}\r\n\r\n\t\treturn {\r\n\r\n\t\t\tget: get,\r\n\t\t\tupdate: update,\r\n\r\n\t\t\tgetWireframeAttribute: getWireframeAttribute\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction WebGLIndexedBufferRenderer( gl, extensions, info, capabilities ) {\r\n\r\n\t\tvar mode;\r\n\r\n\t\tfunction setMode( value ) {\r\n\r\n\t\t\tmode = value;\r\n\r\n\t\t}\r\n\r\n\t\tvar type, bytesPerElement;\r\n\r\n\t\tfunction setIndex( value ) {\r\n\r\n\t\t\ttype = value.type;\r\n\t\t\tbytesPerElement = value.bytesPerElement;\r\n\r\n\t\t}\r\n\r\n\t\tfunction render( start, count ) {\r\n\r\n\t\t\tgl.drawElements( mode, count, type, start * bytesPerElement );\r\n\r\n\t\t\tinfo.update( count, mode );\r\n\r\n\t\t}\r\n\r\n\t\tfunction renderInstances( geometry, start, count ) {\r\n\r\n\t\t\tvar extension;\r\n\r\n\t\t\tif ( capabilities.isWebGL2 ) {\r\n\r\n\t\t\t\textension = gl;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvar extension = extensions.get( 'ANGLE_instanced_arrays' );\r\n\r\n\t\t\t\tif ( extension === null ) {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.' );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\textension[ capabilities.isWebGL2 ? 'drawElementsInstanced' : 'drawElementsInstancedANGLE' ]( mode, count, type, start * bytesPerElement, geometry.maxInstancedCount );\r\n\r\n\t\t\tinfo.update( count, mode, geometry.maxInstancedCount );\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tthis.setMode = setMode;\r\n\t\tthis.setIndex = setIndex;\r\n\t\tthis.render = render;\r\n\t\tthis.renderInstances = renderInstances;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t */\r\n\r\n\tfunction WebGLInfo( gl ) {\r\n\r\n\t\tvar memory = {\r\n\t\t\tgeometries: 0,\r\n\t\t\ttextures: 0\r\n\t\t};\r\n\r\n\t\tvar render = {\r\n\t\t\tframe: 0,\r\n\t\t\tcalls: 0,\r\n\t\t\ttriangles: 0,\r\n\t\t\tpoints: 0,\r\n\t\t\tlines: 0\r\n\t\t};\r\n\r\n\t\tfunction update( count, mode, instanceCount ) {\r\n\r\n\t\t\tinstanceCount = instanceCount || 1;\r\n\r\n\t\t\trender.calls ++;\r\n\r\n\t\t\tswitch ( mode ) {\r\n\r\n\t\t\t\tcase gl.TRIANGLES:\r\n\t\t\t\t\trender.triangles += instanceCount * ( count / 3 );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase gl.TRIANGLE_STRIP:\r\n\t\t\t\tcase gl.TRIANGLE_FAN:\r\n\t\t\t\t\trender.triangles += instanceCount * ( count - 2 );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase gl.LINES:\r\n\t\t\t\t\trender.lines += instanceCount * ( count / 2 );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase gl.LINE_STRIP:\r\n\t\t\t\t\trender.lines += instanceCount * ( count - 1 );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase gl.LINE_LOOP:\r\n\t\t\t\t\trender.lines += instanceCount * count;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase gl.POINTS:\r\n\t\t\t\t\trender.points += instanceCount * count;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tconsole.error( 'THREE.WebGLInfo: Unknown draw mode:', mode );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction reset() {\r\n\r\n\t\t\trender.frame ++;\r\n\t\t\trender.calls = 0;\r\n\t\t\trender.triangles = 0;\r\n\t\t\trender.points = 0;\r\n\t\t\trender.lines = 0;\r\n\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tmemory: memory,\r\n\t\t\trender: render,\r\n\t\t\tprograms: null,\r\n\t\t\tautoReset: true,\r\n\t\t\treset: reset,\r\n\t\t\tupdate: update\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction absNumericalSort( a, b ) {\r\n\r\n\t\treturn Math.abs( b[ 1 ] ) - Math.abs( a[ 1 ] );\r\n\r\n\t}\r\n\r\n\tfunction WebGLMorphtargets( gl ) {\r\n\r\n\t\tvar influencesList = {};\r\n\t\tvar morphInfluences = new Float32Array( 8 );\r\n\r\n\t\tfunction update( object, geometry, material, program ) {\r\n\r\n\t\t\tvar objectInfluences = object.morphTargetInfluences;\r\n\r\n\t\t\tvar length = objectInfluences.length;\r\n\r\n\t\t\tvar influences = influencesList[ geometry.id ];\r\n\r\n\t\t\tif ( influences === undefined ) {\r\n\r\n\t\t\t\t// initialise list\r\n\r\n\t\t\t\tinfluences = [];\r\n\r\n\t\t\t\tfor ( var i = 0; i < length; i ++ ) {\r\n\r\n\t\t\t\t\tinfluences[ i ] = [ i, 0 ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tinfluencesList[ geometry.id ] = influences;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar morphTargets = material.morphTargets && geometry.morphAttributes.position;\r\n\t\t\tvar morphNormals = material.morphNormals && geometry.morphAttributes.normal;\r\n\r\n\t\t\t// Remove current morphAttributes\r\n\r\n\t\t\tfor ( var i = 0; i < length; i ++ ) {\r\n\r\n\t\t\t\tvar influence = influences[ i ];\r\n\r\n\t\t\t\tif ( influence[ 1 ] !== 0 ) {\r\n\r\n\t\t\t\t\tif ( morphTargets ) geometry.removeAttribute( 'morphTarget' + i );\r\n\t\t\t\t\tif ( morphNormals ) geometry.removeAttribute( 'morphNormal' + i );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Collect influences\r\n\r\n\t\t\tfor ( var i = 0; i < length; i ++ ) {\r\n\r\n\t\t\t\tvar influence = influences[ i ];\r\n\r\n\t\t\t\tinfluence[ 0 ] = i;\r\n\t\t\t\tinfluence[ 1 ] = objectInfluences[ i ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tinfluences.sort( absNumericalSort );\r\n\r\n\t\t\t// Add morphAttributes\r\n\r\n\t\t\tfor ( var i = 0; i < 8; i ++ ) {\r\n\r\n\t\t\t\tvar influence = influences[ i ];\r\n\r\n\t\t\t\tif ( influence ) {\r\n\r\n\t\t\t\t\tvar index = influence[ 0 ];\r\n\t\t\t\t\tvar value = influence[ 1 ];\r\n\r\n\t\t\t\t\tif ( value ) {\r\n\r\n\t\t\t\t\t\tif ( morphTargets ) geometry.addAttribute( 'morphTarget' + i, morphTargets[ index ] );\r\n\t\t\t\t\t\tif ( morphNormals ) geometry.addAttribute( 'morphNormal' + i, morphNormals[ index ] );\r\n\r\n\t\t\t\t\t\tmorphInfluences[ i ] = value;\r\n\t\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tmorphInfluences[ i ] = 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tprogram.getUniforms().setValue( gl, 'morphTargetInfluences', morphInfluences );\r\n\r\n\t\t}\r\n\r\n\t\treturn {\r\n\r\n\t\t\tupdate: update\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction WebGLObjects( geometries, info ) {\r\n\r\n\t\tvar updateList = {};\r\n\r\n\t\tfunction update( object ) {\r\n\r\n\t\t\tvar frame = info.render.frame;\r\n\r\n\t\t\tvar geometry = object.geometry;\r\n\t\t\tvar buffergeometry = geometries.get( object, geometry );\r\n\r\n\t\t\t// Update once per frame\r\n\r\n\t\t\tif ( updateList[ buffergeometry.id ] !== frame ) {\r\n\r\n\t\t\t\tif ( geometry.isGeometry ) {\r\n\r\n\t\t\t\t\tbuffergeometry.updateFromObject( object );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgeometries.update( buffergeometry );\r\n\r\n\t\t\t\tupdateList[ buffergeometry.id ] = frame;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn buffergeometry;\r\n\r\n\t\t}\r\n\r\n\t\tfunction dispose() {\r\n\r\n\t\t\tupdateList = {};\r\n\r\n\t\t}\r\n\r\n\t\treturn {\r\n\r\n\t\t\tupdate: update,\r\n\t\t\tdispose: dispose\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction CubeTexture( images, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, encoding ) {\r\n\r\n\t\timages = images !== undefined ? images : [];\r\n\t\tmapping = mapping !== undefined ? mapping : CubeReflectionMapping;\r\n\r\n\t\tTexture.call( this, images, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, encoding );\r\n\r\n\t\tthis.flipY = false;\r\n\r\n\t}\r\n\r\n\tCubeTexture.prototype = Object.create( Texture.prototype );\r\n\tCubeTexture.prototype.constructor = CubeTexture;\r\n\r\n\tCubeTexture.prototype.isCubeTexture = true;\r\n\r\n\tObject.defineProperty( CubeTexture.prototype, 'images', {\r\n\r\n\t\tget: function () {\r\n\r\n\t\t\treturn this.image;\r\n\r\n\t\t},\r\n\r\n\t\tset: function ( value ) {\r\n\r\n\t\t\tthis.image = value;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author tschw\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t *\r\n\t * Uniforms of a program.\r\n\t * Those form a tree structure with a special top-level container for the root,\r\n\t * which you get by calling 'new WebGLUniforms( gl, program, renderer )'.\r\n\t *\r\n\t *\r\n\t * Properties of inner nodes including the top-level container:\r\n\t *\r\n\t * .seq - array of nested uniforms\r\n\t * .map - nested uniforms by name\r\n\t *\r\n\t *\r\n\t * Methods of all nodes except the top-level container:\r\n\t *\r\n\t * .setValue( gl, value, [renderer] )\r\n\t *\r\n\t * \t\tuploads a uniform value(s)\r\n\t *  \tthe 'renderer' parameter is needed for sampler uniforms\r\n\t *\r\n\t *\r\n\t * Static methods of the top-level container (renderer factorizations):\r\n\t *\r\n\t * .upload( gl, seq, values, renderer )\r\n\t *\r\n\t * \t\tsets uniforms in 'seq' to 'values[id].value'\r\n\t *\r\n\t * .seqWithValue( seq, values ) : filteredSeq\r\n\t *\r\n\t * \t\tfilters 'seq' entries with corresponding entry in values\r\n\t *\r\n\t *\r\n\t * Methods of the top-level container (renderer factorizations):\r\n\t *\r\n\t * .setValue( gl, name, value )\r\n\t *\r\n\t * \t\tsets uniform with  name 'name' to 'value'\r\n\t *\r\n\t * .set( gl, obj, prop )\r\n\t *\r\n\t * \t\tsets uniform from object and property with same name than uniform\r\n\t *\r\n\t * .setOptional( gl, obj, prop )\r\n\t *\r\n\t * \t\tlike .set for an optional property of the object\r\n\t *\r\n\t */\r\n\r\n\tvar emptyTexture = new Texture();\r\n\tvar emptyCubeTexture = new CubeTexture();\r\n\r\n\t// --- Base for inner nodes (including the root) ---\r\n\r\n\tfunction UniformContainer() {\r\n\r\n\t\tthis.seq = [];\r\n\t\tthis.map = {};\r\n\r\n\t}\r\n\r\n\t// --- Utilities ---\r\n\r\n\t// Array Caches (provide typed arrays for temporary by size)\r\n\r\n\tvar arrayCacheF32 = [];\r\n\tvar arrayCacheI32 = [];\r\n\r\n\t// Float32Array caches used for uploading Matrix uniforms\r\n\r\n\tvar mat4array = new Float32Array( 16 );\r\n\tvar mat3array = new Float32Array( 9 );\r\n\tvar mat2array = new Float32Array( 4 );\r\n\r\n\t// Flattening for arrays of vectors and matrices\r\n\r\n\tfunction flatten( array, nBlocks, blockSize ) {\r\n\r\n\t\tvar firstElem = array[ 0 ];\r\n\r\n\t\tif ( firstElem <= 0 || firstElem > 0 ) return array;\r\n\t\t// unoptimized: ! isNaN( firstElem )\r\n\t\t// see http://jacksondunstan.com/articles/983\r\n\r\n\t\tvar n = nBlocks * blockSize,\r\n\t\t\tr = arrayCacheF32[ n ];\r\n\r\n\t\tif ( r === undefined ) {\r\n\r\n\t\t\tr = new Float32Array( n );\r\n\t\t\tarrayCacheF32[ n ] = r;\r\n\r\n\t\t}\r\n\r\n\t\tif ( nBlocks !== 0 ) {\r\n\r\n\t\t\tfirstElem.toArray( r, 0 );\r\n\r\n\t\t\tfor ( var i = 1, offset = 0; i !== nBlocks; ++ i ) {\r\n\r\n\t\t\t\toffset += blockSize;\r\n\t\t\t\tarray[ i ].toArray( r, offset );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn r;\r\n\r\n\t}\r\n\r\n\tfunction arraysEqual( a, b ) {\r\n\r\n\t\tif ( a.length !== b.length ) return false;\r\n\r\n\t\tfor ( var i = 0, l = a.length; i < l; i ++ ) {\r\n\r\n\t\t\tif ( a[ i ] !== b[ i ] ) return false;\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t}\r\n\r\n\tfunction copyArray( a, b ) {\r\n\r\n\t\tfor ( var i = 0, l = b.length; i < l; i ++ ) {\r\n\r\n\t\t\ta[ i ] = b[ i ];\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// Texture unit allocation\r\n\r\n\tfunction allocTexUnits( renderer, n ) {\r\n\r\n\t\tvar r = arrayCacheI32[ n ];\r\n\r\n\t\tif ( r === undefined ) {\r\n\r\n\t\t\tr = new Int32Array( n );\r\n\t\t\tarrayCacheI32[ n ] = r;\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0; i !== n; ++ i )\r\n\t\t\tr[ i ] = renderer.allocTextureUnit();\r\n\r\n\t\treturn r;\r\n\r\n\t}\r\n\r\n\t// --- Setters ---\r\n\r\n\t// Note: Defining these methods externally, because they come in a bunch\r\n\t// and this way their names minify.\r\n\r\n\t// Single scalar\r\n\r\n\tfunction setValue1f( gl, v ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\r\n\t\tif ( cache[ 0 ] === v ) return;\r\n\r\n\t\tgl.uniform1f( this.addr, v );\r\n\r\n\t\tcache[ 0 ] = v;\r\n\r\n\t}\r\n\r\n\tfunction setValue1i( gl, v ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\r\n\t\tif ( cache[ 0 ] === v ) return;\r\n\r\n\t\tgl.uniform1i( this.addr, v );\r\n\r\n\t\tcache[ 0 ] = v;\r\n\r\n\t}\r\n\r\n\t// Single float vector (from flat array or THREE.VectorN)\r\n\r\n\tfunction setValue2fv( gl, v ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\r\n\t\tif ( v.x !== undefined ) {\r\n\r\n\t\t\tif ( cache[ 0 ] !== v.x || cache[ 1 ] !== v.y ) {\r\n\r\n\t\t\t\tgl.uniform2f( this.addr, v.x, v.y );\r\n\r\n\t\t\t\tcache[ 0 ] = v.x;\r\n\t\t\t\tcache[ 1 ] = v.y;\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tif ( arraysEqual( cache, v ) ) return;\r\n\r\n\t\t\tgl.uniform2fv( this.addr, v );\r\n\r\n\t\t\tcopyArray( cache, v );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction setValue3fv( gl, v ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\r\n\t\tif ( v.x !== undefined ) {\r\n\r\n\t\t\tif ( cache[ 0 ] !== v.x || cache[ 1 ] !== v.y || cache[ 2 ] !== v.z ) {\r\n\r\n\t\t\t\tgl.uniform3f( this.addr, v.x, v.y, v.z );\r\n\r\n\t\t\t\tcache[ 0 ] = v.x;\r\n\t\t\t\tcache[ 1 ] = v.y;\r\n\t\t\t\tcache[ 2 ] = v.z;\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( v.r !== undefined ) {\r\n\r\n\t\t\tif ( cache[ 0 ] !== v.r || cache[ 1 ] !== v.g || cache[ 2 ] !== v.b ) {\r\n\r\n\t\t\t\tgl.uniform3f( this.addr, v.r, v.g, v.b );\r\n\r\n\t\t\t\tcache[ 0 ] = v.r;\r\n\t\t\t\tcache[ 1 ] = v.g;\r\n\t\t\t\tcache[ 2 ] = v.b;\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tif ( arraysEqual( cache, v ) ) return;\r\n\r\n\t\t\tgl.uniform3fv( this.addr, v );\r\n\r\n\t\t\tcopyArray( cache, v );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction setValue4fv( gl, v ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\r\n\t\tif ( v.x !== undefined ) {\r\n\r\n\t\t\tif ( cache[ 0 ] !== v.x || cache[ 1 ] !== v.y || cache[ 2 ] !== v.z || cache[ 3 ] !== v.w ) {\r\n\r\n\t\t\t\tgl.uniform4f( this.addr, v.x, v.y, v.z, v.w );\r\n\r\n\t\t\t\tcache[ 0 ] = v.x;\r\n\t\t\t\tcache[ 1 ] = v.y;\r\n\t\t\t\tcache[ 2 ] = v.z;\r\n\t\t\t\tcache[ 3 ] = v.w;\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tif ( arraysEqual( cache, v ) ) return;\r\n\r\n\t\t\tgl.uniform4fv( this.addr, v );\r\n\r\n\t\t\tcopyArray( cache, v );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// Single matrix (from flat array or MatrixN)\r\n\r\n\tfunction setValue2fm( gl, v ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\t\tvar elements = v.elements;\r\n\r\n\t\tif ( elements === undefined ) {\r\n\r\n\t\t\tif ( arraysEqual( cache, v ) ) return;\r\n\r\n\t\t\tgl.uniformMatrix2fv( this.addr, false, v );\r\n\r\n\t\t\tcopyArray( cache, v );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tif ( arraysEqual( cache, elements ) ) return;\r\n\r\n\t\t\tmat2array.set( elements );\r\n\r\n\t\t\tgl.uniformMatrix2fv( this.addr, false, mat2array );\r\n\r\n\t\t\tcopyArray( cache, elements );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction setValue3fm( gl, v ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\t\tvar elements = v.elements;\r\n\r\n\t\tif ( elements === undefined ) {\r\n\r\n\t\t\tif ( arraysEqual( cache, v ) ) return;\r\n\r\n\t\t\tgl.uniformMatrix3fv( this.addr, false, v );\r\n\r\n\t\t\tcopyArray( cache, v );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tif ( arraysEqual( cache, elements ) ) return;\r\n\r\n\t\t\tmat3array.set( elements );\r\n\r\n\t\t\tgl.uniformMatrix3fv( this.addr, false, mat3array );\r\n\r\n\t\t\tcopyArray( cache, elements );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction setValue4fm( gl, v ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\t\tvar elements = v.elements;\r\n\r\n\t\tif ( elements === undefined ) {\r\n\r\n\t\t\tif ( arraysEqual( cache, v ) ) return;\r\n\r\n\t\t\tgl.uniformMatrix4fv( this.addr, false, v );\r\n\r\n\t\t\tcopyArray( cache, v );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tif ( arraysEqual( cache, elements ) ) return;\r\n\r\n\t\t\tmat4array.set( elements );\r\n\r\n\t\t\tgl.uniformMatrix4fv( this.addr, false, mat4array );\r\n\r\n\t\t\tcopyArray( cache, elements );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// Single texture (2D / Cube)\r\n\r\n\tfunction setValueT1( gl, v, renderer ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\t\tvar unit = renderer.allocTextureUnit();\r\n\r\n\t\tif ( cache[ 0 ] !== unit ) {\r\n\r\n\t\t\tgl.uniform1i( this.addr, unit );\r\n\t\t\tcache[ 0 ] = unit;\r\n\r\n\t\t}\r\n\r\n\t\trenderer.setTexture2D( v || emptyTexture, unit );\r\n\r\n\t}\r\n\r\n\tfunction setValueT6( gl, v, renderer ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\t\tvar unit = renderer.allocTextureUnit();\r\n\r\n\t\tif ( cache[ 0 ] !== unit ) {\r\n\r\n\t\t\tgl.uniform1i( this.addr, unit );\r\n\t\t\tcache[ 0 ] = unit;\r\n\r\n\t\t}\r\n\r\n\t\trenderer.setTextureCube( v || emptyCubeTexture, unit );\r\n\r\n\t}\r\n\r\n\t// Integer / Boolean vectors or arrays thereof (always flat arrays)\r\n\r\n\tfunction setValue2iv( gl, v ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\r\n\t\tif ( arraysEqual( cache, v ) ) return;\r\n\r\n\t\tgl.uniform2iv( this.addr, v );\r\n\r\n\t\tcopyArray( cache, v );\r\n\r\n\t}\r\n\r\n\tfunction setValue3iv( gl, v ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\r\n\t\tif ( arraysEqual( cache, v ) ) return;\r\n\r\n\t\tgl.uniform3iv( this.addr, v );\r\n\r\n\t\tcopyArray( cache, v );\r\n\r\n\t}\r\n\r\n\tfunction setValue4iv( gl, v ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\r\n\t\tif ( arraysEqual( cache, v ) ) return;\r\n\r\n\t\tgl.uniform4iv( this.addr, v );\r\n\r\n\t\tcopyArray( cache, v );\r\n\r\n\t}\r\n\r\n\t// Helper to pick the right setter for the singular case\r\n\r\n\tfunction getSingularSetter( type ) {\r\n\r\n\t\tswitch ( type ) {\r\n\r\n\t\t\tcase 0x1406: return setValue1f; // FLOAT\r\n\t\t\tcase 0x8b50: return setValue2fv; // _VEC2\r\n\t\t\tcase 0x8b51: return setValue3fv; // _VEC3\r\n\t\t\tcase 0x8b52: return setValue4fv; // _VEC4\r\n\r\n\t\t\tcase 0x8b5a: return setValue2fm; // _MAT2\r\n\t\t\tcase 0x8b5b: return setValue3fm; // _MAT3\r\n\t\t\tcase 0x8b5c: return setValue4fm; // _MAT4\r\n\r\n\t\t\tcase 0x8b5e: case 0x8d66: return setValueT1; // SAMPLER_2D, SAMPLER_EXTERNAL_OES\r\n\t\t\tcase 0x8b60: return setValueT6; // SAMPLER_CUBE\r\n\r\n\t\t\tcase 0x1404: case 0x8b56: return setValue1i; // INT, BOOL\r\n\t\t\tcase 0x8b53: case 0x8b57: return setValue2iv; // _VEC2\r\n\t\t\tcase 0x8b54: case 0x8b58: return setValue3iv; // _VEC3\r\n\t\t\tcase 0x8b55: case 0x8b59: return setValue4iv; // _VEC4\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// Array of scalars\r\n\r\n\tfunction setValue1fv( gl, v ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\r\n\t\tif ( arraysEqual( cache, v ) ) return;\r\n\r\n\t\tgl.uniform1fv( this.addr, v );\r\n\r\n\t\tcopyArray( cache, v );\r\n\r\n\t}\r\n\tfunction setValue1iv( gl, v ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\r\n\t\tif ( arraysEqual( cache, v ) ) return;\r\n\r\n\t\tgl.uniform1iv( this.addr, v );\r\n\r\n\t\tcopyArray( cache, v );\r\n\r\n\t}\r\n\r\n\t// Array of vectors (flat or from THREE classes)\r\n\r\n\tfunction setValueV2a( gl, v ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\t\tvar data = flatten( v, this.size, 2 );\r\n\r\n\t\tif ( arraysEqual( cache, data ) ) return;\r\n\r\n\t\tgl.uniform2fv( this.addr, data );\r\n\r\n\t\tthis.updateCache( data );\r\n\r\n\t}\r\n\r\n\tfunction setValueV3a( gl, v ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\t\tvar data = flatten( v, this.size, 3 );\r\n\r\n\t\tif ( arraysEqual( cache, data ) ) return;\r\n\r\n\t\tgl.uniform3fv( this.addr, data );\r\n\r\n\t\tthis.updateCache( data );\r\n\r\n\t}\r\n\r\n\tfunction setValueV4a( gl, v ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\t\tvar data = flatten( v, this.size, 4 );\r\n\r\n\t\tif ( arraysEqual( cache, data ) ) return;\r\n\r\n\t\tgl.uniform4fv( this.addr, data );\r\n\r\n\t\tthis.updateCache( data );\r\n\r\n\t}\r\n\r\n\t// Array of matrices (flat or from THREE clases)\r\n\r\n\tfunction setValueM2a( gl, v ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\t\tvar data = flatten( v, this.size, 4 );\r\n\r\n\t\tif ( arraysEqual( cache, data ) ) return;\r\n\r\n\t\tgl.uniformMatrix2fv( this.addr, false, data );\r\n\r\n\t\tthis.updateCache( data );\r\n\r\n\t}\r\n\r\n\tfunction setValueM3a( gl, v ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\t\tvar data = flatten( v, this.size, 9 );\r\n\r\n\t\tif ( arraysEqual( cache, data ) ) return;\r\n\r\n\t\tgl.uniformMatrix3fv( this.addr, false, data );\r\n\r\n\t\tthis.updateCache( data );\r\n\r\n\t}\r\n\r\n\tfunction setValueM4a( gl, v ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\t\tvar data = flatten( v, this.size, 16 );\r\n\r\n\t\tif ( arraysEqual( cache, data ) ) return;\r\n\r\n\t\tgl.uniformMatrix4fv( this.addr, false, data );\r\n\r\n\t\tthis.updateCache( data );\r\n\r\n\t}\r\n\r\n\t// Array of textures (2D / Cube)\r\n\r\n\tfunction setValueT1a( gl, v, renderer ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\t\tvar n = v.length;\r\n\r\n\t\tvar units = allocTexUnits( renderer, n );\r\n\r\n\t\tif ( arraysEqual( cache, units ) === false ) {\r\n\r\n\t\t\tgl.uniform1iv( this.addr, units );\r\n\t\t\tcopyArray( cache, units );\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0; i !== n; ++ i ) {\r\n\r\n\t\t\trenderer.setTexture2D( v[ i ] || emptyTexture, units[ i ] );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction setValueT6a( gl, v, renderer ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\t\tvar n = v.length;\r\n\r\n\t\tvar units = allocTexUnits( renderer, n );\r\n\r\n\t\tif ( arraysEqual( cache, units ) === false ) {\r\n\r\n\t\t\tgl.uniform1iv( this.addr, units );\r\n\t\t\tcopyArray( cache, units );\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0; i !== n; ++ i ) {\r\n\r\n\t\t\trenderer.setTextureCube( v[ i ] || emptyCubeTexture, units[ i ] );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// Helper to pick the right setter for a pure (bottom-level) array\r\n\r\n\tfunction getPureArraySetter( type ) {\r\n\r\n\t\tswitch ( type ) {\r\n\r\n\t\t\tcase 0x1406: return setValue1fv; // FLOAT\r\n\t\t\tcase 0x8b50: return setValueV2a; // _VEC2\r\n\t\t\tcase 0x8b51: return setValueV3a; // _VEC3\r\n\t\t\tcase 0x8b52: return setValueV4a; // _VEC4\r\n\r\n\t\t\tcase 0x8b5a: return setValueM2a; // _MAT2\r\n\t\t\tcase 0x8b5b: return setValueM3a; // _MAT3\r\n\t\t\tcase 0x8b5c: return setValueM4a; // _MAT4\r\n\r\n\t\t\tcase 0x8b5e: return setValueT1a; // SAMPLER_2D\r\n\t\t\tcase 0x8b60: return setValueT6a; // SAMPLER_CUBE\r\n\r\n\t\t\tcase 0x1404: case 0x8b56: return setValue1iv; // INT, BOOL\r\n\t\t\tcase 0x8b53: case 0x8b57: return setValue2iv; // _VEC2\r\n\t\t\tcase 0x8b54: case 0x8b58: return setValue3iv; // _VEC3\r\n\t\t\tcase 0x8b55: case 0x8b59: return setValue4iv; // _VEC4\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// --- Uniform Classes ---\r\n\r\n\tfunction SingleUniform( id, activeInfo, addr ) {\r\n\r\n\t\tthis.id = id;\r\n\t\tthis.addr = addr;\r\n\t\tthis.cache = [];\r\n\t\tthis.setValue = getSingularSetter( activeInfo.type );\r\n\r\n\t\t// this.path = activeInfo.name; // DEBUG\r\n\r\n\t}\r\n\r\n\tfunction PureArrayUniform( id, activeInfo, addr ) {\r\n\r\n\t\tthis.id = id;\r\n\t\tthis.addr = addr;\r\n\t\tthis.cache = [];\r\n\t\tthis.size = activeInfo.size;\r\n\t\tthis.setValue = getPureArraySetter( activeInfo.type );\r\n\r\n\t\t// this.path = activeInfo.name; // DEBUG\r\n\r\n\t}\r\n\r\n\tPureArrayUniform.prototype.updateCache = function ( data ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\r\n\t\tif ( data instanceof Float32Array && cache.length !== data.length ) {\r\n\r\n\t\t\tthis.cache = new Float32Array( data.length );\r\n\r\n\t\t}\r\n\r\n\t\tcopyArray( cache, data );\r\n\r\n\t};\r\n\r\n\tfunction StructuredUniform( id ) {\r\n\r\n\t\tthis.id = id;\r\n\r\n\t\tUniformContainer.call( this ); // mix-in\r\n\r\n\t}\r\n\r\n\tStructuredUniform.prototype.setValue = function ( gl, value, renderer ) {\r\n\r\n\t\tvar seq = this.seq;\r\n\r\n\t\tfor ( var i = 0, n = seq.length; i !== n; ++ i ) {\r\n\r\n\t\t\tvar u = seq[ i ];\r\n\t\t\tu.setValue( gl, value[ u.id ], renderer );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t// --- Top-level ---\r\n\r\n\t// Parser - builds up the property tree from the path strings\r\n\r\n\tvar RePathPart = /([\\w\\d_]+)(\\])?(\\[|\\.)?/g;\r\n\r\n\t// extracts\r\n\t// \t- the identifier (member name or array index)\r\n\t//  - followed by an optional right bracket (found when array index)\r\n\t//  - followed by an optional left bracket or dot (type of subscript)\r\n\t//\r\n\t// Note: These portions can be read in a non-overlapping fashion and\r\n\t// allow straightforward parsing of the hierarchy that WebGL encodes\r\n\t// in the uniform names.\r\n\r\n\tfunction addUniform( container, uniformObject ) {\r\n\r\n\t\tcontainer.seq.push( uniformObject );\r\n\t\tcontainer.map[ uniformObject.id ] = uniformObject;\r\n\r\n\t}\r\n\r\n\tfunction parseUniform( activeInfo, addr, container ) {\r\n\r\n\t\tvar path = activeInfo.name,\r\n\t\t\tpathLength = path.length;\r\n\r\n\t\t// reset RegExp object, because of the early exit of a previous run\r\n\t\tRePathPart.lastIndex = 0;\r\n\r\n\t\twhile ( true ) {\r\n\r\n\t\t\tvar match = RePathPart.exec( path ),\r\n\t\t\t\tmatchEnd = RePathPart.lastIndex,\r\n\r\n\t\t\t\tid = match[ 1 ],\r\n\t\t\t\tidIsIndex = match[ 2 ] === ']',\r\n\t\t\t\tsubscript = match[ 3 ];\r\n\r\n\t\t\tif ( idIsIndex ) id = id | 0; // convert to integer\r\n\r\n\t\t\tif ( subscript === undefined || subscript === '[' && matchEnd + 2 === pathLength ) {\r\n\r\n\t\t\t\t// bare name or \"pure\" bottom-level array \"[0]\" suffix\r\n\r\n\t\t\t\taddUniform( container, subscript === undefined ?\r\n\t\t\t\t\tnew SingleUniform( id, activeInfo, addr ) :\r\n\t\t\t\t\tnew PureArrayUniform( id, activeInfo, addr ) );\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// step into inner node / create it in case it doesn't exist\r\n\r\n\t\t\t\tvar map = container.map, next = map[ id ];\r\n\r\n\t\t\t\tif ( next === undefined ) {\r\n\r\n\t\t\t\t\tnext = new StructuredUniform( id );\r\n\t\t\t\t\taddUniform( container, next );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcontainer = next;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// Root Container\r\n\r\n\tfunction WebGLUniforms( gl, program, renderer ) {\r\n\r\n\t\tUniformContainer.call( this );\r\n\r\n\t\tthis.renderer = renderer;\r\n\r\n\t\tvar n = gl.getProgramParameter( program, gl.ACTIVE_UNIFORMS );\r\n\r\n\t\tfor ( var i = 0; i < n; ++ i ) {\r\n\r\n\t\t\tvar info = gl.getActiveUniform( program, i ),\r\n\t\t\t\taddr = gl.getUniformLocation( program, info.name );\r\n\r\n\t\t\tparseUniform( info, addr, this );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tWebGLUniforms.prototype.setValue = function ( gl, name, value ) {\r\n\r\n\t\tvar u = this.map[ name ];\r\n\r\n\t\tif ( u !== undefined ) u.setValue( gl, value, this.renderer );\r\n\r\n\t};\r\n\r\n\tWebGLUniforms.prototype.setOptional = function ( gl, object, name ) {\r\n\r\n\t\tvar v = object[ name ];\r\n\r\n\t\tif ( v !== undefined ) this.setValue( gl, name, v );\r\n\r\n\t};\r\n\r\n\r\n\t// Static interface\r\n\r\n\tWebGLUniforms.upload = function ( gl, seq, values, renderer ) {\r\n\r\n\t\tfor ( var i = 0, n = seq.length; i !== n; ++ i ) {\r\n\r\n\t\t\tvar u = seq[ i ],\r\n\t\t\t\tv = values[ u.id ];\r\n\r\n\t\t\tif ( v.needsUpdate !== false ) {\r\n\r\n\t\t\t\t// note: always updating when .needsUpdate is undefined\r\n\t\t\t\tu.setValue( gl, v.value, renderer );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tWebGLUniforms.seqWithValue = function ( seq, values ) {\r\n\r\n\t\tvar r = [];\r\n\r\n\t\tfor ( var i = 0, n = seq.length; i !== n; ++ i ) {\r\n\r\n\t\t\tvar u = seq[ i ];\r\n\t\t\tif ( u.id in values ) r.push( u );\r\n\r\n\t\t}\r\n\r\n\t\treturn r;\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction addLineNumbers( string ) {\r\n\r\n\t\tvar lines = string.split( '\\n' );\r\n\r\n\t\tfor ( var i = 0; i < lines.length; i ++ ) {\r\n\r\n\t\t\tlines[ i ] = ( i + 1 ) + ': ' + lines[ i ];\r\n\r\n\t\t}\r\n\r\n\t\treturn lines.join( '\\n' );\r\n\r\n\t}\r\n\r\n\tfunction WebGLShader( gl, type, string ) {\r\n\r\n\t\tvar shader = gl.createShader( type );\r\n\r\n\t\tgl.shaderSource( shader, string );\r\n\t\tgl.compileShader( shader );\r\n\r\n\t\tif ( gl.getShaderParameter( shader, gl.COMPILE_STATUS ) === false ) {\r\n\r\n\t\t\tconsole.error( 'THREE.WebGLShader: Shader couldn\\'t compile.' );\r\n\r\n\t\t}\r\n\r\n\t\tif ( gl.getShaderInfoLog( shader ) !== '' ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLShader: gl.getShaderInfoLog()', type === gl.VERTEX_SHADER ? 'vertex' : 'fragment', gl.getShaderInfoLog( shader ), addLineNumbers( string ) );\r\n\r\n\t\t}\r\n\r\n\t\t// --enable-privileged-webgl-extension\r\n\t\t// console.log( type, gl.getExtension( 'WEBGL_debug_shaders' ).getTranslatedShaderSource( shader ) );\r\n\r\n\t\treturn shader;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tvar programIdCount = 0;\r\n\r\n\tfunction getEncodingComponents( encoding ) {\r\n\r\n\t\tswitch ( encoding ) {\r\n\r\n\t\t\tcase LinearEncoding:\r\n\t\t\t\treturn [ 'Linear', '( value )' ];\r\n\t\t\tcase sRGBEncoding:\r\n\t\t\t\treturn [ 'sRGB', '( value )' ];\r\n\t\t\tcase RGBEEncoding:\r\n\t\t\t\treturn [ 'RGBE', '( value )' ];\r\n\t\t\tcase RGBM7Encoding:\r\n\t\t\t\treturn [ 'RGBM', '( value, 7.0 )' ];\r\n\t\t\tcase RGBM16Encoding:\r\n\t\t\t\treturn [ 'RGBM', '( value, 16.0 )' ];\r\n\t\t\tcase RGBDEncoding:\r\n\t\t\t\treturn [ 'RGBD', '( value, 256.0 )' ];\r\n\t\t\tcase GammaEncoding:\r\n\t\t\t\treturn [ 'Gamma', '( value, float( GAMMA_FACTOR ) )' ];\r\n\t\t\tdefault:\r\n\t\t\t\tthrow new Error( 'unsupported encoding: ' + encoding );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction getTexelDecodingFunction( functionName, encoding ) {\r\n\r\n\t\tvar components = getEncodingComponents( encoding );\r\n\t\treturn 'vec4 ' + functionName + '( vec4 value ) { return ' + components[ 0 ] + 'ToLinear' + components[ 1 ] + '; }';\r\n\r\n\t}\r\n\r\n\tfunction getTexelEncodingFunction( functionName, encoding ) {\r\n\r\n\t\tvar components = getEncodingComponents( encoding );\r\n\t\treturn 'vec4 ' + functionName + '( vec4 value ) { return LinearTo' + components[ 0 ] + components[ 1 ] + '; }';\r\n\r\n\t}\r\n\r\n\tfunction getToneMappingFunction( functionName, toneMapping ) {\r\n\r\n\t\tvar toneMappingName;\r\n\r\n\t\tswitch ( toneMapping ) {\r\n\r\n\t\t\tcase LinearToneMapping:\r\n\t\t\t\ttoneMappingName = 'Linear';\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase ReinhardToneMapping:\r\n\t\t\t\ttoneMappingName = 'Reinhard';\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase Uncharted2ToneMapping:\r\n\t\t\t\ttoneMappingName = 'Uncharted2';\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase CineonToneMapping:\r\n\t\t\t\ttoneMappingName = 'OptimizedCineon';\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tdefault:\r\n\t\t\t\tthrow new Error( 'unsupported toneMapping: ' + toneMapping );\r\n\r\n\t\t}\r\n\r\n\t\treturn 'vec3 ' + functionName + '( vec3 color ) { return ' + toneMappingName + 'ToneMapping( color ); }';\r\n\r\n\t}\r\n\r\n\tfunction generateExtensions( extensions, parameters, rendererExtensions ) {\r\n\r\n\t\textensions = extensions || {};\r\n\r\n\t\tvar chunks = [\r\n\t\t\t( extensions.derivatives || parameters.envMapCubeUV || parameters.bumpMap || ( parameters.normalMap && ! parameters.objectSpaceNormalMap ) || parameters.flatShading ) ? '#extension GL_OES_standard_derivatives : enable' : '',\r\n\t\t\t( extensions.fragDepth || parameters.logarithmicDepthBuffer ) && rendererExtensions.get( 'EXT_frag_depth' ) ? '#extension GL_EXT_frag_depth : enable' : '',\r\n\t\t\t( extensions.drawBuffers ) && rendererExtensions.get( 'WEBGL_draw_buffers' ) ? '#extension GL_EXT_draw_buffers : require' : '',\r\n\t\t\t( extensions.shaderTextureLOD || parameters.envMap ) && rendererExtensions.get( 'EXT_shader_texture_lod' ) ? '#extension GL_EXT_shader_texture_lod : enable' : ''\r\n\t\t];\r\n\r\n\t\treturn chunks.filter( filterEmptyLine ).join( '\\n' );\r\n\r\n\t}\r\n\r\n\tfunction generateDefines( defines ) {\r\n\r\n\t\tvar chunks = [];\r\n\r\n\t\tfor ( var name in defines ) {\r\n\r\n\t\t\tvar value = defines[ name ];\r\n\r\n\t\t\tif ( value === false ) continue;\r\n\r\n\t\t\tchunks.push( '#define ' + name + ' ' + value );\r\n\r\n\t\t}\r\n\r\n\t\treturn chunks.join( '\\n' );\r\n\r\n\t}\r\n\r\n\tfunction fetchAttributeLocations( gl, program ) {\r\n\r\n\t\tvar attributes = {};\r\n\r\n\t\tvar n = gl.getProgramParameter( program, gl.ACTIVE_ATTRIBUTES );\r\n\r\n\t\tfor ( var i = 0; i < n; i ++ ) {\r\n\r\n\t\t\tvar info = gl.getActiveAttrib( program, i );\r\n\t\t\tvar name = info.name;\r\n\r\n\t\t\t// console.log( 'THREE.WebGLProgram: ACTIVE VERTEX ATTRIBUTE:', name, i );\r\n\r\n\t\t\tattributes[ name ] = gl.getAttribLocation( program, name );\r\n\r\n\t\t}\r\n\r\n\t\treturn attributes;\r\n\r\n\t}\r\n\r\n\tfunction filterEmptyLine( string ) {\r\n\r\n\t\treturn string !== '';\r\n\r\n\t}\r\n\r\n\tfunction replaceLightNums( string, parameters ) {\r\n\r\n\t\treturn string\r\n\t\t\t.replace( /NUM_DIR_LIGHTS/g, parameters.numDirLights )\r\n\t\t\t.replace( /NUM_SPOT_LIGHTS/g, parameters.numSpotLights )\r\n\t\t\t.replace( /NUM_RECT_AREA_LIGHTS/g, parameters.numRectAreaLights )\r\n\t\t\t.replace( /NUM_POINT_LIGHTS/g, parameters.numPointLights )\r\n\t\t\t.replace( /NUM_HEMI_LIGHTS/g, parameters.numHemiLights );\r\n\r\n\t}\r\n\r\n\tfunction replaceClippingPlaneNums( string, parameters ) {\r\n\r\n\t\treturn string\r\n\t\t\t.replace( /NUM_CLIPPING_PLANES/g, parameters.numClippingPlanes )\r\n\t\t\t.replace( /UNION_CLIPPING_PLANES/g, ( parameters.numClippingPlanes - parameters.numClipIntersection ) );\r\n\r\n\t}\r\n\r\n\tfunction parseIncludes( string ) {\r\n\r\n\t\tvar pattern = /^[ \\t]*#include +<([\\w\\d./]+)>/gm;\r\n\r\n\t\tfunction replace( match, include ) {\r\n\r\n\t\t\tvar replace = ShaderChunk[ include ];\r\n\r\n\t\t\tif ( replace === undefined ) {\r\n\r\n\t\t\t\tthrow new Error( 'Can not resolve #include <' + include + '>' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn parseIncludes( replace );\r\n\r\n\t\t}\r\n\r\n\t\treturn string.replace( pattern, replace );\r\n\r\n\t}\r\n\r\n\tfunction unrollLoops( string ) {\r\n\r\n\t\tvar pattern = /#pragma unroll_loop[\\s]+?for \\( int i \\= (\\d+)\\; i < (\\d+)\\; i \\+\\+ \\) \\{([\\s\\S]+?)(?=\\})\\}/g;\r\n\r\n\t\tfunction replace( match, start, end, snippet ) {\r\n\r\n\t\t\tvar unroll = '';\r\n\r\n\t\t\tfor ( var i = parseInt( start ); i < parseInt( end ); i ++ ) {\r\n\r\n\t\t\t\tunroll += snippet.replace( /\\[ i \\]/g, '[ ' + i + ' ]' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn unroll;\r\n\r\n\t\t}\r\n\r\n\t\treturn string.replace( pattern, replace );\r\n\r\n\t}\r\n\r\n\tfunction WebGLProgram( renderer, extensions, code, material, shader, parameters, capabilities ) {\r\n\r\n\t\tvar gl = renderer.context;\r\n\r\n\t\tvar defines = material.defines;\r\n\r\n\t\tvar vertexShader = shader.vertexShader;\r\n\t\tvar fragmentShader = shader.fragmentShader;\r\n\r\n\t\tvar shadowMapTypeDefine = 'SHADOWMAP_TYPE_BASIC';\r\n\r\n\t\tif ( parameters.shadowMapType === PCFShadowMap ) {\r\n\r\n\t\t\tshadowMapTypeDefine = 'SHADOWMAP_TYPE_PCF';\r\n\r\n\t\t} else if ( parameters.shadowMapType === PCFSoftShadowMap ) {\r\n\r\n\t\t\tshadowMapTypeDefine = 'SHADOWMAP_TYPE_PCF_SOFT';\r\n\r\n\t\t}\r\n\r\n\t\tvar envMapTypeDefine = 'ENVMAP_TYPE_CUBE';\r\n\t\tvar envMapModeDefine = 'ENVMAP_MODE_REFLECTION';\r\n\t\tvar envMapBlendingDefine = 'ENVMAP_BLENDING_MULTIPLY';\r\n\r\n\t\tif ( parameters.envMap ) {\r\n\r\n\t\t\tswitch ( material.envMap.mapping ) {\r\n\r\n\t\t\t\tcase CubeReflectionMapping:\r\n\t\t\t\tcase CubeRefractionMapping:\r\n\t\t\t\t\tenvMapTypeDefine = 'ENVMAP_TYPE_CUBE';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase CubeUVReflectionMapping:\r\n\t\t\t\tcase CubeUVRefractionMapping:\r\n\t\t\t\t\tenvMapTypeDefine = 'ENVMAP_TYPE_CUBE_UV';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase EquirectangularReflectionMapping:\r\n\t\t\t\tcase EquirectangularRefractionMapping:\r\n\t\t\t\t\tenvMapTypeDefine = 'ENVMAP_TYPE_EQUIREC';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase SphericalReflectionMapping:\r\n\t\t\t\t\tenvMapTypeDefine = 'ENVMAP_TYPE_SPHERE';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tswitch ( material.envMap.mapping ) {\r\n\r\n\t\t\t\tcase CubeRefractionMapping:\r\n\t\t\t\tcase EquirectangularRefractionMapping:\r\n\t\t\t\t\tenvMapModeDefine = 'ENVMAP_MODE_REFRACTION';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tswitch ( material.combine ) {\r\n\r\n\t\t\t\tcase MultiplyOperation:\r\n\t\t\t\t\tenvMapBlendingDefine = 'ENVMAP_BLENDING_MULTIPLY';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase MixOperation:\r\n\t\t\t\t\tenvMapBlendingDefine = 'ENVMAP_BLENDING_MIX';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase AddOperation:\r\n\t\t\t\t\tenvMapBlendingDefine = 'ENVMAP_BLENDING_ADD';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar gammaFactorDefine = ( renderer.gammaFactor > 0 ) ? renderer.gammaFactor : 1.0;\r\n\r\n\t\t// console.log( 'building new program ' );\r\n\r\n\t\t//\r\n\r\n\t\tvar customExtensions = capabilities.isWebGL2 ? '' : generateExtensions( material.extensions, parameters, extensions );\r\n\r\n\t\tvar customDefines = generateDefines( defines );\r\n\r\n\t\t//\r\n\r\n\t\tvar program = gl.createProgram();\r\n\r\n\t\tvar prefixVertex, prefixFragment;\r\n\r\n\t\tif ( material.isRawShaderMaterial ) {\r\n\r\n\t\t\tprefixVertex = [\r\n\r\n\t\t\t\tcustomDefines\r\n\r\n\t\t\t].filter( filterEmptyLine ).join( '\\n' );\r\n\r\n\t\t\tif ( prefixVertex.length > 0 ) {\r\n\r\n\t\t\t\tprefixVertex += '\\n';\r\n\r\n\t\t\t}\r\n\r\n\t\t\tprefixFragment = [\r\n\r\n\t\t\t\tcustomExtensions,\r\n\t\t\t\tcustomDefines\r\n\r\n\t\t\t].filter( filterEmptyLine ).join( '\\n' );\r\n\r\n\t\t\tif ( prefixFragment.length > 0 ) {\r\n\r\n\t\t\t\tprefixFragment += '\\n';\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tprefixVertex = [\r\n\r\n\t\t\t\t'precision ' + parameters.precision + ' float;',\r\n\t\t\t\t'precision ' + parameters.precision + ' int;',\r\n\r\n\t\t\t\t'#define SHADER_NAME ' + shader.name,\r\n\r\n\t\t\t\tcustomDefines,\r\n\r\n\t\t\t\tparameters.supportsVertexTextures ? '#define VERTEX_TEXTURES' : '',\r\n\r\n\t\t\t\t'#define GAMMA_FACTOR ' + gammaFactorDefine,\r\n\r\n\t\t\t\t'#define MAX_BONES ' + parameters.maxBones,\r\n\t\t\t\t( parameters.useFog && parameters.fog ) ? '#define USE_FOG' : '',\r\n\t\t\t\t( parameters.useFog && parameters.fogExp ) ? '#define FOG_EXP2' : '',\r\n\r\n\t\t\t\tparameters.map ? '#define USE_MAP' : '',\r\n\t\t\t\tparameters.envMap ? '#define USE_ENVMAP' : '',\r\n\t\t\t\tparameters.envMap ? '#define ' + envMapModeDefine : '',\r\n\t\t\t\tparameters.lightMap ? '#define USE_LIGHTMAP' : '',\r\n\t\t\t\tparameters.aoMap ? '#define USE_AOMAP' : '',\r\n\t\t\t\tparameters.emissiveMap ? '#define USE_EMISSIVEMAP' : '',\r\n\t\t\t\tparameters.bumpMap ? '#define USE_BUMPMAP' : '',\r\n\t\t\t\tparameters.normalMap ? '#define USE_NORMALMAP' : '',\r\n\t\t\t\t( parameters.normalMap && parameters.objectSpaceNormalMap ) ? '#define OBJECTSPACE_NORMALMAP' : '',\r\n\t\t\t\tparameters.displacementMap && parameters.supportsVertexTextures ? '#define USE_DISPLACEMENTMAP' : '',\r\n\t\t\t\tparameters.specularMap ? '#define USE_SPECULARMAP' : '',\r\n\t\t\t\tparameters.roughnessMap ? '#define USE_ROUGHNESSMAP' : '',\r\n\t\t\t\tparameters.metalnessMap ? '#define USE_METALNESSMAP' : '',\r\n\t\t\t\tparameters.alphaMap ? '#define USE_ALPHAMAP' : '',\r\n\t\t\t\tparameters.vertexColors ? '#define USE_COLOR' : '',\r\n\r\n\t\t\t\tparameters.flatShading ? '#define FLAT_SHADED' : '',\r\n\r\n\t\t\t\tparameters.skinning ? '#define USE_SKINNING' : '',\r\n\t\t\t\tparameters.useVertexTexture ? '#define BONE_TEXTURE' : '',\r\n\r\n\t\t\t\tparameters.morphTargets ? '#define USE_MORPHTARGETS' : '',\r\n\t\t\t\tparameters.morphNormals && parameters.flatShading === false ? '#define USE_MORPHNORMALS' : '',\r\n\t\t\t\tparameters.doubleSided ? '#define DOUBLE_SIDED' : '',\r\n\t\t\t\tparameters.flipSided ? '#define FLIP_SIDED' : '',\r\n\r\n\t\t\t\tparameters.shadowMapEnabled ? '#define USE_SHADOWMAP' : '',\r\n\t\t\t\tparameters.shadowMapEnabled ? '#define ' + shadowMapTypeDefine : '',\r\n\r\n\t\t\t\tparameters.sizeAttenuation ? '#define USE_SIZEATTENUATION' : '',\r\n\r\n\t\t\t\tparameters.logarithmicDepthBuffer ? '#define USE_LOGDEPTHBUF' : '',\r\n\t\t\t\tparameters.logarithmicDepthBuffer && ( capabilities.isWebGL2 || extensions.get( 'EXT_frag_depth' ) ) ? '#define USE_LOGDEPTHBUF_EXT' : '',\r\n\r\n\t\t\t\t'uniform mat4 modelMatrix;',\r\n\t\t\t\t'uniform mat4 modelViewMatrix;',\r\n\t\t\t\t'uniform mat4 projectionMatrix;',\r\n\t\t\t\t'uniform mat4 viewMatrix;',\r\n\t\t\t\t'uniform mat3 normalMatrix;',\r\n\t\t\t\t'uniform vec3 cameraPosition;',\r\n\r\n\t\t\t\t'attribute vec3 position;',\r\n\t\t\t\t'attribute vec3 normal;',\r\n\t\t\t\t'attribute vec2 uv;',\r\n\r\n\t\t\t\t'#ifdef USE_COLOR',\r\n\r\n\t\t\t\t'\tattribute vec3 color;',\r\n\r\n\t\t\t\t'#endif',\r\n\r\n\t\t\t\t'#ifdef USE_MORPHTARGETS',\r\n\r\n\t\t\t\t'\tattribute vec3 morphTarget0;',\r\n\t\t\t\t'\tattribute vec3 morphTarget1;',\r\n\t\t\t\t'\tattribute vec3 morphTarget2;',\r\n\t\t\t\t'\tattribute vec3 morphTarget3;',\r\n\r\n\t\t\t\t'\t#ifdef USE_MORPHNORMALS',\r\n\r\n\t\t\t\t'\t\tattribute vec3 morphNormal0;',\r\n\t\t\t\t'\t\tattribute vec3 morphNormal1;',\r\n\t\t\t\t'\t\tattribute vec3 morphNormal2;',\r\n\t\t\t\t'\t\tattribute vec3 morphNormal3;',\r\n\r\n\t\t\t\t'\t#else',\r\n\r\n\t\t\t\t'\t\tattribute vec3 morphTarget4;',\r\n\t\t\t\t'\t\tattribute vec3 morphTarget5;',\r\n\t\t\t\t'\t\tattribute vec3 morphTarget6;',\r\n\t\t\t\t'\t\tattribute vec3 morphTarget7;',\r\n\r\n\t\t\t\t'\t#endif',\r\n\r\n\t\t\t\t'#endif',\r\n\r\n\t\t\t\t'#ifdef USE_SKINNING',\r\n\r\n\t\t\t\t'\tattribute vec4 skinIndex;',\r\n\t\t\t\t'\tattribute vec4 skinWeight;',\r\n\r\n\t\t\t\t'#endif',\r\n\r\n\t\t\t\t'\\n'\r\n\r\n\t\t\t].filter( filterEmptyLine ).join( '\\n' );\r\n\r\n\t\t\tprefixFragment = [\r\n\r\n\t\t\t\tcustomExtensions,\r\n\r\n\t\t\t\t'precision ' + parameters.precision + ' float;',\r\n\t\t\t\t'precision ' + parameters.precision + ' int;',\r\n\r\n\t\t\t\t'#define SHADER_NAME ' + shader.name,\r\n\r\n\t\t\t\tcustomDefines,\r\n\r\n\t\t\t\tparameters.alphaTest ? '#define ALPHATEST ' + parameters.alphaTest + ( parameters.alphaTest % 1 ? '' : '.0' ) : '', // add '.0' if integer\r\n\r\n\t\t\t\t'#define GAMMA_FACTOR ' + gammaFactorDefine,\r\n\r\n\t\t\t\t( parameters.useFog && parameters.fog ) ? '#define USE_FOG' : '',\r\n\t\t\t\t( parameters.useFog && parameters.fogExp ) ? '#define FOG_EXP2' : '',\r\n\r\n\t\t\t\tparameters.map ? '#define USE_MAP' : '',\r\n\t\t\t\tparameters.envMap ? '#define USE_ENVMAP' : '',\r\n\t\t\t\tparameters.envMap ? '#define ' + envMapTypeDefine : '',\r\n\t\t\t\tparameters.envMap ? '#define ' + envMapModeDefine : '',\r\n\t\t\t\tparameters.envMap ? '#define ' + envMapBlendingDefine : '',\r\n\t\t\t\tparameters.lightMap ? '#define USE_LIGHTMAP' : '',\r\n\t\t\t\tparameters.aoMap ? '#define USE_AOMAP' : '',\r\n\t\t\t\tparameters.emissiveMap ? '#define USE_EMISSIVEMAP' : '',\r\n\t\t\t\tparameters.bumpMap ? '#define USE_BUMPMAP' : '',\r\n\t\t\t\tparameters.normalMap ? '#define USE_NORMALMAP' : '',\r\n\t\t\t\t( parameters.normalMap && parameters.objectSpaceNormalMap ) ? '#define OBJECTSPACE_NORMALMAP' : '',\r\n\t\t\t\tparameters.specularMap ? '#define USE_SPECULARMAP' : '',\r\n\t\t\t\tparameters.roughnessMap ? '#define USE_ROUGHNESSMAP' : '',\r\n\t\t\t\tparameters.metalnessMap ? '#define USE_METALNESSMAP' : '',\r\n\t\t\t\tparameters.alphaMap ? '#define USE_ALPHAMAP' : '',\r\n\t\t\t\tparameters.vertexColors ? '#define USE_COLOR' : '',\r\n\r\n\t\t\t\tparameters.gradientMap ? '#define USE_GRADIENTMAP' : '',\r\n\r\n\t\t\t\tparameters.flatShading ? '#define FLAT_SHADED' : '',\r\n\r\n\t\t\t\tparameters.doubleSided ? '#define DOUBLE_SIDED' : '',\r\n\t\t\t\tparameters.flipSided ? '#define FLIP_SIDED' : '',\r\n\r\n\t\t\t\tparameters.shadowMapEnabled ? '#define USE_SHADOWMAP' : '',\r\n\t\t\t\tparameters.shadowMapEnabled ? '#define ' + shadowMapTypeDefine : '',\r\n\r\n\t\t\t\tparameters.premultipliedAlpha ? '#define PREMULTIPLIED_ALPHA' : '',\r\n\r\n\t\t\t\tparameters.physicallyCorrectLights ? '#define PHYSICALLY_CORRECT_LIGHTS' : '',\r\n\r\n\t\t\t\tparameters.logarithmicDepthBuffer ? '#define USE_LOGDEPTHBUF' : '',\r\n\t\t\t\tparameters.logarithmicDepthBuffer && ( capabilities.isWebGL2 || extensions.get( 'EXT_frag_depth' ) ) ? '#define USE_LOGDEPTHBUF_EXT' : '',\r\n\r\n\t\t\t\tparameters.envMap && ( capabilities.isWebGL2 || extensions.get( 'EXT_shader_texture_lod' ) ) ? '#define TEXTURE_LOD_EXT' : '',\r\n\r\n\t\t\t\t'uniform mat4 viewMatrix;',\r\n\t\t\t\t'uniform vec3 cameraPosition;',\r\n\r\n\t\t\t\t( parameters.toneMapping !== NoToneMapping ) ? '#define TONE_MAPPING' : '',\r\n\t\t\t\t( parameters.toneMapping !== NoToneMapping ) ? ShaderChunk[ 'tonemapping_pars_fragment' ] : '', // this code is required here because it is used by the toneMapping() function defined below\r\n\t\t\t\t( parameters.toneMapping !== NoToneMapping ) ? getToneMappingFunction( 'toneMapping', parameters.toneMapping ) : '',\r\n\r\n\t\t\t\tparameters.dithering ? '#define DITHERING' : '',\r\n\r\n\t\t\t\t( parameters.outputEncoding || parameters.mapEncoding || parameters.envMapEncoding || parameters.emissiveMapEncoding ) ? ShaderChunk[ 'encodings_pars_fragment' ] : '', // this code is required here because it is used by the various encoding/decoding function defined below\r\n\t\t\t\tparameters.mapEncoding ? getTexelDecodingFunction( 'mapTexelToLinear', parameters.mapEncoding ) : '',\r\n\t\t\t\tparameters.envMapEncoding ? getTexelDecodingFunction( 'envMapTexelToLinear', parameters.envMapEncoding ) : '',\r\n\t\t\t\tparameters.emissiveMapEncoding ? getTexelDecodingFunction( 'emissiveMapTexelToLinear', parameters.emissiveMapEncoding ) : '',\r\n\t\t\t\tparameters.outputEncoding ? getTexelEncodingFunction( 'linearToOutputTexel', parameters.outputEncoding ) : '',\r\n\r\n\t\t\t\tparameters.depthPacking ? '#define DEPTH_PACKING ' + material.depthPacking : '',\r\n\r\n\t\t\t\t'\\n'\r\n\r\n\t\t\t].filter( filterEmptyLine ).join( '\\n' );\r\n\r\n\t\t}\r\n\r\n\t\tvertexShader = parseIncludes( vertexShader );\r\n\t\tvertexShader = replaceLightNums( vertexShader, parameters );\r\n\t\tvertexShader = replaceClippingPlaneNums( vertexShader, parameters );\r\n\r\n\t\tfragmentShader = parseIncludes( fragmentShader );\r\n\t\tfragmentShader = replaceLightNums( fragmentShader, parameters );\r\n\t\tfragmentShader = replaceClippingPlaneNums( fragmentShader, parameters );\r\n\r\n\t\tvertexShader = unrollLoops( vertexShader );\r\n\t\tfragmentShader = unrollLoops( fragmentShader );\r\n\r\n\t\tif ( capabilities.isWebGL2 && ! material.isRawShaderMaterial ) {\r\n\r\n\t\t\tvar isGLSL3ShaderMaterial = false;\r\n\r\n\t\t\tvar versionRegex = /^\\s*#version\\s+300\\s+es\\s*\\n/;\r\n\r\n\t\t\tif ( material.isShaderMaterial &&\r\n\t\t\t\tvertexShader.match( versionRegex ) !== null &&\r\n\t\t\t\tfragmentShader.match( versionRegex ) !== null ) {\r\n\r\n\t\t\t\tisGLSL3ShaderMaterial = true;\r\n\r\n\t\t\t\tvertexShader = vertexShader.replace( versionRegex, '' );\r\n\t\t\t\tfragmentShader = fragmentShader.replace( versionRegex, '' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// GLSL 3.0 conversion\r\n\t\t\tprefixVertex = [\r\n\t\t\t\t'#version 300 es\\n',\r\n\t\t\t\t'#define attribute in',\r\n\t\t\t\t'#define varying out',\r\n\t\t\t\t'#define texture2D texture'\r\n\t\t\t].join( '\\n' ) + '\\n' + prefixVertex;\r\n\r\n\t\t\tprefixFragment = [\r\n\t\t\t\t'#version 300 es\\n',\r\n\t\t\t\t'#define varying in',\r\n\t\t\t\tisGLSL3ShaderMaterial ? '' : 'out highp vec4 pc_fragColor;',\r\n\t\t\t\tisGLSL3ShaderMaterial ? '' : '#define gl_FragColor pc_fragColor',\r\n\t\t\t\t'#define gl_FragDepthEXT gl_FragDepth',\r\n\t\t\t\t'#define texture2D texture',\r\n\t\t\t\t'#define textureCube texture',\r\n\t\t\t\t'#define texture2DProj textureProj',\r\n\t\t\t\t'#define texture2DLodEXT textureLod',\r\n\t\t\t\t'#define texture2DProjLodEXT textureProjLod',\r\n\t\t\t\t'#define textureCubeLodEXT textureLod',\r\n\t\t\t\t'#define texture2DGradEXT textureGrad',\r\n\t\t\t\t'#define texture2DProjGradEXT textureProjGrad',\r\n\t\t\t\t'#define textureCubeGradEXT textureGrad'\r\n\t\t\t].join( '\\n' ) + '\\n' + prefixFragment;\r\n\r\n\t\t}\r\n\r\n\t\tvar vertexGlsl = prefixVertex + vertexShader;\r\n\t\tvar fragmentGlsl = prefixFragment + fragmentShader;\r\n\r\n\t\t// console.log( '*VERTEX*', vertexGlsl );\r\n\t\t// console.log( '*FRAGMENT*', fragmentGlsl );\r\n\r\n\t\tvar glVertexShader = WebGLShader( gl, gl.VERTEX_SHADER, vertexGlsl );\r\n\t\tvar glFragmentShader = WebGLShader( gl, gl.FRAGMENT_SHADER, fragmentGlsl );\r\n\r\n\t\tgl.attachShader( program, glVertexShader );\r\n\t\tgl.attachShader( program, glFragmentShader );\r\n\r\n\t\t// Force a particular attribute to index 0.\r\n\r\n\t\tif ( material.index0AttributeName !== undefined ) {\r\n\r\n\t\t\tgl.bindAttribLocation( program, 0, material.index0AttributeName );\r\n\r\n\t\t} else if ( parameters.morphTargets === true ) {\r\n\r\n\t\t\t// programs with morphTargets displace position out of attribute 0\r\n\t\t\tgl.bindAttribLocation( program, 0, 'position' );\r\n\r\n\t\t}\r\n\r\n\t\tgl.linkProgram( program );\r\n\r\n\t\tvar programLog = gl.getProgramInfoLog( program ).trim();\r\n\t\tvar vertexLog = gl.getShaderInfoLog( glVertexShader ).trim();\r\n\t\tvar fragmentLog = gl.getShaderInfoLog( glFragmentShader ).trim();\r\n\r\n\t\tvar runnable = true;\r\n\t\tvar haveDiagnostics = true;\r\n\r\n\t\t// console.log( '**VERTEX**', gl.getExtension( 'WEBGL_debug_shaders' ).getTranslatedShaderSource( glVertexShader ) );\r\n\t\t// console.log( '**FRAGMENT**', gl.getExtension( 'WEBGL_debug_shaders' ).getTranslatedShaderSource( glFragmentShader ) );\r\n\r\n\t\tif ( gl.getProgramParameter( program, gl.LINK_STATUS ) === false ) {\r\n\r\n\t\t\trunnable = false;\r\n\r\n\t\t\tconsole.error( 'THREE.WebGLProgram: shader error: ', gl.getError(), 'gl.VALIDATE_STATUS', gl.getProgramParameter( program, gl.VALIDATE_STATUS ), 'gl.getProgramInfoLog', programLog, vertexLog, fragmentLog );\r\n\r\n\t\t} else if ( programLog !== '' ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLProgram: gl.getProgramInfoLog()', programLog );\r\n\r\n\t\t} else if ( vertexLog === '' || fragmentLog === '' ) {\r\n\r\n\t\t\thaveDiagnostics = false;\r\n\r\n\t\t}\r\n\r\n\t\tif ( haveDiagnostics ) {\r\n\r\n\t\t\tthis.diagnostics = {\r\n\r\n\t\t\t\trunnable: runnable,\r\n\t\t\t\tmaterial: material,\r\n\r\n\t\t\t\tprogramLog: programLog,\r\n\r\n\t\t\t\tvertexShader: {\r\n\r\n\t\t\t\t\tlog: vertexLog,\r\n\t\t\t\t\tprefix: prefixVertex\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tfragmentShader: {\r\n\r\n\t\t\t\t\tlog: fragmentLog,\r\n\t\t\t\t\tprefix: prefixFragment\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t\t// clean up\r\n\r\n\t\tgl.deleteShader( glVertexShader );\r\n\t\tgl.deleteShader( glFragmentShader );\r\n\r\n\t\t// set up caching for uniform locations\r\n\r\n\t\tvar cachedUniforms;\r\n\r\n\t\tthis.getUniforms = function () {\r\n\r\n\t\t\tif ( cachedUniforms === undefined ) {\r\n\r\n\t\t\t\tcachedUniforms = new WebGLUniforms( gl, program, renderer );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn cachedUniforms;\r\n\r\n\t\t};\r\n\r\n\t\t// set up caching for attribute locations\r\n\r\n\t\tvar cachedAttributes;\r\n\r\n\t\tthis.getAttributes = function () {\r\n\r\n\t\t\tif ( cachedAttributes === undefined ) {\r\n\r\n\t\t\t\tcachedAttributes = fetchAttributeLocations( gl, program );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn cachedAttributes;\r\n\r\n\t\t};\r\n\r\n\t\t// free resource\r\n\r\n\t\tthis.destroy = function () {\r\n\r\n\t\t\tgl.deleteProgram( program );\r\n\t\t\tthis.program = undefined;\r\n\r\n\t\t};\r\n\r\n\t\t// DEPRECATED\r\n\r\n\t\tObject.defineProperties( this, {\r\n\r\n\t\t\tuniforms: {\r\n\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLProgram: .uniforms is now .getUniforms().' );\r\n\t\t\t\t\treturn this.getUniforms();\r\n\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tattributes: {\r\n\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLProgram: .attributes is now .getAttributes().' );\r\n\t\t\t\t\treturn this.getAttributes();\r\n\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t} );\r\n\r\n\r\n\t\t//\r\n\r\n\t\tthis.name = shader.name;\r\n\t\tthis.id = programIdCount ++;\r\n\t\tthis.code = code;\r\n\t\tthis.usedTimes = 1;\r\n\t\tthis.program = program;\r\n\t\tthis.vertexShader = glVertexShader;\r\n\t\tthis.fragmentShader = glFragmentShader;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction WebGLPrograms( renderer, extensions, capabilities ) {\r\n\r\n\t\tvar programs = [];\r\n\r\n\t\tvar shaderIDs = {\r\n\t\t\tMeshDepthMaterial: 'depth',\r\n\t\t\tMeshDistanceMaterial: 'distanceRGBA',\r\n\t\t\tMeshNormalMaterial: 'normal',\r\n\t\t\tMeshBasicMaterial: 'basic',\r\n\t\t\tMeshLambertMaterial: 'lambert',\r\n\t\t\tMeshPhongMaterial: 'phong',\r\n\t\t\tMeshToonMaterial: 'phong',\r\n\t\t\tMeshStandardMaterial: 'physical',\r\n\t\t\tMeshPhysicalMaterial: 'physical',\r\n\t\t\tLineBasicMaterial: 'basic',\r\n\t\t\tLineDashedMaterial: 'dashed',\r\n\t\t\tPointsMaterial: 'points',\r\n\t\t\tShadowMaterial: 'shadow',\r\n\t\t\tSpriteMaterial: 'sprite'\r\n\t\t};\r\n\r\n\t\tvar parameterNames = [\r\n\t\t\t\"precision\", \"supportsVertexTextures\", \"map\", \"mapEncoding\", \"envMap\", \"envMapMode\", \"envMapEncoding\",\r\n\t\t\t\"lightMap\", \"aoMap\", \"emissiveMap\", \"emissiveMapEncoding\", \"bumpMap\", \"normalMap\", \"objectSpaceNormalMap\", \"displacementMap\", \"specularMap\",\r\n\t\t\t\"roughnessMap\", \"metalnessMap\", \"gradientMap\",\r\n\t\t\t\"alphaMap\", \"combine\", \"vertexColors\", \"fog\", \"useFog\", \"fogExp\",\r\n\t\t\t\"flatShading\", \"sizeAttenuation\", \"logarithmicDepthBuffer\", \"skinning\",\r\n\t\t\t\"maxBones\", \"useVertexTexture\", \"morphTargets\", \"morphNormals\",\r\n\t\t\t\"maxMorphTargets\", \"maxMorphNormals\", \"premultipliedAlpha\",\r\n\t\t\t\"numDirLights\", \"numPointLights\", \"numSpotLights\", \"numHemiLights\", \"numRectAreaLights\",\r\n\t\t\t\"shadowMapEnabled\", \"shadowMapType\", \"toneMapping\", 'physicallyCorrectLights',\r\n\t\t\t\"alphaTest\", \"doubleSided\", \"flipSided\", \"numClippingPlanes\", \"numClipIntersection\", \"depthPacking\", \"dithering\"\r\n\t\t];\r\n\r\n\r\n\t\tfunction allocateBones( object ) {\r\n\r\n\t\t\tvar skeleton = object.skeleton;\r\n\t\t\tvar bones = skeleton.bones;\r\n\r\n\t\t\tif ( capabilities.floatVertexTextures ) {\r\n\r\n\t\t\t\treturn 1024;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// default for when object is not specified\r\n\t\t\t\t// ( for example when prebuilding shader to be used with multiple objects )\r\n\t\t\t\t//\r\n\t\t\t\t//  - leave some extra space for other uniforms\r\n\t\t\t\t//  - limit here is ANGLE's 254 max uniform vectors\r\n\t\t\t\t//    (up to 54 should be safe)\r\n\r\n\t\t\t\tvar nVertexUniforms = capabilities.maxVertexUniforms;\r\n\t\t\t\tvar nVertexMatrices = Math.floor( ( nVertexUniforms - 20 ) / 4 );\r\n\r\n\t\t\t\tvar maxBones = Math.min( nVertexMatrices, bones.length );\r\n\r\n\t\t\t\tif ( maxBones < bones.length ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Skeleton has ' + bones.length + ' bones. This GPU supports ' + maxBones + '.' );\r\n\t\t\t\t\treturn 0;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn maxBones;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction getTextureEncodingFromMap( map, gammaOverrideLinear ) {\r\n\r\n\t\t\tvar encoding;\r\n\r\n\t\t\tif ( ! map ) {\r\n\r\n\t\t\t\tencoding = LinearEncoding;\r\n\r\n\t\t\t} else if ( map.isTexture ) {\r\n\r\n\t\t\t\tencoding = map.encoding;\r\n\r\n\t\t\t} else if ( map.isWebGLRenderTarget ) {\r\n\r\n\t\t\t\tconsole.warn( \"THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead.\" );\r\n\t\t\t\tencoding = map.texture.encoding;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// add backwards compatibility for WebGLRenderer.gammaInput/gammaOutput parameter, should probably be removed at some point.\r\n\t\t\tif ( encoding === LinearEncoding && gammaOverrideLinear ) {\r\n\r\n\t\t\t\tencoding = GammaEncoding;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn encoding;\r\n\r\n\t\t}\r\n\r\n\t\tthis.getParameters = function ( material, lights, shadows, fog, nClipPlanes, nClipIntersection, object ) {\r\n\r\n\t\t\tvar shaderID = shaderIDs[ material.type ];\r\n\r\n\t\t\t// heuristics to create shader parameters according to lights in the scene\r\n\t\t\t// (not to blow over maxLights budget)\r\n\r\n\t\t\tvar maxBones = object.isSkinnedMesh ? allocateBones( object ) : 0;\r\n\t\t\tvar precision = capabilities.precision;\r\n\r\n\t\t\tif ( material.precision !== null ) {\r\n\r\n\t\t\t\tprecision = capabilities.getMaxPrecision( material.precision );\r\n\r\n\t\t\t\tif ( precision !== material.precision ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLProgram.getParameters:', material.precision, 'not supported, using', precision, 'instead.' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar currentRenderTarget = renderer.getRenderTarget();\r\n\r\n\t\t\tvar parameters = {\r\n\r\n\t\t\t\tshaderID: shaderID,\r\n\r\n\t\t\t\tprecision: precision,\r\n\t\t\t\tsupportsVertexTextures: capabilities.vertexTextures,\r\n\t\t\t\toutputEncoding: getTextureEncodingFromMap( ( ! currentRenderTarget ) ? null : currentRenderTarget.texture, renderer.gammaOutput ),\r\n\t\t\t\tmap: !! material.map,\r\n\t\t\t\tmapEncoding: getTextureEncodingFromMap( material.map, renderer.gammaInput ),\r\n\t\t\t\tenvMap: !! material.envMap,\r\n\t\t\t\tenvMapMode: material.envMap && material.envMap.mapping,\r\n\t\t\t\tenvMapEncoding: getTextureEncodingFromMap( material.envMap, renderer.gammaInput ),\r\n\t\t\t\tenvMapCubeUV: ( !! material.envMap ) && ( ( material.envMap.mapping === CubeUVReflectionMapping ) || ( material.envMap.mapping === CubeUVRefractionMapping ) ),\r\n\t\t\t\tlightMap: !! material.lightMap,\r\n\t\t\t\taoMap: !! material.aoMap,\r\n\t\t\t\temissiveMap: !! material.emissiveMap,\r\n\t\t\t\temissiveMapEncoding: getTextureEncodingFromMap( material.emissiveMap, renderer.gammaInput ),\r\n\t\t\t\tbumpMap: !! material.bumpMap,\r\n\t\t\t\tnormalMap: !! material.normalMap,\r\n\t\t\t\tobjectSpaceNormalMap: material.normalMapType === ObjectSpaceNormalMap,\r\n\t\t\t\tdisplacementMap: !! material.displacementMap,\r\n\t\t\t\troughnessMap: !! material.roughnessMap,\r\n\t\t\t\tmetalnessMap: !! material.metalnessMap,\r\n\t\t\t\tspecularMap: !! material.specularMap,\r\n\t\t\t\talphaMap: !! material.alphaMap,\r\n\r\n\t\t\t\tgradientMap: !! material.gradientMap,\r\n\r\n\t\t\t\tcombine: material.combine,\r\n\r\n\t\t\t\tvertexColors: material.vertexColors,\r\n\r\n\t\t\t\tfog: !! fog,\r\n\t\t\t\tuseFog: material.fog,\r\n\t\t\t\tfogExp: ( fog && fog.isFogExp2 ),\r\n\r\n\t\t\t\tflatShading: material.flatShading,\r\n\r\n\t\t\t\tsizeAttenuation: material.sizeAttenuation,\r\n\t\t\t\tlogarithmicDepthBuffer: capabilities.logarithmicDepthBuffer,\r\n\r\n\t\t\t\tskinning: material.skinning && maxBones > 0,\r\n\t\t\t\tmaxBones: maxBones,\r\n\t\t\t\tuseVertexTexture: capabilities.floatVertexTextures,\r\n\r\n\t\t\t\tmorphTargets: material.morphTargets,\r\n\t\t\t\tmorphNormals: material.morphNormals,\r\n\t\t\t\tmaxMorphTargets: renderer.maxMorphTargets,\r\n\t\t\t\tmaxMorphNormals: renderer.maxMorphNormals,\r\n\r\n\t\t\t\tnumDirLights: lights.directional.length,\r\n\t\t\t\tnumPointLights: lights.point.length,\r\n\t\t\t\tnumSpotLights: lights.spot.length,\r\n\t\t\t\tnumRectAreaLights: lights.rectArea.length,\r\n\t\t\t\tnumHemiLights: lights.hemi.length,\r\n\r\n\t\t\t\tnumClippingPlanes: nClipPlanes,\r\n\t\t\t\tnumClipIntersection: nClipIntersection,\r\n\r\n\t\t\t\tdithering: material.dithering,\r\n\r\n\t\t\t\tshadowMapEnabled: renderer.shadowMap.enabled && object.receiveShadow && shadows.length > 0,\r\n\t\t\t\tshadowMapType: renderer.shadowMap.type,\r\n\r\n\t\t\t\ttoneMapping: renderer.toneMapping,\r\n\t\t\t\tphysicallyCorrectLights: renderer.physicallyCorrectLights,\r\n\r\n\t\t\t\tpremultipliedAlpha: material.premultipliedAlpha,\r\n\r\n\t\t\t\talphaTest: material.alphaTest,\r\n\t\t\t\tdoubleSided: material.side === DoubleSide,\r\n\t\t\t\tflipSided: material.side === BackSide,\r\n\r\n\t\t\t\tdepthPacking: ( material.depthPacking !== undefined ) ? material.depthPacking : false\r\n\r\n\t\t\t};\r\n\r\n\t\t\treturn parameters;\r\n\r\n\t\t};\r\n\r\n\t\tthis.getProgramCode = function ( material, parameters ) {\r\n\r\n\t\t\tvar array = [];\r\n\r\n\t\t\tif ( parameters.shaderID ) {\r\n\r\n\t\t\t\tarray.push( parameters.shaderID );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tarray.push( material.fragmentShader );\r\n\t\t\t\tarray.push( material.vertexShader );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.defines !== undefined ) {\r\n\r\n\t\t\t\tfor ( var name in material.defines ) {\r\n\r\n\t\t\t\t\tarray.push( name );\r\n\t\t\t\t\tarray.push( material.defines[ name ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var i = 0; i < parameterNames.length; i ++ ) {\r\n\r\n\t\t\t\tarray.push( parameters[ parameterNames[ i ] ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tarray.push( material.onBeforeCompile.toString() );\r\n\r\n\t\t\tarray.push( renderer.gammaOutput );\r\n\r\n\t\t\treturn array.join();\r\n\r\n\t\t};\r\n\r\n\t\tthis.acquireProgram = function ( material, shader, parameters, code ) {\r\n\r\n\t\t\tvar program;\r\n\r\n\t\t\t// Check if code has been already compiled\r\n\t\t\tfor ( var p = 0, pl = programs.length; p < pl; p ++ ) {\r\n\r\n\t\t\t\tvar programInfo = programs[ p ];\r\n\r\n\t\t\t\tif ( programInfo.code === code ) {\r\n\r\n\t\t\t\t\tprogram = programInfo;\r\n\t\t\t\t\t++ program.usedTimes;\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( program === undefined ) {\r\n\r\n\t\t\t\tprogram = new WebGLProgram( renderer, extensions, code, material, shader, parameters, capabilities );\r\n\t\t\t\tprograms.push( program );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn program;\r\n\r\n\t\t};\r\n\r\n\t\tthis.releaseProgram = function ( program ) {\r\n\r\n\t\t\tif ( -- program.usedTimes === 0 ) {\r\n\r\n\t\t\t\t// Remove from unordered set\r\n\t\t\t\tvar i = programs.indexOf( program );\r\n\t\t\t\tprograms[ i ] = programs[ programs.length - 1 ];\r\n\t\t\t\tprograms.pop();\r\n\r\n\t\t\t\t// Free WebGL resources\r\n\t\t\t\tprogram.destroy();\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t\t// Exposed for resource monitoring & error feedback via renderer.info:\r\n\t\tthis.programs = programs;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author fordacious / fordacious.github.io\r\n\t */\r\n\r\n\tfunction WebGLProperties() {\r\n\r\n\t\tvar properties = new WeakMap();\r\n\r\n\t\tfunction get( object ) {\r\n\r\n\t\t\tvar map = properties.get( object );\r\n\r\n\t\t\tif ( map === undefined ) {\r\n\r\n\t\t\t\tmap = {};\r\n\t\t\t\tproperties.set( object, map );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn map;\r\n\r\n\t\t}\r\n\r\n\t\tfunction remove( object ) {\r\n\r\n\t\t\tproperties.delete( object );\r\n\r\n\t\t}\r\n\r\n\t\tfunction update( object, key, value ) {\r\n\r\n\t\t\tproperties.get( object )[ key ] = value;\r\n\r\n\t\t}\r\n\r\n\t\tfunction dispose() {\r\n\r\n\t\t\tproperties = new WeakMap();\r\n\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tget: get,\r\n\t\t\tremove: remove,\r\n\t\t\tupdate: update,\r\n\t\t\tdispose: dispose\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction painterSortStable( a, b ) {\r\n\r\n\t\tif ( a.renderOrder !== b.renderOrder ) {\r\n\r\n\t\t\treturn a.renderOrder - b.renderOrder;\r\n\r\n\t\t} else if ( a.program && b.program && a.program !== b.program ) {\r\n\r\n\t\t\treturn a.program.id - b.program.id;\r\n\r\n\t\t} else if ( a.material.id !== b.material.id ) {\r\n\r\n\t\t\treturn a.material.id - b.material.id;\r\n\r\n\t\t} else if ( a.z !== b.z ) {\r\n\r\n\t\t\treturn a.z - b.z;\r\n\r\n\t\t} else {\r\n\r\n\t\t\treturn a.id - b.id;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction reversePainterSortStable( a, b ) {\r\n\r\n\t\tif ( a.renderOrder !== b.renderOrder ) {\r\n\r\n\t\t\treturn a.renderOrder - b.renderOrder;\r\n\r\n\t\t} if ( a.z !== b.z ) {\r\n\r\n\t\t\treturn b.z - a.z;\r\n\r\n\t\t} else {\r\n\r\n\t\t\treturn a.id - b.id;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\tfunction WebGLRenderList() {\r\n\r\n\t\tvar renderItems = [];\r\n\t\tvar renderItemsIndex = 0;\r\n\r\n\t\tvar opaque = [];\r\n\t\tvar transparent = [];\r\n\r\n\t\tfunction init() {\r\n\r\n\t\t\trenderItemsIndex = 0;\r\n\r\n\t\t\topaque.length = 0;\r\n\t\t\ttransparent.length = 0;\r\n\r\n\t\t}\r\n\r\n\t\tfunction push( object, geometry, material, z, group ) {\r\n\r\n\t\t\tvar renderItem = renderItems[ renderItemsIndex ];\r\n\r\n\t\t\tif ( renderItem === undefined ) {\r\n\r\n\t\t\t\trenderItem = {\r\n\t\t\t\t\tid: object.id,\r\n\t\t\t\t\tobject: object,\r\n\t\t\t\t\tgeometry: geometry,\r\n\t\t\t\t\tmaterial: material,\r\n\t\t\t\t\tprogram: material.program,\r\n\t\t\t\t\trenderOrder: object.renderOrder,\r\n\t\t\t\t\tz: z,\r\n\t\t\t\t\tgroup: group\r\n\t\t\t\t};\r\n\r\n\t\t\t\trenderItems[ renderItemsIndex ] = renderItem;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\trenderItem.id = object.id;\r\n\t\t\t\trenderItem.object = object;\r\n\t\t\t\trenderItem.geometry = geometry;\r\n\t\t\t\trenderItem.material = material;\r\n\t\t\t\trenderItem.program = material.program;\r\n\t\t\t\trenderItem.renderOrder = object.renderOrder;\r\n\t\t\t\trenderItem.z = z;\r\n\t\t\t\trenderItem.group = group;\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\t( material.transparent === true ? transparent : opaque ).push( renderItem );\r\n\r\n\t\t\trenderItemsIndex ++;\r\n\r\n\t\t}\r\n\r\n\t\tfunction sort() {\r\n\r\n\t\t\tif ( opaque.length > 1 ) opaque.sort( painterSortStable );\r\n\t\t\tif ( transparent.length > 1 ) transparent.sort( reversePainterSortStable );\r\n\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\topaque: opaque,\r\n\t\t\ttransparent: transparent,\r\n\r\n\t\t\tinit: init,\r\n\t\t\tpush: push,\r\n\r\n\t\t\tsort: sort\r\n\t\t};\r\n\r\n\t}\r\n\r\n\tfunction WebGLRenderLists() {\r\n\r\n\t\tvar lists = {};\r\n\r\n\t\tfunction get( scene, camera ) {\r\n\r\n\t\t\tvar hash = scene.id + ',' + camera.id;\r\n\t\t\tvar list = lists[ hash ];\r\n\r\n\t\t\tif ( list === undefined ) {\r\n\r\n\t\t\t\t// console.log( 'THREE.WebGLRenderLists:', hash );\r\n\r\n\t\t\t\tlist = new WebGLRenderList();\r\n\t\t\t\tlists[ hash ] = list;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn list;\r\n\r\n\t\t}\r\n\r\n\t\tfunction dispose() {\r\n\r\n\t\t\tlists = {};\r\n\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tget: get,\r\n\t\t\tdispose: dispose\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction UniformsCache() {\r\n\r\n\t\tvar lights = {};\r\n\r\n\t\treturn {\r\n\r\n\t\t\tget: function ( light ) {\r\n\r\n\t\t\t\tif ( lights[ light.id ] !== undefined ) {\r\n\r\n\t\t\t\t\treturn lights[ light.id ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar uniforms;\r\n\r\n\t\t\t\tswitch ( light.type ) {\r\n\r\n\t\t\t\t\tcase 'DirectionalLight':\r\n\t\t\t\t\t\tuniforms = {\r\n\t\t\t\t\t\t\tdirection: new Vector3(),\r\n\t\t\t\t\t\t\tcolor: new Color(),\r\n\r\n\t\t\t\t\t\t\tshadow: false,\r\n\t\t\t\t\t\t\tshadowBias: 0,\r\n\t\t\t\t\t\t\tshadowRadius: 1,\r\n\t\t\t\t\t\t\tshadowMapSize: new Vector2()\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'SpotLight':\r\n\t\t\t\t\t\tuniforms = {\r\n\t\t\t\t\t\t\tposition: new Vector3(),\r\n\t\t\t\t\t\t\tdirection: new Vector3(),\r\n\t\t\t\t\t\t\tcolor: new Color(),\r\n\t\t\t\t\t\t\tdistance: 0,\r\n\t\t\t\t\t\t\tconeCos: 0,\r\n\t\t\t\t\t\t\tpenumbraCos: 0,\r\n\t\t\t\t\t\t\tdecay: 0,\r\n\r\n\t\t\t\t\t\t\tshadow: false,\r\n\t\t\t\t\t\t\tshadowBias: 0,\r\n\t\t\t\t\t\t\tshadowRadius: 1,\r\n\t\t\t\t\t\t\tshadowMapSize: new Vector2()\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'PointLight':\r\n\t\t\t\t\t\tuniforms = {\r\n\t\t\t\t\t\t\tposition: new Vector3(),\r\n\t\t\t\t\t\t\tcolor: new Color(),\r\n\t\t\t\t\t\t\tdistance: 0,\r\n\t\t\t\t\t\t\tdecay: 0,\r\n\r\n\t\t\t\t\t\t\tshadow: false,\r\n\t\t\t\t\t\t\tshadowBias: 0,\r\n\t\t\t\t\t\t\tshadowRadius: 1,\r\n\t\t\t\t\t\t\tshadowMapSize: new Vector2(),\r\n\t\t\t\t\t\t\tshadowCameraNear: 1,\r\n\t\t\t\t\t\t\tshadowCameraFar: 1000\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'HemisphereLight':\r\n\t\t\t\t\t\tuniforms = {\r\n\t\t\t\t\t\t\tdirection: new Vector3(),\r\n\t\t\t\t\t\t\tskyColor: new Color(),\r\n\t\t\t\t\t\t\tgroundColor: new Color()\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'RectAreaLight':\r\n\t\t\t\t\t\tuniforms = {\r\n\t\t\t\t\t\t\tcolor: new Color(),\r\n\t\t\t\t\t\t\tposition: new Vector3(),\r\n\t\t\t\t\t\t\thalfWidth: new Vector3(),\r\n\t\t\t\t\t\t\thalfHeight: new Vector3()\r\n\t\t\t\t\t\t\t// TODO (abelnation): set RectAreaLight shadow uniforms\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlights[ light.id ] = uniforms;\r\n\r\n\t\t\t\treturn uniforms;\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n\tvar count = 0;\r\n\r\n\tfunction WebGLLights() {\r\n\r\n\t\tvar cache = new UniformsCache();\r\n\r\n\t\tvar state = {\r\n\r\n\t\t\tid: count ++,\r\n\r\n\t\t\thash: {\r\n\t\t\t\tstateID: - 1,\r\n\t\t\t\tdirectionalLength: - 1,\r\n\t\t\t\tpointLength: - 1,\r\n\t\t\t\tspotLength: - 1,\r\n\t\t\t\trectAreaLength: - 1,\r\n\t\t\t\themiLength: - 1,\r\n\t\t\t\tshadowsLength: - 1\r\n\t\t\t},\r\n\r\n\t\t\tambient: [ 0, 0, 0 ],\r\n\t\t\tdirectional: [],\r\n\t\t\tdirectionalShadowMap: [],\r\n\t\t\tdirectionalShadowMatrix: [],\r\n\t\t\tspot: [],\r\n\t\t\tspotShadowMap: [],\r\n\t\t\tspotShadowMatrix: [],\r\n\t\t\trectArea: [],\r\n\t\t\tpoint: [],\r\n\t\t\tpointShadowMap: [],\r\n\t\t\tpointShadowMatrix: [],\r\n\t\t\themi: []\r\n\r\n\t\t};\r\n\r\n\t\tvar vector3 = new Vector3();\r\n\t\tvar matrix4 = new Matrix4();\r\n\t\tvar matrix42 = new Matrix4();\r\n\r\n\t\tfunction setup( lights, shadows, camera ) {\r\n\r\n\t\t\tvar r = 0, g = 0, b = 0;\r\n\r\n\t\t\tvar directionalLength = 0;\r\n\t\t\tvar pointLength = 0;\r\n\t\t\tvar spotLength = 0;\r\n\t\t\tvar rectAreaLength = 0;\r\n\t\t\tvar hemiLength = 0;\r\n\r\n\t\t\tvar viewMatrix = camera.matrixWorldInverse;\r\n\r\n\t\t\tfor ( var i = 0, l = lights.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar light = lights[ i ];\r\n\r\n\t\t\t\tvar color = light.color;\r\n\t\t\t\tvar intensity = light.intensity;\r\n\t\t\t\tvar distance = light.distance;\r\n\r\n\t\t\t\tvar shadowMap = ( light.shadow && light.shadow.map ) ? light.shadow.map.texture : null;\r\n\r\n\t\t\t\tif ( light.isAmbientLight ) {\r\n\r\n\t\t\t\t\tr += color.r * intensity;\r\n\t\t\t\t\tg += color.g * intensity;\r\n\t\t\t\t\tb += color.b * intensity;\r\n\r\n\t\t\t\t} else if ( light.isDirectionalLight ) {\r\n\r\n\t\t\t\t\tvar uniforms = cache.get( light );\r\n\r\n\t\t\t\t\tuniforms.color.copy( light.color ).multiplyScalar( light.intensity );\r\n\t\t\t\t\tuniforms.direction.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\t\t\tvector3.setFromMatrixPosition( light.target.matrixWorld );\r\n\t\t\t\t\tuniforms.direction.sub( vector3 );\r\n\t\t\t\t\tuniforms.direction.transformDirection( viewMatrix );\r\n\r\n\t\t\t\t\tuniforms.shadow = light.castShadow;\r\n\r\n\t\t\t\t\tif ( light.castShadow ) {\r\n\r\n\t\t\t\t\t\tvar shadow = light.shadow;\r\n\r\n\t\t\t\t\t\tuniforms.shadowBias = shadow.bias;\r\n\t\t\t\t\t\tuniforms.shadowRadius = shadow.radius;\r\n\t\t\t\t\t\tuniforms.shadowMapSize = shadow.mapSize;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tstate.directionalShadowMap[ directionalLength ] = shadowMap;\r\n\t\t\t\t\tstate.directionalShadowMatrix[ directionalLength ] = light.shadow.matrix;\r\n\t\t\t\t\tstate.directional[ directionalLength ] = uniforms;\r\n\r\n\t\t\t\t\tdirectionalLength ++;\r\n\r\n\t\t\t\t} else if ( light.isSpotLight ) {\r\n\r\n\t\t\t\t\tvar uniforms = cache.get( light );\r\n\r\n\t\t\t\t\tuniforms.position.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\t\t\tuniforms.position.applyMatrix4( viewMatrix );\r\n\r\n\t\t\t\t\tuniforms.color.copy( color ).multiplyScalar( intensity );\r\n\t\t\t\t\tuniforms.distance = distance;\r\n\r\n\t\t\t\t\tuniforms.direction.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\t\t\tvector3.setFromMatrixPosition( light.target.matrixWorld );\r\n\t\t\t\t\tuniforms.direction.sub( vector3 );\r\n\t\t\t\t\tuniforms.direction.transformDirection( viewMatrix );\r\n\r\n\t\t\t\t\tuniforms.coneCos = Math.cos( light.angle );\r\n\t\t\t\t\tuniforms.penumbraCos = Math.cos( light.angle * ( 1 - light.penumbra ) );\r\n\t\t\t\t\tuniforms.decay = ( light.distance === 0 ) ? 0.0 : light.decay;\r\n\r\n\t\t\t\t\tuniforms.shadow = light.castShadow;\r\n\r\n\t\t\t\t\tif ( light.castShadow ) {\r\n\r\n\t\t\t\t\t\tvar shadow = light.shadow;\r\n\r\n\t\t\t\t\t\tuniforms.shadowBias = shadow.bias;\r\n\t\t\t\t\t\tuniforms.shadowRadius = shadow.radius;\r\n\t\t\t\t\t\tuniforms.shadowMapSize = shadow.mapSize;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tstate.spotShadowMap[ spotLength ] = shadowMap;\r\n\t\t\t\t\tstate.spotShadowMatrix[ spotLength ] = light.shadow.matrix;\r\n\t\t\t\t\tstate.spot[ spotLength ] = uniforms;\r\n\r\n\t\t\t\t\tspotLength ++;\r\n\r\n\t\t\t\t} else if ( light.isRectAreaLight ) {\r\n\r\n\t\t\t\t\tvar uniforms = cache.get( light );\r\n\r\n\t\t\t\t\t// (a) intensity is the total visible light emitted\r\n\t\t\t\t\t//uniforms.color.copy( color ).multiplyScalar( intensity / ( light.width * light.height * Math.PI ) );\r\n\r\n\t\t\t\t\t// (b) intensity is the brightness of the light\r\n\t\t\t\t\tuniforms.color.copy( color ).multiplyScalar( intensity );\r\n\r\n\t\t\t\t\tuniforms.position.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\t\t\tuniforms.position.applyMatrix4( viewMatrix );\r\n\r\n\t\t\t\t\t// extract local rotation of light to derive width/height half vectors\r\n\t\t\t\t\tmatrix42.identity();\r\n\t\t\t\t\tmatrix4.copy( light.matrixWorld );\r\n\t\t\t\t\tmatrix4.premultiply( viewMatrix );\r\n\t\t\t\t\tmatrix42.extractRotation( matrix4 );\r\n\r\n\t\t\t\t\tuniforms.halfWidth.set( light.width * 0.5, 0.0, 0.0 );\r\n\t\t\t\t\tuniforms.halfHeight.set( 0.0, light.height * 0.5, 0.0 );\r\n\r\n\t\t\t\t\tuniforms.halfWidth.applyMatrix4( matrix42 );\r\n\t\t\t\t\tuniforms.halfHeight.applyMatrix4( matrix42 );\r\n\r\n\t\t\t\t\t// TODO (abelnation): RectAreaLight distance?\r\n\t\t\t\t\t// uniforms.distance = distance;\r\n\r\n\t\t\t\t\tstate.rectArea[ rectAreaLength ] = uniforms;\r\n\r\n\t\t\t\t\trectAreaLength ++;\r\n\r\n\t\t\t\t} else if ( light.isPointLight ) {\r\n\r\n\t\t\t\t\tvar uniforms = cache.get( light );\r\n\r\n\t\t\t\t\tuniforms.position.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\t\t\tuniforms.position.applyMatrix4( viewMatrix );\r\n\r\n\t\t\t\t\tuniforms.color.copy( light.color ).multiplyScalar( light.intensity );\r\n\t\t\t\t\tuniforms.distance = light.distance;\r\n\t\t\t\t\tuniforms.decay = ( light.distance === 0 ) ? 0.0 : light.decay;\r\n\r\n\t\t\t\t\tuniforms.shadow = light.castShadow;\r\n\r\n\t\t\t\t\tif ( light.castShadow ) {\r\n\r\n\t\t\t\t\t\tvar shadow = light.shadow;\r\n\r\n\t\t\t\t\t\tuniforms.shadowBias = shadow.bias;\r\n\t\t\t\t\t\tuniforms.shadowRadius = shadow.radius;\r\n\t\t\t\t\t\tuniforms.shadowMapSize = shadow.mapSize;\r\n\t\t\t\t\t\tuniforms.shadowCameraNear = shadow.camera.near;\r\n\t\t\t\t\t\tuniforms.shadowCameraFar = shadow.camera.far;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tstate.pointShadowMap[ pointLength ] = shadowMap;\r\n\t\t\t\t\tstate.pointShadowMatrix[ pointLength ] = light.shadow.matrix;\r\n\t\t\t\t\tstate.point[ pointLength ] = uniforms;\r\n\r\n\t\t\t\t\tpointLength ++;\r\n\r\n\t\t\t\t} else if ( light.isHemisphereLight ) {\r\n\r\n\t\t\t\t\tvar uniforms = cache.get( light );\r\n\r\n\t\t\t\t\tuniforms.direction.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\t\t\tuniforms.direction.transformDirection( viewMatrix );\r\n\t\t\t\t\tuniforms.direction.normalize();\r\n\r\n\t\t\t\t\tuniforms.skyColor.copy( light.color ).multiplyScalar( intensity );\r\n\t\t\t\t\tuniforms.groundColor.copy( light.groundColor ).multiplyScalar( intensity );\r\n\r\n\t\t\t\t\tstate.hemi[ hemiLength ] = uniforms;\r\n\r\n\t\t\t\t\themiLength ++;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tstate.ambient[ 0 ] = r;\r\n\t\t\tstate.ambient[ 1 ] = g;\r\n\t\t\tstate.ambient[ 2 ] = b;\r\n\r\n\t\t\tstate.directional.length = directionalLength;\r\n\t\t\tstate.spot.length = spotLength;\r\n\t\t\tstate.rectArea.length = rectAreaLength;\r\n\t\t\tstate.point.length = pointLength;\r\n\t\t\tstate.hemi.length = hemiLength;\r\n\r\n\t\t\tstate.hash.stateID = state.id;\r\n\t\t\tstate.hash.directionalLength = directionalLength;\r\n\t\t\tstate.hash.pointLength = pointLength;\r\n\t\t\tstate.hash.spotLength = spotLength;\r\n\t\t\tstate.hash.rectAreaLength = rectAreaLength;\r\n\t\t\tstate.hash.hemiLength = hemiLength;\r\n\t\t\tstate.hash.shadowsLength = shadows.length;\r\n\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tsetup: setup,\r\n\t\t\tstate: state\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t */\r\n\r\n\tfunction WebGLRenderState() {\r\n\r\n\t\tvar lights = new WebGLLights();\r\n\r\n\t\tvar lightsArray = [];\r\n\t\tvar shadowsArray = [];\r\n\r\n\t\tfunction init() {\r\n\r\n\t\t\tlightsArray.length = 0;\r\n\t\t\tshadowsArray.length = 0;\r\n\r\n\t\t}\r\n\r\n\t\tfunction pushLight( light ) {\r\n\r\n\t\t\tlightsArray.push( light );\r\n\r\n\t\t}\r\n\r\n\t\tfunction pushShadow( shadowLight ) {\r\n\r\n\t\t\tshadowsArray.push( shadowLight );\r\n\r\n\t\t}\r\n\r\n\t\tfunction setupLights( camera ) {\r\n\r\n\t\t\tlights.setup( lightsArray, shadowsArray, camera );\r\n\r\n\t\t}\r\n\r\n\t\tvar state = {\r\n\t\t\tlightsArray: lightsArray,\r\n\t\t\tshadowsArray: shadowsArray,\r\n\r\n\t\t\tlights: lights\r\n\t\t};\r\n\r\n\t\treturn {\r\n\t\t\tinit: init,\r\n\t\t\tstate: state,\r\n\t\t\tsetupLights: setupLights,\r\n\r\n\t\t\tpushLight: pushLight,\r\n\t\t\tpushShadow: pushShadow\r\n\t\t};\r\n\r\n\t}\r\n\r\n\tfunction WebGLRenderStates() {\r\n\r\n\t\tvar renderStates = {};\r\n\r\n\t\tfunction get( scene, camera ) {\r\n\r\n\t\t\tvar renderState;\r\n\r\n\t\t\tif ( renderStates[ scene.id ] === undefined ) {\r\n\r\n\t\t\t\trenderState = new WebGLRenderState();\r\n\t\t\t\trenderStates[ scene.id ] = {};\r\n\t\t\t\trenderStates[ scene.id ][ camera.id ] = renderState;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif ( renderStates[ scene.id ][ camera.id ] === undefined ) {\r\n\r\n\t\t\t\t\trenderState = new WebGLRenderState();\r\n\t\t\t\t\trenderStates[ scene.id ][ camera.id ] = renderState;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\trenderState = renderStates[ scene.id ][ camera.id ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn renderState;\r\n\r\n\t\t}\r\n\r\n\t\tfunction dispose() {\r\n\r\n\t\t\trenderStates = {};\r\n\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tget: get,\r\n\t\t\tdispose: dispose\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author bhouston / https://clara.io\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t *\r\n\t * parameters = {\r\n\t *\r\n\t *  opacity: <float>,\r\n\t *\r\n\t *  map: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  alphaMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  displacementMap: new THREE.Texture( <Image> ),\r\n\t *  displacementScale: <float>,\r\n\t *  displacementBias: <float>,\r\n\t *\r\n\t *  wireframe: <boolean>,\r\n\t *  wireframeLinewidth: <float>\r\n\t * }\r\n\t */\r\n\r\n\tfunction MeshDepthMaterial( parameters ) {\r\n\r\n\t\tMaterial.call( this );\r\n\r\n\t\tthis.type = 'MeshDepthMaterial';\r\n\r\n\t\tthis.depthPacking = BasicDepthPacking;\r\n\r\n\t\tthis.skinning = false;\r\n\t\tthis.morphTargets = false;\r\n\r\n\t\tthis.map = null;\r\n\r\n\t\tthis.alphaMap = null;\r\n\r\n\t\tthis.displacementMap = null;\r\n\t\tthis.displacementScale = 1;\r\n\t\tthis.displacementBias = 0;\r\n\r\n\t\tthis.wireframe = false;\r\n\t\tthis.wireframeLinewidth = 1;\r\n\r\n\t\tthis.fog = false;\r\n\t\tthis.lights = false;\r\n\r\n\t\tthis.setValues( parameters );\r\n\r\n\t}\r\n\r\n\tMeshDepthMaterial.prototype = Object.create( Material.prototype );\r\n\tMeshDepthMaterial.prototype.constructor = MeshDepthMaterial;\r\n\r\n\tMeshDepthMaterial.prototype.isMeshDepthMaterial = true;\r\n\r\n\tMeshDepthMaterial.prototype.copy = function ( source ) {\r\n\r\n\t\tMaterial.prototype.copy.call( this, source );\r\n\r\n\t\tthis.depthPacking = source.depthPacking;\r\n\r\n\t\tthis.skinning = source.skinning;\r\n\t\tthis.morphTargets = source.morphTargets;\r\n\r\n\t\tthis.map = source.map;\r\n\r\n\t\tthis.alphaMap = source.alphaMap;\r\n\r\n\t\tthis.displacementMap = source.displacementMap;\r\n\t\tthis.displacementScale = source.displacementScale;\r\n\t\tthis.displacementBias = source.displacementBias;\r\n\r\n\t\tthis.wireframe = source.wireframe;\r\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t *\r\n\t * parameters = {\r\n\t *\r\n\t *  referencePosition: <float>,\r\n\t *  nearDistance: <float>,\r\n\t *  farDistance: <float>,\r\n\t *\r\n\t *  skinning: <bool>,\r\n\t *  morphTargets: <bool>,\r\n\t *\r\n\t *  map: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  alphaMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  displacementMap: new THREE.Texture( <Image> ),\r\n\t *  displacementScale: <float>,\r\n\t *  displacementBias: <float>\r\n\t *\r\n\t * }\r\n\t */\r\n\r\n\tfunction MeshDistanceMaterial( parameters ) {\r\n\r\n\t\tMaterial.call( this );\r\n\r\n\t\tthis.type = 'MeshDistanceMaterial';\r\n\r\n\t\tthis.referencePosition = new Vector3();\r\n\t\tthis.nearDistance = 1;\r\n\t\tthis.farDistance = 1000;\r\n\r\n\t\tthis.skinning = false;\r\n\t\tthis.morphTargets = false;\r\n\r\n\t\tthis.map = null;\r\n\r\n\t\tthis.alphaMap = null;\r\n\r\n\t\tthis.displacementMap = null;\r\n\t\tthis.displacementScale = 1;\r\n\t\tthis.displacementBias = 0;\r\n\r\n\t\tthis.fog = false;\r\n\t\tthis.lights = false;\r\n\r\n\t\tthis.setValues( parameters );\r\n\r\n\t}\r\n\r\n\tMeshDistanceMaterial.prototype = Object.create( Material.prototype );\r\n\tMeshDistanceMaterial.prototype.constructor = MeshDistanceMaterial;\r\n\r\n\tMeshDistanceMaterial.prototype.isMeshDistanceMaterial = true;\r\n\r\n\tMeshDistanceMaterial.prototype.copy = function ( source ) {\r\n\r\n\t\tMaterial.prototype.copy.call( this, source );\r\n\r\n\t\tthis.referencePosition.copy( source.referencePosition );\r\n\t\tthis.nearDistance = source.nearDistance;\r\n\t\tthis.farDistance = source.farDistance;\r\n\r\n\t\tthis.skinning = source.skinning;\r\n\t\tthis.morphTargets = source.morphTargets;\r\n\r\n\t\tthis.map = source.map;\r\n\r\n\t\tthis.alphaMap = source.alphaMap;\r\n\r\n\t\tthis.displacementMap = source.displacementMap;\r\n\t\tthis.displacementScale = source.displacementScale;\r\n\t\tthis.displacementBias = source.displacementBias;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction WebGLShadowMap( _renderer, _objects, maxTextureSize ) {\r\n\r\n\t\tvar _frustum = new Frustum(),\r\n\t\t\t_projScreenMatrix = new Matrix4(),\r\n\r\n\t\t\t_shadowMapSize = new Vector2(),\r\n\t\t\t_maxShadowMapSize = new Vector2( maxTextureSize, maxTextureSize ),\r\n\r\n\t\t\t_lookTarget = new Vector3(),\r\n\t\t\t_lightPositionWorld = new Vector3(),\r\n\r\n\t\t\t_MorphingFlag = 1,\r\n\t\t\t_SkinningFlag = 2,\r\n\r\n\t\t\t_NumberOfMaterialVariants = ( _MorphingFlag | _SkinningFlag ) + 1,\r\n\r\n\t\t\t_depthMaterials = new Array( _NumberOfMaterialVariants ),\r\n\t\t\t_distanceMaterials = new Array( _NumberOfMaterialVariants ),\r\n\r\n\t\t\t_materialCache = {};\r\n\r\n\t\tvar shadowSide = { 0: BackSide, 1: FrontSide, 2: DoubleSide };\r\n\r\n\t\tvar cubeDirections = [\r\n\t\t\tnew Vector3( 1, 0, 0 ), new Vector3( - 1, 0, 0 ), new Vector3( 0, 0, 1 ),\r\n\t\t\tnew Vector3( 0, 0, - 1 ), new Vector3( 0, 1, 0 ), new Vector3( 0, - 1, 0 )\r\n\t\t];\r\n\r\n\t\tvar cubeUps = [\r\n\t\t\tnew Vector3( 0, 1, 0 ), new Vector3( 0, 1, 0 ), new Vector3( 0, 1, 0 ),\r\n\t\t\tnew Vector3( 0, 1, 0 ), new Vector3( 0, 0, 1 ),\tnew Vector3( 0, 0, - 1 )\r\n\t\t];\r\n\r\n\t\tvar cube2DViewPorts = [\r\n\t\t\tnew Vector4(), new Vector4(), new Vector4(),\r\n\t\t\tnew Vector4(), new Vector4(), new Vector4()\r\n\t\t];\r\n\r\n\t\t// init\r\n\r\n\t\tfor ( var i = 0; i !== _NumberOfMaterialVariants; ++ i ) {\r\n\r\n\t\t\tvar useMorphing = ( i & _MorphingFlag ) !== 0;\r\n\t\t\tvar useSkinning = ( i & _SkinningFlag ) !== 0;\r\n\r\n\t\t\tvar depthMaterial = new MeshDepthMaterial( {\r\n\r\n\t\t\t\tdepthPacking: RGBADepthPacking,\r\n\r\n\t\t\t\tmorphTargets: useMorphing,\r\n\t\t\t\tskinning: useSkinning\r\n\r\n\t\t\t} );\r\n\r\n\t\t\t_depthMaterials[ i ] = depthMaterial;\r\n\r\n\t\t\t//\r\n\r\n\t\t\tvar distanceMaterial = new MeshDistanceMaterial( {\r\n\r\n\t\t\t\tmorphTargets: useMorphing,\r\n\t\t\t\tskinning: useSkinning\r\n\r\n\t\t\t} );\r\n\r\n\t\t\t_distanceMaterials[ i ] = distanceMaterial;\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tthis.enabled = false;\r\n\r\n\t\tthis.autoUpdate = true;\r\n\t\tthis.needsUpdate = false;\r\n\r\n\t\tthis.type = PCFShadowMap;\r\n\r\n\t\tthis.render = function ( lights, scene, camera ) {\r\n\r\n\t\t\tif ( scope.enabled === false ) return;\r\n\t\t\tif ( scope.autoUpdate === false && scope.needsUpdate === false ) return;\r\n\r\n\t\t\tif ( lights.length === 0 ) return;\r\n\r\n\t\t\t// TODO Clean up (needed in case of contextlost)\r\n\t\t\tvar _gl = _renderer.context;\r\n\t\t\tvar _state = _renderer.state;\r\n\r\n\t\t\t// Set GL state for depth map.\r\n\t\t\t_state.disable( _gl.BLEND );\r\n\t\t\t_state.buffers.color.setClear( 1, 1, 1, 1 );\r\n\t\t\t_state.buffers.depth.setTest( true );\r\n\t\t\t_state.setScissorTest( false );\r\n\r\n\t\t\t// render depth map\r\n\r\n\t\t\tvar faceCount;\r\n\r\n\t\t\tfor ( var i = 0, il = lights.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvar light = lights[ i ];\r\n\t\t\t\tvar shadow = light.shadow;\r\n\t\t\t\tvar isPointLight = light && light.isPointLight;\r\n\r\n\t\t\t\tif ( shadow === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLShadowMap:', light, 'has no shadow.' );\r\n\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar shadowCamera = shadow.camera;\r\n\r\n\t\t\t\t_shadowMapSize.copy( shadow.mapSize );\r\n\t\t\t\t_shadowMapSize.min( _maxShadowMapSize );\r\n\r\n\t\t\t\tif ( isPointLight ) {\r\n\r\n\t\t\t\t\tvar vpWidth = _shadowMapSize.x;\r\n\t\t\t\t\tvar vpHeight = _shadowMapSize.y;\r\n\r\n\t\t\t\t\t// These viewports map a cube-map onto a 2D texture with the\r\n\t\t\t\t\t// following orientation:\r\n\t\t\t\t\t//\r\n\t\t\t\t\t//  xzXZ\r\n\t\t\t\t\t//   y Y\r\n\t\t\t\t\t//\r\n\t\t\t\t\t// X - Positive x direction\r\n\t\t\t\t\t// x - Negative x direction\r\n\t\t\t\t\t// Y - Positive y direction\r\n\t\t\t\t\t// y - Negative y direction\r\n\t\t\t\t\t// Z - Positive z direction\r\n\t\t\t\t\t// z - Negative z direction\r\n\r\n\t\t\t\t\t// positive X\r\n\t\t\t\t\tcube2DViewPorts[ 0 ].set( vpWidth * 2, vpHeight, vpWidth, vpHeight );\r\n\t\t\t\t\t// negative X\r\n\t\t\t\t\tcube2DViewPorts[ 1 ].set( 0, vpHeight, vpWidth, vpHeight );\r\n\t\t\t\t\t// positive Z\r\n\t\t\t\t\tcube2DViewPorts[ 2 ].set( vpWidth * 3, vpHeight, vpWidth, vpHeight );\r\n\t\t\t\t\t// negative Z\r\n\t\t\t\t\tcube2DViewPorts[ 3 ].set( vpWidth, vpHeight, vpWidth, vpHeight );\r\n\t\t\t\t\t// positive Y\r\n\t\t\t\t\tcube2DViewPorts[ 4 ].set( vpWidth * 3, 0, vpWidth, vpHeight );\r\n\t\t\t\t\t// negative Y\r\n\t\t\t\t\tcube2DViewPorts[ 5 ].set( vpWidth, 0, vpWidth, vpHeight );\r\n\r\n\t\t\t\t\t_shadowMapSize.x *= 4.0;\r\n\t\t\t\t\t_shadowMapSize.y *= 2.0;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( shadow.map === null ) {\r\n\r\n\t\t\t\t\tvar pars = { minFilter: NearestFilter, magFilter: NearestFilter, format: RGBAFormat };\r\n\r\n\t\t\t\t\tshadow.map = new WebGLRenderTarget( _shadowMapSize.x, _shadowMapSize.y, pars );\r\n\t\t\t\t\tshadow.map.texture.name = light.name + \".shadowMap\";\r\n\r\n\t\t\t\t\tshadowCamera.updateProjectionMatrix();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( shadow.isSpotLightShadow ) {\r\n\r\n\t\t\t\t\tshadow.update( light );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar shadowMap = shadow.map;\r\n\t\t\t\tvar shadowMatrix = shadow.matrix;\r\n\r\n\t\t\t\t_lightPositionWorld.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\t\tshadowCamera.position.copy( _lightPositionWorld );\r\n\r\n\t\t\t\tif ( isPointLight ) {\r\n\r\n\t\t\t\t\tfaceCount = 6;\r\n\r\n\t\t\t\t\t// for point lights we set the shadow matrix to be a translation-only matrix\r\n\t\t\t\t\t// equal to inverse of the light's position\r\n\r\n\t\t\t\t\tshadowMatrix.makeTranslation( - _lightPositionWorld.x, - _lightPositionWorld.y, - _lightPositionWorld.z );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tfaceCount = 1;\r\n\r\n\t\t\t\t\t_lookTarget.setFromMatrixPosition( light.target.matrixWorld );\r\n\t\t\t\t\tshadowCamera.lookAt( _lookTarget );\r\n\t\t\t\t\tshadowCamera.updateMatrixWorld();\r\n\r\n\t\t\t\t\t// compute shadow matrix\r\n\r\n\t\t\t\t\tshadowMatrix.set(\r\n\t\t\t\t\t\t0.5, 0.0, 0.0, 0.5,\r\n\t\t\t\t\t\t0.0, 0.5, 0.0, 0.5,\r\n\t\t\t\t\t\t0.0, 0.0, 0.5, 0.5,\r\n\t\t\t\t\t\t0.0, 0.0, 0.0, 1.0\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tshadowMatrix.multiply( shadowCamera.projectionMatrix );\r\n\t\t\t\t\tshadowMatrix.multiply( shadowCamera.matrixWorldInverse );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t_renderer.setRenderTarget( shadowMap );\r\n\t\t\t\t_renderer.clear();\r\n\r\n\t\t\t\t// render shadow map for each cube face (if omni-directional) or\r\n\t\t\t\t// run a single pass if not\r\n\r\n\t\t\t\tfor ( var face = 0; face < faceCount; face ++ ) {\r\n\r\n\t\t\t\t\tif ( isPointLight ) {\r\n\r\n\t\t\t\t\t\t_lookTarget.copy( shadowCamera.position );\r\n\t\t\t\t\t\t_lookTarget.add( cubeDirections[ face ] );\r\n\t\t\t\t\t\tshadowCamera.up.copy( cubeUps[ face ] );\r\n\t\t\t\t\t\tshadowCamera.lookAt( _lookTarget );\r\n\t\t\t\t\t\tshadowCamera.updateMatrixWorld();\r\n\r\n\t\t\t\t\t\tvar vpDimensions = cube2DViewPorts[ face ];\r\n\t\t\t\t\t\t_state.viewport( vpDimensions );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// update camera matrices and frustum\r\n\r\n\t\t\t\t\t_projScreenMatrix.multiplyMatrices( shadowCamera.projectionMatrix, shadowCamera.matrixWorldInverse );\r\n\t\t\t\t\t_frustum.setFromMatrix( _projScreenMatrix );\r\n\r\n\t\t\t\t\t// set object matrices & frustum culling\r\n\r\n\t\t\t\t\trenderObject( scene, camera, shadowCamera, isPointLight );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tscope.needsUpdate = false;\r\n\r\n\t\t};\r\n\r\n\t\tfunction getDepthMaterial( object, material, isPointLight, lightPositionWorld, shadowCameraNear, shadowCameraFar ) {\r\n\r\n\t\t\tvar geometry = object.geometry;\r\n\r\n\t\t\tvar result = null;\r\n\r\n\t\t\tvar materialVariants = _depthMaterials;\r\n\t\t\tvar customMaterial = object.customDepthMaterial;\r\n\r\n\t\t\tif ( isPointLight ) {\r\n\r\n\t\t\t\tmaterialVariants = _distanceMaterials;\r\n\t\t\t\tcustomMaterial = object.customDistanceMaterial;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( ! customMaterial ) {\r\n\r\n\t\t\t\tvar useMorphing = false;\r\n\r\n\t\t\t\tif ( material.morphTargets ) {\r\n\r\n\t\t\t\t\tif ( geometry && geometry.isBufferGeometry ) {\r\n\r\n\t\t\t\t\t\tuseMorphing = geometry.morphAttributes && geometry.morphAttributes.position && geometry.morphAttributes.position.length > 0;\r\n\r\n\t\t\t\t\t} else if ( geometry && geometry.isGeometry ) {\r\n\r\n\t\t\t\t\t\tuseMorphing = geometry.morphTargets && geometry.morphTargets.length > 0;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( object.isSkinnedMesh && material.skinning === false ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:', object );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar useSkinning = object.isSkinnedMesh && material.skinning;\r\n\r\n\t\t\t\tvar variantIndex = 0;\r\n\r\n\t\t\t\tif ( useMorphing ) variantIndex |= _MorphingFlag;\r\n\t\t\t\tif ( useSkinning ) variantIndex |= _SkinningFlag;\r\n\r\n\t\t\t\tresult = materialVariants[ variantIndex ];\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tresult = customMaterial;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( _renderer.localClippingEnabled &&\r\n\t\t\t\t\tmaterial.clipShadows === true &&\r\n\t\t\t\t\tmaterial.clippingPlanes.length !== 0 ) {\r\n\r\n\t\t\t\t// in this case we need a unique material instance reflecting the\r\n\t\t\t\t// appropriate state\r\n\r\n\t\t\t\tvar keyA = result.uuid, keyB = material.uuid;\r\n\r\n\t\t\t\tvar materialsForVariant = _materialCache[ keyA ];\r\n\r\n\t\t\t\tif ( materialsForVariant === undefined ) {\r\n\r\n\t\t\t\t\tmaterialsForVariant = {};\r\n\t\t\t\t\t_materialCache[ keyA ] = materialsForVariant;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar cachedMaterial = materialsForVariant[ keyB ];\r\n\r\n\t\t\t\tif ( cachedMaterial === undefined ) {\r\n\r\n\t\t\t\t\tcachedMaterial = result.clone();\r\n\t\t\t\t\tmaterialsForVariant[ keyB ] = cachedMaterial;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tresult = cachedMaterial;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tresult.visible = material.visible;\r\n\t\t\tresult.wireframe = material.wireframe;\r\n\r\n\t\t\tresult.side = ( material.shadowSide != null ) ? material.shadowSide : shadowSide[ material.side ];\r\n\r\n\t\t\tresult.clipShadows = material.clipShadows;\r\n\t\t\tresult.clippingPlanes = material.clippingPlanes;\r\n\t\t\tresult.clipIntersection = material.clipIntersection;\r\n\r\n\t\t\tresult.wireframeLinewidth = material.wireframeLinewidth;\r\n\t\t\tresult.linewidth = material.linewidth;\r\n\r\n\t\t\tif ( isPointLight && result.isMeshDistanceMaterial ) {\r\n\r\n\t\t\t\tresult.referencePosition.copy( lightPositionWorld );\r\n\t\t\t\tresult.nearDistance = shadowCameraNear;\r\n\t\t\t\tresult.farDistance = shadowCameraFar;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn result;\r\n\r\n\t\t}\r\n\r\n\t\tfunction renderObject( object, camera, shadowCamera, isPointLight ) {\r\n\r\n\t\t\tif ( object.visible === false ) return;\r\n\r\n\t\t\tvar visible = object.layers.test( camera.layers );\r\n\r\n\t\t\tif ( visible && ( object.isMesh || object.isLine || object.isPoints ) ) {\r\n\r\n\t\t\t\tif ( object.castShadow && ( ! object.frustumCulled || _frustum.intersectsObject( object ) ) ) {\r\n\r\n\t\t\t\t\tobject.modelViewMatrix.multiplyMatrices( shadowCamera.matrixWorldInverse, object.matrixWorld );\r\n\r\n\t\t\t\t\tvar geometry = _objects.update( object );\r\n\t\t\t\t\tvar material = object.material;\r\n\r\n\t\t\t\t\tif ( Array.isArray( material ) ) {\r\n\r\n\t\t\t\t\t\tvar groups = geometry.groups;\r\n\r\n\t\t\t\t\t\tfor ( var k = 0, kl = groups.length; k < kl; k ++ ) {\r\n\r\n\t\t\t\t\t\t\tvar group = groups[ k ];\r\n\t\t\t\t\t\t\tvar groupMaterial = material[ group.materialIndex ];\r\n\r\n\t\t\t\t\t\t\tif ( groupMaterial && groupMaterial.visible ) {\r\n\r\n\t\t\t\t\t\t\t\tvar depthMaterial = getDepthMaterial( object, groupMaterial, isPointLight, _lightPositionWorld, shadowCamera.near, shadowCamera.far );\r\n\t\t\t\t\t\t\t\t_renderer.renderBufferDirect( shadowCamera, null, geometry, depthMaterial, object, group );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else if ( material.visible ) {\r\n\r\n\t\t\t\t\t\tvar depthMaterial = getDepthMaterial( object, material, isPointLight, _lightPositionWorld, shadowCamera.near, shadowCamera.far );\r\n\t\t\t\t\t\t_renderer.renderBufferDirect( shadowCamera, null, geometry, depthMaterial, object, null );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar children = object.children;\r\n\r\n\t\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\r\n\r\n\t\t\t\trenderObject( children[ i ], camera, shadowCamera, isPointLight );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction WebGLState( gl, extensions, utils, capabilities ) {\r\n\r\n\t\tfunction ColorBuffer() {\r\n\r\n\t\t\tvar locked = false;\r\n\r\n\t\t\tvar color = new Vector4();\r\n\t\t\tvar currentColorMask = null;\r\n\t\t\tvar currentColorClear = new Vector4( 0, 0, 0, 0 );\r\n\r\n\t\t\treturn {\r\n\r\n\t\t\t\tsetMask: function ( colorMask ) {\r\n\r\n\t\t\t\t\tif ( currentColorMask !== colorMask && ! locked ) {\r\n\r\n\t\t\t\t\t\tgl.colorMask( colorMask, colorMask, colorMask, colorMask );\r\n\t\t\t\t\t\tcurrentColorMask = colorMask;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tsetLocked: function ( lock ) {\r\n\r\n\t\t\t\t\tlocked = lock;\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tsetClear: function ( r, g, b, a, premultipliedAlpha ) {\r\n\r\n\t\t\t\t\tif ( premultipliedAlpha === true ) {\r\n\r\n\t\t\t\t\t\tr *= a; g *= a; b *= a;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tcolor.set( r, g, b, a );\r\n\r\n\t\t\t\t\tif ( currentColorClear.equals( color ) === false ) {\r\n\r\n\t\t\t\t\t\tgl.clearColor( r, g, b, a );\r\n\t\t\t\t\t\tcurrentColorClear.copy( color );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\treset: function () {\r\n\r\n\t\t\t\t\tlocked = false;\r\n\r\n\t\t\t\t\tcurrentColorMask = null;\r\n\t\t\t\t\tcurrentColorClear.set( - 1, 0, 0, 0 ); // set to invalid state\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t\tfunction DepthBuffer() {\r\n\r\n\t\t\tvar locked = false;\r\n\r\n\t\t\tvar currentDepthMask = null;\r\n\t\t\tvar currentDepthFunc = null;\r\n\t\t\tvar currentDepthClear = null;\r\n\r\n\t\t\treturn {\r\n\r\n\t\t\t\tsetTest: function ( depthTest ) {\r\n\r\n\t\t\t\t\tif ( depthTest ) {\r\n\r\n\t\t\t\t\t\tenable( gl.DEPTH_TEST );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tdisable( gl.DEPTH_TEST );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tsetMask: function ( depthMask ) {\r\n\r\n\t\t\t\t\tif ( currentDepthMask !== depthMask && ! locked ) {\r\n\r\n\t\t\t\t\t\tgl.depthMask( depthMask );\r\n\t\t\t\t\t\tcurrentDepthMask = depthMask;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tsetFunc: function ( depthFunc ) {\r\n\r\n\t\t\t\t\tif ( currentDepthFunc !== depthFunc ) {\r\n\r\n\t\t\t\t\t\tif ( depthFunc ) {\r\n\r\n\t\t\t\t\t\t\tswitch ( depthFunc ) {\r\n\r\n\t\t\t\t\t\t\t\tcase NeverDepth:\r\n\r\n\t\t\t\t\t\t\t\t\tgl.depthFunc( gl.NEVER );\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tcase AlwaysDepth:\r\n\r\n\t\t\t\t\t\t\t\t\tgl.depthFunc( gl.ALWAYS );\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tcase LessDepth:\r\n\r\n\t\t\t\t\t\t\t\t\tgl.depthFunc( gl.LESS );\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tcase LessEqualDepth:\r\n\r\n\t\t\t\t\t\t\t\t\tgl.depthFunc( gl.LEQUAL );\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tcase EqualDepth:\r\n\r\n\t\t\t\t\t\t\t\t\tgl.depthFunc( gl.EQUAL );\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tcase GreaterEqualDepth:\r\n\r\n\t\t\t\t\t\t\t\t\tgl.depthFunc( gl.GEQUAL );\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tcase GreaterDepth:\r\n\r\n\t\t\t\t\t\t\t\t\tgl.depthFunc( gl.GREATER );\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tcase NotEqualDepth:\r\n\r\n\t\t\t\t\t\t\t\t\tgl.depthFunc( gl.NOTEQUAL );\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tdefault:\r\n\r\n\t\t\t\t\t\t\t\t\tgl.depthFunc( gl.LEQUAL );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tgl.depthFunc( gl.LEQUAL );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tcurrentDepthFunc = depthFunc;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tsetLocked: function ( lock ) {\r\n\r\n\t\t\t\t\tlocked = lock;\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tsetClear: function ( depth ) {\r\n\r\n\t\t\t\t\tif ( currentDepthClear !== depth ) {\r\n\r\n\t\t\t\t\t\tgl.clearDepth( depth );\r\n\t\t\t\t\t\tcurrentDepthClear = depth;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\treset: function () {\r\n\r\n\t\t\t\t\tlocked = false;\r\n\r\n\t\t\t\t\tcurrentDepthMask = null;\r\n\t\t\t\t\tcurrentDepthFunc = null;\r\n\t\t\t\t\tcurrentDepthClear = null;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t\tfunction StencilBuffer() {\r\n\r\n\t\t\tvar locked = false;\r\n\r\n\t\t\tvar currentStencilMask = null;\r\n\t\t\tvar currentStencilFunc = null;\r\n\t\t\tvar currentStencilRef = null;\r\n\t\t\tvar currentStencilFuncMask = null;\r\n\t\t\tvar currentStencilFail = null;\r\n\t\t\tvar currentStencilZFail = null;\r\n\t\t\tvar currentStencilZPass = null;\r\n\t\t\tvar currentStencilClear = null;\r\n\r\n\t\t\treturn {\r\n\r\n\t\t\t\tsetTest: function ( stencilTest ) {\r\n\r\n\t\t\t\t\tif ( stencilTest ) {\r\n\r\n\t\t\t\t\t\tenable( gl.STENCIL_TEST );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tdisable( gl.STENCIL_TEST );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tsetMask: function ( stencilMask ) {\r\n\r\n\t\t\t\t\tif ( currentStencilMask !== stencilMask && ! locked ) {\r\n\r\n\t\t\t\t\t\tgl.stencilMask( stencilMask );\r\n\t\t\t\t\t\tcurrentStencilMask = stencilMask;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tsetFunc: function ( stencilFunc, stencilRef, stencilMask ) {\r\n\r\n\t\t\t\t\tif ( currentStencilFunc !== stencilFunc ||\r\n\t\t\t\t\t     currentStencilRef \t!== stencilRef \t||\r\n\t\t\t\t\t     currentStencilFuncMask !== stencilMask ) {\r\n\r\n\t\t\t\t\t\tgl.stencilFunc( stencilFunc, stencilRef, stencilMask );\r\n\r\n\t\t\t\t\t\tcurrentStencilFunc = stencilFunc;\r\n\t\t\t\t\t\tcurrentStencilRef = stencilRef;\r\n\t\t\t\t\t\tcurrentStencilFuncMask = stencilMask;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tsetOp: function ( stencilFail, stencilZFail, stencilZPass ) {\r\n\r\n\t\t\t\t\tif ( currentStencilFail\t !== stencilFail \t||\r\n\t\t\t\t\t     currentStencilZFail !== stencilZFail ||\r\n\t\t\t\t\t     currentStencilZPass !== stencilZPass ) {\r\n\r\n\t\t\t\t\t\tgl.stencilOp( stencilFail, stencilZFail, stencilZPass );\r\n\r\n\t\t\t\t\t\tcurrentStencilFail = stencilFail;\r\n\t\t\t\t\t\tcurrentStencilZFail = stencilZFail;\r\n\t\t\t\t\t\tcurrentStencilZPass = stencilZPass;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tsetLocked: function ( lock ) {\r\n\r\n\t\t\t\t\tlocked = lock;\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tsetClear: function ( stencil ) {\r\n\r\n\t\t\t\t\tif ( currentStencilClear !== stencil ) {\r\n\r\n\t\t\t\t\t\tgl.clearStencil( stencil );\r\n\t\t\t\t\t\tcurrentStencilClear = stencil;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\treset: function () {\r\n\r\n\t\t\t\t\tlocked = false;\r\n\r\n\t\t\t\t\tcurrentStencilMask = null;\r\n\t\t\t\t\tcurrentStencilFunc = null;\r\n\t\t\t\t\tcurrentStencilRef = null;\r\n\t\t\t\t\tcurrentStencilFuncMask = null;\r\n\t\t\t\t\tcurrentStencilFail = null;\r\n\t\t\t\t\tcurrentStencilZFail = null;\r\n\t\t\t\t\tcurrentStencilZPass = null;\r\n\t\t\t\t\tcurrentStencilClear = null;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tvar colorBuffer = new ColorBuffer();\r\n\t\tvar depthBuffer = new DepthBuffer();\r\n\t\tvar stencilBuffer = new StencilBuffer();\r\n\r\n\t\tvar maxVertexAttributes = gl.getParameter( gl.MAX_VERTEX_ATTRIBS );\r\n\t\tvar newAttributes = new Uint8Array( maxVertexAttributes );\r\n\t\tvar enabledAttributes = new Uint8Array( maxVertexAttributes );\r\n\t\tvar attributeDivisors = new Uint8Array( maxVertexAttributes );\r\n\r\n\t\tvar enabledCapabilities = {};\r\n\r\n\t\tvar compressedTextureFormats = null;\r\n\r\n\t\tvar currentProgram = null;\r\n\r\n\t\tvar currentBlendingEnabled = null;\r\n\t\tvar currentBlending = null;\r\n\t\tvar currentBlendEquation = null;\r\n\t\tvar currentBlendSrc = null;\r\n\t\tvar currentBlendDst = null;\r\n\t\tvar currentBlendEquationAlpha = null;\r\n\t\tvar currentBlendSrcAlpha = null;\r\n\t\tvar currentBlendDstAlpha = null;\r\n\t\tvar currentPremultipledAlpha = false;\r\n\r\n\t\tvar currentFlipSided = null;\r\n\t\tvar currentCullFace = null;\r\n\r\n\t\tvar currentLineWidth = null;\r\n\r\n\t\tvar currentPolygonOffsetFactor = null;\r\n\t\tvar currentPolygonOffsetUnits = null;\r\n\r\n\t\tvar maxTextures = gl.getParameter( gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS );\r\n\r\n\t\tvar lineWidthAvailable = false;\r\n\t\tvar version = 0;\r\n\t\tvar glVersion = gl.getParameter( gl.VERSION );\r\n\r\n\t\tif ( glVersion.indexOf( 'WebGL' ) !== - 1 ) {\r\n\r\n\t\t\tversion = parseFloat( /^WebGL\\ ([0-9])/.exec( glVersion )[ 1 ] );\r\n\t\t\tlineWidthAvailable = ( version >= 1.0 );\r\n\r\n\t\t} else if ( glVersion.indexOf( 'OpenGL ES' ) !== - 1 ) {\r\n\r\n\t\t\tversion = parseFloat( /^OpenGL\\ ES\\ ([0-9])/.exec( glVersion )[ 1 ] );\r\n\t\t\tlineWidthAvailable = ( version >= 2.0 );\r\n\r\n\t\t}\r\n\r\n\t\tvar currentTextureSlot = null;\r\n\t\tvar currentBoundTextures = {};\r\n\r\n\t\tvar currentScissor = new Vector4();\r\n\t\tvar currentViewport = new Vector4();\r\n\r\n\t\tfunction createTexture( type, target, count ) {\r\n\r\n\t\t\tvar data = new Uint8Array( 4 ); // 4 is required to match default unpack alignment of 4.\r\n\t\t\tvar texture = gl.createTexture();\r\n\r\n\t\t\tgl.bindTexture( type, texture );\r\n\t\t\tgl.texParameteri( type, gl.TEXTURE_MIN_FILTER, gl.NEAREST );\r\n\t\t\tgl.texParameteri( type, gl.TEXTURE_MAG_FILTER, gl.NEAREST );\r\n\r\n\t\t\tfor ( var i = 0; i < count; i ++ ) {\r\n\r\n\t\t\t\tgl.texImage2D( target + i, 0, gl.RGBA, 1, 1, 0, gl.RGBA, gl.UNSIGNED_BYTE, data );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn texture;\r\n\r\n\t\t}\r\n\r\n\t\tvar emptyTextures = {};\r\n\t\temptyTextures[ gl.TEXTURE_2D ] = createTexture( gl.TEXTURE_2D, gl.TEXTURE_2D, 1 );\r\n\t\temptyTextures[ gl.TEXTURE_CUBE_MAP ] = createTexture( gl.TEXTURE_CUBE_MAP, gl.TEXTURE_CUBE_MAP_POSITIVE_X, 6 );\r\n\r\n\t\t// init\r\n\r\n\t\tcolorBuffer.setClear( 0, 0, 0, 1 );\r\n\t\tdepthBuffer.setClear( 1 );\r\n\t\tstencilBuffer.setClear( 0 );\r\n\r\n\t\tenable( gl.DEPTH_TEST );\r\n\t\tdepthBuffer.setFunc( LessEqualDepth );\r\n\r\n\t\tsetFlipSided( false );\r\n\t\tsetCullFace( CullFaceBack );\r\n\t\tenable( gl.CULL_FACE );\r\n\r\n\t\tsetBlending( NoBlending );\r\n\r\n\t\t//\r\n\r\n\t\tfunction initAttributes() {\r\n\r\n\t\t\tfor ( var i = 0, l = newAttributes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tnewAttributes[ i ] = 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction enableAttribute( attribute ) {\r\n\r\n\t\t\tenableAttributeAndDivisor( attribute, 0 );\r\n\r\n\t\t}\r\n\r\n\t\tfunction enableAttributeAndDivisor( attribute, meshPerAttribute ) {\r\n\r\n\t\t\tnewAttributes[ attribute ] = 1;\r\n\r\n\t\t\tif ( enabledAttributes[ attribute ] === 0 ) {\r\n\r\n\t\t\t\tgl.enableVertexAttribArray( attribute );\r\n\t\t\t\tenabledAttributes[ attribute ] = 1;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( attributeDivisors[ attribute ] !== meshPerAttribute ) {\r\n\r\n\t\t\t\tvar extension = capabilities.isWebGL2 ? gl : extensions.get( 'ANGLE_instanced_arrays' );\r\n\r\n\t\t\t\textension[ capabilities.isWebGL2 ? 'vertexAttribDivisor' : 'vertexAttribDivisorANGLE' ]( attribute, meshPerAttribute );\r\n\t\t\t\tattributeDivisors[ attribute ] = meshPerAttribute;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction disableUnusedAttributes() {\r\n\r\n\t\t\tfor ( var i = 0, l = enabledAttributes.length; i !== l; ++ i ) {\r\n\r\n\t\t\t\tif ( enabledAttributes[ i ] !== newAttributes[ i ] ) {\r\n\r\n\t\t\t\t\tgl.disableVertexAttribArray( i );\r\n\t\t\t\t\tenabledAttributes[ i ] = 0;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction enable( id ) {\r\n\r\n\t\t\tif ( enabledCapabilities[ id ] !== true ) {\r\n\r\n\t\t\t\tgl.enable( id );\r\n\t\t\t\tenabledCapabilities[ id ] = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction disable( id ) {\r\n\r\n\t\t\tif ( enabledCapabilities[ id ] !== false ) {\r\n\r\n\t\t\t\tgl.disable( id );\r\n\t\t\t\tenabledCapabilities[ id ] = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction getCompressedTextureFormats() {\r\n\r\n\t\t\tif ( compressedTextureFormats === null ) {\r\n\r\n\t\t\t\tcompressedTextureFormats = [];\r\n\r\n\t\t\t\tif ( extensions.get( 'WEBGL_compressed_texture_pvrtc' ) ||\r\n\t\t\t\t     extensions.get( 'WEBGL_compressed_texture_s3tc' ) ||\r\n\t\t\t\t     extensions.get( 'WEBGL_compressed_texture_etc1' ) ||\r\n\t\t\t\t     extensions.get( 'WEBGL_compressed_texture_astc' ) ) {\r\n\r\n\t\t\t\t\tvar formats = gl.getParameter( gl.COMPRESSED_TEXTURE_FORMATS );\r\n\r\n\t\t\t\t\tfor ( var i = 0; i < formats.length; i ++ ) {\r\n\r\n\t\t\t\t\t\tcompressedTextureFormats.push( formats[ i ] );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn compressedTextureFormats;\r\n\r\n\t\t}\r\n\r\n\t\tfunction useProgram( program ) {\r\n\r\n\t\t\tif ( currentProgram !== program ) {\r\n\r\n\t\t\t\tgl.useProgram( program );\r\n\r\n\t\t\t\tcurrentProgram = program;\r\n\r\n\t\t\t\treturn true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn false;\r\n\r\n\t\t}\r\n\r\n\t\tfunction setBlending( blending, blendEquation, blendSrc, blendDst, blendEquationAlpha, blendSrcAlpha, blendDstAlpha, premultipliedAlpha ) {\r\n\r\n\t\t\tif ( blending === NoBlending ) {\r\n\r\n\t\t\t\tif ( currentBlendingEnabled ) {\r\n\r\n\t\t\t\t\tdisable( gl.BLEND );\r\n\t\t\t\t\tcurrentBlendingEnabled = false;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( ! currentBlendingEnabled ) {\r\n\r\n\t\t\t\tenable( gl.BLEND );\r\n\t\t\t\tcurrentBlendingEnabled = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( blending !== CustomBlending ) {\r\n\r\n\t\t\t\tif ( blending !== currentBlending || premultipliedAlpha !== currentPremultipledAlpha ) {\r\n\r\n\t\t\t\t\tif ( currentBlendEquation !== AddEquation || currentBlendEquationAlpha !== AddEquation ) {\r\n\r\n\t\t\t\t\t\tgl.blendEquation( gl.FUNC_ADD );\r\n\r\n\t\t\t\t\t\tcurrentBlendEquation = AddEquation;\r\n\t\t\t\t\t\tcurrentBlendEquationAlpha = AddEquation;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( premultipliedAlpha ) {\r\n\r\n\t\t\t\t\t\tswitch ( blending ) {\r\n\r\n\t\t\t\t\t\t\tcase NormalBlending:\r\n\t\t\t\t\t\t\t\tgl.blendFuncSeparate( gl.ONE, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA );\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\tcase AdditiveBlending:\r\n\t\t\t\t\t\t\t\tgl.blendFunc( gl.ONE, gl.ONE );\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\tcase SubtractiveBlending:\r\n\t\t\t\t\t\t\t\tgl.blendFuncSeparate( gl.ZERO, gl.ZERO, gl.ONE_MINUS_SRC_COLOR, gl.ONE_MINUS_SRC_ALPHA );\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\tcase MultiplyBlending:\r\n\t\t\t\t\t\t\t\tgl.blendFuncSeparate( gl.ZERO, gl.SRC_COLOR, gl.ZERO, gl.SRC_ALPHA );\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\t\tconsole.error( 'THREE.WebGLState: Invalid blending: ', blending );\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tswitch ( blending ) {\r\n\r\n\t\t\t\t\t\t\tcase NormalBlending:\r\n\t\t\t\t\t\t\t\tgl.blendFuncSeparate( gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA );\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\tcase AdditiveBlending:\r\n\t\t\t\t\t\t\t\tgl.blendFunc( gl.SRC_ALPHA, gl.ONE );\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\tcase SubtractiveBlending:\r\n\t\t\t\t\t\t\t\tgl.blendFunc( gl.ZERO, gl.ONE_MINUS_SRC_COLOR );\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\tcase MultiplyBlending:\r\n\t\t\t\t\t\t\t\tgl.blendFunc( gl.ZERO, gl.SRC_COLOR );\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\t\tconsole.error( 'THREE.WebGLState: Invalid blending: ', blending );\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tcurrentBlendSrc = null;\r\n\t\t\t\t\tcurrentBlendDst = null;\r\n\t\t\t\t\tcurrentBlendSrcAlpha = null;\r\n\t\t\t\t\tcurrentBlendDstAlpha = null;\r\n\r\n\t\t\t\t\tcurrentBlending = blending;\r\n\t\t\t\t\tcurrentPremultipledAlpha = premultipliedAlpha;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// custom blending\r\n\r\n\t\t\tblendEquationAlpha = blendEquationAlpha || blendEquation;\r\n\t\t\tblendSrcAlpha = blendSrcAlpha || blendSrc;\r\n\t\t\tblendDstAlpha = blendDstAlpha || blendDst;\r\n\r\n\t\t\tif ( blendEquation !== currentBlendEquation || blendEquationAlpha !== currentBlendEquationAlpha ) {\r\n\r\n\t\t\t\tgl.blendEquationSeparate( utils.convert( blendEquation ), utils.convert( blendEquationAlpha ) );\r\n\r\n\t\t\t\tcurrentBlendEquation = blendEquation;\r\n\t\t\t\tcurrentBlendEquationAlpha = blendEquationAlpha;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( blendSrc !== currentBlendSrc || blendDst !== currentBlendDst || blendSrcAlpha !== currentBlendSrcAlpha || blendDstAlpha !== currentBlendDstAlpha ) {\r\n\r\n\t\t\t\tgl.blendFuncSeparate( utils.convert( blendSrc ), utils.convert( blendDst ), utils.convert( blendSrcAlpha ), utils.convert( blendDstAlpha ) );\r\n\r\n\t\t\t\tcurrentBlendSrc = blendSrc;\r\n\t\t\t\tcurrentBlendDst = blendDst;\r\n\t\t\t\tcurrentBlendSrcAlpha = blendSrcAlpha;\r\n\t\t\t\tcurrentBlendDstAlpha = blendDstAlpha;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcurrentBlending = blending;\r\n\t\t\tcurrentPremultipledAlpha = null;\r\n\r\n\t\t}\r\n\r\n\t\tfunction setMaterial( material, frontFaceCW ) {\r\n\r\n\t\t\tmaterial.side === DoubleSide\r\n\t\t\t\t? disable( gl.CULL_FACE )\r\n\t\t\t\t: enable( gl.CULL_FACE );\r\n\r\n\t\t\tvar flipSided = ( material.side === BackSide );\r\n\t\t\tif ( frontFaceCW ) flipSided = ! flipSided;\r\n\r\n\t\t\tsetFlipSided( flipSided );\r\n\r\n\t\t\t( material.blending === NormalBlending && material.transparent === false )\r\n\t\t\t\t? setBlending( NoBlending )\r\n\t\t\t\t: setBlending( material.blending, material.blendEquation, material.blendSrc, material.blendDst, material.blendEquationAlpha, material.blendSrcAlpha, material.blendDstAlpha, material.premultipliedAlpha );\r\n\r\n\t\t\tdepthBuffer.setFunc( material.depthFunc );\r\n\t\t\tdepthBuffer.setTest( material.depthTest );\r\n\t\t\tdepthBuffer.setMask( material.depthWrite );\r\n\t\t\tcolorBuffer.setMask( material.colorWrite );\r\n\r\n\t\t\tsetPolygonOffset( material.polygonOffset, material.polygonOffsetFactor, material.polygonOffsetUnits );\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tfunction setFlipSided( flipSided ) {\r\n\r\n\t\t\tif ( currentFlipSided !== flipSided ) {\r\n\r\n\t\t\t\tif ( flipSided ) {\r\n\r\n\t\t\t\t\tgl.frontFace( gl.CW );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tgl.frontFace( gl.CCW );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcurrentFlipSided = flipSided;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction setCullFace( cullFace ) {\r\n\r\n\t\t\tif ( cullFace !== CullFaceNone ) {\r\n\r\n\t\t\t\tenable( gl.CULL_FACE );\r\n\r\n\t\t\t\tif ( cullFace !== currentCullFace ) {\r\n\r\n\t\t\t\t\tif ( cullFace === CullFaceBack ) {\r\n\r\n\t\t\t\t\t\tgl.cullFace( gl.BACK );\r\n\r\n\t\t\t\t\t} else if ( cullFace === CullFaceFront ) {\r\n\r\n\t\t\t\t\t\tgl.cullFace( gl.FRONT );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tgl.cullFace( gl.FRONT_AND_BACK );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tdisable( gl.CULL_FACE );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcurrentCullFace = cullFace;\r\n\r\n\t\t}\r\n\r\n\t\tfunction setLineWidth( width ) {\r\n\r\n\t\t\tif ( width !== currentLineWidth ) {\r\n\r\n\t\t\t\tif ( lineWidthAvailable ) gl.lineWidth( width );\r\n\r\n\t\t\t\tcurrentLineWidth = width;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction setPolygonOffset( polygonOffset, factor, units ) {\r\n\r\n\t\t\tif ( polygonOffset ) {\r\n\r\n\t\t\t\tenable( gl.POLYGON_OFFSET_FILL );\r\n\r\n\t\t\t\tif ( currentPolygonOffsetFactor !== factor || currentPolygonOffsetUnits !== units ) {\r\n\r\n\t\t\t\t\tgl.polygonOffset( factor, units );\r\n\r\n\t\t\t\t\tcurrentPolygonOffsetFactor = factor;\r\n\t\t\t\t\tcurrentPolygonOffsetUnits = units;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tdisable( gl.POLYGON_OFFSET_FILL );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction setScissorTest( scissorTest ) {\r\n\r\n\t\t\tif ( scissorTest ) {\r\n\r\n\t\t\t\tenable( gl.SCISSOR_TEST );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tdisable( gl.SCISSOR_TEST );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// texture\r\n\r\n\t\tfunction activeTexture( webglSlot ) {\r\n\r\n\t\t\tif ( webglSlot === undefined ) webglSlot = gl.TEXTURE0 + maxTextures - 1;\r\n\r\n\t\t\tif ( currentTextureSlot !== webglSlot ) {\r\n\r\n\t\t\t\tgl.activeTexture( webglSlot );\r\n\t\t\t\tcurrentTextureSlot = webglSlot;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction bindTexture( webglType, webglTexture ) {\r\n\r\n\t\t\tif ( currentTextureSlot === null ) {\r\n\r\n\t\t\t\tactiveTexture();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar boundTexture = currentBoundTextures[ currentTextureSlot ];\r\n\r\n\t\t\tif ( boundTexture === undefined ) {\r\n\r\n\t\t\t\tboundTexture = { type: undefined, texture: undefined };\r\n\t\t\t\tcurrentBoundTextures[ currentTextureSlot ] = boundTexture;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( boundTexture.type !== webglType || boundTexture.texture !== webglTexture ) {\r\n\r\n\t\t\t\tgl.bindTexture( webglType, webglTexture || emptyTextures[ webglType ] );\r\n\r\n\t\t\t\tboundTexture.type = webglType;\r\n\t\t\t\tboundTexture.texture = webglTexture;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction compressedTexImage2D() {\r\n\r\n\t\t\ttry {\r\n\r\n\t\t\t\tgl.compressedTexImage2D.apply( gl, arguments );\r\n\r\n\t\t\t} catch ( error ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.WebGLState:', error );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction texImage2D() {\r\n\r\n\t\t\ttry {\r\n\r\n\t\t\t\tgl.texImage2D.apply( gl, arguments );\r\n\r\n\t\t\t} catch ( error ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.WebGLState:', error );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tfunction scissor( scissor ) {\r\n\r\n\t\t\tif ( currentScissor.equals( scissor ) === false ) {\r\n\r\n\t\t\t\tgl.scissor( scissor.x, scissor.y, scissor.z, scissor.w );\r\n\t\t\t\tcurrentScissor.copy( scissor );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction viewport( viewport ) {\r\n\r\n\t\t\tif ( currentViewport.equals( viewport ) === false ) {\r\n\r\n\t\t\t\tgl.viewport( viewport.x, viewport.y, viewport.z, viewport.w );\r\n\t\t\t\tcurrentViewport.copy( viewport );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tfunction reset() {\r\n\r\n\t\t\tfor ( var i = 0; i < enabledAttributes.length; i ++ ) {\r\n\r\n\t\t\t\tif ( enabledAttributes[ i ] === 1 ) {\r\n\r\n\t\t\t\t\tgl.disableVertexAttribArray( i );\r\n\t\t\t\t\tenabledAttributes[ i ] = 0;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tenabledCapabilities = {};\r\n\r\n\t\t\tcompressedTextureFormats = null;\r\n\r\n\t\t\tcurrentTextureSlot = null;\r\n\t\t\tcurrentBoundTextures = {};\r\n\r\n\t\t\tcurrentProgram = null;\r\n\r\n\t\t\tcurrentBlending = null;\r\n\r\n\t\t\tcurrentFlipSided = null;\r\n\t\t\tcurrentCullFace = null;\r\n\r\n\t\t\tcolorBuffer.reset();\r\n\t\t\tdepthBuffer.reset();\r\n\t\t\tstencilBuffer.reset();\r\n\r\n\t\t}\r\n\r\n\t\treturn {\r\n\r\n\t\t\tbuffers: {\r\n\t\t\t\tcolor: colorBuffer,\r\n\t\t\t\tdepth: depthBuffer,\r\n\t\t\t\tstencil: stencilBuffer\r\n\t\t\t},\r\n\r\n\t\t\tinitAttributes: initAttributes,\r\n\t\t\tenableAttribute: enableAttribute,\r\n\t\t\tenableAttributeAndDivisor: enableAttributeAndDivisor,\r\n\t\t\tdisableUnusedAttributes: disableUnusedAttributes,\r\n\t\t\tenable: enable,\r\n\t\t\tdisable: disable,\r\n\t\t\tgetCompressedTextureFormats: getCompressedTextureFormats,\r\n\r\n\t\t\tuseProgram: useProgram,\r\n\r\n\t\t\tsetBlending: setBlending,\r\n\t\t\tsetMaterial: setMaterial,\r\n\r\n\t\t\tsetFlipSided: setFlipSided,\r\n\t\t\tsetCullFace: setCullFace,\r\n\r\n\t\t\tsetLineWidth: setLineWidth,\r\n\t\t\tsetPolygonOffset: setPolygonOffset,\r\n\r\n\t\t\tsetScissorTest: setScissorTest,\r\n\r\n\t\t\tactiveTexture: activeTexture,\r\n\t\t\tbindTexture: bindTexture,\r\n\t\t\tcompressedTexImage2D: compressedTexImage2D,\r\n\t\t\ttexImage2D: texImage2D,\r\n\r\n\t\t\tscissor: scissor,\r\n\t\t\tviewport: viewport,\r\n\r\n\t\t\treset: reset\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction WebGLTextures( _gl, extensions, state, properties, capabilities, utils, info ) {\r\n\r\n\t\tvar _videoTextures = {};\r\n\t\tvar _canvas;\r\n\r\n\t\t//\r\n\r\n\t\tfunction clampToMaxSize( image, maxSize ) {\r\n\r\n\t\t\tif ( image.width > maxSize || image.height > maxSize ) {\r\n\r\n\t\t\t\tif ( 'data' in image ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: image in DataTexture is too big (' + image.width + 'x' + image.height + ').' );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Warning: Scaling through the canvas will only work with images that use\r\n\t\t\t\t// premultiplied alpha.\r\n\r\n\t\t\t\tvar scale = maxSize / Math.max( image.width, image.height );\r\n\r\n\t\t\t\tvar canvas = document.createElementNS( 'http://www.w3.org/1999/xhtml', 'canvas' );\r\n\t\t\t\tcanvas.width = Math.floor( image.width * scale );\r\n\t\t\t\tcanvas.height = Math.floor( image.height * scale );\r\n\r\n\t\t\t\tvar context = canvas.getContext( '2d' );\r\n\t\t\t\tcontext.drawImage( image, 0, 0, image.width, image.height, 0, 0, canvas.width, canvas.height );\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: image is too big (' + image.width + 'x' + image.height + '). Resized to ' + canvas.width + 'x' + canvas.height );\r\n\r\n\t\t\t\treturn canvas;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn image;\r\n\r\n\t\t}\r\n\r\n\t\tfunction isPowerOfTwo( image ) {\r\n\r\n\t\t\treturn _Math.isPowerOfTwo( image.width ) && _Math.isPowerOfTwo( image.height );\r\n\r\n\t\t}\r\n\r\n\t\tfunction makePowerOfTwo( image ) {\r\n\r\n\t\t\tif ( image instanceof HTMLImageElement || image instanceof HTMLCanvasElement || image instanceof ImageBitmap ) {\r\n\r\n\t\t\t\tif ( _canvas === undefined ) _canvas = document.createElementNS( 'http://www.w3.org/1999/xhtml', 'canvas' );\r\n\r\n\t\t\t\t_canvas.width = _Math.floorPowerOfTwo( image.width );\r\n\t\t\t\t_canvas.height = _Math.floorPowerOfTwo( image.height );\r\n\r\n\t\t\t\tvar context = _canvas.getContext( '2d' );\r\n\t\t\t\tcontext.drawImage( image, 0, 0, _canvas.width, _canvas.height );\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: image is not power of two (' + image.width + 'x' + image.height + '). Resized to ' + _canvas.width + 'x' + _canvas.height );\r\n\r\n\t\t\t\treturn _canvas;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn image;\r\n\r\n\t\t}\r\n\r\n\t\tfunction textureNeedsPowerOfTwo( texture ) {\r\n\r\n\t\t\tif ( capabilities.isWebGL2 ) return false;\r\n\r\n\t\t\treturn ( texture.wrapS !== ClampToEdgeWrapping || texture.wrapT !== ClampToEdgeWrapping ) ||\r\n\t\t\t\t( texture.minFilter !== NearestFilter && texture.minFilter !== LinearFilter );\r\n\r\n\t\t}\r\n\r\n\t\tfunction textureNeedsGenerateMipmaps( texture, isPowerOfTwo ) {\r\n\r\n\t\t\treturn texture.generateMipmaps && isPowerOfTwo &&\r\n\t\t\t\ttexture.minFilter !== NearestFilter && texture.minFilter !== LinearFilter;\r\n\r\n\t\t}\r\n\r\n\t\tfunction generateMipmap( target, texture, width, height ) {\r\n\r\n\t\t\t_gl.generateMipmap( target );\r\n\r\n\t\t\tvar textureProperties = properties.get( texture );\r\n\r\n\t\t\t// Note: Math.log( x ) * Math.LOG2E used instead of Math.log2( x ) which is not supported by IE11\r\n\t\t\ttextureProperties.__maxMipLevel = Math.log( Math.max( width, height ) ) * Math.LOG2E;\r\n\r\n\t\t}\r\n\r\n\t\tfunction getInternalFormat( glFormat, glType ) {\r\n\r\n\t\t\tif ( ! capabilities.isWebGL2 ) return glFormat;\r\n\r\n\t\t\tif ( glFormat === _gl.RGB ) {\r\n\r\n\t\t\t\tif ( glType === _gl.FLOAT ) return _gl.RGB32F;\r\n\t\t\t\tif ( glType === _gl.HALF_FLOAT ) return _gl.RGB16F;\r\n\t\t\t\tif ( glType === _gl.UNSIGNED_BYTE ) return _gl.RGB8;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( glFormat === _gl.RGBA ) {\r\n\r\n\t\t\t\tif ( glType === _gl.FLOAT ) return _gl.RGBA32F;\r\n\t\t\t\tif ( glType === _gl.HALF_FLOAT ) return _gl.RGBA16F;\r\n\t\t\t\tif ( glType === _gl.UNSIGNED_BYTE ) return _gl.RGBA8;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn glFormat;\r\n\r\n\t\t}\r\n\r\n\t\t// Fallback filters for non-power-of-2 textures\r\n\r\n\t\tfunction filterFallback( f ) {\r\n\r\n\t\t\tif ( f === NearestFilter || f === NearestMipMapNearestFilter || f === NearestMipMapLinearFilter ) {\r\n\r\n\t\t\t\treturn _gl.NEAREST;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn _gl.LINEAR;\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tfunction onTextureDispose( event ) {\r\n\r\n\t\t\tvar texture = event.target;\r\n\r\n\t\t\ttexture.removeEventListener( 'dispose', onTextureDispose );\r\n\r\n\t\t\tdeallocateTexture( texture );\r\n\r\n\t\t\tif ( texture.isVideoTexture ) {\r\n\r\n\t\t\t\tdelete _videoTextures[ texture.id ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tinfo.memory.textures --;\r\n\r\n\t\t}\r\n\r\n\t\tfunction onRenderTargetDispose( event ) {\r\n\r\n\t\t\tvar renderTarget = event.target;\r\n\r\n\t\t\trenderTarget.removeEventListener( 'dispose', onRenderTargetDispose );\r\n\r\n\t\t\tdeallocateRenderTarget( renderTarget );\r\n\r\n\t\t\tinfo.memory.textures --;\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tfunction deallocateTexture( texture ) {\r\n\r\n\t\t\tvar textureProperties = properties.get( texture );\r\n\r\n\t\t\tif ( texture.image && textureProperties.__image__webglTextureCube ) {\r\n\r\n\t\t\t\t// cube texture\r\n\r\n\t\t\t\t_gl.deleteTexture( textureProperties.__image__webglTextureCube );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// 2D texture\r\n\r\n\t\t\t\tif ( textureProperties.__webglInit === undefined ) return;\r\n\r\n\t\t\t\t_gl.deleteTexture( textureProperties.__webglTexture );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// remove all webgl properties\r\n\t\t\tproperties.remove( texture );\r\n\r\n\t\t}\r\n\r\n\t\tfunction deallocateRenderTarget( renderTarget ) {\r\n\r\n\t\t\tvar renderTargetProperties = properties.get( renderTarget );\r\n\t\t\tvar textureProperties = properties.get( renderTarget.texture );\r\n\r\n\t\t\tif ( ! renderTarget ) return;\r\n\r\n\t\t\tif ( textureProperties.__webglTexture !== undefined ) {\r\n\r\n\t\t\t\t_gl.deleteTexture( textureProperties.__webglTexture );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( renderTarget.depthTexture ) {\r\n\r\n\t\t\t\trenderTarget.depthTexture.dispose();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( renderTarget.isWebGLRenderTargetCube ) {\r\n\r\n\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\t\t_gl.deleteFramebuffer( renderTargetProperties.__webglFramebuffer[ i ] );\r\n\t\t\t\t\tif ( renderTargetProperties.__webglDepthbuffer ) _gl.deleteRenderbuffer( renderTargetProperties.__webglDepthbuffer[ i ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t_gl.deleteFramebuffer( renderTargetProperties.__webglFramebuffer );\r\n\t\t\t\tif ( renderTargetProperties.__webglDepthbuffer ) _gl.deleteRenderbuffer( renderTargetProperties.__webglDepthbuffer );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tproperties.remove( renderTarget.texture );\r\n\t\t\tproperties.remove( renderTarget );\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\r\n\r\n\t\tfunction setTexture2D( texture, slot ) {\r\n\r\n\t\t\tvar textureProperties = properties.get( texture );\r\n\r\n\t\t\tif ( texture.isVideoTexture ) updateVideoTexture( texture );\r\n\r\n\t\t\tif ( texture.version > 0 && textureProperties.__version !== texture.version ) {\r\n\r\n\t\t\t\tvar image = texture.image;\r\n\r\n\t\t\t\tif ( image === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture marked for update but image is undefined' );\r\n\r\n\t\t\t\t} else if ( image.complete === false ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture marked for update but image is incomplete' );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tuploadTexture( textureProperties, texture, slot );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\r\n\t\t\tstate.bindTexture( _gl.TEXTURE_2D, textureProperties.__webglTexture );\r\n\r\n\t\t}\r\n\r\n\t\tfunction setTextureCube( texture, slot ) {\r\n\r\n\t\t\tvar textureProperties = properties.get( texture );\r\n\r\n\t\t\tif ( texture.image.length === 6 ) {\r\n\r\n\t\t\t\tif ( texture.version > 0 && textureProperties.__version !== texture.version ) {\r\n\r\n\t\t\t\t\tif ( ! textureProperties.__image__webglTextureCube ) {\r\n\r\n\t\t\t\t\t\ttexture.addEventListener( 'dispose', onTextureDispose );\r\n\r\n\t\t\t\t\t\ttextureProperties.__image__webglTextureCube = _gl.createTexture();\r\n\r\n\t\t\t\t\t\tinfo.memory.textures ++;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\r\n\t\t\t\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, textureProperties.__image__webglTextureCube );\r\n\r\n\t\t\t\t\t_gl.pixelStorei( _gl.UNPACK_FLIP_Y_WEBGL, texture.flipY );\r\n\r\n\t\t\t\t\tvar isCompressed = ( texture && texture.isCompressedTexture );\r\n\t\t\t\t\tvar isDataTexture = ( texture.image[ 0 ] && texture.image[ 0 ].isDataTexture );\r\n\r\n\t\t\t\t\tvar cubeImage = [];\r\n\r\n\t\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\t\t\tif ( ! isCompressed && ! isDataTexture ) {\r\n\r\n\t\t\t\t\t\t\tcubeImage[ i ] = clampToMaxSize( texture.image[ i ], capabilities.maxCubemapSize );\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tcubeImage[ i ] = isDataTexture ? texture.image[ i ].image : texture.image[ i ];\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar image = cubeImage[ 0 ],\r\n\t\t\t\t\t\tisPowerOfTwoImage = isPowerOfTwo( image ),\r\n\t\t\t\t\t\tglFormat = utils.convert( texture.format ),\r\n\t\t\t\t\t\tglType = utils.convert( texture.type ),\r\n\t\t\t\t\t\tglInternalFormat = getInternalFormat( glFormat, glType );\r\n\r\n\t\t\t\t\tsetTextureParameters( _gl.TEXTURE_CUBE_MAP, texture, isPowerOfTwoImage );\r\n\r\n\t\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\t\t\tif ( ! isCompressed ) {\r\n\r\n\t\t\t\t\t\t\tif ( isDataTexture ) {\r\n\r\n\t\t\t\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, glInternalFormat, cubeImage[ i ].width, cubeImage[ i ].height, 0, glFormat, glType, cubeImage[ i ].data );\r\n\r\n\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, glInternalFormat, glFormat, glType, cubeImage[ i ] );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tvar mipmap, mipmaps = cubeImage[ i ].mipmaps;\r\n\r\n\t\t\t\t\t\t\tfor ( var j = 0, jl = mipmaps.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tmipmap = mipmaps[ j ];\r\n\r\n\t\t\t\t\t\t\t\tif ( texture.format !== RGBAFormat && texture.format !== RGBFormat ) {\r\n\r\n\t\t\t\t\t\t\t\t\tif ( state.getCompressedTextureFormats().indexOf( glFormat ) > - 1 ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tstate.compressedTexImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, j, glInternalFormat, mipmap.width, mipmap.height, 0, mipmap.data );\r\n\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()' );\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, j, glInternalFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( ! isCompressed ) {\r\n\r\n\t\t\t\t\t\ttextureProperties.__maxMipLevel = 0;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\ttextureProperties.__maxMipLevel = mipmaps.length - 1;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( textureNeedsGenerateMipmaps( texture, isPowerOfTwoImage ) ) {\r\n\r\n\t\t\t\t\t\t// We assume images for cube map have the same size.\r\n\t\t\t\t\t\tgenerateMipmap( _gl.TEXTURE_CUBE_MAP, texture, image.width, image.height );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ttextureProperties.__version = texture.version;\r\n\r\n\t\t\t\t\tif ( texture.onUpdate ) texture.onUpdate( texture );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\r\n\t\t\t\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, textureProperties.__image__webglTextureCube );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction setTextureCubeDynamic( texture, slot ) {\r\n\r\n\t\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\r\n\t\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, properties.get( texture ).__webglTexture );\r\n\r\n\t\t}\r\n\r\n\t\tfunction setTextureParameters( textureType, texture, isPowerOfTwoImage ) {\r\n\r\n\t\t\tvar extension;\r\n\r\n\t\t\tif ( isPowerOfTwoImage ) {\r\n\r\n\t\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_WRAP_S, utils.convert( texture.wrapS ) );\r\n\t\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_WRAP_T, utils.convert( texture.wrapT ) );\r\n\r\n\t\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_MAG_FILTER, utils.convert( texture.magFilter ) );\r\n\t\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_MIN_FILTER, utils.convert( texture.minFilter ) );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_WRAP_S, _gl.CLAMP_TO_EDGE );\r\n\t\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_WRAP_T, _gl.CLAMP_TO_EDGE );\r\n\r\n\t\t\t\tif ( texture.wrapS !== ClampToEdgeWrapping || texture.wrapT !== ClampToEdgeWrapping ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_MAG_FILTER, filterFallback( texture.magFilter ) );\r\n\t\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_MIN_FILTER, filterFallback( texture.minFilter ) );\r\n\r\n\t\t\t\tif ( texture.minFilter !== NearestFilter && texture.minFilter !== LinearFilter ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\textension = extensions.get( 'EXT_texture_filter_anisotropic' );\r\n\r\n\t\t\tif ( extension ) {\r\n\r\n\t\t\t\tif ( texture.type === FloatType && extensions.get( 'OES_texture_float_linear' ) === null ) return;\r\n\t\t\t\tif ( texture.type === HalfFloatType && ( capabilities.isWebGL2 || extensions.get( 'OES_texture_half_float_linear' ) ) === null ) return;\r\n\r\n\t\t\t\tif ( texture.anisotropy > 1 || properties.get( texture ).__currentAnisotropy ) {\r\n\r\n\t\t\t\t\t_gl.texParameterf( textureType, extension.TEXTURE_MAX_ANISOTROPY_EXT, Math.min( texture.anisotropy, capabilities.getMaxAnisotropy() ) );\r\n\t\t\t\t\tproperties.get( texture ).__currentAnisotropy = texture.anisotropy;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction uploadTexture( textureProperties, texture, slot ) {\r\n\r\n\t\t\tif ( textureProperties.__webglInit === undefined ) {\r\n\r\n\t\t\t\ttextureProperties.__webglInit = true;\r\n\r\n\t\t\t\ttexture.addEventListener( 'dispose', onTextureDispose );\r\n\r\n\t\t\t\ttextureProperties.__webglTexture = _gl.createTexture();\r\n\r\n\t\t\t\tinfo.memory.textures ++;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\r\n\t\t\tstate.bindTexture( _gl.TEXTURE_2D, textureProperties.__webglTexture );\r\n\r\n\t\t\t_gl.pixelStorei( _gl.UNPACK_FLIP_Y_WEBGL, texture.flipY );\r\n\t\t\t_gl.pixelStorei( _gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, texture.premultiplyAlpha );\r\n\t\t\t_gl.pixelStorei( _gl.UNPACK_ALIGNMENT, texture.unpackAlignment );\r\n\r\n\t\t\tvar image = clampToMaxSize( texture.image, capabilities.maxTextureSize );\r\n\r\n\t\t\tif ( textureNeedsPowerOfTwo( texture ) && isPowerOfTwo( image ) === false ) {\r\n\r\n\t\t\t\timage = makePowerOfTwo( image );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar isPowerOfTwoImage = isPowerOfTwo( image ),\r\n\t\t\t\tglFormat = utils.convert( texture.format ),\r\n\t\t\t\tglType = utils.convert( texture.type ),\r\n\t\t\t\tglInternalFormat = getInternalFormat( glFormat, glType );\r\n\r\n\t\t\tsetTextureParameters( _gl.TEXTURE_2D, texture, isPowerOfTwoImage );\r\n\r\n\t\t\tvar mipmap, mipmaps = texture.mipmaps;\r\n\r\n\t\t\tif ( texture.isDepthTexture ) {\r\n\r\n\t\t\t\t// populate depth texture with dummy data\r\n\r\n\t\t\t\tglInternalFormat = _gl.DEPTH_COMPONENT;\r\n\r\n\t\t\t\tif ( texture.type === FloatType ) {\r\n\r\n\t\t\t\t\tif ( ! capabilities.isWebGL2 ) throw new Error( 'Float Depth Texture only supported in WebGL2.0' );\r\n\t\t\t\t\tglInternalFormat = _gl.DEPTH_COMPONENT32F;\r\n\r\n\t\t\t\t} else if ( capabilities.isWebGL2 ) {\r\n\r\n\t\t\t\t\t// WebGL 2.0 requires signed internalformat for glTexImage2D\r\n\t\t\t\t\tglInternalFormat = _gl.DEPTH_COMPONENT16;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( texture.format === DepthFormat && glInternalFormat === _gl.DEPTH_COMPONENT ) {\r\n\r\n\t\t\t\t\t// The error INVALID_OPERATION is generated by texImage2D if format and internalformat are\r\n\t\t\t\t\t// DEPTH_COMPONENT and type is not UNSIGNED_SHORT or UNSIGNED_INT\r\n\t\t\t\t\t// (https://www.khronos.org/registry/webgl/extensions/WEBGL_depth_texture/)\r\n\t\t\t\t\tif ( texture.type !== UnsignedShortType && texture.type !== UnsignedIntType ) {\r\n\r\n\t\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture.' );\r\n\r\n\t\t\t\t\t\ttexture.type = UnsignedShortType;\r\n\t\t\t\t\t\tglType = utils.convert( texture.type );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Depth stencil textures need the DEPTH_STENCIL internal format\r\n\t\t\t\t// (https://www.khronos.org/registry/webgl/extensions/WEBGL_depth_texture/)\r\n\t\t\t\tif ( texture.format === DepthStencilFormat ) {\r\n\r\n\t\t\t\t\tglInternalFormat = _gl.DEPTH_STENCIL;\r\n\r\n\t\t\t\t\t// The error INVALID_OPERATION is generated by texImage2D if format and internalformat are\r\n\t\t\t\t\t// DEPTH_STENCIL and type is not UNSIGNED_INT_24_8_WEBGL.\r\n\t\t\t\t\t// (https://www.khronos.org/registry/webgl/extensions/WEBGL_depth_texture/)\r\n\t\t\t\t\tif ( texture.type !== UnsignedInt248Type ) {\r\n\r\n\t\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture.' );\r\n\r\n\t\t\t\t\t\ttexture.type = UnsignedInt248Type;\r\n\t\t\t\t\t\tglType = utils.convert( texture.type );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, 0, glInternalFormat, image.width, image.height, 0, glFormat, glType, null );\r\n\r\n\t\t\t} else if ( texture.isDataTexture ) {\r\n\r\n\t\t\t\t// use manually created mipmaps if available\r\n\t\t\t\t// if there are no manual mipmaps\r\n\t\t\t\t// set 0 level mipmap and then use GL to generate other mipmap levels\r\n\r\n\t\t\t\tif ( mipmaps.length > 0 && isPowerOfTwoImage ) {\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = mipmaps.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\tmipmap = mipmaps[ i ];\r\n\t\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, i, glInternalFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ttexture.generateMipmaps = false;\r\n\t\t\t\t\ttextureProperties.__maxMipLevel = mipmaps.length - 1;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, 0, glInternalFormat, image.width, image.height, 0, glFormat, glType, image.data );\r\n\t\t\t\t\ttextureProperties.__maxMipLevel = 0;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( texture.isCompressedTexture ) {\r\n\r\n\t\t\t\tfor ( var i = 0, il = mipmaps.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\tmipmap = mipmaps[ i ];\r\n\r\n\t\t\t\t\tif ( texture.format !== RGBAFormat && texture.format !== RGBFormat ) {\r\n\r\n\t\t\t\t\t\tif ( state.getCompressedTextureFormats().indexOf( glFormat ) > - 1 ) {\r\n\r\n\t\t\t\t\t\t\tstate.compressedTexImage2D( _gl.TEXTURE_2D, i, glInternalFormat, mipmap.width, mipmap.height, 0, mipmap.data );\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()' );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, i, glInternalFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttextureProperties.__maxMipLevel = mipmaps.length - 1;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// regular Texture (image, video, canvas)\r\n\r\n\t\t\t\t// use manually created mipmaps if available\r\n\t\t\t\t// if there are no manual mipmaps\r\n\t\t\t\t// set 0 level mipmap and then use GL to generate other mipmap levels\r\n\r\n\t\t\t\tif ( mipmaps.length > 0 && isPowerOfTwoImage ) {\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = mipmaps.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\tmipmap = mipmaps[ i ];\r\n\t\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, i, glInternalFormat, glFormat, glType, mipmap );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ttexture.generateMipmaps = false;\r\n\t\t\t\t\ttextureProperties.__maxMipLevel = mipmaps.length - 1;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, 0, glInternalFormat, glFormat, glType, image );\r\n\t\t\t\t\ttextureProperties.__maxMipLevel = 0;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( textureNeedsGenerateMipmaps( texture, isPowerOfTwoImage ) ) {\r\n\r\n\t\t\t\tgenerateMipmap( _gl.TEXTURE_2D, texture, image.width, image.height );\r\n\r\n\t\t\t}\r\n\r\n\t\t\ttextureProperties.__version = texture.version;\r\n\r\n\t\t\tif ( texture.onUpdate ) texture.onUpdate( texture );\r\n\r\n\t\t}\r\n\r\n\t\t// Render targets\r\n\r\n\t\t// Setup storage for target texture and bind it to correct framebuffer\r\n\t\tfunction setupFrameBufferTexture( framebuffer, renderTarget, attachment, textureTarget ) {\r\n\r\n\t\t\tvar glFormat = utils.convert( renderTarget.texture.format );\r\n\t\t\tvar glType = utils.convert( renderTarget.texture.type );\r\n\t\t\tvar glInternalFormat = getInternalFormat( glFormat, glType );\r\n\t\t\tstate.texImage2D( textureTarget, 0, glInternalFormat, renderTarget.width, renderTarget.height, 0, glFormat, glType, null );\r\n\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, framebuffer );\r\n\t\t\t_gl.framebufferTexture2D( _gl.FRAMEBUFFER, attachment, textureTarget, properties.get( renderTarget.texture ).__webglTexture, 0 );\r\n\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, null );\r\n\r\n\t\t}\r\n\r\n\t\t// Setup storage for internal depth/stencil buffers and bind to correct framebuffer\r\n\t\tfunction setupRenderBufferStorage( renderbuffer, renderTarget ) {\r\n\r\n\t\t\t_gl.bindRenderbuffer( _gl.RENDERBUFFER, renderbuffer );\r\n\r\n\t\t\tif ( renderTarget.depthBuffer && ! renderTarget.stencilBuffer ) {\r\n\r\n\t\t\t\t_gl.renderbufferStorage( _gl.RENDERBUFFER, _gl.DEPTH_COMPONENT16, renderTarget.width, renderTarget.height );\r\n\t\t\t\t_gl.framebufferRenderbuffer( _gl.FRAMEBUFFER, _gl.DEPTH_ATTACHMENT, _gl.RENDERBUFFER, renderbuffer );\r\n\r\n\t\t\t} else if ( renderTarget.depthBuffer && renderTarget.stencilBuffer ) {\r\n\r\n\t\t\t\t_gl.renderbufferStorage( _gl.RENDERBUFFER, _gl.DEPTH_STENCIL, renderTarget.width, renderTarget.height );\r\n\t\t\t\t_gl.framebufferRenderbuffer( _gl.FRAMEBUFFER, _gl.DEPTH_STENCIL_ATTACHMENT, _gl.RENDERBUFFER, renderbuffer );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// FIXME: We don't support !depth !stencil\r\n\t\t\t\t_gl.renderbufferStorage( _gl.RENDERBUFFER, _gl.RGBA4, renderTarget.width, renderTarget.height );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_gl.bindRenderbuffer( _gl.RENDERBUFFER, null );\r\n\r\n\t\t}\r\n\r\n\t\t// Setup resources for a Depth Texture for a FBO (needs an extension)\r\n\t\tfunction setupDepthTexture( framebuffer, renderTarget ) {\r\n\r\n\t\t\tvar isCube = ( renderTarget && renderTarget.isWebGLRenderTargetCube );\r\n\t\t\tif ( isCube ) throw new Error( 'Depth Texture with cube render targets is not supported' );\r\n\r\n\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, framebuffer );\r\n\r\n\t\t\tif ( ! ( renderTarget.depthTexture && renderTarget.depthTexture.isDepthTexture ) ) {\r\n\r\n\t\t\t\tthrow new Error( 'renderTarget.depthTexture must be an instance of THREE.DepthTexture' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// upload an empty depth texture with framebuffer size\r\n\t\t\tif ( ! properties.get( renderTarget.depthTexture ).__webglTexture ||\r\n\t\t\t\t\trenderTarget.depthTexture.image.width !== renderTarget.width ||\r\n\t\t\t\t\trenderTarget.depthTexture.image.height !== renderTarget.height ) {\r\n\r\n\t\t\t\trenderTarget.depthTexture.image.width = renderTarget.width;\r\n\t\t\t\trenderTarget.depthTexture.image.height = renderTarget.height;\r\n\t\t\t\trenderTarget.depthTexture.needsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tsetTexture2D( renderTarget.depthTexture, 0 );\r\n\r\n\t\t\tvar webglDepthTexture = properties.get( renderTarget.depthTexture ).__webglTexture;\r\n\r\n\t\t\tif ( renderTarget.depthTexture.format === DepthFormat ) {\r\n\r\n\t\t\t\t_gl.framebufferTexture2D( _gl.FRAMEBUFFER, _gl.DEPTH_ATTACHMENT, _gl.TEXTURE_2D, webglDepthTexture, 0 );\r\n\r\n\t\t\t} else if ( renderTarget.depthTexture.format === DepthStencilFormat ) {\r\n\r\n\t\t\t\t_gl.framebufferTexture2D( _gl.FRAMEBUFFER, _gl.DEPTH_STENCIL_ATTACHMENT, _gl.TEXTURE_2D, webglDepthTexture, 0 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthrow new Error( 'Unknown depthTexture format' );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// Setup GL resources for a non-texture depth buffer\r\n\t\tfunction setupDepthRenderbuffer( renderTarget ) {\r\n\r\n\t\t\tvar renderTargetProperties = properties.get( renderTarget );\r\n\r\n\t\t\tvar isCube = ( renderTarget.isWebGLRenderTargetCube === true );\r\n\r\n\t\t\tif ( renderTarget.depthTexture ) {\r\n\r\n\t\t\t\tif ( isCube ) throw new Error( 'target.depthTexture not supported in Cube render targets' );\r\n\r\n\t\t\t\tsetupDepthTexture( renderTargetProperties.__webglFramebuffer, renderTarget );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif ( isCube ) {\r\n\r\n\t\t\t\t\trenderTargetProperties.__webglDepthbuffer = [];\r\n\r\n\t\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, renderTargetProperties.__webglFramebuffer[ i ] );\r\n\t\t\t\t\t\trenderTargetProperties.__webglDepthbuffer[ i ] = _gl.createRenderbuffer();\r\n\t\t\t\t\t\tsetupRenderBufferStorage( renderTargetProperties.__webglDepthbuffer[ i ], renderTarget );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, renderTargetProperties.__webglFramebuffer );\r\n\t\t\t\t\trenderTargetProperties.__webglDepthbuffer = _gl.createRenderbuffer();\r\n\t\t\t\t\tsetupRenderBufferStorage( renderTargetProperties.__webglDepthbuffer, renderTarget );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, null );\r\n\r\n\t\t}\r\n\r\n\t\t// Set up GL resources for the render target\r\n\t\tfunction setupRenderTarget( renderTarget ) {\r\n\r\n\t\t\tvar renderTargetProperties = properties.get( renderTarget );\r\n\t\t\tvar textureProperties = properties.get( renderTarget.texture );\r\n\r\n\t\t\trenderTarget.addEventListener( 'dispose', onRenderTargetDispose );\r\n\r\n\t\t\ttextureProperties.__webglTexture = _gl.createTexture();\r\n\r\n\t\t\tinfo.memory.textures ++;\r\n\r\n\t\t\tvar isCube = ( renderTarget.isWebGLRenderTargetCube === true );\r\n\t\t\tvar isTargetPowerOfTwo = isPowerOfTwo( renderTarget );\r\n\r\n\t\t\t// Setup framebuffer\r\n\r\n\t\t\tif ( isCube ) {\r\n\r\n\t\t\t\trenderTargetProperties.__webglFramebuffer = [];\r\n\r\n\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\t\trenderTargetProperties.__webglFramebuffer[ i ] = _gl.createFramebuffer();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\trenderTargetProperties.__webglFramebuffer = _gl.createFramebuffer();\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Setup color buffer\r\n\r\n\t\t\tif ( isCube ) {\r\n\r\n\t\t\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, textureProperties.__webglTexture );\r\n\t\t\t\tsetTextureParameters( _gl.TEXTURE_CUBE_MAP, renderTarget.texture, isTargetPowerOfTwo );\r\n\r\n\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\t\tsetupFrameBufferTexture( renderTargetProperties.__webglFramebuffer[ i ], renderTarget, _gl.COLOR_ATTACHMENT0, _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( textureNeedsGenerateMipmaps( renderTarget.texture, isTargetPowerOfTwo ) ) {\r\n\r\n\t\t\t\t\tgenerateMipmap( _gl.TEXTURE_CUBE_MAP, renderTarget.texture, renderTarget.width, renderTarget.height );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, null );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tstate.bindTexture( _gl.TEXTURE_2D, textureProperties.__webglTexture );\r\n\t\t\t\tsetTextureParameters( _gl.TEXTURE_2D, renderTarget.texture, isTargetPowerOfTwo );\r\n\t\t\t\tsetupFrameBufferTexture( renderTargetProperties.__webglFramebuffer, renderTarget, _gl.COLOR_ATTACHMENT0, _gl.TEXTURE_2D );\r\n\r\n\t\t\t\tif ( textureNeedsGenerateMipmaps( renderTarget.texture, isTargetPowerOfTwo ) ) {\r\n\r\n\t\t\t\t\tgenerateMipmap( _gl.TEXTURE_2D, renderTarget.texture, renderTarget.width, renderTarget.height );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tstate.bindTexture( _gl.TEXTURE_2D, null );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Setup depth and stencil buffers\r\n\r\n\t\t\tif ( renderTarget.depthBuffer ) {\r\n\r\n\t\t\t\tsetupDepthRenderbuffer( renderTarget );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction updateRenderTargetMipmap( renderTarget ) {\r\n\r\n\t\t\tvar texture = renderTarget.texture;\r\n\t\t\tvar isTargetPowerOfTwo = isPowerOfTwo( renderTarget );\r\n\r\n\t\t\tif ( textureNeedsGenerateMipmaps( texture, isTargetPowerOfTwo ) ) {\r\n\r\n\t\t\t\tvar target = renderTarget.isWebGLRenderTargetCube ? _gl.TEXTURE_CUBE_MAP : _gl.TEXTURE_2D;\r\n\t\t\t\tvar webglTexture = properties.get( texture ).__webglTexture;\r\n\r\n\t\t\t\tstate.bindTexture( target, webglTexture );\r\n\t\t\t\tgenerateMipmap( target, texture, renderTarget.width, renderTarget.height );\r\n\t\t\t\tstate.bindTexture( target, null );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction updateVideoTexture( texture ) {\r\n\r\n\t\t\tvar id = texture.id;\r\n\t\t\tvar frame = info.render.frame;\r\n\r\n\t\t\t// Check the last frame we updated the VideoTexture\r\n\r\n\t\t\tif ( _videoTextures[ id ] !== frame ) {\r\n\r\n\t\t\t\t_videoTextures[ id ] = frame;\r\n\t\t\t\ttexture.update();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tthis.setTexture2D = setTexture2D;\r\n\t\tthis.setTextureCube = setTextureCube;\r\n\t\tthis.setTextureCubeDynamic = setTextureCubeDynamic;\r\n\t\tthis.setupRenderTarget = setupRenderTarget;\r\n\t\tthis.updateRenderTargetMipmap = updateRenderTargetMipmap;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author thespite / http://www.twitter.com/thespite\r\n\t */\r\n\r\n\tfunction WebGLUtils( gl, extensions, capabilities ) {\r\n\r\n\t\tfunction convert( p ) {\r\n\r\n\t\t\tvar extension;\r\n\r\n\t\t\tif ( p === RepeatWrapping ) return gl.REPEAT;\r\n\t\t\tif ( p === ClampToEdgeWrapping ) return gl.CLAMP_TO_EDGE;\r\n\t\t\tif ( p === MirroredRepeatWrapping ) return gl.MIRRORED_REPEAT;\r\n\r\n\t\t\tif ( p === NearestFilter ) return gl.NEAREST;\r\n\t\t\tif ( p === NearestMipMapNearestFilter ) return gl.NEAREST_MIPMAP_NEAREST;\r\n\t\t\tif ( p === NearestMipMapLinearFilter ) return gl.NEAREST_MIPMAP_LINEAR;\r\n\r\n\t\t\tif ( p === LinearFilter ) return gl.LINEAR;\r\n\t\t\tif ( p === LinearMipMapNearestFilter ) return gl.LINEAR_MIPMAP_NEAREST;\r\n\t\t\tif ( p === LinearMipMapLinearFilter ) return gl.LINEAR_MIPMAP_LINEAR;\r\n\r\n\t\t\tif ( p === UnsignedByteType ) return gl.UNSIGNED_BYTE;\r\n\t\t\tif ( p === UnsignedShort4444Type ) return gl.UNSIGNED_SHORT_4_4_4_4;\r\n\t\t\tif ( p === UnsignedShort5551Type ) return gl.UNSIGNED_SHORT_5_5_5_1;\r\n\t\t\tif ( p === UnsignedShort565Type ) return gl.UNSIGNED_SHORT_5_6_5;\r\n\r\n\t\t\tif ( p === ByteType ) return gl.BYTE;\r\n\t\t\tif ( p === ShortType ) return gl.SHORT;\r\n\t\t\tif ( p === UnsignedShortType ) return gl.UNSIGNED_SHORT;\r\n\t\t\tif ( p === IntType ) return gl.INT;\r\n\t\t\tif ( p === UnsignedIntType ) return gl.UNSIGNED_INT;\r\n\t\t\tif ( p === FloatType ) return gl.FLOAT;\r\n\r\n\t\t\tif ( p === HalfFloatType ) {\r\n\r\n\t\t\t\tif ( capabilities.isWebGL2 ) return gl.HALF_FLOAT;\r\n\r\n\t\t\t\textension = extensions.get( 'OES_texture_half_float' );\r\n\r\n\t\t\t\tif ( extension !== null ) return extension.HALF_FLOAT_OES;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( p === AlphaFormat ) return gl.ALPHA;\r\n\t\t\tif ( p === RGBFormat ) return gl.RGB;\r\n\t\t\tif ( p === RGBAFormat ) return gl.RGBA;\r\n\t\t\tif ( p === LuminanceFormat ) return gl.LUMINANCE;\r\n\t\t\tif ( p === LuminanceAlphaFormat ) return gl.LUMINANCE_ALPHA;\r\n\t\t\tif ( p === DepthFormat ) return gl.DEPTH_COMPONENT;\r\n\t\t\tif ( p === DepthStencilFormat ) return gl.DEPTH_STENCIL;\r\n\r\n\t\t\tif ( p === AddEquation ) return gl.FUNC_ADD;\r\n\t\t\tif ( p === SubtractEquation ) return gl.FUNC_SUBTRACT;\r\n\t\t\tif ( p === ReverseSubtractEquation ) return gl.FUNC_REVERSE_SUBTRACT;\r\n\r\n\t\t\tif ( p === ZeroFactor ) return gl.ZERO;\r\n\t\t\tif ( p === OneFactor ) return gl.ONE;\r\n\t\t\tif ( p === SrcColorFactor ) return gl.SRC_COLOR;\r\n\t\t\tif ( p === OneMinusSrcColorFactor ) return gl.ONE_MINUS_SRC_COLOR;\r\n\t\t\tif ( p === SrcAlphaFactor ) return gl.SRC_ALPHA;\r\n\t\t\tif ( p === OneMinusSrcAlphaFactor ) return gl.ONE_MINUS_SRC_ALPHA;\r\n\t\t\tif ( p === DstAlphaFactor ) return gl.DST_ALPHA;\r\n\t\t\tif ( p === OneMinusDstAlphaFactor ) return gl.ONE_MINUS_DST_ALPHA;\r\n\r\n\t\t\tif ( p === DstColorFactor ) return gl.DST_COLOR;\r\n\t\t\tif ( p === OneMinusDstColorFactor ) return gl.ONE_MINUS_DST_COLOR;\r\n\t\t\tif ( p === SrcAlphaSaturateFactor ) return gl.SRC_ALPHA_SATURATE;\r\n\r\n\t\t\tif ( p === RGB_S3TC_DXT1_Format || p === RGBA_S3TC_DXT1_Format ||\r\n\t\t\t\tp === RGBA_S3TC_DXT3_Format || p === RGBA_S3TC_DXT5_Format ) {\r\n\r\n\t\t\t\textension = extensions.get( 'WEBGL_compressed_texture_s3tc' );\r\n\r\n\t\t\t\tif ( extension !== null ) {\r\n\r\n\t\t\t\t\tif ( p === RGB_S3TC_DXT1_Format ) return extension.COMPRESSED_RGB_S3TC_DXT1_EXT;\r\n\t\t\t\t\tif ( p === RGBA_S3TC_DXT1_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT1_EXT;\r\n\t\t\t\t\tif ( p === RGBA_S3TC_DXT3_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT3_EXT;\r\n\t\t\t\t\tif ( p === RGBA_S3TC_DXT5_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT5_EXT;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( p === RGB_PVRTC_4BPPV1_Format || p === RGB_PVRTC_2BPPV1_Format ||\r\n\t\t\t\tp === RGBA_PVRTC_4BPPV1_Format || p === RGBA_PVRTC_2BPPV1_Format ) {\r\n\r\n\t\t\t\textension = extensions.get( 'WEBGL_compressed_texture_pvrtc' );\r\n\r\n\t\t\t\tif ( extension !== null ) {\r\n\r\n\t\t\t\t\tif ( p === RGB_PVRTC_4BPPV1_Format ) return extension.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;\r\n\t\t\t\t\tif ( p === RGB_PVRTC_2BPPV1_Format ) return extension.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;\r\n\t\t\t\t\tif ( p === RGBA_PVRTC_4BPPV1_Format ) return extension.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;\r\n\t\t\t\t\tif ( p === RGBA_PVRTC_2BPPV1_Format ) return extension.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( p === RGB_ETC1_Format ) {\r\n\r\n\t\t\t\textension = extensions.get( 'WEBGL_compressed_texture_etc1' );\r\n\r\n\t\t\t\tif ( extension !== null ) return extension.COMPRESSED_RGB_ETC1_WEBGL;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( p === RGBA_ASTC_4x4_Format || p === RGBA_ASTC_5x4_Format || p === RGBA_ASTC_5x5_Format ||\r\n\t\t\t\tp === RGBA_ASTC_6x5_Format || p === RGBA_ASTC_6x6_Format || p === RGBA_ASTC_8x5_Format ||\r\n\t\t\t\tp === RGBA_ASTC_8x6_Format || p === RGBA_ASTC_8x8_Format || p === RGBA_ASTC_10x5_Format ||\r\n\t\t\t\tp === RGBA_ASTC_10x6_Format || p === RGBA_ASTC_10x8_Format || p === RGBA_ASTC_10x10_Format ||\r\n\t\t\t\tp === RGBA_ASTC_12x10_Format || p === RGBA_ASTC_12x12_Format ) {\r\n\r\n\t\t\t\textension = extensions.get( 'WEBGL_compressed_texture_astc' );\r\n\r\n\t\t\t\tif ( extension !== null ) {\r\n\r\n\t\t\t\t\treturn p;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( p === MinEquation || p === MaxEquation ) {\r\n\r\n\t\t\t\tif ( capabilities.isWebGL2 ) {\r\n\r\n\t\t\t\t\tif ( p === MinEquation ) return gl.MIN;\r\n\t\t\t\t\tif ( p === MaxEquation ) return gl.MAX;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\textension = extensions.get( 'EXT_blend_minmax' );\r\n\r\n\t\t\t\tif ( extension !== null ) {\r\n\r\n\t\t\t\t\tif ( p === MinEquation ) return extension.MIN_EXT;\r\n\t\t\t\t\tif ( p === MaxEquation ) return extension.MAX_EXT;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( p === UnsignedInt248Type ) {\r\n\r\n\t\t\t\tif ( capabilities.isWebGL2 ) return gl.UNSIGNED_INT_24_8;\r\n\r\n\t\t\t\textension = extensions.get( 'WEBGL_depth_texture' );\r\n\r\n\t\t\t\tif ( extension !== null ) return extension.UNSIGNED_INT_24_8_WEBGL;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn 0;\r\n\r\n\t\t}\r\n\r\n\t\treturn { convert: convert };\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction Group() {\r\n\r\n\t\tObject3D.call( this );\r\n\r\n\t\tthis.type = 'Group';\r\n\r\n\t}\r\n\r\n\tGroup.prototype = Object.assign( Object.create( Object3D.prototype ), {\r\n\r\n\t\tconstructor: Group,\r\n\r\n\t\tisGroup: true\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author greggman / http://games.greggman.com/\r\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\r\n\t * @author tschw\r\n\t */\r\n\r\n\tfunction PerspectiveCamera( fov, aspect, near, far ) {\r\n\r\n\t\tCamera.call( this );\r\n\r\n\t\tthis.type = 'PerspectiveCamera';\r\n\r\n\t\tthis.fov = fov !== undefined ? fov : 50;\r\n\t\tthis.zoom = 1;\r\n\r\n\t\tthis.near = near !== undefined ? near : 0.1;\r\n\t\tthis.far = far !== undefined ? far : 2000;\r\n\t\tthis.focus = 10;\r\n\r\n\t\tthis.aspect = aspect !== undefined ? aspect : 1;\r\n\t\tthis.view = null;\r\n\r\n\t\tthis.filmGauge = 35;\t// width of the film (default in millimeters)\r\n\t\tthis.filmOffset = 0;\t// horizontal film offset (same unit as gauge)\r\n\r\n\t\tthis.updateProjectionMatrix();\r\n\r\n\t}\r\n\r\n\tPerspectiveCamera.prototype = Object.assign( Object.create( Camera.prototype ), {\r\n\r\n\t\tconstructor: PerspectiveCamera,\r\n\r\n\t\tisPerspectiveCamera: true,\r\n\r\n\t\tcopy: function ( source, recursive ) {\r\n\r\n\t\t\tCamera.prototype.copy.call( this, source, recursive );\r\n\r\n\t\t\tthis.fov = source.fov;\r\n\t\t\tthis.zoom = source.zoom;\r\n\r\n\t\t\tthis.near = source.near;\r\n\t\t\tthis.far = source.far;\r\n\t\t\tthis.focus = source.focus;\r\n\r\n\t\t\tthis.aspect = source.aspect;\r\n\t\t\tthis.view = source.view === null ? null : Object.assign( {}, source.view );\r\n\r\n\t\t\tthis.filmGauge = source.filmGauge;\r\n\t\t\tthis.filmOffset = source.filmOffset;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Sets the FOV by focal length in respect to the current .filmGauge.\r\n\t\t *\r\n\t\t * The default film gauge is 35, so that the focal length can be specified for\r\n\t\t * a 35mm (full frame) camera.\r\n\t\t *\r\n\t\t * Values for focal length and film gauge must have the same unit.\r\n\t\t */\r\n\t\tsetFocalLength: function ( focalLength ) {\r\n\r\n\t\t\t// see http://www.bobatkins.com/photography/technical/field_of_view.html\r\n\t\t\tvar vExtentSlope = 0.5 * this.getFilmHeight() / focalLength;\r\n\r\n\t\t\tthis.fov = _Math.RAD2DEG * 2 * Math.atan( vExtentSlope );\r\n\t\t\tthis.updateProjectionMatrix();\r\n\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Calculates the focal length from the current .fov and .filmGauge.\r\n\t\t */\r\n\t\tgetFocalLength: function () {\r\n\r\n\t\t\tvar vExtentSlope = Math.tan( _Math.DEG2RAD * 0.5 * this.fov );\r\n\r\n\t\t\treturn 0.5 * this.getFilmHeight() / vExtentSlope;\r\n\r\n\t\t},\r\n\r\n\t\tgetEffectiveFOV: function () {\r\n\r\n\t\t\treturn _Math.RAD2DEG * 2 * Math.atan(\r\n\t\t\t\tMath.tan( _Math.DEG2RAD * 0.5 * this.fov ) / this.zoom );\r\n\r\n\t\t},\r\n\r\n\t\tgetFilmWidth: function () {\r\n\r\n\t\t\t// film not completely covered in portrait format (aspect < 1)\r\n\t\t\treturn this.filmGauge * Math.min( this.aspect, 1 );\r\n\r\n\t\t},\r\n\r\n\t\tgetFilmHeight: function () {\r\n\r\n\t\t\t// film not completely covered in landscape format (aspect > 1)\r\n\t\t\treturn this.filmGauge / Math.max( this.aspect, 1 );\r\n\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Sets an offset in a larger frustum. This is useful for multi-window or\r\n\t\t * multi-monitor/multi-machine setups.\r\n\t\t *\r\n\t\t * For example, if you have 3x2 monitors and each monitor is 1920x1080 and\r\n\t\t * the monitors are in grid like this\r\n\t\t *\r\n\t\t *   +---+---+---+\r\n\t\t *   | A | B | C |\r\n\t\t *   +---+---+---+\r\n\t\t *   | D | E | F |\r\n\t\t *   +---+---+---+\r\n\t\t *\r\n\t\t * then for each monitor you would call it like this\r\n\t\t *\r\n\t\t *   var w = 1920;\r\n\t\t *   var h = 1080;\r\n\t\t *   var fullWidth = w * 3;\r\n\t\t *   var fullHeight = h * 2;\r\n\t\t *\r\n\t\t *   --A--\r\n\t\t *   camera.setOffset( fullWidth, fullHeight, w * 0, h * 0, w, h );\r\n\t\t *   --B--\r\n\t\t *   camera.setOffset( fullWidth, fullHeight, w * 1, h * 0, w, h );\r\n\t\t *   --C--\r\n\t\t *   camera.setOffset( fullWidth, fullHeight, w * 2, h * 0, w, h );\r\n\t\t *   --D--\r\n\t\t *   camera.setOffset( fullWidth, fullHeight, w * 0, h * 1, w, h );\r\n\t\t *   --E--\r\n\t\t *   camera.setOffset( fullWidth, fullHeight, w * 1, h * 1, w, h );\r\n\t\t *   --F--\r\n\t\t *   camera.setOffset( fullWidth, fullHeight, w * 2, h * 1, w, h );\r\n\t\t *\r\n\t\t *   Note there is no reason monitors have to be the same size or in a grid.\r\n\t\t */\r\n\t\tsetViewOffset: function ( fullWidth, fullHeight, x, y, width, height ) {\r\n\r\n\t\t\tthis.aspect = fullWidth / fullHeight;\r\n\r\n\t\t\tif ( this.view === null ) {\r\n\r\n\t\t\t\tthis.view = {\r\n\t\t\t\t\tenabled: true,\r\n\t\t\t\t\tfullWidth: 1,\r\n\t\t\t\t\tfullHeight: 1,\r\n\t\t\t\t\toffsetX: 0,\r\n\t\t\t\t\toffsetY: 0,\r\n\t\t\t\t\twidth: 1,\r\n\t\t\t\t\theight: 1\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.view.enabled = true;\r\n\t\t\tthis.view.fullWidth = fullWidth;\r\n\t\t\tthis.view.fullHeight = fullHeight;\r\n\t\t\tthis.view.offsetX = x;\r\n\t\t\tthis.view.offsetY = y;\r\n\t\t\tthis.view.width = width;\r\n\t\t\tthis.view.height = height;\r\n\r\n\t\t\tthis.updateProjectionMatrix();\r\n\r\n\t\t},\r\n\r\n\t\tclearViewOffset: function () {\r\n\r\n\t\t\tif ( this.view !== null ) {\r\n\r\n\t\t\t\tthis.view.enabled = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.updateProjectionMatrix();\r\n\r\n\t\t},\r\n\r\n\t\tupdateProjectionMatrix: function () {\r\n\r\n\t\t\tvar near = this.near,\r\n\t\t\t\ttop = near * Math.tan( _Math.DEG2RAD * 0.5 * this.fov ) / this.zoom,\r\n\t\t\t\theight = 2 * top,\r\n\t\t\t\twidth = this.aspect * height,\r\n\t\t\t\tleft = - 0.5 * width,\r\n\t\t\t\tview = this.view;\r\n\r\n\t\t\tif ( this.view !== null && this.view.enabled ) {\r\n\r\n\t\t\t\tvar fullWidth = view.fullWidth,\r\n\t\t\t\t\tfullHeight = view.fullHeight;\r\n\r\n\t\t\t\tleft += view.offsetX * width / fullWidth;\r\n\t\t\t\ttop -= view.offsetY * height / fullHeight;\r\n\t\t\t\twidth *= view.width / fullWidth;\r\n\t\t\t\theight *= view.height / fullHeight;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar skew = this.filmOffset;\r\n\t\t\tif ( skew !== 0 ) left += near * skew / this.getFilmWidth();\r\n\r\n\t\t\tthis.projectionMatrix.makePerspective( left, left + width, top, top - height, near, this.far );\r\n\r\n\t\t\tthis.projectionMatrixInverse.getInverse( this.projectionMatrix );\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function ( meta ) {\r\n\r\n\t\t\tvar data = Object3D.prototype.toJSON.call( this, meta );\r\n\r\n\t\t\tdata.object.fov = this.fov;\r\n\t\t\tdata.object.zoom = this.zoom;\r\n\r\n\t\t\tdata.object.near = this.near;\r\n\t\t\tdata.object.far = this.far;\r\n\t\t\tdata.object.focus = this.focus;\r\n\r\n\t\t\tdata.object.aspect = this.aspect;\r\n\r\n\t\t\tif ( this.view !== null ) data.object.view = Object.assign( {}, this.view );\r\n\r\n\t\t\tdata.object.filmGauge = this.filmGauge;\r\n\t\t\tdata.object.filmOffset = this.filmOffset;\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction ArrayCamera( array ) {\r\n\r\n\t\tPerspectiveCamera.call( this );\r\n\r\n\t\tthis.cameras = array || [];\r\n\r\n\t}\r\n\r\n\tArrayCamera.prototype = Object.assign( Object.create( PerspectiveCamera.prototype ), {\r\n\r\n\t\tconstructor: ArrayCamera,\r\n\r\n\t\tisArrayCamera: true\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction WebVRManager( renderer ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar device = null;\r\n\t\tvar frameData = null;\r\n\r\n\t\tvar poseTarget = null;\r\n\r\n\t\tvar controllers = [];\r\n\t\tvar standingMatrix = new Matrix4();\r\n\t\tvar standingMatrixInverse = new Matrix4();\r\n\r\n\t\tif ( typeof window !== 'undefined' && 'VRFrameData' in window ) {\r\n\r\n\t\t\tframeData = new window.VRFrameData();\r\n\t\t\twindow.addEventListener( 'vrdisplaypresentchange', onVRDisplayPresentChange, false );\r\n\r\n\t\t}\r\n\r\n\t\tvar matrixWorldInverse = new Matrix4();\r\n\t\tvar tempQuaternion = new Quaternion();\r\n\t\tvar tempPosition = new Vector3();\r\n\r\n\t\tvar cameraL = new PerspectiveCamera();\r\n\t\tcameraL.bounds = new Vector4( 0.0, 0.0, 0.5, 1.0 );\r\n\t\tcameraL.layers.enable( 1 );\r\n\r\n\t\tvar cameraR = new PerspectiveCamera();\r\n\t\tcameraR.bounds = new Vector4( 0.5, 0.0, 0.5, 1.0 );\r\n\t\tcameraR.layers.enable( 2 );\r\n\r\n\t\tvar cameraVR = new ArrayCamera( [ cameraL, cameraR ] );\r\n\t\tcameraVR.layers.enable( 1 );\r\n\t\tcameraVR.layers.enable( 2 );\r\n\r\n\t\t//\r\n\r\n\t\tfunction isPresenting() {\r\n\r\n\t\t\treturn device !== null && device.isPresenting === true;\r\n\r\n\t\t}\r\n\r\n\t\tvar currentSize, currentPixelRatio;\r\n\r\n\t\tfunction onVRDisplayPresentChange() {\r\n\r\n\t\t\tif ( isPresenting() ) {\r\n\r\n\t\t\t\tvar eyeParameters = device.getEyeParameters( 'left' );\r\n\t\t\t\tvar renderWidth = eyeParameters.renderWidth;\r\n\t\t\t\tvar renderHeight = eyeParameters.renderHeight;\r\n\r\n\t\t\t\tcurrentPixelRatio = renderer.getPixelRatio();\r\n\t\t\t\tcurrentSize = renderer.getSize();\r\n\r\n\t\t\t\trenderer.setDrawingBufferSize( renderWidth * 2, renderHeight, 1 );\r\n\r\n\t\t\t\tanimation.start();\r\n\r\n\t\t\t} else if ( scope.enabled ) {\r\n\r\n\t\t\t\trenderer.setDrawingBufferSize( currentSize.width, currentSize.height, currentPixelRatio );\r\n\r\n\t\t\t\tanimation.stop();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tvar triggers = [];\r\n\r\n\t\tfunction findGamepad( id ) {\r\n\r\n\t\t\tvar gamepads = navigator.getGamepads && navigator.getGamepads();\r\n\r\n\t\t\tfor ( var i = 0, j = 0, l = gamepads.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar gamepad = gamepads[ i ];\r\n\r\n\t\t\t\tif ( gamepad && ( gamepad.id === 'Daydream Controller' ||\r\n\t\t\t\t\tgamepad.id === 'Gear VR Controller' || gamepad.id === 'Oculus Go Controller' ||\r\n\t\t\t\t\tgamepad.id === 'OpenVR Gamepad' || gamepad.id.startsWith( 'Oculus Touch' ) ||\r\n\t\t\t\t\tgamepad.id.startsWith( 'Spatial Controller' ) ) ) {\r\n\r\n\t\t\t\t\tif ( j === id ) return gamepad;\r\n\r\n\t\t\t\t\tj ++;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction updateControllers() {\r\n\r\n\t\t\tfor ( var i = 0; i < controllers.length; i ++ ) {\r\n\r\n\t\t\t\tvar controller = controllers[ i ];\r\n\r\n\t\t\t\tvar gamepad = findGamepad( i );\r\n\r\n\t\t\t\tif ( gamepad !== undefined && gamepad.pose !== undefined ) {\r\n\r\n\t\t\t\t\tif ( gamepad.pose === null ) return;\r\n\r\n\t\t\t\t\t//  Pose\r\n\r\n\t\t\t\t\tvar pose = gamepad.pose;\r\n\r\n\t\t\t\t\tif ( pose.hasPosition === false ) controller.position.set( 0.2, - 0.6, - 0.05 );\r\n\r\n\t\t\t\t\tif ( pose.position !== null ) controller.position.fromArray( pose.position );\r\n\t\t\t\t\tif ( pose.orientation !== null ) controller.quaternion.fromArray( pose.orientation );\r\n\t\t\t\t\tcontroller.matrix.compose( controller.position, controller.quaternion, controller.scale );\r\n\t\t\t\t\tcontroller.matrix.premultiply( standingMatrix );\r\n\t\t\t\t\tcontroller.matrix.decompose( controller.position, controller.quaternion, controller.scale );\r\n\t\t\t\t\tcontroller.matrixWorldNeedsUpdate = true;\r\n\t\t\t\t\tcontroller.visible = true;\r\n\r\n\t\t\t\t\t//  Trigger\r\n\r\n\t\t\t\t\tvar buttonId = gamepad.id === 'Daydream Controller' ? 0 : 1;\r\n\r\n\t\t\t\t\tif ( triggers[ i ] !== gamepad.buttons[ buttonId ].pressed ) {\r\n\r\n\t\t\t\t\t\ttriggers[ i ] = gamepad.buttons[ buttonId ].pressed;\r\n\r\n\t\t\t\t\t\tif ( triggers[ i ] === true ) {\r\n\r\n\t\t\t\t\t\t\tcontroller.dispatchEvent( { type: 'selectstart' } );\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tcontroller.dispatchEvent( { type: 'selectend' } );\r\n\t\t\t\t\t\t\tcontroller.dispatchEvent( { type: 'select' } );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tcontroller.visible = false;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tthis.enabled = false;\r\n\t\tthis.userHeight = 1.6;\r\n\r\n\t\tthis.getController = function ( id ) {\r\n\r\n\t\t\tvar controller = controllers[ id ];\r\n\r\n\t\t\tif ( controller === undefined ) {\r\n\r\n\t\t\t\tcontroller = new Group();\r\n\t\t\t\tcontroller.matrixAutoUpdate = false;\r\n\t\t\t\tcontroller.visible = false;\r\n\r\n\t\t\t\tcontrollers[ id ] = controller;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn controller;\r\n\r\n\t\t};\r\n\r\n\t\tthis.getDevice = function () {\r\n\r\n\t\t\treturn device;\r\n\r\n\t\t};\r\n\r\n\t\tthis.setDevice = function ( value ) {\r\n\r\n\t\t\tif ( value !== undefined ) device = value;\r\n\r\n\t\t\tanimation.setContext( value );\r\n\r\n\t\t};\r\n\r\n\t\tthis.setPoseTarget = function ( object ) {\r\n\r\n\t\t\tif ( object !== undefined ) poseTarget = object;\r\n\r\n\t\t};\r\n\r\n\t\tthis.getCamera = function ( camera ) {\r\n\r\n\t\t\tif ( device === null ) {\r\n\r\n\t\t\t\tcamera.position.set( 0, scope.userHeight, 0 );\r\n\t\t\t\treturn camera;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tdevice.depthNear = camera.near;\r\n\t\t\tdevice.depthFar = camera.far;\r\n\r\n\t\t\tdevice.getFrameData( frameData );\r\n\r\n\t\t\t//\r\n\r\n\t\t\tvar stageParameters = device.stageParameters;\r\n\r\n\t\t\tif ( stageParameters ) {\r\n\r\n\t\t\t\tstandingMatrix.fromArray( stageParameters.sittingToStandingTransform );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tstandingMatrix.makeTranslation( 0, scope.userHeight, 0 );\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\tvar pose = frameData.pose;\r\n\t\t\tvar poseObject = poseTarget !== null ? poseTarget : camera;\r\n\r\n\t\t\t// We want to manipulate poseObject by its position and quaternion components since users may rely on them.\r\n\t\t\tposeObject.matrix.copy( standingMatrix );\r\n\t\t\tposeObject.matrix.decompose( poseObject.position, poseObject.quaternion, poseObject.scale );\r\n\r\n\t\t\tif ( pose.orientation !== null ) {\r\n\r\n\t\t\t\ttempQuaternion.fromArray( pose.orientation );\r\n\t\t\t\tposeObject.quaternion.multiply( tempQuaternion );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( pose.position !== null ) {\r\n\r\n\t\t\t\ttempQuaternion.setFromRotationMatrix( standingMatrix );\r\n\t\t\t\ttempPosition.fromArray( pose.position );\r\n\t\t\t\ttempPosition.applyQuaternion( tempQuaternion );\r\n\t\t\t\tposeObject.position.add( tempPosition );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tposeObject.updateMatrixWorld();\r\n\r\n\t\t\tif ( device.isPresenting === false ) return camera;\r\n\r\n\t\t\t//\r\n\r\n\t\t\tcameraL.near = camera.near;\r\n\t\t\tcameraR.near = camera.near;\r\n\r\n\t\t\tcameraL.far = camera.far;\r\n\t\t\tcameraR.far = camera.far;\r\n\r\n\t\t\tcameraVR.matrixWorld.copy( camera.matrixWorld );\r\n\t\t\tcameraVR.matrixWorldInverse.copy( camera.matrixWorldInverse );\r\n\r\n\t\t\tcameraL.matrixWorldInverse.fromArray( frameData.leftViewMatrix );\r\n\t\t\tcameraR.matrixWorldInverse.fromArray( frameData.rightViewMatrix );\r\n\r\n\t\t\t// TODO (mrdoob) Double check this code\r\n\r\n\t\t\tstandingMatrixInverse.getInverse( standingMatrix );\r\n\r\n\t\t\tcameraL.matrixWorldInverse.multiply( standingMatrixInverse );\r\n\t\t\tcameraR.matrixWorldInverse.multiply( standingMatrixInverse );\r\n\r\n\t\t\tvar parent = poseObject.parent;\r\n\r\n\t\t\tif ( parent !== null ) {\r\n\r\n\t\t\t\tmatrixWorldInverse.getInverse( parent.matrixWorld );\r\n\r\n\t\t\t\tcameraL.matrixWorldInverse.multiply( matrixWorldInverse );\r\n\t\t\t\tcameraR.matrixWorldInverse.multiply( matrixWorldInverse );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// envMap and Mirror needs camera.matrixWorld\r\n\r\n\t\t\tcameraL.matrixWorld.getInverse( cameraL.matrixWorldInverse );\r\n\t\t\tcameraR.matrixWorld.getInverse( cameraR.matrixWorldInverse );\r\n\r\n\t\t\tcameraL.projectionMatrix.fromArray( frameData.leftProjectionMatrix );\r\n\t\t\tcameraR.projectionMatrix.fromArray( frameData.rightProjectionMatrix );\r\n\r\n\t\t\t// HACK (mrdoob)\r\n\t\t\t// https://github.com/w3c/webvr/issues/203\r\n\r\n\t\t\tcameraVR.projectionMatrix.copy( cameraL.projectionMatrix );\r\n\r\n\t\t\t//\r\n\r\n\t\t\tvar layers = device.getLayers();\r\n\r\n\t\t\tif ( layers.length ) {\r\n\r\n\t\t\t\tvar layer = layers[ 0 ];\r\n\r\n\t\t\t\tif ( layer.leftBounds !== null && layer.leftBounds.length === 4 ) {\r\n\r\n\t\t\t\t\tcameraL.bounds.fromArray( layer.leftBounds );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( layer.rightBounds !== null && layer.rightBounds.length === 4 ) {\r\n\r\n\t\t\t\t\tcameraR.bounds.fromArray( layer.rightBounds );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tupdateControllers();\r\n\r\n\t\t\treturn cameraVR;\r\n\r\n\t\t};\r\n\r\n\t\tthis.getStandingMatrix = function () {\r\n\r\n\t\t\treturn standingMatrix;\r\n\r\n\t\t};\r\n\r\n\t\tthis.isPresenting = isPresenting;\r\n\r\n\t\t// Animation Loop\r\n\r\n\t\tvar animation = new WebGLAnimation();\r\n\r\n\t\tthis.setAnimationLoop = function ( callback ) {\r\n\r\n\t\t\tanimation.setAnimationLoop( callback );\r\n\r\n\t\t};\r\n\r\n\t\tthis.submitFrame = function () {\r\n\r\n\t\t\tif ( isPresenting() ) device.submitFrame();\r\n\r\n\t\t};\r\n\r\n\t\tthis.dispose = function () {\r\n\r\n\t\t\tif ( typeof window !== 'undefined' ) {\r\n\r\n\t\t\t\twindow.removeEventListener( 'vrdisplaypresentchange', onVRDisplayPresentChange );\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction WebXRManager( renderer ) {\r\n\r\n\t\tvar gl = renderer.context;\r\n\r\n\t\tvar device = null;\r\n\t\tvar session = null;\r\n\r\n\t\tvar frameOfRef = null;\r\n\r\n\t\tvar pose = null;\r\n\r\n\t\tvar controllers = [];\r\n\t\tvar inputSources = [];\r\n\r\n\t\tfunction isPresenting() {\r\n\r\n\t\t\treturn session !== null && frameOfRef !== null;\r\n\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tvar cameraL = new PerspectiveCamera();\r\n\t\tcameraL.layers.enable( 1 );\r\n\t\tcameraL.viewport = new Vector4();\r\n\r\n\t\tvar cameraR = new PerspectiveCamera();\r\n\t\tcameraR.layers.enable( 2 );\r\n\t\tcameraR.viewport = new Vector4();\r\n\r\n\t\tvar cameraVR = new ArrayCamera( [ cameraL, cameraR ] );\r\n\t\tcameraVR.layers.enable( 1 );\r\n\t\tcameraVR.layers.enable( 2 );\r\n\r\n\t\t//\r\n\r\n\t\tthis.enabled = false;\r\n\r\n\t\tthis.getController = function ( id ) {\r\n\r\n\t\t\tvar controller = controllers[ id ];\r\n\r\n\t\t\tif ( controller === undefined ) {\r\n\r\n\t\t\t\tcontroller = new Group();\r\n\t\t\t\tcontroller.matrixAutoUpdate = false;\r\n\t\t\t\tcontroller.visible = false;\r\n\r\n\t\t\t\tcontrollers[ id ] = controller;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn controller;\r\n\r\n\t\t};\r\n\r\n\t\tthis.getDevice = function () {\r\n\r\n\t\t\treturn device;\r\n\r\n\t\t};\r\n\r\n\t\tthis.setDevice = function ( value ) {\r\n\r\n\t\t\tif ( value !== undefined ) device = value;\r\n\t\t\tif ( value instanceof XRDevice ) gl.setCompatibleXRDevice( value );\r\n\r\n\t\t};\r\n\r\n\t\t//\r\n\r\n\t\tfunction onSessionEvent( event ) {\r\n\r\n\t\t\tvar controller = controllers[ inputSources.indexOf( event.inputSource ) ];\r\n\t\t\tif ( controller ) controller.dispatchEvent( { type: event.type } );\r\n\r\n\t\t}\r\n\r\n\t\tfunction onSessionEnd() {\r\n\r\n\t\t\trenderer.setFramebuffer( null );\r\n\t\t\tanimation.stop();\r\n\r\n\t\t}\r\n\r\n\t\tthis.setSession = function ( value, options ) {\r\n\r\n\t\t\tsession = value;\r\n\r\n\t\t\tif ( session !== null ) {\r\n\r\n\t\t\t\tsession.addEventListener( 'select', onSessionEvent );\r\n\t\t\t\tsession.addEventListener( 'selectstart', onSessionEvent );\r\n\t\t\t\tsession.addEventListener( 'selectend', onSessionEvent );\r\n\t\t\t\tsession.addEventListener( 'end', onSessionEnd );\r\n\r\n\t\t\t\tsession.baseLayer = new XRWebGLLayer( session, gl );\r\n\t\t\t\tsession.requestFrameOfReference( options.frameOfReferenceType ).then( function ( value ) {\r\n\r\n\t\t\t\t\tframeOfRef = value;\r\n\r\n\t\t\t\t\trenderer.setFramebuffer( session.baseLayer.framebuffer );\r\n\r\n\t\t\t\t\tanimation.setContext( session );\r\n\t\t\t\t\tanimation.start();\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t\t//\r\n\r\n\t\t\t\tinputSources = session.getInputSources();\r\n\r\n\t\t\t\tsession.addEventListener( 'inputsourceschange', function () {\r\n\r\n\t\t\t\t\tinputSources = session.getInputSources();\r\n\t\t\t\t\tconsole.log( inputSources );\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t\tfunction updateCamera( camera, parent ) {\r\n\r\n\t\t\tif ( parent === null ) {\r\n\r\n\t\t\t\tcamera.matrixWorld.copy( camera.matrix );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tcamera.matrixWorld.multiplyMatrices( parent.matrixWorld, camera.matrix );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcamera.matrixWorldInverse.getInverse( camera.matrixWorld );\r\n\r\n\t\t}\r\n\r\n\t\tthis.getCamera = function ( camera ) {\r\n\r\n\t\t\tif ( isPresenting() ) {\r\n\r\n\t\t\t\tvar parent = camera.parent;\r\n\t\t\t\tvar cameras = cameraVR.cameras;\r\n\r\n\t\t\t\t// apply camera.parent to cameraVR\r\n\r\n\t\t\t\tupdateCamera( cameraVR, parent );\r\n\r\n\t\t\t\tfor ( var i = 0; i < cameras.length; i ++ ) {\r\n\r\n\t\t\t\t\tupdateCamera( cameras[ i ], parent );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// update camera and its children\r\n\r\n\t\t\t\tcamera.matrixWorld.copy( cameraVR.matrixWorld );\r\n\r\n\t\t\t\tvar children = camera.children;\r\n\r\n\t\t\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tchildren[ i ].updateMatrixWorld( true );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn cameraVR;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn camera;\r\n\r\n\t\t};\r\n\r\n\t\tthis.isPresenting = isPresenting;\r\n\r\n\t\t// Animation Loop\r\n\r\n\t\tvar onAnimationFrameCallback = null;\r\n\r\n\t\tfunction onAnimationFrame( time, frame ) {\r\n\r\n\t\t\tpose = frame.getDevicePose( frameOfRef );\r\n\r\n\t\t\tif ( pose !== null ) {\r\n\r\n\t\t\t\tvar layer = session.baseLayer;\r\n\t\t\t\tvar views = frame.views;\r\n\r\n\t\t\t\tfor ( var i = 0; i < views.length; i ++ ) {\r\n\r\n\t\t\t\t\tvar view = views[ i ];\r\n\t\t\t\t\tvar viewport = layer.getViewport( view );\r\n\t\t\t\t\tvar viewMatrix = pose.getViewMatrix( view );\r\n\r\n\t\t\t\t\tvar camera = cameraVR.cameras[ i ];\r\n\t\t\t\t\tcamera.matrix.fromArray( viewMatrix ).getInverse( camera.matrix );\r\n\t\t\t\t\tcamera.projectionMatrix.fromArray( view.projectionMatrix );\r\n\t\t\t\t\tcamera.viewport.set( viewport.x, viewport.y, viewport.width, viewport.height );\r\n\r\n\t\t\t\t\tif ( i === 0 ) {\r\n\r\n\t\t\t\t\t\tcameraVR.matrix.copy( camera.matrix );\r\n\r\n\t\t\t\t\t\t// HACK (mrdoob)\r\n\t\t\t\t\t\t// https://github.com/w3c/webvr/issues/203\r\n\r\n\t\t\t\t\t\tcameraVR.projectionMatrix.copy( camera.projectionMatrix );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tfor ( var i = 0; i < controllers.length; i ++ ) {\r\n\r\n\t\t\t\tvar controller = controllers[ i ];\r\n\r\n\t\t\t\tvar inputSource = inputSources[ i ];\r\n\r\n\t\t\t\tif ( inputSource ) {\r\n\r\n\t\t\t\t\tvar inputPose = frame.getInputPose( inputSource, frameOfRef );\r\n\r\n\t\t\t\t\tif ( inputPose !== null ) {\r\n\r\n\t\t\t\t\t\tif ( 'targetRay' in inputPose ) {\r\n\r\n\t\t\t\t\t\t\tcontroller.matrix.elements = inputPose.targetRay.transformMatrix;\r\n\r\n\t\t\t\t\t\t} else if ( 'pointerMatrix' in inputPose ) {\r\n\r\n\t\t\t\t\t\t\t// DEPRECATED\r\n\r\n\t\t\t\t\t\t\tcontroller.matrix.elements = inputPose.pointerMatrix;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tcontroller.matrix.decompose( controller.position, controller.rotation, controller.scale );\r\n\t\t\t\t\t\tcontroller.visible = true;\r\n\r\n\t\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcontroller.visible = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( onAnimationFrameCallback ) onAnimationFrameCallback( time );\r\n\r\n\t\t}\r\n\r\n\t\tvar animation = new WebGLAnimation();\r\n\t\tanimation.setAnimationLoop( onAnimationFrame );\r\n\r\n\t\tthis.setAnimationLoop = function ( callback ) {\r\n\r\n\t\t\tonAnimationFrameCallback = callback;\r\n\r\n\t\t};\r\n\r\n\t\tthis.dispose = function () {};\r\n\r\n\t\t// DEPRECATED\r\n\r\n\t\tthis.getStandingMatrix = function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebXRManager: getStandingMatrix() is no longer needed.' );\r\n\t\t\treturn new THREE.Matrix4();\r\n\r\n\t\t};\r\n\r\n\t\tthis.submitFrame = function () {};\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author supereggbert / http://www.paulbrunt.co.uk/\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author szimek / https://github.com/szimek/\r\n\t * @author tschw\r\n\t */\r\n\r\n\tfunction WebGLRenderer( parameters ) {\r\n\r\n\t\tconsole.log( 'THREE.WebGLRenderer', REVISION );\r\n\r\n\t\tparameters = parameters || {};\r\n\r\n\t\tvar _canvas = parameters.canvas !== undefined ? parameters.canvas : document.createElementNS( 'http://www.w3.org/1999/xhtml', 'canvas' ),\r\n\t\t\t_context = parameters.context !== undefined ? parameters.context : null,\r\n\r\n\t\t\t_alpha = parameters.alpha !== undefined ? parameters.alpha : false,\r\n\t\t\t_depth = parameters.depth !== undefined ? parameters.depth : true,\r\n\t\t\t_stencil = parameters.stencil !== undefined ? parameters.stencil : true,\r\n\t\t\t_antialias = parameters.antialias !== undefined ? parameters.antialias : false,\r\n\t\t\t_premultipliedAlpha = parameters.premultipliedAlpha !== undefined ? parameters.premultipliedAlpha : true,\r\n\t\t\t_preserveDrawingBuffer = parameters.preserveDrawingBuffer !== undefined ? parameters.preserveDrawingBuffer : false,\r\n\t\t\t_powerPreference = parameters.powerPreference !== undefined ? parameters.powerPreference : 'default';\r\n\r\n\t\tvar currentRenderList = null;\r\n\t\tvar currentRenderState = null;\r\n\r\n\t\t// public properties\r\n\r\n\t\tthis.domElement = _canvas;\r\n\t\tthis.context = null;\r\n\r\n\t\t// clearing\r\n\r\n\t\tthis.autoClear = true;\r\n\t\tthis.autoClearColor = true;\r\n\t\tthis.autoClearDepth = true;\r\n\t\tthis.autoClearStencil = true;\r\n\r\n\t\t// scene graph\r\n\r\n\t\tthis.sortObjects = true;\r\n\r\n\t\t// user-defined clipping\r\n\r\n\t\tthis.clippingPlanes = [];\r\n\t\tthis.localClippingEnabled = false;\r\n\r\n\t\t// physically based shading\r\n\r\n\t\tthis.gammaFactor = 2.0;\t// for backwards compatibility\r\n\t\tthis.gammaInput = false;\r\n\t\tthis.gammaOutput = false;\r\n\r\n\t\t// physical lights\r\n\r\n\t\tthis.physicallyCorrectLights = false;\r\n\r\n\t\t// tone mapping\r\n\r\n\t\tthis.toneMapping = LinearToneMapping;\r\n\t\tthis.toneMappingExposure = 1.0;\r\n\t\tthis.toneMappingWhitePoint = 1.0;\r\n\r\n\t\t// morphs\r\n\r\n\t\tthis.maxMorphTargets = 8;\r\n\t\tthis.maxMorphNormals = 4;\r\n\r\n\t\t// internal properties\r\n\r\n\t\tvar _this = this,\r\n\r\n\t\t\t_isContextLost = false,\r\n\r\n\t\t\t// internal state cache\r\n\r\n\t\t\t_framebuffer = null,\r\n\r\n\t\t\t_currentRenderTarget = null,\r\n\t\t\t_currentFramebuffer = null,\r\n\t\t\t_currentMaterialId = - 1,\r\n\r\n\t\t\t// geometry and program caching\r\n\r\n\t\t\t_currentGeometryProgram = {\r\n\t\t\t\tgeometry: null,\r\n\t\t\t\tprogram: null,\r\n\t\t\t\twireframe: false\r\n\t\t\t},\r\n\r\n\t\t\t_currentCamera = null,\r\n\t\t\t_currentArrayCamera = null,\r\n\r\n\t\t\t_currentViewport = new Vector4(),\r\n\t\t\t_currentScissor = new Vector4(),\r\n\t\t\t_currentScissorTest = null,\r\n\r\n\t\t\t//\r\n\r\n\t\t\t_usedTextureUnits = 0,\r\n\r\n\t\t\t//\r\n\r\n\t\t\t_width = _canvas.width,\r\n\t\t\t_height = _canvas.height,\r\n\r\n\t\t\t_pixelRatio = 1,\r\n\r\n\t\t\t_viewport = new Vector4( 0, 0, _width, _height ),\r\n\t\t\t_scissor = new Vector4( 0, 0, _width, _height ),\r\n\t\t\t_scissorTest = false,\r\n\r\n\t\t\t// frustum\r\n\r\n\t\t\t_frustum = new Frustum(),\r\n\r\n\t\t\t// clipping\r\n\r\n\t\t\t_clipping = new WebGLClipping(),\r\n\t\t\t_clippingEnabled = false,\r\n\t\t\t_localClippingEnabled = false,\r\n\r\n\t\t\t// camera matrices cache\r\n\r\n\t\t\t_projScreenMatrix = new Matrix4(),\r\n\r\n\t\t\t_vector3 = new Vector3();\r\n\r\n\t\tfunction getTargetPixelRatio() {\r\n\r\n\t\t\treturn _currentRenderTarget === null ? _pixelRatio : 1;\r\n\r\n\t\t}\r\n\r\n\t\t// initialize\r\n\r\n\t\tvar _gl;\r\n\r\n\t\ttry {\r\n\r\n\t\t\tvar contextAttributes = {\r\n\t\t\t\talpha: _alpha,\r\n\t\t\t\tdepth: _depth,\r\n\t\t\t\tstencil: _stencil,\r\n\t\t\t\tantialias: _antialias,\r\n\t\t\t\tpremultipliedAlpha: _premultipliedAlpha,\r\n\t\t\t\tpreserveDrawingBuffer: _preserveDrawingBuffer,\r\n\t\t\t\tpowerPreference: _powerPreference\r\n\t\t\t};\r\n\r\n\t\t\t// event listeners must be registered before WebGL context is created, see #12753\r\n\r\n\t\t\t_canvas.addEventListener( 'webglcontextlost', onContextLost, false );\r\n\t\t\t_canvas.addEventListener( 'webglcontextrestored', onContextRestore, false );\r\n\r\n\t\t\t_gl = _context || _canvas.getContext( 'webgl', contextAttributes ) || _canvas.getContext( 'experimental-webgl', contextAttributes );\r\n\r\n\t\t\tif ( _gl === null ) {\r\n\r\n\t\t\t\tif ( _canvas.getContext( 'webgl' ) !== null ) {\r\n\r\n\t\t\t\t\tthrow new Error( 'Error creating WebGL context with your selected attributes.' );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tthrow new Error( 'Error creating WebGL context.' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Some experimental-webgl implementations do not have getShaderPrecisionFormat\r\n\r\n\t\t\tif ( _gl.getShaderPrecisionFormat === undefined ) {\r\n\r\n\t\t\t\t_gl.getShaderPrecisionFormat = function () {\r\n\r\n\t\t\t\t\treturn { 'rangeMin': 1, 'rangeMax': 1, 'precision': 1 };\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t} catch ( error ) {\r\n\r\n\t\t\tconsole.error( 'THREE.WebGLRenderer: ' + error.message );\r\n\r\n\t\t}\r\n\r\n\t\tvar extensions, capabilities, state, info;\r\n\t\tvar properties, textures, attributes, geometries, objects;\r\n\t\tvar programCache, renderLists, renderStates;\r\n\r\n\t\tvar background, morphtargets, bufferRenderer, indexedBufferRenderer;\r\n\r\n\t\tvar utils;\r\n\r\n\t\tfunction initGLContext() {\r\n\r\n\t\t\textensions = new WebGLExtensions( _gl );\r\n\r\n\t\t\tcapabilities = new WebGLCapabilities( _gl, extensions, parameters );\r\n\r\n\t\t\tif ( ! capabilities.isWebGL2 ) {\r\n\r\n\t\t\t\textensions.get( 'WEBGL_depth_texture' );\r\n\t\t\t\textensions.get( 'OES_texture_float' );\r\n\t\t\t\textensions.get( 'OES_texture_half_float' );\r\n\t\t\t\textensions.get( 'OES_texture_half_float_linear' );\r\n\t\t\t\textensions.get( 'OES_standard_derivatives' );\r\n\t\t\t\textensions.get( 'OES_element_index_uint' );\r\n\t\t\t\textensions.get( 'ANGLE_instanced_arrays' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\textensions.get( 'OES_texture_float_linear' );\r\n\r\n\t\t\tutils = new WebGLUtils( _gl, extensions, capabilities );\r\n\r\n\t\t\tstate = new WebGLState( _gl, extensions, utils, capabilities );\r\n\t\t\tstate.scissor( _currentScissor.copy( _scissor ).multiplyScalar( _pixelRatio ) );\r\n\t\t\tstate.viewport( _currentViewport.copy( _viewport ).multiplyScalar( _pixelRatio ) );\r\n\r\n\t\t\tinfo = new WebGLInfo( _gl );\r\n\t\t\tproperties = new WebGLProperties();\r\n\t\t\ttextures = new WebGLTextures( _gl, extensions, state, properties, capabilities, utils, info );\r\n\t\t\tattributes = new WebGLAttributes( _gl );\r\n\t\t\tgeometries = new WebGLGeometries( _gl, attributes, info );\r\n\t\t\tobjects = new WebGLObjects( geometries, info );\r\n\t\t\tmorphtargets = new WebGLMorphtargets( _gl );\r\n\t\t\tprogramCache = new WebGLPrograms( _this, extensions, capabilities );\r\n\t\t\trenderLists = new WebGLRenderLists();\r\n\t\t\trenderStates = new WebGLRenderStates();\r\n\r\n\t\t\tbackground = new WebGLBackground( _this, state, objects, _premultipliedAlpha );\r\n\r\n\t\t\tbufferRenderer = new WebGLBufferRenderer( _gl, extensions, info, capabilities );\r\n\t\t\tindexedBufferRenderer = new WebGLIndexedBufferRenderer( _gl, extensions, info, capabilities );\r\n\r\n\t\t\tinfo.programs = programCache.programs;\r\n\r\n\t\t\t_this.context = _gl;\r\n\t\t\t_this.capabilities = capabilities;\r\n\t\t\t_this.extensions = extensions;\r\n\t\t\t_this.properties = properties;\r\n\t\t\t_this.renderLists = renderLists;\r\n\t\t\t_this.state = state;\r\n\t\t\t_this.info = info;\r\n\r\n\t\t}\r\n\r\n\t\tinitGLContext();\r\n\r\n\t\t// vr\r\n\r\n\t\tvar vr = ( 'xr' in navigator ) ? new WebXRManager( _this ) : new WebVRManager( _this );\r\n\r\n\t\tthis.vr = vr;\r\n\r\n\t\t// shadow map\r\n\r\n\t\tvar shadowMap = new WebGLShadowMap( _this, objects, capabilities.maxTextureSize );\r\n\r\n\t\tthis.shadowMap = shadowMap;\r\n\r\n\t\t// API\r\n\r\n\t\tthis.getContext = function () {\r\n\r\n\t\t\treturn _gl;\r\n\r\n\t\t};\r\n\r\n\t\tthis.getContextAttributes = function () {\r\n\r\n\t\t\treturn _gl.getContextAttributes();\r\n\r\n\t\t};\r\n\r\n\t\tthis.forceContextLoss = function () {\r\n\r\n\t\t\tvar extension = extensions.get( 'WEBGL_lose_context' );\r\n\t\t\tif ( extension ) extension.loseContext();\r\n\r\n\t\t};\r\n\r\n\t\tthis.forceContextRestore = function () {\r\n\r\n\t\t\tvar extension = extensions.get( 'WEBGL_lose_context' );\r\n\t\t\tif ( extension ) extension.restoreContext();\r\n\r\n\t\t};\r\n\r\n\t\tthis.getPixelRatio = function () {\r\n\r\n\t\t\treturn _pixelRatio;\r\n\r\n\t\t};\r\n\r\n\t\tthis.setPixelRatio = function ( value ) {\r\n\r\n\t\t\tif ( value === undefined ) return;\r\n\r\n\t\t\t_pixelRatio = value;\r\n\r\n\t\t\tthis.setSize( _width, _height, false );\r\n\r\n\t\t};\r\n\r\n\t\tthis.getSize = function () {\r\n\r\n\t\t\treturn {\r\n\t\t\t\twidth: _width,\r\n\t\t\t\theight: _height\r\n\t\t\t};\r\n\r\n\t\t};\r\n\r\n\t\tthis.setSize = function ( width, height, updateStyle ) {\r\n\r\n\t\t\tif ( vr.isPresenting() ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Can\\'t change size while VR device is presenting.' );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_width = width;\r\n\t\t\t_height = height;\r\n\r\n\t\t\t_canvas.width = width * _pixelRatio;\r\n\t\t\t_canvas.height = height * _pixelRatio;\r\n\r\n\t\t\tif ( updateStyle !== false ) {\r\n\r\n\t\t\t\t_canvas.style.width = width + 'px';\r\n\t\t\t\t_canvas.style.height = height + 'px';\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.setViewport( 0, 0, width, height );\r\n\r\n\t\t};\r\n\r\n\t\tthis.getDrawingBufferSize = function () {\r\n\r\n\t\t\treturn {\r\n\t\t\t\twidth: _width * _pixelRatio,\r\n\t\t\t\theight: _height * _pixelRatio\r\n\t\t\t};\r\n\r\n\t\t};\r\n\r\n\t\tthis.setDrawingBufferSize = function ( width, height, pixelRatio ) {\r\n\r\n\t\t\t_width = width;\r\n\t\t\t_height = height;\r\n\r\n\t\t\t_pixelRatio = pixelRatio;\r\n\r\n\t\t\t_canvas.width = width * pixelRatio;\r\n\t\t\t_canvas.height = height * pixelRatio;\r\n\r\n\t\t\tthis.setViewport( 0, 0, width, height );\r\n\r\n\t\t};\r\n\r\n\t\tthis.getCurrentViewport = function () {\r\n\r\n\t\t\treturn _currentViewport;\r\n\r\n\t\t};\r\n\r\n\t\tthis.setViewport = function ( x, y, width, height ) {\r\n\r\n\t\t\t_viewport.set( x, _height - y - height, width, height );\r\n\t\t\tstate.viewport( _currentViewport.copy( _viewport ).multiplyScalar( _pixelRatio ) );\r\n\r\n\t\t};\r\n\r\n\t\tthis.setScissor = function ( x, y, width, height ) {\r\n\r\n\t\t\t_scissor.set( x, _height - y - height, width, height );\r\n\t\t\tstate.scissor( _currentScissor.copy( _scissor ).multiplyScalar( _pixelRatio ) );\r\n\r\n\t\t};\r\n\r\n\t\tthis.setScissorTest = function ( boolean ) {\r\n\r\n\t\t\tstate.setScissorTest( _scissorTest = boolean );\r\n\r\n\t\t};\r\n\r\n\t\t// Clearing\r\n\r\n\t\tthis.getClearColor = function () {\r\n\r\n\t\t\treturn background.getClearColor();\r\n\r\n\t\t};\r\n\r\n\t\tthis.setClearColor = function () {\r\n\r\n\t\t\tbackground.setClearColor.apply( background, arguments );\r\n\r\n\t\t};\r\n\r\n\t\tthis.getClearAlpha = function () {\r\n\r\n\t\t\treturn background.getClearAlpha();\r\n\r\n\t\t};\r\n\r\n\t\tthis.setClearAlpha = function () {\r\n\r\n\t\t\tbackground.setClearAlpha.apply( background, arguments );\r\n\r\n\t\t};\r\n\r\n\t\tthis.clear = function ( color, depth, stencil ) {\r\n\r\n\t\t\tvar bits = 0;\r\n\r\n\t\t\tif ( color === undefined || color ) bits |= _gl.COLOR_BUFFER_BIT;\r\n\t\t\tif ( depth === undefined || depth ) bits |= _gl.DEPTH_BUFFER_BIT;\r\n\t\t\tif ( stencil === undefined || stencil ) bits |= _gl.STENCIL_BUFFER_BIT;\r\n\r\n\t\t\t_gl.clear( bits );\r\n\r\n\t\t};\r\n\r\n\t\tthis.clearColor = function () {\r\n\r\n\t\t\tthis.clear( true, false, false );\r\n\r\n\t\t};\r\n\r\n\t\tthis.clearDepth = function () {\r\n\r\n\t\t\tthis.clear( false, true, false );\r\n\r\n\t\t};\r\n\r\n\t\tthis.clearStencil = function () {\r\n\r\n\t\t\tthis.clear( false, false, true );\r\n\r\n\t\t};\r\n\r\n\t\tthis.clearTarget = function ( renderTarget, color, depth, stencil ) {\r\n\r\n\t\t\tthis.setRenderTarget( renderTarget );\r\n\t\t\tthis.clear( color, depth, stencil );\r\n\r\n\t\t};\r\n\r\n\t\t//\r\n\r\n\t\tthis.dispose = function () {\r\n\r\n\t\t\t_canvas.removeEventListener( 'webglcontextlost', onContextLost, false );\r\n\t\t\t_canvas.removeEventListener( 'webglcontextrestored', onContextRestore, false );\r\n\r\n\t\t\trenderLists.dispose();\r\n\t\t\trenderStates.dispose();\r\n\t\t\tproperties.dispose();\r\n\t\t\tobjects.dispose();\r\n\r\n\t\t\tvr.dispose();\r\n\r\n\t\t\tanimation.stop();\r\n\r\n\t\t};\r\n\r\n\t\t// Events\r\n\r\n\t\tfunction onContextLost( event ) {\r\n\r\n\t\t\tevent.preventDefault();\r\n\r\n\t\t\tconsole.log( 'THREE.WebGLRenderer: Context Lost.' );\r\n\r\n\t\t\t_isContextLost = true;\r\n\r\n\t\t}\r\n\r\n\t\tfunction onContextRestore( /* event */ ) {\r\n\r\n\t\t\tconsole.log( 'THREE.WebGLRenderer: Context Restored.' );\r\n\r\n\t\t\t_isContextLost = false;\r\n\r\n\t\t\tinitGLContext();\r\n\r\n\t\t}\r\n\r\n\t\tfunction onMaterialDispose( event ) {\r\n\r\n\t\t\tvar material = event.target;\r\n\r\n\t\t\tmaterial.removeEventListener( 'dispose', onMaterialDispose );\r\n\r\n\t\t\tdeallocateMaterial( material );\r\n\r\n\t\t}\r\n\r\n\t\t// Buffer deallocation\r\n\r\n\t\tfunction deallocateMaterial( material ) {\r\n\r\n\t\t\treleaseMaterialProgramReference( material );\r\n\r\n\t\t\tproperties.remove( material );\r\n\r\n\t\t}\r\n\r\n\r\n\t\tfunction releaseMaterialProgramReference( material ) {\r\n\r\n\t\t\tvar programInfo = properties.get( material ).program;\r\n\r\n\t\t\tmaterial.program = undefined;\r\n\r\n\t\t\tif ( programInfo !== undefined ) {\r\n\r\n\t\t\t\tprogramCache.releaseProgram( programInfo );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// Buffer rendering\r\n\r\n\t\tfunction renderObjectImmediate( object, program ) {\r\n\r\n\t\t\tobject.render( function ( object ) {\r\n\r\n\t\t\t\t_this.renderBufferImmediate( object, program );\r\n\r\n\t\t\t} );\r\n\r\n\t\t}\r\n\r\n\t\tthis.renderBufferImmediate = function ( object, program ) {\r\n\r\n\t\t\tstate.initAttributes();\r\n\r\n\t\t\tvar buffers = properties.get( object );\r\n\r\n\t\t\tif ( object.hasPositions && ! buffers.position ) buffers.position = _gl.createBuffer();\r\n\t\t\tif ( object.hasNormals && ! buffers.normal ) buffers.normal = _gl.createBuffer();\r\n\t\t\tif ( object.hasUvs && ! buffers.uv ) buffers.uv = _gl.createBuffer();\r\n\t\t\tif ( object.hasColors && ! buffers.color ) buffers.color = _gl.createBuffer();\r\n\r\n\t\t\tvar programAttributes = program.getAttributes();\r\n\r\n\t\t\tif ( object.hasPositions ) {\r\n\r\n\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffers.position );\r\n\t\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, object.positionArray, _gl.DYNAMIC_DRAW );\r\n\r\n\t\t\t\tstate.enableAttribute( programAttributes.position );\r\n\t\t\t\t_gl.vertexAttribPointer( programAttributes.position, 3, _gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( object.hasNormals ) {\r\n\r\n\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffers.normal );\r\n\t\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, object.normalArray, _gl.DYNAMIC_DRAW );\r\n\r\n\t\t\t\tstate.enableAttribute( programAttributes.normal );\r\n\t\t\t\t_gl.vertexAttribPointer( programAttributes.normal, 3, _gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( object.hasUvs ) {\r\n\r\n\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffers.uv );\r\n\t\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, object.uvArray, _gl.DYNAMIC_DRAW );\r\n\r\n\t\t\t\tstate.enableAttribute( programAttributes.uv );\r\n\t\t\t\t_gl.vertexAttribPointer( programAttributes.uv, 2, _gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( object.hasColors ) {\r\n\r\n\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffers.color );\r\n\t\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, object.colorArray, _gl.DYNAMIC_DRAW );\r\n\r\n\t\t\t\tstate.enableAttribute( programAttributes.color );\r\n\t\t\t\t_gl.vertexAttribPointer( programAttributes.color, 3, _gl.FLOAT, false, 0, 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tstate.disableUnusedAttributes();\r\n\r\n\t\t\t_gl.drawArrays( _gl.TRIANGLES, 0, object.count );\r\n\r\n\t\t\tobject.count = 0;\r\n\r\n\t\t};\r\n\r\n\t\tthis.renderBufferDirect = function ( camera, fog, geometry, material, object, group ) {\r\n\r\n\t\t\tvar frontFaceCW = ( object.isMesh && object.normalMatrix.determinant() < 0 );\r\n\r\n\t\t\tstate.setMaterial( material, frontFaceCW );\r\n\r\n\t\t\tvar program = setProgram( camera, fog, material, object );\r\n\r\n\t\t\tvar updateBuffers = false;\r\n\r\n\t\t\tif ( _currentGeometryProgram.geometry !== geometry.id ||\r\n\t\t\t\t_currentGeometryProgram.program !== program.id ||\r\n\t\t\t\t_currentGeometryProgram.wireframe !== ( material.wireframe === true ) ) {\r\n\r\n\t\t\t\t_currentGeometryProgram.geometry = geometry.id;\r\n\t\t\t\t_currentGeometryProgram.program = program.id;\r\n\t\t\t\t_currentGeometryProgram.wireframe = material.wireframe === true;\r\n\t\t\t\tupdateBuffers = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( object.morphTargetInfluences ) {\r\n\r\n\t\t\t\tmorphtargets.update( object, geometry, material, program );\r\n\r\n\t\t\t\tupdateBuffers = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tvar index = geometry.index;\r\n\t\t\tvar position = geometry.attributes.position;\r\n\t\t\tvar rangeFactor = 1;\r\n\r\n\t\t\tif ( material.wireframe === true ) {\r\n\r\n\t\t\t\tindex = geometries.getWireframeAttribute( geometry );\r\n\t\t\t\trangeFactor = 2;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar attribute;\r\n\t\t\tvar renderer = bufferRenderer;\r\n\r\n\t\t\tif ( index !== null ) {\r\n\r\n\t\t\t\tattribute = attributes.get( index );\r\n\r\n\t\t\t\trenderer = indexedBufferRenderer;\r\n\t\t\t\trenderer.setIndex( attribute );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( updateBuffers ) {\r\n\r\n\t\t\t\tsetupVertexAttributes( material, program, geometry );\r\n\r\n\t\t\t\tif ( index !== null ) {\r\n\r\n\t\t\t\t\t_gl.bindBuffer( _gl.ELEMENT_ARRAY_BUFFER, attribute.buffer );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tvar dataCount = Infinity;\r\n\r\n\t\t\tif ( index !== null ) {\r\n\r\n\t\t\t\tdataCount = index.count;\r\n\r\n\t\t\t} else if ( position !== undefined ) {\r\n\r\n\t\t\t\tdataCount = position.count;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar rangeStart = geometry.drawRange.start * rangeFactor;\r\n\t\t\tvar rangeCount = geometry.drawRange.count * rangeFactor;\r\n\r\n\t\t\tvar groupStart = group !== null ? group.start * rangeFactor : 0;\r\n\t\t\tvar groupCount = group !== null ? group.count * rangeFactor : Infinity;\r\n\r\n\t\t\tvar drawStart = Math.max( rangeStart, groupStart );\r\n\t\t\tvar drawEnd = Math.min( dataCount, rangeStart + rangeCount, groupStart + groupCount ) - 1;\r\n\r\n\t\t\tvar drawCount = Math.max( 0, drawEnd - drawStart + 1 );\r\n\r\n\t\t\tif ( drawCount === 0 ) return;\r\n\r\n\t\t\t//\r\n\r\n\t\t\tif ( object.isMesh ) {\r\n\r\n\t\t\t\tif ( material.wireframe === true ) {\r\n\r\n\t\t\t\t\tstate.setLineWidth( material.wireframeLinewidth * getTargetPixelRatio() );\r\n\t\t\t\t\trenderer.setMode( _gl.LINES );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tswitch ( object.drawMode ) {\r\n\r\n\t\t\t\t\t\tcase TrianglesDrawMode:\r\n\t\t\t\t\t\t\trenderer.setMode( _gl.TRIANGLES );\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase TriangleStripDrawMode:\r\n\t\t\t\t\t\t\trenderer.setMode( _gl.TRIANGLE_STRIP );\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase TriangleFanDrawMode:\r\n\t\t\t\t\t\t\trenderer.setMode( _gl.TRIANGLE_FAN );\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t} else if ( object.isLine ) {\r\n\r\n\t\t\t\tvar lineWidth = material.linewidth;\r\n\r\n\t\t\t\tif ( lineWidth === undefined ) lineWidth = 1; // Not using Line*Material\r\n\r\n\t\t\t\tstate.setLineWidth( lineWidth * getTargetPixelRatio() );\r\n\r\n\t\t\t\tif ( object.isLineSegments ) {\r\n\r\n\t\t\t\t\trenderer.setMode( _gl.LINES );\r\n\r\n\t\t\t\t} else if ( object.isLineLoop ) {\r\n\r\n\t\t\t\t\trenderer.setMode( _gl.LINE_LOOP );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\trenderer.setMode( _gl.LINE_STRIP );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( object.isPoints ) {\r\n\r\n\t\t\t\trenderer.setMode( _gl.POINTS );\r\n\r\n\t\t\t} else if ( object.isSprite ) {\r\n\r\n\t\t\t\trenderer.setMode( _gl.TRIANGLES );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( geometry && geometry.isInstancedBufferGeometry ) {\r\n\r\n\t\t\t\tif ( geometry.maxInstancedCount > 0 ) {\r\n\r\n\t\t\t\t\trenderer.renderInstances( geometry, drawStart, drawCount );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\trenderer.render( drawStart, drawCount );\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t\tfunction setupVertexAttributes( material, program, geometry ) {\r\n\r\n\t\t\tif ( geometry && geometry.isInstancedBufferGeometry & ! capabilities.isWebGL2 ) {\r\n\r\n\t\t\t\tif ( extensions.get( 'ANGLE_instanced_arrays' ) === null ) {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.' );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tstate.initAttributes();\r\n\r\n\t\t\tvar geometryAttributes = geometry.attributes;\r\n\r\n\t\t\tvar programAttributes = program.getAttributes();\r\n\r\n\t\t\tvar materialDefaultAttributeValues = material.defaultAttributeValues;\r\n\r\n\t\t\tfor ( var name in programAttributes ) {\r\n\r\n\t\t\t\tvar programAttribute = programAttributes[ name ];\r\n\r\n\t\t\t\tif ( programAttribute >= 0 ) {\r\n\r\n\t\t\t\t\tvar geometryAttribute = geometryAttributes[ name ];\r\n\r\n\t\t\t\t\tif ( geometryAttribute !== undefined ) {\r\n\r\n\t\t\t\t\t\tvar normalized = geometryAttribute.normalized;\r\n\t\t\t\t\t\tvar size = geometryAttribute.itemSize;\r\n\r\n\t\t\t\t\t\tvar attribute = attributes.get( geometryAttribute );\r\n\r\n\t\t\t\t\t\t// TODO Attribute may not be available on context restore\r\n\r\n\t\t\t\t\t\tif ( attribute === undefined ) continue;\r\n\r\n\t\t\t\t\t\tvar buffer = attribute.buffer;\r\n\t\t\t\t\t\tvar type = attribute.type;\r\n\t\t\t\t\t\tvar bytesPerElement = attribute.bytesPerElement;\r\n\r\n\t\t\t\t\t\tif ( geometryAttribute.isInterleavedBufferAttribute ) {\r\n\r\n\t\t\t\t\t\t\tvar data = geometryAttribute.data;\r\n\t\t\t\t\t\t\tvar stride = data.stride;\r\n\t\t\t\t\t\t\tvar offset = geometryAttribute.offset;\r\n\r\n\t\t\t\t\t\t\tif ( data && data.isInstancedInterleavedBuffer ) {\r\n\r\n\t\t\t\t\t\t\t\tstate.enableAttributeAndDivisor( programAttribute, data.meshPerAttribute );\r\n\r\n\t\t\t\t\t\t\t\tif ( geometry.maxInstancedCount === undefined ) {\r\n\r\n\t\t\t\t\t\t\t\t\tgeometry.maxInstancedCount = data.meshPerAttribute * data.count;\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\tstate.enableAttribute( programAttribute );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffer );\r\n\t\t\t\t\t\t\t_gl.vertexAttribPointer( programAttribute, size, type, normalized, stride * bytesPerElement, offset * bytesPerElement );\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tif ( geometryAttribute.isInstancedBufferAttribute ) {\r\n\r\n\t\t\t\t\t\t\t\tstate.enableAttributeAndDivisor( programAttribute, geometryAttribute.meshPerAttribute );\r\n\r\n\t\t\t\t\t\t\t\tif ( geometry.maxInstancedCount === undefined ) {\r\n\r\n\t\t\t\t\t\t\t\t\tgeometry.maxInstancedCount = geometryAttribute.meshPerAttribute * geometryAttribute.count;\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\tstate.enableAttribute( programAttribute );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffer );\r\n\t\t\t\t\t\t\t_gl.vertexAttribPointer( programAttribute, size, type, normalized, 0, 0 );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else if ( materialDefaultAttributeValues !== undefined ) {\r\n\r\n\t\t\t\t\t\tvar value = materialDefaultAttributeValues[ name ];\r\n\r\n\t\t\t\t\t\tif ( value !== undefined ) {\r\n\r\n\t\t\t\t\t\t\tswitch ( value.length ) {\r\n\r\n\t\t\t\t\t\t\t\tcase 2:\r\n\t\t\t\t\t\t\t\t\t_gl.vertexAttrib2fv( programAttribute, value );\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tcase 3:\r\n\t\t\t\t\t\t\t\t\t_gl.vertexAttrib3fv( programAttribute, value );\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tcase 4:\r\n\t\t\t\t\t\t\t\t\t_gl.vertexAttrib4fv( programAttribute, value );\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\t\t\t_gl.vertexAttrib1fv( programAttribute, value );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tstate.disableUnusedAttributes();\r\n\r\n\t\t}\r\n\r\n\t\t// Compile\r\n\r\n\t\tthis.compile = function ( scene, camera ) {\r\n\r\n\t\t\tcurrentRenderState = renderStates.get( scene, camera );\r\n\t\t\tcurrentRenderState.init();\r\n\r\n\t\t\tscene.traverse( function ( object ) {\r\n\r\n\t\t\t\tif ( object.isLight ) {\r\n\r\n\t\t\t\t\tcurrentRenderState.pushLight( object );\r\n\r\n\t\t\t\t\tif ( object.castShadow ) {\r\n\r\n\t\t\t\t\t\tcurrentRenderState.pushShadow( object );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} );\r\n\r\n\t\t\tcurrentRenderState.setupLights( camera );\r\n\r\n\t\t\tscene.traverse( function ( object ) {\r\n\r\n\t\t\t\tif ( object.material ) {\r\n\r\n\t\t\t\t\tif ( Array.isArray( object.material ) ) {\r\n\r\n\t\t\t\t\t\tfor ( var i = 0; i < object.material.length; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tinitMaterial( object.material[ i ], scene.fog, object );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tinitMaterial( object.material, scene.fog, object );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} );\r\n\r\n\t\t};\r\n\r\n\t\t// Animation Loop\r\n\r\n\t\tvar onAnimationFrameCallback = null;\r\n\r\n\t\tfunction onAnimationFrame( time ) {\r\n\r\n\t\t\tif ( vr.isPresenting() ) return;\r\n\t\t\tif ( onAnimationFrameCallback ) onAnimationFrameCallback( time );\r\n\r\n\t\t}\r\n\r\n\t\tvar animation = new WebGLAnimation();\r\n\t\tanimation.setAnimationLoop( onAnimationFrame );\r\n\r\n\t\tif ( typeof window !== 'undefined' ) animation.setContext( window );\r\n\r\n\t\tthis.setAnimationLoop = function ( callback ) {\r\n\r\n\t\t\tonAnimationFrameCallback = callback;\r\n\t\t\tvr.setAnimationLoop( callback );\r\n\r\n\t\t\tanimation.start();\r\n\r\n\t\t};\r\n\r\n\t\t// Rendering\r\n\r\n\t\tthis.render = function ( scene, camera, renderTarget, forceClear ) {\r\n\r\n\t\t\tif ( ! ( camera && camera.isCamera ) ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.' );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( _isContextLost ) return;\r\n\r\n\t\t\t// reset caching for this frame\r\n\r\n\t\t\t_currentGeometryProgram.geometry = null;\r\n\t\t\t_currentGeometryProgram.program = null;\r\n\t\t\t_currentGeometryProgram.wireframe = false;\r\n\t\t\t_currentMaterialId = - 1;\r\n\t\t\t_currentCamera = null;\r\n\r\n\t\t\t// update scene graph\r\n\r\n\t\t\tif ( scene.autoUpdate === true ) scene.updateMatrixWorld();\r\n\r\n\t\t\t// update camera matrices and frustum\r\n\r\n\t\t\tif ( camera.parent === null ) camera.updateMatrixWorld();\r\n\r\n\t\t\tif ( vr.enabled ) {\r\n\r\n\t\t\t\tcamera = vr.getCamera( camera );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tcurrentRenderState = renderStates.get( scene, camera );\r\n\t\t\tcurrentRenderState.init();\r\n\r\n\t\t\tscene.onBeforeRender( _this, scene, camera, renderTarget );\r\n\r\n\t\t\t_projScreenMatrix.multiplyMatrices( camera.projectionMatrix, camera.matrixWorldInverse );\r\n\t\t\t_frustum.setFromMatrix( _projScreenMatrix );\r\n\r\n\t\t\t_localClippingEnabled = this.localClippingEnabled;\r\n\t\t\t_clippingEnabled = _clipping.init( this.clippingPlanes, _localClippingEnabled, camera );\r\n\r\n\t\t\tcurrentRenderList = renderLists.get( scene, camera );\r\n\t\t\tcurrentRenderList.init();\r\n\r\n\t\t\tprojectObject( scene, camera, _this.sortObjects );\r\n\r\n\t\t\tif ( _this.sortObjects === true ) {\r\n\r\n\t\t\t\tcurrentRenderList.sort();\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tif ( _clippingEnabled ) _clipping.beginShadows();\r\n\r\n\t\t\tvar shadowsArray = currentRenderState.state.shadowsArray;\r\n\r\n\t\t\tshadowMap.render( shadowsArray, scene, camera );\r\n\r\n\t\t\tcurrentRenderState.setupLights( camera );\r\n\r\n\t\t\tif ( _clippingEnabled ) _clipping.endShadows();\r\n\r\n\t\t\t//\r\n\r\n\t\t\tif ( this.info.autoReset ) this.info.reset();\r\n\r\n\t\t\tif ( renderTarget === undefined ) {\r\n\r\n\t\t\t\trenderTarget = null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.setRenderTarget( renderTarget );\r\n\r\n\t\t\t//\r\n\r\n\t\t\tbackground.render( currentRenderList, scene, camera, forceClear );\r\n\r\n\t\t\t// render scene\r\n\r\n\t\t\tvar opaqueObjects = currentRenderList.opaque;\r\n\t\t\tvar transparentObjects = currentRenderList.transparent;\r\n\r\n\t\t\tif ( scene.overrideMaterial ) {\r\n\r\n\t\t\t\tvar overrideMaterial = scene.overrideMaterial;\r\n\r\n\t\t\t\tif ( opaqueObjects.length ) renderObjects( opaqueObjects, scene, camera, overrideMaterial );\r\n\t\t\t\tif ( transparentObjects.length ) renderObjects( transparentObjects, scene, camera, overrideMaterial );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// opaque pass (front-to-back order)\r\n\r\n\t\t\t\tif ( opaqueObjects.length ) renderObjects( opaqueObjects, scene, camera );\r\n\r\n\t\t\t\t// transparent pass (back-to-front order)\r\n\r\n\t\t\t\tif ( transparentObjects.length ) renderObjects( transparentObjects, scene, camera );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Generate mipmap if we're using any kind of mipmap filtering\r\n\r\n\t\t\tif ( renderTarget ) {\r\n\r\n\t\t\t\ttextures.updateRenderTargetMipmap( renderTarget );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Ensure depth buffer writing is enabled so it can be cleared on next render\r\n\r\n\t\t\tstate.buffers.depth.setTest( true );\r\n\t\t\tstate.buffers.depth.setMask( true );\r\n\t\t\tstate.buffers.color.setMask( true );\r\n\r\n\t\t\tstate.setPolygonOffset( false );\r\n\r\n\t\t\tscene.onAfterRender( _this, scene, camera );\r\n\r\n\t\t\tif ( vr.enabled ) {\r\n\r\n\t\t\t\tvr.submitFrame();\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// _gl.finish();\r\n\r\n\t\t\tcurrentRenderList = null;\r\n\t\t\tcurrentRenderState = null;\r\n\r\n\t\t};\r\n\r\n\t\t/*\r\n\t\t// TODO Duplicated code (Frustum)\r\n\r\n\t\tvar _sphere = new Sphere();\r\n\r\n\t\tfunction isObjectViewable( object ) {\r\n\r\n\t\t\tvar geometry = object.geometry;\r\n\r\n\t\t\tif ( geometry.boundingSphere === null )\r\n\t\t\t\tgeometry.computeBoundingSphere();\r\n\r\n\t\t\t_sphere.copy( geometry.boundingSphere ).\r\n\t\t\tapplyMatrix4( object.matrixWorld );\r\n\r\n\t\t\treturn isSphereViewable( _sphere );\r\n\r\n\t\t}\r\n\r\n\t\tfunction isSpriteViewable( sprite ) {\r\n\r\n\t\t\t_sphere.center.set( 0, 0, 0 );\r\n\t\t\t_sphere.radius = 0.7071067811865476;\r\n\t\t\t_sphere.applyMatrix4( sprite.matrixWorld );\r\n\r\n\t\t\treturn isSphereViewable( _sphere );\r\n\r\n\t\t}\r\n\r\n\t\tfunction isSphereViewable( sphere ) {\r\n\r\n\t\t\tif ( ! _frustum.intersectsSphere( sphere ) ) return false;\r\n\r\n\t\t\tvar numPlanes = _clipping.numPlanes;\r\n\r\n\t\t\tif ( numPlanes === 0 ) return true;\r\n\r\n\t\t\tvar planes = _this.clippingPlanes,\r\n\r\n\t\t\t\tcenter = sphere.center,\r\n\t\t\t\tnegRad = - sphere.radius,\r\n\t\t\t\ti = 0;\r\n\r\n\t\t\tdo {\r\n\r\n\t\t\t\t// out when deeper than radius in the negative halfspace\r\n\t\t\t\tif ( planes[ i ].distanceToPoint( center ) < negRad ) return false;\r\n\r\n\t\t\t} while ( ++ i !== numPlanes );\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\t\t*/\r\n\r\n\t\tfunction projectObject( object, camera, sortObjects ) {\r\n\r\n\t\t\tif ( object.visible === false ) return;\r\n\r\n\t\t\tvar visible = object.layers.test( camera.layers );\r\n\r\n\t\t\tif ( visible ) {\r\n\r\n\t\t\t\tif ( object.isLight ) {\r\n\r\n\t\t\t\t\tcurrentRenderState.pushLight( object );\r\n\r\n\t\t\t\t\tif ( object.castShadow ) {\r\n\r\n\t\t\t\t\t\tcurrentRenderState.pushShadow( object );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else if ( object.isSprite ) {\r\n\r\n\t\t\t\t\tif ( ! object.frustumCulled || _frustum.intersectsSprite( object ) ) {\r\n\r\n\t\t\t\t\t\tif ( sortObjects ) {\r\n\r\n\t\t\t\t\t\t\t_vector3.setFromMatrixPosition( object.matrixWorld )\r\n\t\t\t\t\t\t\t\t.applyMatrix4( _projScreenMatrix );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar geometry = objects.update( object );\r\n\t\t\t\t\t\tvar material = object.material;\r\n\r\n\t\t\t\t\t\tcurrentRenderList.push( object, geometry, material, _vector3.z, null );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else if ( object.isImmediateRenderObject ) {\r\n\r\n\t\t\t\t\tif ( sortObjects ) {\r\n\r\n\t\t\t\t\t\t_vector3.setFromMatrixPosition( object.matrixWorld )\r\n\t\t\t\t\t\t\t.applyMatrix4( _projScreenMatrix );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tcurrentRenderList.push( object, null, object.material, _vector3.z, null );\r\n\r\n\t\t\t\t} else if ( object.isMesh || object.isLine || object.isPoints ) {\r\n\r\n\t\t\t\t\tif ( object.isSkinnedMesh ) {\r\n\r\n\t\t\t\t\t\tobject.skeleton.update();\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( ! object.frustumCulled || _frustum.intersectsObject( object ) ) {\r\n\r\n\t\t\t\t\t\tif ( sortObjects ) {\r\n\r\n\t\t\t\t\t\t\t_vector3.setFromMatrixPosition( object.matrixWorld )\r\n\t\t\t\t\t\t\t\t.applyMatrix4( _projScreenMatrix );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar geometry = objects.update( object );\r\n\t\t\t\t\t\tvar material = object.material;\r\n\r\n\t\t\t\t\t\tif ( Array.isArray( material ) ) {\r\n\r\n\t\t\t\t\t\t\tvar groups = geometry.groups;\r\n\r\n\t\t\t\t\t\t\tfor ( var i = 0, l = groups.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tvar group = groups[ i ];\r\n\t\t\t\t\t\t\t\tvar groupMaterial = material[ group.materialIndex ];\r\n\r\n\t\t\t\t\t\t\t\tif ( groupMaterial && groupMaterial.visible ) {\r\n\r\n\t\t\t\t\t\t\t\t\tcurrentRenderList.push( object, geometry, groupMaterial, _vector3.z, group );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t} else if ( material.visible ) {\r\n\r\n\t\t\t\t\t\t\tcurrentRenderList.push( object, geometry, material, _vector3.z, null );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar children = object.children;\r\n\r\n\t\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tprojectObject( children[ i ], camera, sortObjects );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction renderObjects( renderList, scene, camera, overrideMaterial ) {\r\n\r\n\t\t\tfor ( var i = 0, l = renderList.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar renderItem = renderList[ i ];\r\n\r\n\t\t\t\tvar object = renderItem.object;\r\n\t\t\t\tvar geometry = renderItem.geometry;\r\n\t\t\t\tvar material = overrideMaterial === undefined ? renderItem.material : overrideMaterial;\r\n\t\t\t\tvar group = renderItem.group;\r\n\r\n\t\t\t\tif ( camera.isArrayCamera ) {\r\n\r\n\t\t\t\t\t_currentArrayCamera = camera;\r\n\r\n\t\t\t\t\tvar cameras = camera.cameras;\r\n\r\n\t\t\t\t\tfor ( var j = 0, jl = cameras.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\t\tvar camera2 = cameras[ j ];\r\n\r\n\t\t\t\t\t\tif ( object.layers.test( camera2.layers ) ) {\r\n\r\n\t\t\t\t\t\t\tif ( 'viewport' in camera2 ) { // XR\r\n\r\n\t\t\t\t\t\t\t\tstate.viewport( _currentViewport.copy( camera2.viewport ) );\r\n\r\n\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\tvar bounds = camera2.bounds;\r\n\r\n\t\t\t\t\t\t\t\tvar x = bounds.x * _width;\r\n\t\t\t\t\t\t\t\tvar y = bounds.y * _height;\r\n\t\t\t\t\t\t\t\tvar width = bounds.z * _width;\r\n\t\t\t\t\t\t\t\tvar height = bounds.w * _height;\r\n\r\n\t\t\t\t\t\t\t\tstate.viewport( _currentViewport.set( x, y, width, height ).multiplyScalar( _pixelRatio ) );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tcurrentRenderState.setupLights( camera2 );\r\n\r\n\t\t\t\t\t\t\trenderObject( object, scene, camera2, geometry, material, group );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t_currentArrayCamera = null;\r\n\r\n\t\t\t\t\trenderObject( object, scene, camera, geometry, material, group );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction renderObject( object, scene, camera, geometry, material, group ) {\r\n\r\n\t\t\tobject.onBeforeRender( _this, scene, camera, geometry, material, group );\r\n\t\t\tcurrentRenderState = renderStates.get( scene, _currentArrayCamera || camera );\r\n\r\n\t\t\tobject.modelViewMatrix.multiplyMatrices( camera.matrixWorldInverse, object.matrixWorld );\r\n\t\t\tobject.normalMatrix.getNormalMatrix( object.modelViewMatrix );\r\n\r\n\t\t\tif ( object.isImmediateRenderObject ) {\r\n\r\n\t\t\t\tstate.setMaterial( material );\r\n\r\n\t\t\t\tvar program = setProgram( camera, scene.fog, material, object );\r\n\r\n\t\t\t\t_currentGeometryProgram.geometry = null;\r\n\t\t\t\t_currentGeometryProgram.program = null;\r\n\t\t\t\t_currentGeometryProgram.wireframe = false;\r\n\r\n\t\t\t\trenderObjectImmediate( object, program );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t_this.renderBufferDirect( camera, scene.fog, geometry, material, object, group );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tobject.onAfterRender( _this, scene, camera, geometry, material, group );\r\n\t\t\tcurrentRenderState = renderStates.get( scene, _currentArrayCamera || camera );\r\n\r\n\t\t}\r\n\r\n\t\tfunction initMaterial( material, fog, object ) {\r\n\r\n\t\t\tvar materialProperties = properties.get( material );\r\n\r\n\t\t\tvar lights = currentRenderState.state.lights;\r\n\t\t\tvar shadowsArray = currentRenderState.state.shadowsArray;\r\n\r\n\t\t\tvar lightsHash = materialProperties.lightsHash;\r\n\t\t\tvar lightsStateHash = lights.state.hash;\r\n\r\n\t\t\tvar parameters = programCache.getParameters(\r\n\t\t\t\tmaterial, lights.state, shadowsArray, fog, _clipping.numPlanes, _clipping.numIntersection, object );\r\n\r\n\t\t\tvar code = programCache.getProgramCode( material, parameters );\r\n\r\n\t\t\tvar program = materialProperties.program;\r\n\t\t\tvar programChange = true;\r\n\r\n\t\t\tif ( program === undefined ) {\r\n\r\n\t\t\t\t// new material\r\n\t\t\t\tmaterial.addEventListener( 'dispose', onMaterialDispose );\r\n\r\n\t\t\t} else if ( program.code !== code ) {\r\n\r\n\t\t\t\t// changed glsl or parameters\r\n\t\t\t\treleaseMaterialProgramReference( material );\r\n\r\n\t\t\t} else if ( lightsHash.stateID !== lightsStateHash.stateID ||\r\n\t\t\t\tlightsHash.directionalLength !== lightsStateHash.directionalLength ||\r\n\t\t\t\tlightsHash.pointLength !== lightsStateHash.pointLength ||\r\n\t\t\t\tlightsHash.spotLength !== lightsStateHash.spotLength ||\r\n\t\t\t\tlightsHash.rectAreaLength !== lightsStateHash.rectAreaLength ||\r\n\t\t\t\tlightsHash.hemiLength !== lightsStateHash.hemiLength ||\r\n\t\t\t\tlightsHash.shadowsLength !== lightsStateHash.shadowsLength ) {\r\n\r\n\t\t\t\tlightsHash.stateID = lightsStateHash.stateID;\r\n\t\t\t\tlightsHash.directionalLength = lightsStateHash.directionalLength;\r\n\t\t\t\tlightsHash.pointLength = lightsStateHash.pointLength;\r\n\t\t\t\tlightsHash.spotLength = lightsStateHash.spotLength;\r\n\t\t\t\tlightsHash.rectAreaLength = lightsStateHash.rectAreaLength;\r\n\t\t\t\tlightsHash.hemiLength = lightsStateHash.hemiLength;\r\n\t\t\t\tlightsHash.shadowsLength = lightsStateHash.shadowsLength;\r\n\r\n\t\t\t\tprogramChange = false;\r\n\r\n\t\t\t} else if ( parameters.shaderID !== undefined ) {\r\n\r\n\t\t\t\t// same glsl and uniform list\r\n\t\t\t\treturn;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// only rebuild uniform list\r\n\t\t\t\tprogramChange = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( programChange ) {\r\n\r\n\t\t\t\tif ( parameters.shaderID ) {\r\n\r\n\t\t\t\t\tvar shader = ShaderLib[ parameters.shaderID ];\r\n\r\n\t\t\t\t\tmaterialProperties.shader = {\r\n\t\t\t\t\t\tname: material.type,\r\n\t\t\t\t\t\tuniforms: UniformsUtils.clone( shader.uniforms ),\r\n\t\t\t\t\t\tvertexShader: shader.vertexShader,\r\n\t\t\t\t\t\tfragmentShader: shader.fragmentShader\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tmaterialProperties.shader = {\r\n\t\t\t\t\t\tname: material.type,\r\n\t\t\t\t\t\tuniforms: material.uniforms,\r\n\t\t\t\t\t\tvertexShader: material.vertexShader,\r\n\t\t\t\t\t\tfragmentShader: material.fragmentShader\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tmaterial.onBeforeCompile( materialProperties.shader, _this );\r\n\r\n\t\t\t\t// Computing code again as onBeforeCompile may have changed the shaders\r\n\t\t\t\tcode = programCache.getProgramCode( material, parameters );\r\n\r\n\t\t\t\tprogram = programCache.acquireProgram( material, materialProperties.shader, parameters, code );\r\n\r\n\t\t\t\tmaterialProperties.program = program;\r\n\t\t\t\tmaterial.program = program;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar programAttributes = program.getAttributes();\r\n\r\n\t\t\tif ( material.morphTargets ) {\r\n\r\n\t\t\t\tmaterial.numSupportedMorphTargets = 0;\r\n\r\n\t\t\t\tfor ( var i = 0; i < _this.maxMorphTargets; i ++ ) {\r\n\r\n\t\t\t\t\tif ( programAttributes[ 'morphTarget' + i ] >= 0 ) {\r\n\r\n\t\t\t\t\t\tmaterial.numSupportedMorphTargets ++;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.morphNormals ) {\r\n\r\n\t\t\t\tmaterial.numSupportedMorphNormals = 0;\r\n\r\n\t\t\t\tfor ( var i = 0; i < _this.maxMorphNormals; i ++ ) {\r\n\r\n\t\t\t\t\tif ( programAttributes[ 'morphNormal' + i ] >= 0 ) {\r\n\r\n\t\t\t\t\t\tmaterial.numSupportedMorphNormals ++;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar uniforms = materialProperties.shader.uniforms;\r\n\r\n\t\t\tif ( ! material.isShaderMaterial &&\r\n\t\t\t\t! material.isRawShaderMaterial ||\r\n\t\t\t\tmaterial.clipping === true ) {\r\n\r\n\t\t\t\tmaterialProperties.numClippingPlanes = _clipping.numPlanes;\r\n\t\t\t\tmaterialProperties.numIntersection = _clipping.numIntersection;\r\n\t\t\t\tuniforms.clippingPlanes = _clipping.uniform;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tmaterialProperties.fog = fog;\r\n\r\n\t\t\t// store the light setup it was created for\r\n\t\t\tif ( lightsHash === undefined ) {\r\n\r\n\t\t\t\tmaterialProperties.lightsHash = lightsHash = {};\r\n\r\n\t\t\t}\r\n\r\n\t\t\tlightsHash.stateID = lightsStateHash.stateID;\r\n\t\t\tlightsHash.directionalLength = lightsStateHash.directionalLength;\r\n\t\t\tlightsHash.pointLength = lightsStateHash.pointLength;\r\n\t\t\tlightsHash.spotLength = lightsStateHash.spotLength;\r\n\t\t\tlightsHash.rectAreaLength = lightsStateHash.rectAreaLength;\r\n\t\t\tlightsHash.hemiLength = lightsStateHash.hemiLength;\r\n\t\t\tlightsHash.shadowsLength = lightsStateHash.shadowsLength;\r\n\r\n\t\t\tif ( material.lights ) {\r\n\r\n\t\t\t\t// wire up the material to this renderer's lighting state\r\n\r\n\t\t\t\tuniforms.ambientLightColor.value = lights.state.ambient;\r\n\t\t\t\tuniforms.directionalLights.value = lights.state.directional;\r\n\t\t\t\tuniforms.spotLights.value = lights.state.spot;\r\n\t\t\t\tuniforms.rectAreaLights.value = lights.state.rectArea;\r\n\t\t\t\tuniforms.pointLights.value = lights.state.point;\r\n\t\t\t\tuniforms.hemisphereLights.value = lights.state.hemi;\r\n\r\n\t\t\t\tuniforms.directionalShadowMap.value = lights.state.directionalShadowMap;\r\n\t\t\t\tuniforms.directionalShadowMatrix.value = lights.state.directionalShadowMatrix;\r\n\t\t\t\tuniforms.spotShadowMap.value = lights.state.spotShadowMap;\r\n\t\t\t\tuniforms.spotShadowMatrix.value = lights.state.spotShadowMatrix;\r\n\t\t\t\tuniforms.pointShadowMap.value = lights.state.pointShadowMap;\r\n\t\t\t\tuniforms.pointShadowMatrix.value = lights.state.pointShadowMatrix;\r\n\t\t\t\t// TODO (abelnation): add area lights shadow info to uniforms\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar progUniforms = materialProperties.program.getUniforms(),\r\n\t\t\t\tuniformsList =\r\n\t\t\t\t\tWebGLUniforms.seqWithValue( progUniforms.seq, uniforms );\r\n\r\n\t\t\tmaterialProperties.uniformsList = uniformsList;\r\n\r\n\t\t}\r\n\r\n\t\tfunction setProgram( camera, fog, material, object ) {\r\n\r\n\t\t\t_usedTextureUnits = 0;\r\n\r\n\t\t\tvar materialProperties = properties.get( material );\r\n\t\t\tvar lights = currentRenderState.state.lights;\r\n\r\n\t\t\tvar lightsHash = materialProperties.lightsHash;\r\n\t\t\tvar lightsStateHash = lights.state.hash;\r\n\r\n\t\t\tif ( _clippingEnabled ) {\r\n\r\n\t\t\t\tif ( _localClippingEnabled || camera !== _currentCamera ) {\r\n\r\n\t\t\t\t\tvar useCache =\r\n\t\t\t\t\t\tcamera === _currentCamera &&\r\n\t\t\t\t\t\tmaterial.id === _currentMaterialId;\r\n\r\n\t\t\t\t\t// we might want to call this function with some ClippingGroup\r\n\t\t\t\t\t// object instead of the material, once it becomes feasible\r\n\t\t\t\t\t// (#8465, #8379)\r\n\t\t\t\t\t_clipping.setState(\r\n\t\t\t\t\t\tmaterial.clippingPlanes, material.clipIntersection, material.clipShadows,\r\n\t\t\t\t\t\tcamera, materialProperties, useCache );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.needsUpdate === false ) {\r\n\r\n\t\t\t\tif ( materialProperties.program === undefined ) {\r\n\r\n\t\t\t\t\tmaterial.needsUpdate = true;\r\n\r\n\t\t\t\t} else if ( material.fog && materialProperties.fog !== fog ) {\r\n\r\n\t\t\t\t\tmaterial.needsUpdate = true;\r\n\r\n\t\t\t\t} else if ( material.lights && ( lightsHash.stateID !== lightsStateHash.stateID ||\r\n\t\t\t\t\tlightsHash.directionalLength !== lightsStateHash.directionalLength ||\r\n\t\t\t\t\tlightsHash.pointLength !== lightsStateHash.pointLength ||\r\n\t\t\t\t\tlightsHash.spotLength !== lightsStateHash.spotLength ||\r\n\t\t\t\t\tlightsHash.rectAreaLength !== lightsStateHash.rectAreaLength ||\r\n\t\t\t\t\tlightsHash.hemiLength !== lightsStateHash.hemiLength ||\r\n\t\t\t\t\tlightsHash.shadowsLength !== lightsStateHash.shadowsLength ) ) {\r\n\r\n\t\t\t\t\tmaterial.needsUpdate = true;\r\n\r\n\t\t\t\t} else if ( materialProperties.numClippingPlanes !== undefined &&\r\n\t\t\t\t\t( materialProperties.numClippingPlanes !== _clipping.numPlanes ||\r\n\t\t\t\t\tmaterialProperties.numIntersection !== _clipping.numIntersection ) ) {\r\n\r\n\t\t\t\t\tmaterial.needsUpdate = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.needsUpdate ) {\r\n\r\n\t\t\t\tinitMaterial( material, fog, object );\r\n\t\t\t\tmaterial.needsUpdate = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar refreshProgram = false;\r\n\t\t\tvar refreshMaterial = false;\r\n\t\t\tvar refreshLights = false;\r\n\r\n\t\t\tvar program = materialProperties.program,\r\n\t\t\t\tp_uniforms = program.getUniforms(),\r\n\t\t\t\tm_uniforms = materialProperties.shader.uniforms;\r\n\r\n\t\t\tif ( state.useProgram( program.program ) ) {\r\n\r\n\t\t\t\trefreshProgram = true;\r\n\t\t\t\trefreshMaterial = true;\r\n\t\t\t\trefreshLights = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.id !== _currentMaterialId ) {\r\n\r\n\t\t\t\t_currentMaterialId = material.id;\r\n\r\n\t\t\t\trefreshMaterial = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( refreshProgram || _currentCamera !== camera ) {\r\n\r\n\t\t\t\tp_uniforms.setValue( _gl, 'projectionMatrix', camera.projectionMatrix );\r\n\r\n\t\t\t\tif ( capabilities.logarithmicDepthBuffer ) {\r\n\r\n\t\t\t\t\tp_uniforms.setValue( _gl, 'logDepthBufFC',\r\n\t\t\t\t\t\t2.0 / ( Math.log( camera.far + 1.0 ) / Math.LN2 ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( _currentCamera !== camera ) {\r\n\r\n\t\t\t\t\t_currentCamera = camera;\r\n\r\n\t\t\t\t\t// lighting uniforms depend on the camera so enforce an update\r\n\t\t\t\t\t// now, in case this material supports lights - or later, when\r\n\t\t\t\t\t// the next material that does gets activated:\r\n\r\n\t\t\t\t\trefreshMaterial = true;\t\t// set to true on material change\r\n\t\t\t\t\trefreshLights = true;\t\t// remains set until update done\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// load material specific uniforms\r\n\t\t\t\t// (shader material also gets them for the sake of genericity)\r\n\r\n\t\t\t\tif ( material.isShaderMaterial ||\r\n\t\t\t\t\tmaterial.isMeshPhongMaterial ||\r\n\t\t\t\t\tmaterial.isMeshStandardMaterial ||\r\n\t\t\t\t\tmaterial.envMap ) {\r\n\r\n\t\t\t\t\tvar uCamPos = p_uniforms.map.cameraPosition;\r\n\r\n\t\t\t\t\tif ( uCamPos !== undefined ) {\r\n\r\n\t\t\t\t\t\tuCamPos.setValue( _gl,\r\n\t\t\t\t\t\t\t_vector3.setFromMatrixPosition( camera.matrixWorld ) );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( material.isMeshPhongMaterial ||\r\n\t\t\t\t\tmaterial.isMeshLambertMaterial ||\r\n\t\t\t\t\tmaterial.isMeshBasicMaterial ||\r\n\t\t\t\t\tmaterial.isMeshStandardMaterial ||\r\n\t\t\t\t\tmaterial.isShaderMaterial ||\r\n\t\t\t\t\tmaterial.skinning ) {\r\n\r\n\t\t\t\t\tp_uniforms.setValue( _gl, 'viewMatrix', camera.matrixWorldInverse );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// skinning uniforms must be set even if material didn't change\r\n\t\t\t// auto-setting of texture unit for bone texture must go before other textures\r\n\t\t\t// not sure why, but otherwise weird things happen\r\n\r\n\t\t\tif ( material.skinning ) {\r\n\r\n\t\t\t\tp_uniforms.setOptional( _gl, object, 'bindMatrix' );\r\n\t\t\t\tp_uniforms.setOptional( _gl, object, 'bindMatrixInverse' );\r\n\r\n\t\t\t\tvar skeleton = object.skeleton;\r\n\r\n\t\t\t\tif ( skeleton ) {\r\n\r\n\t\t\t\t\tvar bones = skeleton.bones;\r\n\r\n\t\t\t\t\tif ( capabilities.floatVertexTextures ) {\r\n\r\n\t\t\t\t\t\tif ( skeleton.boneTexture === undefined ) {\r\n\r\n\t\t\t\t\t\t\t// layout (1 matrix = 4 pixels)\r\n\t\t\t\t\t\t\t//      RGBA RGBA RGBA RGBA (=> column1, column2, column3, column4)\r\n\t\t\t\t\t\t\t//  with  8x8  pixel texture max   16 bones * 4 pixels =  (8 * 8)\r\n\t\t\t\t\t\t\t//       16x16 pixel texture max   64 bones * 4 pixels = (16 * 16)\r\n\t\t\t\t\t\t\t//       32x32 pixel texture max  256 bones * 4 pixels = (32 * 32)\r\n\t\t\t\t\t\t\t//       64x64 pixel texture max 1024 bones * 4 pixels = (64 * 64)\r\n\r\n\r\n\t\t\t\t\t\t\tvar size = Math.sqrt( bones.length * 4 ); // 4 pixels needed for 1 matrix\r\n\t\t\t\t\t\t\tsize = _Math.ceilPowerOfTwo( size );\r\n\t\t\t\t\t\t\tsize = Math.max( size, 4 );\r\n\r\n\t\t\t\t\t\t\tvar boneMatrices = new Float32Array( size * size * 4 ); // 4 floats per RGBA pixel\r\n\t\t\t\t\t\t\tboneMatrices.set( skeleton.boneMatrices ); // copy current values\r\n\r\n\t\t\t\t\t\t\tvar boneTexture = new DataTexture( boneMatrices, size, size, RGBAFormat, FloatType );\r\n\t\t\t\t\t\t\tboneTexture.needsUpdate = true;\r\n\r\n\t\t\t\t\t\t\tskeleton.boneMatrices = boneMatrices;\r\n\t\t\t\t\t\t\tskeleton.boneTexture = boneTexture;\r\n\t\t\t\t\t\t\tskeleton.boneTextureSize = size;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tp_uniforms.setValue( _gl, 'boneTexture', skeleton.boneTexture );\r\n\t\t\t\t\t\tp_uniforms.setValue( _gl, 'boneTextureSize', skeleton.boneTextureSize );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tp_uniforms.setOptional( _gl, skeleton, 'boneMatrices' );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( refreshMaterial ) {\r\n\r\n\t\t\t\tp_uniforms.setValue( _gl, 'toneMappingExposure', _this.toneMappingExposure );\r\n\t\t\t\tp_uniforms.setValue( _gl, 'toneMappingWhitePoint', _this.toneMappingWhitePoint );\r\n\r\n\t\t\t\tif ( material.lights ) {\r\n\r\n\t\t\t\t\t// the current material requires lighting info\r\n\r\n\t\t\t\t\t// note: all lighting uniforms are always set correctly\r\n\t\t\t\t\t// they simply reference the renderer's state for their\r\n\t\t\t\t\t// values\r\n\t\t\t\t\t//\r\n\t\t\t\t\t// use the current material's .needsUpdate flags to set\r\n\t\t\t\t\t// the GL state when required\r\n\r\n\t\t\t\t\tmarkUniformsLightsNeedsUpdate( m_uniforms, refreshLights );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// refresh uniforms common to several materials\r\n\r\n\t\t\t\tif ( fog && material.fog ) {\r\n\r\n\t\t\t\t\trefreshUniformsFog( m_uniforms, fog );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( material.isMeshBasicMaterial ) {\r\n\r\n\t\t\t\t\trefreshUniformsCommon( m_uniforms, material );\r\n\r\n\t\t\t\t} else if ( material.isMeshLambertMaterial ) {\r\n\r\n\t\t\t\t\trefreshUniformsCommon( m_uniforms, material );\r\n\t\t\t\t\trefreshUniformsLambert( m_uniforms, material );\r\n\r\n\t\t\t\t} else if ( material.isMeshPhongMaterial ) {\r\n\r\n\t\t\t\t\trefreshUniformsCommon( m_uniforms, material );\r\n\r\n\t\t\t\t\tif ( material.isMeshToonMaterial ) {\r\n\r\n\t\t\t\t\t\trefreshUniformsToon( m_uniforms, material );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\trefreshUniformsPhong( m_uniforms, material );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else if ( material.isMeshStandardMaterial ) {\r\n\r\n\t\t\t\t\trefreshUniformsCommon( m_uniforms, material );\r\n\r\n\t\t\t\t\tif ( material.isMeshPhysicalMaterial ) {\r\n\r\n\t\t\t\t\t\trefreshUniformsPhysical( m_uniforms, material );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\trefreshUniformsStandard( m_uniforms, material );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else if ( material.isMeshDepthMaterial ) {\r\n\r\n\t\t\t\t\trefreshUniformsCommon( m_uniforms, material );\r\n\t\t\t\t\trefreshUniformsDepth( m_uniforms, material );\r\n\r\n\t\t\t\t} else if ( material.isMeshDistanceMaterial ) {\r\n\r\n\t\t\t\t\trefreshUniformsCommon( m_uniforms, material );\r\n\t\t\t\t\trefreshUniformsDistance( m_uniforms, material );\r\n\r\n\t\t\t\t} else if ( material.isMeshNormalMaterial ) {\r\n\r\n\t\t\t\t\trefreshUniformsCommon( m_uniforms, material );\r\n\t\t\t\t\trefreshUniformsNormal( m_uniforms, material );\r\n\r\n\t\t\t\t} else if ( material.isLineBasicMaterial ) {\r\n\r\n\t\t\t\t\trefreshUniformsLine( m_uniforms, material );\r\n\r\n\t\t\t\t\tif ( material.isLineDashedMaterial ) {\r\n\r\n\t\t\t\t\t\trefreshUniformsDash( m_uniforms, material );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else if ( material.isPointsMaterial ) {\r\n\r\n\t\t\t\t\trefreshUniformsPoints( m_uniforms, material );\r\n\r\n\t\t\t\t} else if ( material.isSpriteMaterial ) {\r\n\r\n\t\t\t\t\trefreshUniformsSprites( m_uniforms, material );\r\n\r\n\t\t\t\t} else if ( material.isShadowMaterial ) {\r\n\r\n\t\t\t\t\tm_uniforms.color.value = material.color;\r\n\t\t\t\t\tm_uniforms.opacity.value = material.opacity;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// RectAreaLight Texture\r\n\t\t\t\t// TODO (mrdoob): Find a nicer implementation\r\n\r\n\t\t\t\tif ( m_uniforms.ltc_1 !== undefined ) m_uniforms.ltc_1.value = UniformsLib.LTC_1;\r\n\t\t\t\tif ( m_uniforms.ltc_2 !== undefined ) m_uniforms.ltc_2.value = UniformsLib.LTC_2;\r\n\r\n\t\t\t\tWebGLUniforms.upload( _gl, materialProperties.uniformsList, m_uniforms, _this );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.isShaderMaterial && material.uniformsNeedUpdate === true ) {\r\n\r\n\t\t\t\tWebGLUniforms.upload( _gl, materialProperties.uniformsList, m_uniforms, _this );\r\n\t\t\t\tmaterial.uniformsNeedUpdate = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.isSpriteMaterial ) {\r\n\r\n\t\t\t\tp_uniforms.setValue( _gl, 'center', object.center );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// common matrices\r\n\r\n\t\t\tp_uniforms.setValue( _gl, 'modelViewMatrix', object.modelViewMatrix );\r\n\t\t\tp_uniforms.setValue( _gl, 'normalMatrix', object.normalMatrix );\r\n\t\t\tp_uniforms.setValue( _gl, 'modelMatrix', object.matrixWorld );\r\n\r\n\t\t\treturn program;\r\n\r\n\t\t}\r\n\r\n\t\t// Uniforms (refresh uniforms objects)\r\n\r\n\t\tfunction refreshUniformsCommon( uniforms, material ) {\r\n\r\n\t\t\tuniforms.opacity.value = material.opacity;\r\n\r\n\t\t\tif ( material.color ) {\r\n\r\n\t\t\t\tuniforms.diffuse.value = material.color;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.emissive ) {\r\n\r\n\t\t\t\tuniforms.emissive.value.copy( material.emissive ).multiplyScalar( material.emissiveIntensity );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.map ) {\r\n\r\n\t\t\t\tuniforms.map.value = material.map;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.alphaMap ) {\r\n\r\n\t\t\t\tuniforms.alphaMap.value = material.alphaMap;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.specularMap ) {\r\n\r\n\t\t\t\tuniforms.specularMap.value = material.specularMap;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.envMap ) {\r\n\r\n\t\t\t\tuniforms.envMap.value = material.envMap;\r\n\r\n\t\t\t\t// don't flip CubeTexture envMaps, flip everything else:\r\n\t\t\t\t//  WebGLRenderTargetCube will be flipped for backwards compatibility\r\n\t\t\t\t//  WebGLRenderTargetCube.texture will be flipped because it's a Texture and NOT a CubeTexture\r\n\t\t\t\t// this check must be handled differently, or removed entirely, if WebGLRenderTargetCube uses a CubeTexture in the future\r\n\t\t\t\tuniforms.flipEnvMap.value = ( ! ( material.envMap && material.envMap.isCubeTexture ) ) ? 1 : - 1;\r\n\r\n\t\t\t\tuniforms.reflectivity.value = material.reflectivity;\r\n\t\t\t\tuniforms.refractionRatio.value = material.refractionRatio;\r\n\r\n\t\t\t\tuniforms.maxMipLevel.value = properties.get( material.envMap ).__maxMipLevel;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.lightMap ) {\r\n\r\n\t\t\t\tuniforms.lightMap.value = material.lightMap;\r\n\t\t\t\tuniforms.lightMapIntensity.value = material.lightMapIntensity;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.aoMap ) {\r\n\r\n\t\t\t\tuniforms.aoMap.value = material.aoMap;\r\n\t\t\t\tuniforms.aoMapIntensity.value = material.aoMapIntensity;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// uv repeat and offset setting priorities\r\n\t\t\t// 1. color map\r\n\t\t\t// 2. specular map\r\n\t\t\t// 3. normal map\r\n\t\t\t// 4. bump map\r\n\t\t\t// 5. alpha map\r\n\t\t\t// 6. emissive map\r\n\r\n\t\t\tvar uvScaleMap;\r\n\r\n\t\t\tif ( material.map ) {\r\n\r\n\t\t\t\tuvScaleMap = material.map;\r\n\r\n\t\t\t} else if ( material.specularMap ) {\r\n\r\n\t\t\t\tuvScaleMap = material.specularMap;\r\n\r\n\t\t\t} else if ( material.displacementMap ) {\r\n\r\n\t\t\t\tuvScaleMap = material.displacementMap;\r\n\r\n\t\t\t} else if ( material.normalMap ) {\r\n\r\n\t\t\t\tuvScaleMap = material.normalMap;\r\n\r\n\t\t\t} else if ( material.bumpMap ) {\r\n\r\n\t\t\t\tuvScaleMap = material.bumpMap;\r\n\r\n\t\t\t} else if ( material.roughnessMap ) {\r\n\r\n\t\t\t\tuvScaleMap = material.roughnessMap;\r\n\r\n\t\t\t} else if ( material.metalnessMap ) {\r\n\r\n\t\t\t\tuvScaleMap = material.metalnessMap;\r\n\r\n\t\t\t} else if ( material.alphaMap ) {\r\n\r\n\t\t\t\tuvScaleMap = material.alphaMap;\r\n\r\n\t\t\t} else if ( material.emissiveMap ) {\r\n\r\n\t\t\t\tuvScaleMap = material.emissiveMap;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( uvScaleMap !== undefined ) {\r\n\r\n\t\t\t\t// backwards compatibility\r\n\t\t\t\tif ( uvScaleMap.isWebGLRenderTarget ) {\r\n\r\n\t\t\t\t\tuvScaleMap = uvScaleMap.texture;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( uvScaleMap.matrixAutoUpdate === true ) {\r\n\r\n\t\t\t\t\tuvScaleMap.updateMatrix();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tuniforms.uvTransform.value.copy( uvScaleMap.matrix );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction refreshUniformsLine( uniforms, material ) {\r\n\r\n\t\t\tuniforms.diffuse.value = material.color;\r\n\t\t\tuniforms.opacity.value = material.opacity;\r\n\r\n\t\t}\r\n\r\n\t\tfunction refreshUniformsDash( uniforms, material ) {\r\n\r\n\t\t\tuniforms.dashSize.value = material.dashSize;\r\n\t\t\tuniforms.totalSize.value = material.dashSize + material.gapSize;\r\n\t\t\tuniforms.scale.value = material.scale;\r\n\r\n\t\t}\r\n\r\n\t\tfunction refreshUniformsPoints( uniforms, material ) {\r\n\r\n\t\t\tuniforms.diffuse.value = material.color;\r\n\t\t\tuniforms.opacity.value = material.opacity;\r\n\t\t\tuniforms.size.value = material.size * _pixelRatio;\r\n\t\t\tuniforms.scale.value = _height * 0.5;\r\n\r\n\t\t\tuniforms.map.value = material.map;\r\n\r\n\t\t\tif ( material.map !== null ) {\r\n\r\n\t\t\t\tif ( material.map.matrixAutoUpdate === true ) {\r\n\r\n\t\t\t\t\tmaterial.map.updateMatrix();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tuniforms.uvTransform.value.copy( material.map.matrix );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction refreshUniformsSprites( uniforms, material ) {\r\n\r\n\t\t\tuniforms.diffuse.value = material.color;\r\n\t\t\tuniforms.opacity.value = material.opacity;\r\n\t\t\tuniforms.rotation.value = material.rotation;\r\n\t\t\tuniforms.map.value = material.map;\r\n\r\n\t\t\tif ( material.map !== null ) {\r\n\r\n\t\t\t\tif ( material.map.matrixAutoUpdate === true ) {\r\n\r\n\t\t\t\t\tmaterial.map.updateMatrix();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tuniforms.uvTransform.value.copy( material.map.matrix );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction refreshUniformsFog( uniforms, fog ) {\r\n\r\n\t\t\tuniforms.fogColor.value = fog.color;\r\n\r\n\t\t\tif ( fog.isFog ) {\r\n\r\n\t\t\t\tuniforms.fogNear.value = fog.near;\r\n\t\t\t\tuniforms.fogFar.value = fog.far;\r\n\r\n\t\t\t} else if ( fog.isFogExp2 ) {\r\n\r\n\t\t\t\tuniforms.fogDensity.value = fog.density;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction refreshUniformsLambert( uniforms, material ) {\r\n\r\n\t\t\tif ( material.emissiveMap ) {\r\n\r\n\t\t\t\tuniforms.emissiveMap.value = material.emissiveMap;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction refreshUniformsPhong( uniforms, material ) {\r\n\r\n\t\t\tuniforms.specular.value = material.specular;\r\n\t\t\tuniforms.shininess.value = Math.max( material.shininess, 1e-4 ); // to prevent pow( 0.0, 0.0 )\r\n\r\n\t\t\tif ( material.emissiveMap ) {\r\n\r\n\t\t\t\tuniforms.emissiveMap.value = material.emissiveMap;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.bumpMap ) {\r\n\r\n\t\t\t\tuniforms.bumpMap.value = material.bumpMap;\r\n\t\t\t\tuniforms.bumpScale.value = material.bumpScale;\r\n\t\t\t\tif ( material.side === BackSide ) uniforms.bumpScale.value *= - 1;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.normalMap ) {\r\n\r\n\t\t\t\tuniforms.normalMap.value = material.normalMap;\r\n\t\t\t\tuniforms.normalScale.value.copy( material.normalScale );\r\n\t\t\t\tif ( material.side === BackSide ) uniforms.normalScale.value.negate();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.displacementMap ) {\r\n\r\n\t\t\t\tuniforms.displacementMap.value = material.displacementMap;\r\n\t\t\t\tuniforms.displacementScale.value = material.displacementScale;\r\n\t\t\t\tuniforms.displacementBias.value = material.displacementBias;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction refreshUniformsToon( uniforms, material ) {\r\n\r\n\t\t\trefreshUniformsPhong( uniforms, material );\r\n\r\n\t\t\tif ( material.gradientMap ) {\r\n\r\n\t\t\t\tuniforms.gradientMap.value = material.gradientMap;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction refreshUniformsStandard( uniforms, material ) {\r\n\r\n\t\t\tuniforms.roughness.value = material.roughness;\r\n\t\t\tuniforms.metalness.value = material.metalness;\r\n\r\n\t\t\tif ( material.roughnessMap ) {\r\n\r\n\t\t\t\tuniforms.roughnessMap.value = material.roughnessMap;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.metalnessMap ) {\r\n\r\n\t\t\t\tuniforms.metalnessMap.value = material.metalnessMap;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.emissiveMap ) {\r\n\r\n\t\t\t\tuniforms.emissiveMap.value = material.emissiveMap;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.bumpMap ) {\r\n\r\n\t\t\t\tuniforms.bumpMap.value = material.bumpMap;\r\n\t\t\t\tuniforms.bumpScale.value = material.bumpScale;\r\n\t\t\t\tif ( material.side === BackSide ) uniforms.bumpScale.value *= - 1;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.normalMap ) {\r\n\r\n\t\t\t\tuniforms.normalMap.value = material.normalMap;\r\n\t\t\t\tuniforms.normalScale.value.copy( material.normalScale );\r\n\t\t\t\tif ( material.side === BackSide ) uniforms.normalScale.value.negate();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.displacementMap ) {\r\n\r\n\t\t\t\tuniforms.displacementMap.value = material.displacementMap;\r\n\t\t\t\tuniforms.displacementScale.value = material.displacementScale;\r\n\t\t\t\tuniforms.displacementBias.value = material.displacementBias;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.envMap ) {\r\n\r\n\t\t\t\t//uniforms.envMap.value = material.envMap; // part of uniforms common\r\n\t\t\t\tuniforms.envMapIntensity.value = material.envMapIntensity;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction refreshUniformsPhysical( uniforms, material ) {\r\n\r\n\t\t\trefreshUniformsStandard( uniforms, material );\r\n\r\n\t\t\tuniforms.reflectivity.value = material.reflectivity; // also part of uniforms common\r\n\r\n\t\t\tuniforms.clearCoat.value = material.clearCoat;\r\n\t\t\tuniforms.clearCoatRoughness.value = material.clearCoatRoughness;\r\n\r\n\t\t}\r\n\r\n\t\tfunction refreshUniformsDepth( uniforms, material ) {\r\n\r\n\t\t\tif ( material.displacementMap ) {\r\n\r\n\t\t\t\tuniforms.displacementMap.value = material.displacementMap;\r\n\t\t\t\tuniforms.displacementScale.value = material.displacementScale;\r\n\t\t\t\tuniforms.displacementBias.value = material.displacementBias;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction refreshUniformsDistance( uniforms, material ) {\r\n\r\n\t\t\tif ( material.displacementMap ) {\r\n\r\n\t\t\t\tuniforms.displacementMap.value = material.displacementMap;\r\n\t\t\t\tuniforms.displacementScale.value = material.displacementScale;\r\n\t\t\t\tuniforms.displacementBias.value = material.displacementBias;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tuniforms.referencePosition.value.copy( material.referencePosition );\r\n\t\t\tuniforms.nearDistance.value = material.nearDistance;\r\n\t\t\tuniforms.farDistance.value = material.farDistance;\r\n\r\n\t\t}\r\n\r\n\t\tfunction refreshUniformsNormal( uniforms, material ) {\r\n\r\n\t\t\tif ( material.bumpMap ) {\r\n\r\n\t\t\t\tuniforms.bumpMap.value = material.bumpMap;\r\n\t\t\t\tuniforms.bumpScale.value = material.bumpScale;\r\n\t\t\t\tif ( material.side === BackSide ) uniforms.bumpScale.value *= - 1;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.normalMap ) {\r\n\r\n\t\t\t\tuniforms.normalMap.value = material.normalMap;\r\n\t\t\t\tuniforms.normalScale.value.copy( material.normalScale );\r\n\t\t\t\tif ( material.side === BackSide ) uniforms.normalScale.value.negate();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.displacementMap ) {\r\n\r\n\t\t\t\tuniforms.displacementMap.value = material.displacementMap;\r\n\t\t\t\tuniforms.displacementScale.value = material.displacementScale;\r\n\t\t\t\tuniforms.displacementBias.value = material.displacementBias;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// If uniforms are marked as clean, they don't need to be loaded to the GPU.\r\n\r\n\t\tfunction markUniformsLightsNeedsUpdate( uniforms, value ) {\r\n\r\n\t\t\tuniforms.ambientLightColor.needsUpdate = value;\r\n\r\n\t\t\tuniforms.directionalLights.needsUpdate = value;\r\n\t\t\tuniforms.pointLights.needsUpdate = value;\r\n\t\t\tuniforms.spotLights.needsUpdate = value;\r\n\t\t\tuniforms.rectAreaLights.needsUpdate = value;\r\n\t\t\tuniforms.hemisphereLights.needsUpdate = value;\r\n\r\n\t\t}\r\n\r\n\t\t// Textures\r\n\r\n\t\tfunction allocTextureUnit() {\r\n\r\n\t\t\tvar textureUnit = _usedTextureUnits;\r\n\r\n\t\t\tif ( textureUnit >= capabilities.maxTextures ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Trying to use ' + textureUnit + ' texture units while this GPU supports only ' + capabilities.maxTextures );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_usedTextureUnits += 1;\r\n\r\n\t\t\treturn textureUnit;\r\n\r\n\t\t}\r\n\r\n\t\tthis.allocTextureUnit = allocTextureUnit;\r\n\r\n\t\t// this.setTexture2D = setTexture2D;\r\n\t\tthis.setTexture2D = ( function () {\r\n\r\n\t\t\tvar warned = false;\r\n\r\n\t\t\t// backwards compatibility: peel texture.texture\r\n\t\t\treturn function setTexture2D( texture, slot ) {\r\n\r\n\t\t\t\tif ( texture && texture.isWebGLRenderTarget ) {\r\n\r\n\t\t\t\t\tif ( ! warned ) {\r\n\r\n\t\t\t\t\t\tconsole.warn( \"THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead.\" );\r\n\t\t\t\t\t\twarned = true;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ttexture = texture.texture;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttextures.setTexture2D( texture, slot );\r\n\r\n\t\t\t};\r\n\r\n\t\t}() );\r\n\r\n\t\tthis.setTexture = ( function () {\r\n\r\n\t\t\tvar warned = false;\r\n\r\n\t\t\treturn function setTexture( texture, slot ) {\r\n\r\n\t\t\t\tif ( ! warned ) {\r\n\r\n\t\t\t\t\tconsole.warn( \"THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead.\" );\r\n\t\t\t\t\twarned = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttextures.setTexture2D( texture, slot );\r\n\r\n\t\t\t};\r\n\r\n\t\t}() );\r\n\r\n\t\tthis.setTextureCube = ( function () {\r\n\r\n\t\t\tvar warned = false;\r\n\r\n\t\t\treturn function setTextureCube( texture, slot ) {\r\n\r\n\t\t\t\t// backwards compatibility: peel texture.texture\r\n\t\t\t\tif ( texture && texture.isWebGLRenderTargetCube ) {\r\n\r\n\t\t\t\t\tif ( ! warned ) {\r\n\r\n\t\t\t\t\t\tconsole.warn( \"THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead.\" );\r\n\t\t\t\t\t\twarned = true;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ttexture = texture.texture;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// currently relying on the fact that WebGLRenderTargetCube.texture is a Texture and NOT a CubeTexture\r\n\t\t\t\t// TODO: unify these code paths\r\n\t\t\t\tif ( ( texture && texture.isCubeTexture ) ||\r\n\t\t\t\t\t( Array.isArray( texture.image ) && texture.image.length === 6 ) ) {\r\n\r\n\t\t\t\t\t// CompressedTexture can have Array in image :/\r\n\r\n\t\t\t\t\t// this function alone should take care of cube textures\r\n\t\t\t\t\ttextures.setTextureCube( texture, slot );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// assumed: texture property of THREE.WebGLRenderTargetCube\r\n\r\n\t\t\t\t\ttextures.setTextureCubeDynamic( texture, slot );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\r\n\t\t}() );\r\n\r\n\t\t//\r\n\r\n\t\tthis.setFramebuffer = function ( value ) {\r\n\r\n\t\t\t_framebuffer = value;\r\n\r\n\t\t};\r\n\r\n\t\tthis.getRenderTarget = function () {\r\n\r\n\t\t\treturn _currentRenderTarget;\r\n\r\n\t\t};\r\n\r\n\t\tthis.setRenderTarget = function ( renderTarget ) {\r\n\r\n\t\t\t_currentRenderTarget = renderTarget;\r\n\r\n\t\t\tif ( renderTarget && properties.get( renderTarget ).__webglFramebuffer === undefined ) {\r\n\r\n\t\t\t\ttextures.setupRenderTarget( renderTarget );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar framebuffer = _framebuffer;\r\n\t\t\tvar isCube = false;\r\n\r\n\t\t\tif ( renderTarget ) {\r\n\r\n\t\t\t\tvar __webglFramebuffer = properties.get( renderTarget ).__webglFramebuffer;\r\n\r\n\t\t\t\tif ( renderTarget.isWebGLRenderTargetCube ) {\r\n\r\n\t\t\t\t\tframebuffer = __webglFramebuffer[ renderTarget.activeCubeFace ];\r\n\t\t\t\t\tisCube = true;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tframebuffer = __webglFramebuffer;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t_currentViewport.copy( renderTarget.viewport );\r\n\t\t\t\t_currentScissor.copy( renderTarget.scissor );\r\n\t\t\t\t_currentScissorTest = renderTarget.scissorTest;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t_currentViewport.copy( _viewport ).multiplyScalar( _pixelRatio );\r\n\t\t\t\t_currentScissor.copy( _scissor ).multiplyScalar( _pixelRatio );\r\n\t\t\t\t_currentScissorTest = _scissorTest;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( _currentFramebuffer !== framebuffer ) {\r\n\r\n\t\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, framebuffer );\r\n\t\t\t\t_currentFramebuffer = framebuffer;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tstate.viewport( _currentViewport );\r\n\t\t\tstate.scissor( _currentScissor );\r\n\t\t\tstate.setScissorTest( _currentScissorTest );\r\n\r\n\t\t\tif ( isCube ) {\r\n\r\n\t\t\t\tvar textureProperties = properties.get( renderTarget.texture );\r\n\t\t\t\t_gl.framebufferTexture2D( _gl.FRAMEBUFFER, _gl.COLOR_ATTACHMENT0, _gl.TEXTURE_CUBE_MAP_POSITIVE_X + renderTarget.activeCubeFace, textureProperties.__webglTexture, renderTarget.activeMipMapLevel );\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t\tthis.readRenderTargetPixels = function ( renderTarget, x, y, width, height, buffer ) {\r\n\r\n\t\t\tif ( ! ( renderTarget && renderTarget.isWebGLRenderTarget ) ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.' );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar framebuffer = properties.get( renderTarget ).__webglFramebuffer;\r\n\r\n\t\t\tif ( framebuffer ) {\r\n\r\n\t\t\t\tvar restore = false;\r\n\r\n\t\t\t\tif ( framebuffer !== _currentFramebuffer ) {\r\n\r\n\t\t\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, framebuffer );\r\n\r\n\t\t\t\t\trestore = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttry {\r\n\r\n\t\t\t\t\tvar texture = renderTarget.texture;\r\n\t\t\t\t\tvar textureFormat = texture.format;\r\n\t\t\t\t\tvar textureType = texture.type;\r\n\r\n\t\t\t\t\tif ( textureFormat !== RGBAFormat && utils.convert( textureFormat ) !== _gl.getParameter( _gl.IMPLEMENTATION_COLOR_READ_FORMAT ) ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.' );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( textureType !== UnsignedByteType && utils.convert( textureType ) !== _gl.getParameter( _gl.IMPLEMENTATION_COLOR_READ_TYPE ) && // IE11, Edge and Chrome Mac < 52 (#9513)\r\n\t\t\t\t\t\t! ( textureType === FloatType && ( capabilities.isWebGL2 || extensions.get( 'OES_texture_float' ) || extensions.get( 'WEBGL_color_buffer_float' ) ) ) && // Chrome Mac >= 52 and Firefox\r\n\t\t\t\t\t\t! ( textureType === HalfFloatType && ( capabilities.isWebGL2 ? extensions.get( 'EXT_color_buffer_float' ) : extensions.get( 'EXT_color_buffer_half_float' ) ) ) ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.' );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( _gl.checkFramebufferStatus( _gl.FRAMEBUFFER ) === _gl.FRAMEBUFFER_COMPLETE ) {\r\n\r\n\t\t\t\t\t\t// the following if statement ensures valid read requests (no out-of-bounds pixels, see #8604)\r\n\r\n\t\t\t\t\t\tif ( ( x >= 0 && x <= ( renderTarget.width - width ) ) && ( y >= 0 && y <= ( renderTarget.height - height ) ) ) {\r\n\r\n\t\t\t\t\t\t\t_gl.readPixels( x, y, width, height, utils.convert( textureFormat ), utils.convert( textureType ), buffer );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.' );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} finally {\r\n\r\n\t\t\t\t\tif ( restore ) {\r\n\r\n\t\t\t\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, _currentFramebuffer );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t\tthis.copyFramebufferToTexture = function ( position, texture, level ) {\r\n\r\n\t\t\tvar width = texture.image.width;\r\n\t\t\tvar height = texture.image.height;\r\n\t\t\tvar glFormat = utils.convert( texture.format );\r\n\r\n\t\t\tthis.setTexture2D( texture, 0 );\r\n\r\n\t\t\t_gl.copyTexImage2D( _gl.TEXTURE_2D, level || 0, glFormat, position.x, position.y, width, height, 0 );\r\n\r\n\t\t};\r\n\r\n\t\tthis.copyTextureToTexture = function ( position, srcTexture, dstTexture, level ) {\r\n\r\n\t\t\tvar width = srcTexture.image.width;\r\n\t\t\tvar height = srcTexture.image.height;\r\n\t\t\tvar glFormat = utils.convert( dstTexture.format );\r\n\t\t\tvar glType = utils.convert( dstTexture.type );\r\n\r\n\t\t\tthis.setTexture2D( dstTexture, 0 );\r\n\r\n\t\t\tif ( srcTexture.isDataTexture ) {\r\n\r\n\t\t\t\t_gl.texSubImage2D( _gl.TEXTURE_2D, level || 0, position.x, position.y, width, height, glFormat, glType, srcTexture.image.data );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t_gl.texSubImage2D( _gl.TEXTURE_2D, level || 0, position.x, position.y, glFormat, glType, srcTexture.image );\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\r\n\tfunction FogExp2( color, density ) {\r\n\r\n\t\tthis.name = '';\r\n\r\n\t\tthis.color = new Color( color );\r\n\t\tthis.density = ( density !== undefined ) ? density : 0.00025;\r\n\r\n\t}\r\n\r\n\tFogExp2.prototype.isFogExp2 = true;\r\n\r\n\tFogExp2.prototype.clone = function () {\r\n\r\n\t\treturn new FogExp2( this.color, this.density );\r\n\r\n\t};\r\n\r\n\tFogExp2.prototype.toJSON = function ( /* meta */ ) {\r\n\r\n\t\treturn {\r\n\t\t\ttype: 'FogExp2',\r\n\t\t\tcolor: this.color.getHex(),\r\n\t\t\tdensity: this.density\r\n\t\t};\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\r\n\tfunction Fog( color, near, far ) {\r\n\r\n\t\tthis.name = '';\r\n\r\n\t\tthis.color = new Color( color );\r\n\r\n\t\tthis.near = ( near !== undefined ) ? near : 1;\r\n\t\tthis.far = ( far !== undefined ) ? far : 1000;\r\n\r\n\t}\r\n\r\n\tFog.prototype.isFog = true;\r\n\r\n\tFog.prototype.clone = function () {\r\n\r\n\t\treturn new Fog( this.color, this.near, this.far );\r\n\r\n\t};\r\n\r\n\tFog.prototype.toJSON = function ( /* meta */ ) {\r\n\r\n\t\treturn {\r\n\t\t\ttype: 'Fog',\r\n\t\t\tcolor: this.color.getHex(),\r\n\t\t\tnear: this.near,\r\n\t\t\tfar: this.far\r\n\t\t};\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction Scene() {\r\n\r\n\t\tObject3D.call( this );\r\n\r\n\t\tthis.type = 'Scene';\r\n\r\n\t\tthis.background = null;\r\n\t\tthis.fog = null;\r\n\t\tthis.overrideMaterial = null;\r\n\r\n\t\tthis.autoUpdate = true; // checked by the renderer\r\n\r\n\t}\r\n\r\n\tScene.prototype = Object.assign( Object.create( Object3D.prototype ), {\r\n\r\n\t\tconstructor: Scene,\r\n\r\n\t\tcopy: function ( source, recursive ) {\r\n\r\n\t\t\tObject3D.prototype.copy.call( this, source, recursive );\r\n\r\n\t\t\tif ( source.background !== null ) this.background = source.background.clone();\r\n\t\t\tif ( source.fog !== null ) this.fog = source.fog.clone();\r\n\t\t\tif ( source.overrideMaterial !== null ) this.overrideMaterial = source.overrideMaterial.clone();\r\n\r\n\t\t\tthis.autoUpdate = source.autoUpdate;\r\n\t\t\tthis.matrixAutoUpdate = source.matrixAutoUpdate;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function ( meta ) {\r\n\r\n\t\t\tvar data = Object3D.prototype.toJSON.call( this, meta );\r\n\r\n\t\t\tif ( this.background !== null ) data.object.background = this.background.toJSON( meta );\r\n\t\t\tif ( this.fog !== null ) data.object.fog = this.fog.toJSON();\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author benaadams / https://twitter.com/ben_a_adams\r\n\t */\r\n\r\n\tfunction InterleavedBuffer( array, stride ) {\r\n\r\n\t\tthis.array = array;\r\n\t\tthis.stride = stride;\r\n\t\tthis.count = array !== undefined ? array.length / stride : 0;\r\n\r\n\t\tthis.dynamic = false;\r\n\t\tthis.updateRange = { offset: 0, count: - 1 };\r\n\r\n\t\tthis.version = 0;\r\n\r\n\t}\r\n\r\n\tObject.defineProperty( InterleavedBuffer.prototype, 'needsUpdate', {\r\n\r\n\t\tset: function ( value ) {\r\n\r\n\t\t\tif ( value === true ) this.version ++;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( InterleavedBuffer.prototype, {\r\n\r\n\t\tisInterleavedBuffer: true,\r\n\r\n\t\tonUploadCallback: function () {},\r\n\r\n\t\tsetArray: function ( array ) {\r\n\r\n\t\t\tif ( Array.isArray( array ) ) {\r\n\r\n\t\t\t\tthrow new TypeError( 'THREE.BufferAttribute: array should be a Typed Array.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.count = array !== undefined ? array.length / this.stride : 0;\r\n\t\t\tthis.array = array;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetDynamic: function ( value ) {\r\n\r\n\t\t\tthis.dynamic = value;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tthis.array = new source.array.constructor( source.array );\r\n\t\t\tthis.count = source.count;\r\n\t\t\tthis.stride = source.stride;\r\n\t\t\tthis.dynamic = source.dynamic;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcopyAt: function ( index1, attribute, index2 ) {\r\n\r\n\t\t\tindex1 *= this.stride;\r\n\t\t\tindex2 *= attribute.stride;\r\n\r\n\t\t\tfor ( var i = 0, l = this.stride; i < l; i ++ ) {\r\n\r\n\t\t\t\tthis.array[ index1 + i ] = attribute.array[ index2 + i ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tset: function ( value, offset ) {\r\n\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\t\tthis.array.set( value, offset );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tonUpload: function ( callback ) {\r\n\r\n\t\t\tthis.onUploadCallback = callback;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author benaadams / https://twitter.com/ben_a_adams\r\n\t */\r\n\r\n\tfunction InterleavedBufferAttribute( interleavedBuffer, itemSize, offset, normalized ) {\r\n\r\n\t\tthis.data = interleavedBuffer;\r\n\t\tthis.itemSize = itemSize;\r\n\t\tthis.offset = offset;\r\n\r\n\t\tthis.normalized = normalized === true;\r\n\r\n\t}\r\n\r\n\tObject.defineProperties( InterleavedBufferAttribute.prototype, {\r\n\r\n\t\tcount: {\r\n\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\treturn this.data.count;\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tarray: {\r\n\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\treturn this.data.array;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( InterleavedBufferAttribute.prototype, {\r\n\r\n\t\tisInterleavedBufferAttribute: true,\r\n\r\n\t\tsetX: function ( index, x ) {\r\n\r\n\t\t\tthis.data.array[ index * this.data.stride + this.offset ] = x;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetY: function ( index, y ) {\r\n\r\n\t\t\tthis.data.array[ index * this.data.stride + this.offset + 1 ] = y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetZ: function ( index, z ) {\r\n\r\n\t\t\tthis.data.array[ index * this.data.stride + this.offset + 2 ] = z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetW: function ( index, w ) {\r\n\r\n\t\t\tthis.data.array[ index * this.data.stride + this.offset + 3 ] = w;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetX: function ( index ) {\r\n\r\n\t\t\treturn this.data.array[ index * this.data.stride + this.offset ];\r\n\r\n\t\t},\r\n\r\n\t\tgetY: function ( index ) {\r\n\r\n\t\t\treturn this.data.array[ index * this.data.stride + this.offset + 1 ];\r\n\r\n\t\t},\r\n\r\n\t\tgetZ: function ( index ) {\r\n\r\n\t\t\treturn this.data.array[ index * this.data.stride + this.offset + 2 ];\r\n\r\n\t\t},\r\n\r\n\t\tgetW: function ( index ) {\r\n\r\n\t\t\treturn this.data.array[ index * this.data.stride + this.offset + 3 ];\r\n\r\n\t\t},\r\n\r\n\t\tsetXY: function ( index, x, y ) {\r\n\r\n\t\t\tindex = index * this.data.stride + this.offset;\r\n\r\n\t\t\tthis.data.array[ index + 0 ] = x;\r\n\t\t\tthis.data.array[ index + 1 ] = y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetXYZ: function ( index, x, y, z ) {\r\n\r\n\t\t\tindex = index * this.data.stride + this.offset;\r\n\r\n\t\t\tthis.data.array[ index + 0 ] = x;\r\n\t\t\tthis.data.array[ index + 1 ] = y;\r\n\t\t\tthis.data.array[ index + 2 ] = z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetXYZW: function ( index, x, y, z, w ) {\r\n\r\n\t\t\tindex = index * this.data.stride + this.offset;\r\n\r\n\t\t\tthis.data.array[ index + 0 ] = x;\r\n\t\t\tthis.data.array[ index + 1 ] = y;\r\n\t\t\tthis.data.array[ index + 2 ] = z;\r\n\t\t\tthis.data.array[ index + 3 ] = w;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t *\r\n\t * parameters = {\r\n\t *  color: <hex>,\r\n\t *  map: new THREE.Texture( <Image> ),\r\n\t *  rotation: <float>,\r\n\t *  sizeAttenuation: <bool>\r\n\t * }\r\n\t */\r\n\r\n\tfunction SpriteMaterial( parameters ) {\r\n\r\n\t\tMaterial.call( this );\r\n\r\n\t\tthis.type = 'SpriteMaterial';\r\n\r\n\t\tthis.color = new Color( 0xffffff );\r\n\t\tthis.map = null;\r\n\r\n\t\tthis.rotation = 0;\r\n\r\n\t\tthis.sizeAttenuation = true;\r\n\r\n\t\tthis.lights = false;\r\n\t\tthis.transparent = true;\r\n\r\n\t\tthis.setValues( parameters );\r\n\r\n\t}\r\n\r\n\tSpriteMaterial.prototype = Object.create( Material.prototype );\r\n\tSpriteMaterial.prototype.constructor = SpriteMaterial;\r\n\tSpriteMaterial.prototype.isSpriteMaterial = true;\r\n\r\n\tSpriteMaterial.prototype.copy = function ( source ) {\r\n\r\n\t\tMaterial.prototype.copy.call( this, source );\r\n\r\n\t\tthis.color.copy( source.color );\r\n\t\tthis.map = source.map;\r\n\r\n\t\tthis.rotation = source.rotation;\r\n\r\n\t\tthis.sizeAttenuation = source.sizeAttenuation;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\r\n\tvar geometry;\r\n\r\n\tfunction Sprite( material ) {\r\n\r\n\t\tObject3D.call( this );\r\n\r\n\t\tthis.type = 'Sprite';\r\n\r\n\t\tif ( geometry === undefined ) {\r\n\r\n\t\t\tgeometry = new BufferGeometry();\r\n\r\n\t\t\tvar float32Array = new Float32Array( [\r\n\t\t\t\t- 0.5, - 0.5, 0, 0, 0,\r\n\t\t\t\t0.5, - 0.5, 0, 1, 0,\r\n\t\t\t\t0.5, 0.5, 0, 1, 1,\r\n\t\t\t\t- 0.5, 0.5, 0, 0, 1\r\n\t\t\t] );\r\n\r\n\t\t\tvar interleavedBuffer = new InterleavedBuffer( float32Array, 5 );\r\n\r\n\t\t\tgeometry.setIndex( [ 0, 1, 2,\t0, 2, 3 ] );\r\n\t\t\tgeometry.addAttribute( 'position', new InterleavedBufferAttribute( interleavedBuffer, 3, 0, false ) );\r\n\t\t\tgeometry.addAttribute( 'uv', new InterleavedBufferAttribute( interleavedBuffer, 2, 3, false ) );\r\n\r\n\t\t}\r\n\r\n\t\tthis.geometry = geometry;\r\n\t\tthis.material = ( material !== undefined ) ? material : new SpriteMaterial();\r\n\r\n\t\tthis.center = new Vector2( 0.5, 0.5 );\r\n\r\n\t}\r\n\r\n\tSprite.prototype = Object.assign( Object.create( Object3D.prototype ), {\r\n\r\n\t\tconstructor: Sprite,\r\n\r\n\t\tisSprite: true,\r\n\r\n\t\traycast: ( function () {\r\n\r\n\t\t\tvar intersectPoint = new Vector3();\r\n\t\t\tvar worldScale = new Vector3();\r\n\t\t\tvar mvPosition = new Vector3();\r\n\r\n\t\t\tvar alignedPosition = new Vector2();\r\n\t\t\tvar rotatedPosition = new Vector2();\r\n\t\t\tvar viewWorldMatrix = new Matrix4();\r\n\r\n\t\t\tvar vA = new Vector3();\r\n\t\t\tvar vB = new Vector3();\r\n\t\t\tvar vC = new Vector3();\r\n\r\n\t\t\tfunction transformVertex( vertexPosition, mvPosition, center, scale, sin, cos ) {\r\n\r\n\t\t\t\t// compute position in camera space\r\n\t\t\t\talignedPosition.subVectors( vertexPosition, center ).addScalar( 0.5 ).multiply( scale );\r\n\r\n\t\t\t\t// to check if rotation is not zero\r\n\t\t\t\tif ( sin !== undefined ) {\r\n\r\n\t\t\t\t\trotatedPosition.x = ( cos * alignedPosition.x ) - ( sin * alignedPosition.y );\r\n\t\t\t\t\trotatedPosition.y = ( sin * alignedPosition.x ) + ( cos * alignedPosition.y );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\trotatedPosition.copy( alignedPosition );\r\n\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t\tvertexPosition.copy( mvPosition );\r\n\t\t\t\tvertexPosition.x += rotatedPosition.x;\r\n\t\t\t\tvertexPosition.y += rotatedPosition.y;\r\n\r\n\t\t\t\t// transform to world space\r\n\t\t\t\tvertexPosition.applyMatrix4( viewWorldMatrix );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn function raycast( raycaster, intersects ) {\r\n\r\n\t\t\t\tworldScale.setFromMatrixScale( this.matrixWorld );\r\n\t\t\t\tviewWorldMatrix.getInverse( this.modelViewMatrix ).premultiply( this.matrixWorld );\r\n\t\t\t\tmvPosition.setFromMatrixPosition( this.modelViewMatrix );\r\n\r\n\t\t\t\tvar rotation = this.material.rotation;\r\n\t\t\t\tvar sin, cos;\r\n\t\t\t\tif ( rotation !== 0 ) {\r\n\r\n\t\t\t\t\tcos = Math.cos( rotation );\r\n\t\t\t\t\tsin = Math.sin( rotation );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar center = this.center;\r\n\r\n\t\t\t\ttransformVertex( vA.set( - 0.5, - 0.5, 0 ), mvPosition, center, worldScale, sin, cos );\r\n\t\t\t\ttransformVertex( vB.set( 0.5, - 0.5, 0 ), mvPosition, center, worldScale, sin, cos );\r\n\t\t\t\ttransformVertex( vC.set( 0.5, 0.5, 0 ), mvPosition, center, worldScale, sin, cos );\r\n\r\n\t\t\t\t// check first triangle\r\n\t\t\t\tvar intersect = raycaster.ray.intersectTriangle( vA, vB, vC, false, intersectPoint );\r\n\r\n\t\t\t\tif ( intersect === null ) {\r\n\r\n\t\t\t\t\t// check second triangle\r\n\t\t\t\t\ttransformVertex( vB.set( - 0.5, 0.5, 0 ), mvPosition, center, worldScale, sin, cos );\r\n\t\t\t\t\tintersect = raycaster.ray.intersectTriangle( vA, vC, vB, false, intersectPoint );\r\n\t\t\t\t\tif ( intersect === null ) {\r\n\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( intersectPoint );\r\n\r\n\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) return;\r\n\r\n\t\t\t\tintersects.push( {\r\n\r\n\t\t\t\t\tdistance: distance,\r\n\t\t\t\t\tpoint: intersectPoint.clone(),\r\n\t\t\t\t\tface: null,\r\n\t\t\t\t\tobject: this\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t};\r\n\r\n\t\t}() ),\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor( this.material ).copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tObject3D.prototype.copy.call( this, source );\r\n\r\n\t\t\tif ( source.center !== undefined ) this.center.copy( source.center );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction LOD() {\r\n\r\n\t\tObject3D.call( this );\r\n\r\n\t\tthis.type = 'LOD';\r\n\r\n\t\tObject.defineProperties( this, {\r\n\t\t\tlevels: {\r\n\t\t\t\tenumerable: true,\r\n\t\t\t\tvalue: []\r\n\t\t\t}\r\n\t\t} );\r\n\r\n\t}\r\n\r\n\tLOD.prototype = Object.assign( Object.create( Object3D.prototype ), {\r\n\r\n\t\tconstructor: LOD,\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tObject3D.prototype.copy.call( this, source, false );\r\n\r\n\t\t\tvar levels = source.levels;\r\n\r\n\t\t\tfor ( var i = 0, l = levels.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar level = levels[ i ];\r\n\r\n\t\t\t\tthis.addLevel( level.object.clone(), level.distance );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\taddLevel: function ( object, distance ) {\r\n\r\n\t\t\tif ( distance === undefined ) distance = 0;\r\n\r\n\t\t\tdistance = Math.abs( distance );\r\n\r\n\t\t\tvar levels = this.levels;\r\n\r\n\t\t\tfor ( var l = 0; l < levels.length; l ++ ) {\r\n\r\n\t\t\t\tif ( distance < levels[ l ].distance ) {\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tlevels.splice( l, 0, { distance: distance, object: object } );\r\n\r\n\t\t\tthis.add( object );\r\n\r\n\t\t},\r\n\r\n\t\tgetObjectForDistance: function ( distance ) {\r\n\r\n\t\t\tvar levels = this.levels;\r\n\r\n\t\t\tfor ( var i = 1, l = levels.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tif ( distance < levels[ i ].distance ) {\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn levels[ i - 1 ].object;\r\n\r\n\t\t},\r\n\r\n\t\traycast: ( function () {\r\n\r\n\t\t\tvar matrixPosition = new Vector3();\r\n\r\n\t\t\treturn function raycast( raycaster, intersects ) {\r\n\r\n\t\t\t\tmatrixPosition.setFromMatrixPosition( this.matrixWorld );\r\n\r\n\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( matrixPosition );\r\n\r\n\t\t\t\tthis.getObjectForDistance( distance ).raycast( raycaster, intersects );\r\n\r\n\t\t\t};\r\n\r\n\t\t}() ),\r\n\r\n\t\tupdate: function () {\r\n\r\n\t\t\tvar v1 = new Vector3();\r\n\t\t\tvar v2 = new Vector3();\r\n\r\n\t\t\treturn function update( camera ) {\r\n\r\n\t\t\t\tvar levels = this.levels;\r\n\r\n\t\t\t\tif ( levels.length > 1 ) {\r\n\r\n\t\t\t\t\tv1.setFromMatrixPosition( camera.matrixWorld );\r\n\t\t\t\t\tv2.setFromMatrixPosition( this.matrixWorld );\r\n\r\n\t\t\t\t\tvar distance = v1.distanceTo( v2 );\r\n\r\n\t\t\t\t\tlevels[ 0 ].object.visible = true;\r\n\r\n\t\t\t\t\tfor ( var i = 1, l = levels.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\t\tif ( distance >= levels[ i ].distance ) {\r\n\r\n\t\t\t\t\t\t\tlevels[ i - 1 ].object.visible = false;\r\n\t\t\t\t\t\t\tlevels[ i ].object.visible = true;\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfor ( ; i < l; i ++ ) {\r\n\r\n\t\t\t\t\t\tlevels[ i ].object.visible = false;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\ttoJSON: function ( meta ) {\r\n\r\n\t\t\tvar data = Object3D.prototype.toJSON.call( this, meta );\r\n\r\n\t\t\tdata.object.levels = [];\r\n\r\n\t\t\tvar levels = this.levels;\r\n\r\n\t\t\tfor ( var i = 0, l = levels.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar level = levels[ i ];\r\n\r\n\t\t\t\tdata.object.levels.push( {\r\n\t\t\t\t\tobject: level.object.uuid,\r\n\t\t\t\t\tdistance: level.distance\r\n\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author michael guerrero / http://realitymeltdown.com\r\n\t * @author ikerr / http://verold.com\r\n\t */\r\n\r\n\tfunction Skeleton( bones, boneInverses ) {\r\n\r\n\t\t// copy the bone array\r\n\r\n\t\tbones = bones || [];\r\n\r\n\t\tthis.bones = bones.slice( 0 );\r\n\t\tthis.boneMatrices = new Float32Array( this.bones.length * 16 );\r\n\r\n\t\t// use the supplied bone inverses or calculate the inverses\r\n\r\n\t\tif ( boneInverses === undefined ) {\r\n\r\n\t\t\tthis.calculateInverses();\r\n\r\n\t\t} else {\r\n\r\n\t\t\tif ( this.bones.length === boneInverses.length ) {\r\n\r\n\t\t\t\tthis.boneInverses = boneInverses.slice( 0 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Skeleton boneInverses is the wrong length.' );\r\n\r\n\t\t\t\tthis.boneInverses = [];\r\n\r\n\t\t\t\tfor ( var i = 0, il = this.bones.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\tthis.boneInverses.push( new Matrix4() );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tObject.assign( Skeleton.prototype, {\r\n\r\n\t\tcalculateInverses: function () {\r\n\r\n\t\t\tthis.boneInverses = [];\r\n\r\n\t\t\tfor ( var i = 0, il = this.bones.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvar inverse = new Matrix4();\r\n\r\n\t\t\t\tif ( this.bones[ i ] ) {\r\n\r\n\t\t\t\t\tinverse.getInverse( this.bones[ i ].matrixWorld );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.boneInverses.push( inverse );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tpose: function () {\r\n\r\n\t\t\tvar bone, i, il;\r\n\r\n\t\t\t// recover the bind-time world matrices\r\n\r\n\t\t\tfor ( i = 0, il = this.bones.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tbone = this.bones[ i ];\r\n\r\n\t\t\t\tif ( bone ) {\r\n\r\n\t\t\t\t\tbone.matrixWorld.getInverse( this.boneInverses[ i ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// compute the local matrices, positions, rotations and scales\r\n\r\n\t\t\tfor ( i = 0, il = this.bones.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tbone = this.bones[ i ];\r\n\r\n\t\t\t\tif ( bone ) {\r\n\r\n\t\t\t\t\tif ( bone.parent && bone.parent.isBone ) {\r\n\r\n\t\t\t\t\t\tbone.matrix.getInverse( bone.parent.matrixWorld );\r\n\t\t\t\t\t\tbone.matrix.multiply( bone.matrixWorld );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tbone.matrix.copy( bone.matrixWorld );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbone.matrix.decompose( bone.position, bone.quaternion, bone.scale );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tupdate: ( function () {\r\n\r\n\t\t\tvar offsetMatrix = new Matrix4();\r\n\t\t\tvar identityMatrix = new Matrix4();\r\n\r\n\t\t\treturn function update() {\r\n\r\n\t\t\t\tvar bones = this.bones;\r\n\t\t\t\tvar boneInverses = this.boneInverses;\r\n\t\t\t\tvar boneMatrices = this.boneMatrices;\r\n\t\t\t\tvar boneTexture = this.boneTexture;\r\n\r\n\t\t\t\t// flatten bone matrices to array\r\n\r\n\t\t\t\tfor ( var i = 0, il = bones.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t// compute the offset between the current and the original transform\r\n\r\n\t\t\t\t\tvar matrix = bones[ i ] ? bones[ i ].matrixWorld : identityMatrix;\r\n\r\n\t\t\t\t\toffsetMatrix.multiplyMatrices( matrix, boneInverses[ i ] );\r\n\t\t\t\t\toffsetMatrix.toArray( boneMatrices, i * 16 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( boneTexture !== undefined ) {\r\n\r\n\t\t\t\t\tboneTexture.needsUpdate = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\r\n\t\t} )(),\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new Skeleton( this.bones, this.boneInverses );\r\n\r\n\t\t},\r\n\r\n\t\tgetBoneByName: function ( name ) {\r\n\r\n\t\t\tfor ( var i = 0, il = this.bones.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvar bone = this.bones[ i ];\r\n\r\n\t\t\t\tif ( bone.name === name ) {\r\n\r\n\t\t\t\t\treturn bone;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn undefined;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author ikerr / http://verold.com\r\n\t */\r\n\r\n\tfunction Bone() {\r\n\r\n\t\tObject3D.call( this );\r\n\r\n\t\tthis.type = 'Bone';\r\n\r\n\t}\r\n\r\n\tBone.prototype = Object.assign( Object.create( Object3D.prototype ), {\r\n\r\n\t\tconstructor: Bone,\r\n\r\n\t\tisBone: true\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author ikerr / http://verold.com\r\n\t */\r\n\r\n\tfunction SkinnedMesh( geometry, material ) {\r\n\r\n\t\tMesh.call( this, geometry, material );\r\n\r\n\t\tthis.type = 'SkinnedMesh';\r\n\r\n\t\tthis.bindMode = 'attached';\r\n\t\tthis.bindMatrix = new Matrix4();\r\n\t\tthis.bindMatrixInverse = new Matrix4();\r\n\r\n\t\tvar bones = this.initBones();\r\n\t\tvar skeleton = new Skeleton( bones );\r\n\r\n\t\tthis.bind( skeleton, this.matrixWorld );\r\n\r\n\t\tthis.normalizeSkinWeights();\r\n\r\n\t}\r\n\r\n\tSkinnedMesh.prototype = Object.assign( Object.create( Mesh.prototype ), {\r\n\r\n\t\tconstructor: SkinnedMesh,\r\n\r\n\t\tisSkinnedMesh: true,\r\n\r\n\t\tinitBones: function () {\r\n\r\n\t\t\tvar bones = [], bone, gbone;\r\n\t\t\tvar i, il;\r\n\r\n\t\t\tif ( this.geometry && this.geometry.bones !== undefined ) {\r\n\r\n\t\t\t\t// first, create array of 'Bone' objects from geometry data\r\n\r\n\t\t\t\tfor ( i = 0, il = this.geometry.bones.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\tgbone = this.geometry.bones[ i ];\r\n\r\n\t\t\t\t\t// create new 'Bone' object\r\n\r\n\t\t\t\t\tbone = new Bone();\r\n\t\t\t\t\tbones.push( bone );\r\n\r\n\t\t\t\t\t// apply values\r\n\r\n\t\t\t\t\tbone.name = gbone.name;\r\n\t\t\t\t\tbone.position.fromArray( gbone.pos );\r\n\t\t\t\t\tbone.quaternion.fromArray( gbone.rotq );\r\n\t\t\t\t\tif ( gbone.scl !== undefined ) bone.scale.fromArray( gbone.scl );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// second, create bone hierarchy\r\n\r\n\t\t\t\tfor ( i = 0, il = this.geometry.bones.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\tgbone = this.geometry.bones[ i ];\r\n\r\n\t\t\t\t\tif ( ( gbone.parent !== - 1 ) && ( gbone.parent !== null ) && ( bones[ gbone.parent ] !== undefined ) ) {\r\n\r\n\t\t\t\t\t\t// subsequent bones in the hierarchy\r\n\r\n\t\t\t\t\t\tbones[ gbone.parent ].add( bones[ i ] );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// topmost bone, immediate child of the skinned mesh\r\n\r\n\t\t\t\t\t\tthis.add( bones[ i ] );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// now the bones are part of the scene graph and children of the skinned mesh.\r\n\t\t\t// let's update the corresponding matrices\r\n\r\n\t\t\tthis.updateMatrixWorld( true );\r\n\r\n\t\t\treturn bones;\r\n\r\n\t\t},\r\n\r\n\t\tbind: function ( skeleton, bindMatrix ) {\r\n\r\n\t\t\tthis.skeleton = skeleton;\r\n\r\n\t\t\tif ( bindMatrix === undefined ) {\r\n\r\n\t\t\t\tthis.updateMatrixWorld( true );\r\n\r\n\t\t\t\tthis.skeleton.calculateInverses();\r\n\r\n\t\t\t\tbindMatrix = this.matrixWorld;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.bindMatrix.copy( bindMatrix );\r\n\t\t\tthis.bindMatrixInverse.getInverse( bindMatrix );\r\n\r\n\t\t},\r\n\r\n\t\tpose: function () {\r\n\r\n\t\t\tthis.skeleton.pose();\r\n\r\n\t\t},\r\n\r\n\t\tnormalizeSkinWeights: function () {\r\n\r\n\t\t\tvar scale, i;\r\n\r\n\t\t\tif ( this.geometry && this.geometry.isGeometry ) {\r\n\r\n\t\t\t\tfor ( i = 0; i < this.geometry.skinWeights.length; i ++ ) {\r\n\r\n\t\t\t\t\tvar sw = this.geometry.skinWeights[ i ];\r\n\r\n\t\t\t\t\tscale = 1.0 / sw.manhattanLength();\r\n\r\n\t\t\t\t\tif ( scale !== Infinity ) {\r\n\r\n\t\t\t\t\t\tsw.multiplyScalar( scale );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tsw.set( 1, 0, 0, 0 ); // do something reasonable\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( this.geometry && this.geometry.isBufferGeometry ) {\r\n\r\n\t\t\t\tvar vec = new Vector4();\r\n\r\n\t\t\t\tvar skinWeight = this.geometry.attributes.skinWeight;\r\n\r\n\t\t\t\tfor ( i = 0; i < skinWeight.count; i ++ ) {\r\n\r\n\t\t\t\t\tvec.x = skinWeight.getX( i );\r\n\t\t\t\t\tvec.y = skinWeight.getY( i );\r\n\t\t\t\t\tvec.z = skinWeight.getZ( i );\r\n\t\t\t\t\tvec.w = skinWeight.getW( i );\r\n\r\n\t\t\t\t\tscale = 1.0 / vec.manhattanLength();\r\n\r\n\t\t\t\t\tif ( scale !== Infinity ) {\r\n\r\n\t\t\t\t\t\tvec.multiplyScalar( scale );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tvec.set( 1, 0, 0, 0 ); // do something reasonable\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tskinWeight.setXYZW( i, vec.x, vec.y, vec.z, vec.w );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tupdateMatrixWorld: function ( force ) {\r\n\r\n\t\t\tMesh.prototype.updateMatrixWorld.call( this, force );\r\n\r\n\t\t\tif ( this.bindMode === 'attached' ) {\r\n\r\n\t\t\t\tthis.bindMatrixInverse.getInverse( this.matrixWorld );\r\n\r\n\t\t\t} else if ( this.bindMode === 'detached' ) {\r\n\r\n\t\t\t\tthis.bindMatrixInverse.getInverse( this.bindMatrix );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.SkinnedMesh: Unrecognized bindMode: ' + this.bindMode );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor( this.geometry, this.material ).copy( this );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t *\r\n\t * parameters = {\r\n\t *  color: <hex>,\r\n\t *  opacity: <float>,\r\n\t *\r\n\t *  linewidth: <float>,\r\n\t *  linecap: \"round\",\r\n\t *  linejoin: \"round\"\r\n\t * }\r\n\t */\r\n\r\n\tfunction LineBasicMaterial( parameters ) {\r\n\r\n\t\tMaterial.call( this );\r\n\r\n\t\tthis.type = 'LineBasicMaterial';\r\n\r\n\t\tthis.color = new Color( 0xffffff );\r\n\r\n\t\tthis.linewidth = 1;\r\n\t\tthis.linecap = 'round';\r\n\t\tthis.linejoin = 'round';\r\n\r\n\t\tthis.lights = false;\r\n\r\n\t\tthis.setValues( parameters );\r\n\r\n\t}\r\n\r\n\tLineBasicMaterial.prototype = Object.create( Material.prototype );\r\n\tLineBasicMaterial.prototype.constructor = LineBasicMaterial;\r\n\r\n\tLineBasicMaterial.prototype.isLineBasicMaterial = true;\r\n\r\n\tLineBasicMaterial.prototype.copy = function ( source ) {\r\n\r\n\t\tMaterial.prototype.copy.call( this, source );\r\n\r\n\t\tthis.color.copy( source.color );\r\n\r\n\t\tthis.linewidth = source.linewidth;\r\n\t\tthis.linecap = source.linecap;\r\n\t\tthis.linejoin = source.linejoin;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction Line( geometry, material, mode ) {\r\n\r\n\t\tif ( mode === 1 ) {\r\n\r\n\t\t\tconsole.error( 'THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead.' );\r\n\r\n\t\t}\r\n\r\n\t\tObject3D.call( this );\r\n\r\n\t\tthis.type = 'Line';\r\n\r\n\t\tthis.geometry = geometry !== undefined ? geometry : new BufferGeometry();\r\n\t\tthis.material = material !== undefined ? material : new LineBasicMaterial( { color: Math.random() * 0xffffff } );\r\n\r\n\t}\r\n\r\n\tLine.prototype = Object.assign( Object.create( Object3D.prototype ), {\r\n\r\n\t\tconstructor: Line,\r\n\r\n\t\tisLine: true,\r\n\r\n\t\tcomputeLineDistances: ( function () {\r\n\r\n\t\t\tvar start = new Vector3();\r\n\t\t\tvar end = new Vector3();\r\n\r\n\t\t\treturn function computeLineDistances() {\r\n\r\n\t\t\t\tvar geometry = this.geometry;\r\n\r\n\t\t\t\tif ( geometry.isBufferGeometry ) {\r\n\r\n\t\t\t\t\t// we assume non-indexed geometry\r\n\r\n\t\t\t\t\tif ( geometry.index === null ) {\r\n\r\n\t\t\t\t\t\tvar positionAttribute = geometry.attributes.position;\r\n\t\t\t\t\t\tvar lineDistances = [ 0 ];\r\n\r\n\t\t\t\t\t\tfor ( var i = 1, l = positionAttribute.count; i < l; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tstart.fromBufferAttribute( positionAttribute, i - 1 );\r\n\t\t\t\t\t\t\tend.fromBufferAttribute( positionAttribute, i );\r\n\r\n\t\t\t\t\t\t\tlineDistances[ i ] = lineDistances[ i - 1 ];\r\n\t\t\t\t\t\t\tlineDistances[ i ] += start.distanceTo( end );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tgeometry.addAttribute( 'lineDistance', new Float32BufferAttribute( lineDistances, 1 ) );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tconsole.warn( 'THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.' );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else if ( geometry.isGeometry ) {\r\n\r\n\t\t\t\t\tvar vertices = geometry.vertices;\r\n\t\t\t\t\tvar lineDistances = geometry.lineDistances;\r\n\r\n\t\t\t\t\tlineDistances[ 0 ] = 0;\r\n\r\n\t\t\t\t\tfor ( var i = 1, l = vertices.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\t\tlineDistances[ i ] = lineDistances[ i - 1 ];\r\n\t\t\t\t\t\tlineDistances[ i ] += vertices[ i - 1 ].distanceTo( vertices[ i ] );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t};\r\n\r\n\t\t}() ),\r\n\r\n\t\traycast: ( function () {\r\n\r\n\t\t\tvar inverseMatrix = new Matrix4();\r\n\t\t\tvar ray = new Ray();\r\n\t\t\tvar sphere = new Sphere();\r\n\r\n\t\t\treturn function raycast( raycaster, intersects ) {\r\n\r\n\t\t\t\tvar precision = raycaster.linePrecision;\r\n\t\t\t\tvar precisionSq = precision * precision;\r\n\r\n\t\t\t\tvar geometry = this.geometry;\r\n\t\t\t\tvar matrixWorld = this.matrixWorld;\r\n\r\n\t\t\t\t// Checking boundingSphere distance to ray\r\n\r\n\t\t\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\r\n\r\n\t\t\t\tsphere.copy( geometry.boundingSphere );\r\n\t\t\t\tsphere.applyMatrix4( matrixWorld );\r\n\r\n\t\t\t\tif ( raycaster.ray.intersectsSphere( sphere ) === false ) return;\r\n\r\n\t\t\t\t//\r\n\r\n\t\t\t\tinverseMatrix.getInverse( matrixWorld );\r\n\t\t\t\tray.copy( raycaster.ray ).applyMatrix4( inverseMatrix );\r\n\r\n\t\t\t\tvar vStart = new Vector3();\r\n\t\t\t\tvar vEnd = new Vector3();\r\n\t\t\t\tvar interSegment = new Vector3();\r\n\t\t\t\tvar interRay = new Vector3();\r\n\t\t\t\tvar step = ( this && this.isLineSegments ) ? 2 : 1;\r\n\r\n\t\t\t\tif ( geometry.isBufferGeometry ) {\r\n\r\n\t\t\t\t\tvar index = geometry.index;\r\n\t\t\t\t\tvar attributes = geometry.attributes;\r\n\t\t\t\t\tvar positions = attributes.position.array;\r\n\r\n\t\t\t\t\tif ( index !== null ) {\r\n\r\n\t\t\t\t\t\tvar indices = index.array;\r\n\r\n\t\t\t\t\t\tfor ( var i = 0, l = indices.length - 1; i < l; i += step ) {\r\n\r\n\t\t\t\t\t\t\tvar a = indices[ i ];\r\n\t\t\t\t\t\t\tvar b = indices[ i + 1 ];\r\n\r\n\t\t\t\t\t\t\tvStart.fromArray( positions, a * 3 );\r\n\t\t\t\t\t\t\tvEnd.fromArray( positions, b * 3 );\r\n\r\n\t\t\t\t\t\t\tvar distSq = ray.distanceSqToSegment( vStart, vEnd, interRay, interSegment );\r\n\r\n\t\t\t\t\t\t\tif ( distSq > precisionSq ) continue;\r\n\r\n\t\t\t\t\t\t\tinterRay.applyMatrix4( this.matrixWorld ); //Move back to world space for distance calculation\r\n\r\n\t\t\t\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( interRay );\r\n\r\n\t\t\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) continue;\r\n\r\n\t\t\t\t\t\t\tintersects.push( {\r\n\r\n\t\t\t\t\t\t\t\tdistance: distance,\r\n\t\t\t\t\t\t\t\t// What do we want? intersection point on the ray or on the segment??\r\n\t\t\t\t\t\t\t\t// point: raycaster.ray.at( distance ),\r\n\t\t\t\t\t\t\t\tpoint: interSegment.clone().applyMatrix4( this.matrixWorld ),\r\n\t\t\t\t\t\t\t\tindex: i,\r\n\t\t\t\t\t\t\t\tface: null,\r\n\t\t\t\t\t\t\t\tfaceIndex: null,\r\n\t\t\t\t\t\t\t\tobject: this\r\n\r\n\t\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tfor ( var i = 0, l = positions.length / 3 - 1; i < l; i += step ) {\r\n\r\n\t\t\t\t\t\t\tvStart.fromArray( positions, 3 * i );\r\n\t\t\t\t\t\t\tvEnd.fromArray( positions, 3 * i + 3 );\r\n\r\n\t\t\t\t\t\t\tvar distSq = ray.distanceSqToSegment( vStart, vEnd, interRay, interSegment );\r\n\r\n\t\t\t\t\t\t\tif ( distSq > precisionSq ) continue;\r\n\r\n\t\t\t\t\t\t\tinterRay.applyMatrix4( this.matrixWorld ); //Move back to world space for distance calculation\r\n\r\n\t\t\t\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( interRay );\r\n\r\n\t\t\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) continue;\r\n\r\n\t\t\t\t\t\t\tintersects.push( {\r\n\r\n\t\t\t\t\t\t\t\tdistance: distance,\r\n\t\t\t\t\t\t\t\t// What do we want? intersection point on the ray or on the segment??\r\n\t\t\t\t\t\t\t\t// point: raycaster.ray.at( distance ),\r\n\t\t\t\t\t\t\t\tpoint: interSegment.clone().applyMatrix4( this.matrixWorld ),\r\n\t\t\t\t\t\t\t\tindex: i,\r\n\t\t\t\t\t\t\t\tface: null,\r\n\t\t\t\t\t\t\t\tfaceIndex: null,\r\n\t\t\t\t\t\t\t\tobject: this\r\n\r\n\t\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else if ( geometry.isGeometry ) {\r\n\r\n\t\t\t\t\tvar vertices = geometry.vertices;\r\n\t\t\t\t\tvar nbVertices = vertices.length;\r\n\r\n\t\t\t\t\tfor ( var i = 0; i < nbVertices - 1; i += step ) {\r\n\r\n\t\t\t\t\t\tvar distSq = ray.distanceSqToSegment( vertices[ i ], vertices[ i + 1 ], interRay, interSegment );\r\n\r\n\t\t\t\t\t\tif ( distSq > precisionSq ) continue;\r\n\r\n\t\t\t\t\t\tinterRay.applyMatrix4( this.matrixWorld ); //Move back to world space for distance calculation\r\n\r\n\t\t\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( interRay );\r\n\r\n\t\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) continue;\r\n\r\n\t\t\t\t\t\tintersects.push( {\r\n\r\n\t\t\t\t\t\t\tdistance: distance,\r\n\t\t\t\t\t\t\t// What do we want? intersection point on the ray or on the segment??\r\n\t\t\t\t\t\t\t// point: raycaster.ray.at( distance ),\r\n\t\t\t\t\t\t\tpoint: interSegment.clone().applyMatrix4( this.matrixWorld ),\r\n\t\t\t\t\t\t\tindex: i,\r\n\t\t\t\t\t\t\tface: null,\r\n\t\t\t\t\t\t\tfaceIndex: null,\r\n\t\t\t\t\t\t\tobject: this\r\n\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\r\n\t\t}() ),\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor( this.geometry, this.material ).copy( this );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction LineSegments( geometry, material ) {\r\n\r\n\t\tLine.call( this, geometry, material );\r\n\r\n\t\tthis.type = 'LineSegments';\r\n\r\n\t}\r\n\r\n\tLineSegments.prototype = Object.assign( Object.create( Line.prototype ), {\r\n\r\n\t\tconstructor: LineSegments,\r\n\r\n\t\tisLineSegments: true,\r\n\r\n\t\tcomputeLineDistances: ( function () {\r\n\r\n\t\t\tvar start = new Vector3();\r\n\t\t\tvar end = new Vector3();\r\n\r\n\t\t\treturn function computeLineDistances() {\r\n\r\n\t\t\t\tvar geometry = this.geometry;\r\n\r\n\t\t\t\tif ( geometry.isBufferGeometry ) {\r\n\r\n\t\t\t\t\t// we assume non-indexed geometry\r\n\r\n\t\t\t\t\tif ( geometry.index === null ) {\r\n\r\n\t\t\t\t\t\tvar positionAttribute = geometry.attributes.position;\r\n\t\t\t\t\t\tvar lineDistances = [];\r\n\r\n\t\t\t\t\t\tfor ( var i = 0, l = positionAttribute.count; i < l; i += 2 ) {\r\n\r\n\t\t\t\t\t\t\tstart.fromBufferAttribute( positionAttribute, i );\r\n\t\t\t\t\t\t\tend.fromBufferAttribute( positionAttribute, i + 1 );\r\n\r\n\t\t\t\t\t\t\tlineDistances[ i ] = ( i === 0 ) ? 0 : lineDistances[ i - 1 ];\r\n\t\t\t\t\t\t\tlineDistances[ i + 1 ] = lineDistances[ i ] + start.distanceTo( end );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tgeometry.addAttribute( 'lineDistance', new Float32BufferAttribute( lineDistances, 1 ) );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tconsole.warn( 'THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.' );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else if ( geometry.isGeometry ) {\r\n\r\n\t\t\t\t\tvar vertices = geometry.vertices;\r\n\t\t\t\t\tvar lineDistances = geometry.lineDistances;\r\n\r\n\t\t\t\t\tfor ( var i = 0, l = vertices.length; i < l; i += 2 ) {\r\n\r\n\t\t\t\t\t\tstart.copy( vertices[ i ] );\r\n\t\t\t\t\t\tend.copy( vertices[ i + 1 ] );\r\n\r\n\t\t\t\t\t\tlineDistances[ i ] = ( i === 0 ) ? 0 : lineDistances[ i - 1 ];\r\n\t\t\t\t\t\tlineDistances[ i + 1 ] = lineDistances[ i ] + start.distanceTo( end );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t};\r\n\r\n\t\t}() )\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mgreter / http://github.com/mgreter\r\n\t */\r\n\r\n\tfunction LineLoop( geometry, material ) {\r\n\r\n\t\tLine.call( this, geometry, material );\r\n\r\n\t\tthis.type = 'LineLoop';\r\n\r\n\t}\r\n\r\n\tLineLoop.prototype = Object.assign( Object.create( Line.prototype ), {\r\n\r\n\t\tconstructor: LineLoop,\r\n\r\n\t\tisLineLoop: true,\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t *\r\n\t * parameters = {\r\n\t *  color: <hex>,\r\n\t *  opacity: <float>,\r\n\t *  map: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  size: <float>,\r\n\t *  sizeAttenuation: <bool>\r\n\t *\r\n\t *  morphTargets: <bool>\r\n\t * }\r\n\t */\r\n\r\n\tfunction PointsMaterial( parameters ) {\r\n\r\n\t\tMaterial.call( this );\r\n\r\n\t\tthis.type = 'PointsMaterial';\r\n\r\n\t\tthis.color = new Color( 0xffffff );\r\n\r\n\t\tthis.map = null;\r\n\r\n\t\tthis.size = 1;\r\n\t\tthis.sizeAttenuation = true;\r\n\r\n\t\tthis.morphTargets = false;\r\n\r\n\t\tthis.lights = false;\r\n\r\n\t\tthis.setValues( parameters );\r\n\r\n\t}\r\n\r\n\tPointsMaterial.prototype = Object.create( Material.prototype );\r\n\tPointsMaterial.prototype.constructor = PointsMaterial;\r\n\r\n\tPointsMaterial.prototype.isPointsMaterial = true;\r\n\r\n\tPointsMaterial.prototype.copy = function ( source ) {\r\n\r\n\t\tMaterial.prototype.copy.call( this, source );\r\n\r\n\t\tthis.color.copy( source.color );\r\n\r\n\t\tthis.map = source.map;\r\n\r\n\t\tthis.size = source.size;\r\n\t\tthis.sizeAttenuation = source.sizeAttenuation;\r\n\r\n\t\tthis.morphTargets = source.morphTargets;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\r\n\tfunction Points( geometry, material ) {\r\n\r\n\t\tObject3D.call( this );\r\n\r\n\t\tthis.type = 'Points';\r\n\r\n\t\tthis.geometry = geometry !== undefined ? geometry : new BufferGeometry();\r\n\t\tthis.material = material !== undefined ? material : new PointsMaterial( { color: Math.random() * 0xffffff } );\r\n\r\n\t}\r\n\r\n\tPoints.prototype = Object.assign( Object.create( Object3D.prototype ), {\r\n\r\n\t\tconstructor: Points,\r\n\r\n\t\tisPoints: true,\r\n\r\n\t\traycast: ( function () {\r\n\r\n\t\t\tvar inverseMatrix = new Matrix4();\r\n\t\t\tvar ray = new Ray();\r\n\t\t\tvar sphere = new Sphere();\r\n\r\n\t\t\treturn function raycast( raycaster, intersects ) {\r\n\r\n\t\t\t\tvar object = this;\r\n\t\t\t\tvar geometry = this.geometry;\r\n\t\t\t\tvar matrixWorld = this.matrixWorld;\r\n\t\t\t\tvar threshold = raycaster.params.Points.threshold;\r\n\r\n\t\t\t\t// Checking boundingSphere distance to ray\r\n\r\n\t\t\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\r\n\r\n\t\t\t\tsphere.copy( geometry.boundingSphere );\r\n\t\t\t\tsphere.applyMatrix4( matrixWorld );\r\n\t\t\t\tsphere.radius += threshold;\r\n\r\n\t\t\t\tif ( raycaster.ray.intersectsSphere( sphere ) === false ) return;\r\n\r\n\t\t\t\t//\r\n\r\n\t\t\t\tinverseMatrix.getInverse( matrixWorld );\r\n\t\t\t\tray.copy( raycaster.ray ).applyMatrix4( inverseMatrix );\r\n\r\n\t\t\t\tvar localThreshold = threshold / ( ( this.scale.x + this.scale.y + this.scale.z ) / 3 );\r\n\t\t\t\tvar localThresholdSq = localThreshold * localThreshold;\r\n\t\t\t\tvar position = new Vector3();\r\n\t\t\t\tvar intersectPoint = new Vector3();\r\n\r\n\t\t\t\tfunction testPoint( point, index ) {\r\n\r\n\t\t\t\t\tvar rayPointDistanceSq = ray.distanceSqToPoint( point );\r\n\r\n\t\t\t\t\tif ( rayPointDistanceSq < localThresholdSq ) {\r\n\r\n\t\t\t\t\t\tray.closestPointToPoint( point, intersectPoint );\r\n\t\t\t\t\t\tintersectPoint.applyMatrix4( matrixWorld );\r\n\r\n\t\t\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( intersectPoint );\r\n\r\n\t\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) return;\r\n\r\n\t\t\t\t\t\tintersects.push( {\r\n\r\n\t\t\t\t\t\t\tdistance: distance,\r\n\t\t\t\t\t\t\tdistanceToRay: Math.sqrt( rayPointDistanceSq ),\r\n\t\t\t\t\t\t\tpoint: intersectPoint.clone(),\r\n\t\t\t\t\t\t\tindex: index,\r\n\t\t\t\t\t\t\tface: null,\r\n\t\t\t\t\t\t\tobject: object\r\n\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( geometry.isBufferGeometry ) {\r\n\r\n\t\t\t\t\tvar index = geometry.index;\r\n\t\t\t\t\tvar attributes = geometry.attributes;\r\n\t\t\t\t\tvar positions = attributes.position.array;\r\n\r\n\t\t\t\t\tif ( index !== null ) {\r\n\r\n\t\t\t\t\t\tvar indices = index.array;\r\n\r\n\t\t\t\t\t\tfor ( var i = 0, il = indices.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tvar a = indices[ i ];\r\n\r\n\t\t\t\t\t\t\tposition.fromArray( positions, a * 3 );\r\n\r\n\t\t\t\t\t\t\ttestPoint( position, a );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tfor ( var i = 0, l = positions.length / 3; i < l; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tposition.fromArray( positions, i * 3 );\r\n\r\n\t\t\t\t\t\t\ttestPoint( position, i );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tvar vertices = geometry.vertices;\r\n\r\n\t\t\t\t\tfor ( var i = 0, l = vertices.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\t\ttestPoint( vertices[ i ], i );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\r\n\t\t}() ),\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor( this.geometry, this.material ).copy( this );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction VideoTexture( video, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy ) {\r\n\r\n\t\tTexture.call( this, video, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\r\n\r\n\t\tthis.generateMipmaps = false;\r\n\r\n\t}\r\n\r\n\tVideoTexture.prototype = Object.assign( Object.create( Texture.prototype ), {\r\n\r\n\t\tconstructor: VideoTexture,\r\n\r\n\t\tisVideoTexture: true,\r\n\r\n\t\tupdate: function () {\r\n\r\n\t\t\tvar video = this.image;\r\n\r\n\t\t\tif ( video.readyState >= video.HAVE_CURRENT_DATA ) {\r\n\r\n\t\t\t\tthis.needsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\r\n\tfunction CompressedTexture( mipmaps, width, height, format, type, mapping, wrapS, wrapT, magFilter, minFilter, anisotropy, encoding ) {\r\n\r\n\t\tTexture.call( this, null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, encoding );\r\n\r\n\t\tthis.image = { width: width, height: height };\r\n\t\tthis.mipmaps = mipmaps;\r\n\r\n\t\t// no flipping for cube textures\r\n\t\t// (also flipping doesn't work for compressed textures )\r\n\r\n\t\tthis.flipY = false;\r\n\r\n\t\t// can't generate mipmaps for compressed textures\r\n\t\t// mips must be embedded in DDS files\r\n\r\n\t\tthis.generateMipmaps = false;\r\n\r\n\t}\r\n\r\n\tCompressedTexture.prototype = Object.create( Texture.prototype );\r\n\tCompressedTexture.prototype.constructor = CompressedTexture;\r\n\r\n\tCompressedTexture.prototype.isCompressedTexture = true;\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction CanvasTexture( canvas, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy ) {\r\n\r\n\t\tTexture.call( this, canvas, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\r\n\r\n\t\tthis.needsUpdate = true;\r\n\r\n\t}\r\n\r\n\tCanvasTexture.prototype = Object.create( Texture.prototype );\r\n\tCanvasTexture.prototype.constructor = CanvasTexture;\r\n\tCanvasTexture.prototype.isCanvasTexture = true;\r\n\r\n\t/**\r\n\t * @author Matt DesLauriers / @mattdesl\r\n\t * @author atix / arthursilber.de\r\n\t */\r\n\r\n\tfunction DepthTexture( width, height, type, mapping, wrapS, wrapT, magFilter, minFilter, anisotropy, format ) {\r\n\r\n\t\tformat = format !== undefined ? format : DepthFormat;\r\n\r\n\t\tif ( format !== DepthFormat && format !== DepthStencilFormat ) {\r\n\r\n\t\t\tthrow new Error( 'DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat' );\r\n\r\n\t\t}\r\n\r\n\t\tif ( type === undefined && format === DepthFormat ) type = UnsignedShortType;\r\n\t\tif ( type === undefined && format === DepthStencilFormat ) type = UnsignedInt248Type;\r\n\r\n\t\tTexture.call( this, null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\r\n\r\n\t\tthis.image = { width: width, height: height };\r\n\r\n\t\tthis.magFilter = magFilter !== undefined ? magFilter : NearestFilter;\r\n\t\tthis.minFilter = minFilter !== undefined ? minFilter : NearestFilter;\r\n\r\n\t\tthis.flipY = false;\r\n\t\tthis.generateMipmaps\t= false;\r\n\r\n\t}\r\n\r\n\tDepthTexture.prototype = Object.create( Texture.prototype );\r\n\tDepthTexture.prototype.constructor = DepthTexture;\r\n\tDepthTexture.prototype.isDepthTexture = true;\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t */\r\n\r\n\tfunction WireframeGeometry( geometry ) {\r\n\r\n\t\tBufferGeometry.call( this );\r\n\r\n\t\tthis.type = 'WireframeGeometry';\r\n\r\n\t\t// buffer\r\n\r\n\t\tvar vertices = [];\r\n\r\n\t\t// helper variables\r\n\r\n\t\tvar i, j, l, o, ol;\r\n\t\tvar edge = [ 0, 0 ], edges = {}, e, edge1, edge2;\r\n\t\tvar key, keys = [ 'a', 'b', 'c' ];\r\n\t\tvar vertex;\r\n\r\n\t\t// different logic for Geometry and BufferGeometry\r\n\r\n\t\tif ( geometry && geometry.isGeometry ) {\r\n\r\n\t\t\t// create a data structure that contains all edges without duplicates\r\n\r\n\t\t\tvar faces = geometry.faces;\r\n\r\n\t\t\tfor ( i = 0, l = faces.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar face = faces[ i ];\r\n\r\n\t\t\t\tfor ( j = 0; j < 3; j ++ ) {\r\n\r\n\t\t\t\t\tedge1 = face[ keys[ j ] ];\r\n\t\t\t\t\tedge2 = face[ keys[ ( j + 1 ) % 3 ] ];\r\n\t\t\t\t\tedge[ 0 ] = Math.min( edge1, edge2 ); // sorting prevents duplicates\r\n\t\t\t\t\tedge[ 1 ] = Math.max( edge1, edge2 );\r\n\r\n\t\t\t\t\tkey = edge[ 0 ] + ',' + edge[ 1 ];\r\n\r\n\t\t\t\t\tif ( edges[ key ] === undefined ) {\r\n\r\n\t\t\t\t\t\tedges[ key ] = { index1: edge[ 0 ], index2: edge[ 1 ] };\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// generate vertices\r\n\r\n\t\t\tfor ( key in edges ) {\r\n\r\n\t\t\t\te = edges[ key ];\r\n\r\n\t\t\t\tvertex = geometry.vertices[ e.index1 ];\r\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t\tvertex = geometry.vertices[ e.index2 ];\r\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( geometry && geometry.isBufferGeometry ) {\r\n\r\n\t\t\tvar position, indices, groups;\r\n\t\t\tvar group, start, count;\r\n\t\t\tvar index1, index2;\r\n\r\n\t\t\tvertex = new Vector3();\r\n\r\n\t\t\tif ( geometry.index !== null ) {\r\n\r\n\t\t\t\t// indexed BufferGeometry\r\n\r\n\t\t\t\tposition = geometry.attributes.position;\r\n\t\t\t\tindices = geometry.index;\r\n\t\t\t\tgroups = geometry.groups;\r\n\r\n\t\t\t\tif ( groups.length === 0 ) {\r\n\r\n\t\t\t\t\tgroups = [ { start: 0, count: indices.count, materialIndex: 0 } ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// create a data structure that contains all eges without duplicates\r\n\r\n\t\t\t\tfor ( o = 0, ol = groups.length; o < ol; ++ o ) {\r\n\r\n\t\t\t\t\tgroup = groups[ o ];\r\n\r\n\t\t\t\t\tstart = group.start;\r\n\t\t\t\t\tcount = group.count;\r\n\r\n\t\t\t\t\tfor ( i = start, l = ( start + count ); i < l; i += 3 ) {\r\n\r\n\t\t\t\t\t\tfor ( j = 0; j < 3; j ++ ) {\r\n\r\n\t\t\t\t\t\t\tedge1 = indices.getX( i + j );\r\n\t\t\t\t\t\t\tedge2 = indices.getX( i + ( j + 1 ) % 3 );\r\n\t\t\t\t\t\t\tedge[ 0 ] = Math.min( edge1, edge2 ); // sorting prevents duplicates\r\n\t\t\t\t\t\t\tedge[ 1 ] = Math.max( edge1, edge2 );\r\n\r\n\t\t\t\t\t\t\tkey = edge[ 0 ] + ',' + edge[ 1 ];\r\n\r\n\t\t\t\t\t\t\tif ( edges[ key ] === undefined ) {\r\n\r\n\t\t\t\t\t\t\t\tedges[ key ] = { index1: edge[ 0 ], index2: edge[ 1 ] };\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// generate vertices\r\n\r\n\t\t\t\tfor ( key in edges ) {\r\n\r\n\t\t\t\t\te = edges[ key ];\r\n\r\n\t\t\t\t\tvertex.fromBufferAttribute( position, e.index1 );\r\n\t\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t\t\tvertex.fromBufferAttribute( position, e.index2 );\r\n\t\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// non-indexed BufferGeometry\r\n\r\n\t\t\t\tposition = geometry.attributes.position;\r\n\r\n\t\t\t\tfor ( i = 0, l = ( position.count / 3 ); i < l; i ++ ) {\r\n\r\n\t\t\t\t\tfor ( j = 0; j < 3; j ++ ) {\r\n\r\n\t\t\t\t\t\t// three edges per triangle, an edge is represented as (index1, index2)\r\n\t\t\t\t\t\t// e.g. the first triangle has the following edges: (0,1),(1,2),(2,0)\r\n\r\n\t\t\t\t\t\tindex1 = 3 * i + j;\r\n\t\t\t\t\t\tvertex.fromBufferAttribute( position, index1 );\r\n\t\t\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t\t\t\tindex2 = 3 * i + ( ( j + 1 ) % 3 );\r\n\t\t\t\t\t\tvertex.fromBufferAttribute( position, index2 );\r\n\t\t\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// build geometry\r\n\r\n\t\tthis.addAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\r\n\t}\r\n\r\n\tWireframeGeometry.prototype = Object.create( BufferGeometry.prototype );\r\n\tWireframeGeometry.prototype.constructor = WireframeGeometry;\r\n\r\n\t/**\r\n\t * @author zz85 / https://github.com/zz85\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t *\r\n\t * Parametric Surfaces Geometry\r\n\t * based on the brilliant article by @prideout http://prideout.net/blog/?p=44\r\n\t */\r\n\r\n\t// ParametricGeometry\r\n\r\n\tfunction ParametricGeometry( func, slices, stacks ) {\r\n\r\n\t\tGeometry.call( this );\r\n\r\n\t\tthis.type = 'ParametricGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tfunc: func,\r\n\t\t\tslices: slices,\r\n\t\t\tstacks: stacks\r\n\t\t};\r\n\r\n\t\tthis.fromBufferGeometry( new ParametricBufferGeometry( func, slices, stacks ) );\r\n\t\tthis.mergeVertices();\r\n\r\n\t}\r\n\r\n\tParametricGeometry.prototype = Object.create( Geometry.prototype );\r\n\tParametricGeometry.prototype.constructor = ParametricGeometry;\r\n\r\n\t// ParametricBufferGeometry\r\n\r\n\tfunction ParametricBufferGeometry( func, slices, stacks ) {\r\n\r\n\t\tBufferGeometry.call( this );\r\n\r\n\t\tthis.type = 'ParametricBufferGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tfunc: func,\r\n\t\t\tslices: slices,\r\n\t\t\tstacks: stacks\r\n\t\t};\r\n\r\n\t\t// buffers\r\n\r\n\t\tvar indices = [];\r\n\t\tvar vertices = [];\r\n\t\tvar normals = [];\r\n\t\tvar uvs = [];\r\n\r\n\t\tvar EPS = 0.00001;\r\n\r\n\t\tvar normal = new Vector3();\r\n\r\n\t\tvar p0 = new Vector3(), p1 = new Vector3();\r\n\t\tvar pu = new Vector3(), pv = new Vector3();\r\n\r\n\t\tvar i, j;\r\n\r\n\t\tif ( func.length < 3 ) {\r\n\r\n\t\t\tconsole.error( 'THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.' );\r\n\r\n\t\t}\r\n\r\n\t\t// generate vertices, normals and uvs\r\n\r\n\t\tvar sliceCount = slices + 1;\r\n\r\n\t\tfor ( i = 0; i <= stacks; i ++ ) {\r\n\r\n\t\t\tvar v = i / stacks;\r\n\r\n\t\t\tfor ( j = 0; j <= slices; j ++ ) {\r\n\r\n\t\t\t\tvar u = j / slices;\r\n\r\n\t\t\t\t// vertex\r\n\r\n\t\t\t\tfunc( u, v, p0 );\r\n\t\t\t\tvertices.push( p0.x, p0.y, p0.z );\r\n\r\n\t\t\t\t// normal\r\n\r\n\t\t\t\t// approximate tangent vectors via finite differences\r\n\r\n\t\t\t\tif ( u - EPS >= 0 ) {\r\n\r\n\t\t\t\t\tfunc( u - EPS, v, p1 );\r\n\t\t\t\t\tpu.subVectors( p0, p1 );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tfunc( u + EPS, v, p1 );\r\n\t\t\t\t\tpu.subVectors( p1, p0 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( v - EPS >= 0 ) {\r\n\r\n\t\t\t\t\tfunc( u, v - EPS, p1 );\r\n\t\t\t\t\tpv.subVectors( p0, p1 );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tfunc( u, v + EPS, p1 );\r\n\t\t\t\t\tpv.subVectors( p1, p0 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// cross product of tangent vectors returns surface normal\r\n\r\n\t\t\t\tnormal.crossVectors( pu, pv ).normalize();\r\n\t\t\t\tnormals.push( normal.x, normal.y, normal.z );\r\n\r\n\t\t\t\t// uv\r\n\r\n\t\t\t\tuvs.push( u, v );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// generate indices\r\n\r\n\t\tfor ( i = 0; i < stacks; i ++ ) {\r\n\r\n\t\t\tfor ( j = 0; j < slices; j ++ ) {\r\n\r\n\t\t\t\tvar a = i * sliceCount + j;\r\n\t\t\t\tvar b = i * sliceCount + j + 1;\r\n\t\t\t\tvar c = ( i + 1 ) * sliceCount + j + 1;\r\n\t\t\t\tvar d = ( i + 1 ) * sliceCount + j;\r\n\r\n\t\t\t\t// faces one and two\r\n\r\n\t\t\t\tindices.push( a, b, d );\r\n\t\t\t\tindices.push( b, c, d );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// build geometry\r\n\r\n\t\tthis.setIndex( indices );\r\n\t\tthis.addAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\t\tthis.addAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\r\n\t\tthis.addAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\r\n\r\n\t}\r\n\r\n\tParametricBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\r\n\tParametricBufferGeometry.prototype.constructor = ParametricBufferGeometry;\r\n\r\n\t/**\r\n\t * @author clockworkgeek / https://github.com/clockworkgeek\r\n\t * @author timothypratley / https://github.com/timothypratley\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t */\r\n\r\n\t// PolyhedronGeometry\r\n\r\n\tfunction PolyhedronGeometry( vertices, indices, radius, detail ) {\r\n\r\n\t\tGeometry.call( this );\r\n\r\n\t\tthis.type = 'PolyhedronGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tvertices: vertices,\r\n\t\t\tindices: indices,\r\n\t\t\tradius: radius,\r\n\t\t\tdetail: detail\r\n\t\t};\r\n\r\n\t\tthis.fromBufferGeometry( new PolyhedronBufferGeometry( vertices, indices, radius, detail ) );\r\n\t\tthis.mergeVertices();\r\n\r\n\t}\r\n\r\n\tPolyhedronGeometry.prototype = Object.create( Geometry.prototype );\r\n\tPolyhedronGeometry.prototype.constructor = PolyhedronGeometry;\r\n\r\n\t// PolyhedronBufferGeometry\r\n\r\n\tfunction PolyhedronBufferGeometry( vertices, indices, radius, detail ) {\r\n\r\n\t\tBufferGeometry.call( this );\r\n\r\n\t\tthis.type = 'PolyhedronBufferGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tvertices: vertices,\r\n\t\t\tindices: indices,\r\n\t\t\tradius: radius,\r\n\t\t\tdetail: detail\r\n\t\t};\r\n\r\n\t\tradius = radius || 1;\r\n\t\tdetail = detail || 0;\r\n\r\n\t\t// default buffer data\r\n\r\n\t\tvar vertexBuffer = [];\r\n\t\tvar uvBuffer = [];\r\n\r\n\t\t// the subdivision creates the vertex buffer data\r\n\r\n\t\tsubdivide( detail );\r\n\r\n\t\t// all vertices should lie on a conceptual sphere with a given radius\r\n\r\n\t\tappplyRadius( radius );\r\n\r\n\t\t// finally, create the uv data\r\n\r\n\t\tgenerateUVs();\r\n\r\n\t\t// build non-indexed geometry\r\n\r\n\t\tthis.addAttribute( 'position', new Float32BufferAttribute( vertexBuffer, 3 ) );\r\n\t\tthis.addAttribute( 'normal', new Float32BufferAttribute( vertexBuffer.slice(), 3 ) );\r\n\t\tthis.addAttribute( 'uv', new Float32BufferAttribute( uvBuffer, 2 ) );\r\n\r\n\t\tif ( detail === 0 ) {\r\n\r\n\t\t\tthis.computeVertexNormals(); // flat normals\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.normalizeNormals(); // smooth normals\r\n\r\n\t\t}\r\n\r\n\t\t// helper functions\r\n\r\n\t\tfunction subdivide( detail ) {\r\n\r\n\t\t\tvar a = new Vector3();\r\n\t\t\tvar b = new Vector3();\r\n\t\t\tvar c = new Vector3();\r\n\r\n\t\t\t// iterate over all faces and apply a subdivison with the given detail value\r\n\r\n\t\t\tfor ( var i = 0; i < indices.length; i += 3 ) {\r\n\r\n\t\t\t\t// get the vertices of the face\r\n\r\n\t\t\t\tgetVertexByIndex( indices[ i + 0 ], a );\r\n\t\t\t\tgetVertexByIndex( indices[ i + 1 ], b );\r\n\t\t\t\tgetVertexByIndex( indices[ i + 2 ], c );\r\n\r\n\t\t\t\t// perform subdivision\r\n\r\n\t\t\t\tsubdivideFace( a, b, c, detail );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction subdivideFace( a, b, c, detail ) {\r\n\r\n\t\t\tvar cols = Math.pow( 2, detail );\r\n\r\n\t\t\t// we use this multidimensional array as a data structure for creating the subdivision\r\n\r\n\t\t\tvar v = [];\r\n\r\n\t\t\tvar i, j;\r\n\r\n\t\t\t// construct all of the vertices for this subdivision\r\n\r\n\t\t\tfor ( i = 0; i <= cols; i ++ ) {\r\n\r\n\t\t\t\tv[ i ] = [];\r\n\r\n\t\t\t\tvar aj = a.clone().lerp( c, i / cols );\r\n\t\t\t\tvar bj = b.clone().lerp( c, i / cols );\r\n\r\n\t\t\t\tvar rows = cols - i;\r\n\r\n\t\t\t\tfor ( j = 0; j <= rows; j ++ ) {\r\n\r\n\t\t\t\t\tif ( j === 0 && i === cols ) {\r\n\r\n\t\t\t\t\t\tv[ i ][ j ] = aj;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tv[ i ][ j ] = aj.clone().lerp( bj, j / rows );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// construct all of the faces\r\n\r\n\t\t\tfor ( i = 0; i < cols; i ++ ) {\r\n\r\n\t\t\t\tfor ( j = 0; j < 2 * ( cols - i ) - 1; j ++ ) {\r\n\r\n\t\t\t\t\tvar k = Math.floor( j / 2 );\r\n\r\n\t\t\t\t\tif ( j % 2 === 0 ) {\r\n\r\n\t\t\t\t\t\tpushVertex( v[ i ][ k + 1 ] );\r\n\t\t\t\t\t\tpushVertex( v[ i + 1 ][ k ] );\r\n\t\t\t\t\t\tpushVertex( v[ i ][ k ] );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tpushVertex( v[ i ][ k + 1 ] );\r\n\t\t\t\t\t\tpushVertex( v[ i + 1 ][ k + 1 ] );\r\n\t\t\t\t\t\tpushVertex( v[ i + 1 ][ k ] );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction appplyRadius( radius ) {\r\n\r\n\t\t\tvar vertex = new Vector3();\r\n\r\n\t\t\t// iterate over the entire buffer and apply the radius to each vertex\r\n\r\n\t\t\tfor ( var i = 0; i < vertexBuffer.length; i += 3 ) {\r\n\r\n\t\t\t\tvertex.x = vertexBuffer[ i + 0 ];\r\n\t\t\t\tvertex.y = vertexBuffer[ i + 1 ];\r\n\t\t\t\tvertex.z = vertexBuffer[ i + 2 ];\r\n\r\n\t\t\t\tvertex.normalize().multiplyScalar( radius );\r\n\r\n\t\t\t\tvertexBuffer[ i + 0 ] = vertex.x;\r\n\t\t\t\tvertexBuffer[ i + 1 ] = vertex.y;\r\n\t\t\t\tvertexBuffer[ i + 2 ] = vertex.z;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction generateUVs() {\r\n\r\n\t\t\tvar vertex = new Vector3();\r\n\r\n\t\t\tfor ( var i = 0; i < vertexBuffer.length; i += 3 ) {\r\n\r\n\t\t\t\tvertex.x = vertexBuffer[ i + 0 ];\r\n\t\t\t\tvertex.y = vertexBuffer[ i + 1 ];\r\n\t\t\t\tvertex.z = vertexBuffer[ i + 2 ];\r\n\r\n\t\t\t\tvar u = azimuth( vertex ) / 2 / Math.PI + 0.5;\r\n\t\t\t\tvar v = inclination( vertex ) / Math.PI + 0.5;\r\n\t\t\t\tuvBuffer.push( u, 1 - v );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcorrectUVs();\r\n\r\n\t\t\tcorrectSeam();\r\n\r\n\t\t}\r\n\r\n\t\tfunction correctSeam() {\r\n\r\n\t\t\t// handle case when face straddles the seam, see #3269\r\n\r\n\t\t\tfor ( var i = 0; i < uvBuffer.length; i += 6 ) {\r\n\r\n\t\t\t\t// uv data of a single face\r\n\r\n\t\t\t\tvar x0 = uvBuffer[ i + 0 ];\r\n\t\t\t\tvar x1 = uvBuffer[ i + 2 ];\r\n\t\t\t\tvar x2 = uvBuffer[ i + 4 ];\r\n\r\n\t\t\t\tvar max = Math.max( x0, x1, x2 );\r\n\t\t\t\tvar min = Math.min( x0, x1, x2 );\r\n\r\n\t\t\t\t// 0.9 is somewhat arbitrary\r\n\r\n\t\t\t\tif ( max > 0.9 && min < 0.1 ) {\r\n\r\n\t\t\t\t\tif ( x0 < 0.2 ) uvBuffer[ i + 0 ] += 1;\r\n\t\t\t\t\tif ( x1 < 0.2 ) uvBuffer[ i + 2 ] += 1;\r\n\t\t\t\t\tif ( x2 < 0.2 ) uvBuffer[ i + 4 ] += 1;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction pushVertex( vertex ) {\r\n\r\n\t\t\tvertexBuffer.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t}\r\n\r\n\t\tfunction getVertexByIndex( index, vertex ) {\r\n\r\n\t\t\tvar stride = index * 3;\r\n\r\n\t\t\tvertex.x = vertices[ stride + 0 ];\r\n\t\t\tvertex.y = vertices[ stride + 1 ];\r\n\t\t\tvertex.z = vertices[ stride + 2 ];\r\n\r\n\t\t}\r\n\r\n\t\tfunction correctUVs() {\r\n\r\n\t\t\tvar a = new Vector3();\r\n\t\t\tvar b = new Vector3();\r\n\t\t\tvar c = new Vector3();\r\n\r\n\t\t\tvar centroid = new Vector3();\r\n\r\n\t\t\tvar uvA = new Vector2();\r\n\t\t\tvar uvB = new Vector2();\r\n\t\t\tvar uvC = new Vector2();\r\n\r\n\t\t\tfor ( var i = 0, j = 0; i < vertexBuffer.length; i += 9, j += 6 ) {\r\n\r\n\t\t\t\ta.set( vertexBuffer[ i + 0 ], vertexBuffer[ i + 1 ], vertexBuffer[ i + 2 ] );\r\n\t\t\t\tb.set( vertexBuffer[ i + 3 ], vertexBuffer[ i + 4 ], vertexBuffer[ i + 5 ] );\r\n\t\t\t\tc.set( vertexBuffer[ i + 6 ], vertexBuffer[ i + 7 ], vertexBuffer[ i + 8 ] );\r\n\r\n\t\t\t\tuvA.set( uvBuffer[ j + 0 ], uvBuffer[ j + 1 ] );\r\n\t\t\t\tuvB.set( uvBuffer[ j + 2 ], uvBuffer[ j + 3 ] );\r\n\t\t\t\tuvC.set( uvBuffer[ j + 4 ], uvBuffer[ j + 5 ] );\r\n\r\n\t\t\t\tcentroid.copy( a ).add( b ).add( c ).divideScalar( 3 );\r\n\r\n\t\t\t\tvar azi = azimuth( centroid );\r\n\r\n\t\t\t\tcorrectUV( uvA, j + 0, a, azi );\r\n\t\t\t\tcorrectUV( uvB, j + 2, b, azi );\r\n\t\t\t\tcorrectUV( uvC, j + 4, c, azi );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction correctUV( uv, stride, vector, azimuth ) {\r\n\r\n\t\t\tif ( ( azimuth < 0 ) && ( uv.x === 1 ) ) {\r\n\r\n\t\t\t\tuvBuffer[ stride ] = uv.x - 1;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( ( vector.x === 0 ) && ( vector.z === 0 ) ) {\r\n\r\n\t\t\t\tuvBuffer[ stride ] = azimuth / 2 / Math.PI + 0.5;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// Angle around the Y axis, counter-clockwise when looking from above.\r\n\r\n\t\tfunction azimuth( vector ) {\r\n\r\n\t\t\treturn Math.atan2( vector.z, - vector.x );\r\n\r\n\t\t}\r\n\r\n\r\n\t\t// Angle above the XZ plane.\r\n\r\n\t\tfunction inclination( vector ) {\r\n\r\n\t\t\treturn Math.atan2( - vector.y, Math.sqrt( ( vector.x * vector.x ) + ( vector.z * vector.z ) ) );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tPolyhedronBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\r\n\tPolyhedronBufferGeometry.prototype.constructor = PolyhedronBufferGeometry;\r\n\r\n\t/**\r\n\t * @author timothypratley / https://github.com/timothypratley\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t */\r\n\r\n\t// TetrahedronGeometry\r\n\r\n\tfunction TetrahedronGeometry( radius, detail ) {\r\n\r\n\t\tGeometry.call( this );\r\n\r\n\t\tthis.type = 'TetrahedronGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\tdetail: detail\r\n\t\t};\r\n\r\n\t\tthis.fromBufferGeometry( new TetrahedronBufferGeometry( radius, detail ) );\r\n\t\tthis.mergeVertices();\r\n\r\n\t}\r\n\r\n\tTetrahedronGeometry.prototype = Object.create( Geometry.prototype );\r\n\tTetrahedronGeometry.prototype.constructor = TetrahedronGeometry;\r\n\r\n\t// TetrahedronBufferGeometry\r\n\r\n\tfunction TetrahedronBufferGeometry( radius, detail ) {\r\n\r\n\t\tvar vertices = [\r\n\t\t\t1, 1, 1, \t- 1, - 1, 1, \t- 1, 1, - 1, \t1, - 1, - 1\r\n\t\t];\r\n\r\n\t\tvar indices = [\r\n\t\t\t2, 1, 0, \t0, 3, 2,\t1, 3, 0,\t2, 3, 1\r\n\t\t];\r\n\r\n\t\tPolyhedronBufferGeometry.call( this, vertices, indices, radius, detail );\r\n\r\n\t\tthis.type = 'TetrahedronBufferGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\tdetail: detail\r\n\t\t};\r\n\r\n\t}\r\n\r\n\tTetrahedronBufferGeometry.prototype = Object.create( PolyhedronBufferGeometry.prototype );\r\n\tTetrahedronBufferGeometry.prototype.constructor = TetrahedronBufferGeometry;\r\n\r\n\t/**\r\n\t * @author timothypratley / https://github.com/timothypratley\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t */\r\n\r\n\t// OctahedronGeometry\r\n\r\n\tfunction OctahedronGeometry( radius, detail ) {\r\n\r\n\t\tGeometry.call( this );\r\n\r\n\t\tthis.type = 'OctahedronGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\tdetail: detail\r\n\t\t};\r\n\r\n\t\tthis.fromBufferGeometry( new OctahedronBufferGeometry( radius, detail ) );\r\n\t\tthis.mergeVertices();\r\n\r\n\t}\r\n\r\n\tOctahedronGeometry.prototype = Object.create( Geometry.prototype );\r\n\tOctahedronGeometry.prototype.constructor = OctahedronGeometry;\r\n\r\n\t// OctahedronBufferGeometry\r\n\r\n\tfunction OctahedronBufferGeometry( radius, detail ) {\r\n\r\n\t\tvar vertices = [\r\n\t\t\t1, 0, 0, \t- 1, 0, 0,\t0, 1, 0,\r\n\t\t\t0, - 1, 0, \t0, 0, 1,\t0, 0, - 1\r\n\t\t];\r\n\r\n\t\tvar indices = [\r\n\t\t\t0, 2, 4,\t0, 4, 3,\t0, 3, 5,\r\n\t\t\t0, 5, 2,\t1, 2, 5,\t1, 5, 3,\r\n\t\t\t1, 3, 4,\t1, 4, 2\r\n\t\t];\r\n\r\n\t\tPolyhedronBufferGeometry.call( this, vertices, indices, radius, detail );\r\n\r\n\t\tthis.type = 'OctahedronBufferGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\tdetail: detail\r\n\t\t};\r\n\r\n\t}\r\n\r\n\tOctahedronBufferGeometry.prototype = Object.create( PolyhedronBufferGeometry.prototype );\r\n\tOctahedronBufferGeometry.prototype.constructor = OctahedronBufferGeometry;\r\n\r\n\t/**\r\n\t * @author timothypratley / https://github.com/timothypratley\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t */\r\n\r\n\t// IcosahedronGeometry\r\n\r\n\tfunction IcosahedronGeometry( radius, detail ) {\r\n\r\n\t\tGeometry.call( this );\r\n\r\n\t\tthis.type = 'IcosahedronGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\tdetail: detail\r\n\t\t};\r\n\r\n\t\tthis.fromBufferGeometry( new IcosahedronBufferGeometry( radius, detail ) );\r\n\t\tthis.mergeVertices();\r\n\r\n\t}\r\n\r\n\tIcosahedronGeometry.prototype = Object.create( Geometry.prototype );\r\n\tIcosahedronGeometry.prototype.constructor = IcosahedronGeometry;\r\n\r\n\t// IcosahedronBufferGeometry\r\n\r\n\tfunction IcosahedronBufferGeometry( radius, detail ) {\r\n\r\n\t\tvar t = ( 1 + Math.sqrt( 5 ) ) / 2;\r\n\r\n\t\tvar vertices = [\r\n\t\t\t- 1, t, 0, \t1, t, 0, \t- 1, - t, 0, \t1, - t, 0,\r\n\t\t\t 0, - 1, t, \t0, 1, t,\t0, - 1, - t, \t0, 1, - t,\r\n\t\t\t t, 0, - 1, \tt, 0, 1, \t- t, 0, - 1, \t- t, 0, 1\r\n\t\t];\r\n\r\n\t\tvar indices = [\r\n\t\t\t 0, 11, 5, \t0, 5, 1, \t0, 1, 7, \t0, 7, 10, \t0, 10, 11,\r\n\t\t\t 1, 5, 9, \t5, 11, 4,\t11, 10, 2,\t10, 7, 6,\t7, 1, 8,\r\n\t\t\t 3, 9, 4, \t3, 4, 2,\t3, 2, 6,\t3, 6, 8,\t3, 8, 9,\r\n\t\t\t 4, 9, 5, \t2, 4, 11,\t6, 2, 10,\t8, 6, 7,\t9, 8, 1\r\n\t\t];\r\n\r\n\t\tPolyhedronBufferGeometry.call( this, vertices, indices, radius, detail );\r\n\r\n\t\tthis.type = 'IcosahedronBufferGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\tdetail: detail\r\n\t\t};\r\n\r\n\t}\r\n\r\n\tIcosahedronBufferGeometry.prototype = Object.create( PolyhedronBufferGeometry.prototype );\r\n\tIcosahedronBufferGeometry.prototype.constructor = IcosahedronBufferGeometry;\r\n\r\n\t/**\r\n\t * @author Abe Pazos / https://hamoid.com\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t */\r\n\r\n\t// DodecahedronGeometry\r\n\r\n\tfunction DodecahedronGeometry( radius, detail ) {\r\n\r\n\t\tGeometry.call( this );\r\n\r\n\t\tthis.type = 'DodecahedronGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\tdetail: detail\r\n\t\t};\r\n\r\n\t\tthis.fromBufferGeometry( new DodecahedronBufferGeometry( radius, detail ) );\r\n\t\tthis.mergeVertices();\r\n\r\n\t}\r\n\r\n\tDodecahedronGeometry.prototype = Object.create( Geometry.prototype );\r\n\tDodecahedronGeometry.prototype.constructor = DodecahedronGeometry;\r\n\r\n\t// DodecahedronBufferGeometry\r\n\r\n\tfunction DodecahedronBufferGeometry( radius, detail ) {\r\n\r\n\t\tvar t = ( 1 + Math.sqrt( 5 ) ) / 2;\r\n\t\tvar r = 1 / t;\r\n\r\n\t\tvar vertices = [\r\n\r\n\t\t\t// (1, 1, 1)\r\n\t\t\t- 1, - 1, - 1,\t- 1, - 1, 1,\r\n\t\t\t- 1, 1, - 1, - 1, 1, 1,\r\n\t\t\t1, - 1, - 1, 1, - 1, 1,\r\n\t\t\t1, 1, - 1, 1, 1, 1,\r\n\r\n\t\t\t// (0, 1/, )\r\n\t\t\t 0, - r, - t, 0, - r, t,\r\n\t\t\t 0, r, - t, 0, r, t,\r\n\r\n\t\t\t// (1/, , 0)\r\n\t\t\t- r, - t, 0, - r, t, 0,\r\n\t\t\t r, - t, 0, r, t, 0,\r\n\r\n\t\t\t// (, 0, 1/)\r\n\t\t\t- t, 0, - r, t, 0, - r,\r\n\t\t\t- t, 0, r, t, 0, r\r\n\t\t];\r\n\r\n\t\tvar indices = [\r\n\t\t\t3, 11, 7, \t3, 7, 15, \t3, 15, 13,\r\n\t\t\t7, 19, 17, \t7, 17, 6, \t7, 6, 15,\r\n\t\t\t17, 4, 8, \t17, 8, 10, \t17, 10, 6,\r\n\t\t\t8, 0, 16, \t8, 16, 2, \t8, 2, 10,\r\n\t\t\t0, 12, 1, \t0, 1, 18, \t0, 18, 16,\r\n\t\t\t6, 10, 2, \t6, 2, 13, \t6, 13, 15,\r\n\t\t\t2, 16, 18, \t2, 18, 3, \t2, 3, 13,\r\n\t\t\t18, 1, 9, \t18, 9, 11, \t18, 11, 3,\r\n\t\t\t4, 14, 12, \t4, 12, 0, \t4, 0, 8,\r\n\t\t\t11, 9, 5, \t11, 5, 19, \t11, 19, 7,\r\n\t\t\t19, 5, 14, \t19, 14, 4, \t19, 4, 17,\r\n\t\t\t1, 12, 14, \t1, 14, 5, \t1, 5, 9\r\n\t\t];\r\n\r\n\t\tPolyhedronBufferGeometry.call( this, vertices, indices, radius, detail );\r\n\r\n\t\tthis.type = 'DodecahedronBufferGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\tdetail: detail\r\n\t\t};\r\n\r\n\t}\r\n\r\n\tDodecahedronBufferGeometry.prototype = Object.create( PolyhedronBufferGeometry.prototype );\r\n\tDodecahedronBufferGeometry.prototype.constructor = DodecahedronBufferGeometry;\r\n\r\n\t/**\r\n\t * @author oosmoxiecode / https://github.com/oosmoxiecode\r\n\t * @author WestLangley / https://github.com/WestLangley\r\n\t * @author zz85 / https://github.com/zz85\r\n\t * @author miningold / https://github.com/miningold\r\n\t * @author jonobr1 / https://github.com/jonobr1\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t *\r\n\t */\r\n\r\n\t// TubeGeometry\r\n\r\n\tfunction TubeGeometry( path, tubularSegments, radius, radialSegments, closed, taper ) {\r\n\r\n\t\tGeometry.call( this );\r\n\r\n\t\tthis.type = 'TubeGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tpath: path,\r\n\t\t\ttubularSegments: tubularSegments,\r\n\t\t\tradius: radius,\r\n\t\t\tradialSegments: radialSegments,\r\n\t\t\tclosed: closed\r\n\t\t};\r\n\r\n\t\tif ( taper !== undefined ) console.warn( 'THREE.TubeGeometry: taper has been removed.' );\r\n\r\n\t\tvar bufferGeometry = new TubeBufferGeometry( path, tubularSegments, radius, radialSegments, closed );\r\n\r\n\t\t// expose internals\r\n\r\n\t\tthis.tangents = bufferGeometry.tangents;\r\n\t\tthis.normals = bufferGeometry.normals;\r\n\t\tthis.binormals = bufferGeometry.binormals;\r\n\r\n\t\t// create geometry\r\n\r\n\t\tthis.fromBufferGeometry( bufferGeometry );\r\n\t\tthis.mergeVertices();\r\n\r\n\t}\r\n\r\n\tTubeGeometry.prototype = Object.create( Geometry.prototype );\r\n\tTubeGeometry.prototype.constructor = TubeGeometry;\r\n\r\n\t// TubeBufferGeometry\r\n\r\n\tfunction TubeBufferGeometry( path, tubularSegments, radius, radialSegments, closed ) {\r\n\r\n\t\tBufferGeometry.call( this );\r\n\r\n\t\tthis.type = 'TubeBufferGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tpath: path,\r\n\t\t\ttubularSegments: tubularSegments,\r\n\t\t\tradius: radius,\r\n\t\t\tradialSegments: radialSegments,\r\n\t\t\tclosed: closed\r\n\t\t};\r\n\r\n\t\ttubularSegments = tubularSegments || 64;\r\n\t\tradius = radius || 1;\r\n\t\tradialSegments = radialSegments || 8;\r\n\t\tclosed = closed || false;\r\n\r\n\t\tvar frames = path.computeFrenetFrames( tubularSegments, closed );\r\n\r\n\t\t// expose internals\r\n\r\n\t\tthis.tangents = frames.tangents;\r\n\t\tthis.normals = frames.normals;\r\n\t\tthis.binormals = frames.binormals;\r\n\r\n\t\t// helper variables\r\n\r\n\t\tvar vertex = new Vector3();\r\n\t\tvar normal = new Vector3();\r\n\t\tvar uv = new Vector2();\r\n\t\tvar P = new Vector3();\r\n\r\n\t\tvar i, j;\r\n\r\n\t\t// buffer\r\n\r\n\t\tvar vertices = [];\r\n\t\tvar normals = [];\r\n\t\tvar uvs = [];\r\n\t\tvar indices = [];\r\n\r\n\t\t// create buffer data\r\n\r\n\t\tgenerateBufferData();\r\n\r\n\t\t// build geometry\r\n\r\n\t\tthis.setIndex( indices );\r\n\t\tthis.addAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\t\tthis.addAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\r\n\t\tthis.addAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\r\n\r\n\t\t// functions\r\n\r\n\t\tfunction generateBufferData() {\r\n\r\n\t\t\tfor ( i = 0; i < tubularSegments; i ++ ) {\r\n\r\n\t\t\t\tgenerateSegment( i );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// if the geometry is not closed, generate the last row of vertices and normals\r\n\t\t\t// at the regular position on the given path\r\n\t\t\t//\r\n\t\t\t// if the geometry is closed, duplicate the first row of vertices and normals (uvs will differ)\r\n\r\n\t\t\tgenerateSegment( ( closed === false ) ? tubularSegments : 0 );\r\n\r\n\t\t\t// uvs are generated in a separate function.\r\n\t\t\t// this makes it easy compute correct values for closed geometries\r\n\r\n\t\t\tgenerateUVs();\r\n\r\n\t\t\t// finally create faces\r\n\r\n\t\t\tgenerateIndices();\r\n\r\n\t\t}\r\n\r\n\t\tfunction generateSegment( i ) {\r\n\r\n\t\t\t// we use getPointAt to sample evenly distributed points from the given path\r\n\r\n\t\t\tP = path.getPointAt( i / tubularSegments, P );\r\n\r\n\t\t\t// retrieve corresponding normal and binormal\r\n\r\n\t\t\tvar N = frames.normals[ i ];\r\n\t\t\tvar B = frames.binormals[ i ];\r\n\r\n\t\t\t// generate normals and vertices for the current segment\r\n\r\n\t\t\tfor ( j = 0; j <= radialSegments; j ++ ) {\r\n\r\n\t\t\t\tvar v = j / radialSegments * Math.PI * 2;\r\n\r\n\t\t\t\tvar sin = Math.sin( v );\r\n\t\t\t\tvar cos = - Math.cos( v );\r\n\r\n\t\t\t\t// normal\r\n\r\n\t\t\t\tnormal.x = ( cos * N.x + sin * B.x );\r\n\t\t\t\tnormal.y = ( cos * N.y + sin * B.y );\r\n\t\t\t\tnormal.z = ( cos * N.z + sin * B.z );\r\n\t\t\t\tnormal.normalize();\r\n\r\n\t\t\t\tnormals.push( normal.x, normal.y, normal.z );\r\n\r\n\t\t\t\t// vertex\r\n\r\n\t\t\t\tvertex.x = P.x + radius * normal.x;\r\n\t\t\t\tvertex.y = P.y + radius * normal.y;\r\n\t\t\t\tvertex.z = P.z + radius * normal.z;\r\n\r\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction generateIndices() {\r\n\r\n\t\t\tfor ( j = 1; j <= tubularSegments; j ++ ) {\r\n\r\n\t\t\t\tfor ( i = 1; i <= radialSegments; i ++ ) {\r\n\r\n\t\t\t\t\tvar a = ( radialSegments + 1 ) * ( j - 1 ) + ( i - 1 );\r\n\t\t\t\t\tvar b = ( radialSegments + 1 ) * j + ( i - 1 );\r\n\t\t\t\t\tvar c = ( radialSegments + 1 ) * j + i;\r\n\t\t\t\t\tvar d = ( radialSegments + 1 ) * ( j - 1 ) + i;\r\n\r\n\t\t\t\t\t// faces\r\n\r\n\t\t\t\t\tindices.push( a, b, d );\r\n\t\t\t\t\tindices.push( b, c, d );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction generateUVs() {\r\n\r\n\t\t\tfor ( i = 0; i <= tubularSegments; i ++ ) {\r\n\r\n\t\t\t\tfor ( j = 0; j <= radialSegments; j ++ ) {\r\n\r\n\t\t\t\t\tuv.x = i / tubularSegments;\r\n\t\t\t\t\tuv.y = j / radialSegments;\r\n\r\n\t\t\t\t\tuvs.push( uv.x, uv.y );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tTubeBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\r\n\tTubeBufferGeometry.prototype.constructor = TubeBufferGeometry;\r\n\r\n\t/**\r\n\t * @author oosmoxiecode\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t *\r\n\t * based on http://www.blackpawn.com/texts/pqtorus/\r\n\t */\r\n\r\n\t// TorusKnotGeometry\r\n\r\n\tfunction TorusKnotGeometry( radius, tube, tubularSegments, radialSegments, p, q, heightScale ) {\r\n\r\n\t\tGeometry.call( this );\r\n\r\n\t\tthis.type = 'TorusKnotGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\ttube: tube,\r\n\t\t\ttubularSegments: tubularSegments,\r\n\t\t\tradialSegments: radialSegments,\r\n\t\t\tp: p,\r\n\t\t\tq: q\r\n\t\t};\r\n\r\n\t\tif ( heightScale !== undefined ) console.warn( 'THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead.' );\r\n\r\n\t\tthis.fromBufferGeometry( new TorusKnotBufferGeometry( radius, tube, tubularSegments, radialSegments, p, q ) );\r\n\t\tthis.mergeVertices();\r\n\r\n\t}\r\n\r\n\tTorusKnotGeometry.prototype = Object.create( Geometry.prototype );\r\n\tTorusKnotGeometry.prototype.constructor = TorusKnotGeometry;\r\n\r\n\t// TorusKnotBufferGeometry\r\n\r\n\tfunction TorusKnotBufferGeometry( radius, tube, tubularSegments, radialSegments, p, q ) {\r\n\r\n\t\tBufferGeometry.call( this );\r\n\r\n\t\tthis.type = 'TorusKnotBufferGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\ttube: tube,\r\n\t\t\ttubularSegments: tubularSegments,\r\n\t\t\tradialSegments: radialSegments,\r\n\t\t\tp: p,\r\n\t\t\tq: q\r\n\t\t};\r\n\r\n\t\tradius = radius || 1;\r\n\t\ttube = tube || 0.4;\r\n\t\ttubularSegments = Math.floor( tubularSegments ) || 64;\r\n\t\tradialSegments = Math.floor( radialSegments ) || 8;\r\n\t\tp = p || 2;\r\n\t\tq = q || 3;\r\n\r\n\t\t// buffers\r\n\r\n\t\tvar indices = [];\r\n\t\tvar vertices = [];\r\n\t\tvar normals = [];\r\n\t\tvar uvs = [];\r\n\r\n\t\t// helper variables\r\n\r\n\t\tvar i, j;\r\n\r\n\t\tvar vertex = new Vector3();\r\n\t\tvar normal = new Vector3();\r\n\r\n\t\tvar P1 = new Vector3();\r\n\t\tvar P2 = new Vector3();\r\n\r\n\t\tvar B = new Vector3();\r\n\t\tvar T = new Vector3();\r\n\t\tvar N = new Vector3();\r\n\r\n\t\t// generate vertices, normals and uvs\r\n\r\n\t\tfor ( i = 0; i <= tubularSegments; ++ i ) {\r\n\r\n\t\t\t// the radian \"u\" is used to calculate the position on the torus curve of the current tubular segement\r\n\r\n\t\t\tvar u = i / tubularSegments * p * Math.PI * 2;\r\n\r\n\t\t\t// now we calculate two points. P1 is our current position on the curve, P2 is a little farther ahead.\r\n\t\t\t// these points are used to create a special \"coordinate space\", which is necessary to calculate the correct vertex positions\r\n\r\n\t\t\tcalculatePositionOnCurve( u, p, q, radius, P1 );\r\n\t\t\tcalculatePositionOnCurve( u + 0.01, p, q, radius, P2 );\r\n\r\n\t\t\t// calculate orthonormal basis\r\n\r\n\t\t\tT.subVectors( P2, P1 );\r\n\t\t\tN.addVectors( P2, P1 );\r\n\t\t\tB.crossVectors( T, N );\r\n\t\t\tN.crossVectors( B, T );\r\n\r\n\t\t\t// normalize B, N. T can be ignored, we don't use it\r\n\r\n\t\t\tB.normalize();\r\n\t\t\tN.normalize();\r\n\r\n\t\t\tfor ( j = 0; j <= radialSegments; ++ j ) {\r\n\r\n\t\t\t\t// now calculate the vertices. they are nothing more than an extrusion of the torus curve.\r\n\t\t\t\t// because we extrude a shape in the xy-plane, there is no need to calculate a z-value.\r\n\r\n\t\t\t\tvar v = j / radialSegments * Math.PI * 2;\r\n\t\t\t\tvar cx = - tube * Math.cos( v );\r\n\t\t\t\tvar cy = tube * Math.sin( v );\r\n\r\n\t\t\t\t// now calculate the final vertex position.\r\n\t\t\t\t// first we orient the extrusion with our basis vectos, then we add it to the current position on the curve\r\n\r\n\t\t\t\tvertex.x = P1.x + ( cx * N.x + cy * B.x );\r\n\t\t\t\tvertex.y = P1.y + ( cx * N.y + cy * B.y );\r\n\t\t\t\tvertex.z = P1.z + ( cx * N.z + cy * B.z );\r\n\r\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t\t// normal (P1 is always the center/origin of the extrusion, thus we can use it to calculate the normal)\r\n\r\n\t\t\t\tnormal.subVectors( vertex, P1 ).normalize();\r\n\r\n\t\t\t\tnormals.push( normal.x, normal.y, normal.z );\r\n\r\n\t\t\t\t// uv\r\n\r\n\t\t\t\tuvs.push( i / tubularSegments );\r\n\t\t\t\tuvs.push( j / radialSegments );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// generate indices\r\n\r\n\t\tfor ( j = 1; j <= tubularSegments; j ++ ) {\r\n\r\n\t\t\tfor ( i = 1; i <= radialSegments; i ++ ) {\r\n\r\n\t\t\t\t// indices\r\n\r\n\t\t\t\tvar a = ( radialSegments + 1 ) * ( j - 1 ) + ( i - 1 );\r\n\t\t\t\tvar b = ( radialSegments + 1 ) * j + ( i - 1 );\r\n\t\t\t\tvar c = ( radialSegments + 1 ) * j + i;\r\n\t\t\t\tvar d = ( radialSegments + 1 ) * ( j - 1 ) + i;\r\n\r\n\t\t\t\t// faces\r\n\r\n\t\t\t\tindices.push( a, b, d );\r\n\t\t\t\tindices.push( b, c, d );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// build geometry\r\n\r\n\t\tthis.setIndex( indices );\r\n\t\tthis.addAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\t\tthis.addAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\r\n\t\tthis.addAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\r\n\r\n\t\t// this function calculates the current position on the torus curve\r\n\r\n\t\tfunction calculatePositionOnCurve( u, p, q, radius, position ) {\r\n\r\n\t\t\tvar cu = Math.cos( u );\r\n\t\t\tvar su = Math.sin( u );\r\n\t\t\tvar quOverP = q / p * u;\r\n\t\t\tvar cs = Math.cos( quOverP );\r\n\r\n\t\t\tposition.x = radius * ( 2 + cs ) * 0.5 * cu;\r\n\t\t\tposition.y = radius * ( 2 + cs ) * su * 0.5;\r\n\t\t\tposition.z = radius * Math.sin( quOverP ) * 0.5;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tTorusKnotBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\r\n\tTorusKnotBufferGeometry.prototype.constructor = TorusKnotBufferGeometry;\r\n\r\n\t/**\r\n\t * @author oosmoxiecode\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t */\r\n\r\n\t// TorusGeometry\r\n\r\n\tfunction TorusGeometry( radius, tube, radialSegments, tubularSegments, arc ) {\r\n\r\n\t\tGeometry.call( this );\r\n\r\n\t\tthis.type = 'TorusGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\ttube: tube,\r\n\t\t\tradialSegments: radialSegments,\r\n\t\t\ttubularSegments: tubularSegments,\r\n\t\t\tarc: arc\r\n\t\t};\r\n\r\n\t\tthis.fromBufferGeometry( new TorusBufferGeometry( radius, tube, radialSegments, tubularSegments, arc ) );\r\n\t\tthis.mergeVertices();\r\n\r\n\t}\r\n\r\n\tTorusGeometry.prototype = Object.create( Geometry.prototype );\r\n\tTorusGeometry.prototype.constructor = TorusGeometry;\r\n\r\n\t// TorusBufferGeometry\r\n\r\n\tfunction TorusBufferGeometry( radius, tube, radialSegments, tubularSegments, arc ) {\r\n\r\n\t\tBufferGeometry.call( this );\r\n\r\n\t\tthis.type = 'TorusBufferGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\ttube: tube,\r\n\t\t\tradialSegments: radialSegments,\r\n\t\t\ttubularSegments: tubularSegments,\r\n\t\t\tarc: arc\r\n\t\t};\r\n\r\n\t\tradius = radius || 1;\r\n\t\ttube = tube || 0.4;\r\n\t\tradialSegments = Math.floor( radialSegments ) || 8;\r\n\t\ttubularSegments = Math.floor( tubularSegments ) || 6;\r\n\t\tarc = arc || Math.PI * 2;\r\n\r\n\t\t// buffers\r\n\r\n\t\tvar indices = [];\r\n\t\tvar vertices = [];\r\n\t\tvar normals = [];\r\n\t\tvar uvs = [];\r\n\r\n\t\t// helper variables\r\n\r\n\t\tvar center = new Vector3();\r\n\t\tvar vertex = new Vector3();\r\n\t\tvar normal = new Vector3();\r\n\r\n\t\tvar j, i;\r\n\r\n\t\t// generate vertices, normals and uvs\r\n\r\n\t\tfor ( j = 0; j <= radialSegments; j ++ ) {\r\n\r\n\t\t\tfor ( i = 0; i <= tubularSegments; i ++ ) {\r\n\r\n\t\t\t\tvar u = i / tubularSegments * arc;\r\n\t\t\t\tvar v = j / radialSegments * Math.PI * 2;\r\n\r\n\t\t\t\t// vertex\r\n\r\n\t\t\t\tvertex.x = ( radius + tube * Math.cos( v ) ) * Math.cos( u );\r\n\t\t\t\tvertex.y = ( radius + tube * Math.cos( v ) ) * Math.sin( u );\r\n\t\t\t\tvertex.z = tube * Math.sin( v );\r\n\r\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t\t// normal\r\n\r\n\t\t\t\tcenter.x = radius * Math.cos( u );\r\n\t\t\t\tcenter.y = radius * Math.sin( u );\r\n\t\t\t\tnormal.subVectors( vertex, center ).normalize();\r\n\r\n\t\t\t\tnormals.push( normal.x, normal.y, normal.z );\r\n\r\n\t\t\t\t// uv\r\n\r\n\t\t\t\tuvs.push( i / tubularSegments );\r\n\t\t\t\tuvs.push( j / radialSegments );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// generate indices\r\n\r\n\t\tfor ( j = 1; j <= radialSegments; j ++ ) {\r\n\r\n\t\t\tfor ( i = 1; i <= tubularSegments; i ++ ) {\r\n\r\n\t\t\t\t// indices\r\n\r\n\t\t\t\tvar a = ( tubularSegments + 1 ) * j + i - 1;\r\n\t\t\t\tvar b = ( tubularSegments + 1 ) * ( j - 1 ) + i - 1;\r\n\t\t\t\tvar c = ( tubularSegments + 1 ) * ( j - 1 ) + i;\r\n\t\t\t\tvar d = ( tubularSegments + 1 ) * j + i;\r\n\r\n\t\t\t\t// faces\r\n\r\n\t\t\t\tindices.push( a, b, d );\r\n\t\t\t\tindices.push( b, c, d );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// build geometry\r\n\r\n\t\tthis.setIndex( indices );\r\n\t\tthis.addAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\t\tthis.addAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\r\n\t\tthis.addAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\r\n\r\n\t}\r\n\r\n\tTorusBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\r\n\tTorusBufferGeometry.prototype.constructor = TorusBufferGeometry;\r\n\r\n\t/**\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t * Port from https://github.com/mapbox/earcut (v2.1.2)\r\n\t */\r\n\r\n\tvar Earcut = {\r\n\r\n\t\ttriangulate: function ( data, holeIndices, dim ) {\r\n\r\n\t\t\tdim = dim || 2;\r\n\r\n\t\t\tvar hasHoles = holeIndices && holeIndices.length,\r\n\t\t\t\touterLen = hasHoles ? holeIndices[ 0 ] * dim : data.length,\r\n\t\t\t\touterNode = linkedList( data, 0, outerLen, dim, true ),\r\n\t\t\t\ttriangles = [];\r\n\r\n\t\t\tif ( ! outerNode ) return triangles;\r\n\r\n\t\t\tvar minX, minY, maxX, maxY, x, y, invSize;\r\n\r\n\t\t\tif ( hasHoles ) outerNode = eliminateHoles( data, holeIndices, outerNode, dim );\r\n\r\n\t\t\t// if the shape is not too simple, we'll use z-order curve hash later; calculate polygon bbox\r\n\r\n\t\t\tif ( data.length > 80 * dim ) {\r\n\r\n\t\t\t\tminX = maxX = data[ 0 ];\r\n\t\t\t\tminY = maxY = data[ 1 ];\r\n\r\n\t\t\t\tfor ( var i = dim; i < outerLen; i += dim ) {\r\n\r\n\t\t\t\t\tx = data[ i ];\r\n\t\t\t\t\ty = data[ i + 1 ];\r\n\t\t\t\t\tif ( x < minX ) minX = x;\r\n\t\t\t\t\tif ( y < minY ) minY = y;\r\n\t\t\t\t\tif ( x > maxX ) maxX = x;\r\n\t\t\t\t\tif ( y > maxY ) maxY = y;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// minX, minY and invSize are later used to transform coords into integers for z-order calculation\r\n\r\n\t\t\t\tinvSize = Math.max( maxX - minX, maxY - minY );\r\n\t\t\t\tinvSize = invSize !== 0 ? 1 / invSize : 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tearcutLinked( outerNode, triangles, dim, minX, minY, invSize );\r\n\r\n\t\t\treturn triangles;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t// create a circular doubly linked list from polygon points in the specified winding order\r\n\r\n\tfunction linkedList( data, start, end, dim, clockwise ) {\r\n\r\n\t\tvar i, last;\r\n\r\n\t\tif ( clockwise === ( signedArea( data, start, end, dim ) > 0 ) ) {\r\n\r\n\t\t\tfor ( i = start; i < end; i += dim ) last = insertNode( i, data[ i ], data[ i + 1 ], last );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tfor ( i = end - dim; i >= start; i -= dim ) last = insertNode( i, data[ i ], data[ i + 1 ], last );\r\n\r\n\t\t}\r\n\r\n\t\tif ( last && equals( last, last.next ) ) {\r\n\r\n\t\t\tremoveNode( last );\r\n\t\t\tlast = last.next;\r\n\r\n\t\t}\r\n\r\n\t\treturn last;\r\n\r\n\t}\r\n\r\n\t// eliminate colinear or duplicate points\r\n\r\n\tfunction filterPoints( start, end ) {\r\n\r\n\t\tif ( ! start ) return start;\r\n\t\tif ( ! end ) end = start;\r\n\r\n\t\tvar p = start, again;\r\n\r\n\t\tdo {\r\n\r\n\t\t\tagain = false;\r\n\r\n\t\t\tif ( ! p.steiner && ( equals( p, p.next ) || area( p.prev, p, p.next ) === 0 ) ) {\r\n\r\n\t\t\t\tremoveNode( p );\r\n\t\t\t\tp = end = p.prev;\r\n\t\t\t\tif ( p === p.next ) break;\r\n\t\t\t\tagain = true;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tp = p.next;\r\n\r\n\t\t\t}\r\n\r\n\t\t} while ( again || p !== end );\r\n\r\n\t\treturn end;\r\n\r\n\t}\r\n\r\n\t// main ear slicing loop which triangulates a polygon (given as a linked list)\r\n\r\n\tfunction earcutLinked( ear, triangles, dim, minX, minY, invSize, pass ) {\r\n\r\n\t\tif ( ! ear ) return;\r\n\r\n\t\t// interlink polygon nodes in z-order\r\n\r\n\t\tif ( ! pass && invSize ) indexCurve( ear, minX, minY, invSize );\r\n\r\n\t\tvar stop = ear, prev, next;\r\n\r\n\t\t// iterate through ears, slicing them one by one\r\n\r\n\t\twhile ( ear.prev !== ear.next ) {\r\n\r\n\t\t\tprev = ear.prev;\r\n\t\t\tnext = ear.next;\r\n\r\n\t\t\tif ( invSize ? isEarHashed( ear, minX, minY, invSize ) : isEar( ear ) ) {\r\n\r\n\t\t\t\t// cut off the triangle\r\n\t\t\t\ttriangles.push( prev.i / dim );\r\n\t\t\t\ttriangles.push( ear.i / dim );\r\n\t\t\t\ttriangles.push( next.i / dim );\r\n\r\n\t\t\t\tremoveNode( ear );\r\n\r\n\t\t\t\t// skipping the next vertice leads to less sliver triangles\r\n\t\t\t\tear = next.next;\r\n\t\t\t\tstop = next.next;\r\n\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tear = next;\r\n\r\n\t\t\t// if we looped through the whole remaining polygon and can't find any more ears\r\n\r\n\t\t\tif ( ear === stop ) {\r\n\r\n\t\t\t\t// try filtering points and slicing again\r\n\r\n\t\t\t\tif ( ! pass ) {\r\n\r\n\t\t\t\t\tearcutLinked( filterPoints( ear ), triangles, dim, minX, minY, invSize, 1 );\r\n\r\n\t\t\t\t\t// if this didn't work, try curing all small self-intersections locally\r\n\r\n\t\t\t\t} else if ( pass === 1 ) {\r\n\r\n\t\t\t\t\tear = cureLocalIntersections( ear, triangles, dim );\r\n\t\t\t\t\tearcutLinked( ear, triangles, dim, minX, minY, invSize, 2 );\r\n\r\n\t\t\t\t\t// as a last resort, try splitting the remaining polygon into two\r\n\r\n\t\t\t\t} else if ( pass === 2 ) {\r\n\r\n\t\t\t\t\tsplitEarcut( ear, triangles, dim, minX, minY, invSize );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// check whether a polygon node forms a valid ear with adjacent nodes\r\n\r\n\tfunction isEar( ear ) {\r\n\r\n\t\tvar a = ear.prev,\r\n\t\t\tb = ear,\r\n\t\t\tc = ear.next;\r\n\r\n\t\tif ( area( a, b, c ) >= 0 ) return false; // reflex, can't be an ear\r\n\r\n\t\t// now make sure we don't have other points inside the potential ear\r\n\t\tvar p = ear.next.next;\r\n\r\n\t\twhile ( p !== ear.prev ) {\r\n\r\n\t\t\tif ( pointInTriangle( a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y ) && area( p.prev, p, p.next ) >= 0 ) {\r\n\r\n\t\t\t\treturn false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tp = p.next;\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t}\r\n\r\n\tfunction isEarHashed( ear, minX, minY, invSize ) {\r\n\r\n\t\tvar a = ear.prev,\r\n\t\t\tb = ear,\r\n\t\t\tc = ear.next;\r\n\r\n\t\tif ( area( a, b, c ) >= 0 ) return false; // reflex, can't be an ear\r\n\r\n\t\t// triangle bbox; min & max are calculated like this for speed\r\n\r\n\t\tvar minTX = a.x < b.x ? ( a.x < c.x ? a.x : c.x ) : ( b.x < c.x ? b.x : c.x ),\r\n\t\t\tminTY = a.y < b.y ? ( a.y < c.y ? a.y : c.y ) : ( b.y < c.y ? b.y : c.y ),\r\n\t\t\tmaxTX = a.x > b.x ? ( a.x > c.x ? a.x : c.x ) : ( b.x > c.x ? b.x : c.x ),\r\n\t\t\tmaxTY = a.y > b.y ? ( a.y > c.y ? a.y : c.y ) : ( b.y > c.y ? b.y : c.y );\r\n\r\n\t\t// z-order range for the current triangle bbox;\r\n\r\n\t\tvar minZ = zOrder( minTX, minTY, minX, minY, invSize ),\r\n\t\t\tmaxZ = zOrder( maxTX, maxTY, minX, minY, invSize );\r\n\r\n\t\t// first look for points inside the triangle in increasing z-order\r\n\r\n\t\tvar p = ear.nextZ;\r\n\r\n\t\twhile ( p && p.z <= maxZ ) {\r\n\r\n\t\t\tif ( p !== ear.prev && p !== ear.next &&\r\n\t\t\t\t\tpointInTriangle( a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y ) &&\r\n\t\t\t\t\tarea( p.prev, p, p.next ) >= 0 ) return false;\r\n\t\t\tp = p.nextZ;\r\n\r\n\t\t}\r\n\r\n\t\t// then look for points in decreasing z-order\r\n\r\n\t\tp = ear.prevZ;\r\n\r\n\t\twhile ( p && p.z >= minZ ) {\r\n\r\n\t\t\tif ( p !== ear.prev && p !== ear.next &&\r\n\t\t\t\t\tpointInTriangle( a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y ) &&\r\n\t\t\t\t\tarea( p.prev, p, p.next ) >= 0 ) return false;\r\n\r\n\t\t\tp = p.prevZ;\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t}\r\n\r\n\t// go through all polygon nodes and cure small local self-intersections\r\n\r\n\tfunction cureLocalIntersections( start, triangles, dim ) {\r\n\r\n\t\tvar p = start;\r\n\r\n\t\tdo {\r\n\r\n\t\t\tvar a = p.prev, b = p.next.next;\r\n\r\n\t\t\tif ( ! equals( a, b ) && intersects( a, p, p.next, b ) && locallyInside( a, b ) && locallyInside( b, a ) ) {\r\n\r\n\t\t\t\ttriangles.push( a.i / dim );\r\n\t\t\t\ttriangles.push( p.i / dim );\r\n\t\t\t\ttriangles.push( b.i / dim );\r\n\r\n\t\t\t\t// remove two nodes involved\r\n\r\n\t\t\t\tremoveNode( p );\r\n\t\t\t\tremoveNode( p.next );\r\n\r\n\t\t\t\tp = start = b;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tp = p.next;\r\n\r\n\t\t} while ( p !== start );\r\n\r\n\t\treturn p;\r\n\r\n\t}\r\n\r\n\t// try splitting polygon into two and triangulate them independently\r\n\r\n\tfunction splitEarcut( start, triangles, dim, minX, minY, invSize ) {\r\n\r\n\t\t// look for a valid diagonal that divides the polygon into two\r\n\r\n\t\tvar a = start;\r\n\r\n\t\tdo {\r\n\r\n\t\t\tvar b = a.next.next;\r\n\r\n\t\t\twhile ( b !== a.prev ) {\r\n\r\n\t\t\t\tif ( a.i !== b.i && isValidDiagonal( a, b ) ) {\r\n\r\n\t\t\t\t\t// split the polygon in two by the diagonal\r\n\r\n\t\t\t\t\tvar c = splitPolygon( a, b );\r\n\r\n\t\t\t\t\t// filter colinear points around the cuts\r\n\r\n\t\t\t\t\ta = filterPoints( a, a.next );\r\n\t\t\t\t\tc = filterPoints( c, c.next );\r\n\r\n\t\t\t\t\t// run earcut on each half\r\n\r\n\t\t\t\t\tearcutLinked( a, triangles, dim, minX, minY, invSize );\r\n\t\t\t\t\tearcutLinked( c, triangles, dim, minX, minY, invSize );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tb = b.next;\r\n\r\n\t\t\t}\r\n\r\n\t\t\ta = a.next;\r\n\r\n\t\t} while ( a !== start );\r\n\r\n\t}\r\n\r\n\t// link every hole into the outer loop, producing a single-ring polygon without holes\r\n\r\n\tfunction eliminateHoles( data, holeIndices, outerNode, dim ) {\r\n\r\n\t\tvar queue = [], i, len, start, end, list;\r\n\r\n\t\tfor ( i = 0, len = holeIndices.length; i < len; i ++ ) {\r\n\r\n\t\t\tstart = holeIndices[ i ] * dim;\r\n\t\t\tend = i < len - 1 ? holeIndices[ i + 1 ] * dim : data.length;\r\n\t\t\tlist = linkedList( data, start, end, dim, false );\r\n\t\t\tif ( list === list.next ) list.steiner = true;\r\n\t\t\tqueue.push( getLeftmost( list ) );\r\n\r\n\t\t}\r\n\r\n\t\tqueue.sort( compareX );\r\n\r\n\t\t// process holes from left to right\r\n\r\n\t\tfor ( i = 0; i < queue.length; i ++ ) {\r\n\r\n\t\t\teliminateHole( queue[ i ], outerNode );\r\n\t\t\touterNode = filterPoints( outerNode, outerNode.next );\r\n\r\n\t\t}\r\n\r\n\t\treturn outerNode;\r\n\r\n\t}\r\n\r\n\tfunction compareX( a, b ) {\r\n\r\n\t\treturn a.x - b.x;\r\n\r\n\t}\r\n\r\n\t// find a bridge between vertices that connects hole with an outer ring and and link it\r\n\r\n\tfunction eliminateHole( hole, outerNode ) {\r\n\r\n\t\touterNode = findHoleBridge( hole, outerNode );\r\n\r\n\t\tif ( outerNode ) {\r\n\r\n\t\t\tvar b = splitPolygon( outerNode, hole );\r\n\r\n\t\t\tfilterPoints( b, b.next );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// David Eberly's algorithm for finding a bridge between hole and outer polygon\r\n\r\n\tfunction findHoleBridge( hole, outerNode ) {\r\n\r\n\t\tvar p = outerNode,\r\n\t\t\thx = hole.x,\r\n\t\t\thy = hole.y,\r\n\t\t\tqx = - Infinity,\r\n\t\t\tm;\r\n\r\n\t\t// find a segment intersected by a ray from the hole's leftmost point to the left;\r\n\t\t// segment's endpoint with lesser x will be potential connection point\r\n\r\n\t\tdo {\r\n\r\n\t\t\tif ( hy <= p.y && hy >= p.next.y && p.next.y !== p.y ) {\r\n\r\n\t\t\t\tvar x = p.x + ( hy - p.y ) * ( p.next.x - p.x ) / ( p.next.y - p.y );\r\n\r\n\t\t\t\tif ( x <= hx && x > qx ) {\r\n\r\n\t\t\t\t\tqx = x;\r\n\r\n\t\t\t\t\tif ( x === hx ) {\r\n\r\n\t\t\t\t\t\tif ( hy === p.y ) return p;\r\n\t\t\t\t\t\tif ( hy === p.next.y ) return p.next;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tm = p.x < p.next.x ? p : p.next;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tp = p.next;\r\n\r\n\t\t} while ( p !== outerNode );\r\n\r\n\t\tif ( ! m ) return null;\r\n\r\n\t\tif ( hx === qx ) return m.prev; // hole touches outer segment; pick lower endpoint\r\n\r\n\t\t// look for points inside the triangle of hole point, segment intersection and endpoint;\r\n\t\t// if there are no points found, we have a valid connection;\r\n\t\t// otherwise choose the point of the minimum angle with the ray as connection point\r\n\r\n\t\tvar stop = m,\r\n\t\t\tmx = m.x,\r\n\t\t\tmy = m.y,\r\n\t\t\ttanMin = Infinity,\r\n\t\t\ttan;\r\n\r\n\t\tp = m.next;\r\n\r\n\t\twhile ( p !== stop ) {\r\n\r\n\t\t\tif ( hx >= p.x && p.x >= mx && hx !== p.x &&\r\n\t\t\t\t\t\t\tpointInTriangle( hy < my ? hx : qx, hy, mx, my, hy < my ? qx : hx, hy, p.x, p.y ) ) {\r\n\r\n\t\t\t\ttan = Math.abs( hy - p.y ) / ( hx - p.x ); // tangential\r\n\r\n\t\t\t\tif ( ( tan < tanMin || ( tan === tanMin && p.x > m.x ) ) && locallyInside( p, hole ) ) {\r\n\r\n\t\t\t\t\tm = p;\r\n\t\t\t\t\ttanMin = tan;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tp = p.next;\r\n\r\n\t\t}\r\n\r\n\t\treturn m;\r\n\r\n\t}\r\n\r\n\t// interlink polygon nodes in z-order\r\n\r\n\tfunction indexCurve( start, minX, minY, invSize ) {\r\n\r\n\t\tvar p = start;\r\n\r\n\t\tdo {\r\n\r\n\t\t\tif ( p.z === null ) p.z = zOrder( p.x, p.y, minX, minY, invSize );\r\n\t\t\tp.prevZ = p.prev;\r\n\t\t\tp.nextZ = p.next;\r\n\t\t\tp = p.next;\r\n\r\n\t\t} while ( p !== start );\r\n\r\n\t\tp.prevZ.nextZ = null;\r\n\t\tp.prevZ = null;\r\n\r\n\t\tsortLinked( p );\r\n\r\n\t}\r\n\r\n\t// Simon Tatham's linked list merge sort algorithm\r\n\t// http://www.chiark.greenend.org.uk/~sgtatham/algorithms/listsort.html\r\n\r\n\tfunction sortLinked( list ) {\r\n\r\n\t\tvar i, p, q, e, tail, numMerges, pSize, qSize, inSize = 1;\r\n\r\n\t\tdo {\r\n\r\n\t\t\tp = list;\r\n\t\t\tlist = null;\r\n\t\t\ttail = null;\r\n\t\t\tnumMerges = 0;\r\n\r\n\t\t\twhile ( p ) {\r\n\r\n\t\t\t\tnumMerges ++;\r\n\t\t\t\tq = p;\r\n\t\t\t\tpSize = 0;\r\n\r\n\t\t\t\tfor ( i = 0; i < inSize; i ++ ) {\r\n\r\n\t\t\t\t\tpSize ++;\r\n\t\t\t\t\tq = q.nextZ;\r\n\t\t\t\t\tif ( ! q ) break;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tqSize = inSize;\r\n\r\n\t\t\t\twhile ( pSize > 0 || ( qSize > 0 && q ) ) {\r\n\r\n\t\t\t\t\tif ( pSize !== 0 && ( qSize === 0 || ! q || p.z <= q.z ) ) {\r\n\r\n\t\t\t\t\t\te = p;\r\n\t\t\t\t\t\tp = p.nextZ;\r\n\t\t\t\t\t\tpSize --;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\te = q;\r\n\t\t\t\t\t\tq = q.nextZ;\r\n\t\t\t\t\t\tqSize --;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( tail ) tail.nextZ = e;\r\n\t\t\t\t\telse list = e;\r\n\r\n\t\t\t\t\te.prevZ = tail;\r\n\t\t\t\t\ttail = e;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tp = q;\r\n\r\n\t\t\t}\r\n\r\n\t\t\ttail.nextZ = null;\r\n\t\t\tinSize *= 2;\r\n\r\n\t\t} while ( numMerges > 1 );\r\n\r\n\t\treturn list;\r\n\r\n\t}\r\n\r\n\t// z-order of a point given coords and inverse of the longer side of data bbox\r\n\r\n\tfunction zOrder( x, y, minX, minY, invSize ) {\r\n\r\n\t\t// coords are transformed into non-negative 15-bit integer range\r\n\r\n\t\tx = 32767 * ( x - minX ) * invSize;\r\n\t\ty = 32767 * ( y - minY ) * invSize;\r\n\r\n\t\tx = ( x | ( x << 8 ) ) & 0x00FF00FF;\r\n\t\tx = ( x | ( x << 4 ) ) & 0x0F0F0F0F;\r\n\t\tx = ( x | ( x << 2 ) ) & 0x33333333;\r\n\t\tx = ( x | ( x << 1 ) ) & 0x55555555;\r\n\r\n\t\ty = ( y | ( y << 8 ) ) & 0x00FF00FF;\r\n\t\ty = ( y | ( y << 4 ) ) & 0x0F0F0F0F;\r\n\t\ty = ( y | ( y << 2 ) ) & 0x33333333;\r\n\t\ty = ( y | ( y << 1 ) ) & 0x55555555;\r\n\r\n\t\treturn x | ( y << 1 );\r\n\r\n\t}\r\n\r\n\t// find the leftmost node of a polygon ring\r\n\r\n\tfunction getLeftmost( start ) {\r\n\r\n\t\tvar p = start, leftmost = start;\r\n\r\n\t\tdo {\r\n\r\n\t\t\tif ( p.x < leftmost.x ) leftmost = p;\r\n\t\t\tp = p.next;\r\n\r\n\t\t} while ( p !== start );\r\n\r\n\t\treturn leftmost;\r\n\r\n\t}\r\n\r\n\t// check if a point lies within a convex triangle\r\n\r\n\tfunction pointInTriangle( ax, ay, bx, by, cx, cy, px, py ) {\r\n\r\n\t\treturn ( cx - px ) * ( ay - py ) - ( ax - px ) * ( cy - py ) >= 0 &&\r\n\t\t ( ax - px ) * ( by - py ) - ( bx - px ) * ( ay - py ) >= 0 &&\r\n\t\t ( bx - px ) * ( cy - py ) - ( cx - px ) * ( by - py ) >= 0;\r\n\r\n\t}\r\n\r\n\t// check if a diagonal between two polygon nodes is valid (lies in polygon interior)\r\n\r\n\tfunction isValidDiagonal( a, b ) {\r\n\r\n\t\treturn a.next.i !== b.i && a.prev.i !== b.i && ! intersectsPolygon( a, b ) &&\r\n\t\t\tlocallyInside( a, b ) && locallyInside( b, a ) && middleInside( a, b );\r\n\r\n\t}\r\n\r\n\t// signed area of a triangle\r\n\r\n\tfunction area( p, q, r ) {\r\n\r\n\t\treturn ( q.y - p.y ) * ( r.x - q.x ) - ( q.x - p.x ) * ( r.y - q.y );\r\n\r\n\t}\r\n\r\n\t// check if two points are equal\r\n\r\n\tfunction equals( p1, p2 ) {\r\n\r\n\t\treturn p1.x === p2.x && p1.y === p2.y;\r\n\r\n\t}\r\n\r\n\t// check if two segments intersect\r\n\r\n\tfunction intersects( p1, q1, p2, q2 ) {\r\n\r\n\t\tif ( ( equals( p1, q1 ) && equals( p2, q2 ) ) ||\r\n\t\t\t\t( equals( p1, q2 ) && equals( p2, q1 ) ) ) return true;\r\n\r\n\t\treturn area( p1, q1, p2 ) > 0 !== area( p1, q1, q2 ) > 0 &&\r\n\t\t\t\t\t area( p2, q2, p1 ) > 0 !== area( p2, q2, q1 ) > 0;\r\n\r\n\t}\r\n\r\n\t// check if a polygon diagonal intersects any polygon segments\r\n\r\n\tfunction intersectsPolygon( a, b ) {\r\n\r\n\t\tvar p = a;\r\n\r\n\t\tdo {\r\n\r\n\t\t\tif ( p.i !== a.i && p.next.i !== a.i && p.i !== b.i && p.next.i !== b.i &&\r\n\t\t\t\t\t\t\tintersects( p, p.next, a, b ) ) {\r\n\r\n\t\t\t\treturn true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tp = p.next;\r\n\r\n\t\t} while ( p !== a );\r\n\r\n\t\treturn false;\r\n\r\n\t}\r\n\r\n\t// check if a polygon diagonal is locally inside the polygon\r\n\r\n\tfunction locallyInside( a, b ) {\r\n\r\n\t\treturn area( a.prev, a, a.next ) < 0 ?\r\n\t\t\tarea( a, b, a.next ) >= 0 && area( a, a.prev, b ) >= 0 :\r\n\t\t\tarea( a, b, a.prev ) < 0 || area( a, a.next, b ) < 0;\r\n\r\n\t}\r\n\r\n\t// check if the middle point of a polygon diagonal is inside the polygon\r\n\r\n\tfunction middleInside( a, b ) {\r\n\r\n\t\tvar p = a,\r\n\t\t\tinside = false,\r\n\t\t\tpx = ( a.x + b.x ) / 2,\r\n\t\t\tpy = ( a.y + b.y ) / 2;\r\n\r\n\t\tdo {\r\n\r\n\t\t\tif ( ( ( p.y > py ) !== ( p.next.y > py ) ) && p.next.y !== p.y &&\r\n\t\t\t\t\t\t\t( px < ( p.next.x - p.x ) * ( py - p.y ) / ( p.next.y - p.y ) + p.x ) ) {\r\n\r\n\t\t\t\tinside = ! inside;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tp = p.next;\r\n\r\n\t\t} while ( p !== a );\r\n\r\n\t\treturn inside;\r\n\r\n\t}\r\n\r\n\t// link two polygon vertices with a bridge; if the vertices belong to the same ring, it splits polygon into two;\r\n\t// if one belongs to the outer ring and another to a hole, it merges it into a single ring\r\n\r\n\tfunction splitPolygon( a, b ) {\r\n\r\n\t\tvar a2 = new Node( a.i, a.x, a.y ),\r\n\t\t\tb2 = new Node( b.i, b.x, b.y ),\r\n\t\t\tan = a.next,\r\n\t\t\tbp = b.prev;\r\n\r\n\t\ta.next = b;\r\n\t\tb.prev = a;\r\n\r\n\t\ta2.next = an;\r\n\t\tan.prev = a2;\r\n\r\n\t\tb2.next = a2;\r\n\t\ta2.prev = b2;\r\n\r\n\t\tbp.next = b2;\r\n\t\tb2.prev = bp;\r\n\r\n\t\treturn b2;\r\n\r\n\t}\r\n\r\n\t// create a node and optionally link it with previous one (in a circular doubly linked list)\r\n\r\n\tfunction insertNode( i, x, y, last ) {\r\n\r\n\t\tvar p = new Node( i, x, y );\r\n\r\n\t\tif ( ! last ) {\r\n\r\n\t\t\tp.prev = p;\r\n\t\t\tp.next = p;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tp.next = last.next;\r\n\t\t\tp.prev = last;\r\n\t\t\tlast.next.prev = p;\r\n\t\t\tlast.next = p;\r\n\r\n\t\t}\r\n\r\n\t\treturn p;\r\n\r\n\t}\r\n\r\n\tfunction removeNode( p ) {\r\n\r\n\t\tp.next.prev = p.prev;\r\n\t\tp.prev.next = p.next;\r\n\r\n\t\tif ( p.prevZ ) p.prevZ.nextZ = p.nextZ;\r\n\t\tif ( p.nextZ ) p.nextZ.prevZ = p.prevZ;\r\n\r\n\t}\r\n\r\n\tfunction Node( i, x, y ) {\r\n\r\n\t\t// vertice index in coordinates array\r\n\t\tthis.i = i;\r\n\r\n\t\t// vertex coordinates\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\r\n\t\t// previous and next vertice nodes in a polygon ring\r\n\t\tthis.prev = null;\r\n\t\tthis.next = null;\r\n\r\n\t\t// z-order curve value\r\n\t\tthis.z = null;\r\n\r\n\t\t// previous and next nodes in z-order\r\n\t\tthis.prevZ = null;\r\n\t\tthis.nextZ = null;\r\n\r\n\t\t// indicates whether this is a steiner point\r\n\t\tthis.steiner = false;\r\n\r\n\t}\r\n\r\n\tfunction signedArea( data, start, end, dim ) {\r\n\r\n\t\tvar sum = 0;\r\n\r\n\t\tfor ( var i = start, j = end - dim; i < end; i += dim ) {\r\n\r\n\t\t\tsum += ( data[ j ] - data[ i ] ) * ( data[ i + 1 ] + data[ j + 1 ] );\r\n\t\t\tj = i;\r\n\r\n\t\t}\r\n\r\n\t\treturn sum;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\r\n\t */\r\n\r\n\tvar ShapeUtils = {\r\n\r\n\t\t// calculate area of the contour polygon\r\n\r\n\t\tarea: function ( contour ) {\r\n\r\n\t\t\tvar n = contour.length;\r\n\t\t\tvar a = 0.0;\r\n\r\n\t\t\tfor ( var p = n - 1, q = 0; q < n; p = q ++ ) {\r\n\r\n\t\t\t\ta += contour[ p ].x * contour[ q ].y - contour[ q ].x * contour[ p ].y;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn a * 0.5;\r\n\r\n\t\t},\r\n\r\n\t\tisClockWise: function ( pts ) {\r\n\r\n\t\t\treturn ShapeUtils.area( pts ) < 0;\r\n\r\n\t\t},\r\n\r\n\t\ttriangulateShape: function ( contour, holes ) {\r\n\r\n\t\t\tvar vertices = []; // flat array of vertices like [ x0,y0, x1,y1, x2,y2, ... ]\r\n\t\t\tvar holeIndices = []; // array of hole indices\r\n\t\t\tvar faces = []; // final array of vertex indices like [ [ a,b,d ], [ b,c,d ] ]\r\n\r\n\t\t\tremoveDupEndPts( contour );\r\n\t\t\taddContour( vertices, contour );\r\n\r\n\t\t\t//\r\n\r\n\t\t\tvar holeIndex = contour.length;\r\n\r\n\t\t\tholes.forEach( removeDupEndPts );\r\n\r\n\t\t\tfor ( var i = 0; i < holes.length; i ++ ) {\r\n\r\n\t\t\t\tholeIndices.push( holeIndex );\r\n\t\t\t\tholeIndex += holes[ i ].length;\r\n\t\t\t\taddContour( vertices, holes[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tvar triangles = Earcut.triangulate( vertices, holeIndices );\r\n\r\n\t\t\t//\r\n\r\n\t\t\tfor ( var i = 0; i < triangles.length; i += 3 ) {\r\n\r\n\t\t\t\tfaces.push( triangles.slice( i, i + 3 ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn faces;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tfunction removeDupEndPts( points ) {\r\n\r\n\t\tvar l = points.length;\r\n\r\n\t\tif ( l > 2 && points[ l - 1 ].equals( points[ 0 ] ) ) {\r\n\r\n\t\t\tpoints.pop();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction addContour( vertices, contour ) {\r\n\r\n\t\tfor ( var i = 0; i < contour.length; i ++ ) {\r\n\r\n\t\t\tvertices.push( contour[ i ].x );\r\n\t\t\tvertices.push( contour[ i ].y );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\r\n\t *\r\n\t * Creates extruded geometry from a path shape.\r\n\t *\r\n\t * parameters = {\r\n\t *\r\n\t *  curveSegments: <int>, // number of points on the curves\r\n\t *  steps: <int>, // number of points for z-side extrusions / used for subdividing segments of extrude spline too\r\n\t *  depth: <float>, // Depth to extrude the shape\r\n\t *\r\n\t *  bevelEnabled: <bool>, // turn on bevel\r\n\t *  bevelThickness: <float>, // how deep into the original shape bevel goes\r\n\t *  bevelSize: <float>, // how far from shape outline is bevel\r\n\t *  bevelSegments: <int>, // number of bevel layers\r\n\t *\r\n\t *  extrudePath: <THREE.Curve> // curve to extrude shape along\r\n\t *\r\n\t *  UVGenerator: <Object> // object that provides UV generator functions\r\n\t *\r\n\t * }\r\n\t */\r\n\r\n\t// ExtrudeGeometry\r\n\r\n\tfunction ExtrudeGeometry( shapes, options ) {\r\n\r\n\t\tGeometry.call( this );\r\n\r\n\t\tthis.type = 'ExtrudeGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tshapes: shapes,\r\n\t\t\toptions: options\r\n\t\t};\r\n\r\n\t\tthis.fromBufferGeometry( new ExtrudeBufferGeometry( shapes, options ) );\r\n\t\tthis.mergeVertices();\r\n\r\n\t}\r\n\r\n\tExtrudeGeometry.prototype = Object.create( Geometry.prototype );\r\n\tExtrudeGeometry.prototype.constructor = ExtrudeGeometry;\r\n\r\n\tExtrudeGeometry.prototype.toJSON = function () {\r\n\r\n\t\tvar data = Geometry.prototype.toJSON.call( this );\r\n\r\n\t\tvar shapes = this.parameters.shapes;\r\n\t\tvar options = this.parameters.options;\r\n\r\n\t\treturn toJSON( shapes, options, data );\r\n\r\n\t};\r\n\r\n\t// ExtrudeBufferGeometry\r\n\r\n\tfunction ExtrudeBufferGeometry( shapes, options ) {\r\n\r\n\t\tBufferGeometry.call( this );\r\n\r\n\t\tthis.type = 'ExtrudeBufferGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tshapes: shapes,\r\n\t\t\toptions: options\r\n\t\t};\r\n\r\n\t\tshapes = Array.isArray( shapes ) ? shapes : [ shapes ];\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar verticesArray = [];\r\n\t\tvar uvArray = [];\r\n\r\n\t\tfor ( var i = 0, l = shapes.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar shape = shapes[ i ];\r\n\t\t\taddShape( shape );\r\n\r\n\t\t}\r\n\r\n\t\t// build geometry\r\n\r\n\t\tthis.addAttribute( 'position', new Float32BufferAttribute( verticesArray, 3 ) );\r\n\t\tthis.addAttribute( 'uv', new Float32BufferAttribute( uvArray, 2 ) );\r\n\r\n\t\tthis.computeVertexNormals();\r\n\r\n\t\t// functions\r\n\r\n\t\tfunction addShape( shape ) {\r\n\r\n\t\t\tvar placeholder = [];\r\n\r\n\t\t\t// options\r\n\r\n\t\t\tvar curveSegments = options.curveSegments !== undefined ? options.curveSegments : 12;\r\n\t\t\tvar steps = options.steps !== undefined ? options.steps : 1;\r\n\t\t\tvar depth = options.depth !== undefined ? options.depth : 100;\r\n\r\n\t\t\tvar bevelEnabled = options.bevelEnabled !== undefined ? options.bevelEnabled : true;\r\n\t\t\tvar bevelThickness = options.bevelThickness !== undefined ? options.bevelThickness : 6;\r\n\t\t\tvar bevelSize = options.bevelSize !== undefined ? options.bevelSize : bevelThickness - 2;\r\n\t\t\tvar bevelSegments = options.bevelSegments !== undefined ? options.bevelSegments : 3;\r\n\r\n\t\t\tvar extrudePath = options.extrudePath;\r\n\r\n\t\t\tvar uvgen = options.UVGenerator !== undefined ? options.UVGenerator : WorldUVGenerator;\r\n\r\n\t\t\t// deprecated options\r\n\r\n\t\t\tif ( options.amount !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.ExtrudeBufferGeometry: amount has been renamed to depth.' );\r\n\t\t\t\tdepth = options.amount;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tvar extrudePts, extrudeByPath = false;\r\n\t\t\tvar splineTube, binormal, normal, position2;\r\n\r\n\t\t\tif ( extrudePath ) {\r\n\r\n\t\t\t\textrudePts = extrudePath.getSpacedPoints( steps );\r\n\r\n\t\t\t\textrudeByPath = true;\r\n\t\t\t\tbevelEnabled = false; // bevels not supported for path extrusion\r\n\r\n\t\t\t\t// SETUP TNB variables\r\n\r\n\t\t\t\t// TODO1 - have a .isClosed in spline?\r\n\r\n\t\t\t\tsplineTube = extrudePath.computeFrenetFrames( steps, false );\r\n\r\n\t\t\t\t// console.log(splineTube, 'splineTube', splineTube.normals.length, 'steps', steps, 'extrudePts', extrudePts.length);\r\n\r\n\t\t\t\tbinormal = new Vector3();\r\n\t\t\t\tnormal = new Vector3();\r\n\t\t\t\tposition2 = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Safeguards if bevels are not enabled\r\n\r\n\t\t\tif ( ! bevelEnabled ) {\r\n\r\n\t\t\t\tbevelSegments = 0;\r\n\t\t\t\tbevelThickness = 0;\r\n\t\t\t\tbevelSize = 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Variables initialization\r\n\r\n\t\t\tvar ahole, h, hl; // looping of holes\r\n\r\n\t\t\tvar shapePoints = shape.extractPoints( curveSegments );\r\n\r\n\t\t\tvar vertices = shapePoints.shape;\r\n\t\t\tvar holes = shapePoints.holes;\r\n\r\n\t\t\tvar reverse = ! ShapeUtils.isClockWise( vertices );\r\n\r\n\t\t\tif ( reverse ) {\r\n\r\n\t\t\t\tvertices = vertices.reverse();\r\n\r\n\t\t\t\t// Maybe we should also check if holes are in the opposite direction, just to be safe ...\r\n\r\n\t\t\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\t\t\t\tahole = holes[ h ];\r\n\r\n\t\t\t\t\tif ( ShapeUtils.isClockWise( ahole ) ) {\r\n\r\n\t\t\t\t\t\tholes[ h ] = ahole.reverse();\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\tvar faces = ShapeUtils.triangulateShape( vertices, holes );\r\n\r\n\t\t\t/* Vertices */\r\n\r\n\t\t\tvar contour = vertices; // vertices has all points but contour has only points of circumference\r\n\r\n\t\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\t\t\tahole = holes[ h ];\r\n\r\n\t\t\t\tvertices = vertices.concat( ahole );\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\tfunction scalePt2( pt, vec, size ) {\r\n\r\n\t\t\t\tif ( ! vec ) console.error( \"THREE.ExtrudeGeometry: vec does not exist\" );\r\n\r\n\t\t\t\treturn vec.clone().multiplyScalar( size ).add( pt );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar b, bs, t, z,\r\n\t\t\t\tvert, vlen = vertices.length,\r\n\t\t\t\tface, flen = faces.length;\r\n\r\n\r\n\t\t\t// Find directions for point movement\r\n\r\n\r\n\t\t\tfunction getBevelVec( inPt, inPrev, inNext ) {\r\n\r\n\t\t\t\t// computes for inPt the corresponding point inPt' on a new contour\r\n\t\t\t\t//   shifted by 1 unit (length of normalized vector) to the left\r\n\t\t\t\t// if we walk along contour clockwise, this new contour is outside the old one\r\n\t\t\t\t//\r\n\t\t\t\t// inPt' is the intersection of the two lines parallel to the two\r\n\t\t\t\t//  adjacent edges of inPt at a distance of 1 unit on the left side.\r\n\r\n\t\t\t\tvar v_trans_x, v_trans_y, shrink_by; // resulting translation vector for inPt\r\n\r\n\t\t\t\t// good reading for geometry algorithms (here: line-line intersection)\r\n\t\t\t\t// http://geomalgorithms.com/a05-_intersect-1.html\r\n\r\n\t\t\t\tvar v_prev_x = inPt.x - inPrev.x,\r\n\t\t\t\t\tv_prev_y = inPt.y - inPrev.y;\r\n\t\t\t\tvar v_next_x = inNext.x - inPt.x,\r\n\t\t\t\t\tv_next_y = inNext.y - inPt.y;\r\n\r\n\t\t\t\tvar v_prev_lensq = ( v_prev_x * v_prev_x + v_prev_y * v_prev_y );\r\n\r\n\t\t\t\t// check for collinear edges\r\n\t\t\t\tvar collinear0 = ( v_prev_x * v_next_y - v_prev_y * v_next_x );\r\n\r\n\t\t\t\tif ( Math.abs( collinear0 ) > Number.EPSILON ) {\r\n\r\n\t\t\t\t\t// not collinear\r\n\r\n\t\t\t\t\t// length of vectors for normalizing\r\n\r\n\t\t\t\t\tvar v_prev_len = Math.sqrt( v_prev_lensq );\r\n\t\t\t\t\tvar v_next_len = Math.sqrt( v_next_x * v_next_x + v_next_y * v_next_y );\r\n\r\n\t\t\t\t\t// shift adjacent points by unit vectors to the left\r\n\r\n\t\t\t\t\tvar ptPrevShift_x = ( inPrev.x - v_prev_y / v_prev_len );\r\n\t\t\t\t\tvar ptPrevShift_y = ( inPrev.y + v_prev_x / v_prev_len );\r\n\r\n\t\t\t\t\tvar ptNextShift_x = ( inNext.x - v_next_y / v_next_len );\r\n\t\t\t\t\tvar ptNextShift_y = ( inNext.y + v_next_x / v_next_len );\r\n\r\n\t\t\t\t\t// scaling factor for v_prev to intersection point\r\n\r\n\t\t\t\t\tvar sf = ( ( ptNextShift_x - ptPrevShift_x ) * v_next_y -\r\n\t\t\t\t\t\t\t( ptNextShift_y - ptPrevShift_y ) * v_next_x ) /\r\n\t\t\t\t\t\t( v_prev_x * v_next_y - v_prev_y * v_next_x );\r\n\r\n\t\t\t\t\t// vector from inPt to intersection point\r\n\r\n\t\t\t\t\tv_trans_x = ( ptPrevShift_x + v_prev_x * sf - inPt.x );\r\n\t\t\t\t\tv_trans_y = ( ptPrevShift_y + v_prev_y * sf - inPt.y );\r\n\r\n\t\t\t\t\t// Don't normalize!, otherwise sharp corners become ugly\r\n\t\t\t\t\t//  but prevent crazy spikes\r\n\t\t\t\t\tvar v_trans_lensq = ( v_trans_x * v_trans_x + v_trans_y * v_trans_y );\r\n\t\t\t\t\tif ( v_trans_lensq <= 2 ) {\r\n\r\n\t\t\t\t\t\treturn new Vector2( v_trans_x, v_trans_y );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tshrink_by = Math.sqrt( v_trans_lensq / 2 );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// handle special case of collinear edges\r\n\r\n\t\t\t\t\tvar direction_eq = false; // assumes: opposite\r\n\t\t\t\t\tif ( v_prev_x > Number.EPSILON ) {\r\n\r\n\t\t\t\t\t\tif ( v_next_x > Number.EPSILON ) {\r\n\r\n\t\t\t\t\t\t\tdirection_eq = true;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tif ( v_prev_x < - Number.EPSILON ) {\r\n\r\n\t\t\t\t\t\t\tif ( v_next_x < - Number.EPSILON ) {\r\n\r\n\t\t\t\t\t\t\t\tdirection_eq = true;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tif ( Math.sign( v_prev_y ) === Math.sign( v_next_y ) ) {\r\n\r\n\t\t\t\t\t\t\t\tdirection_eq = true;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( direction_eq ) {\r\n\r\n\t\t\t\t\t\t// console.log(\"Warning: lines are a straight sequence\");\r\n\t\t\t\t\t\tv_trans_x = - v_prev_y;\r\n\t\t\t\t\t\tv_trans_y = v_prev_x;\r\n\t\t\t\t\t\tshrink_by = Math.sqrt( v_prev_lensq );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// console.log(\"Warning: lines are a straight spike\");\r\n\t\t\t\t\t\tv_trans_x = v_prev_x;\r\n\t\t\t\t\t\tv_trans_y = v_prev_y;\r\n\t\t\t\t\t\tshrink_by = Math.sqrt( v_prev_lensq / 2 );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn new Vector2( v_trans_x / shrink_by, v_trans_y / shrink_by );\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\tvar contourMovements = [];\r\n\r\n\t\t\tfor ( var i = 0, il = contour.length, j = il - 1, k = i + 1; i < il; i ++, j ++, k ++ ) {\r\n\r\n\t\t\t\tif ( j === il ) j = 0;\r\n\t\t\t\tif ( k === il ) k = 0;\r\n\r\n\t\t\t\t//  (j)---(i)---(k)\r\n\t\t\t\t// console.log('i,j,k', i, j , k)\r\n\r\n\t\t\t\tcontourMovements[ i ] = getBevelVec( contour[ i ], contour[ j ], contour[ k ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar holesMovements = [],\r\n\t\t\t\toneHoleMovements, verticesMovements = contourMovements.concat();\r\n\r\n\t\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\t\t\tahole = holes[ h ];\r\n\r\n\t\t\t\toneHoleMovements = [];\r\n\r\n\t\t\t\tfor ( i = 0, il = ahole.length, j = il - 1, k = i + 1; i < il; i ++, j ++, k ++ ) {\r\n\r\n\t\t\t\t\tif ( j === il ) j = 0;\r\n\t\t\t\t\tif ( k === il ) k = 0;\r\n\r\n\t\t\t\t\t//  (j)---(i)---(k)\r\n\t\t\t\t\toneHoleMovements[ i ] = getBevelVec( ahole[ i ], ahole[ j ], ahole[ k ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tholesMovements.push( oneHoleMovements );\r\n\t\t\t\tverticesMovements = verticesMovements.concat( oneHoleMovements );\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\t// Loop bevelSegments, 1 for the front, 1 for the back\r\n\r\n\t\t\tfor ( b = 0; b < bevelSegments; b ++ ) {\r\n\r\n\t\t\t\t//for ( b = bevelSegments; b > 0; b -- ) {\r\n\r\n\t\t\t\tt = b / bevelSegments;\r\n\t\t\t\tz = bevelThickness * Math.cos( t * Math.PI / 2 );\r\n\t\t\t\tbs = bevelSize * Math.sin( t * Math.PI / 2 );\r\n\r\n\t\t\t\t// contract shape\r\n\r\n\t\t\t\tfor ( i = 0, il = contour.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\tvert = scalePt2( contour[ i ], contourMovements[ i ], bs );\r\n\r\n\t\t\t\t\tv( vert.x, vert.y, - z );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// expand holes\r\n\r\n\t\t\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\t\t\t\tahole = holes[ h ];\r\n\t\t\t\t\toneHoleMovements = holesMovements[ h ];\r\n\r\n\t\t\t\t\tfor ( i = 0, il = ahole.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\tvert = scalePt2( ahole[ i ], oneHoleMovements[ i ], bs );\r\n\r\n\t\t\t\t\t\tv( vert.x, vert.y, - z );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tbs = bevelSize;\r\n\r\n\t\t\t// Back facing vertices\r\n\r\n\t\t\tfor ( i = 0; i < vlen; i ++ ) {\r\n\r\n\t\t\t\tvert = bevelEnabled ? scalePt2( vertices[ i ], verticesMovements[ i ], bs ) : vertices[ i ];\r\n\r\n\t\t\t\tif ( ! extrudeByPath ) {\r\n\r\n\t\t\t\t\tv( vert.x, vert.y, 0 );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// v( vert.x, vert.y + extrudePts[ 0 ].y, extrudePts[ 0 ].x );\r\n\r\n\t\t\t\t\tnormal.copy( splineTube.normals[ 0 ] ).multiplyScalar( vert.x );\r\n\t\t\t\t\tbinormal.copy( splineTube.binormals[ 0 ] ).multiplyScalar( vert.y );\r\n\r\n\t\t\t\t\tposition2.copy( extrudePts[ 0 ] ).add( normal ).add( binormal );\r\n\r\n\t\t\t\t\tv( position2.x, position2.y, position2.z );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Add stepped vertices...\r\n\t\t\t// Including front facing vertices\r\n\r\n\t\t\tvar s;\r\n\r\n\t\t\tfor ( s = 1; s <= steps; s ++ ) {\r\n\r\n\t\t\t\tfor ( i = 0; i < vlen; i ++ ) {\r\n\r\n\t\t\t\t\tvert = bevelEnabled ? scalePt2( vertices[ i ], verticesMovements[ i ], bs ) : vertices[ i ];\r\n\r\n\t\t\t\t\tif ( ! extrudeByPath ) {\r\n\r\n\t\t\t\t\t\tv( vert.x, vert.y, depth / steps * s );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// v( vert.x, vert.y + extrudePts[ s - 1 ].y, extrudePts[ s - 1 ].x );\r\n\r\n\t\t\t\t\t\tnormal.copy( splineTube.normals[ s ] ).multiplyScalar( vert.x );\r\n\t\t\t\t\t\tbinormal.copy( splineTube.binormals[ s ] ).multiplyScalar( vert.y );\r\n\r\n\t\t\t\t\t\tposition2.copy( extrudePts[ s ] ).add( normal ).add( binormal );\r\n\r\n\t\t\t\t\t\tv( position2.x, position2.y, position2.z );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\t// Add bevel segments planes\r\n\r\n\t\t\t//for ( b = 1; b <= bevelSegments; b ++ ) {\r\n\t\t\tfor ( b = bevelSegments - 1; b >= 0; b -- ) {\r\n\r\n\t\t\t\tt = b / bevelSegments;\r\n\t\t\t\tz = bevelThickness * Math.cos( t * Math.PI / 2 );\r\n\t\t\t\tbs = bevelSize * Math.sin( t * Math.PI / 2 );\r\n\r\n\t\t\t\t// contract shape\r\n\r\n\t\t\t\tfor ( i = 0, il = contour.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\tvert = scalePt2( contour[ i ], contourMovements[ i ], bs );\r\n\t\t\t\t\tv( vert.x, vert.y, depth + z );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// expand holes\r\n\r\n\t\t\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\t\t\t\tahole = holes[ h ];\r\n\t\t\t\t\toneHoleMovements = holesMovements[ h ];\r\n\r\n\t\t\t\t\tfor ( i = 0, il = ahole.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\tvert = scalePt2( ahole[ i ], oneHoleMovements[ i ], bs );\r\n\r\n\t\t\t\t\t\tif ( ! extrudeByPath ) {\r\n\r\n\t\t\t\t\t\t\tv( vert.x, vert.y, depth + z );\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tv( vert.x, vert.y + extrudePts[ steps - 1 ].y, extrudePts[ steps - 1 ].x + z );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t/* Faces */\r\n\r\n\t\t\t// Top and bottom faces\r\n\r\n\t\t\tbuildLidFaces();\r\n\r\n\t\t\t// Sides faces\r\n\r\n\t\t\tbuildSideFaces();\r\n\r\n\r\n\t\t\t/////  Internal functions\r\n\r\n\t\t\tfunction buildLidFaces() {\r\n\r\n\t\t\t\tvar start = verticesArray.length / 3;\r\n\r\n\t\t\t\tif ( bevelEnabled ) {\r\n\r\n\t\t\t\t\tvar layer = 0; // steps + 1\r\n\t\t\t\t\tvar offset = vlen * layer;\r\n\r\n\t\t\t\t\t// Bottom faces\r\n\r\n\t\t\t\t\tfor ( i = 0; i < flen; i ++ ) {\r\n\r\n\t\t\t\t\t\tface = faces[ i ];\r\n\t\t\t\t\t\tf3( face[ 2 ] + offset, face[ 1 ] + offset, face[ 0 ] + offset );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlayer = steps + bevelSegments * 2;\r\n\t\t\t\t\toffset = vlen * layer;\r\n\r\n\t\t\t\t\t// Top faces\r\n\r\n\t\t\t\t\tfor ( i = 0; i < flen; i ++ ) {\r\n\r\n\t\t\t\t\t\tface = faces[ i ];\r\n\t\t\t\t\t\tf3( face[ 0 ] + offset, face[ 1 ] + offset, face[ 2 ] + offset );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// Bottom faces\r\n\r\n\t\t\t\t\tfor ( i = 0; i < flen; i ++ ) {\r\n\r\n\t\t\t\t\t\tface = faces[ i ];\r\n\t\t\t\t\t\tf3( face[ 2 ], face[ 1 ], face[ 0 ] );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Top faces\r\n\r\n\t\t\t\t\tfor ( i = 0; i < flen; i ++ ) {\r\n\r\n\t\t\t\t\t\tface = faces[ i ];\r\n\t\t\t\t\t\tf3( face[ 0 ] + vlen * steps, face[ 1 ] + vlen * steps, face[ 2 ] + vlen * steps );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tscope.addGroup( start, verticesArray.length / 3 - start, 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Create faces for the z-sides of the shape\r\n\r\n\t\t\tfunction buildSideFaces() {\r\n\r\n\t\t\t\tvar start = verticesArray.length / 3;\r\n\t\t\t\tvar layeroffset = 0;\r\n\t\t\t\tsidewalls( contour, layeroffset );\r\n\t\t\t\tlayeroffset += contour.length;\r\n\r\n\t\t\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\t\t\t\tahole = holes[ h ];\r\n\t\t\t\t\tsidewalls( ahole, layeroffset );\r\n\r\n\t\t\t\t\t//, true\r\n\t\t\t\t\tlayeroffset += ahole.length;\r\n\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t\tscope.addGroup( start, verticesArray.length / 3 - start, 1 );\r\n\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction sidewalls( contour, layeroffset ) {\r\n\r\n\t\t\t\tvar j, k;\r\n\t\t\t\ti = contour.length;\r\n\r\n\t\t\t\twhile ( -- i >= 0 ) {\r\n\r\n\t\t\t\t\tj = i;\r\n\t\t\t\t\tk = i - 1;\r\n\t\t\t\t\tif ( k < 0 ) k = contour.length - 1;\r\n\r\n\t\t\t\t\t//console.log('b', i,j, i-1, k,vertices.length);\r\n\r\n\t\t\t\t\tvar s = 0,\r\n\t\t\t\t\t\tsl = steps + bevelSegments * 2;\r\n\r\n\t\t\t\t\tfor ( s = 0; s < sl; s ++ ) {\r\n\r\n\t\t\t\t\t\tvar slen1 = vlen * s;\r\n\t\t\t\t\t\tvar slen2 = vlen * ( s + 1 );\r\n\r\n\t\t\t\t\t\tvar a = layeroffset + j + slen1,\r\n\t\t\t\t\t\t\tb = layeroffset + k + slen1,\r\n\t\t\t\t\t\t\tc = layeroffset + k + slen2,\r\n\t\t\t\t\t\t\td = layeroffset + j + slen2;\r\n\r\n\t\t\t\t\t\tf4( a, b, c, d );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction v( x, y, z ) {\r\n\r\n\t\t\t\tplaceholder.push( x );\r\n\t\t\t\tplaceholder.push( y );\r\n\t\t\t\tplaceholder.push( z );\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\tfunction f3( a, b, c ) {\r\n\r\n\t\t\t\taddVertex( a );\r\n\t\t\t\taddVertex( b );\r\n\t\t\t\taddVertex( c );\r\n\r\n\t\t\t\tvar nextIndex = verticesArray.length / 3;\r\n\t\t\t\tvar uvs = uvgen.generateTopUV( scope, verticesArray, nextIndex - 3, nextIndex - 2, nextIndex - 1 );\r\n\r\n\t\t\t\taddUV( uvs[ 0 ] );\r\n\t\t\t\taddUV( uvs[ 1 ] );\r\n\t\t\t\taddUV( uvs[ 2 ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction f4( a, b, c, d ) {\r\n\r\n\t\t\t\taddVertex( a );\r\n\t\t\t\taddVertex( b );\r\n\t\t\t\taddVertex( d );\r\n\r\n\t\t\t\taddVertex( b );\r\n\t\t\t\taddVertex( c );\r\n\t\t\t\taddVertex( d );\r\n\r\n\r\n\t\t\t\tvar nextIndex = verticesArray.length / 3;\r\n\t\t\t\tvar uvs = uvgen.generateSideWallUV( scope, verticesArray, nextIndex - 6, nextIndex - 3, nextIndex - 2, nextIndex - 1 );\r\n\r\n\t\t\t\taddUV( uvs[ 0 ] );\r\n\t\t\t\taddUV( uvs[ 1 ] );\r\n\t\t\t\taddUV( uvs[ 3 ] );\r\n\r\n\t\t\t\taddUV( uvs[ 1 ] );\r\n\t\t\t\taddUV( uvs[ 2 ] );\r\n\t\t\t\taddUV( uvs[ 3 ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction addVertex( index ) {\r\n\r\n\t\t\t\tverticesArray.push( placeholder[ index * 3 + 0 ] );\r\n\t\t\t\tverticesArray.push( placeholder[ index * 3 + 1 ] );\r\n\t\t\t\tverticesArray.push( placeholder[ index * 3 + 2 ] );\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\tfunction addUV( vector2 ) {\r\n\r\n\t\t\t\tuvArray.push( vector2.x );\r\n\t\t\t\tuvArray.push( vector2.y );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tExtrudeBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\r\n\tExtrudeBufferGeometry.prototype.constructor = ExtrudeBufferGeometry;\r\n\r\n\tExtrudeBufferGeometry.prototype.toJSON = function () {\r\n\r\n\t\tvar data = BufferGeometry.prototype.toJSON.call( this );\r\n\r\n\t\tvar shapes = this.parameters.shapes;\r\n\t\tvar options = this.parameters.options;\r\n\r\n\t\treturn toJSON( shapes, options, data );\r\n\r\n\t};\r\n\r\n\t//\r\n\r\n\tvar WorldUVGenerator = {\r\n\r\n\t\tgenerateTopUV: function ( geometry, vertices, indexA, indexB, indexC ) {\r\n\r\n\t\t\tvar a_x = vertices[ indexA * 3 ];\r\n\t\t\tvar a_y = vertices[ indexA * 3 + 1 ];\r\n\t\t\tvar b_x = vertices[ indexB * 3 ];\r\n\t\t\tvar b_y = vertices[ indexB * 3 + 1 ];\r\n\t\t\tvar c_x = vertices[ indexC * 3 ];\r\n\t\t\tvar c_y = vertices[ indexC * 3 + 1 ];\r\n\r\n\t\t\treturn [\r\n\t\t\t\tnew Vector2( a_x, a_y ),\r\n\t\t\t\tnew Vector2( b_x, b_y ),\r\n\t\t\t\tnew Vector2( c_x, c_y )\r\n\t\t\t];\r\n\r\n\t\t},\r\n\r\n\t\tgenerateSideWallUV: function ( geometry, vertices, indexA, indexB, indexC, indexD ) {\r\n\r\n\t\t\tvar a_x = vertices[ indexA * 3 ];\r\n\t\t\tvar a_y = vertices[ indexA * 3 + 1 ];\r\n\t\t\tvar a_z = vertices[ indexA * 3 + 2 ];\r\n\t\t\tvar b_x = vertices[ indexB * 3 ];\r\n\t\t\tvar b_y = vertices[ indexB * 3 + 1 ];\r\n\t\t\tvar b_z = vertices[ indexB * 3 + 2 ];\r\n\t\t\tvar c_x = vertices[ indexC * 3 ];\r\n\t\t\tvar c_y = vertices[ indexC * 3 + 1 ];\r\n\t\t\tvar c_z = vertices[ indexC * 3 + 2 ];\r\n\t\t\tvar d_x = vertices[ indexD * 3 ];\r\n\t\t\tvar d_y = vertices[ indexD * 3 + 1 ];\r\n\t\t\tvar d_z = vertices[ indexD * 3 + 2 ];\r\n\r\n\t\t\tif ( Math.abs( a_y - b_y ) < 0.01 ) {\r\n\r\n\t\t\t\treturn [\r\n\t\t\t\t\tnew Vector2( a_x, 1 - a_z ),\r\n\t\t\t\t\tnew Vector2( b_x, 1 - b_z ),\r\n\t\t\t\t\tnew Vector2( c_x, 1 - c_z ),\r\n\t\t\t\t\tnew Vector2( d_x, 1 - d_z )\r\n\t\t\t\t];\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\treturn [\r\n\t\t\t\t\tnew Vector2( a_y, 1 - a_z ),\r\n\t\t\t\t\tnew Vector2( b_y, 1 - b_z ),\r\n\t\t\t\t\tnew Vector2( c_y, 1 - c_z ),\r\n\t\t\t\t\tnew Vector2( d_y, 1 - d_z )\r\n\t\t\t\t];\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t};\r\n\r\n\tfunction toJSON( shapes, options, data ) {\r\n\r\n\t\t//\r\n\r\n\t\tdata.shapes = [];\r\n\r\n\t\tif ( Array.isArray( shapes ) ) {\r\n\r\n\t\t\tfor ( var i = 0, l = shapes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar shape = shapes[ i ];\r\n\r\n\t\t\t\tdata.shapes.push( shape.uuid );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tdata.shapes.push( shapes.uuid );\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tif ( options.extrudePath !== undefined ) data.options.extrudePath = options.extrudePath.toJSON();\r\n\r\n\t\treturn data;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t *\r\n\t * Text = 3D Text\r\n\t *\r\n\t * parameters = {\r\n\t *  font: <THREE.Font>, // font\r\n\t *\r\n\t *  size: <float>, // size of the text\r\n\t *  height: <float>, // thickness to extrude text\r\n\t *  curveSegments: <int>, // number of points on the curves\r\n\t *\r\n\t *  bevelEnabled: <bool>, // turn on bevel\r\n\t *  bevelThickness: <float>, // how deep into text bevel goes\r\n\t *  bevelSize: <float> // how far from text outline is bevel\r\n\t * }\r\n\t */\r\n\r\n\t// TextGeometry\r\n\r\n\tfunction TextGeometry( text, parameters ) {\r\n\r\n\t\tGeometry.call( this );\r\n\r\n\t\tthis.type = 'TextGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\ttext: text,\r\n\t\t\tparameters: parameters\r\n\t\t};\r\n\r\n\t\tthis.fromBufferGeometry( new TextBufferGeometry( text, parameters ) );\r\n\t\tthis.mergeVertices();\r\n\r\n\t}\r\n\r\n\tTextGeometry.prototype = Object.create( Geometry.prototype );\r\n\tTextGeometry.prototype.constructor = TextGeometry;\r\n\r\n\t// TextBufferGeometry\r\n\r\n\tfunction TextBufferGeometry( text, parameters ) {\r\n\r\n\t\tparameters = parameters || {};\r\n\r\n\t\tvar font = parameters.font;\r\n\r\n\t\tif ( ! ( font && font.isFont ) ) {\r\n\r\n\t\t\tconsole.error( 'THREE.TextGeometry: font parameter is not an instance of THREE.Font.' );\r\n\t\t\treturn new Geometry();\r\n\r\n\t\t}\r\n\r\n\t\tvar shapes = font.generateShapes( text, parameters.size );\r\n\r\n\t\t// translate parameters to ExtrudeGeometry API\r\n\r\n\t\tparameters.depth = parameters.height !== undefined ? parameters.height : 50;\r\n\r\n\t\t// defaults\r\n\r\n\t\tif ( parameters.bevelThickness === undefined ) parameters.bevelThickness = 10;\r\n\t\tif ( parameters.bevelSize === undefined ) parameters.bevelSize = 8;\r\n\t\tif ( parameters.bevelEnabled === undefined ) parameters.bevelEnabled = false;\r\n\r\n\t\tExtrudeBufferGeometry.call( this, shapes, parameters );\r\n\r\n\t\tthis.type = 'TextBufferGeometry';\r\n\r\n\t}\r\n\r\n\tTextBufferGeometry.prototype = Object.create( ExtrudeBufferGeometry.prototype );\r\n\tTextBufferGeometry.prototype.constructor = TextBufferGeometry;\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author benaadams / https://twitter.com/ben_a_adams\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t */\r\n\r\n\t// SphereGeometry\r\n\r\n\tfunction SphereGeometry( radius, widthSegments, heightSegments, phiStart, phiLength, thetaStart, thetaLength ) {\r\n\r\n\t\tGeometry.call( this );\r\n\r\n\t\tthis.type = 'SphereGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\twidthSegments: widthSegments,\r\n\t\t\theightSegments: heightSegments,\r\n\t\t\tphiStart: phiStart,\r\n\t\t\tphiLength: phiLength,\r\n\t\t\tthetaStart: thetaStart,\r\n\t\t\tthetaLength: thetaLength\r\n\t\t};\r\n\r\n\t\tthis.fromBufferGeometry( new SphereBufferGeometry( radius, widthSegments, heightSegments, phiStart, phiLength, thetaStart, thetaLength ) );\r\n\t\tthis.mergeVertices();\r\n\r\n\t}\r\n\r\n\tSphereGeometry.prototype = Object.create( Geometry.prototype );\r\n\tSphereGeometry.prototype.constructor = SphereGeometry;\r\n\r\n\t// SphereBufferGeometry\r\n\r\n\tfunction SphereBufferGeometry( radius, widthSegments, heightSegments, phiStart, phiLength, thetaStart, thetaLength ) {\r\n\r\n\t\tBufferGeometry.call( this );\r\n\r\n\t\tthis.type = 'SphereBufferGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\twidthSegments: widthSegments,\r\n\t\t\theightSegments: heightSegments,\r\n\t\t\tphiStart: phiStart,\r\n\t\t\tphiLength: phiLength,\r\n\t\t\tthetaStart: thetaStart,\r\n\t\t\tthetaLength: thetaLength\r\n\t\t};\r\n\r\n\t\tradius = radius || 1;\r\n\r\n\t\twidthSegments = Math.max( 3, Math.floor( widthSegments ) || 8 );\r\n\t\theightSegments = Math.max( 2, Math.floor( heightSegments ) || 6 );\r\n\r\n\t\tphiStart = phiStart !== undefined ? phiStart : 0;\r\n\t\tphiLength = phiLength !== undefined ? phiLength : Math.PI * 2;\r\n\r\n\t\tthetaStart = thetaStart !== undefined ? thetaStart : 0;\r\n\t\tthetaLength = thetaLength !== undefined ? thetaLength : Math.PI;\r\n\r\n\t\tvar thetaEnd = thetaStart + thetaLength;\r\n\r\n\t\tvar ix, iy;\r\n\r\n\t\tvar index = 0;\r\n\t\tvar grid = [];\r\n\r\n\t\tvar vertex = new Vector3();\r\n\t\tvar normal = new Vector3();\r\n\r\n\t\t// buffers\r\n\r\n\t\tvar indices = [];\r\n\t\tvar vertices = [];\r\n\t\tvar normals = [];\r\n\t\tvar uvs = [];\r\n\r\n\t\t// generate vertices, normals and uvs\r\n\r\n\t\tfor ( iy = 0; iy <= heightSegments; iy ++ ) {\r\n\r\n\t\t\tvar verticesRow = [];\r\n\r\n\t\t\tvar v = iy / heightSegments;\r\n\r\n\t\t\tfor ( ix = 0; ix <= widthSegments; ix ++ ) {\r\n\r\n\t\t\t\tvar u = ix / widthSegments;\r\n\r\n\t\t\t\t// vertex\r\n\r\n\t\t\t\tvertex.x = - radius * Math.cos( phiStart + u * phiLength ) * Math.sin( thetaStart + v * thetaLength );\r\n\t\t\t\tvertex.y = radius * Math.cos( thetaStart + v * thetaLength );\r\n\t\t\t\tvertex.z = radius * Math.sin( phiStart + u * phiLength ) * Math.sin( thetaStart + v * thetaLength );\r\n\r\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t\t// normal\r\n\r\n\t\t\t\tnormal.set( vertex.x, vertex.y, vertex.z ).normalize();\r\n\t\t\t\tnormals.push( normal.x, normal.y, normal.z );\r\n\r\n\t\t\t\t// uv\r\n\r\n\t\t\t\tuvs.push( u, 1 - v );\r\n\r\n\t\t\t\tverticesRow.push( index ++ );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgrid.push( verticesRow );\r\n\r\n\t\t}\r\n\r\n\t\t// indices\r\n\r\n\t\tfor ( iy = 0; iy < heightSegments; iy ++ ) {\r\n\r\n\t\t\tfor ( ix = 0; ix < widthSegments; ix ++ ) {\r\n\r\n\t\t\t\tvar a = grid[ iy ][ ix + 1 ];\r\n\t\t\t\tvar b = grid[ iy ][ ix ];\r\n\t\t\t\tvar c = grid[ iy + 1 ][ ix ];\r\n\t\t\t\tvar d = grid[ iy + 1 ][ ix + 1 ];\r\n\r\n\t\t\t\tif ( iy !== 0 || thetaStart > 0 ) indices.push( a, b, d );\r\n\t\t\t\tif ( iy !== heightSegments - 1 || thetaEnd < Math.PI ) indices.push( b, c, d );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// build geometry\r\n\r\n\t\tthis.setIndex( indices );\r\n\t\tthis.addAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\t\tthis.addAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\r\n\t\tthis.addAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\r\n\r\n\t}\r\n\r\n\tSphereBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\r\n\tSphereBufferGeometry.prototype.constructor = SphereBufferGeometry;\r\n\r\n\t/**\r\n\t * @author Kaleb Murphy\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t */\r\n\r\n\t// RingGeometry\r\n\r\n\tfunction RingGeometry( innerRadius, outerRadius, thetaSegments, phiSegments, thetaStart, thetaLength ) {\r\n\r\n\t\tGeometry.call( this );\r\n\r\n\t\tthis.type = 'RingGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tinnerRadius: innerRadius,\r\n\t\t\touterRadius: outerRadius,\r\n\t\t\tthetaSegments: thetaSegments,\r\n\t\t\tphiSegments: phiSegments,\r\n\t\t\tthetaStart: thetaStart,\r\n\t\t\tthetaLength: thetaLength\r\n\t\t};\r\n\r\n\t\tthis.fromBufferGeometry( new RingBufferGeometry( innerRadius, outerRadius, thetaSegments, phiSegments, thetaStart, thetaLength ) );\r\n\t\tthis.mergeVertices();\r\n\r\n\t}\r\n\r\n\tRingGeometry.prototype = Object.create( Geometry.prototype );\r\n\tRingGeometry.prototype.constructor = RingGeometry;\r\n\r\n\t// RingBufferGeometry\r\n\r\n\tfunction RingBufferGeometry( innerRadius, outerRadius, thetaSegments, phiSegments, thetaStart, thetaLength ) {\r\n\r\n\t\tBufferGeometry.call( this );\r\n\r\n\t\tthis.type = 'RingBufferGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tinnerRadius: innerRadius,\r\n\t\t\touterRadius: outerRadius,\r\n\t\t\tthetaSegments: thetaSegments,\r\n\t\t\tphiSegments: phiSegments,\r\n\t\t\tthetaStart: thetaStart,\r\n\t\t\tthetaLength: thetaLength\r\n\t\t};\r\n\r\n\t\tinnerRadius = innerRadius || 0.5;\r\n\t\touterRadius = outerRadius || 1;\r\n\r\n\t\tthetaStart = thetaStart !== undefined ? thetaStart : 0;\r\n\t\tthetaLength = thetaLength !== undefined ? thetaLength : Math.PI * 2;\r\n\r\n\t\tthetaSegments = thetaSegments !== undefined ? Math.max( 3, thetaSegments ) : 8;\r\n\t\tphiSegments = phiSegments !== undefined ? Math.max( 1, phiSegments ) : 1;\r\n\r\n\t\t// buffers\r\n\r\n\t\tvar indices = [];\r\n\t\tvar vertices = [];\r\n\t\tvar normals = [];\r\n\t\tvar uvs = [];\r\n\r\n\t\t// some helper variables\r\n\r\n\t\tvar segment;\r\n\t\tvar radius = innerRadius;\r\n\t\tvar radiusStep = ( ( outerRadius - innerRadius ) / phiSegments );\r\n\t\tvar vertex = new Vector3();\r\n\t\tvar uv = new Vector2();\r\n\t\tvar j, i;\r\n\r\n\t\t// generate vertices, normals and uvs\r\n\r\n\t\tfor ( j = 0; j <= phiSegments; j ++ ) {\r\n\r\n\t\t\tfor ( i = 0; i <= thetaSegments; i ++ ) {\r\n\r\n\t\t\t\t// values are generate from the inside of the ring to the outside\r\n\r\n\t\t\t\tsegment = thetaStart + i / thetaSegments * thetaLength;\r\n\r\n\t\t\t\t// vertex\r\n\r\n\t\t\t\tvertex.x = radius * Math.cos( segment );\r\n\t\t\t\tvertex.y = radius * Math.sin( segment );\r\n\r\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t\t// normal\r\n\r\n\t\t\t\tnormals.push( 0, 0, 1 );\r\n\r\n\t\t\t\t// uv\r\n\r\n\t\t\t\tuv.x = ( vertex.x / outerRadius + 1 ) / 2;\r\n\t\t\t\tuv.y = ( vertex.y / outerRadius + 1 ) / 2;\r\n\r\n\t\t\t\tuvs.push( uv.x, uv.y );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// increase the radius for next row of vertices\r\n\r\n\t\t\tradius += radiusStep;\r\n\r\n\t\t}\r\n\r\n\t\t// indices\r\n\r\n\t\tfor ( j = 0; j < phiSegments; j ++ ) {\r\n\r\n\t\t\tvar thetaSegmentLevel = j * ( thetaSegments + 1 );\r\n\r\n\t\t\tfor ( i = 0; i < thetaSegments; i ++ ) {\r\n\r\n\t\t\t\tsegment = i + thetaSegmentLevel;\r\n\r\n\t\t\t\tvar a = segment;\r\n\t\t\t\tvar b = segment + thetaSegments + 1;\r\n\t\t\t\tvar c = segment + thetaSegments + 2;\r\n\t\t\t\tvar d = segment + 1;\r\n\r\n\t\t\t\t// faces\r\n\r\n\t\t\t\tindices.push( a, b, d );\r\n\t\t\t\tindices.push( b, c, d );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// build geometry\r\n\r\n\t\tthis.setIndex( indices );\r\n\t\tthis.addAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\t\tthis.addAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\r\n\t\tthis.addAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\r\n\r\n\t}\r\n\r\n\tRingBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\r\n\tRingBufferGeometry.prototype.constructor = RingBufferGeometry;\r\n\r\n\t/**\r\n\t * @author zz85 / https://github.com/zz85\r\n\t * @author bhouston / http://clara.io\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t */\r\n\r\n\t// LatheGeometry\r\n\r\n\tfunction LatheGeometry( points, segments, phiStart, phiLength ) {\r\n\r\n\t\tGeometry.call( this );\r\n\r\n\t\tthis.type = 'LatheGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tpoints: points,\r\n\t\t\tsegments: segments,\r\n\t\t\tphiStart: phiStart,\r\n\t\t\tphiLength: phiLength\r\n\t\t};\r\n\r\n\t\tthis.fromBufferGeometry( new LatheBufferGeometry( points, segments, phiStart, phiLength ) );\r\n\t\tthis.mergeVertices();\r\n\r\n\t}\r\n\r\n\tLatheGeometry.prototype = Object.create( Geometry.prototype );\r\n\tLatheGeometry.prototype.constructor = LatheGeometry;\r\n\r\n\t// LatheBufferGeometry\r\n\r\n\tfunction LatheBufferGeometry( points, segments, phiStart, phiLength ) {\r\n\r\n\t\tBufferGeometry.call( this );\r\n\r\n\t\tthis.type = 'LatheBufferGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tpoints: points,\r\n\t\t\tsegments: segments,\r\n\t\t\tphiStart: phiStart,\r\n\t\t\tphiLength: phiLength\r\n\t\t};\r\n\r\n\t\tsegments = Math.floor( segments ) || 12;\r\n\t\tphiStart = phiStart || 0;\r\n\t\tphiLength = phiLength || Math.PI * 2;\r\n\r\n\t\t// clamp phiLength so it's in range of [ 0, 2PI ]\r\n\r\n\t\tphiLength = _Math.clamp( phiLength, 0, Math.PI * 2 );\r\n\r\n\r\n\t\t// buffers\r\n\r\n\t\tvar indices = [];\r\n\t\tvar vertices = [];\r\n\t\tvar uvs = [];\r\n\r\n\t\t// helper variables\r\n\r\n\t\tvar base;\r\n\t\tvar inverseSegments = 1.0 / segments;\r\n\t\tvar vertex = new Vector3();\r\n\t\tvar uv = new Vector2();\r\n\t\tvar i, j;\r\n\r\n\t\t// generate vertices and uvs\r\n\r\n\t\tfor ( i = 0; i <= segments; i ++ ) {\r\n\r\n\t\t\tvar phi = phiStart + i * inverseSegments * phiLength;\r\n\r\n\t\t\tvar sin = Math.sin( phi );\r\n\t\t\tvar cos = Math.cos( phi );\r\n\r\n\t\t\tfor ( j = 0; j <= ( points.length - 1 ); j ++ ) {\r\n\r\n\t\t\t\t// vertex\r\n\r\n\t\t\t\tvertex.x = points[ j ].x * sin;\r\n\t\t\t\tvertex.y = points[ j ].y;\r\n\t\t\t\tvertex.z = points[ j ].x * cos;\r\n\r\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t\t// uv\r\n\r\n\t\t\t\tuv.x = i / segments;\r\n\t\t\t\tuv.y = j / ( points.length - 1 );\r\n\r\n\t\t\t\tuvs.push( uv.x, uv.y );\r\n\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// indices\r\n\r\n\t\tfor ( i = 0; i < segments; i ++ ) {\r\n\r\n\t\t\tfor ( j = 0; j < ( points.length - 1 ); j ++ ) {\r\n\r\n\t\t\t\tbase = j + i * points.length;\r\n\r\n\t\t\t\tvar a = base;\r\n\t\t\t\tvar b = base + points.length;\r\n\t\t\t\tvar c = base + points.length + 1;\r\n\t\t\t\tvar d = base + 1;\r\n\r\n\t\t\t\t// faces\r\n\r\n\t\t\t\tindices.push( a, b, d );\r\n\t\t\t\tindices.push( b, c, d );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// build geometry\r\n\r\n\t\tthis.setIndex( indices );\r\n\t\tthis.addAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\t\tthis.addAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\r\n\r\n\t\t// generate normals\r\n\r\n\t\tthis.computeVertexNormals();\r\n\r\n\t\t// if the geometry is closed, we need to average the normals along the seam.\r\n\t\t// because the corresponding vertices are identical (but still have different UVs).\r\n\r\n\t\tif ( phiLength === Math.PI * 2 ) {\r\n\r\n\t\t\tvar normals = this.attributes.normal.array;\r\n\t\t\tvar n1 = new Vector3();\r\n\t\t\tvar n2 = new Vector3();\r\n\t\t\tvar n = new Vector3();\r\n\r\n\t\t\t// this is the buffer offset for the last line of vertices\r\n\r\n\t\t\tbase = segments * points.length * 3;\r\n\r\n\t\t\tfor ( i = 0, j = 0; i < points.length; i ++, j += 3 ) {\r\n\r\n\t\t\t\t// select the normal of the vertex in the first line\r\n\r\n\t\t\t\tn1.x = normals[ j + 0 ];\r\n\t\t\t\tn1.y = normals[ j + 1 ];\r\n\t\t\t\tn1.z = normals[ j + 2 ];\r\n\r\n\t\t\t\t// select the normal of the vertex in the last line\r\n\r\n\t\t\t\tn2.x = normals[ base + j + 0 ];\r\n\t\t\t\tn2.y = normals[ base + j + 1 ];\r\n\t\t\t\tn2.z = normals[ base + j + 2 ];\r\n\r\n\t\t\t\t// average normals\r\n\r\n\t\t\t\tn.addVectors( n1, n2 ).normalize();\r\n\r\n\t\t\t\t// assign the new values to both normals\r\n\r\n\t\t\t\tnormals[ j + 0 ] = normals[ base + j + 0 ] = n.x;\r\n\t\t\t\tnormals[ j + 1 ] = normals[ base + j + 1 ] = n.y;\r\n\t\t\t\tnormals[ j + 2 ] = normals[ base + j + 2 ] = n.z;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tLatheBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\r\n\tLatheBufferGeometry.prototype.constructor = LatheBufferGeometry;\r\n\r\n\t/**\r\n\t * @author jonobr1 / http://jonobr1.com\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t */\r\n\r\n\t// ShapeGeometry\r\n\r\n\tfunction ShapeGeometry( shapes, curveSegments ) {\r\n\r\n\t\tGeometry.call( this );\r\n\r\n\t\tthis.type = 'ShapeGeometry';\r\n\r\n\t\tif ( typeof curveSegments === 'object' ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.ShapeGeometry: Options parameter has been removed.' );\r\n\r\n\t\t\tcurveSegments = curveSegments.curveSegments;\r\n\r\n\t\t}\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tshapes: shapes,\r\n\t\t\tcurveSegments: curveSegments\r\n\t\t};\r\n\r\n\t\tthis.fromBufferGeometry( new ShapeBufferGeometry( shapes, curveSegments ) );\r\n\t\tthis.mergeVertices();\r\n\r\n\t}\r\n\r\n\tShapeGeometry.prototype = Object.create( Geometry.prototype );\r\n\tShapeGeometry.prototype.constructor = ShapeGeometry;\r\n\r\n\tShapeGeometry.prototype.toJSON = function () {\r\n\r\n\t\tvar data = Geometry.prototype.toJSON.call( this );\r\n\r\n\t\tvar shapes = this.parameters.shapes;\r\n\r\n\t\treturn toJSON$1( shapes, data );\r\n\r\n\t};\r\n\r\n\t// ShapeBufferGeometry\r\n\r\n\tfunction ShapeBufferGeometry( shapes, curveSegments ) {\r\n\r\n\t\tBufferGeometry.call( this );\r\n\r\n\t\tthis.type = 'ShapeBufferGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tshapes: shapes,\r\n\t\t\tcurveSegments: curveSegments\r\n\t\t};\r\n\r\n\t\tcurveSegments = curveSegments || 12;\r\n\r\n\t\t// buffers\r\n\r\n\t\tvar indices = [];\r\n\t\tvar vertices = [];\r\n\t\tvar normals = [];\r\n\t\tvar uvs = [];\r\n\r\n\t\t// helper variables\r\n\r\n\t\tvar groupStart = 0;\r\n\t\tvar groupCount = 0;\r\n\r\n\t\t// allow single and array values for \"shapes\" parameter\r\n\r\n\t\tif ( Array.isArray( shapes ) === false ) {\r\n\r\n\t\t\taddShape( shapes );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tfor ( var i = 0; i < shapes.length; i ++ ) {\r\n\r\n\t\t\t\taddShape( shapes[ i ] );\r\n\r\n\t\t\t\tthis.addGroup( groupStart, groupCount, i ); // enables MultiMaterial support\r\n\r\n\t\t\t\tgroupStart += groupCount;\r\n\t\t\t\tgroupCount = 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// build geometry\r\n\r\n\t\tthis.setIndex( indices );\r\n\t\tthis.addAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\t\tthis.addAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\r\n\t\tthis.addAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\r\n\r\n\r\n\t\t// helper functions\r\n\r\n\t\tfunction addShape( shape ) {\r\n\r\n\t\t\tvar i, l, shapeHole;\r\n\r\n\t\t\tvar indexOffset = vertices.length / 3;\r\n\t\t\tvar points = shape.extractPoints( curveSegments );\r\n\r\n\t\t\tvar shapeVertices = points.shape;\r\n\t\t\tvar shapeHoles = points.holes;\r\n\r\n\t\t\t// check direction of vertices\r\n\r\n\t\t\tif ( ShapeUtils.isClockWise( shapeVertices ) === false ) {\r\n\r\n\t\t\t\tshapeVertices = shapeVertices.reverse();\r\n\r\n\t\t\t\t// also check if holes are in the opposite direction\r\n\r\n\t\t\t\tfor ( i = 0, l = shapeHoles.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tshapeHole = shapeHoles[ i ];\r\n\r\n\t\t\t\t\tif ( ShapeUtils.isClockWise( shapeHole ) === true ) {\r\n\r\n\t\t\t\t\t\tshapeHoles[ i ] = shapeHole.reverse();\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar faces = ShapeUtils.triangulateShape( shapeVertices, shapeHoles );\r\n\r\n\t\t\t// join vertices of inner and outer paths to a single array\r\n\r\n\t\t\tfor ( i = 0, l = shapeHoles.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tshapeHole = shapeHoles[ i ];\r\n\t\t\t\tshapeVertices = shapeVertices.concat( shapeHole );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// vertices, normals, uvs\r\n\r\n\t\t\tfor ( i = 0, l = shapeVertices.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar vertex = shapeVertices[ i ];\r\n\r\n\t\t\t\tvertices.push( vertex.x, vertex.y, 0 );\r\n\t\t\t\tnormals.push( 0, 0, 1 );\r\n\t\t\t\tuvs.push( vertex.x, vertex.y ); // world uvs\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// incides\r\n\r\n\t\t\tfor ( i = 0, l = faces.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar face = faces[ i ];\r\n\r\n\t\t\t\tvar a = face[ 0 ] + indexOffset;\r\n\t\t\t\tvar b = face[ 1 ] + indexOffset;\r\n\t\t\t\tvar c = face[ 2 ] + indexOffset;\r\n\r\n\t\t\t\tindices.push( a, b, c );\r\n\t\t\t\tgroupCount += 3;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tShapeBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\r\n\tShapeBufferGeometry.prototype.constructor = ShapeBufferGeometry;\r\n\r\n\tShapeBufferGeometry.prototype.toJSON = function () {\r\n\r\n\t\tvar data = BufferGeometry.prototype.toJSON.call( this );\r\n\r\n\t\tvar shapes = this.parameters.shapes;\r\n\r\n\t\treturn toJSON$1( shapes, data );\r\n\r\n\t};\r\n\r\n\t//\r\n\r\n\tfunction toJSON$1( shapes, data ) {\r\n\r\n\t\tdata.shapes = [];\r\n\r\n\t\tif ( Array.isArray( shapes ) ) {\r\n\r\n\t\t\tfor ( var i = 0, l = shapes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar shape = shapes[ i ];\r\n\r\n\t\t\t\tdata.shapes.push( shape.uuid );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tdata.shapes.push( shapes.uuid );\r\n\r\n\t\t}\r\n\r\n\t\treturn data;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t */\r\n\r\n\tfunction EdgesGeometry( geometry, thresholdAngle ) {\r\n\r\n\t\tBufferGeometry.call( this );\r\n\r\n\t\tthis.type = 'EdgesGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tthresholdAngle: thresholdAngle\r\n\t\t};\r\n\r\n\t\tthresholdAngle = ( thresholdAngle !== undefined ) ? thresholdAngle : 1;\r\n\r\n\t\t// buffer\r\n\r\n\t\tvar vertices = [];\r\n\r\n\t\t// helper variables\r\n\r\n\t\tvar thresholdDot = Math.cos( _Math.DEG2RAD * thresholdAngle );\r\n\t\tvar edge = [ 0, 0 ], edges = {}, edge1, edge2;\r\n\t\tvar key, keys = [ 'a', 'b', 'c' ];\r\n\r\n\t\t// prepare source geometry\r\n\r\n\t\tvar geometry2;\r\n\r\n\t\tif ( geometry.isBufferGeometry ) {\r\n\r\n\t\t\tgeometry2 = new Geometry();\r\n\t\t\tgeometry2.fromBufferGeometry( geometry );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tgeometry2 = geometry.clone();\r\n\r\n\t\t}\r\n\r\n\t\tgeometry2.mergeVertices();\r\n\t\tgeometry2.computeFaceNormals();\r\n\r\n\t\tvar sourceVertices = geometry2.vertices;\r\n\t\tvar faces = geometry2.faces;\r\n\r\n\t\t// now create a data structure where each entry represents an edge with its adjoining faces\r\n\r\n\t\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar face = faces[ i ];\r\n\r\n\t\t\tfor ( var j = 0; j < 3; j ++ ) {\r\n\r\n\t\t\t\tedge1 = face[ keys[ j ] ];\r\n\t\t\t\tedge2 = face[ keys[ ( j + 1 ) % 3 ] ];\r\n\t\t\t\tedge[ 0 ] = Math.min( edge1, edge2 );\r\n\t\t\t\tedge[ 1 ] = Math.max( edge1, edge2 );\r\n\r\n\t\t\t\tkey = edge[ 0 ] + ',' + edge[ 1 ];\r\n\r\n\t\t\t\tif ( edges[ key ] === undefined ) {\r\n\r\n\t\t\t\t\tedges[ key ] = { index1: edge[ 0 ], index2: edge[ 1 ], face1: i, face2: undefined };\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tedges[ key ].face2 = i;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// generate vertices\r\n\r\n\t\tfor ( key in edges ) {\r\n\r\n\t\t\tvar e = edges[ key ];\r\n\r\n\t\t\t// an edge is only rendered if the angle (in degrees) between the face normals of the adjoining faces exceeds this value. default = 1 degree.\r\n\r\n\t\t\tif ( e.face2 === undefined || faces[ e.face1 ].normal.dot( faces[ e.face2 ].normal ) <= thresholdDot ) {\r\n\r\n\t\t\t\tvar vertex = sourceVertices[ e.index1 ];\r\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t\tvertex = sourceVertices[ e.index2 ];\r\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// build geometry\r\n\r\n\t\tthis.addAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\r\n\t}\r\n\r\n\tEdgesGeometry.prototype = Object.create( BufferGeometry.prototype );\r\n\tEdgesGeometry.prototype.constructor = EdgesGeometry;\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t */\r\n\r\n\t// CylinderGeometry\r\n\r\n\tfunction CylinderGeometry( radiusTop, radiusBottom, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength ) {\r\n\r\n\t\tGeometry.call( this );\r\n\r\n\t\tthis.type = 'CylinderGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradiusTop: radiusTop,\r\n\t\t\tradiusBottom: radiusBottom,\r\n\t\t\theight: height,\r\n\t\t\tradialSegments: radialSegments,\r\n\t\t\theightSegments: heightSegments,\r\n\t\t\topenEnded: openEnded,\r\n\t\t\tthetaStart: thetaStart,\r\n\t\t\tthetaLength: thetaLength\r\n\t\t};\r\n\r\n\t\tthis.fromBufferGeometry( new CylinderBufferGeometry( radiusTop, radiusBottom, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength ) );\r\n\t\tthis.mergeVertices();\r\n\r\n\t}\r\n\r\n\tCylinderGeometry.prototype = Object.create( Geometry.prototype );\r\n\tCylinderGeometry.prototype.constructor = CylinderGeometry;\r\n\r\n\t// CylinderBufferGeometry\r\n\r\n\tfunction CylinderBufferGeometry( radiusTop, radiusBottom, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength ) {\r\n\r\n\t\tBufferGeometry.call( this );\r\n\r\n\t\tthis.type = 'CylinderBufferGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradiusTop: radiusTop,\r\n\t\t\tradiusBottom: radiusBottom,\r\n\t\t\theight: height,\r\n\t\t\tradialSegments: radialSegments,\r\n\t\t\theightSegments: heightSegments,\r\n\t\t\topenEnded: openEnded,\r\n\t\t\tthetaStart: thetaStart,\r\n\t\t\tthetaLength: thetaLength\r\n\t\t};\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tradiusTop = radiusTop !== undefined ? radiusTop : 1;\r\n\t\tradiusBottom = radiusBottom !== undefined ? radiusBottom : 1;\r\n\t\theight = height || 1;\r\n\r\n\t\tradialSegments = Math.floor( radialSegments ) || 8;\r\n\t\theightSegments = Math.floor( heightSegments ) || 1;\r\n\r\n\t\topenEnded = openEnded !== undefined ? openEnded : false;\r\n\t\tthetaStart = thetaStart !== undefined ? thetaStart : 0.0;\r\n\t\tthetaLength = thetaLength !== undefined ? thetaLength : Math.PI * 2;\r\n\r\n\t\t// buffers\r\n\r\n\t\tvar indices = [];\r\n\t\tvar vertices = [];\r\n\t\tvar normals = [];\r\n\t\tvar uvs = [];\r\n\r\n\t\t// helper variables\r\n\r\n\t\tvar index = 0;\r\n\t\tvar indexArray = [];\r\n\t\tvar halfHeight = height / 2;\r\n\t\tvar groupStart = 0;\r\n\r\n\t\t// generate geometry\r\n\r\n\t\tgenerateTorso();\r\n\r\n\t\tif ( openEnded === false ) {\r\n\r\n\t\t\tif ( radiusTop > 0 ) generateCap( true );\r\n\t\t\tif ( radiusBottom > 0 ) generateCap( false );\r\n\r\n\t\t}\r\n\r\n\t\t// build geometry\r\n\r\n\t\tthis.setIndex( indices );\r\n\t\tthis.addAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\t\tthis.addAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\r\n\t\tthis.addAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\r\n\r\n\t\tfunction generateTorso() {\r\n\r\n\t\t\tvar x, y;\r\n\t\t\tvar normal = new Vector3();\r\n\t\t\tvar vertex = new Vector3();\r\n\r\n\t\t\tvar groupCount = 0;\r\n\r\n\t\t\t// this will be used to calculate the normal\r\n\t\t\tvar slope = ( radiusBottom - radiusTop ) / height;\r\n\r\n\t\t\t// generate vertices, normals and uvs\r\n\r\n\t\t\tfor ( y = 0; y <= heightSegments; y ++ ) {\r\n\r\n\t\t\t\tvar indexRow = [];\r\n\r\n\t\t\t\tvar v = y / heightSegments;\r\n\r\n\t\t\t\t// calculate the radius of the current row\r\n\r\n\t\t\t\tvar radius = v * ( radiusBottom - radiusTop ) + radiusTop;\r\n\r\n\t\t\t\tfor ( x = 0; x <= radialSegments; x ++ ) {\r\n\r\n\t\t\t\t\tvar u = x / radialSegments;\r\n\r\n\t\t\t\t\tvar theta = u * thetaLength + thetaStart;\r\n\r\n\t\t\t\t\tvar sinTheta = Math.sin( theta );\r\n\t\t\t\t\tvar cosTheta = Math.cos( theta );\r\n\r\n\t\t\t\t\t// vertex\r\n\r\n\t\t\t\t\tvertex.x = radius * sinTheta;\r\n\t\t\t\t\tvertex.y = - v * height + halfHeight;\r\n\t\t\t\t\tvertex.z = radius * cosTheta;\r\n\t\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t\t\t// normal\r\n\r\n\t\t\t\t\tnormal.set( sinTheta, slope, cosTheta ).normalize();\r\n\t\t\t\t\tnormals.push( normal.x, normal.y, normal.z );\r\n\r\n\t\t\t\t\t// uv\r\n\r\n\t\t\t\t\tuvs.push( u, 1 - v );\r\n\r\n\t\t\t\t\t// save index of vertex in respective row\r\n\r\n\t\t\t\t\tindexRow.push( index ++ );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// now save vertices of the row in our index array\r\n\r\n\t\t\t\tindexArray.push( indexRow );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// generate indices\r\n\r\n\t\t\tfor ( x = 0; x < radialSegments; x ++ ) {\r\n\r\n\t\t\t\tfor ( y = 0; y < heightSegments; y ++ ) {\r\n\r\n\t\t\t\t\t// we use the index array to access the correct indices\r\n\r\n\t\t\t\t\tvar a = indexArray[ y ][ x ];\r\n\t\t\t\t\tvar b = indexArray[ y + 1 ][ x ];\r\n\t\t\t\t\tvar c = indexArray[ y + 1 ][ x + 1 ];\r\n\t\t\t\t\tvar d = indexArray[ y ][ x + 1 ];\r\n\r\n\t\t\t\t\t// faces\r\n\r\n\t\t\t\t\tindices.push( a, b, d );\r\n\t\t\t\t\tindices.push( b, c, d );\r\n\r\n\t\t\t\t\t// update group counter\r\n\r\n\t\t\t\t\tgroupCount += 6;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// add a group to the geometry. this will ensure multi material support\r\n\r\n\t\t\tscope.addGroup( groupStart, groupCount, 0 );\r\n\r\n\t\t\t// calculate new start value for groups\r\n\r\n\t\t\tgroupStart += groupCount;\r\n\r\n\t\t}\r\n\r\n\t\tfunction generateCap( top ) {\r\n\r\n\t\t\tvar x, centerIndexStart, centerIndexEnd;\r\n\r\n\t\t\tvar uv = new Vector2();\r\n\t\t\tvar vertex = new Vector3();\r\n\r\n\t\t\tvar groupCount = 0;\r\n\r\n\t\t\tvar radius = ( top === true ) ? radiusTop : radiusBottom;\r\n\t\t\tvar sign = ( top === true ) ? 1 : - 1;\r\n\r\n\t\t\t// save the index of the first center vertex\r\n\t\t\tcenterIndexStart = index;\r\n\r\n\t\t\t// first we generate the center vertex data of the cap.\r\n\t\t\t// because the geometry needs one set of uvs per face,\r\n\t\t\t// we must generate a center vertex per face/segment\r\n\r\n\t\t\tfor ( x = 1; x <= radialSegments; x ++ ) {\r\n\r\n\t\t\t\t// vertex\r\n\r\n\t\t\t\tvertices.push( 0, halfHeight * sign, 0 );\r\n\r\n\t\t\t\t// normal\r\n\r\n\t\t\t\tnormals.push( 0, sign, 0 );\r\n\r\n\t\t\t\t// uv\r\n\r\n\t\t\t\tuvs.push( 0.5, 0.5 );\r\n\r\n\t\t\t\t// increase index\r\n\r\n\t\t\t\tindex ++;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// save the index of the last center vertex\r\n\r\n\t\t\tcenterIndexEnd = index;\r\n\r\n\t\t\t// now we generate the surrounding vertices, normals and uvs\r\n\r\n\t\t\tfor ( x = 0; x <= radialSegments; x ++ ) {\r\n\r\n\t\t\t\tvar u = x / radialSegments;\r\n\t\t\t\tvar theta = u * thetaLength + thetaStart;\r\n\r\n\t\t\t\tvar cosTheta = Math.cos( theta );\r\n\t\t\t\tvar sinTheta = Math.sin( theta );\r\n\r\n\t\t\t\t// vertex\r\n\r\n\t\t\t\tvertex.x = radius * sinTheta;\r\n\t\t\t\tvertex.y = halfHeight * sign;\r\n\t\t\t\tvertex.z = radius * cosTheta;\r\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t\t// normal\r\n\r\n\t\t\t\tnormals.push( 0, sign, 0 );\r\n\r\n\t\t\t\t// uv\r\n\r\n\t\t\t\tuv.x = ( cosTheta * 0.5 ) + 0.5;\r\n\t\t\t\tuv.y = ( sinTheta * 0.5 * sign ) + 0.5;\r\n\t\t\t\tuvs.push( uv.x, uv.y );\r\n\r\n\t\t\t\t// increase index\r\n\r\n\t\t\t\tindex ++;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// generate indices\r\n\r\n\t\t\tfor ( x = 0; x < radialSegments; x ++ ) {\r\n\r\n\t\t\t\tvar c = centerIndexStart + x;\r\n\t\t\t\tvar i = centerIndexEnd + x;\r\n\r\n\t\t\t\tif ( top === true ) {\r\n\r\n\t\t\t\t\t// face top\r\n\r\n\t\t\t\t\tindices.push( i, i + 1, c );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// face bottom\r\n\r\n\t\t\t\t\tindices.push( i + 1, i, c );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgroupCount += 3;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// add a group to the geometry. this will ensure multi material support\r\n\r\n\t\t\tscope.addGroup( groupStart, groupCount, top === true ? 1 : 2 );\r\n\r\n\t\t\t// calculate new start value for groups\r\n\r\n\t\t\tgroupStart += groupCount;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tCylinderBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\r\n\tCylinderBufferGeometry.prototype.constructor = CylinderBufferGeometry;\r\n\r\n\t/**\r\n\t * @author abelnation / http://github.com/abelnation\r\n\t */\r\n\r\n\t// ConeGeometry\r\n\r\n\tfunction ConeGeometry( radius, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength ) {\r\n\r\n\t\tCylinderGeometry.call( this, 0, radius, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength );\r\n\r\n\t\tthis.type = 'ConeGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\theight: height,\r\n\t\t\tradialSegments: radialSegments,\r\n\t\t\theightSegments: heightSegments,\r\n\t\t\topenEnded: openEnded,\r\n\t\t\tthetaStart: thetaStart,\r\n\t\t\tthetaLength: thetaLength\r\n\t\t};\r\n\r\n\t}\r\n\r\n\tConeGeometry.prototype = Object.create( CylinderGeometry.prototype );\r\n\tConeGeometry.prototype.constructor = ConeGeometry;\r\n\r\n\t// ConeBufferGeometry\r\n\r\n\tfunction ConeBufferGeometry( radius, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength ) {\r\n\r\n\t\tCylinderBufferGeometry.call( this, 0, radius, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength );\r\n\r\n\t\tthis.type = 'ConeBufferGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\theight: height,\r\n\t\t\tradialSegments: radialSegments,\r\n\t\t\theightSegments: heightSegments,\r\n\t\t\topenEnded: openEnded,\r\n\t\t\tthetaStart: thetaStart,\r\n\t\t\tthetaLength: thetaLength\r\n\t\t};\r\n\r\n\t}\r\n\r\n\tConeBufferGeometry.prototype = Object.create( CylinderBufferGeometry.prototype );\r\n\tConeBufferGeometry.prototype.constructor = ConeBufferGeometry;\r\n\r\n\t/**\r\n\t * @author benaadams / https://twitter.com/ben_a_adams\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t * @author hughes\r\n\t */\r\n\r\n\t// CircleGeometry\r\n\r\n\tfunction CircleGeometry( radius, segments, thetaStart, thetaLength ) {\r\n\r\n\t\tGeometry.call( this );\r\n\r\n\t\tthis.type = 'CircleGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\tsegments: segments,\r\n\t\t\tthetaStart: thetaStart,\r\n\t\t\tthetaLength: thetaLength\r\n\t\t};\r\n\r\n\t\tthis.fromBufferGeometry( new CircleBufferGeometry( radius, segments, thetaStart, thetaLength ) );\r\n\t\tthis.mergeVertices();\r\n\r\n\t}\r\n\r\n\tCircleGeometry.prototype = Object.create( Geometry.prototype );\r\n\tCircleGeometry.prototype.constructor = CircleGeometry;\r\n\r\n\t// CircleBufferGeometry\r\n\r\n\tfunction CircleBufferGeometry( radius, segments, thetaStart, thetaLength ) {\r\n\r\n\t\tBufferGeometry.call( this );\r\n\r\n\t\tthis.type = 'CircleBufferGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\tsegments: segments,\r\n\t\t\tthetaStart: thetaStart,\r\n\t\t\tthetaLength: thetaLength\r\n\t\t};\r\n\r\n\t\tradius = radius || 1;\r\n\t\tsegments = segments !== undefined ? Math.max( 3, segments ) : 8;\r\n\r\n\t\tthetaStart = thetaStart !== undefined ? thetaStart : 0;\r\n\t\tthetaLength = thetaLength !== undefined ? thetaLength : Math.PI * 2;\r\n\r\n\t\t// buffers\r\n\r\n\t\tvar indices = [];\r\n\t\tvar vertices = [];\r\n\t\tvar normals = [];\r\n\t\tvar uvs = [];\r\n\r\n\t\t// helper variables\r\n\r\n\t\tvar i, s;\r\n\t\tvar vertex = new Vector3();\r\n\t\tvar uv = new Vector2();\r\n\r\n\t\t// center point\r\n\r\n\t\tvertices.push( 0, 0, 0 );\r\n\t\tnormals.push( 0, 0, 1 );\r\n\t\tuvs.push( 0.5, 0.5 );\r\n\r\n\t\tfor ( s = 0, i = 3; s <= segments; s ++, i += 3 ) {\r\n\r\n\t\t\tvar segment = thetaStart + s / segments * thetaLength;\r\n\r\n\t\t\t// vertex\r\n\r\n\t\t\tvertex.x = radius * Math.cos( segment );\r\n\t\t\tvertex.y = radius * Math.sin( segment );\r\n\r\n\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t// normal\r\n\r\n\t\t\tnormals.push( 0, 0, 1 );\r\n\r\n\t\t\t// uvs\r\n\r\n\t\t\tuv.x = ( vertices[ i ] / radius + 1 ) / 2;\r\n\t\t\tuv.y = ( vertices[ i + 1 ] / radius + 1 ) / 2;\r\n\r\n\t\t\tuvs.push( uv.x, uv.y );\r\n\r\n\t\t}\r\n\r\n\t\t// indices\r\n\r\n\t\tfor ( i = 1; i <= segments; i ++ ) {\r\n\r\n\t\t\tindices.push( i, i + 1, 0 );\r\n\r\n\t\t}\r\n\r\n\t\t// build geometry\r\n\r\n\t\tthis.setIndex( indices );\r\n\t\tthis.addAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\t\tthis.addAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\r\n\t\tthis.addAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\r\n\r\n\t}\r\n\r\n\tCircleBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\r\n\tCircleBufferGeometry.prototype.constructor = CircleBufferGeometry;\r\n\r\n\r\n\r\n\tvar Geometries = /*#__PURE__*/Object.freeze({\r\n\t\tWireframeGeometry: WireframeGeometry,\r\n\t\tParametricGeometry: ParametricGeometry,\r\n\t\tParametricBufferGeometry: ParametricBufferGeometry,\r\n\t\tTetrahedronGeometry: TetrahedronGeometry,\r\n\t\tTetrahedronBufferGeometry: TetrahedronBufferGeometry,\r\n\t\tOctahedronGeometry: OctahedronGeometry,\r\n\t\tOctahedronBufferGeometry: OctahedronBufferGeometry,\r\n\t\tIcosahedronGeometry: IcosahedronGeometry,\r\n\t\tIcosahedronBufferGeometry: IcosahedronBufferGeometry,\r\n\t\tDodecahedronGeometry: DodecahedronGeometry,\r\n\t\tDodecahedronBufferGeometry: DodecahedronBufferGeometry,\r\n\t\tPolyhedronGeometry: PolyhedronGeometry,\r\n\t\tPolyhedronBufferGeometry: PolyhedronBufferGeometry,\r\n\t\tTubeGeometry: TubeGeometry,\r\n\t\tTubeBufferGeometry: TubeBufferGeometry,\r\n\t\tTorusKnotGeometry: TorusKnotGeometry,\r\n\t\tTorusKnotBufferGeometry: TorusKnotBufferGeometry,\r\n\t\tTorusGeometry: TorusGeometry,\r\n\t\tTorusBufferGeometry: TorusBufferGeometry,\r\n\t\tTextGeometry: TextGeometry,\r\n\t\tTextBufferGeometry: TextBufferGeometry,\r\n\t\tSphereGeometry: SphereGeometry,\r\n\t\tSphereBufferGeometry: SphereBufferGeometry,\r\n\t\tRingGeometry: RingGeometry,\r\n\t\tRingBufferGeometry: RingBufferGeometry,\r\n\t\tPlaneGeometry: PlaneGeometry,\r\n\t\tPlaneBufferGeometry: PlaneBufferGeometry,\r\n\t\tLatheGeometry: LatheGeometry,\r\n\t\tLatheBufferGeometry: LatheBufferGeometry,\r\n\t\tShapeGeometry: ShapeGeometry,\r\n\t\tShapeBufferGeometry: ShapeBufferGeometry,\r\n\t\tExtrudeGeometry: ExtrudeGeometry,\r\n\t\tExtrudeBufferGeometry: ExtrudeBufferGeometry,\r\n\t\tEdgesGeometry: EdgesGeometry,\r\n\t\tConeGeometry: ConeGeometry,\r\n\t\tConeBufferGeometry: ConeBufferGeometry,\r\n\t\tCylinderGeometry: CylinderGeometry,\r\n\t\tCylinderBufferGeometry: CylinderBufferGeometry,\r\n\t\tCircleGeometry: CircleGeometry,\r\n\t\tCircleBufferGeometry: CircleBufferGeometry,\r\n\t\tBoxGeometry: BoxGeometry,\r\n\t\tBoxBufferGeometry: BoxBufferGeometry\r\n\t});\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t *\r\n\t * parameters = {\r\n\t *  color: <THREE.Color>\r\n\t * }\r\n\t */\r\n\r\n\tfunction ShadowMaterial( parameters ) {\r\n\r\n\t\tMaterial.call( this );\r\n\r\n\t\tthis.type = 'ShadowMaterial';\r\n\r\n\t\tthis.color = new Color( 0x000000 );\r\n\t\tthis.transparent = true;\r\n\r\n\t\tthis.setValues( parameters );\r\n\r\n\t}\r\n\r\n\tShadowMaterial.prototype = Object.create( Material.prototype );\r\n\tShadowMaterial.prototype.constructor = ShadowMaterial;\r\n\r\n\tShadowMaterial.prototype.isShadowMaterial = true;\r\n\r\n\tShadowMaterial.prototype.copy = function ( source ) {\r\n\r\n\t\tMaterial.prototype.copy.call( this, source );\r\n\r\n\t\tthis.color.copy( source.color );\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction RawShaderMaterial( parameters ) {\r\n\r\n\t\tShaderMaterial.call( this, parameters );\r\n\r\n\t\tthis.type = 'RawShaderMaterial';\r\n\r\n\t}\r\n\r\n\tRawShaderMaterial.prototype = Object.create( ShaderMaterial.prototype );\r\n\tRawShaderMaterial.prototype.constructor = RawShaderMaterial;\r\n\r\n\tRawShaderMaterial.prototype.isRawShaderMaterial = true;\r\n\r\n\t/**\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t *\r\n\t * parameters = {\r\n\t *  color: <hex>,\r\n\t *  roughness: <float>,\r\n\t *  metalness: <float>,\r\n\t *  opacity: <float>,\r\n\t *\r\n\t *  map: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  lightMap: new THREE.Texture( <Image> ),\r\n\t *  lightMapIntensity: <float>\r\n\t *\r\n\t *  aoMap: new THREE.Texture( <Image> ),\r\n\t *  aoMapIntensity: <float>\r\n\t *\r\n\t *  emissive: <hex>,\r\n\t *  emissiveIntensity: <float>\r\n\t *  emissiveMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  bumpMap: new THREE.Texture( <Image> ),\r\n\t *  bumpScale: <float>,\r\n\t *\r\n\t *  normalMap: new THREE.Texture( <Image> ),\r\n\t *  normalMapType: THREE.TangentSpaceNormalMap,\r\n\t *  normalScale: <Vector2>,\r\n\t *\r\n\t *  displacementMap: new THREE.Texture( <Image> ),\r\n\t *  displacementScale: <float>,\r\n\t *  displacementBias: <float>,\r\n\t *\r\n\t *  roughnessMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  metalnessMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  alphaMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  envMap: new THREE.CubeTexture( [posx, negx, posy, negy, posz, negz] ),\r\n\t *  envMapIntensity: <float>\r\n\t *\r\n\t *  refractionRatio: <float>,\r\n\t *\r\n\t *  wireframe: <boolean>,\r\n\t *  wireframeLinewidth: <float>,\r\n\t *\r\n\t *  skinning: <bool>,\r\n\t *  morphTargets: <bool>,\r\n\t *  morphNormals: <bool>\r\n\t * }\r\n\t */\r\n\r\n\tfunction MeshStandardMaterial( parameters ) {\r\n\r\n\t\tMaterial.call( this );\r\n\r\n\t\tthis.defines = { 'STANDARD': '' };\r\n\r\n\t\tthis.type = 'MeshStandardMaterial';\r\n\r\n\t\tthis.color = new Color( 0xffffff ); // diffuse\r\n\t\tthis.roughness = 0.5;\r\n\t\tthis.metalness = 0.5;\r\n\r\n\t\tthis.map = null;\r\n\r\n\t\tthis.lightMap = null;\r\n\t\tthis.lightMapIntensity = 1.0;\r\n\r\n\t\tthis.aoMap = null;\r\n\t\tthis.aoMapIntensity = 1.0;\r\n\r\n\t\tthis.emissive = new Color( 0x000000 );\r\n\t\tthis.emissiveIntensity = 1.0;\r\n\t\tthis.emissiveMap = null;\r\n\r\n\t\tthis.bumpMap = null;\r\n\t\tthis.bumpScale = 1;\r\n\r\n\t\tthis.normalMap = null;\r\n\t\tthis.normalMapType = TangentSpaceNormalMap;\r\n\t\tthis.normalScale = new Vector2( 1, 1 );\r\n\r\n\t\tthis.displacementMap = null;\r\n\t\tthis.displacementScale = 1;\r\n\t\tthis.displacementBias = 0;\r\n\r\n\t\tthis.roughnessMap = null;\r\n\r\n\t\tthis.metalnessMap = null;\r\n\r\n\t\tthis.alphaMap = null;\r\n\r\n\t\tthis.envMap = null;\r\n\t\tthis.envMapIntensity = 1.0;\r\n\r\n\t\tthis.refractionRatio = 0.98;\r\n\r\n\t\tthis.wireframe = false;\r\n\t\tthis.wireframeLinewidth = 1;\r\n\t\tthis.wireframeLinecap = 'round';\r\n\t\tthis.wireframeLinejoin = 'round';\r\n\r\n\t\tthis.skinning = false;\r\n\t\tthis.morphTargets = false;\r\n\t\tthis.morphNormals = false;\r\n\r\n\t\tthis.setValues( parameters );\r\n\r\n\t}\r\n\r\n\tMeshStandardMaterial.prototype = Object.create( Material.prototype );\r\n\tMeshStandardMaterial.prototype.constructor = MeshStandardMaterial;\r\n\r\n\tMeshStandardMaterial.prototype.isMeshStandardMaterial = true;\r\n\r\n\tMeshStandardMaterial.prototype.copy = function ( source ) {\r\n\r\n\t\tMaterial.prototype.copy.call( this, source );\r\n\r\n\t\tthis.defines = { 'STANDARD': '' };\r\n\r\n\t\tthis.color.copy( source.color );\r\n\t\tthis.roughness = source.roughness;\r\n\t\tthis.metalness = source.metalness;\r\n\r\n\t\tthis.map = source.map;\r\n\r\n\t\tthis.lightMap = source.lightMap;\r\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\r\n\r\n\t\tthis.aoMap = source.aoMap;\r\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\r\n\r\n\t\tthis.emissive.copy( source.emissive );\r\n\t\tthis.emissiveMap = source.emissiveMap;\r\n\t\tthis.emissiveIntensity = source.emissiveIntensity;\r\n\r\n\t\tthis.bumpMap = source.bumpMap;\r\n\t\tthis.bumpScale = source.bumpScale;\r\n\r\n\t\tthis.normalMap = source.normalMap;\r\n\t\tthis.normalMapType = source.normalMapType;\r\n\t\tthis.normalScale.copy( source.normalScale );\r\n\r\n\t\tthis.displacementMap = source.displacementMap;\r\n\t\tthis.displacementScale = source.displacementScale;\r\n\t\tthis.displacementBias = source.displacementBias;\r\n\r\n\t\tthis.roughnessMap = source.roughnessMap;\r\n\r\n\t\tthis.metalnessMap = source.metalnessMap;\r\n\r\n\t\tthis.alphaMap = source.alphaMap;\r\n\r\n\t\tthis.envMap = source.envMap;\r\n\t\tthis.envMapIntensity = source.envMapIntensity;\r\n\r\n\t\tthis.refractionRatio = source.refractionRatio;\r\n\r\n\t\tthis.wireframe = source.wireframe;\r\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\r\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\r\n\r\n\t\tthis.skinning = source.skinning;\r\n\t\tthis.morphTargets = source.morphTargets;\r\n\t\tthis.morphNormals = source.morphNormals;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t *\r\n\t * parameters = {\r\n\t *  reflectivity: <float>\r\n\t * }\r\n\t */\r\n\r\n\tfunction MeshPhysicalMaterial( parameters ) {\r\n\r\n\t\tMeshStandardMaterial.call( this );\r\n\r\n\t\tthis.defines = { 'PHYSICAL': '' };\r\n\r\n\t\tthis.type = 'MeshPhysicalMaterial';\r\n\r\n\t\tthis.reflectivity = 0.5; // maps to F0 = 0.04\r\n\r\n\t\tthis.clearCoat = 0.0;\r\n\t\tthis.clearCoatRoughness = 0.0;\r\n\r\n\t\tthis.setValues( parameters );\r\n\r\n\t}\r\n\r\n\tMeshPhysicalMaterial.prototype = Object.create( MeshStandardMaterial.prototype );\r\n\tMeshPhysicalMaterial.prototype.constructor = MeshPhysicalMaterial;\r\n\r\n\tMeshPhysicalMaterial.prototype.isMeshPhysicalMaterial = true;\r\n\r\n\tMeshPhysicalMaterial.prototype.copy = function ( source ) {\r\n\r\n\t\tMeshStandardMaterial.prototype.copy.call( this, source );\r\n\r\n\t\tthis.defines = { 'PHYSICAL': '' };\r\n\r\n\t\tthis.reflectivity = source.reflectivity;\r\n\r\n\t\tthis.clearCoat = source.clearCoat;\r\n\t\tthis.clearCoatRoughness = source.clearCoatRoughness;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t *\r\n\t * parameters = {\r\n\t *  color: <hex>,\r\n\t *  specular: <hex>,\r\n\t *  shininess: <float>,\r\n\t *  opacity: <float>,\r\n\t *\r\n\t *  map: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  lightMap: new THREE.Texture( <Image> ),\r\n\t *  lightMapIntensity: <float>\r\n\t *\r\n\t *  aoMap: new THREE.Texture( <Image> ),\r\n\t *  aoMapIntensity: <float>\r\n\t *\r\n\t *  emissive: <hex>,\r\n\t *  emissiveIntensity: <float>\r\n\t *  emissiveMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  bumpMap: new THREE.Texture( <Image> ),\r\n\t *  bumpScale: <float>,\r\n\t *\r\n\t *  normalMap: new THREE.Texture( <Image> ),\r\n\t *  normalMapType: THREE.TangentSpaceNormalMap,\r\n\t *  normalScale: <Vector2>,\r\n\t *\r\n\t *  displacementMap: new THREE.Texture( <Image> ),\r\n\t *  displacementScale: <float>,\r\n\t *  displacementBias: <float>,\r\n\t *\r\n\t *  specularMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  alphaMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  envMap: new THREE.CubeTexture( [posx, negx, posy, negy, posz, negz] ),\r\n\t *  combine: THREE.Multiply,\r\n\t *  reflectivity: <float>,\r\n\t *  refractionRatio: <float>,\r\n\t *\r\n\t *  wireframe: <boolean>,\r\n\t *  wireframeLinewidth: <float>,\r\n\t *\r\n\t *  skinning: <bool>,\r\n\t *  morphTargets: <bool>,\r\n\t *  morphNormals: <bool>\r\n\t * }\r\n\t */\r\n\r\n\tfunction MeshPhongMaterial( parameters ) {\r\n\r\n\t\tMaterial.call( this );\r\n\r\n\t\tthis.type = 'MeshPhongMaterial';\r\n\r\n\t\tthis.color = new Color( 0xffffff ); // diffuse\r\n\t\tthis.specular = new Color( 0x111111 );\r\n\t\tthis.shininess = 30;\r\n\r\n\t\tthis.map = null;\r\n\r\n\t\tthis.lightMap = null;\r\n\t\tthis.lightMapIntensity = 1.0;\r\n\r\n\t\tthis.aoMap = null;\r\n\t\tthis.aoMapIntensity = 1.0;\r\n\r\n\t\tthis.emissive = new Color( 0x000000 );\r\n\t\tthis.emissiveIntensity = 1.0;\r\n\t\tthis.emissiveMap = null;\r\n\r\n\t\tthis.bumpMap = null;\r\n\t\tthis.bumpScale = 1;\r\n\r\n\t\tthis.normalMap = null;\r\n\t\tthis.normalMapType = TangentSpaceNormalMap;\r\n\t\tthis.normalScale = new Vector2( 1, 1 );\r\n\r\n\t\tthis.displacementMap = null;\r\n\t\tthis.displacementScale = 1;\r\n\t\tthis.displacementBias = 0;\r\n\r\n\t\tthis.specularMap = null;\r\n\r\n\t\tthis.alphaMap = null;\r\n\r\n\t\tthis.envMap = null;\r\n\t\tthis.combine = MultiplyOperation;\r\n\t\tthis.reflectivity = 1;\r\n\t\tthis.refractionRatio = 0.98;\r\n\r\n\t\tthis.wireframe = false;\r\n\t\tthis.wireframeLinewidth = 1;\r\n\t\tthis.wireframeLinecap = 'round';\r\n\t\tthis.wireframeLinejoin = 'round';\r\n\r\n\t\tthis.skinning = false;\r\n\t\tthis.morphTargets = false;\r\n\t\tthis.morphNormals = false;\r\n\r\n\t\tthis.setValues( parameters );\r\n\r\n\t}\r\n\r\n\tMeshPhongMaterial.prototype = Object.create( Material.prototype );\r\n\tMeshPhongMaterial.prototype.constructor = MeshPhongMaterial;\r\n\r\n\tMeshPhongMaterial.prototype.isMeshPhongMaterial = true;\r\n\r\n\tMeshPhongMaterial.prototype.copy = function ( source ) {\r\n\r\n\t\tMaterial.prototype.copy.call( this, source );\r\n\r\n\t\tthis.color.copy( source.color );\r\n\t\tthis.specular.copy( source.specular );\r\n\t\tthis.shininess = source.shininess;\r\n\r\n\t\tthis.map = source.map;\r\n\r\n\t\tthis.lightMap = source.lightMap;\r\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\r\n\r\n\t\tthis.aoMap = source.aoMap;\r\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\r\n\r\n\t\tthis.emissive.copy( source.emissive );\r\n\t\tthis.emissiveMap = source.emissiveMap;\r\n\t\tthis.emissiveIntensity = source.emissiveIntensity;\r\n\r\n\t\tthis.bumpMap = source.bumpMap;\r\n\t\tthis.bumpScale = source.bumpScale;\r\n\r\n\t\tthis.normalMap = source.normalMap;\r\n\t\tthis.normalMapType = source.normalMapType;\r\n\t\tthis.normalScale.copy( source.normalScale );\r\n\r\n\t\tthis.displacementMap = source.displacementMap;\r\n\t\tthis.displacementScale = source.displacementScale;\r\n\t\tthis.displacementBias = source.displacementBias;\r\n\r\n\t\tthis.specularMap = source.specularMap;\r\n\r\n\t\tthis.alphaMap = source.alphaMap;\r\n\r\n\t\tthis.envMap = source.envMap;\r\n\t\tthis.combine = source.combine;\r\n\t\tthis.reflectivity = source.reflectivity;\r\n\t\tthis.refractionRatio = source.refractionRatio;\r\n\r\n\t\tthis.wireframe = source.wireframe;\r\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\r\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\r\n\r\n\t\tthis.skinning = source.skinning;\r\n\t\tthis.morphTargets = source.morphTargets;\r\n\t\tthis.morphNormals = source.morphNormals;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author takahirox / http://github.com/takahirox\r\n\t *\r\n\t * parameters = {\r\n\t *  gradientMap: new THREE.Texture( <Image> )\r\n\t * }\r\n\t */\r\n\r\n\tfunction MeshToonMaterial( parameters ) {\r\n\r\n\t\tMeshPhongMaterial.call( this );\r\n\r\n\t\tthis.defines = { 'TOON': '' };\r\n\r\n\t\tthis.type = 'MeshToonMaterial';\r\n\r\n\t\tthis.gradientMap = null;\r\n\r\n\t\tthis.setValues( parameters );\r\n\r\n\t}\r\n\r\n\tMeshToonMaterial.prototype = Object.create( MeshPhongMaterial.prototype );\r\n\tMeshToonMaterial.prototype.constructor = MeshToonMaterial;\r\n\r\n\tMeshToonMaterial.prototype.isMeshToonMaterial = true;\r\n\r\n\tMeshToonMaterial.prototype.copy = function ( source ) {\r\n\r\n\t\tMeshPhongMaterial.prototype.copy.call( this, source );\r\n\r\n\t\tthis.gradientMap = source.gradientMap;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t *\r\n\t * parameters = {\r\n\t *  opacity: <float>,\r\n\t *\r\n\t *  bumpMap: new THREE.Texture( <Image> ),\r\n\t *  bumpScale: <float>,\r\n\t *\r\n\t *  normalMap: new THREE.Texture( <Image> ),\r\n\t *  normalMapType: THREE.TangentSpaceNormalMap,\r\n\t *  normalScale: <Vector2>,\r\n\t *\r\n\t *  displacementMap: new THREE.Texture( <Image> ),\r\n\t *  displacementScale: <float>,\r\n\t *  displacementBias: <float>,\r\n\t *\r\n\t *  wireframe: <boolean>,\r\n\t *  wireframeLinewidth: <float>\r\n\t *\r\n\t *  skinning: <bool>,\r\n\t *  morphTargets: <bool>,\r\n\t *  morphNormals: <bool>\r\n\t * }\r\n\t */\r\n\r\n\tfunction MeshNormalMaterial( parameters ) {\r\n\r\n\t\tMaterial.call( this );\r\n\r\n\t\tthis.type = 'MeshNormalMaterial';\r\n\r\n\t\tthis.bumpMap = null;\r\n\t\tthis.bumpScale = 1;\r\n\r\n\t\tthis.normalMap = null;\r\n\t\tthis.normalMapType = TangentSpaceNormalMap;\r\n\t\tthis.normalScale = new Vector2( 1, 1 );\r\n\r\n\t\tthis.displacementMap = null;\r\n\t\tthis.displacementScale = 1;\r\n\t\tthis.displacementBias = 0;\r\n\r\n\t\tthis.wireframe = false;\r\n\t\tthis.wireframeLinewidth = 1;\r\n\r\n\t\tthis.fog = false;\r\n\t\tthis.lights = false;\r\n\r\n\t\tthis.skinning = false;\r\n\t\tthis.morphTargets = false;\r\n\t\tthis.morphNormals = false;\r\n\r\n\t\tthis.setValues( parameters );\r\n\r\n\t}\r\n\r\n\tMeshNormalMaterial.prototype = Object.create( Material.prototype );\r\n\tMeshNormalMaterial.prototype.constructor = MeshNormalMaterial;\r\n\r\n\tMeshNormalMaterial.prototype.isMeshNormalMaterial = true;\r\n\r\n\tMeshNormalMaterial.prototype.copy = function ( source ) {\r\n\r\n\t\tMaterial.prototype.copy.call( this, source );\r\n\r\n\t\tthis.bumpMap = source.bumpMap;\r\n\t\tthis.bumpScale = source.bumpScale;\r\n\r\n\t\tthis.normalMap = source.normalMap;\r\n\t\tthis.normalMapType = source.normalMapType;\r\n\t\tthis.normalScale.copy( source.normalScale );\r\n\r\n\t\tthis.displacementMap = source.displacementMap;\r\n\t\tthis.displacementScale = source.displacementScale;\r\n\t\tthis.displacementBias = source.displacementBias;\r\n\r\n\t\tthis.wireframe = source.wireframe;\r\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\r\n\t\tthis.skinning = source.skinning;\r\n\t\tthis.morphTargets = source.morphTargets;\r\n\t\tthis.morphNormals = source.morphNormals;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t *\r\n\t * parameters = {\r\n\t *  color: <hex>,\r\n\t *  opacity: <float>,\r\n\t *\r\n\t *  map: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  lightMap: new THREE.Texture( <Image> ),\r\n\t *  lightMapIntensity: <float>\r\n\t *\r\n\t *  aoMap: new THREE.Texture( <Image> ),\r\n\t *  aoMapIntensity: <float>\r\n\t *\r\n\t *  emissive: <hex>,\r\n\t *  emissiveIntensity: <float>\r\n\t *  emissiveMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  specularMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  alphaMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  envMap: new THREE.CubeTexture( [posx, negx, posy, negy, posz, negz] ),\r\n\t *  combine: THREE.Multiply,\r\n\t *  reflectivity: <float>,\r\n\t *  refractionRatio: <float>,\r\n\t *\r\n\t *  wireframe: <boolean>,\r\n\t *  wireframeLinewidth: <float>,\r\n\t *\r\n\t *  skinning: <bool>,\r\n\t *  morphTargets: <bool>,\r\n\t *  morphNormals: <bool>\r\n\t * }\r\n\t */\r\n\r\n\tfunction MeshLambertMaterial( parameters ) {\r\n\r\n\t\tMaterial.call( this );\r\n\r\n\t\tthis.type = 'MeshLambertMaterial';\r\n\r\n\t\tthis.color = new Color( 0xffffff ); // diffuse\r\n\r\n\t\tthis.map = null;\r\n\r\n\t\tthis.lightMap = null;\r\n\t\tthis.lightMapIntensity = 1.0;\r\n\r\n\t\tthis.aoMap = null;\r\n\t\tthis.aoMapIntensity = 1.0;\r\n\r\n\t\tthis.emissive = new Color( 0x000000 );\r\n\t\tthis.emissiveIntensity = 1.0;\r\n\t\tthis.emissiveMap = null;\r\n\r\n\t\tthis.specularMap = null;\r\n\r\n\t\tthis.alphaMap = null;\r\n\r\n\t\tthis.envMap = null;\r\n\t\tthis.combine = MultiplyOperation;\r\n\t\tthis.reflectivity = 1;\r\n\t\tthis.refractionRatio = 0.98;\r\n\r\n\t\tthis.wireframe = false;\r\n\t\tthis.wireframeLinewidth = 1;\r\n\t\tthis.wireframeLinecap = 'round';\r\n\t\tthis.wireframeLinejoin = 'round';\r\n\r\n\t\tthis.skinning = false;\r\n\t\tthis.morphTargets = false;\r\n\t\tthis.morphNormals = false;\r\n\r\n\t\tthis.setValues( parameters );\r\n\r\n\t}\r\n\r\n\tMeshLambertMaterial.prototype = Object.create( Material.prototype );\r\n\tMeshLambertMaterial.prototype.constructor = MeshLambertMaterial;\r\n\r\n\tMeshLambertMaterial.prototype.isMeshLambertMaterial = true;\r\n\r\n\tMeshLambertMaterial.prototype.copy = function ( source ) {\r\n\r\n\t\tMaterial.prototype.copy.call( this, source );\r\n\r\n\t\tthis.color.copy( source.color );\r\n\r\n\t\tthis.map = source.map;\r\n\r\n\t\tthis.lightMap = source.lightMap;\r\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\r\n\r\n\t\tthis.aoMap = source.aoMap;\r\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\r\n\r\n\t\tthis.emissive.copy( source.emissive );\r\n\t\tthis.emissiveMap = source.emissiveMap;\r\n\t\tthis.emissiveIntensity = source.emissiveIntensity;\r\n\r\n\t\tthis.specularMap = source.specularMap;\r\n\r\n\t\tthis.alphaMap = source.alphaMap;\r\n\r\n\t\tthis.envMap = source.envMap;\r\n\t\tthis.combine = source.combine;\r\n\t\tthis.reflectivity = source.reflectivity;\r\n\t\tthis.refractionRatio = source.refractionRatio;\r\n\r\n\t\tthis.wireframe = source.wireframe;\r\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\r\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\r\n\r\n\t\tthis.skinning = source.skinning;\r\n\t\tthis.morphTargets = source.morphTargets;\r\n\t\tthis.morphNormals = source.morphNormals;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t *\r\n\t * parameters = {\r\n\t *  color: <hex>,\r\n\t *  opacity: <float>,\r\n\t *\r\n\t *  linewidth: <float>,\r\n\t *\r\n\t *  scale: <float>,\r\n\t *  dashSize: <float>,\r\n\t *  gapSize: <float>\r\n\t * }\r\n\t */\r\n\r\n\tfunction LineDashedMaterial( parameters ) {\r\n\r\n\t\tLineBasicMaterial.call( this );\r\n\r\n\t\tthis.type = 'LineDashedMaterial';\r\n\r\n\t\tthis.scale = 1;\r\n\t\tthis.dashSize = 3;\r\n\t\tthis.gapSize = 1;\r\n\r\n\t\tthis.setValues( parameters );\r\n\r\n\t}\r\n\r\n\tLineDashedMaterial.prototype = Object.create( LineBasicMaterial.prototype );\r\n\tLineDashedMaterial.prototype.constructor = LineDashedMaterial;\r\n\r\n\tLineDashedMaterial.prototype.isLineDashedMaterial = true;\r\n\r\n\tLineDashedMaterial.prototype.copy = function ( source ) {\r\n\r\n\t\tLineBasicMaterial.prototype.copy.call( this, source );\r\n\r\n\t\tthis.scale = source.scale;\r\n\t\tthis.dashSize = source.dashSize;\r\n\t\tthis.gapSize = source.gapSize;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\r\n\r\n\tvar Materials = /*#__PURE__*/Object.freeze({\r\n\t\tShadowMaterial: ShadowMaterial,\r\n\t\tSpriteMaterial: SpriteMaterial,\r\n\t\tRawShaderMaterial: RawShaderMaterial,\r\n\t\tShaderMaterial: ShaderMaterial,\r\n\t\tPointsMaterial: PointsMaterial,\r\n\t\tMeshPhysicalMaterial: MeshPhysicalMaterial,\r\n\t\tMeshStandardMaterial: MeshStandardMaterial,\r\n\t\tMeshPhongMaterial: MeshPhongMaterial,\r\n\t\tMeshToonMaterial: MeshToonMaterial,\r\n\t\tMeshNormalMaterial: MeshNormalMaterial,\r\n\t\tMeshLambertMaterial: MeshLambertMaterial,\r\n\t\tMeshDepthMaterial: MeshDepthMaterial,\r\n\t\tMeshDistanceMaterial: MeshDistanceMaterial,\r\n\t\tMeshBasicMaterial: MeshBasicMaterial,\r\n\t\tLineDashedMaterial: LineDashedMaterial,\r\n\t\tLineBasicMaterial: LineBasicMaterial,\r\n\t\tMaterial: Material\r\n\t});\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tvar Cache = {\r\n\r\n\t\tenabled: false,\r\n\r\n\t\tfiles: {},\r\n\r\n\t\tadd: function ( key, file ) {\r\n\r\n\t\t\tif ( this.enabled === false ) return;\r\n\r\n\t\t\t// console.log( 'THREE.Cache', 'Adding key:', key );\r\n\r\n\t\t\tthis.files[ key ] = file;\r\n\r\n\t\t},\r\n\r\n\t\tget: function ( key ) {\r\n\r\n\t\t\tif ( this.enabled === false ) return;\r\n\r\n\t\t\t// console.log( 'THREE.Cache', 'Checking key:', key );\r\n\r\n\t\t\treturn this.files[ key ];\r\n\r\n\t\t},\r\n\r\n\t\tremove: function ( key ) {\r\n\r\n\t\t\tdelete this.files[ key ];\r\n\r\n\t\t},\r\n\r\n\t\tclear: function () {\r\n\r\n\t\t\tthis.files = {};\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction LoadingManager( onLoad, onProgress, onError ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar isLoading = false;\r\n\t\tvar itemsLoaded = 0;\r\n\t\tvar itemsTotal = 0;\r\n\t\tvar urlModifier = undefined;\r\n\r\n\t\t// Refer to #5689 for the reason why we don't set .onStart\r\n\t\t// in the constructor\r\n\r\n\t\tthis.onStart = undefined;\r\n\t\tthis.onLoad = onLoad;\r\n\t\tthis.onProgress = onProgress;\r\n\t\tthis.onError = onError;\r\n\r\n\t\tthis.itemStart = function ( url ) {\r\n\r\n\t\t\titemsTotal ++;\r\n\r\n\t\t\tif ( isLoading === false ) {\r\n\r\n\t\t\t\tif ( scope.onStart !== undefined ) {\r\n\r\n\t\t\t\t\tscope.onStart( url, itemsLoaded, itemsTotal );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tisLoading = true;\r\n\r\n\t\t};\r\n\r\n\t\tthis.itemEnd = function ( url ) {\r\n\r\n\t\t\titemsLoaded ++;\r\n\r\n\t\t\tif ( scope.onProgress !== undefined ) {\r\n\r\n\t\t\t\tscope.onProgress( url, itemsLoaded, itemsTotal );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( itemsLoaded === itemsTotal ) {\r\n\r\n\t\t\t\tisLoading = false;\r\n\r\n\t\t\t\tif ( scope.onLoad !== undefined ) {\r\n\r\n\t\t\t\t\tscope.onLoad();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t\tthis.itemError = function ( url ) {\r\n\r\n\t\t\tif ( scope.onError !== undefined ) {\r\n\r\n\t\t\t\tscope.onError( url );\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t\tthis.resolveURL = function ( url ) {\r\n\r\n\t\t\tif ( urlModifier ) {\r\n\r\n\t\t\t\treturn urlModifier( url );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn url;\r\n\r\n\t\t};\r\n\r\n\t\tthis.setURLModifier = function ( transform ) {\r\n\r\n\t\t\turlModifier = transform;\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n\tvar DefaultLoadingManager = new LoadingManager();\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tvar loading = {};\r\n\r\n\tfunction FileLoader( manager ) {\r\n\r\n\t\tthis.manager = ( manager !== undefined ) ? manager : DefaultLoadingManager;\r\n\r\n\t}\r\n\r\n\tObject.assign( FileLoader.prototype, {\r\n\r\n\t\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\t\tif ( url === undefined ) url = '';\r\n\r\n\t\t\tif ( this.path !== undefined ) url = this.path + url;\r\n\r\n\t\t\turl = this.manager.resolveURL( url );\r\n\r\n\t\t\tvar scope = this;\r\n\r\n\t\t\tvar cached = Cache.get( url );\r\n\r\n\t\t\tif ( cached !== undefined ) {\r\n\r\n\t\t\t\tscope.manager.itemStart( url );\r\n\r\n\t\t\t\tsetTimeout( function () {\r\n\r\n\t\t\t\t\tif ( onLoad ) onLoad( cached );\r\n\r\n\t\t\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t\t\t}, 0 );\r\n\r\n\t\t\t\treturn cached;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Check if request is duplicate\r\n\r\n\t\t\tif ( loading[ url ] !== undefined ) {\r\n\r\n\t\t\t\tloading[ url ].push( {\r\n\r\n\t\t\t\t\tonLoad: onLoad,\r\n\t\t\t\t\tonProgress: onProgress,\r\n\t\t\t\t\tonError: onError\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Check for data: URI\r\n\t\t\tvar dataUriRegex = /^data:(.*?)(;base64)?,(.*)$/;\r\n\t\t\tvar dataUriRegexResult = url.match( dataUriRegex );\r\n\r\n\t\t\t// Safari can not handle Data URIs through XMLHttpRequest so process manually\r\n\t\t\tif ( dataUriRegexResult ) {\r\n\r\n\t\t\t\tvar mimeType = dataUriRegexResult[ 1 ];\r\n\t\t\t\tvar isBase64 = !! dataUriRegexResult[ 2 ];\r\n\t\t\t\tvar data = dataUriRegexResult[ 3 ];\r\n\r\n\t\t\t\tdata = window.decodeURIComponent( data );\r\n\r\n\t\t\t\tif ( isBase64 ) data = window.atob( data );\r\n\r\n\t\t\t\ttry {\r\n\r\n\t\t\t\t\tvar response;\r\n\t\t\t\t\tvar responseType = ( this.responseType || '' ).toLowerCase();\r\n\r\n\t\t\t\t\tswitch ( responseType ) {\r\n\r\n\t\t\t\t\t\tcase 'arraybuffer':\r\n\t\t\t\t\t\tcase 'blob':\r\n\r\n\t\t\t\t\t\t\tvar view = new Uint8Array( data.length );\r\n\r\n\t\t\t\t\t\t\tfor ( var i = 0; i < data.length; i ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tview[ i ] = data.charCodeAt( i );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif ( responseType === 'blob' ) {\r\n\r\n\t\t\t\t\t\t\t\tresponse = new Blob( [ view.buffer ], { type: mimeType } );\r\n\r\n\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\tresponse = view.buffer;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'document':\r\n\r\n\t\t\t\t\t\t\tvar parser = new DOMParser();\r\n\t\t\t\t\t\t\tresponse = parser.parseFromString( data, mimeType );\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'json':\r\n\r\n\t\t\t\t\t\t\tresponse = JSON.parse( data );\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tdefault: // 'text' or other\r\n\r\n\t\t\t\t\t\t\tresponse = data;\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Wait for next browser tick like standard XMLHttpRequest event dispatching does\r\n\t\t\t\t\twindow.setTimeout( function () {\r\n\r\n\t\t\t\t\t\tif ( onLoad ) onLoad( response );\r\n\r\n\t\t\t\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t\t\t\t}, 0 );\r\n\r\n\t\t\t\t} catch ( error ) {\r\n\r\n\t\t\t\t\t// Wait for next browser tick like standard XMLHttpRequest event dispatching does\r\n\t\t\t\t\twindow.setTimeout( function () {\r\n\r\n\t\t\t\t\t\tif ( onError ) onError( error );\r\n\r\n\t\t\t\t\t\tscope.manager.itemEnd( url );\r\n\t\t\t\t\t\tscope.manager.itemError( url );\r\n\r\n\t\t\t\t\t}, 0 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// Initialise array for duplicate requests\r\n\r\n\t\t\t\tloading[ url ] = [];\r\n\r\n\t\t\t\tloading[ url ].push( {\r\n\r\n\t\t\t\t\tonLoad: onLoad,\r\n\t\t\t\t\tonProgress: onProgress,\r\n\t\t\t\t\tonError: onError\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t\tvar request = new XMLHttpRequest();\r\n\r\n\t\t\t\trequest.open( 'GET', url, true );\r\n\r\n\t\t\t\trequest.addEventListener( 'load', function ( event ) {\r\n\r\n\t\t\t\t\tvar response = this.response;\r\n\r\n\t\t\t\t\tCache.add( url, response );\r\n\r\n\t\t\t\t\tvar callbacks = loading[ url ];\r\n\r\n\t\t\t\t\tdelete loading[ url ];\r\n\r\n\t\t\t\t\tif ( this.status === 200 || this.status === 0 ) {\r\n\r\n\t\t\t\t\t\t// Some browsers return HTTP Status 0 when using non-http protocol\r\n\t\t\t\t\t\t// e.g. 'file://' or 'data://'. Handle as success.\r\n\r\n\t\t\t\t\t\tif ( this.status === 0 ) console.warn( 'THREE.FileLoader: HTTP Status 0 received.' );\r\n\r\n\t\t\t\t\t\tfor ( var i = 0, il = callbacks.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tvar callback = callbacks[ i ];\r\n\t\t\t\t\t\t\tif ( callback.onLoad ) callback.onLoad( response );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tfor ( var i = 0, il = callbacks.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tvar callback = callbacks[ i ];\r\n\t\t\t\t\t\t\tif ( callback.onError ) callback.onError( event );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tscope.manager.itemEnd( url );\r\n\t\t\t\t\t\tscope.manager.itemError( url );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}, false );\r\n\r\n\t\t\t\trequest.addEventListener( 'progress', function ( event ) {\r\n\r\n\t\t\t\t\tvar callbacks = loading[ url ];\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = callbacks.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\tvar callback = callbacks[ i ];\r\n\t\t\t\t\t\tif ( callback.onProgress ) callback.onProgress( event );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}, false );\r\n\r\n\t\t\t\trequest.addEventListener( 'error', function ( event ) {\r\n\r\n\t\t\t\t\tvar callbacks = loading[ url ];\r\n\r\n\t\t\t\t\tdelete loading[ url ];\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = callbacks.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\tvar callback = callbacks[ i ];\r\n\t\t\t\t\t\tif ( callback.onError ) callback.onError( event );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tscope.manager.itemEnd( url );\r\n\t\t\t\t\tscope.manager.itemError( url );\r\n\r\n\t\t\t\t}, false );\r\n\r\n\t\t\t\trequest.addEventListener( 'abort', function ( event ) {\r\n\r\n\t\t\t\t\tvar callbacks = loading[ url ];\r\n\r\n\t\t\t\t\tdelete loading[ url ];\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = callbacks.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\tvar callback = callbacks[ i ];\r\n\t\t\t\t\t\tif ( callback.onError ) callback.onError( event );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tscope.manager.itemEnd( url );\r\n\t\t\t\t\tscope.manager.itemError( url );\r\n\r\n\t\t\t\t}, false );\r\n\r\n\t\t\t\tif ( this.responseType !== undefined ) request.responseType = this.responseType;\r\n\t\t\t\tif ( this.withCredentials !== undefined ) request.withCredentials = this.withCredentials;\r\n\r\n\t\t\t\tif ( request.overrideMimeType ) request.overrideMimeType( this.mimeType !== undefined ? this.mimeType : 'text/plain' );\r\n\r\n\t\t\t\tfor ( var header in this.requestHeader ) {\r\n\r\n\t\t\t\t\trequest.setRequestHeader( header, this.requestHeader[ header ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\trequest.send( null );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tscope.manager.itemStart( url );\r\n\r\n\t\t\treturn request;\r\n\r\n\t\t},\r\n\r\n\t\tsetPath: function ( value ) {\r\n\r\n\t\t\tthis.path = value;\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetResponseType: function ( value ) {\r\n\r\n\t\t\tthis.responseType = value;\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetWithCredentials: function ( value ) {\r\n\r\n\t\t\tthis.withCredentials = value;\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetMimeType: function ( value ) {\r\n\r\n\t\t\tthis.mimeType = value;\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetRequestHeader: function ( value ) {\r\n\r\n\t\t\tthis.requestHeader = value;\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t *\r\n\t * Abstract Base class to block based textures loader (dds, pvr, ...)\r\n\t */\r\n\r\n\tfunction CompressedTextureLoader( manager ) {\r\n\r\n\t\tthis.manager = ( manager !== undefined ) ? manager : DefaultLoadingManager;\r\n\r\n\t\t// override in sub classes\r\n\t\tthis._parser = null;\r\n\r\n\t}\r\n\r\n\tObject.assign( CompressedTextureLoader.prototype, {\r\n\r\n\t\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\t\tvar scope = this;\r\n\r\n\t\t\tvar images = [];\r\n\r\n\t\t\tvar texture = new CompressedTexture();\r\n\t\t\ttexture.image = images;\r\n\r\n\t\t\tvar loader = new FileLoader( this.manager );\r\n\t\t\tloader.setPath( this.path );\r\n\t\t\tloader.setResponseType( 'arraybuffer' );\r\n\r\n\t\t\tfunction loadTexture( i ) {\r\n\r\n\t\t\t\tloader.load( url[ i ], function ( buffer ) {\r\n\r\n\t\t\t\t\tvar texDatas = scope._parser( buffer, true );\r\n\r\n\t\t\t\t\timages[ i ] = {\r\n\t\t\t\t\t\twidth: texDatas.width,\r\n\t\t\t\t\t\theight: texDatas.height,\r\n\t\t\t\t\t\tformat: texDatas.format,\r\n\t\t\t\t\t\tmipmaps: texDatas.mipmaps\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tloaded += 1;\r\n\r\n\t\t\t\t\tif ( loaded === 6 ) {\r\n\r\n\t\t\t\t\t\tif ( texDatas.mipmapCount === 1 )\r\n\t\t\t\t\t\t\ttexture.minFilter = LinearFilter;\r\n\r\n\t\t\t\t\t\ttexture.format = texDatas.format;\r\n\t\t\t\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\t\t\t\tif ( onLoad ) onLoad( texture );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}, onProgress, onError );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( Array.isArray( url ) ) {\r\n\r\n\t\t\t\tvar loaded = 0;\r\n\r\n\t\t\t\tfor ( var i = 0, il = url.length; i < il; ++ i ) {\r\n\r\n\t\t\t\t\tloadTexture( i );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// compressed cubemap texture stored in a single DDS file\r\n\r\n\t\t\t\tloader.load( url, function ( buffer ) {\r\n\r\n\t\t\t\t\tvar texDatas = scope._parser( buffer, true );\r\n\r\n\t\t\t\t\tif ( texDatas.isCubemap ) {\r\n\r\n\t\t\t\t\t\tvar faces = texDatas.mipmaps.length / texDatas.mipmapCount;\r\n\r\n\t\t\t\t\t\tfor ( var f = 0; f < faces; f ++ ) {\r\n\r\n\t\t\t\t\t\t\timages[ f ] = { mipmaps: [] };\r\n\r\n\t\t\t\t\t\t\tfor ( var i = 0; i < texDatas.mipmapCount; i ++ ) {\r\n\r\n\t\t\t\t\t\t\t\timages[ f ].mipmaps.push( texDatas.mipmaps[ f * texDatas.mipmapCount + i ] );\r\n\t\t\t\t\t\t\t\timages[ f ].format = texDatas.format;\r\n\t\t\t\t\t\t\t\timages[ f ].width = texDatas.width;\r\n\t\t\t\t\t\t\t\timages[ f ].height = texDatas.height;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\ttexture.image.width = texDatas.width;\r\n\t\t\t\t\t\ttexture.image.height = texDatas.height;\r\n\t\t\t\t\t\ttexture.mipmaps = texDatas.mipmaps;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( texDatas.mipmapCount === 1 ) {\r\n\r\n\t\t\t\t\t\ttexture.minFilter = LinearFilter;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ttexture.format = texDatas.format;\r\n\t\t\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\t\t\tif ( onLoad ) onLoad( texture );\r\n\r\n\t\t\t\t}, onProgress, onError );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn texture;\r\n\r\n\t\t},\r\n\r\n\t\tsetPath: function ( value ) {\r\n\r\n\t\t\tthis.path = value;\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author Nikos M. / https://github.com/foo123/\r\n\t *\r\n\t * Abstract Base class to load generic binary textures formats (rgbe, hdr, ...)\r\n\t */\r\n\r\n\tfunction DataTextureLoader( manager ) {\r\n\r\n\t\tthis.manager = ( manager !== undefined ) ? manager : DefaultLoadingManager;\r\n\r\n\t\t// override in sub classes\r\n\t\tthis._parser = null;\r\n\r\n\t}\r\n\r\n\tObject.assign( DataTextureLoader.prototype, {\r\n\r\n\t\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\t\tvar scope = this;\r\n\r\n\t\t\tvar texture = new DataTexture();\r\n\r\n\t\t\tvar loader = new FileLoader( this.manager );\r\n\t\t\tloader.setResponseType( 'arraybuffer' );\r\n\r\n\t\t\tloader.load( url, function ( buffer ) {\r\n\r\n\t\t\t\tvar texData = scope._parser( buffer );\r\n\r\n\t\t\t\tif ( ! texData ) return;\r\n\r\n\t\t\t\tif ( undefined !== texData.image ) {\r\n\r\n\t\t\t\t\ttexture.image = texData.image;\r\n\r\n\t\t\t\t} else if ( undefined !== texData.data ) {\r\n\r\n\t\t\t\t\ttexture.image.width = texData.width;\r\n\t\t\t\t\ttexture.image.height = texData.height;\r\n\t\t\t\t\ttexture.image.data = texData.data;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttexture.wrapS = undefined !== texData.wrapS ? texData.wrapS : ClampToEdgeWrapping;\r\n\t\t\t\ttexture.wrapT = undefined !== texData.wrapT ? texData.wrapT : ClampToEdgeWrapping;\r\n\r\n\t\t\t\ttexture.magFilter = undefined !== texData.magFilter ? texData.magFilter : LinearFilter;\r\n\t\t\t\ttexture.minFilter = undefined !== texData.minFilter ? texData.minFilter : LinearMipMapLinearFilter;\r\n\r\n\t\t\t\ttexture.anisotropy = undefined !== texData.anisotropy ? texData.anisotropy : 1;\r\n\r\n\t\t\t\tif ( undefined !== texData.format ) {\r\n\r\n\t\t\t\t\ttexture.format = texData.format;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif ( undefined !== texData.type ) {\r\n\r\n\t\t\t\t\ttexture.type = texData.type;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( undefined !== texData.mipmaps ) {\r\n\r\n\t\t\t\t\ttexture.mipmaps = texData.mipmaps;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( 1 === texData.mipmapCount ) {\r\n\r\n\t\t\t\t\ttexture.minFilter = LinearFilter;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\t\tif ( onLoad ) onLoad( texture, texData );\r\n\r\n\t\t\t}, onProgress, onError );\r\n\r\n\r\n\t\t\treturn texture;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\r\n\tfunction ImageLoader( manager ) {\r\n\r\n\t\tthis.manager = ( manager !== undefined ) ? manager : DefaultLoadingManager;\r\n\r\n\t}\r\n\r\n\tObject.assign( ImageLoader.prototype, {\r\n\r\n\t\tcrossOrigin: 'anonymous',\r\n\r\n\t\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\t\tif ( url === undefined ) url = '';\r\n\r\n\t\t\tif ( this.path !== undefined ) url = this.path + url;\r\n\r\n\t\t\turl = this.manager.resolveURL( url );\r\n\r\n\t\t\tvar scope = this;\r\n\r\n\t\t\tvar cached = Cache.get( url );\r\n\r\n\t\t\tif ( cached !== undefined ) {\r\n\r\n\t\t\t\tscope.manager.itemStart( url );\r\n\r\n\t\t\t\tsetTimeout( function () {\r\n\r\n\t\t\t\t\tif ( onLoad ) onLoad( cached );\r\n\r\n\t\t\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t\t\t}, 0 );\r\n\r\n\t\t\t\treturn cached;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar image = document.createElementNS( 'http://www.w3.org/1999/xhtml', 'img' );\r\n\r\n\t\t\tfunction onImageLoad() {\r\n\r\n\t\t\t\timage.removeEventListener( 'load', onImageLoad, false );\r\n\t\t\t\timage.removeEventListener( 'error', onImageError, false );\r\n\r\n\t\t\t\tCache.add( url, this );\r\n\r\n\t\t\t\tif ( onLoad ) onLoad( this );\r\n\r\n\t\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction onImageError( event ) {\r\n\r\n\t\t\t\timage.removeEventListener( 'load', onImageLoad, false );\r\n\t\t\t\timage.removeEventListener( 'error', onImageError, false );\r\n\r\n\t\t\t\tif ( onError ) onError( event );\r\n\r\n\t\t\t\tscope.manager.itemEnd( url );\r\n\t\t\t\tscope.manager.itemError( url );\r\n\r\n\t\t\t}\r\n\r\n\t\t\timage.addEventListener( 'load', onImageLoad, false );\r\n\t\t\timage.addEventListener( 'error', onImageError, false );\r\n\r\n\t\t\tif ( url.substr( 0, 5 ) !== 'data:' ) {\r\n\r\n\t\t\t\tif ( this.crossOrigin !== undefined ) image.crossOrigin = this.crossOrigin;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tscope.manager.itemStart( url );\r\n\r\n\t\t\timage.src = url;\r\n\r\n\t\t\treturn image;\r\n\r\n\t\t},\r\n\r\n\t\tsetCrossOrigin: function ( value ) {\r\n\r\n\t\t\tthis.crossOrigin = value;\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetPath: function ( value ) {\r\n\r\n\t\t\tthis.path = value;\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\r\n\tfunction CubeTextureLoader( manager ) {\r\n\r\n\t\tthis.manager = ( manager !== undefined ) ? manager : DefaultLoadingManager;\r\n\r\n\t}\r\n\r\n\tObject.assign( CubeTextureLoader.prototype, {\r\n\r\n\t\tcrossOrigin: 'anonymous',\r\n\r\n\t\tload: function ( urls, onLoad, onProgress, onError ) {\r\n\r\n\t\t\tvar texture = new CubeTexture();\r\n\r\n\t\t\tvar loader = new ImageLoader( this.manager );\r\n\t\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\t\t\tloader.setPath( this.path );\r\n\r\n\t\t\tvar loaded = 0;\r\n\r\n\t\t\tfunction loadTexture( i ) {\r\n\r\n\t\t\t\tloader.load( urls[ i ], function ( image ) {\r\n\r\n\t\t\t\t\ttexture.images[ i ] = image;\r\n\r\n\t\t\t\t\tloaded ++;\r\n\r\n\t\t\t\t\tif ( loaded === 6 ) {\r\n\r\n\t\t\t\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\t\t\t\tif ( onLoad ) onLoad( texture );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}, undefined, onError );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var i = 0; i < urls.length; ++ i ) {\r\n\r\n\t\t\t\tloadTexture( i );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn texture;\r\n\r\n\t\t},\r\n\r\n\t\tsetCrossOrigin: function ( value ) {\r\n\r\n\t\t\tthis.crossOrigin = value;\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetPath: function ( value ) {\r\n\r\n\t\t\tthis.path = value;\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\r\n\tfunction TextureLoader( manager ) {\r\n\r\n\t\tthis.manager = ( manager !== undefined ) ? manager : DefaultLoadingManager;\r\n\r\n\t}\r\n\r\n\tObject.assign( TextureLoader.prototype, {\r\n\r\n\t\tcrossOrigin: 'anonymous',\r\n\r\n\t\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\t\tvar texture = new Texture();\r\n\r\n\t\t\tvar loader = new ImageLoader( this.manager );\r\n\t\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\t\t\tloader.setPath( this.path );\r\n\r\n\t\t\tloader.load( url, function ( image ) {\r\n\r\n\t\t\t\ttexture.image = image;\r\n\r\n\t\t\t\t// JPEGs can't have an alpha channel, so memory can be saved by storing them as RGB.\r\n\t\t\t\tvar isJPEG = url.search( /\\.jpe?g$/i ) > 0 || url.search( /^data\\:image\\/jpeg/ ) === 0;\r\n\r\n\t\t\t\ttexture.format = isJPEG ? RGBFormat : RGBAFormat;\r\n\t\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\t\tif ( onLoad !== undefined ) {\r\n\r\n\t\t\t\t\tonLoad( texture );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}, onProgress, onError );\r\n\r\n\t\t\treturn texture;\r\n\r\n\t\t},\r\n\r\n\t\tsetCrossOrigin: function ( value ) {\r\n\r\n\t\t\tthis.crossOrigin = value;\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetPath: function ( value ) {\r\n\r\n\t\t\tthis.path = value;\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\r\n\t * Extensible curve object\r\n\t *\r\n\t * Some common of curve methods:\r\n\t * .getPoint( t, optionalTarget ), .getTangent( t )\r\n\t * .getPointAt( u, optionalTarget ), .getTangentAt( u )\r\n\t * .getPoints(), .getSpacedPoints()\r\n\t * .getLength()\r\n\t * .updateArcLengths()\r\n\t *\r\n\t * This following curves inherit from THREE.Curve:\r\n\t *\r\n\t * -- 2D curves --\r\n\t * THREE.ArcCurve\r\n\t * THREE.CubicBezierCurve\r\n\t * THREE.EllipseCurve\r\n\t * THREE.LineCurve\r\n\t * THREE.QuadraticBezierCurve\r\n\t * THREE.SplineCurve\r\n\t *\r\n\t * -- 3D curves --\r\n\t * THREE.CatmullRomCurve3\r\n\t * THREE.CubicBezierCurve3\r\n\t * THREE.LineCurve3\r\n\t * THREE.QuadraticBezierCurve3\r\n\t *\r\n\t * A series of curves can be represented as a THREE.CurvePath.\r\n\t *\r\n\t **/\r\n\r\n\t/**************************************************************\r\n\t *\tAbstract Curve base class\r\n\t **************************************************************/\r\n\r\n\tfunction Curve() {\r\n\r\n\t\tthis.type = 'Curve';\r\n\r\n\t\tthis.arcLengthDivisions = 200;\r\n\r\n\t}\r\n\r\n\tObject.assign( Curve.prototype, {\r\n\r\n\t\t// Virtual base class method to overwrite and implement in subclasses\r\n\t\t//\t- t [0 .. 1]\r\n\r\n\t\tgetPoint: function ( /* t, optionalTarget */ ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Curve: .getPoint() not implemented.' );\r\n\t\t\treturn null;\r\n\r\n\t\t},\r\n\r\n\t\t// Get point at relative position in curve according to arc length\r\n\t\t// - u [0 .. 1]\r\n\r\n\t\tgetPointAt: function ( u, optionalTarget ) {\r\n\r\n\t\t\tvar t = this.getUtoTmapping( u );\r\n\t\t\treturn this.getPoint( t, optionalTarget );\r\n\r\n\t\t},\r\n\r\n\t\t// Get sequence of points using getPoint( t )\r\n\r\n\t\tgetPoints: function ( divisions ) {\r\n\r\n\t\t\tif ( divisions === undefined ) divisions = 5;\r\n\r\n\t\t\tvar points = [];\r\n\r\n\t\t\tfor ( var d = 0; d <= divisions; d ++ ) {\r\n\r\n\t\t\t\tpoints.push( this.getPoint( d / divisions ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn points;\r\n\r\n\t\t},\r\n\r\n\t\t// Get sequence of points using getPointAt( u )\r\n\r\n\t\tgetSpacedPoints: function ( divisions ) {\r\n\r\n\t\t\tif ( divisions === undefined ) divisions = 5;\r\n\r\n\t\t\tvar points = [];\r\n\r\n\t\t\tfor ( var d = 0; d <= divisions; d ++ ) {\r\n\r\n\t\t\t\tpoints.push( this.getPointAt( d / divisions ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn points;\r\n\r\n\t\t},\r\n\r\n\t\t// Get total curve arc length\r\n\r\n\t\tgetLength: function () {\r\n\r\n\t\t\tvar lengths = this.getLengths();\r\n\t\t\treturn lengths[ lengths.length - 1 ];\r\n\r\n\t\t},\r\n\r\n\t\t// Get list of cumulative segment lengths\r\n\r\n\t\tgetLengths: function ( divisions ) {\r\n\r\n\t\t\tif ( divisions === undefined ) divisions = this.arcLengthDivisions;\r\n\r\n\t\t\tif ( this.cacheArcLengths &&\r\n\t\t\t\t( this.cacheArcLengths.length === divisions + 1 ) &&\r\n\t\t\t\t! this.needsUpdate ) {\r\n\r\n\t\t\t\treturn this.cacheArcLengths;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.needsUpdate = false;\r\n\r\n\t\t\tvar cache = [];\r\n\t\t\tvar current, last = this.getPoint( 0 );\r\n\t\t\tvar p, sum = 0;\r\n\r\n\t\t\tcache.push( 0 );\r\n\r\n\t\t\tfor ( p = 1; p <= divisions; p ++ ) {\r\n\r\n\t\t\t\tcurrent = this.getPoint( p / divisions );\r\n\t\t\t\tsum += current.distanceTo( last );\r\n\t\t\t\tcache.push( sum );\r\n\t\t\t\tlast = current;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.cacheArcLengths = cache;\r\n\r\n\t\t\treturn cache; // { sums: cache, sum: sum }; Sum is in the last element.\r\n\r\n\t\t},\r\n\r\n\t\tupdateArcLengths: function () {\r\n\r\n\t\t\tthis.needsUpdate = true;\r\n\t\t\tthis.getLengths();\r\n\r\n\t\t},\r\n\r\n\t\t// Given u ( 0 .. 1 ), get a t to find p. This gives you points which are equidistant\r\n\r\n\t\tgetUtoTmapping: function ( u, distance ) {\r\n\r\n\t\t\tvar arcLengths = this.getLengths();\r\n\r\n\t\t\tvar i = 0, il = arcLengths.length;\r\n\r\n\t\t\tvar targetArcLength; // The targeted u distance value to get\r\n\r\n\t\t\tif ( distance ) {\r\n\r\n\t\t\t\ttargetArcLength = distance;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\ttargetArcLength = u * arcLengths[ il - 1 ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// binary search for the index with largest value smaller than target u distance\r\n\r\n\t\t\tvar low = 0, high = il - 1, comparison;\r\n\r\n\t\t\twhile ( low <= high ) {\r\n\r\n\t\t\t\ti = Math.floor( low + ( high - low ) / 2 ); // less likely to overflow, though probably not issue here, JS doesn't really have integers, all numbers are floats\r\n\r\n\t\t\t\tcomparison = arcLengths[ i ] - targetArcLength;\r\n\r\n\t\t\t\tif ( comparison < 0 ) {\r\n\r\n\t\t\t\t\tlow = i + 1;\r\n\r\n\t\t\t\t} else if ( comparison > 0 ) {\r\n\r\n\t\t\t\t\thigh = i - 1;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\thigh = i;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t// DONE\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\ti = high;\r\n\r\n\t\t\tif ( arcLengths[ i ] === targetArcLength ) {\r\n\r\n\t\t\t\treturn i / ( il - 1 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// we could get finer grain at lengths, or use simple interpolation between two points\r\n\r\n\t\t\tvar lengthBefore = arcLengths[ i ];\r\n\t\t\tvar lengthAfter = arcLengths[ i + 1 ];\r\n\r\n\t\t\tvar segmentLength = lengthAfter - lengthBefore;\r\n\r\n\t\t\t// determine where we are between the 'before' and 'after' points\r\n\r\n\t\t\tvar segmentFraction = ( targetArcLength - lengthBefore ) / segmentLength;\r\n\r\n\t\t\t// add that fractional amount to t\r\n\r\n\t\t\tvar t = ( i + segmentFraction ) / ( il - 1 );\r\n\r\n\t\t\treturn t;\r\n\r\n\t\t},\r\n\r\n\t\t// Returns a unit vector tangent at t\r\n\t\t// In case any sub curve does not implement its tangent derivation,\r\n\t\t// 2 points a small delta apart will be used to find its gradient\r\n\t\t// which seems to give a reasonable approximation\r\n\r\n\t\tgetTangent: function ( t ) {\r\n\r\n\t\t\tvar delta = 0.0001;\r\n\t\t\tvar t1 = t - delta;\r\n\t\t\tvar t2 = t + delta;\r\n\r\n\t\t\t// Capping in case of danger\r\n\r\n\t\t\tif ( t1 < 0 ) t1 = 0;\r\n\t\t\tif ( t2 > 1 ) t2 = 1;\r\n\r\n\t\t\tvar pt1 = this.getPoint( t1 );\r\n\t\t\tvar pt2 = this.getPoint( t2 );\r\n\r\n\t\t\tvar vec = pt2.clone().sub( pt1 );\r\n\t\t\treturn vec.normalize();\r\n\r\n\t\t},\r\n\r\n\t\tgetTangentAt: function ( u ) {\r\n\r\n\t\t\tvar t = this.getUtoTmapping( u );\r\n\t\t\treturn this.getTangent( t );\r\n\r\n\t\t},\r\n\r\n\t\tcomputeFrenetFrames: function ( segments, closed ) {\r\n\r\n\t\t\t// see http://www.cs.indiana.edu/pub/techreports/TR425.pdf\r\n\r\n\t\t\tvar normal = new Vector3();\r\n\r\n\t\t\tvar tangents = [];\r\n\t\t\tvar normals = [];\r\n\t\t\tvar binormals = [];\r\n\r\n\t\t\tvar vec = new Vector3();\r\n\t\t\tvar mat = new Matrix4();\r\n\r\n\t\t\tvar i, u, theta;\r\n\r\n\t\t\t// compute the tangent vectors for each segment on the curve\r\n\r\n\t\t\tfor ( i = 0; i <= segments; i ++ ) {\r\n\r\n\t\t\t\tu = i / segments;\r\n\r\n\t\t\t\ttangents[ i ] = this.getTangentAt( u );\r\n\t\t\t\ttangents[ i ].normalize();\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// select an initial normal vector perpendicular to the first tangent vector,\r\n\t\t\t// and in the direction of the minimum tangent xyz component\r\n\r\n\t\t\tnormals[ 0 ] = new Vector3();\r\n\t\t\tbinormals[ 0 ] = new Vector3();\r\n\t\t\tvar min = Number.MAX_VALUE;\r\n\t\t\tvar tx = Math.abs( tangents[ 0 ].x );\r\n\t\t\tvar ty = Math.abs( tangents[ 0 ].y );\r\n\t\t\tvar tz = Math.abs( tangents[ 0 ].z );\r\n\r\n\t\t\tif ( tx <= min ) {\r\n\r\n\t\t\t\tmin = tx;\r\n\t\t\t\tnormal.set( 1, 0, 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( ty <= min ) {\r\n\r\n\t\t\t\tmin = ty;\r\n\t\t\t\tnormal.set( 0, 1, 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( tz <= min ) {\r\n\r\n\t\t\t\tnormal.set( 0, 0, 1 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvec.crossVectors( tangents[ 0 ], normal ).normalize();\r\n\r\n\t\t\tnormals[ 0 ].crossVectors( tangents[ 0 ], vec );\r\n\t\t\tbinormals[ 0 ].crossVectors( tangents[ 0 ], normals[ 0 ] );\r\n\r\n\r\n\t\t\t// compute the slowly-varying normal and binormal vectors for each segment on the curve\r\n\r\n\t\t\tfor ( i = 1; i <= segments; i ++ ) {\r\n\r\n\t\t\t\tnormals[ i ] = normals[ i - 1 ].clone();\r\n\r\n\t\t\t\tbinormals[ i ] = binormals[ i - 1 ].clone();\r\n\r\n\t\t\t\tvec.crossVectors( tangents[ i - 1 ], tangents[ i ] );\r\n\r\n\t\t\t\tif ( vec.length() > Number.EPSILON ) {\r\n\r\n\t\t\t\t\tvec.normalize();\r\n\r\n\t\t\t\t\ttheta = Math.acos( _Math.clamp( tangents[ i - 1 ].dot( tangents[ i ] ), - 1, 1 ) ); // clamp for floating pt errors\r\n\r\n\t\t\t\t\tnormals[ i ].applyMatrix4( mat.makeRotationAxis( vec, theta ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbinormals[ i ].crossVectors( tangents[ i ], normals[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// if the curve is closed, postprocess the vectors so the first and last normal vectors are the same\r\n\r\n\t\t\tif ( closed === true ) {\r\n\r\n\t\t\t\ttheta = Math.acos( _Math.clamp( normals[ 0 ].dot( normals[ segments ] ), - 1, 1 ) );\r\n\t\t\t\ttheta /= segments;\r\n\r\n\t\t\t\tif ( tangents[ 0 ].dot( vec.crossVectors( normals[ 0 ], normals[ segments ] ) ) > 0 ) {\r\n\r\n\t\t\t\t\ttheta = - theta;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor ( i = 1; i <= segments; i ++ ) {\r\n\r\n\t\t\t\t\t// twist a little...\r\n\t\t\t\t\tnormals[ i ].applyMatrix4( mat.makeRotationAxis( tangents[ i ], theta * i ) );\r\n\t\t\t\t\tbinormals[ i ].crossVectors( tangents[ i ], normals[ i ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn {\r\n\t\t\t\ttangents: tangents,\r\n\t\t\t\tnormals: normals,\r\n\t\t\t\tbinormals: binormals\r\n\t\t\t};\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tthis.arcLengthDivisions = source.arcLengthDivisions;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function () {\r\n\r\n\t\t\tvar data = {\r\n\t\t\t\tmetadata: {\r\n\t\t\t\t\tversion: 4.5,\r\n\t\t\t\t\ttype: 'Curve',\r\n\t\t\t\t\tgenerator: 'Curve.toJSON'\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tdata.arcLengthDivisions = this.arcLengthDivisions;\r\n\t\t\tdata.type = this.type;\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t},\r\n\r\n\t\tfromJSON: function ( json ) {\r\n\r\n\t\t\tthis.arcLengthDivisions = json.arcLengthDivisions;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tfunction EllipseCurve( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation ) {\r\n\r\n\t\tCurve.call( this );\r\n\r\n\t\tthis.type = 'EllipseCurve';\r\n\r\n\t\tthis.aX = aX || 0;\r\n\t\tthis.aY = aY || 0;\r\n\r\n\t\tthis.xRadius = xRadius || 1;\r\n\t\tthis.yRadius = yRadius || 1;\r\n\r\n\t\tthis.aStartAngle = aStartAngle || 0;\r\n\t\tthis.aEndAngle = aEndAngle || 2 * Math.PI;\r\n\r\n\t\tthis.aClockwise = aClockwise || false;\r\n\r\n\t\tthis.aRotation = aRotation || 0;\r\n\r\n\t}\r\n\r\n\tEllipseCurve.prototype = Object.create( Curve.prototype );\r\n\tEllipseCurve.prototype.constructor = EllipseCurve;\r\n\r\n\tEllipseCurve.prototype.isEllipseCurve = true;\r\n\r\n\tEllipseCurve.prototype.getPoint = function ( t, optionalTarget ) {\r\n\r\n\t\tvar point = optionalTarget || new Vector2();\r\n\r\n\t\tvar twoPi = Math.PI * 2;\r\n\t\tvar deltaAngle = this.aEndAngle - this.aStartAngle;\r\n\t\tvar samePoints = Math.abs( deltaAngle ) < Number.EPSILON;\r\n\r\n\t\t// ensures that deltaAngle is 0 .. 2 PI\r\n\t\twhile ( deltaAngle < 0 ) deltaAngle += twoPi;\r\n\t\twhile ( deltaAngle > twoPi ) deltaAngle -= twoPi;\r\n\r\n\t\tif ( deltaAngle < Number.EPSILON ) {\r\n\r\n\t\t\tif ( samePoints ) {\r\n\r\n\t\t\t\tdeltaAngle = 0;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tdeltaAngle = twoPi;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.aClockwise === true && ! samePoints ) {\r\n\r\n\t\t\tif ( deltaAngle === twoPi ) {\r\n\r\n\t\t\t\tdeltaAngle = - twoPi;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tdeltaAngle = deltaAngle - twoPi;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar angle = this.aStartAngle + t * deltaAngle;\r\n\t\tvar x = this.aX + this.xRadius * Math.cos( angle );\r\n\t\tvar y = this.aY + this.yRadius * Math.sin( angle );\r\n\r\n\t\tif ( this.aRotation !== 0 ) {\r\n\r\n\t\t\tvar cos = Math.cos( this.aRotation );\r\n\t\t\tvar sin = Math.sin( this.aRotation );\r\n\r\n\t\t\tvar tx = x - this.aX;\r\n\t\t\tvar ty = y - this.aY;\r\n\r\n\t\t\t// Rotate the point about the center of the ellipse.\r\n\t\t\tx = tx * cos - ty * sin + this.aX;\r\n\t\t\ty = tx * sin + ty * cos + this.aY;\r\n\r\n\t\t}\r\n\r\n\t\treturn point.set( x, y );\r\n\r\n\t};\r\n\r\n\tEllipseCurve.prototype.copy = function ( source ) {\r\n\r\n\t\tCurve.prototype.copy.call( this, source );\r\n\r\n\t\tthis.aX = source.aX;\r\n\t\tthis.aY = source.aY;\r\n\r\n\t\tthis.xRadius = source.xRadius;\r\n\t\tthis.yRadius = source.yRadius;\r\n\r\n\t\tthis.aStartAngle = source.aStartAngle;\r\n\t\tthis.aEndAngle = source.aEndAngle;\r\n\r\n\t\tthis.aClockwise = source.aClockwise;\r\n\r\n\t\tthis.aRotation = source.aRotation;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\r\n\tEllipseCurve.prototype.toJSON = function () {\r\n\r\n\t\tvar data = Curve.prototype.toJSON.call( this );\r\n\r\n\t\tdata.aX = this.aX;\r\n\t\tdata.aY = this.aY;\r\n\r\n\t\tdata.xRadius = this.xRadius;\r\n\t\tdata.yRadius = this.yRadius;\r\n\r\n\t\tdata.aStartAngle = this.aStartAngle;\r\n\t\tdata.aEndAngle = this.aEndAngle;\r\n\r\n\t\tdata.aClockwise = this.aClockwise;\r\n\r\n\t\tdata.aRotation = this.aRotation;\r\n\r\n\t\treturn data;\r\n\r\n\t};\r\n\r\n\tEllipseCurve.prototype.fromJSON = function ( json ) {\r\n\r\n\t\tCurve.prototype.fromJSON.call( this, json );\r\n\r\n\t\tthis.aX = json.aX;\r\n\t\tthis.aY = json.aY;\r\n\r\n\t\tthis.xRadius = json.xRadius;\r\n\t\tthis.yRadius = json.yRadius;\r\n\r\n\t\tthis.aStartAngle = json.aStartAngle;\r\n\t\tthis.aEndAngle = json.aEndAngle;\r\n\r\n\t\tthis.aClockwise = json.aClockwise;\r\n\r\n\t\tthis.aRotation = json.aRotation;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction ArcCurve( aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise ) {\r\n\r\n\t\tEllipseCurve.call( this, aX, aY, aRadius, aRadius, aStartAngle, aEndAngle, aClockwise );\r\n\r\n\t\tthis.type = 'ArcCurve';\r\n\r\n\t}\r\n\r\n\tArcCurve.prototype = Object.create( EllipseCurve.prototype );\r\n\tArcCurve.prototype.constructor = ArcCurve;\r\n\r\n\tArcCurve.prototype.isArcCurve = true;\r\n\r\n\t/**\r\n\t * @author zz85 https://github.com/zz85\r\n\t *\r\n\t * Centripetal CatmullRom Curve - which is useful for avoiding\r\n\t * cusps and self-intersections in non-uniform catmull rom curves.\r\n\t * http://www.cemyuksel.com/research/catmullrom_param/catmullrom.pdf\r\n\t *\r\n\t * curve.type accepts centripetal(default), chordal and catmullrom\r\n\t * curve.tension is used for catmullrom which defaults to 0.5\r\n\t */\r\n\r\n\r\n\t/*\r\n\tBased on an optimized c++ solution in\r\n\t - http://stackoverflow.com/questions/9489736/catmull-rom-curve-with-no-cusps-and-no-self-intersections/\r\n\t - http://ideone.com/NoEbVM\r\n\r\n\tThis CubicPoly class could be used for reusing some variables and calculations,\r\n\tbut for three.js curve use, it could be possible inlined and flatten into a single function call\r\n\twhich can be placed in CurveUtils.\r\n\t*/\r\n\r\n\tfunction CubicPoly() {\r\n\r\n\t\tvar c0 = 0, c1 = 0, c2 = 0, c3 = 0;\r\n\r\n\t\t/*\r\n\t\t * Compute coefficients for a cubic polynomial\r\n\t\t *   p(s) = c0 + c1*s + c2*s^2 + c3*s^3\r\n\t\t * such that\r\n\t\t *   p(0) = x0, p(1) = x1\r\n\t\t *  and\r\n\t\t *   p'(0) = t0, p'(1) = t1.\r\n\t\t */\r\n\t\tfunction init( x0, x1, t0, t1 ) {\r\n\r\n\t\t\tc0 = x0;\r\n\t\t\tc1 = t0;\r\n\t\t\tc2 = - 3 * x0 + 3 * x1 - 2 * t0 - t1;\r\n\t\t\tc3 = 2 * x0 - 2 * x1 + t0 + t1;\r\n\r\n\t\t}\r\n\r\n\t\treturn {\r\n\r\n\t\t\tinitCatmullRom: function ( x0, x1, x2, x3, tension ) {\r\n\r\n\t\t\t\tinit( x1, x2, tension * ( x2 - x0 ), tension * ( x3 - x1 ) );\r\n\r\n\t\t\t},\r\n\r\n\t\t\tinitNonuniformCatmullRom: function ( x0, x1, x2, x3, dt0, dt1, dt2 ) {\r\n\r\n\t\t\t\t// compute tangents when parameterized in [t1,t2]\r\n\t\t\t\tvar t1 = ( x1 - x0 ) / dt0 - ( x2 - x0 ) / ( dt0 + dt1 ) + ( x2 - x1 ) / dt1;\r\n\t\t\t\tvar t2 = ( x2 - x1 ) / dt1 - ( x3 - x1 ) / ( dt1 + dt2 ) + ( x3 - x2 ) / dt2;\r\n\r\n\t\t\t\t// rescale tangents for parametrization in [0,1]\r\n\t\t\t\tt1 *= dt1;\r\n\t\t\t\tt2 *= dt1;\r\n\r\n\t\t\t\tinit( x1, x2, t1, t2 );\r\n\r\n\t\t\t},\r\n\r\n\t\t\tcalc: function ( t ) {\r\n\r\n\t\t\t\tvar t2 = t * t;\r\n\t\t\t\tvar t3 = t2 * t;\r\n\t\t\t\treturn c0 + c1 * t + c2 * t2 + c3 * t3;\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tvar tmp = new Vector3();\r\n\tvar px = new CubicPoly(), py = new CubicPoly(), pz = new CubicPoly();\r\n\r\n\tfunction CatmullRomCurve3( points, closed, curveType, tension ) {\r\n\r\n\t\tCurve.call( this );\r\n\r\n\t\tthis.type = 'CatmullRomCurve3';\r\n\r\n\t\tthis.points = points || [];\r\n\t\tthis.closed = closed || false;\r\n\t\tthis.curveType = curveType || 'centripetal';\r\n\t\tthis.tension = tension || 0.5;\r\n\r\n\t}\r\n\r\n\tCatmullRomCurve3.prototype = Object.create( Curve.prototype );\r\n\tCatmullRomCurve3.prototype.constructor = CatmullRomCurve3;\r\n\r\n\tCatmullRomCurve3.prototype.isCatmullRomCurve3 = true;\r\n\r\n\tCatmullRomCurve3.prototype.getPoint = function ( t, optionalTarget ) {\r\n\r\n\t\tvar point = optionalTarget || new Vector3();\r\n\r\n\t\tvar points = this.points;\r\n\t\tvar l = points.length;\r\n\r\n\t\tvar p = ( l - ( this.closed ? 0 : 1 ) ) * t;\r\n\t\tvar intPoint = Math.floor( p );\r\n\t\tvar weight = p - intPoint;\r\n\r\n\t\tif ( this.closed ) {\r\n\r\n\t\t\tintPoint += intPoint > 0 ? 0 : ( Math.floor( Math.abs( intPoint ) / l ) + 1 ) * l;\r\n\r\n\t\t} else if ( weight === 0 && intPoint === l - 1 ) {\r\n\r\n\t\t\tintPoint = l - 2;\r\n\t\t\tweight = 1;\r\n\r\n\t\t}\r\n\r\n\t\tvar p0, p1, p2, p3; // 4 points\r\n\r\n\t\tif ( this.closed || intPoint > 0 ) {\r\n\r\n\t\t\tp0 = points[ ( intPoint - 1 ) % l ];\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// extrapolate first point\r\n\t\t\ttmp.subVectors( points[ 0 ], points[ 1 ] ).add( points[ 0 ] );\r\n\t\t\tp0 = tmp;\r\n\r\n\t\t}\r\n\r\n\t\tp1 = points[ intPoint % l ];\r\n\t\tp2 = points[ ( intPoint + 1 ) % l ];\r\n\r\n\t\tif ( this.closed || intPoint + 2 < l ) {\r\n\r\n\t\t\tp3 = points[ ( intPoint + 2 ) % l ];\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// extrapolate last point\r\n\t\t\ttmp.subVectors( points[ l - 1 ], points[ l - 2 ] ).add( points[ l - 1 ] );\r\n\t\t\tp3 = tmp;\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.curveType === 'centripetal' || this.curveType === 'chordal' ) {\r\n\r\n\t\t\t// init Centripetal / Chordal Catmull-Rom\r\n\t\t\tvar pow = this.curveType === 'chordal' ? 0.5 : 0.25;\r\n\t\t\tvar dt0 = Math.pow( p0.distanceToSquared( p1 ), pow );\r\n\t\t\tvar dt1 = Math.pow( p1.distanceToSquared( p2 ), pow );\r\n\t\t\tvar dt2 = Math.pow( p2.distanceToSquared( p3 ), pow );\r\n\r\n\t\t\t// safety check for repeated points\r\n\t\t\tif ( dt1 < 1e-4 ) dt1 = 1.0;\r\n\t\t\tif ( dt0 < 1e-4 ) dt0 = dt1;\r\n\t\t\tif ( dt2 < 1e-4 ) dt2 = dt1;\r\n\r\n\t\t\tpx.initNonuniformCatmullRom( p0.x, p1.x, p2.x, p3.x, dt0, dt1, dt2 );\r\n\t\t\tpy.initNonuniformCatmullRom( p0.y, p1.y, p2.y, p3.y, dt0, dt1, dt2 );\r\n\t\t\tpz.initNonuniformCatmullRom( p0.z, p1.z, p2.z, p3.z, dt0, dt1, dt2 );\r\n\r\n\t\t} else if ( this.curveType === 'catmullrom' ) {\r\n\r\n\t\t\tpx.initCatmullRom( p0.x, p1.x, p2.x, p3.x, this.tension );\r\n\t\t\tpy.initCatmullRom( p0.y, p1.y, p2.y, p3.y, this.tension );\r\n\t\t\tpz.initCatmullRom( p0.z, p1.z, p2.z, p3.z, this.tension );\r\n\r\n\t\t}\r\n\r\n\t\tpoint.set(\r\n\t\t\tpx.calc( weight ),\r\n\t\t\tpy.calc( weight ),\r\n\t\t\tpz.calc( weight )\r\n\t\t);\r\n\r\n\t\treturn point;\r\n\r\n\t};\r\n\r\n\tCatmullRomCurve3.prototype.copy = function ( source ) {\r\n\r\n\t\tCurve.prototype.copy.call( this, source );\r\n\r\n\t\tthis.points = [];\r\n\r\n\t\tfor ( var i = 0, l = source.points.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar point = source.points[ i ];\r\n\r\n\t\t\tthis.points.push( point.clone() );\r\n\r\n\t\t}\r\n\r\n\t\tthis.closed = source.closed;\r\n\t\tthis.curveType = source.curveType;\r\n\t\tthis.tension = source.tension;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tCatmullRomCurve3.prototype.toJSON = function () {\r\n\r\n\t\tvar data = Curve.prototype.toJSON.call( this );\r\n\r\n\t\tdata.points = [];\r\n\r\n\t\tfor ( var i = 0, l = this.points.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar point = this.points[ i ];\r\n\t\t\tdata.points.push( point.toArray() );\r\n\r\n\t\t}\r\n\r\n\t\tdata.closed = this.closed;\r\n\t\tdata.curveType = this.curveType;\r\n\t\tdata.tension = this.tension;\r\n\r\n\t\treturn data;\r\n\r\n\t};\r\n\r\n\tCatmullRomCurve3.prototype.fromJSON = function ( json ) {\r\n\r\n\t\tCurve.prototype.fromJSON.call( this, json );\r\n\r\n\t\tthis.points = [];\r\n\r\n\t\tfor ( var i = 0, l = json.points.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar point = json.points[ i ];\r\n\t\t\tthis.points.push( new Vector3().fromArray( point ) );\r\n\r\n\t\t}\r\n\r\n\t\tthis.closed = json.closed;\r\n\t\tthis.curveType = json.curveType;\r\n\t\tthis.tension = json.tension;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\r\n\t *\r\n\t * Bezier Curves formulas obtained from\r\n\t * http://en.wikipedia.org/wiki/Bzier_curve\r\n\t */\r\n\r\n\tfunction CatmullRom( t, p0, p1, p2, p3 ) {\r\n\r\n\t\tvar v0 = ( p2 - p0 ) * 0.5;\r\n\t\tvar v1 = ( p3 - p1 ) * 0.5;\r\n\t\tvar t2 = t * t;\r\n\t\tvar t3 = t * t2;\r\n\t\treturn ( 2 * p1 - 2 * p2 + v0 + v1 ) * t3 + ( - 3 * p1 + 3 * p2 - 2 * v0 - v1 ) * t2 + v0 * t + p1;\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tfunction QuadraticBezierP0( t, p ) {\r\n\r\n\t\tvar k = 1 - t;\r\n\t\treturn k * k * p;\r\n\r\n\t}\r\n\r\n\tfunction QuadraticBezierP1( t, p ) {\r\n\r\n\t\treturn 2 * ( 1 - t ) * t * p;\r\n\r\n\t}\r\n\r\n\tfunction QuadraticBezierP2( t, p ) {\r\n\r\n\t\treturn t * t * p;\r\n\r\n\t}\r\n\r\n\tfunction QuadraticBezier( t, p0, p1, p2 ) {\r\n\r\n\t\treturn QuadraticBezierP0( t, p0 ) + QuadraticBezierP1( t, p1 ) +\r\n\t\t\tQuadraticBezierP2( t, p2 );\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tfunction CubicBezierP0( t, p ) {\r\n\r\n\t\tvar k = 1 - t;\r\n\t\treturn k * k * k * p;\r\n\r\n\t}\r\n\r\n\tfunction CubicBezierP1( t, p ) {\r\n\r\n\t\tvar k = 1 - t;\r\n\t\treturn 3 * k * k * t * p;\r\n\r\n\t}\r\n\r\n\tfunction CubicBezierP2( t, p ) {\r\n\r\n\t\treturn 3 * ( 1 - t ) * t * t * p;\r\n\r\n\t}\r\n\r\n\tfunction CubicBezierP3( t, p ) {\r\n\r\n\t\treturn t * t * t * p;\r\n\r\n\t}\r\n\r\n\tfunction CubicBezier( t, p0, p1, p2, p3 ) {\r\n\r\n\t\treturn CubicBezierP0( t, p0 ) + CubicBezierP1( t, p1 ) + CubicBezierP2( t, p2 ) +\r\n\t\t\tCubicBezierP3( t, p3 );\r\n\r\n\t}\r\n\r\n\tfunction CubicBezierCurve( v0, v1, v2, v3 ) {\r\n\r\n\t\tCurve.call( this );\r\n\r\n\t\tthis.type = 'CubicBezierCurve';\r\n\r\n\t\tthis.v0 = v0 || new Vector2();\r\n\t\tthis.v1 = v1 || new Vector2();\r\n\t\tthis.v2 = v2 || new Vector2();\r\n\t\tthis.v3 = v3 || new Vector2();\r\n\r\n\t}\r\n\r\n\tCubicBezierCurve.prototype = Object.create( Curve.prototype );\r\n\tCubicBezierCurve.prototype.constructor = CubicBezierCurve;\r\n\r\n\tCubicBezierCurve.prototype.isCubicBezierCurve = true;\r\n\r\n\tCubicBezierCurve.prototype.getPoint = function ( t, optionalTarget ) {\r\n\r\n\t\tvar point = optionalTarget || new Vector2();\r\n\r\n\t\tvar v0 = this.v0, v1 = this.v1, v2 = this.v2, v3 = this.v3;\r\n\r\n\t\tpoint.set(\r\n\t\t\tCubicBezier( t, v0.x, v1.x, v2.x, v3.x ),\r\n\t\t\tCubicBezier( t, v0.y, v1.y, v2.y, v3.y )\r\n\t\t);\r\n\r\n\t\treturn point;\r\n\r\n\t};\r\n\r\n\tCubicBezierCurve.prototype.copy = function ( source ) {\r\n\r\n\t\tCurve.prototype.copy.call( this, source );\r\n\r\n\t\tthis.v0.copy( source.v0 );\r\n\t\tthis.v1.copy( source.v1 );\r\n\t\tthis.v2.copy( source.v2 );\r\n\t\tthis.v3.copy( source.v3 );\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tCubicBezierCurve.prototype.toJSON = function () {\r\n\r\n\t\tvar data = Curve.prototype.toJSON.call( this );\r\n\r\n\t\tdata.v0 = this.v0.toArray();\r\n\t\tdata.v1 = this.v1.toArray();\r\n\t\tdata.v2 = this.v2.toArray();\r\n\t\tdata.v3 = this.v3.toArray();\r\n\r\n\t\treturn data;\r\n\r\n\t};\r\n\r\n\tCubicBezierCurve.prototype.fromJSON = function ( json ) {\r\n\r\n\t\tCurve.prototype.fromJSON.call( this, json );\r\n\r\n\t\tthis.v0.fromArray( json.v0 );\r\n\t\tthis.v1.fromArray( json.v1 );\r\n\t\tthis.v2.fromArray( json.v2 );\r\n\t\tthis.v3.fromArray( json.v3 );\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction CubicBezierCurve3( v0, v1, v2, v3 ) {\r\n\r\n\t\tCurve.call( this );\r\n\r\n\t\tthis.type = 'CubicBezierCurve3';\r\n\r\n\t\tthis.v0 = v0 || new Vector3();\r\n\t\tthis.v1 = v1 || new Vector3();\r\n\t\tthis.v2 = v2 || new Vector3();\r\n\t\tthis.v3 = v3 || new Vector3();\r\n\r\n\t}\r\n\r\n\tCubicBezierCurve3.prototype = Object.create( Curve.prototype );\r\n\tCubicBezierCurve3.prototype.constructor = CubicBezierCurve3;\r\n\r\n\tCubicBezierCurve3.prototype.isCubicBezierCurve3 = true;\r\n\r\n\tCubicBezierCurve3.prototype.getPoint = function ( t, optionalTarget ) {\r\n\r\n\t\tvar point = optionalTarget || new Vector3();\r\n\r\n\t\tvar v0 = this.v0, v1 = this.v1, v2 = this.v2, v3 = this.v3;\r\n\r\n\t\tpoint.set(\r\n\t\t\tCubicBezier( t, v0.x, v1.x, v2.x, v3.x ),\r\n\t\t\tCubicBezier( t, v0.y, v1.y, v2.y, v3.y ),\r\n\t\t\tCubicBezier( t, v0.z, v1.z, v2.z, v3.z )\r\n\t\t);\r\n\r\n\t\treturn point;\r\n\r\n\t};\r\n\r\n\tCubicBezierCurve3.prototype.copy = function ( source ) {\r\n\r\n\t\tCurve.prototype.copy.call( this, source );\r\n\r\n\t\tthis.v0.copy( source.v0 );\r\n\t\tthis.v1.copy( source.v1 );\r\n\t\tthis.v2.copy( source.v2 );\r\n\t\tthis.v3.copy( source.v3 );\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tCubicBezierCurve3.prototype.toJSON = function () {\r\n\r\n\t\tvar data = Curve.prototype.toJSON.call( this );\r\n\r\n\t\tdata.v0 = this.v0.toArray();\r\n\t\tdata.v1 = this.v1.toArray();\r\n\t\tdata.v2 = this.v2.toArray();\r\n\t\tdata.v3 = this.v3.toArray();\r\n\r\n\t\treturn data;\r\n\r\n\t};\r\n\r\n\tCubicBezierCurve3.prototype.fromJSON = function ( json ) {\r\n\r\n\t\tCurve.prototype.fromJSON.call( this, json );\r\n\r\n\t\tthis.v0.fromArray( json.v0 );\r\n\t\tthis.v1.fromArray( json.v1 );\r\n\t\tthis.v2.fromArray( json.v2 );\r\n\t\tthis.v3.fromArray( json.v3 );\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction LineCurve( v1, v2 ) {\r\n\r\n\t\tCurve.call( this );\r\n\r\n\t\tthis.type = 'LineCurve';\r\n\r\n\t\tthis.v1 = v1 || new Vector2();\r\n\t\tthis.v2 = v2 || new Vector2();\r\n\r\n\t}\r\n\r\n\tLineCurve.prototype = Object.create( Curve.prototype );\r\n\tLineCurve.prototype.constructor = LineCurve;\r\n\r\n\tLineCurve.prototype.isLineCurve = true;\r\n\r\n\tLineCurve.prototype.getPoint = function ( t, optionalTarget ) {\r\n\r\n\t\tvar point = optionalTarget || new Vector2();\r\n\r\n\t\tif ( t === 1 ) {\r\n\r\n\t\t\tpoint.copy( this.v2 );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tpoint.copy( this.v2 ).sub( this.v1 );\r\n\t\t\tpoint.multiplyScalar( t ).add( this.v1 );\r\n\r\n\t\t}\r\n\r\n\t\treturn point;\r\n\r\n\t};\r\n\r\n\t// Line curve is linear, so we can overwrite default getPointAt\r\n\r\n\tLineCurve.prototype.getPointAt = function ( u, optionalTarget ) {\r\n\r\n\t\treturn this.getPoint( u, optionalTarget );\r\n\r\n\t};\r\n\r\n\tLineCurve.prototype.getTangent = function ( /* t */ ) {\r\n\r\n\t\tvar tangent = this.v2.clone().sub( this.v1 );\r\n\r\n\t\treturn tangent.normalize();\r\n\r\n\t};\r\n\r\n\tLineCurve.prototype.copy = function ( source ) {\r\n\r\n\t\tCurve.prototype.copy.call( this, source );\r\n\r\n\t\tthis.v1.copy( source.v1 );\r\n\t\tthis.v2.copy( source.v2 );\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tLineCurve.prototype.toJSON = function () {\r\n\r\n\t\tvar data = Curve.prototype.toJSON.call( this );\r\n\r\n\t\tdata.v1 = this.v1.toArray();\r\n\t\tdata.v2 = this.v2.toArray();\r\n\r\n\t\treturn data;\r\n\r\n\t};\r\n\r\n\tLineCurve.prototype.fromJSON = function ( json ) {\r\n\r\n\t\tCurve.prototype.fromJSON.call( this, json );\r\n\r\n\t\tthis.v1.fromArray( json.v1 );\r\n\t\tthis.v2.fromArray( json.v2 );\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction LineCurve3( v1, v2 ) {\r\n\r\n\t\tCurve.call( this );\r\n\r\n\t\tthis.type = 'LineCurve3';\r\n\r\n\t\tthis.v1 = v1 || new Vector3();\r\n\t\tthis.v2 = v2 || new Vector3();\r\n\r\n\t}\r\n\r\n\tLineCurve3.prototype = Object.create( Curve.prototype );\r\n\tLineCurve3.prototype.constructor = LineCurve3;\r\n\r\n\tLineCurve3.prototype.isLineCurve3 = true;\r\n\r\n\tLineCurve3.prototype.getPoint = function ( t, optionalTarget ) {\r\n\r\n\t\tvar point = optionalTarget || new Vector3();\r\n\r\n\t\tif ( t === 1 ) {\r\n\r\n\t\t\tpoint.copy( this.v2 );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tpoint.copy( this.v2 ).sub( this.v1 );\r\n\t\t\tpoint.multiplyScalar( t ).add( this.v1 );\r\n\r\n\t\t}\r\n\r\n\t\treturn point;\r\n\r\n\t};\r\n\r\n\t// Line curve is linear, so we can overwrite default getPointAt\r\n\r\n\tLineCurve3.prototype.getPointAt = function ( u, optionalTarget ) {\r\n\r\n\t\treturn this.getPoint( u, optionalTarget );\r\n\r\n\t};\r\n\r\n\tLineCurve3.prototype.copy = function ( source ) {\r\n\r\n\t\tCurve.prototype.copy.call( this, source );\r\n\r\n\t\tthis.v1.copy( source.v1 );\r\n\t\tthis.v2.copy( source.v2 );\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tLineCurve3.prototype.toJSON = function () {\r\n\r\n\t\tvar data = Curve.prototype.toJSON.call( this );\r\n\r\n\t\tdata.v1 = this.v1.toArray();\r\n\t\tdata.v2 = this.v2.toArray();\r\n\r\n\t\treturn data;\r\n\r\n\t};\r\n\r\n\tLineCurve3.prototype.fromJSON = function ( json ) {\r\n\r\n\t\tCurve.prototype.fromJSON.call( this, json );\r\n\r\n\t\tthis.v1.fromArray( json.v1 );\r\n\t\tthis.v2.fromArray( json.v2 );\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction QuadraticBezierCurve( v0, v1, v2 ) {\r\n\r\n\t\tCurve.call( this );\r\n\r\n\t\tthis.type = 'QuadraticBezierCurve';\r\n\r\n\t\tthis.v0 = v0 || new Vector2();\r\n\t\tthis.v1 = v1 || new Vector2();\r\n\t\tthis.v2 = v2 || new Vector2();\r\n\r\n\t}\r\n\r\n\tQuadraticBezierCurve.prototype = Object.create( Curve.prototype );\r\n\tQuadraticBezierCurve.prototype.constructor = QuadraticBezierCurve;\r\n\r\n\tQuadraticBezierCurve.prototype.isQuadraticBezierCurve = true;\r\n\r\n\tQuadraticBezierCurve.prototype.getPoint = function ( t, optionalTarget ) {\r\n\r\n\t\tvar point = optionalTarget || new Vector2();\r\n\r\n\t\tvar v0 = this.v0, v1 = this.v1, v2 = this.v2;\r\n\r\n\t\tpoint.set(\r\n\t\t\tQuadraticBezier( t, v0.x, v1.x, v2.x ),\r\n\t\t\tQuadraticBezier( t, v0.y, v1.y, v2.y )\r\n\t\t);\r\n\r\n\t\treturn point;\r\n\r\n\t};\r\n\r\n\tQuadraticBezierCurve.prototype.copy = function ( source ) {\r\n\r\n\t\tCurve.prototype.copy.call( this, source );\r\n\r\n\t\tthis.v0.copy( source.v0 );\r\n\t\tthis.v1.copy( source.v1 );\r\n\t\tthis.v2.copy( source.v2 );\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tQuadraticBezierCurve.prototype.toJSON = function () {\r\n\r\n\t\tvar data = Curve.prototype.toJSON.call( this );\r\n\r\n\t\tdata.v0 = this.v0.toArray();\r\n\t\tdata.v1 = this.v1.toArray();\r\n\t\tdata.v2 = this.v2.toArray();\r\n\r\n\t\treturn data;\r\n\r\n\t};\r\n\r\n\tQuadraticBezierCurve.prototype.fromJSON = function ( json ) {\r\n\r\n\t\tCurve.prototype.fromJSON.call( this, json );\r\n\r\n\t\tthis.v0.fromArray( json.v0 );\r\n\t\tthis.v1.fromArray( json.v1 );\r\n\t\tthis.v2.fromArray( json.v2 );\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction QuadraticBezierCurve3( v0, v1, v2 ) {\r\n\r\n\t\tCurve.call( this );\r\n\r\n\t\tthis.type = 'QuadraticBezierCurve3';\r\n\r\n\t\tthis.v0 = v0 || new Vector3();\r\n\t\tthis.v1 = v1 || new Vector3();\r\n\t\tthis.v2 = v2 || new Vector3();\r\n\r\n\t}\r\n\r\n\tQuadraticBezierCurve3.prototype = Object.create( Curve.prototype );\r\n\tQuadraticBezierCurve3.prototype.constructor = QuadraticBezierCurve3;\r\n\r\n\tQuadraticBezierCurve3.prototype.isQuadraticBezierCurve3 = true;\r\n\r\n\tQuadraticBezierCurve3.prototype.getPoint = function ( t, optionalTarget ) {\r\n\r\n\t\tvar point = optionalTarget || new Vector3();\r\n\r\n\t\tvar v0 = this.v0, v1 = this.v1, v2 = this.v2;\r\n\r\n\t\tpoint.set(\r\n\t\t\tQuadraticBezier( t, v0.x, v1.x, v2.x ),\r\n\t\t\tQuadraticBezier( t, v0.y, v1.y, v2.y ),\r\n\t\t\tQuadraticBezier( t, v0.z, v1.z, v2.z )\r\n\t\t);\r\n\r\n\t\treturn point;\r\n\r\n\t};\r\n\r\n\tQuadraticBezierCurve3.prototype.copy = function ( source ) {\r\n\r\n\t\tCurve.prototype.copy.call( this, source );\r\n\r\n\t\tthis.v0.copy( source.v0 );\r\n\t\tthis.v1.copy( source.v1 );\r\n\t\tthis.v2.copy( source.v2 );\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tQuadraticBezierCurve3.prototype.toJSON = function () {\r\n\r\n\t\tvar data = Curve.prototype.toJSON.call( this );\r\n\r\n\t\tdata.v0 = this.v0.toArray();\r\n\t\tdata.v1 = this.v1.toArray();\r\n\t\tdata.v2 = this.v2.toArray();\r\n\r\n\t\treturn data;\r\n\r\n\t};\r\n\r\n\tQuadraticBezierCurve3.prototype.fromJSON = function ( json ) {\r\n\r\n\t\tCurve.prototype.fromJSON.call( this, json );\r\n\r\n\t\tthis.v0.fromArray( json.v0 );\r\n\t\tthis.v1.fromArray( json.v1 );\r\n\t\tthis.v2.fromArray( json.v2 );\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction SplineCurve( points /* array of Vector2 */ ) {\r\n\r\n\t\tCurve.call( this );\r\n\r\n\t\tthis.type = 'SplineCurve';\r\n\r\n\t\tthis.points = points || [];\r\n\r\n\t}\r\n\r\n\tSplineCurve.prototype = Object.create( Curve.prototype );\r\n\tSplineCurve.prototype.constructor = SplineCurve;\r\n\r\n\tSplineCurve.prototype.isSplineCurve = true;\r\n\r\n\tSplineCurve.prototype.getPoint = function ( t, optionalTarget ) {\r\n\r\n\t\tvar point = optionalTarget || new Vector2();\r\n\r\n\t\tvar points = this.points;\r\n\t\tvar p = ( points.length - 1 ) * t;\r\n\r\n\t\tvar intPoint = Math.floor( p );\r\n\t\tvar weight = p - intPoint;\r\n\r\n\t\tvar p0 = points[ intPoint === 0 ? intPoint : intPoint - 1 ];\r\n\t\tvar p1 = points[ intPoint ];\r\n\t\tvar p2 = points[ intPoint > points.length - 2 ? points.length - 1 : intPoint + 1 ];\r\n\t\tvar p3 = points[ intPoint > points.length - 3 ? points.length - 1 : intPoint + 2 ];\r\n\r\n\t\tpoint.set(\r\n\t\t\tCatmullRom( weight, p0.x, p1.x, p2.x, p3.x ),\r\n\t\t\tCatmullRom( weight, p0.y, p1.y, p2.y, p3.y )\r\n\t\t);\r\n\r\n\t\treturn point;\r\n\r\n\t};\r\n\r\n\tSplineCurve.prototype.copy = function ( source ) {\r\n\r\n\t\tCurve.prototype.copy.call( this, source );\r\n\r\n\t\tthis.points = [];\r\n\r\n\t\tfor ( var i = 0, l = source.points.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar point = source.points[ i ];\r\n\r\n\t\t\tthis.points.push( point.clone() );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tSplineCurve.prototype.toJSON = function () {\r\n\r\n\t\tvar data = Curve.prototype.toJSON.call( this );\r\n\r\n\t\tdata.points = [];\r\n\r\n\t\tfor ( var i = 0, l = this.points.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar point = this.points[ i ];\r\n\t\t\tdata.points.push( point.toArray() );\r\n\r\n\t\t}\r\n\r\n\t\treturn data;\r\n\r\n\t};\r\n\r\n\tSplineCurve.prototype.fromJSON = function ( json ) {\r\n\r\n\t\tCurve.prototype.fromJSON.call( this, json );\r\n\r\n\t\tthis.points = [];\r\n\r\n\t\tfor ( var i = 0, l = json.points.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar point = json.points[ i ];\r\n\t\t\tthis.points.push( new Vector2().fromArray( point ) );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\r\n\r\n\tvar Curves = /*#__PURE__*/Object.freeze({\r\n\t\tArcCurve: ArcCurve,\r\n\t\tCatmullRomCurve3: CatmullRomCurve3,\r\n\t\tCubicBezierCurve: CubicBezierCurve,\r\n\t\tCubicBezierCurve3: CubicBezierCurve3,\r\n\t\tEllipseCurve: EllipseCurve,\r\n\t\tLineCurve: LineCurve,\r\n\t\tLineCurve3: LineCurve3,\r\n\t\tQuadraticBezierCurve: QuadraticBezierCurve,\r\n\t\tQuadraticBezierCurve3: QuadraticBezierCurve3,\r\n\t\tSplineCurve: SplineCurve\r\n\t});\r\n\r\n\t/**\r\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\r\n\t *\r\n\t **/\r\n\r\n\t/**************************************************************\r\n\t *\tCurved Path - a curve path is simply a array of connected\r\n\t *  curves, but retains the api of a curve\r\n\t **************************************************************/\r\n\r\n\tfunction CurvePath() {\r\n\r\n\t\tCurve.call( this );\r\n\r\n\t\tthis.type = 'CurvePath';\r\n\r\n\t\tthis.curves = [];\r\n\t\tthis.autoClose = false; // Automatically closes the path\r\n\r\n\t}\r\n\r\n\tCurvePath.prototype = Object.assign( Object.create( Curve.prototype ), {\r\n\r\n\t\tconstructor: CurvePath,\r\n\r\n\t\tadd: function ( curve ) {\r\n\r\n\t\t\tthis.curves.push( curve );\r\n\r\n\t\t},\r\n\r\n\t\tclosePath: function () {\r\n\r\n\t\t\t// Add a line curve if start and end of lines are not connected\r\n\t\t\tvar startPoint = this.curves[ 0 ].getPoint( 0 );\r\n\t\t\tvar endPoint = this.curves[ this.curves.length - 1 ].getPoint( 1 );\r\n\r\n\t\t\tif ( ! startPoint.equals( endPoint ) ) {\r\n\r\n\t\t\t\tthis.curves.push( new LineCurve( endPoint, startPoint ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t// To get accurate point with reference to\r\n\t\t// entire path distance at time t,\r\n\t\t// following has to be done:\r\n\r\n\t\t// 1. Length of each sub path have to be known\r\n\t\t// 2. Locate and identify type of curve\r\n\t\t// 3. Get t for the curve\r\n\t\t// 4. Return curve.getPointAt(t')\r\n\r\n\t\tgetPoint: function ( t ) {\r\n\r\n\t\t\tvar d = t * this.getLength();\r\n\t\t\tvar curveLengths = this.getCurveLengths();\r\n\t\t\tvar i = 0;\r\n\r\n\t\t\t// To think about boundaries points.\r\n\r\n\t\t\twhile ( i < curveLengths.length ) {\r\n\r\n\t\t\t\tif ( curveLengths[ i ] >= d ) {\r\n\r\n\t\t\t\t\tvar diff = curveLengths[ i ] - d;\r\n\t\t\t\t\tvar curve = this.curves[ i ];\r\n\r\n\t\t\t\t\tvar segmentLength = curve.getLength();\r\n\t\t\t\t\tvar u = segmentLength === 0 ? 0 : 1 - diff / segmentLength;\r\n\r\n\t\t\t\t\treturn curve.getPointAt( u );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ti ++;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn null;\r\n\r\n\t\t\t// loop where sum != 0, sum > d , sum+1 <d\r\n\r\n\t\t},\r\n\r\n\t\t// We cannot use the default THREE.Curve getPoint() with getLength() because in\r\n\t\t// THREE.Curve, getLength() depends on getPoint() but in THREE.CurvePath\r\n\t\t// getPoint() depends on getLength\r\n\r\n\t\tgetLength: function () {\r\n\r\n\t\t\tvar lens = this.getCurveLengths();\r\n\t\t\treturn lens[ lens.length - 1 ];\r\n\r\n\t\t},\r\n\r\n\t\t// cacheLengths must be recalculated.\r\n\t\tupdateArcLengths: function () {\r\n\r\n\t\t\tthis.needsUpdate = true;\r\n\t\t\tthis.cacheLengths = null;\r\n\t\t\tthis.getCurveLengths();\r\n\r\n\t\t},\r\n\r\n\t\t// Compute lengths and cache them\r\n\t\t// We cannot overwrite getLengths() because UtoT mapping uses it.\r\n\r\n\t\tgetCurveLengths: function () {\r\n\r\n\t\t\t// We use cache values if curves and cache array are same length\r\n\r\n\t\t\tif ( this.cacheLengths && this.cacheLengths.length === this.curves.length ) {\r\n\r\n\t\t\t\treturn this.cacheLengths;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Get length of sub-curve\r\n\t\t\t// Push sums into cached array\r\n\r\n\t\t\tvar lengths = [], sums = 0;\r\n\r\n\t\t\tfor ( var i = 0, l = this.curves.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tsums += this.curves[ i ].getLength();\r\n\t\t\t\tlengths.push( sums );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.cacheLengths = lengths;\r\n\r\n\t\t\treturn lengths;\r\n\r\n\t\t},\r\n\r\n\t\tgetSpacedPoints: function ( divisions ) {\r\n\r\n\t\t\tif ( divisions === undefined ) divisions = 40;\r\n\r\n\t\t\tvar points = [];\r\n\r\n\t\t\tfor ( var i = 0; i <= divisions; i ++ ) {\r\n\r\n\t\t\t\tpoints.push( this.getPoint( i / divisions ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.autoClose ) {\r\n\r\n\t\t\t\tpoints.push( points[ 0 ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn points;\r\n\r\n\t\t},\r\n\r\n\t\tgetPoints: function ( divisions ) {\r\n\r\n\t\t\tdivisions = divisions || 12;\r\n\r\n\t\t\tvar points = [], last;\r\n\r\n\t\t\tfor ( var i = 0, curves = this.curves; i < curves.length; i ++ ) {\r\n\r\n\t\t\t\tvar curve = curves[ i ];\r\n\t\t\t\tvar resolution = ( curve && curve.isEllipseCurve ) ? divisions * 2\r\n\t\t\t\t\t: ( curve && ( curve.isLineCurve || curve.isLineCurve3 ) ) ? 1\r\n\t\t\t\t\t\t: ( curve && curve.isSplineCurve ) ? divisions * curve.points.length\r\n\t\t\t\t\t\t\t: divisions;\r\n\r\n\t\t\t\tvar pts = curve.getPoints( resolution );\r\n\r\n\t\t\t\tfor ( var j = 0; j < pts.length; j ++ ) {\r\n\r\n\t\t\t\t\tvar point = pts[ j ];\r\n\r\n\t\t\t\t\tif ( last && last.equals( point ) ) continue; // ensures no consecutive points are duplicates\r\n\r\n\t\t\t\t\tpoints.push( point );\r\n\t\t\t\t\tlast = point;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.autoClose && points.length > 1 && ! points[ points.length - 1 ].equals( points[ 0 ] ) ) {\r\n\r\n\t\t\t\tpoints.push( points[ 0 ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn points;\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tCurve.prototype.copy.call( this, source );\r\n\r\n\t\t\tthis.curves = [];\r\n\r\n\t\t\tfor ( var i = 0, l = source.curves.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar curve = source.curves[ i ];\r\n\r\n\t\t\t\tthis.curves.push( curve.clone() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.autoClose = source.autoClose;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function () {\r\n\r\n\t\t\tvar data = Curve.prototype.toJSON.call( this );\r\n\r\n\t\t\tdata.autoClose = this.autoClose;\r\n\t\t\tdata.curves = [];\r\n\r\n\t\t\tfor ( var i = 0, l = this.curves.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar curve = this.curves[ i ];\r\n\t\t\t\tdata.curves.push( curve.toJSON() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t},\r\n\r\n\t\tfromJSON: function ( json ) {\r\n\r\n\t\t\tCurve.prototype.fromJSON.call( this, json );\r\n\r\n\t\t\tthis.autoClose = json.autoClose;\r\n\t\t\tthis.curves = [];\r\n\r\n\t\t\tfor ( var i = 0, l = json.curves.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar curve = json.curves[ i ];\r\n\t\t\t\tthis.curves.push( new Curves[ curve.type ]().fromJSON( curve ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\r\n\t * Creates free form 2d path using series of points, lines or curves.\r\n\t **/\r\n\r\n\tfunction Path( points ) {\r\n\r\n\t\tCurvePath.call( this );\r\n\r\n\t\tthis.type = 'Path';\r\n\r\n\t\tthis.currentPoint = new Vector2();\r\n\r\n\t\tif ( points ) {\r\n\r\n\t\t\tthis.setFromPoints( points );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tPath.prototype = Object.assign( Object.create( CurvePath.prototype ), {\r\n\r\n\t\tconstructor: Path,\r\n\r\n\t\tsetFromPoints: function ( points ) {\r\n\r\n\t\t\tthis.moveTo( points[ 0 ].x, points[ 0 ].y );\r\n\r\n\t\t\tfor ( var i = 1, l = points.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tthis.lineTo( points[ i ].x, points[ i ].y );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tmoveTo: function ( x, y ) {\r\n\r\n\t\t\tthis.currentPoint.set( x, y ); // TODO consider referencing vectors instead of copying?\r\n\r\n\t\t},\r\n\r\n\t\tlineTo: function ( x, y ) {\r\n\r\n\t\t\tvar curve = new LineCurve( this.currentPoint.clone(), new Vector2( x, y ) );\r\n\t\t\tthis.curves.push( curve );\r\n\r\n\t\t\tthis.currentPoint.set( x, y );\r\n\r\n\t\t},\r\n\r\n\t\tquadraticCurveTo: function ( aCPx, aCPy, aX, aY ) {\r\n\r\n\t\t\tvar curve = new QuadraticBezierCurve(\r\n\t\t\t\tthis.currentPoint.clone(),\r\n\t\t\t\tnew Vector2( aCPx, aCPy ),\r\n\t\t\t\tnew Vector2( aX, aY )\r\n\t\t\t);\r\n\r\n\t\t\tthis.curves.push( curve );\r\n\r\n\t\t\tthis.currentPoint.set( aX, aY );\r\n\r\n\t\t},\r\n\r\n\t\tbezierCurveTo: function ( aCP1x, aCP1y, aCP2x, aCP2y, aX, aY ) {\r\n\r\n\t\t\tvar curve = new CubicBezierCurve(\r\n\t\t\t\tthis.currentPoint.clone(),\r\n\t\t\t\tnew Vector2( aCP1x, aCP1y ),\r\n\t\t\t\tnew Vector2( aCP2x, aCP2y ),\r\n\t\t\t\tnew Vector2( aX, aY )\r\n\t\t\t);\r\n\r\n\t\t\tthis.curves.push( curve );\r\n\r\n\t\t\tthis.currentPoint.set( aX, aY );\r\n\r\n\t\t},\r\n\r\n\t\tsplineThru: function ( pts /*Array of Vector*/ ) {\r\n\r\n\t\t\tvar npts = [ this.currentPoint.clone() ].concat( pts );\r\n\r\n\t\t\tvar curve = new SplineCurve( npts );\r\n\t\t\tthis.curves.push( curve );\r\n\r\n\t\t\tthis.currentPoint.copy( pts[ pts.length - 1 ] );\r\n\r\n\t\t},\r\n\r\n\t\tarc: function ( aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise ) {\r\n\r\n\t\t\tvar x0 = this.currentPoint.x;\r\n\t\t\tvar y0 = this.currentPoint.y;\r\n\r\n\t\t\tthis.absarc( aX + x0, aY + y0, aRadius,\r\n\t\t\t\taStartAngle, aEndAngle, aClockwise );\r\n\r\n\t\t},\r\n\r\n\t\tabsarc: function ( aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise ) {\r\n\r\n\t\t\tthis.absellipse( aX, aY, aRadius, aRadius, aStartAngle, aEndAngle, aClockwise );\r\n\r\n\t\t},\r\n\r\n\t\tellipse: function ( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation ) {\r\n\r\n\t\t\tvar x0 = this.currentPoint.x;\r\n\t\t\tvar y0 = this.currentPoint.y;\r\n\r\n\t\t\tthis.absellipse( aX + x0, aY + y0, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation );\r\n\r\n\t\t},\r\n\r\n\t\tabsellipse: function ( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation ) {\r\n\r\n\t\t\tvar curve = new EllipseCurve( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation );\r\n\r\n\t\t\tif ( this.curves.length > 0 ) {\r\n\r\n\t\t\t\t// if a previous curve is present, attempt to join\r\n\t\t\t\tvar firstPoint = curve.getPoint( 0 );\r\n\r\n\t\t\t\tif ( ! firstPoint.equals( this.currentPoint ) ) {\r\n\r\n\t\t\t\t\tthis.lineTo( firstPoint.x, firstPoint.y );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.curves.push( curve );\r\n\r\n\t\t\tvar lastPoint = curve.getPoint( 1 );\r\n\t\t\tthis.currentPoint.copy( lastPoint );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tCurvePath.prototype.copy.call( this, source );\r\n\r\n\t\t\tthis.currentPoint.copy( source.currentPoint );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function () {\r\n\r\n\t\t\tvar data = CurvePath.prototype.toJSON.call( this );\r\n\r\n\t\t\tdata.currentPoint = this.currentPoint.toArray();\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t},\r\n\r\n\t\tfromJSON: function ( json ) {\r\n\r\n\t\t\tCurvePath.prototype.fromJSON.call( this, json );\r\n\r\n\t\t\tthis.currentPoint.fromArray( json.currentPoint );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\r\n\t * Defines a 2d shape plane using paths.\r\n\t **/\r\n\r\n\t// STEP 1 Create a path.\r\n\t// STEP 2 Turn path into shape.\r\n\t// STEP 3 ExtrudeGeometry takes in Shape/Shapes\r\n\t// STEP 3a - Extract points from each shape, turn to vertices\r\n\t// STEP 3b - Triangulate each shape, add faces.\r\n\r\n\tfunction Shape( points ) {\r\n\r\n\t\tPath.call( this, points );\r\n\r\n\t\tthis.uuid = _Math.generateUUID();\r\n\r\n\t\tthis.type = 'Shape';\r\n\r\n\t\tthis.holes = [];\r\n\r\n\t}\r\n\r\n\tShape.prototype = Object.assign( Object.create( Path.prototype ), {\r\n\r\n\t\tconstructor: Shape,\r\n\r\n\t\tgetPointsHoles: function ( divisions ) {\r\n\r\n\t\t\tvar holesPts = [];\r\n\r\n\t\t\tfor ( var i = 0, l = this.holes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tholesPts[ i ] = this.holes[ i ].getPoints( divisions );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn holesPts;\r\n\r\n\t\t},\r\n\r\n\t\t// get points of shape and holes (keypoints based on segments parameter)\r\n\r\n\t\textractPoints: function ( divisions ) {\r\n\r\n\t\t\treturn {\r\n\r\n\t\t\t\tshape: this.getPoints( divisions ),\r\n\t\t\t\tholes: this.getPointsHoles( divisions )\r\n\r\n\t\t\t};\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tPath.prototype.copy.call( this, source );\r\n\r\n\t\t\tthis.holes = [];\r\n\r\n\t\t\tfor ( var i = 0, l = source.holes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar hole = source.holes[ i ];\r\n\r\n\t\t\t\tthis.holes.push( hole.clone() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function () {\r\n\r\n\t\t\tvar data = Path.prototype.toJSON.call( this );\r\n\r\n\t\t\tdata.uuid = this.uuid;\r\n\t\t\tdata.holes = [];\r\n\r\n\t\t\tfor ( var i = 0, l = this.holes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar hole = this.holes[ i ];\r\n\t\t\t\tdata.holes.push( hole.toJSON() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t},\r\n\r\n\t\tfromJSON: function ( json ) {\r\n\r\n\t\t\tPath.prototype.fromJSON.call( this, json );\r\n\r\n\t\t\tthis.uuid = json.uuid;\r\n\t\t\tthis.holes = [];\r\n\r\n\t\t\tfor ( var i = 0, l = json.holes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar hole = json.holes[ i ];\r\n\t\t\t\tthis.holes.push( new Path().fromJSON( hole ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\r\n\tfunction Light( color, intensity ) {\r\n\r\n\t\tObject3D.call( this );\r\n\r\n\t\tthis.type = 'Light';\r\n\r\n\t\tthis.color = new Color( color );\r\n\t\tthis.intensity = intensity !== undefined ? intensity : 1;\r\n\r\n\t\tthis.receiveShadow = undefined;\r\n\r\n\t}\r\n\r\n\tLight.prototype = Object.assign( Object.create( Object3D.prototype ), {\r\n\r\n\t\tconstructor: Light,\r\n\r\n\t\tisLight: true,\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tObject3D.prototype.copy.call( this, source );\r\n\r\n\t\t\tthis.color.copy( source.color );\r\n\t\t\tthis.intensity = source.intensity;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function ( meta ) {\r\n\r\n\t\t\tvar data = Object3D.prototype.toJSON.call( this, meta );\r\n\r\n\t\t\tdata.object.color = this.color.getHex();\r\n\t\t\tdata.object.intensity = this.intensity;\r\n\r\n\t\t\tif ( this.groundColor !== undefined ) data.object.groundColor = this.groundColor.getHex();\r\n\r\n\t\t\tif ( this.distance !== undefined ) data.object.distance = this.distance;\r\n\t\t\tif ( this.angle !== undefined ) data.object.angle = this.angle;\r\n\t\t\tif ( this.decay !== undefined ) data.object.decay = this.decay;\r\n\t\t\tif ( this.penumbra !== undefined ) data.object.penumbra = this.penumbra;\r\n\r\n\t\t\tif ( this.shadow !== undefined ) data.object.shadow = this.shadow.toJSON();\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\r\n\tfunction HemisphereLight( skyColor, groundColor, intensity ) {\r\n\r\n\t\tLight.call( this, skyColor, intensity );\r\n\r\n\t\tthis.type = 'HemisphereLight';\r\n\r\n\t\tthis.castShadow = undefined;\r\n\r\n\t\tthis.position.copy( Object3D.DefaultUp );\r\n\t\tthis.updateMatrix();\r\n\r\n\t\tthis.groundColor = new Color( groundColor );\r\n\r\n\t}\r\n\r\n\tHemisphereLight.prototype = Object.assign( Object.create( Light.prototype ), {\r\n\r\n\t\tconstructor: HemisphereLight,\r\n\r\n\t\tisHemisphereLight: true,\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tLight.prototype.copy.call( this, source );\r\n\r\n\t\t\tthis.groundColor.copy( source.groundColor );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction LightShadow( camera ) {\r\n\r\n\t\tthis.camera = camera;\r\n\r\n\t\tthis.bias = 0;\r\n\t\tthis.radius = 1;\r\n\r\n\t\tthis.mapSize = new Vector2( 512, 512 );\r\n\r\n\t\tthis.map = null;\r\n\t\tthis.matrix = new Matrix4();\r\n\r\n\t}\r\n\r\n\tObject.assign( LightShadow.prototype, {\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tthis.camera = source.camera.clone();\r\n\r\n\t\t\tthis.bias = source.bias;\r\n\t\t\tthis.radius = source.radius;\r\n\r\n\t\t\tthis.mapSize.copy( source.mapSize );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function () {\r\n\r\n\t\t\tvar object = {};\r\n\r\n\t\t\tif ( this.bias !== 0 ) object.bias = this.bias;\r\n\t\t\tif ( this.radius !== 1 ) object.radius = this.radius;\r\n\t\t\tif ( this.mapSize.x !== 512 || this.mapSize.y !== 512 ) object.mapSize = this.mapSize.toArray();\r\n\r\n\t\t\tobject.camera = this.camera.toJSON( false ).object;\r\n\t\t\tdelete object.camera.matrix;\r\n\r\n\t\t\treturn object;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction SpotLightShadow() {\r\n\r\n\t\tLightShadow.call( this, new PerspectiveCamera( 50, 1, 0.5, 500 ) );\r\n\r\n\t}\r\n\r\n\tSpotLightShadow.prototype = Object.assign( Object.create( LightShadow.prototype ), {\r\n\r\n\t\tconstructor: SpotLightShadow,\r\n\r\n\t\tisSpotLightShadow: true,\r\n\r\n\t\tupdate: function ( light ) {\r\n\r\n\t\t\tvar camera = this.camera;\r\n\r\n\t\t\tvar fov = _Math.RAD2DEG * 2 * light.angle;\r\n\t\t\tvar aspect = this.mapSize.width / this.mapSize.height;\r\n\t\t\tvar far = light.distance || camera.far;\r\n\r\n\t\t\tif ( fov !== camera.fov || aspect !== camera.aspect || far !== camera.far ) {\r\n\r\n\t\t\t\tcamera.fov = fov;\r\n\t\t\t\tcamera.aspect = aspect;\r\n\t\t\t\tcamera.far = far;\r\n\t\t\t\tcamera.updateProjectionMatrix();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\r\n\tfunction SpotLight( color, intensity, distance, angle, penumbra, decay ) {\r\n\r\n\t\tLight.call( this, color, intensity );\r\n\r\n\t\tthis.type = 'SpotLight';\r\n\r\n\t\tthis.position.copy( Object3D.DefaultUp );\r\n\t\tthis.updateMatrix();\r\n\r\n\t\tthis.target = new Object3D();\r\n\r\n\t\tObject.defineProperty( this, 'power', {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\t// intensity = power per solid angle.\r\n\t\t\t\t// ref: equation (17) from https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\r\n\t\t\t\treturn this.intensity * Math.PI;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( power ) {\r\n\r\n\t\t\t\t// intensity = power per solid angle.\r\n\t\t\t\t// ref: equation (17) from https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\r\n\t\t\t\tthis.intensity = power / Math.PI;\r\n\r\n\t\t\t}\r\n\t\t} );\r\n\r\n\t\tthis.distance = ( distance !== undefined ) ? distance : 0;\r\n\t\tthis.angle = ( angle !== undefined ) ? angle : Math.PI / 3;\r\n\t\tthis.penumbra = ( penumbra !== undefined ) ? penumbra : 0;\r\n\t\tthis.decay = ( decay !== undefined ) ? decay : 1;\t// for physically correct lights, should be 2.\r\n\r\n\t\tthis.shadow = new SpotLightShadow();\r\n\r\n\t}\r\n\r\n\tSpotLight.prototype = Object.assign( Object.create( Light.prototype ), {\r\n\r\n\t\tconstructor: SpotLight,\r\n\r\n\t\tisSpotLight: true,\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tLight.prototype.copy.call( this, source );\r\n\r\n\t\t\tthis.distance = source.distance;\r\n\t\t\tthis.angle = source.angle;\r\n\t\t\tthis.penumbra = source.penumbra;\r\n\t\t\tthis.decay = source.decay;\r\n\r\n\t\t\tthis.target = source.target.clone();\r\n\r\n\t\t\tthis.shadow = source.shadow.clone();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\r\n\tfunction PointLight( color, intensity, distance, decay ) {\r\n\r\n\t\tLight.call( this, color, intensity );\r\n\r\n\t\tthis.type = 'PointLight';\r\n\r\n\t\tObject.defineProperty( this, 'power', {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\t// intensity = power per solid angle.\r\n\t\t\t\t// ref: equation (15) from https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\r\n\t\t\t\treturn this.intensity * 4 * Math.PI;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( power ) {\r\n\r\n\t\t\t\t// intensity = power per solid angle.\r\n\t\t\t\t// ref: equation (15) from https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\r\n\t\t\t\tthis.intensity = power / ( 4 * Math.PI );\r\n\r\n\t\t\t}\r\n\t\t} );\r\n\r\n\t\tthis.distance = ( distance !== undefined ) ? distance : 0;\r\n\t\tthis.decay = ( decay !== undefined ) ? decay : 1;\t// for physically correct lights, should be 2.\r\n\r\n\t\tthis.shadow = new LightShadow( new PerspectiveCamera( 90, 1, 0.5, 500 ) );\r\n\r\n\t}\r\n\r\n\tPointLight.prototype = Object.assign( Object.create( Light.prototype ), {\r\n\r\n\t\tconstructor: PointLight,\r\n\r\n\t\tisPointLight: true,\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tLight.prototype.copy.call( this, source );\r\n\r\n\t\t\tthis.distance = source.distance;\r\n\t\t\tthis.decay = source.decay;\r\n\r\n\t\t\tthis.shadow = source.shadow.clone();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction DirectionalLightShadow( ) {\r\n\r\n\t\tLightShadow.call( this, new OrthographicCamera( - 5, 5, 5, - 5, 0.5, 500 ) );\r\n\r\n\t}\r\n\r\n\tDirectionalLightShadow.prototype = Object.assign( Object.create( LightShadow.prototype ), {\r\n\r\n\t\tconstructor: DirectionalLightShadow\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\r\n\tfunction DirectionalLight( color, intensity ) {\r\n\r\n\t\tLight.call( this, color, intensity );\r\n\r\n\t\tthis.type = 'DirectionalLight';\r\n\r\n\t\tthis.position.copy( Object3D.DefaultUp );\r\n\t\tthis.updateMatrix();\r\n\r\n\t\tthis.target = new Object3D();\r\n\r\n\t\tthis.shadow = new DirectionalLightShadow();\r\n\r\n\t}\r\n\r\n\tDirectionalLight.prototype = Object.assign( Object.create( Light.prototype ), {\r\n\r\n\t\tconstructor: DirectionalLight,\r\n\r\n\t\tisDirectionalLight: true,\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tLight.prototype.copy.call( this, source );\r\n\r\n\t\t\tthis.target = source.target.clone();\r\n\r\n\t\t\tthis.shadow = source.shadow.clone();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction AmbientLight( color, intensity ) {\r\n\r\n\t\tLight.call( this, color, intensity );\r\n\r\n\t\tthis.type = 'AmbientLight';\r\n\r\n\t\tthis.castShadow = undefined;\r\n\r\n\t}\r\n\r\n\tAmbientLight.prototype = Object.assign( Object.create( Light.prototype ), {\r\n\r\n\t\tconstructor: AmbientLight,\r\n\r\n\t\tisAmbientLight: true\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author abelnation / http://github.com/abelnation\r\n\t */\r\n\r\n\tfunction RectAreaLight( color, intensity, width, height ) {\r\n\r\n\t\tLight.call( this, color, intensity );\r\n\r\n\t\tthis.type = 'RectAreaLight';\r\n\r\n\t\tthis.width = ( width !== undefined ) ? width : 10;\r\n\t\tthis.height = ( height !== undefined ) ? height : 10;\r\n\r\n\t}\r\n\r\n\tRectAreaLight.prototype = Object.assign( Object.create( Light.prototype ), {\r\n\r\n\t\tconstructor: RectAreaLight,\r\n\r\n\t\tisRectAreaLight: true,\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tLight.prototype.copy.call( this, source );\r\n\r\n\t\t\tthis.width = source.width;\r\n\t\t\tthis.height = source.height;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function ( meta ) {\r\n\r\n\t\t\tvar data = Light.prototype.toJSON.call( this, meta );\r\n\r\n\t\t\tdata.object.width = this.width;\r\n\t\t\tdata.object.height = this.height;\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author tschw\r\n\t * @author Ben Houston / http://clara.io/\r\n\t * @author David Sarno / http://lighthaus.us/\r\n\t */\r\n\r\n\tvar AnimationUtils = {\r\n\r\n\t\t// same as Array.prototype.slice, but also works on typed arrays\r\n\t\tarraySlice: function ( array, from, to ) {\r\n\r\n\t\t\tif ( AnimationUtils.isTypedArray( array ) ) {\r\n\r\n\t\t\t\t// in ios9 array.subarray(from, undefined) will return empty array\r\n\t\t\t\t// but array.subarray(from) or array.subarray(from, len) is correct\r\n\t\t\t\treturn new array.constructor( array.subarray( from, to !== undefined ? to : array.length ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn array.slice( from, to );\r\n\r\n\t\t},\r\n\r\n\t\t// converts an array to a specific type\r\n\t\tconvertArray: function ( array, type, forceClone ) {\r\n\r\n\t\t\tif ( ! array || // let 'undefined' and 'null' pass\r\n\t\t\t\t\t! forceClone && array.constructor === type ) return array;\r\n\r\n\t\t\tif ( typeof type.BYTES_PER_ELEMENT === 'number' ) {\r\n\r\n\t\t\t\treturn new type( array ); // create typed array\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn Array.prototype.slice.call( array ); // create Array\r\n\r\n\t\t},\r\n\r\n\t\tisTypedArray: function ( object ) {\r\n\r\n\t\t\treturn ArrayBuffer.isView( object ) &&\r\n\t\t\t\t\t! ( object instanceof DataView );\r\n\r\n\t\t},\r\n\r\n\t\t// returns an array by which times and values can be sorted\r\n\t\tgetKeyframeOrder: function ( times ) {\r\n\r\n\t\t\tfunction compareTime( i, j ) {\r\n\r\n\t\t\t\treturn times[ i ] - times[ j ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar n = times.length;\r\n\t\t\tvar result = new Array( n );\r\n\t\t\tfor ( var i = 0; i !== n; ++ i ) result[ i ] = i;\r\n\r\n\t\t\tresult.sort( compareTime );\r\n\r\n\t\t\treturn result;\r\n\r\n\t\t},\r\n\r\n\t\t// uses the array previously returned by 'getKeyframeOrder' to sort data\r\n\t\tsortedArray: function ( values, stride, order ) {\r\n\r\n\t\t\tvar nValues = values.length;\r\n\t\t\tvar result = new values.constructor( nValues );\r\n\r\n\t\t\tfor ( var i = 0, dstOffset = 0; dstOffset !== nValues; ++ i ) {\r\n\r\n\t\t\t\tvar srcOffset = order[ i ] * stride;\r\n\r\n\t\t\t\tfor ( var j = 0; j !== stride; ++ j ) {\r\n\r\n\t\t\t\t\tresult[ dstOffset ++ ] = values[ srcOffset + j ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn result;\r\n\r\n\t\t},\r\n\r\n\t\t// function for parsing AOS keyframe formats\r\n\t\tflattenJSON: function ( jsonKeys, times, values, valuePropertyName ) {\r\n\r\n\t\t\tvar i = 1, key = jsonKeys[ 0 ];\r\n\r\n\t\t\twhile ( key !== undefined && key[ valuePropertyName ] === undefined ) {\r\n\r\n\t\t\t\tkey = jsonKeys[ i ++ ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( key === undefined ) return; // no data\r\n\r\n\t\t\tvar value = key[ valuePropertyName ];\r\n\t\t\tif ( value === undefined ) return; // no data\r\n\r\n\t\t\tif ( Array.isArray( value ) ) {\r\n\r\n\t\t\t\tdo {\r\n\r\n\t\t\t\t\tvalue = key[ valuePropertyName ];\r\n\r\n\t\t\t\t\tif ( value !== undefined ) {\r\n\r\n\t\t\t\t\t\ttimes.push( key.time );\r\n\t\t\t\t\t\tvalues.push.apply( values, value ); // push all elements\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tkey = jsonKeys[ i ++ ];\r\n\r\n\t\t\t\t} while ( key !== undefined );\r\n\r\n\t\t\t} else if ( value.toArray !== undefined ) {\r\n\r\n\t\t\t\t// ...assume THREE.Math-ish\r\n\r\n\t\t\t\tdo {\r\n\r\n\t\t\t\t\tvalue = key[ valuePropertyName ];\r\n\r\n\t\t\t\t\tif ( value !== undefined ) {\r\n\r\n\t\t\t\t\t\ttimes.push( key.time );\r\n\t\t\t\t\t\tvalue.toArray( values, values.length );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tkey = jsonKeys[ i ++ ];\r\n\r\n\t\t\t\t} while ( key !== undefined );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// otherwise push as-is\r\n\r\n\t\t\t\tdo {\r\n\r\n\t\t\t\t\tvalue = key[ valuePropertyName ];\r\n\r\n\t\t\t\t\tif ( value !== undefined ) {\r\n\r\n\t\t\t\t\t\ttimes.push( key.time );\r\n\t\t\t\t\t\tvalues.push( value );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tkey = jsonKeys[ i ++ ];\r\n\r\n\t\t\t\t} while ( key !== undefined );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * Abstract base class of interpolants over parametric samples.\r\n\t *\r\n\t * The parameter domain is one dimensional, typically the time or a path\r\n\t * along a curve defined by the data.\r\n\t *\r\n\t * The sample values can have any dimensionality and derived classes may\r\n\t * apply special interpretations to the data.\r\n\t *\r\n\t * This class provides the interval seek in a Template Method, deferring\r\n\t * the actual interpolation to derived classes.\r\n\t *\r\n\t * Time complexity is O(1) for linear access crossing at most two points\r\n\t * and O(log N) for random access, where N is the number of positions.\r\n\t *\r\n\t * References:\r\n\t *\r\n\t * \t\thttp://www.oodesign.com/template-method-pattern.html\r\n\t *\r\n\t * @author tschw\r\n\t */\r\n\r\n\tfunction Interpolant( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\r\n\r\n\t\tthis.parameterPositions = parameterPositions;\r\n\t\tthis._cachedIndex = 0;\r\n\r\n\t\tthis.resultBuffer = resultBuffer !== undefined ?\r\n\t\t\tresultBuffer : new sampleValues.constructor( sampleSize );\r\n\t\tthis.sampleValues = sampleValues;\r\n\t\tthis.valueSize = sampleSize;\r\n\r\n\t}\r\n\r\n\tObject.assign( Interpolant.prototype, {\r\n\r\n\t\tevaluate: function ( t ) {\r\n\r\n\t\t\tvar pp = this.parameterPositions,\r\n\t\t\t\ti1 = this._cachedIndex,\r\n\r\n\t\t\t\tt1 = pp[ i1 ],\r\n\t\t\t\tt0 = pp[ i1 - 1 ];\r\n\r\n\t\t\tvalidate_interval: {\r\n\r\n\t\t\t\tseek: {\r\n\r\n\t\t\t\t\tvar right;\r\n\r\n\t\t\t\t\tlinear_scan: {\r\n\r\n\t\t\t\t\t\t//- See http://jsperf.com/comparison-to-undefined/3\r\n\t\t\t\t\t\t//- slower code:\r\n\t\t\t\t\t\t//-\r\n\t\t\t\t\t\t//- \t\t\t\tif ( t >= t1 || t1 === undefined ) {\r\n\t\t\t\t\t\tforward_scan: if ( ! ( t < t1 ) ) {\r\n\r\n\t\t\t\t\t\t\tfor ( var giveUpAt = i1 + 2; ; ) {\r\n\r\n\t\t\t\t\t\t\t\tif ( t1 === undefined ) {\r\n\r\n\t\t\t\t\t\t\t\t\tif ( t < t0 ) break forward_scan;\r\n\r\n\t\t\t\t\t\t\t\t\t// after end\r\n\r\n\t\t\t\t\t\t\t\t\ti1 = pp.length;\r\n\t\t\t\t\t\t\t\t\tthis._cachedIndex = i1;\r\n\t\t\t\t\t\t\t\t\treturn this.afterEnd_( i1 - 1, t, t0 );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tif ( i1 === giveUpAt ) break; // this loop\r\n\r\n\t\t\t\t\t\t\t\tt0 = t1;\r\n\t\t\t\t\t\t\t\tt1 = pp[ ++ i1 ];\r\n\r\n\t\t\t\t\t\t\t\tif ( t < t1 ) {\r\n\r\n\t\t\t\t\t\t\t\t\t// we have arrived at the sought interval\r\n\t\t\t\t\t\t\t\t\tbreak seek;\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// prepare binary search on the right side of the index\r\n\t\t\t\t\t\t\tright = pp.length;\r\n\t\t\t\t\t\t\tbreak linear_scan;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t//- slower code:\r\n\t\t\t\t\t\t//-\t\t\t\t\tif ( t < t0 || t0 === undefined ) {\r\n\t\t\t\t\t\tif ( ! ( t >= t0 ) ) {\r\n\r\n\t\t\t\t\t\t\t// looping?\r\n\r\n\t\t\t\t\t\t\tvar t1global = pp[ 1 ];\r\n\r\n\t\t\t\t\t\t\tif ( t < t1global ) {\r\n\r\n\t\t\t\t\t\t\t\ti1 = 2; // + 1, using the scan for the details\r\n\t\t\t\t\t\t\t\tt0 = t1global;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// linear reverse scan\r\n\r\n\t\t\t\t\t\t\tfor ( var giveUpAt = i1 - 2; ; ) {\r\n\r\n\t\t\t\t\t\t\t\tif ( t0 === undefined ) {\r\n\r\n\t\t\t\t\t\t\t\t\t// before start\r\n\r\n\t\t\t\t\t\t\t\t\tthis._cachedIndex = 0;\r\n\t\t\t\t\t\t\t\t\treturn this.beforeStart_( 0, t, t1 );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tif ( i1 === giveUpAt ) break; // this loop\r\n\r\n\t\t\t\t\t\t\t\tt1 = t0;\r\n\t\t\t\t\t\t\t\tt0 = pp[ -- i1 - 1 ];\r\n\r\n\t\t\t\t\t\t\t\tif ( t >= t0 ) {\r\n\r\n\t\t\t\t\t\t\t\t\t// we have arrived at the sought interval\r\n\t\t\t\t\t\t\t\t\tbreak seek;\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// prepare binary search on the left side of the index\r\n\t\t\t\t\t\t\tright = i1;\r\n\t\t\t\t\t\t\ti1 = 0;\r\n\t\t\t\t\t\t\tbreak linear_scan;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// the interval is valid\r\n\r\n\t\t\t\t\t\tbreak validate_interval;\r\n\r\n\t\t\t\t\t} // linear scan\r\n\r\n\t\t\t\t\t// binary search\r\n\r\n\t\t\t\t\twhile ( i1 < right ) {\r\n\r\n\t\t\t\t\t\tvar mid = ( i1 + right ) >>> 1;\r\n\r\n\t\t\t\t\t\tif ( t < pp[ mid ] ) {\r\n\r\n\t\t\t\t\t\t\tright = mid;\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\ti1 = mid + 1;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tt1 = pp[ i1 ];\r\n\t\t\t\t\tt0 = pp[ i1 - 1 ];\r\n\r\n\t\t\t\t\t// check boundary cases, again\r\n\r\n\t\t\t\t\tif ( t0 === undefined ) {\r\n\r\n\t\t\t\t\t\tthis._cachedIndex = 0;\r\n\t\t\t\t\t\treturn this.beforeStart_( 0, t, t1 );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( t1 === undefined ) {\r\n\r\n\t\t\t\t\t\ti1 = pp.length;\r\n\t\t\t\t\t\tthis._cachedIndex = i1;\r\n\t\t\t\t\t\treturn this.afterEnd_( i1 - 1, t0, t );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} // seek\r\n\r\n\t\t\t\tthis._cachedIndex = i1;\r\n\r\n\t\t\t\tthis.intervalChanged_( i1, t0, t1 );\r\n\r\n\t\t\t} // validate_interval\r\n\r\n\t\t\treturn this.interpolate_( i1, t0, t, t1 );\r\n\r\n\t\t},\r\n\r\n\t\tsettings: null, // optional, subclass-specific settings structure\r\n\t\t// Note: The indirection allows central control of many interpolants.\r\n\r\n\t\t// --- Protected interface\r\n\r\n\t\tDefaultSettings_: {},\r\n\r\n\t\tgetSettings_: function () {\r\n\r\n\t\t\treturn this.settings || this.DefaultSettings_;\r\n\r\n\t\t},\r\n\r\n\t\tcopySampleValue_: function ( index ) {\r\n\r\n\t\t\t// copies a sample value to the result buffer\r\n\r\n\t\t\tvar result = this.resultBuffer,\r\n\t\t\t\tvalues = this.sampleValues,\r\n\t\t\t\tstride = this.valueSize,\r\n\t\t\t\toffset = index * stride;\r\n\r\n\t\t\tfor ( var i = 0; i !== stride; ++ i ) {\r\n\r\n\t\t\t\tresult[ i ] = values[ offset + i ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn result;\r\n\r\n\t\t},\r\n\r\n\t\t// Template methods for derived classes:\r\n\r\n\t\tinterpolate_: function ( /* i1, t0, t, t1 */ ) {\r\n\r\n\t\t\tthrow new Error( 'call to abstract method' );\r\n\t\t\t// implementations shall return this.resultBuffer\r\n\r\n\t\t},\r\n\r\n\t\tintervalChanged_: function ( /* i1, t0, t1 */ ) {\r\n\r\n\t\t\t// empty\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t//!\\ DECLARE ALIAS AFTER assign prototype !\r\n\tObject.assign( Interpolant.prototype, {\r\n\r\n\t\t//( 0, t, t0 ), returns this.resultBuffer\r\n\t\tbeforeStart_: Interpolant.prototype.copySampleValue_,\r\n\r\n\t\t//( N-1, tN-1, t ), returns this.resultBuffer\r\n\t\tafterEnd_: Interpolant.prototype.copySampleValue_,\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * Fast and simple cubic spline interpolant.\r\n\t *\r\n\t * It was derived from a Hermitian construction setting the first derivative\r\n\t * at each sample position to the linear slope between neighboring positions\r\n\t * over their parameter interval.\r\n\t *\r\n\t * @author tschw\r\n\t */\r\n\r\n\tfunction CubicInterpolant( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\r\n\r\n\t\tInterpolant.call( this, parameterPositions, sampleValues, sampleSize, resultBuffer );\r\n\r\n\t\tthis._weightPrev = - 0;\r\n\t\tthis._offsetPrev = - 0;\r\n\t\tthis._weightNext = - 0;\r\n\t\tthis._offsetNext = - 0;\r\n\r\n\t}\r\n\r\n\tCubicInterpolant.prototype = Object.assign( Object.create( Interpolant.prototype ), {\r\n\r\n\t\tconstructor: CubicInterpolant,\r\n\r\n\t\tDefaultSettings_: {\r\n\r\n\t\t\tendingStart: ZeroCurvatureEnding,\r\n\t\t\tendingEnd: ZeroCurvatureEnding\r\n\r\n\t\t},\r\n\r\n\t\tintervalChanged_: function ( i1, t0, t1 ) {\r\n\r\n\t\t\tvar pp = this.parameterPositions,\r\n\t\t\t\tiPrev = i1 - 2,\r\n\t\t\t\tiNext = i1 + 1,\r\n\r\n\t\t\t\ttPrev = pp[ iPrev ],\r\n\t\t\t\ttNext = pp[ iNext ];\r\n\r\n\t\t\tif ( tPrev === undefined ) {\r\n\r\n\t\t\t\tswitch ( this.getSettings_().endingStart ) {\r\n\r\n\t\t\t\t\tcase ZeroSlopeEnding:\r\n\r\n\t\t\t\t\t\t// f'(t0) = 0\r\n\t\t\t\t\t\tiPrev = i1;\r\n\t\t\t\t\t\ttPrev = 2 * t0 - t1;\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase WrapAroundEnding:\r\n\r\n\t\t\t\t\t\t// use the other end of the curve\r\n\t\t\t\t\t\tiPrev = pp.length - 2;\r\n\t\t\t\t\t\ttPrev = t0 + pp[ iPrev ] - pp[ iPrev + 1 ];\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault: // ZeroCurvatureEnding\r\n\r\n\t\t\t\t\t\t// f''(t0) = 0 a.k.a. Natural Spline\r\n\t\t\t\t\t\tiPrev = i1;\r\n\t\t\t\t\t\ttPrev = t1;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( tNext === undefined ) {\r\n\r\n\t\t\t\tswitch ( this.getSettings_().endingEnd ) {\r\n\r\n\t\t\t\t\tcase ZeroSlopeEnding:\r\n\r\n\t\t\t\t\t\t// f'(tN) = 0\r\n\t\t\t\t\t\tiNext = i1;\r\n\t\t\t\t\t\ttNext = 2 * t1 - t0;\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase WrapAroundEnding:\r\n\r\n\t\t\t\t\t\t// use the other end of the curve\r\n\t\t\t\t\t\tiNext = 1;\r\n\t\t\t\t\t\ttNext = t1 + pp[ 1 ] - pp[ 0 ];\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault: // ZeroCurvatureEnding\r\n\r\n\t\t\t\t\t\t// f''(tN) = 0, a.k.a. Natural Spline\r\n\t\t\t\t\t\tiNext = i1 - 1;\r\n\t\t\t\t\t\ttNext = t0;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar halfDt = ( t1 - t0 ) * 0.5,\r\n\t\t\t\tstride = this.valueSize;\r\n\r\n\t\t\tthis._weightPrev = halfDt / ( t0 - tPrev );\r\n\t\t\tthis._weightNext = halfDt / ( tNext - t1 );\r\n\t\t\tthis._offsetPrev = iPrev * stride;\r\n\t\t\tthis._offsetNext = iNext * stride;\r\n\r\n\t\t},\r\n\r\n\t\tinterpolate_: function ( i1, t0, t, t1 ) {\r\n\r\n\t\t\tvar result = this.resultBuffer,\r\n\t\t\t\tvalues = this.sampleValues,\r\n\t\t\t\tstride = this.valueSize,\r\n\r\n\t\t\t\to1 = i1 * stride,\t\to0 = o1 - stride,\r\n\t\t\t\toP = this._offsetPrev, \toN = this._offsetNext,\r\n\t\t\t\twP = this._weightPrev,\twN = this._weightNext,\r\n\r\n\t\t\t\tp = ( t - t0 ) / ( t1 - t0 ),\r\n\t\t\t\tpp = p * p,\r\n\t\t\t\tppp = pp * p;\r\n\r\n\t\t\t// evaluate polynomials\r\n\r\n\t\t\tvar sP = - wP * ppp + 2 * wP * pp - wP * p;\r\n\t\t\tvar s0 = ( 1 + wP ) * ppp + ( - 1.5 - 2 * wP ) * pp + ( - 0.5 + wP ) * p + 1;\r\n\t\t\tvar s1 = ( - 1 - wN ) * ppp + ( 1.5 + wN ) * pp + 0.5 * p;\r\n\t\t\tvar sN = wN * ppp - wN * pp;\r\n\r\n\t\t\t// combine data linearly\r\n\r\n\t\t\tfor ( var i = 0; i !== stride; ++ i ) {\r\n\r\n\t\t\t\tresult[ i ] =\r\n\t\t\t\t\t\tsP * values[ oP + i ] +\r\n\t\t\t\t\t\ts0 * values[ o0 + i ] +\r\n\t\t\t\t\t\ts1 * values[ o1 + i ] +\r\n\t\t\t\t\t\tsN * values[ oN + i ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn result;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author tschw\r\n\t */\r\n\r\n\tfunction LinearInterpolant( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\r\n\r\n\t\tInterpolant.call( this, parameterPositions, sampleValues, sampleSize, resultBuffer );\r\n\r\n\t}\r\n\r\n\tLinearInterpolant.prototype = Object.assign( Object.create( Interpolant.prototype ), {\r\n\r\n\t\tconstructor: LinearInterpolant,\r\n\r\n\t\tinterpolate_: function ( i1, t0, t, t1 ) {\r\n\r\n\t\t\tvar result = this.resultBuffer,\r\n\t\t\t\tvalues = this.sampleValues,\r\n\t\t\t\tstride = this.valueSize,\r\n\r\n\t\t\t\toffset1 = i1 * stride,\r\n\t\t\t\toffset0 = offset1 - stride,\r\n\r\n\t\t\t\tweight1 = ( t - t0 ) / ( t1 - t0 ),\r\n\t\t\t\tweight0 = 1 - weight1;\r\n\r\n\t\t\tfor ( var i = 0; i !== stride; ++ i ) {\r\n\r\n\t\t\t\tresult[ i ] =\r\n\t\t\t\t\t\tvalues[ offset0 + i ] * weight0 +\r\n\t\t\t\t\t\tvalues[ offset1 + i ] * weight1;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn result;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t *\r\n\t * Interpolant that evaluates to the sample value at the position preceeding\r\n\t * the parameter.\r\n\t *\r\n\t * @author tschw\r\n\t */\r\n\r\n\tfunction DiscreteInterpolant( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\r\n\r\n\t\tInterpolant.call( this, parameterPositions, sampleValues, sampleSize, resultBuffer );\r\n\r\n\t}\r\n\r\n\tDiscreteInterpolant.prototype = Object.assign( Object.create( Interpolant.prototype ), {\r\n\r\n\t\tconstructor: DiscreteInterpolant,\r\n\r\n\t\tinterpolate_: function ( i1 /*, t0, t, t1 */ ) {\r\n\r\n\t\t\treturn this.copySampleValue_( i1 - 1 );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t *\r\n\t * A timed sequence of keyframes for a specific property.\r\n\t *\r\n\t *\r\n\t * @author Ben Houston / http://clara.io/\r\n\t * @author David Sarno / http://lighthaus.us/\r\n\t * @author tschw\r\n\t */\r\n\r\n\tfunction KeyframeTrack( name, times, values, interpolation ) {\r\n\r\n\t\tif ( name === undefined ) throw new Error( 'THREE.KeyframeTrack: track name is undefined' );\r\n\t\tif ( times === undefined || times.length === 0 ) throw new Error( 'THREE.KeyframeTrack: no keyframes in track named ' + name );\r\n\r\n\t\tthis.name = name;\r\n\r\n\t\tthis.times = AnimationUtils.convertArray( times, this.TimeBufferType );\r\n\t\tthis.values = AnimationUtils.convertArray( values, this.ValueBufferType );\r\n\r\n\t\tthis.setInterpolation( interpolation || this.DefaultInterpolation );\r\n\r\n\t}\r\n\r\n\t// Static methods\r\n\r\n\tObject.assign( KeyframeTrack, {\r\n\r\n\t\t// Serialization (in static context, because of constructor invocation\r\n\t\t// and automatic invocation of .toJSON):\r\n\r\n\t\ttoJSON: function ( track ) {\r\n\r\n\t\t\tvar trackType = track.constructor;\r\n\r\n\t\t\tvar json;\r\n\r\n\t\t\t// derived classes can define a static toJSON method\r\n\t\t\tif ( trackType.toJSON !== undefined ) {\r\n\r\n\t\t\t\tjson = trackType.toJSON( track );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// by default, we assume the data can be serialized as-is\r\n\t\t\t\tjson = {\r\n\r\n\t\t\t\t\t'name': track.name,\r\n\t\t\t\t\t'times': AnimationUtils.convertArray( track.times, Array ),\r\n\t\t\t\t\t'values': AnimationUtils.convertArray( track.values, Array )\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t\tvar interpolation = track.getInterpolation();\r\n\r\n\t\t\t\tif ( interpolation !== track.DefaultInterpolation ) {\r\n\r\n\t\t\t\t\tjson.interpolation = interpolation;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tjson.type = track.ValueTypeName; // mandatory\r\n\r\n\t\t\treturn json;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( KeyframeTrack.prototype, {\r\n\r\n\t\tconstructor: KeyframeTrack,\r\n\r\n\t\tTimeBufferType: Float32Array,\r\n\r\n\t\tValueBufferType: Float32Array,\r\n\r\n\t\tDefaultInterpolation: InterpolateLinear,\r\n\r\n\t\tInterpolantFactoryMethodDiscrete: function ( result ) {\r\n\r\n\t\t\treturn new DiscreteInterpolant( this.times, this.values, this.getValueSize(), result );\r\n\r\n\t\t},\r\n\r\n\t\tInterpolantFactoryMethodLinear: function ( result ) {\r\n\r\n\t\t\treturn new LinearInterpolant( this.times, this.values, this.getValueSize(), result );\r\n\r\n\t\t},\r\n\r\n\t\tInterpolantFactoryMethodSmooth: function ( result ) {\r\n\r\n\t\t\treturn new CubicInterpolant( this.times, this.values, this.getValueSize(), result );\r\n\r\n\t\t},\r\n\r\n\t\tsetInterpolation: function ( interpolation ) {\r\n\r\n\t\t\tvar factoryMethod;\r\n\r\n\t\t\tswitch ( interpolation ) {\r\n\r\n\t\t\t\tcase InterpolateDiscrete:\r\n\r\n\t\t\t\t\tfactoryMethod = this.InterpolantFactoryMethodDiscrete;\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase InterpolateLinear:\r\n\r\n\t\t\t\t\tfactoryMethod = this.InterpolantFactoryMethodLinear;\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase InterpolateSmooth:\r\n\r\n\t\t\t\t\tfactoryMethod = this.InterpolantFactoryMethodSmooth;\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( factoryMethod === undefined ) {\r\n\r\n\t\t\t\tvar message = \"unsupported interpolation for \" +\r\n\t\t\t\t\tthis.ValueTypeName + \" keyframe track named \" + this.name;\r\n\r\n\t\t\t\tif ( this.createInterpolant === undefined ) {\r\n\r\n\t\t\t\t\t// fall back to default, unless the default itself is messed up\r\n\t\t\t\t\tif ( interpolation !== this.DefaultInterpolation ) {\r\n\r\n\t\t\t\t\t\tthis.setInterpolation( this.DefaultInterpolation );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tthrow new Error( message ); // fatal, in this case\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconsole.warn( 'THREE.KeyframeTrack:', message );\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.createInterpolant = factoryMethod;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetInterpolation: function () {\r\n\r\n\t\t\tswitch ( this.createInterpolant ) {\r\n\r\n\t\t\t\tcase this.InterpolantFactoryMethodDiscrete:\r\n\r\n\t\t\t\t\treturn InterpolateDiscrete;\r\n\r\n\t\t\t\tcase this.InterpolantFactoryMethodLinear:\r\n\r\n\t\t\t\t\treturn InterpolateLinear;\r\n\r\n\t\t\t\tcase this.InterpolantFactoryMethodSmooth:\r\n\r\n\t\t\t\t\treturn InterpolateSmooth;\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tgetValueSize: function () {\r\n\r\n\t\t\treturn this.values.length / this.times.length;\r\n\r\n\t\t},\r\n\r\n\t\t// move all keyframes either forwards or backwards in time\r\n\t\tshift: function ( timeOffset ) {\r\n\r\n\t\t\tif ( timeOffset !== 0.0 ) {\r\n\r\n\t\t\t\tvar times = this.times;\r\n\r\n\t\t\t\tfor ( var i = 0, n = times.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\t\ttimes[ i ] += timeOffset;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\t// scale all keyframe times by a factor (useful for frame <-> seconds conversions)\r\n\t\tscale: function ( timeScale ) {\r\n\r\n\t\t\tif ( timeScale !== 1.0 ) {\r\n\r\n\t\t\t\tvar times = this.times;\r\n\r\n\t\t\t\tfor ( var i = 0, n = times.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\t\ttimes[ i ] *= timeScale;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\t// removes keyframes before and after animation without changing any values within the range [startTime, endTime].\r\n\t\t// IMPORTANT: We do not shift around keys to the start of the track time, because for interpolated keys this will change their values\r\n\t\ttrim: function ( startTime, endTime ) {\r\n\r\n\t\t\tvar times = this.times,\r\n\t\t\t\tnKeys = times.length,\r\n\t\t\t\tfrom = 0,\r\n\t\t\t\tto = nKeys - 1;\r\n\r\n\t\t\twhile ( from !== nKeys && times[ from ] < startTime ) {\r\n\r\n\t\t\t\t++ from;\r\n\r\n\t\t\t}\r\n\r\n\t\t\twhile ( to !== - 1 && times[ to ] > endTime ) {\r\n\r\n\t\t\t\t-- to;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t++ to; // inclusive -> exclusive bound\r\n\r\n\t\t\tif ( from !== 0 || to !== nKeys ) {\r\n\r\n\t\t\t\t// empty tracks are forbidden, so keep at least one keyframe\r\n\t\t\t\tif ( from >= to ) to = Math.max( to, 1 ), from = to - 1;\r\n\r\n\t\t\t\tvar stride = this.getValueSize();\r\n\t\t\t\tthis.times = AnimationUtils.arraySlice( times, from, to );\r\n\t\t\t\tthis.values = AnimationUtils.arraySlice( this.values, from * stride, to * stride );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\t// ensure we do not get a GarbageInGarbageOut situation, make sure tracks are at least minimally viable\r\n\t\tvalidate: function () {\r\n\r\n\t\t\tvar valid = true;\r\n\r\n\t\t\tvar valueSize = this.getValueSize();\r\n\t\t\tif ( valueSize - Math.floor( valueSize ) !== 0 ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.KeyframeTrack: Invalid value size in track.', this );\r\n\t\t\t\tvalid = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar times = this.times,\r\n\t\t\t\tvalues = this.values,\r\n\r\n\t\t\t\tnKeys = times.length;\r\n\r\n\t\t\tif ( nKeys === 0 ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.KeyframeTrack: Track is empty.', this );\r\n\t\t\t\tvalid = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar prevTime = null;\r\n\r\n\t\t\tfor ( var i = 0; i !== nKeys; i ++ ) {\r\n\r\n\t\t\t\tvar currTime = times[ i ];\r\n\r\n\t\t\t\tif ( typeof currTime === 'number' && isNaN( currTime ) ) {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.KeyframeTrack: Time is not a valid number.', this, i, currTime );\r\n\t\t\t\t\tvalid = false;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( prevTime !== null && prevTime > currTime ) {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.KeyframeTrack: Out of order keys.', this, i, currTime, prevTime );\r\n\t\t\t\t\tvalid = false;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tprevTime = currTime;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( values !== undefined ) {\r\n\r\n\t\t\t\tif ( AnimationUtils.isTypedArray( values ) ) {\r\n\r\n\t\t\t\t\tfor ( var i = 0, n = values.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\t\t\tvar value = values[ i ];\r\n\r\n\t\t\t\t\t\tif ( isNaN( value ) ) {\r\n\r\n\t\t\t\t\t\t\tconsole.error( 'THREE.KeyframeTrack: Value is not a valid number.', this, i, value );\r\n\t\t\t\t\t\t\tvalid = false;\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn valid;\r\n\r\n\t\t},\r\n\r\n\t\t// removes equivalent sequential keys as common in morph target sequences\r\n\t\t// (0,0,0,0,1,1,1,0,0,0,0,0,0,0) --> (0,0,1,1,0,0)\r\n\t\toptimize: function () {\r\n\r\n\t\t\tvar times = this.times,\r\n\t\t\t\tvalues = this.values,\r\n\t\t\t\tstride = this.getValueSize(),\r\n\r\n\t\t\t\tsmoothInterpolation = this.getInterpolation() === InterpolateSmooth,\r\n\r\n\t\t\t\twriteIndex = 1,\r\n\t\t\t\tlastIndex = times.length - 1;\r\n\r\n\t\t\tfor ( var i = 1; i < lastIndex; ++ i ) {\r\n\r\n\t\t\t\tvar keep = false;\r\n\r\n\t\t\t\tvar time = times[ i ];\r\n\t\t\t\tvar timeNext = times[ i + 1 ];\r\n\r\n\t\t\t\t// remove adjacent keyframes scheduled at the same time\r\n\r\n\t\t\t\tif ( time !== timeNext && ( i !== 1 || time !== time[ 0 ] ) ) {\r\n\r\n\t\t\t\t\tif ( ! smoothInterpolation ) {\r\n\r\n\t\t\t\t\t\t// remove unnecessary keyframes same as their neighbors\r\n\r\n\t\t\t\t\t\tvar offset = i * stride,\r\n\t\t\t\t\t\t\toffsetP = offset - stride,\r\n\t\t\t\t\t\t\toffsetN = offset + stride;\r\n\r\n\t\t\t\t\t\tfor ( var j = 0; j !== stride; ++ j ) {\r\n\r\n\t\t\t\t\t\t\tvar value = values[ offset + j ];\r\n\r\n\t\t\t\t\t\t\tif ( value !== values[ offsetP + j ] ||\r\n\t\t\t\t\t\t\t\tvalue !== values[ offsetN + j ] ) {\r\n\r\n\t\t\t\t\t\t\t\tkeep = true;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tkeep = true;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// in-place compaction\r\n\r\n\t\t\t\tif ( keep ) {\r\n\r\n\t\t\t\t\tif ( i !== writeIndex ) {\r\n\r\n\t\t\t\t\t\ttimes[ writeIndex ] = times[ i ];\r\n\r\n\t\t\t\t\t\tvar readOffset = i * stride,\r\n\t\t\t\t\t\t\twriteOffset = writeIndex * stride;\r\n\r\n\t\t\t\t\t\tfor ( var j = 0; j !== stride; ++ j ) {\r\n\r\n\t\t\t\t\t\t\tvalues[ writeOffset + j ] = values[ readOffset + j ];\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t++ writeIndex;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// flush last keyframe (compaction looks ahead)\r\n\r\n\t\t\tif ( lastIndex > 0 ) {\r\n\r\n\t\t\t\ttimes[ writeIndex ] = times[ lastIndex ];\r\n\r\n\t\t\t\tfor ( var readOffset = lastIndex * stride, writeOffset = writeIndex * stride, j = 0; j !== stride; ++ j ) {\r\n\r\n\t\t\t\t\tvalues[ writeOffset + j ] = values[ readOffset + j ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t++ writeIndex;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( writeIndex !== times.length ) {\r\n\r\n\t\t\t\tthis.times = AnimationUtils.arraySlice( times, 0, writeIndex );\r\n\t\t\t\tthis.values = AnimationUtils.arraySlice( values, 0, writeIndex * stride );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t *\r\n\t * A Track of Boolean keyframe values.\r\n\t *\r\n\t *\r\n\t * @author Ben Houston / http://clara.io/\r\n\t * @author David Sarno / http://lighthaus.us/\r\n\t * @author tschw\r\n\t */\r\n\r\n\tfunction BooleanKeyframeTrack( name, times, values ) {\r\n\r\n\t\tKeyframeTrack.call( this, name, times, values );\r\n\r\n\t}\r\n\r\n\tBooleanKeyframeTrack.prototype = Object.assign( Object.create( KeyframeTrack.prototype ), {\r\n\r\n\t\tconstructor: BooleanKeyframeTrack,\r\n\r\n\t\tValueTypeName: 'bool',\r\n\t\tValueBufferType: Array,\r\n\r\n\t\tDefaultInterpolation: InterpolateDiscrete,\r\n\r\n\t\tInterpolantFactoryMethodLinear: undefined,\r\n\t\tInterpolantFactoryMethodSmooth: undefined\r\n\r\n\t\t// Note: Actually this track could have a optimized / compressed\r\n\t\t// representation of a single value and a custom interpolant that\r\n\t\t// computes \"firstValue ^ isOdd( index )\".\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t *\r\n\t * A Track of keyframe values that represent color.\r\n\t *\r\n\t *\r\n\t * @author Ben Houston / http://clara.io/\r\n\t * @author David Sarno / http://lighthaus.us/\r\n\t * @author tschw\r\n\t */\r\n\r\n\tfunction ColorKeyframeTrack( name, times, values, interpolation ) {\r\n\r\n\t\tKeyframeTrack.call( this, name, times, values, interpolation );\r\n\r\n\t}\r\n\r\n\tColorKeyframeTrack.prototype = Object.assign( Object.create( KeyframeTrack.prototype ), {\r\n\r\n\t\tconstructor: ColorKeyframeTrack,\r\n\r\n\t\tValueTypeName: 'color'\r\n\r\n\t\t// ValueBufferType is inherited\r\n\r\n\t\t// DefaultInterpolation is inherited\r\n\r\n\t\t// Note: Very basic implementation and nothing special yet.\r\n\t\t// However, this is the place for color space parameterization.\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t *\r\n\t * A Track of numeric keyframe values.\r\n\t *\r\n\t * @author Ben Houston / http://clara.io/\r\n\t * @author David Sarno / http://lighthaus.us/\r\n\t * @author tschw\r\n\t */\r\n\r\n\tfunction NumberKeyframeTrack( name, times, values, interpolation ) {\r\n\r\n\t\tKeyframeTrack.call( this, name, times, values, interpolation );\r\n\r\n\t}\r\n\r\n\tNumberKeyframeTrack.prototype = Object.assign( Object.create( KeyframeTrack.prototype ), {\r\n\r\n\t\tconstructor: NumberKeyframeTrack,\r\n\r\n\t\tValueTypeName: 'number'\r\n\r\n\t\t// ValueBufferType is inherited\r\n\r\n\t\t// DefaultInterpolation is inherited\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * Spherical linear unit quaternion interpolant.\r\n\t *\r\n\t * @author tschw\r\n\t */\r\n\r\n\tfunction QuaternionLinearInterpolant( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\r\n\r\n\t\tInterpolant.call( this, parameterPositions, sampleValues, sampleSize, resultBuffer );\r\n\r\n\t}\r\n\r\n\tQuaternionLinearInterpolant.prototype = Object.assign( Object.create( Interpolant.prototype ), {\r\n\r\n\t\tconstructor: QuaternionLinearInterpolant,\r\n\r\n\t\tinterpolate_: function ( i1, t0, t, t1 ) {\r\n\r\n\t\t\tvar result = this.resultBuffer,\r\n\t\t\t\tvalues = this.sampleValues,\r\n\t\t\t\tstride = this.valueSize,\r\n\r\n\t\t\t\toffset = i1 * stride,\r\n\r\n\t\t\t\talpha = ( t - t0 ) / ( t1 - t0 );\r\n\r\n\t\t\tfor ( var end = offset + stride; offset !== end; offset += 4 ) {\r\n\r\n\t\t\t\tQuaternion.slerpFlat( result, 0, values, offset - stride, values, offset, alpha );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn result;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t *\r\n\t * A Track of quaternion keyframe values.\r\n\t *\r\n\t * @author Ben Houston / http://clara.io/\r\n\t * @author David Sarno / http://lighthaus.us/\r\n\t * @author tschw\r\n\t */\r\n\r\n\tfunction QuaternionKeyframeTrack( name, times, values, interpolation ) {\r\n\r\n\t\tKeyframeTrack.call( this, name, times, values, interpolation );\r\n\r\n\t}\r\n\r\n\tQuaternionKeyframeTrack.prototype = Object.assign( Object.create( KeyframeTrack.prototype ), {\r\n\r\n\t\tconstructor: QuaternionKeyframeTrack,\r\n\r\n\t\tValueTypeName: 'quaternion',\r\n\r\n\t\t// ValueBufferType is inherited\r\n\r\n\t\tDefaultInterpolation: InterpolateLinear,\r\n\r\n\t\tInterpolantFactoryMethodLinear: function ( result ) {\r\n\r\n\t\t\treturn new QuaternionLinearInterpolant( this.times, this.values, this.getValueSize(), result );\r\n\r\n\t\t},\r\n\r\n\t\tInterpolantFactoryMethodSmooth: undefined // not yet implemented\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t *\r\n\t * A Track that interpolates Strings\r\n\t *\r\n\t *\r\n\t * @author Ben Houston / http://clara.io/\r\n\t * @author David Sarno / http://lighthaus.us/\r\n\t * @author tschw\r\n\t */\r\n\r\n\tfunction StringKeyframeTrack( name, times, values, interpolation ) {\r\n\r\n\t\tKeyframeTrack.call( this, name, times, values, interpolation );\r\n\r\n\t}\r\n\r\n\tStringKeyframeTrack.prototype = Object.assign( Object.create( KeyframeTrack.prototype ), {\r\n\r\n\t\tconstructor: StringKeyframeTrack,\r\n\r\n\t\tValueTypeName: 'string',\r\n\t\tValueBufferType: Array,\r\n\r\n\t\tDefaultInterpolation: InterpolateDiscrete,\r\n\r\n\t\tInterpolantFactoryMethodLinear: undefined,\r\n\r\n\t\tInterpolantFactoryMethodSmooth: undefined\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t *\r\n\t * A Track of vectored keyframe values.\r\n\t *\r\n\t *\r\n\t * @author Ben Houston / http://clara.io/\r\n\t * @author David Sarno / http://lighthaus.us/\r\n\t * @author tschw\r\n\t */\r\n\r\n\tfunction VectorKeyframeTrack( name, times, values, interpolation ) {\r\n\r\n\t\tKeyframeTrack.call( this, name, times, values, interpolation );\r\n\r\n\t}\r\n\r\n\tVectorKeyframeTrack.prototype = Object.assign( Object.create( KeyframeTrack.prototype ), {\r\n\r\n\t\tconstructor: VectorKeyframeTrack,\r\n\r\n\t\tValueTypeName: 'vector'\r\n\r\n\t\t// ValueBufferType is inherited\r\n\r\n\t\t// DefaultInterpolation is inherited\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t *\r\n\t * Reusable set of Tracks that represent an animation.\r\n\t *\r\n\t * @author Ben Houston / http://clara.io/\r\n\t * @author David Sarno / http://lighthaus.us/\r\n\t */\r\n\r\n\tfunction AnimationClip( name, duration, tracks ) {\r\n\r\n\t\tthis.name = name;\r\n\t\tthis.tracks = tracks;\r\n\t\tthis.duration = ( duration !== undefined ) ? duration : - 1;\r\n\r\n\t\tthis.uuid = _Math.generateUUID();\r\n\r\n\t\t// this means it should figure out its duration by scanning the tracks\r\n\t\tif ( this.duration < 0 ) {\r\n\r\n\t\t\tthis.resetDuration();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction getTrackTypeForValueTypeName( typeName ) {\r\n\r\n\t\tswitch ( typeName.toLowerCase() ) {\r\n\r\n\t\t\tcase 'scalar':\r\n\t\t\tcase 'double':\r\n\t\t\tcase 'float':\r\n\t\t\tcase 'number':\r\n\t\t\tcase 'integer':\r\n\r\n\t\t\t\treturn NumberKeyframeTrack;\r\n\r\n\t\t\tcase 'vector':\r\n\t\t\tcase 'vector2':\r\n\t\t\tcase 'vector3':\r\n\t\t\tcase 'vector4':\r\n\r\n\t\t\t\treturn VectorKeyframeTrack;\r\n\r\n\t\t\tcase 'color':\r\n\r\n\t\t\t\treturn ColorKeyframeTrack;\r\n\r\n\t\t\tcase 'quaternion':\r\n\r\n\t\t\t\treturn QuaternionKeyframeTrack;\r\n\r\n\t\t\tcase 'bool':\r\n\t\t\tcase 'boolean':\r\n\r\n\t\t\t\treturn BooleanKeyframeTrack;\r\n\r\n\t\t\tcase 'string':\r\n\r\n\t\t\t\treturn StringKeyframeTrack;\r\n\r\n\t\t}\r\n\r\n\t\tthrow new Error( 'THREE.KeyframeTrack: Unsupported typeName: ' + typeName );\r\n\r\n\t}\r\n\r\n\tfunction parseKeyframeTrack( json ) {\r\n\r\n\t\tif ( json.type === undefined ) {\r\n\r\n\t\t\tthrow new Error( 'THREE.KeyframeTrack: track type undefined, can not parse' );\r\n\r\n\t\t}\r\n\r\n\t\tvar trackType = getTrackTypeForValueTypeName( json.type );\r\n\r\n\t\tif ( json.times === undefined ) {\r\n\r\n\t\t\tvar times = [], values = [];\r\n\r\n\t\t\tAnimationUtils.flattenJSON( json.keys, times, values, 'value' );\r\n\r\n\t\t\tjson.times = times;\r\n\t\t\tjson.values = values;\r\n\r\n\t\t}\r\n\r\n\t\t// derived classes can define a static parse method\r\n\t\tif ( trackType.parse !== undefined ) {\r\n\r\n\t\t\treturn trackType.parse( json );\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// by default, we assume a constructor compatible with the base\r\n\t\t\treturn new trackType( json.name, json.times, json.values, json.interpolation );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tObject.assign( AnimationClip, {\r\n\r\n\t\tparse: function ( json ) {\r\n\r\n\t\t\tvar tracks = [],\r\n\t\t\t\tjsonTracks = json.tracks,\r\n\t\t\t\tframeTime = 1.0 / ( json.fps || 1.0 );\r\n\r\n\t\t\tfor ( var i = 0, n = jsonTracks.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\ttracks.push( parseKeyframeTrack( jsonTracks[ i ] ).scale( frameTime ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn new AnimationClip( json.name, json.duration, tracks );\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function ( clip ) {\r\n\r\n\t\t\tvar tracks = [],\r\n\t\t\t\tclipTracks = clip.tracks;\r\n\r\n\t\t\tvar json = {\r\n\r\n\t\t\t\t'name': clip.name,\r\n\t\t\t\t'duration': clip.duration,\r\n\t\t\t\t'tracks': tracks,\r\n\t\t\t\t'uuid': clip.uuid\r\n\r\n\t\t\t};\r\n\r\n\t\t\tfor ( var i = 0, n = clipTracks.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\ttracks.push( KeyframeTrack.toJSON( clipTracks[ i ] ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn json;\r\n\r\n\t\t},\r\n\r\n\t\tCreateFromMorphTargetSequence: function ( name, morphTargetSequence, fps, noLoop ) {\r\n\r\n\t\t\tvar numMorphTargets = morphTargetSequence.length;\r\n\t\t\tvar tracks = [];\r\n\r\n\t\t\tfor ( var i = 0; i < numMorphTargets; i ++ ) {\r\n\r\n\t\t\t\tvar times = [];\r\n\t\t\t\tvar values = [];\r\n\r\n\t\t\t\ttimes.push(\r\n\t\t\t\t\t( i + numMorphTargets - 1 ) % numMorphTargets,\r\n\t\t\t\t\ti,\r\n\t\t\t\t\t( i + 1 ) % numMorphTargets );\r\n\r\n\t\t\t\tvalues.push( 0, 1, 0 );\r\n\r\n\t\t\t\tvar order = AnimationUtils.getKeyframeOrder( times );\r\n\t\t\t\ttimes = AnimationUtils.sortedArray( times, 1, order );\r\n\t\t\t\tvalues = AnimationUtils.sortedArray( values, 1, order );\r\n\r\n\t\t\t\t// if there is a key at the first frame, duplicate it as the\r\n\t\t\t\t// last frame as well for perfect loop.\r\n\t\t\t\tif ( ! noLoop && times[ 0 ] === 0 ) {\r\n\r\n\t\t\t\t\ttimes.push( numMorphTargets );\r\n\t\t\t\t\tvalues.push( values[ 0 ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttracks.push(\r\n\t\t\t\t\tnew NumberKeyframeTrack(\r\n\t\t\t\t\t\t'.morphTargetInfluences[' + morphTargetSequence[ i ].name + ']',\r\n\t\t\t\t\t\ttimes, values\r\n\t\t\t\t\t).scale( 1.0 / fps ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn new AnimationClip( name, - 1, tracks );\r\n\r\n\t\t},\r\n\r\n\t\tfindByName: function ( objectOrClipArray, name ) {\r\n\r\n\t\t\tvar clipArray = objectOrClipArray;\r\n\r\n\t\t\tif ( ! Array.isArray( objectOrClipArray ) ) {\r\n\r\n\t\t\t\tvar o = objectOrClipArray;\r\n\t\t\t\tclipArray = o.geometry && o.geometry.animations || o.animations;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var i = 0; i < clipArray.length; i ++ ) {\r\n\r\n\t\t\t\tif ( clipArray[ i ].name === name ) {\r\n\r\n\t\t\t\t\treturn clipArray[ i ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn null;\r\n\r\n\t\t},\r\n\r\n\t\tCreateClipsFromMorphTargetSequences: function ( morphTargets, fps, noLoop ) {\r\n\r\n\t\t\tvar animationToMorphTargets = {};\r\n\r\n\t\t\t// tested with https://regex101.com/ on trick sequences\r\n\t\t\t// such flamingo_flyA_003, flamingo_run1_003, crdeath0059\r\n\t\t\tvar pattern = /^([\\w-]*?)([\\d]+)$/;\r\n\r\n\t\t\t// sort morph target names into animation groups based\r\n\t\t\t// patterns like Walk_001, Walk_002, Run_001, Run_002\r\n\t\t\tfor ( var i = 0, il = morphTargets.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvar morphTarget = morphTargets[ i ];\r\n\t\t\t\tvar parts = morphTarget.name.match( pattern );\r\n\r\n\t\t\t\tif ( parts && parts.length > 1 ) {\r\n\r\n\t\t\t\t\tvar name = parts[ 1 ];\r\n\r\n\t\t\t\t\tvar animationMorphTargets = animationToMorphTargets[ name ];\r\n\t\t\t\t\tif ( ! animationMorphTargets ) {\r\n\r\n\t\t\t\t\t\tanimationToMorphTargets[ name ] = animationMorphTargets = [];\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tanimationMorphTargets.push( morphTarget );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar clips = [];\r\n\r\n\t\t\tfor ( var name in animationToMorphTargets ) {\r\n\r\n\t\t\t\tclips.push( AnimationClip.CreateFromMorphTargetSequence( name, animationToMorphTargets[ name ], fps, noLoop ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn clips;\r\n\r\n\t\t},\r\n\r\n\t\t// parse the animation.hierarchy format\r\n\t\tparseAnimation: function ( animation, bones ) {\r\n\r\n\t\t\tif ( ! animation ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.AnimationClip: No animation in JSONLoader data.' );\r\n\t\t\t\treturn null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar addNonemptyTrack = function ( trackType, trackName, animationKeys, propertyName, destTracks ) {\r\n\r\n\t\t\t\t// only return track if there are actually keys.\r\n\t\t\t\tif ( animationKeys.length !== 0 ) {\r\n\r\n\t\t\t\t\tvar times = [];\r\n\t\t\t\t\tvar values = [];\r\n\r\n\t\t\t\t\tAnimationUtils.flattenJSON( animationKeys, times, values, propertyName );\r\n\r\n\t\t\t\t\t// empty keys are filtered out, so check again\r\n\t\t\t\t\tif ( times.length !== 0 ) {\r\n\r\n\t\t\t\t\t\tdestTracks.push( new trackType( trackName, times, values ) );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\r\n\t\t\tvar tracks = [];\r\n\r\n\t\t\tvar clipName = animation.name || 'default';\r\n\t\t\t// automatic length determination in AnimationClip.\r\n\t\t\tvar duration = animation.length || - 1;\r\n\t\t\tvar fps = animation.fps || 30;\r\n\r\n\t\t\tvar hierarchyTracks = animation.hierarchy || [];\r\n\r\n\t\t\tfor ( var h = 0; h < hierarchyTracks.length; h ++ ) {\r\n\r\n\t\t\t\tvar animationKeys = hierarchyTracks[ h ].keys;\r\n\r\n\t\t\t\t// skip empty tracks\r\n\t\t\t\tif ( ! animationKeys || animationKeys.length === 0 ) continue;\r\n\r\n\t\t\t\t// process morph targets\r\n\t\t\t\tif ( animationKeys[ 0 ].morphTargets ) {\r\n\r\n\t\t\t\t\t// figure out all morph targets used in this track\r\n\t\t\t\t\tvar morphTargetNames = {};\r\n\r\n\t\t\t\t\tfor ( var k = 0; k < animationKeys.length; k ++ ) {\r\n\r\n\t\t\t\t\t\tif ( animationKeys[ k ].morphTargets ) {\r\n\r\n\t\t\t\t\t\t\tfor ( var m = 0; m < animationKeys[ k ].morphTargets.length; m ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tmorphTargetNames[ animationKeys[ k ].morphTargets[ m ] ] = - 1;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// create a track for each morph target with all zero\r\n\t\t\t\t\t// morphTargetInfluences except for the keys in which\r\n\t\t\t\t\t// the morphTarget is named.\r\n\t\t\t\t\tfor ( var morphTargetName in morphTargetNames ) {\r\n\r\n\t\t\t\t\t\tvar times = [];\r\n\t\t\t\t\t\tvar values = [];\r\n\r\n\t\t\t\t\t\tfor ( var m = 0; m !== animationKeys[ k ].morphTargets.length; ++ m ) {\r\n\r\n\t\t\t\t\t\t\tvar animationKey = animationKeys[ k ];\r\n\r\n\t\t\t\t\t\t\ttimes.push( animationKey.time );\r\n\t\t\t\t\t\t\tvalues.push( ( animationKey.morphTarget === morphTargetName ) ? 1 : 0 );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\ttracks.push( new NumberKeyframeTrack( '.morphTargetInfluence[' + morphTargetName + ']', times, values ) );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tduration = morphTargetNames.length * ( fps || 1.0 );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// ...assume skeletal animation\r\n\r\n\t\t\t\t\tvar boneName = '.bones[' + bones[ h ].name + ']';\r\n\r\n\t\t\t\t\taddNonemptyTrack(\r\n\t\t\t\t\t\tVectorKeyframeTrack, boneName + '.position',\r\n\t\t\t\t\t\tanimationKeys, 'pos', tracks );\r\n\r\n\t\t\t\t\taddNonemptyTrack(\r\n\t\t\t\t\t\tQuaternionKeyframeTrack, boneName + '.quaternion',\r\n\t\t\t\t\t\tanimationKeys, 'rot', tracks );\r\n\r\n\t\t\t\t\taddNonemptyTrack(\r\n\t\t\t\t\t\tVectorKeyframeTrack, boneName + '.scale',\r\n\t\t\t\t\t\tanimationKeys, 'scl', tracks );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( tracks.length === 0 ) {\r\n\r\n\t\t\t\treturn null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar clip = new AnimationClip( clipName, duration, tracks );\r\n\r\n\t\t\treturn clip;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( AnimationClip.prototype, {\r\n\r\n\t\tresetDuration: function () {\r\n\r\n\t\t\tvar tracks = this.tracks, duration = 0;\r\n\r\n\t\t\tfor ( var i = 0, n = tracks.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\tvar track = this.tracks[ i ];\r\n\r\n\t\t\t\tduration = Math.max( duration, track.times[ track.times.length - 1 ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.duration = duration;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttrim: function () {\r\n\r\n\t\t\tfor ( var i = 0; i < this.tracks.length; i ++ ) {\r\n\r\n\t\t\t\tthis.tracks[ i ].trim( 0, this.duration );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tvalidate: function () {\r\n\r\n\t\t\tvar valid = true;\r\n\r\n\t\t\tfor ( var i = 0; i < this.tracks.length; i ++ ) {\r\n\r\n\t\t\t\tvalid = valid && this.tracks[ i ].validate();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn valid;\r\n\r\n\t\t},\r\n\r\n\t\toptimize: function () {\r\n\r\n\t\t\tfor ( var i = 0; i < this.tracks.length; i ++ ) {\r\n\r\n\t\t\t\tthis.tracks[ i ].optimize();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction MaterialLoader( manager ) {\r\n\r\n\t\tthis.manager = ( manager !== undefined ) ? manager : DefaultLoadingManager;\r\n\t\tthis.textures = {};\r\n\r\n\t}\r\n\r\n\tObject.assign( MaterialLoader.prototype, {\r\n\r\n\t\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\t\tvar scope = this;\r\n\r\n\t\t\tvar loader = new FileLoader( scope.manager );\r\n\t\t\tloader.load( url, function ( text ) {\r\n\r\n\t\t\t\tonLoad( scope.parse( JSON.parse( text ) ) );\r\n\r\n\t\t\t}, onProgress, onError );\r\n\r\n\t\t},\r\n\r\n\t\tsetTextures: function ( value ) {\r\n\r\n\t\t\tthis.textures = value;\r\n\r\n\t\t},\r\n\r\n\t\tparse: function ( json ) {\r\n\r\n\t\t\tvar textures = this.textures;\r\n\r\n\t\t\tfunction getTexture( name ) {\r\n\r\n\t\t\t\tif ( textures[ name ] === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.MaterialLoader: Undefined texture', name );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn textures[ name ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar material = new Materials[ json.type ]();\r\n\r\n\t\t\tif ( json.uuid !== undefined ) material.uuid = json.uuid;\r\n\t\t\tif ( json.name !== undefined ) material.name = json.name;\r\n\t\t\tif ( json.color !== undefined ) material.color.setHex( json.color );\r\n\t\t\tif ( json.roughness !== undefined ) material.roughness = json.roughness;\r\n\t\t\tif ( json.metalness !== undefined ) material.metalness = json.metalness;\r\n\t\t\tif ( json.emissive !== undefined ) material.emissive.setHex( json.emissive );\r\n\t\t\tif ( json.specular !== undefined ) material.specular.setHex( json.specular );\r\n\t\t\tif ( json.shininess !== undefined ) material.shininess = json.shininess;\r\n\t\t\tif ( json.clearCoat !== undefined ) material.clearCoat = json.clearCoat;\r\n\t\t\tif ( json.clearCoatRoughness !== undefined ) material.clearCoatRoughness = json.clearCoatRoughness;\r\n\t\t\tif ( json.vertexColors !== undefined ) material.vertexColors = json.vertexColors;\r\n\t\t\tif ( json.fog !== undefined ) material.fog = json.fog;\r\n\t\t\tif ( json.flatShading !== undefined ) material.flatShading = json.flatShading;\r\n\t\t\tif ( json.blending !== undefined ) material.blending = json.blending;\r\n\t\t\tif ( json.side !== undefined ) material.side = json.side;\r\n\t\t\tif ( json.opacity !== undefined ) material.opacity = json.opacity;\r\n\t\t\tif ( json.transparent !== undefined ) material.transparent = json.transparent;\r\n\t\t\tif ( json.alphaTest !== undefined ) material.alphaTest = json.alphaTest;\r\n\t\t\tif ( json.depthTest !== undefined ) material.depthTest = json.depthTest;\r\n\t\t\tif ( json.depthWrite !== undefined ) material.depthWrite = json.depthWrite;\r\n\t\t\tif ( json.colorWrite !== undefined ) material.colorWrite = json.colorWrite;\r\n\t\t\tif ( json.wireframe !== undefined ) material.wireframe = json.wireframe;\r\n\t\t\tif ( json.wireframeLinewidth !== undefined ) material.wireframeLinewidth = json.wireframeLinewidth;\r\n\t\t\tif ( json.wireframeLinecap !== undefined ) material.wireframeLinecap = json.wireframeLinecap;\r\n\t\t\tif ( json.wireframeLinejoin !== undefined ) material.wireframeLinejoin = json.wireframeLinejoin;\r\n\r\n\t\t\tif ( json.rotation !== undefined ) material.rotation = json.rotation;\r\n\r\n\t\t\tif ( json.linewidth !== 1 ) material.linewidth = json.linewidth;\r\n\t\t\tif ( json.dashSize !== undefined ) material.dashSize = json.dashSize;\r\n\t\t\tif ( json.gapSize !== undefined ) material.gapSize = json.gapSize;\r\n\t\t\tif ( json.scale !== undefined ) material.scale = json.scale;\r\n\r\n\t\t\tif ( json.polygonOffset !== undefined ) material.polygonOffset = json.polygonOffset;\r\n\t\t\tif ( json.polygonOffsetFactor !== undefined ) material.polygonOffsetFactor = json.polygonOffsetFactor;\r\n\t\t\tif ( json.polygonOffsetUnits !== undefined ) material.polygonOffsetUnits = json.polygonOffsetUnits;\r\n\r\n\t\t\tif ( json.skinning !== undefined ) material.skinning = json.skinning;\r\n\t\t\tif ( json.morphTargets !== undefined ) material.morphTargets = json.morphTargets;\r\n\t\t\tif ( json.dithering !== undefined ) material.dithering = json.dithering;\r\n\r\n\t\t\tif ( json.visible !== undefined ) material.visible = json.visible;\r\n\t\t\tif ( json.userData !== undefined ) material.userData = json.userData;\r\n\r\n\t\t\t// Shader Material\r\n\r\n\t\t\tif ( json.uniforms !== undefined ) {\r\n\r\n\t\t\t\tfor ( var name in json.uniforms ) {\r\n\r\n\t\t\t\t\tvar uniform = json.uniforms[ name ];\r\n\r\n\t\t\t\t\tmaterial.uniforms[ name ] = {};\r\n\r\n\t\t\t\t\tswitch ( uniform.type ) {\r\n\r\n\t\t\t\t\t\tcase 't':\r\n\t\t\t\t\t\t\tmaterial.uniforms[ name ].value = getTexture( uniform.value );\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'c':\r\n\t\t\t\t\t\t\tmaterial.uniforms[ name ].value = new Color().setHex( uniform.value );\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'v2':\r\n\t\t\t\t\t\t\tmaterial.uniforms[ name ].value = new Vector2().fromArray( uniform.value );\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'v3':\r\n\t\t\t\t\t\t\tmaterial.uniforms[ name ].value = new Vector3().fromArray( uniform.value );\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'v4':\r\n\t\t\t\t\t\t\tmaterial.uniforms[ name ].value = new Vector4().fromArray( uniform.value );\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'm4':\r\n\t\t\t\t\t\t\tmaterial.uniforms[ name ].value = new Matrix4().fromArray( uniform.value );\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\tmaterial.uniforms[ name ].value = uniform.value;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( json.defines !== undefined ) material.defines = json.defines;\r\n\t\t\tif ( json.vertexShader !== undefined ) material.vertexShader = json.vertexShader;\r\n\t\t\tif ( json.fragmentShader !== undefined ) material.fragmentShader = json.fragmentShader;\r\n\r\n\t\t\t// Deprecated\r\n\r\n\t\t\tif ( json.shading !== undefined ) material.flatShading = json.shading === 1; // THREE.FlatShading\r\n\r\n\t\t\t// for PointsMaterial\r\n\r\n\t\t\tif ( json.size !== undefined ) material.size = json.size;\r\n\t\t\tif ( json.sizeAttenuation !== undefined ) material.sizeAttenuation = json.sizeAttenuation;\r\n\r\n\t\t\t// maps\r\n\r\n\t\t\tif ( json.map !== undefined ) material.map = getTexture( json.map );\r\n\r\n\t\t\tif ( json.alphaMap !== undefined ) {\r\n\r\n\t\t\t\tmaterial.alphaMap = getTexture( json.alphaMap );\r\n\t\t\t\tmaterial.transparent = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( json.bumpMap !== undefined ) material.bumpMap = getTexture( json.bumpMap );\r\n\t\t\tif ( json.bumpScale !== undefined ) material.bumpScale = json.bumpScale;\r\n\r\n\t\t\tif ( json.normalMap !== undefined ) material.normalMap = getTexture( json.normalMap );\r\n\t\t\tif ( json.normalMapType !== undefined ) material.normalMapType = json.normalMapType;\r\n\t\t\tif ( json.normalScale !== undefined ) {\r\n\r\n\t\t\t\tvar normalScale = json.normalScale;\r\n\r\n\t\t\t\tif ( Array.isArray( normalScale ) === false ) {\r\n\r\n\t\t\t\t\t// Blender exporter used to export a scalar. See #7459\r\n\r\n\t\t\t\t\tnormalScale = [ normalScale, normalScale ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tmaterial.normalScale = new Vector2().fromArray( normalScale );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( json.displacementMap !== undefined ) material.displacementMap = getTexture( json.displacementMap );\r\n\t\t\tif ( json.displacementScale !== undefined ) material.displacementScale = json.displacementScale;\r\n\t\t\tif ( json.displacementBias !== undefined ) material.displacementBias = json.displacementBias;\r\n\r\n\t\t\tif ( json.roughnessMap !== undefined ) material.roughnessMap = getTexture( json.roughnessMap );\r\n\t\t\tif ( json.metalnessMap !== undefined ) material.metalnessMap = getTexture( json.metalnessMap );\r\n\r\n\t\t\tif ( json.emissiveMap !== undefined ) material.emissiveMap = getTexture( json.emissiveMap );\r\n\t\t\tif ( json.emissiveIntensity !== undefined ) material.emissiveIntensity = json.emissiveIntensity;\r\n\r\n\t\t\tif ( json.specularMap !== undefined ) material.specularMap = getTexture( json.specularMap );\r\n\r\n\t\t\tif ( json.envMap !== undefined ) material.envMap = getTexture( json.envMap );\r\n\r\n\t\t\tif ( json.reflectivity !== undefined ) material.reflectivity = json.reflectivity;\r\n\r\n\t\t\tif ( json.lightMap !== undefined ) material.lightMap = getTexture( json.lightMap );\r\n\t\t\tif ( json.lightMapIntensity !== undefined ) material.lightMapIntensity = json.lightMapIntensity;\r\n\r\n\t\t\tif ( json.aoMap !== undefined ) material.aoMap = getTexture( json.aoMap );\r\n\t\t\tif ( json.aoMapIntensity !== undefined ) material.aoMapIntensity = json.aoMapIntensity;\r\n\r\n\t\t\tif ( json.gradientMap !== undefined ) material.gradientMap = getTexture( json.gradientMap );\r\n\r\n\t\t\treturn material;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction BufferGeometryLoader( manager ) {\r\n\r\n\t\tthis.manager = ( manager !== undefined ) ? manager : DefaultLoadingManager;\r\n\r\n\t}\r\n\r\n\tObject.assign( BufferGeometryLoader.prototype, {\r\n\r\n\t\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\t\tvar scope = this;\r\n\r\n\t\t\tvar loader = new FileLoader( scope.manager );\r\n\t\t\tloader.load( url, function ( text ) {\r\n\r\n\t\t\t\tonLoad( scope.parse( JSON.parse( text ) ) );\r\n\r\n\t\t\t}, onProgress, onError );\r\n\r\n\t\t},\r\n\r\n\t\tparse: function ( json ) {\r\n\r\n\t\t\tvar geometry = new BufferGeometry();\r\n\r\n\t\t\tvar index = json.data.index;\r\n\r\n\t\t\tif ( index !== undefined ) {\r\n\r\n\t\t\t\tvar typedArray = new TYPED_ARRAYS[ index.type ]( index.array );\r\n\t\t\t\tgeometry.setIndex( new BufferAttribute( typedArray, 1 ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar attributes = json.data.attributes;\r\n\r\n\t\t\tfor ( var key in attributes ) {\r\n\r\n\t\t\t\tvar attribute = attributes[ key ];\r\n\t\t\t\tvar typedArray = new TYPED_ARRAYS[ attribute.type ]( attribute.array );\r\n\r\n\t\t\t\tgeometry.addAttribute( key, new BufferAttribute( typedArray, attribute.itemSize, attribute.normalized ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar groups = json.data.groups || json.data.drawcalls || json.data.offsets;\r\n\r\n\t\t\tif ( groups !== undefined ) {\r\n\r\n\t\t\t\tfor ( var i = 0, n = groups.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\t\tvar group = groups[ i ];\r\n\r\n\t\t\t\t\tgeometry.addGroup( group.start, group.count, group.materialIndex );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar boundingSphere = json.data.boundingSphere;\r\n\r\n\t\t\tif ( boundingSphere !== undefined ) {\r\n\r\n\t\t\t\tvar center = new Vector3();\r\n\r\n\t\t\t\tif ( boundingSphere.center !== undefined ) {\r\n\r\n\t\t\t\t\tcenter.fromArray( boundingSphere.center );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgeometry.boundingSphere = new Sphere( center, boundingSphere.radius );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn geometry;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tvar TYPED_ARRAYS = {\r\n\t\tInt8Array: Int8Array,\r\n\t\tUint8Array: Uint8Array,\r\n\t\t// Workaround for IE11 pre KB2929437. See #11440\r\n\t\tUint8ClampedArray: typeof Uint8ClampedArray !== 'undefined' ? Uint8ClampedArray : Uint8Array,\r\n\t\tInt16Array: Int16Array,\r\n\t\tUint16Array: Uint16Array,\r\n\t\tInt32Array: Int32Array,\r\n\t\tUint32Array: Uint32Array,\r\n\t\tFloat32Array: Float32Array,\r\n\t\tFloat64Array: Float64Array\r\n\t};\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\r\n\tfunction Loader() {}\r\n\r\n\tLoader.Handlers = {\r\n\r\n\t\thandlers: [],\r\n\r\n\t\tadd: function ( regex, loader ) {\r\n\r\n\t\t\tthis.handlers.push( regex, loader );\r\n\r\n\t\t},\r\n\r\n\t\tget: function ( file ) {\r\n\r\n\t\t\tvar handlers = this.handlers;\r\n\r\n\t\t\tfor ( var i = 0, l = handlers.length; i < l; i += 2 ) {\r\n\r\n\t\t\t\tvar regex = handlers[ i ];\r\n\t\t\t\tvar loader = handlers[ i + 1 ];\r\n\r\n\t\t\t\tif ( regex.test( file ) ) {\r\n\r\n\t\t\t\t\treturn loader;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn null;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tObject.assign( Loader.prototype, {\r\n\r\n\t\tcrossOrigin: 'anonymous',\r\n\r\n\t\tonLoadStart: function () {},\r\n\r\n\t\tonLoadProgress: function () {},\r\n\r\n\t\tonLoadComplete: function () {},\r\n\r\n\t\tinitMaterials: function ( materials, texturePath, crossOrigin ) {\r\n\r\n\t\t\tvar array = [];\r\n\r\n\t\t\tfor ( var i = 0; i < materials.length; ++ i ) {\r\n\r\n\t\t\t\tarray[ i ] = this.createMaterial( materials[ i ], texturePath, crossOrigin );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn array;\r\n\r\n\t\t},\r\n\r\n\t\tcreateMaterial: ( function () {\r\n\r\n\t\t\tvar BlendingMode = {\r\n\t\t\t\tNoBlending: NoBlending,\r\n\t\t\t\tNormalBlending: NormalBlending,\r\n\t\t\t\tAdditiveBlending: AdditiveBlending,\r\n\t\t\t\tSubtractiveBlending: SubtractiveBlending,\r\n\t\t\t\tMultiplyBlending: MultiplyBlending,\r\n\t\t\t\tCustomBlending: CustomBlending\r\n\t\t\t};\r\n\r\n\t\t\tvar color = new Color();\r\n\t\t\tvar textureLoader = new TextureLoader();\r\n\t\t\tvar materialLoader = new MaterialLoader();\r\n\r\n\t\t\treturn function createMaterial( m, texturePath, crossOrigin ) {\r\n\r\n\t\t\t\t// convert from old material format\r\n\r\n\t\t\t\tvar textures = {};\r\n\r\n\t\t\t\tfunction loadTexture( path, repeat, offset, wrap, anisotropy ) {\r\n\r\n\t\t\t\t\tvar fullPath = texturePath + path;\r\n\t\t\t\t\tvar loader = Loader.Handlers.get( fullPath );\r\n\r\n\t\t\t\t\tvar texture;\r\n\r\n\t\t\t\t\tif ( loader !== null ) {\r\n\r\n\t\t\t\t\t\ttexture = loader.load( fullPath );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\ttextureLoader.setCrossOrigin( crossOrigin );\r\n\t\t\t\t\t\ttexture = textureLoader.load( fullPath );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( repeat !== undefined ) {\r\n\r\n\t\t\t\t\t\ttexture.repeat.fromArray( repeat );\r\n\r\n\t\t\t\t\t\tif ( repeat[ 0 ] !== 1 ) texture.wrapS = RepeatWrapping;\r\n\t\t\t\t\t\tif ( repeat[ 1 ] !== 1 ) texture.wrapT = RepeatWrapping;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( offset !== undefined ) {\r\n\r\n\t\t\t\t\t\ttexture.offset.fromArray( offset );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( wrap !== undefined ) {\r\n\r\n\t\t\t\t\t\tif ( wrap[ 0 ] === 'repeat' ) texture.wrapS = RepeatWrapping;\r\n\t\t\t\t\t\tif ( wrap[ 0 ] === 'mirror' ) texture.wrapS = MirroredRepeatWrapping;\r\n\r\n\t\t\t\t\t\tif ( wrap[ 1 ] === 'repeat' ) texture.wrapT = RepeatWrapping;\r\n\t\t\t\t\t\tif ( wrap[ 1 ] === 'mirror' ) texture.wrapT = MirroredRepeatWrapping;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( anisotropy !== undefined ) {\r\n\r\n\t\t\t\t\t\ttexture.anisotropy = anisotropy;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar uuid = _Math.generateUUID();\r\n\r\n\t\t\t\t\ttextures[ uuid ] = texture;\r\n\r\n\t\t\t\t\treturn uuid;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//\r\n\r\n\t\t\t\tvar json = {\r\n\t\t\t\t\tuuid: _Math.generateUUID(),\r\n\t\t\t\t\ttype: 'MeshLambertMaterial'\r\n\t\t\t\t};\r\n\r\n\t\t\t\tfor ( var name in m ) {\r\n\r\n\t\t\t\t\tvar value = m[ name ];\r\n\r\n\t\t\t\t\tswitch ( name ) {\r\n\r\n\t\t\t\t\t\tcase 'DbgColor':\r\n\t\t\t\t\t\tcase 'DbgIndex':\r\n\t\t\t\t\t\tcase 'opticalDensity':\r\n\t\t\t\t\t\tcase 'illumination':\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'DbgName':\r\n\t\t\t\t\t\t\tjson.name = value;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'blending':\r\n\t\t\t\t\t\t\tjson.blending = BlendingMode[ value ];\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'colorAmbient':\r\n\t\t\t\t\t\tcase 'mapAmbient':\r\n\t\t\t\t\t\t\tconsole.warn( 'THREE.Loader.createMaterial:', name, 'is no longer supported.' );\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'colorDiffuse':\r\n\t\t\t\t\t\t\tjson.color = color.fromArray( value ).getHex();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'colorSpecular':\r\n\t\t\t\t\t\t\tjson.specular = color.fromArray( value ).getHex();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'colorEmissive':\r\n\t\t\t\t\t\t\tjson.emissive = color.fromArray( value ).getHex();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'specularCoef':\r\n\t\t\t\t\t\t\tjson.shininess = value;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'shading':\r\n\t\t\t\t\t\t\tif ( value.toLowerCase() === 'basic' ) json.type = 'MeshBasicMaterial';\r\n\t\t\t\t\t\t\tif ( value.toLowerCase() === 'phong' ) json.type = 'MeshPhongMaterial';\r\n\t\t\t\t\t\t\tif ( value.toLowerCase() === 'standard' ) json.type = 'MeshStandardMaterial';\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mapDiffuse':\r\n\t\t\t\t\t\t\tjson.map = loadTexture( value, m.mapDiffuseRepeat, m.mapDiffuseOffset, m.mapDiffuseWrap, m.mapDiffuseAnisotropy );\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mapDiffuseRepeat':\r\n\t\t\t\t\t\tcase 'mapDiffuseOffset':\r\n\t\t\t\t\t\tcase 'mapDiffuseWrap':\r\n\t\t\t\t\t\tcase 'mapDiffuseAnisotropy':\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mapEmissive':\r\n\t\t\t\t\t\t\tjson.emissiveMap = loadTexture( value, m.mapEmissiveRepeat, m.mapEmissiveOffset, m.mapEmissiveWrap, m.mapEmissiveAnisotropy );\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mapEmissiveRepeat':\r\n\t\t\t\t\t\tcase 'mapEmissiveOffset':\r\n\t\t\t\t\t\tcase 'mapEmissiveWrap':\r\n\t\t\t\t\t\tcase 'mapEmissiveAnisotropy':\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mapLight':\r\n\t\t\t\t\t\t\tjson.lightMap = loadTexture( value, m.mapLightRepeat, m.mapLightOffset, m.mapLightWrap, m.mapLightAnisotropy );\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mapLightRepeat':\r\n\t\t\t\t\t\tcase 'mapLightOffset':\r\n\t\t\t\t\t\tcase 'mapLightWrap':\r\n\t\t\t\t\t\tcase 'mapLightAnisotropy':\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mapAO':\r\n\t\t\t\t\t\t\tjson.aoMap = loadTexture( value, m.mapAORepeat, m.mapAOOffset, m.mapAOWrap, m.mapAOAnisotropy );\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mapAORepeat':\r\n\t\t\t\t\t\tcase 'mapAOOffset':\r\n\t\t\t\t\t\tcase 'mapAOWrap':\r\n\t\t\t\t\t\tcase 'mapAOAnisotropy':\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mapBump':\r\n\t\t\t\t\t\t\tjson.bumpMap = loadTexture( value, m.mapBumpRepeat, m.mapBumpOffset, m.mapBumpWrap, m.mapBumpAnisotropy );\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mapBumpScale':\r\n\t\t\t\t\t\t\tjson.bumpScale = value;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mapBumpRepeat':\r\n\t\t\t\t\t\tcase 'mapBumpOffset':\r\n\t\t\t\t\t\tcase 'mapBumpWrap':\r\n\t\t\t\t\t\tcase 'mapBumpAnisotropy':\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mapNormal':\r\n\t\t\t\t\t\t\tjson.normalMap = loadTexture( value, m.mapNormalRepeat, m.mapNormalOffset, m.mapNormalWrap, m.mapNormalAnisotropy );\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mapNormalFactor':\r\n\t\t\t\t\t\t\tjson.normalScale = value;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mapNormalRepeat':\r\n\t\t\t\t\t\tcase 'mapNormalOffset':\r\n\t\t\t\t\t\tcase 'mapNormalWrap':\r\n\t\t\t\t\t\tcase 'mapNormalAnisotropy':\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mapSpecular':\r\n\t\t\t\t\t\t\tjson.specularMap = loadTexture( value, m.mapSpecularRepeat, m.mapSpecularOffset, m.mapSpecularWrap, m.mapSpecularAnisotropy );\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mapSpecularRepeat':\r\n\t\t\t\t\t\tcase 'mapSpecularOffset':\r\n\t\t\t\t\t\tcase 'mapSpecularWrap':\r\n\t\t\t\t\t\tcase 'mapSpecularAnisotropy':\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mapMetalness':\r\n\t\t\t\t\t\t\tjson.metalnessMap = loadTexture( value, m.mapMetalnessRepeat, m.mapMetalnessOffset, m.mapMetalnessWrap, m.mapMetalnessAnisotropy );\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mapMetalnessRepeat':\r\n\t\t\t\t\t\tcase 'mapMetalnessOffset':\r\n\t\t\t\t\t\tcase 'mapMetalnessWrap':\r\n\t\t\t\t\t\tcase 'mapMetalnessAnisotropy':\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mapRoughness':\r\n\t\t\t\t\t\t\tjson.roughnessMap = loadTexture( value, m.mapRoughnessRepeat, m.mapRoughnessOffset, m.mapRoughnessWrap, m.mapRoughnessAnisotropy );\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mapRoughnessRepeat':\r\n\t\t\t\t\t\tcase 'mapRoughnessOffset':\r\n\t\t\t\t\t\tcase 'mapRoughnessWrap':\r\n\t\t\t\t\t\tcase 'mapRoughnessAnisotropy':\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mapAlpha':\r\n\t\t\t\t\t\t\tjson.alphaMap = loadTexture( value, m.mapAlphaRepeat, m.mapAlphaOffset, m.mapAlphaWrap, m.mapAlphaAnisotropy );\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'mapAlphaRepeat':\r\n\t\t\t\t\t\tcase 'mapAlphaOffset':\r\n\t\t\t\t\t\tcase 'mapAlphaWrap':\r\n\t\t\t\t\t\tcase 'mapAlphaAnisotropy':\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'flipSided':\r\n\t\t\t\t\t\t\tjson.side = BackSide;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'doubleSided':\r\n\t\t\t\t\t\t\tjson.side = DoubleSide;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'transparency':\r\n\t\t\t\t\t\t\tconsole.warn( 'THREE.Loader.createMaterial: transparency has been renamed to opacity' );\r\n\t\t\t\t\t\t\tjson.opacity = value;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'depthTest':\r\n\t\t\t\t\t\tcase 'depthWrite':\r\n\t\t\t\t\t\tcase 'colorWrite':\r\n\t\t\t\t\t\tcase 'opacity':\r\n\t\t\t\t\t\tcase 'reflectivity':\r\n\t\t\t\t\t\tcase 'transparent':\r\n\t\t\t\t\t\tcase 'visible':\r\n\t\t\t\t\t\tcase 'wireframe':\r\n\t\t\t\t\t\t\tjson[ name ] = value;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'vertexColors':\r\n\t\t\t\t\t\t\tif ( value === true ) json.vertexColors = VertexColors;\r\n\t\t\t\t\t\t\tif ( value === 'face' ) json.vertexColors = FaceColors;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\tconsole.error( 'THREE.Loader.createMaterial: Unsupported', name, value );\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( json.type === 'MeshBasicMaterial' ) delete json.emissive;\r\n\t\t\t\tif ( json.type !== 'MeshPhongMaterial' ) delete json.specular;\r\n\r\n\t\t\t\tif ( json.opacity < 1 ) json.transparent = true;\r\n\r\n\t\t\t\tmaterialLoader.setTextures( textures );\r\n\r\n\t\t\t\treturn materialLoader.parse( json );\r\n\r\n\t\t\t};\r\n\r\n\t\t} )()\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author Don McCurdy / https://www.donmccurdy.com\r\n\t */\r\n\r\n\tvar LoaderUtils = {\r\n\r\n\t\tdecodeText: function ( array ) {\r\n\r\n\t\t\tif ( typeof TextDecoder !== 'undefined' ) {\r\n\r\n\t\t\t\treturn new TextDecoder().decode( array );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Avoid the String.fromCharCode.apply(null, array) shortcut, which\r\n\t\t\t// throws a \"maximum call stack size exceeded\" error for large arrays.\r\n\r\n\t\t\tvar s = '';\r\n\r\n\t\t\tfor ( var i = 0, il = array.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t// Implicitly assumes little-endian.\r\n\t\t\t\ts += String.fromCharCode( array[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Merges multi-byte utf-8 characters.\r\n\t\t\treturn decodeURIComponent( escape( s ) );\r\n\r\n\t\t},\r\n\r\n\t\textractUrlBase: function ( url ) {\r\n\r\n\t\t\tvar index = url.lastIndexOf( '/' );\r\n\r\n\t\t\tif ( index === - 1 ) return './';\r\n\r\n\t\t\treturn url.substr( 0, index + 1 );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\r\n\tfunction JSONLoader( manager ) {\r\n\r\n\t\tif ( typeof manager === 'boolean' ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.JSONLoader: showStatus parameter has been removed from constructor.' );\r\n\t\t\tmanager = undefined;\r\n\r\n\t\t}\r\n\r\n\t\tthis.manager = ( manager !== undefined ) ? manager : DefaultLoadingManager;\r\n\r\n\t\tthis.withCredentials = false;\r\n\r\n\t}\r\n\r\n\tObject.assign( JSONLoader.prototype, {\r\n\r\n\t\tcrossOrigin: 'anonymous',\r\n\r\n\t\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\t\tvar scope = this;\r\n\r\n\t\t\tvar texturePath = this.texturePath && ( typeof this.texturePath === 'string' ) ? this.texturePath : LoaderUtils.extractUrlBase( url );\r\n\r\n\t\t\tvar loader = new FileLoader( this.manager );\r\n\t\t\tloader.setWithCredentials( this.withCredentials );\r\n\t\t\tloader.load( url, function ( text ) {\r\n\r\n\t\t\t\tvar json = JSON.parse( text );\r\n\t\t\t\tvar metadata = json.metadata;\r\n\r\n\t\t\t\tif ( metadata !== undefined ) {\r\n\r\n\t\t\t\t\tvar type = metadata.type;\r\n\r\n\t\t\t\t\tif ( type !== undefined ) {\r\n\r\n\t\t\t\t\t\tif ( type.toLowerCase() === 'object' ) {\r\n\r\n\t\t\t\t\t\t\tconsole.error( 'THREE.JSONLoader: ' + url + ' should be loaded with THREE.ObjectLoader instead.' );\r\n\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar object = scope.parse( json, texturePath );\r\n\t\t\t\tonLoad( object.geometry, object.materials );\r\n\r\n\t\t\t}, onProgress, onError );\r\n\r\n\t\t},\r\n\r\n\t\tsetCrossOrigin: function ( value ) {\r\n\r\n\t\t\tthis.crossOrigin = value;\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetTexturePath: function ( value ) {\r\n\r\n\t\t\tthis.texturePath = value;\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tparse: ( function () {\r\n\r\n\t\t\tfunction parseModel( json, geometry ) {\r\n\r\n\t\t\t\tfunction isBitSet( value, position ) {\r\n\r\n\t\t\t\t\treturn value & ( 1 << position );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar i, j, fi,\r\n\r\n\t\t\t\t\toffset, zLength,\r\n\r\n\t\t\t\t\tcolorIndex, normalIndex, uvIndex, materialIndex,\r\n\r\n\t\t\t\t\ttype,\r\n\t\t\t\t\tisQuad,\r\n\t\t\t\t\thasMaterial,\r\n\t\t\t\t\thasFaceVertexUv,\r\n\t\t\t\t\thasFaceNormal, hasFaceVertexNormal,\r\n\t\t\t\t\thasFaceColor, hasFaceVertexColor,\r\n\r\n\t\t\t\t\tvertex, face, faceA, faceB, hex, normal,\r\n\r\n\t\t\t\t\tuvLayer, uv, u, v,\r\n\r\n\t\t\t\t\tfaces = json.faces,\r\n\t\t\t\t\tvertices = json.vertices,\r\n\t\t\t\t\tnormals = json.normals,\r\n\t\t\t\t\tcolors = json.colors,\r\n\r\n\t\t\t\t\tscale = json.scale,\r\n\r\n\t\t\t\t\tnUvLayers = 0;\r\n\r\n\r\n\t\t\t\tif ( json.uvs !== undefined ) {\r\n\r\n\t\t\t\t\t// disregard empty arrays\r\n\r\n\t\t\t\t\tfor ( i = 0; i < json.uvs.length; i ++ ) {\r\n\r\n\t\t\t\t\t\tif ( json.uvs[ i ].length ) nUvLayers ++;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfor ( i = 0; i < nUvLayers; i ++ ) {\r\n\r\n\t\t\t\t\t\tgeometry.faceVertexUvs[ i ] = [];\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\toffset = 0;\r\n\t\t\t\tzLength = vertices.length;\r\n\r\n\t\t\t\twhile ( offset < zLength ) {\r\n\r\n\t\t\t\t\tvertex = new Vector3();\r\n\r\n\t\t\t\t\tvertex.x = vertices[ offset ++ ] * scale;\r\n\t\t\t\t\tvertex.y = vertices[ offset ++ ] * scale;\r\n\t\t\t\t\tvertex.z = vertices[ offset ++ ] * scale;\r\n\r\n\t\t\t\t\tgeometry.vertices.push( vertex );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\toffset = 0;\r\n\t\t\t\tzLength = faces.length;\r\n\r\n\t\t\t\twhile ( offset < zLength ) {\r\n\r\n\t\t\t\t\ttype = faces[ offset ++ ];\r\n\r\n\t\t\t\t\tisQuad = isBitSet( type, 0 );\r\n\t\t\t\t\thasMaterial = isBitSet( type, 1 );\r\n\t\t\t\t\thasFaceVertexUv = isBitSet( type, 3 );\r\n\t\t\t\t\thasFaceNormal = isBitSet( type, 4 );\r\n\t\t\t\t\thasFaceVertexNormal = isBitSet( type, 5 );\r\n\t\t\t\t\thasFaceColor = isBitSet( type, 6 );\r\n\t\t\t\t\thasFaceVertexColor = isBitSet( type, 7 );\r\n\r\n\t\t\t\t\t// console.log(\"type\", type, \"bits\", isQuad, hasMaterial, hasFaceVertexUv, hasFaceNormal, hasFaceVertexNormal, hasFaceColor, hasFaceVertexColor);\r\n\r\n\t\t\t\t\tif ( isQuad ) {\r\n\r\n\t\t\t\t\t\tfaceA = new Face3();\r\n\t\t\t\t\t\tfaceA.a = faces[ offset ];\r\n\t\t\t\t\t\tfaceA.b = faces[ offset + 1 ];\r\n\t\t\t\t\t\tfaceA.c = faces[ offset + 3 ];\r\n\r\n\t\t\t\t\t\tfaceB = new Face3();\r\n\t\t\t\t\t\tfaceB.a = faces[ offset + 1 ];\r\n\t\t\t\t\t\tfaceB.b = faces[ offset + 2 ];\r\n\t\t\t\t\t\tfaceB.c = faces[ offset + 3 ];\r\n\r\n\t\t\t\t\t\toffset += 4;\r\n\r\n\t\t\t\t\t\tif ( hasMaterial ) {\r\n\r\n\t\t\t\t\t\t\tmaterialIndex = faces[ offset ++ ];\r\n\t\t\t\t\t\t\tfaceA.materialIndex = materialIndex;\r\n\t\t\t\t\t\t\tfaceB.materialIndex = materialIndex;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// to get face <=> uv index correspondence\r\n\r\n\t\t\t\t\t\tfi = geometry.faces.length;\r\n\r\n\t\t\t\t\t\tif ( hasFaceVertexUv ) {\r\n\r\n\t\t\t\t\t\t\tfor ( i = 0; i < nUvLayers; i ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tuvLayer = json.uvs[ i ];\r\n\r\n\t\t\t\t\t\t\t\tgeometry.faceVertexUvs[ i ][ fi ] = [];\r\n\t\t\t\t\t\t\t\tgeometry.faceVertexUvs[ i ][ fi + 1 ] = [];\r\n\r\n\t\t\t\t\t\t\t\tfor ( j = 0; j < 4; j ++ ) {\r\n\r\n\t\t\t\t\t\t\t\t\tuvIndex = faces[ offset ++ ];\r\n\r\n\t\t\t\t\t\t\t\t\tu = uvLayer[ uvIndex * 2 ];\r\n\t\t\t\t\t\t\t\t\tv = uvLayer[ uvIndex * 2 + 1 ];\r\n\r\n\t\t\t\t\t\t\t\t\tuv = new Vector2( u, v );\r\n\r\n\t\t\t\t\t\t\t\t\tif ( j !== 2 ) geometry.faceVertexUvs[ i ][ fi ].push( uv );\r\n\t\t\t\t\t\t\t\t\tif ( j !== 0 ) geometry.faceVertexUvs[ i ][ fi + 1 ].push( uv );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif ( hasFaceNormal ) {\r\n\r\n\t\t\t\t\t\t\tnormalIndex = faces[ offset ++ ] * 3;\r\n\r\n\t\t\t\t\t\t\tfaceA.normal.set(\r\n\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\t\tnormals[ normalIndex ]\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tfaceB.normal.copy( faceA.normal );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif ( hasFaceVertexNormal ) {\r\n\r\n\t\t\t\t\t\t\tfor ( i = 0; i < 4; i ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tnormalIndex = faces[ offset ++ ] * 3;\r\n\r\n\t\t\t\t\t\t\t\tnormal = new Vector3(\r\n\t\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\t\t\tnormals[ normalIndex ]\r\n\t\t\t\t\t\t\t\t);\r\n\r\n\r\n\t\t\t\t\t\t\t\tif ( i !== 2 ) faceA.vertexNormals.push( normal );\r\n\t\t\t\t\t\t\t\tif ( i !== 0 ) faceB.vertexNormals.push( normal );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\t\tif ( hasFaceColor ) {\r\n\r\n\t\t\t\t\t\t\tcolorIndex = faces[ offset ++ ];\r\n\t\t\t\t\t\t\thex = colors[ colorIndex ];\r\n\r\n\t\t\t\t\t\t\tfaceA.color.setHex( hex );\r\n\t\t\t\t\t\t\tfaceB.color.setHex( hex );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\t\tif ( hasFaceVertexColor ) {\r\n\r\n\t\t\t\t\t\t\tfor ( i = 0; i < 4; i ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tcolorIndex = faces[ offset ++ ];\r\n\t\t\t\t\t\t\t\thex = colors[ colorIndex ];\r\n\r\n\t\t\t\t\t\t\t\tif ( i !== 2 ) faceA.vertexColors.push( new Color( hex ) );\r\n\t\t\t\t\t\t\t\tif ( i !== 0 ) faceB.vertexColors.push( new Color( hex ) );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tgeometry.faces.push( faceA );\r\n\t\t\t\t\t\tgeometry.faces.push( faceB );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tface = new Face3();\r\n\t\t\t\t\t\tface.a = faces[ offset ++ ];\r\n\t\t\t\t\t\tface.b = faces[ offset ++ ];\r\n\t\t\t\t\t\tface.c = faces[ offset ++ ];\r\n\r\n\t\t\t\t\t\tif ( hasMaterial ) {\r\n\r\n\t\t\t\t\t\t\tmaterialIndex = faces[ offset ++ ];\r\n\t\t\t\t\t\t\tface.materialIndex = materialIndex;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// to get face <=> uv index correspondence\r\n\r\n\t\t\t\t\t\tfi = geometry.faces.length;\r\n\r\n\t\t\t\t\t\tif ( hasFaceVertexUv ) {\r\n\r\n\t\t\t\t\t\t\tfor ( i = 0; i < nUvLayers; i ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tuvLayer = json.uvs[ i ];\r\n\r\n\t\t\t\t\t\t\t\tgeometry.faceVertexUvs[ i ][ fi ] = [];\r\n\r\n\t\t\t\t\t\t\t\tfor ( j = 0; j < 3; j ++ ) {\r\n\r\n\t\t\t\t\t\t\t\t\tuvIndex = faces[ offset ++ ];\r\n\r\n\t\t\t\t\t\t\t\t\tu = uvLayer[ uvIndex * 2 ];\r\n\t\t\t\t\t\t\t\t\tv = uvLayer[ uvIndex * 2 + 1 ];\r\n\r\n\t\t\t\t\t\t\t\t\tuv = new Vector2( u, v );\r\n\r\n\t\t\t\t\t\t\t\t\tgeometry.faceVertexUvs[ i ][ fi ].push( uv );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif ( hasFaceNormal ) {\r\n\r\n\t\t\t\t\t\t\tnormalIndex = faces[ offset ++ ] * 3;\r\n\r\n\t\t\t\t\t\t\tface.normal.set(\r\n\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\t\tnormals[ normalIndex ]\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif ( hasFaceVertexNormal ) {\r\n\r\n\t\t\t\t\t\t\tfor ( i = 0; i < 3; i ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tnormalIndex = faces[ offset ++ ] * 3;\r\n\r\n\t\t\t\t\t\t\t\tnormal = new Vector3(\r\n\t\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\r\n\t\t\t\t\t\t\t\t\tnormals[ normalIndex ]\r\n\t\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\t\tface.vertexNormals.push( normal );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\t\tif ( hasFaceColor ) {\r\n\r\n\t\t\t\t\t\t\tcolorIndex = faces[ offset ++ ];\r\n\t\t\t\t\t\t\tface.color.setHex( colors[ colorIndex ] );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\t\tif ( hasFaceVertexColor ) {\r\n\r\n\t\t\t\t\t\t\tfor ( i = 0; i < 3; i ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tcolorIndex = faces[ offset ++ ];\r\n\t\t\t\t\t\t\t\tface.vertexColors.push( new Color( colors[ colorIndex ] ) );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tgeometry.faces.push( face );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction parseSkin( json, geometry ) {\r\n\r\n\t\t\t\tvar influencesPerVertex = ( json.influencesPerVertex !== undefined ) ? json.influencesPerVertex : 2;\r\n\r\n\t\t\t\tif ( json.skinWeights ) {\r\n\r\n\t\t\t\t\tfor ( var i = 0, l = json.skinWeights.length; i < l; i += influencesPerVertex ) {\r\n\r\n\t\t\t\t\t\tvar x = json.skinWeights[ i ];\r\n\t\t\t\t\t\tvar y = ( influencesPerVertex > 1 ) ? json.skinWeights[ i + 1 ] : 0;\r\n\t\t\t\t\t\tvar z = ( influencesPerVertex > 2 ) ? json.skinWeights[ i + 2 ] : 0;\r\n\t\t\t\t\t\tvar w = ( influencesPerVertex > 3 ) ? json.skinWeights[ i + 3 ] : 0;\r\n\r\n\t\t\t\t\t\tgeometry.skinWeights.push( new Vector4( x, y, z, w ) );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( json.skinIndices ) {\r\n\r\n\t\t\t\t\tfor ( var i = 0, l = json.skinIndices.length; i < l; i += influencesPerVertex ) {\r\n\r\n\t\t\t\t\t\tvar a = json.skinIndices[ i ];\r\n\t\t\t\t\t\tvar b = ( influencesPerVertex > 1 ) ? json.skinIndices[ i + 1 ] : 0;\r\n\t\t\t\t\t\tvar c = ( influencesPerVertex > 2 ) ? json.skinIndices[ i + 2 ] : 0;\r\n\t\t\t\t\t\tvar d = ( influencesPerVertex > 3 ) ? json.skinIndices[ i + 3 ] : 0;\r\n\r\n\t\t\t\t\t\tgeometry.skinIndices.push( new Vector4( a, b, c, d ) );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgeometry.bones = json.bones;\r\n\r\n\t\t\t\tif ( geometry.bones && geometry.bones.length > 0 && ( geometry.skinWeights.length !== geometry.skinIndices.length || geometry.skinIndices.length !== geometry.vertices.length ) ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'When skinning, number of vertices (' + geometry.vertices.length + '), skinIndices (' +\r\n\t\t\t\t\t\tgeometry.skinIndices.length + '), and skinWeights (' + geometry.skinWeights.length + ') should match.' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction parseMorphing( json, geometry ) {\r\n\r\n\t\t\t\tvar scale = json.scale;\r\n\r\n\t\t\t\tif ( json.morphTargets !== undefined ) {\r\n\r\n\t\t\t\t\tfor ( var i = 0, l = json.morphTargets.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\t\tgeometry.morphTargets[ i ] = {};\r\n\t\t\t\t\t\tgeometry.morphTargets[ i ].name = json.morphTargets[ i ].name;\r\n\t\t\t\t\t\tgeometry.morphTargets[ i ].vertices = [];\r\n\r\n\t\t\t\t\t\tvar dstVertices = geometry.morphTargets[ i ].vertices;\r\n\t\t\t\t\t\tvar srcVertices = json.morphTargets[ i ].vertices;\r\n\r\n\t\t\t\t\t\tfor ( var v = 0, vl = srcVertices.length; v < vl; v += 3 ) {\r\n\r\n\t\t\t\t\t\t\tvar vertex = new Vector3();\r\n\t\t\t\t\t\t\tvertex.x = srcVertices[ v ] * scale;\r\n\t\t\t\t\t\t\tvertex.y = srcVertices[ v + 1 ] * scale;\r\n\t\t\t\t\t\t\tvertex.z = srcVertices[ v + 2 ] * scale;\r\n\r\n\t\t\t\t\t\t\tdstVertices.push( vertex );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( json.morphColors !== undefined && json.morphColors.length > 0 ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.JSONLoader: \"morphColors\" no longer supported. Using them as face colors.' );\r\n\r\n\t\t\t\t\tvar faces = geometry.faces;\r\n\t\t\t\t\tvar morphColors = json.morphColors[ 0 ].colors;\r\n\r\n\t\t\t\t\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\t\tfaces[ i ].color.fromArray( morphColors, i * 3 );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction parseAnimations( json, geometry ) {\r\n\r\n\t\t\t\tvar outputAnimations = [];\r\n\r\n\t\t\t\t// parse old style Bone/Hierarchy animations\r\n\t\t\t\tvar animations = [];\r\n\r\n\t\t\t\tif ( json.animation !== undefined ) {\r\n\r\n\t\t\t\t\tanimations.push( json.animation );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( json.animations !== undefined ) {\r\n\r\n\t\t\t\t\tif ( json.animations.length ) {\r\n\r\n\t\t\t\t\t\tanimations = animations.concat( json.animations );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tanimations.push( json.animations );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor ( var i = 0; i < animations.length; i ++ ) {\r\n\r\n\t\t\t\t\tvar clip = AnimationClip.parseAnimation( animations[ i ], geometry.bones );\r\n\t\t\t\t\tif ( clip ) outputAnimations.push( clip );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// parse implicit morph animations\r\n\t\t\t\tif ( geometry.morphTargets ) {\r\n\r\n\t\t\t\t\t// TODO: Figure out what an appropraite FPS is for morph target animations -- defaulting to 10, but really it is completely arbitrary.\r\n\t\t\t\t\tvar morphAnimationClips = AnimationClip.CreateClipsFromMorphTargetSequences( geometry.morphTargets, 10 );\r\n\t\t\t\t\toutputAnimations = outputAnimations.concat( morphAnimationClips );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( outputAnimations.length > 0 ) geometry.animations = outputAnimations;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn function parse( json, texturePath ) {\r\n\r\n\t\t\t\tif ( json.data !== undefined ) {\r\n\r\n\t\t\t\t\t// Geometry 4.0 spec\r\n\t\t\t\t\tjson = json.data;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( json.scale !== undefined ) {\r\n\r\n\t\t\t\t\tjson.scale = 1.0 / json.scale;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tjson.scale = 1.0;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar geometry = new Geometry();\r\n\r\n\t\t\t\tparseModel( json, geometry );\r\n\t\t\t\tparseSkin( json, geometry );\r\n\t\t\t\tparseMorphing( json, geometry );\r\n\t\t\t\tparseAnimations( json, geometry );\r\n\r\n\t\t\t\tgeometry.computeFaceNormals();\r\n\t\t\t\tgeometry.computeBoundingSphere();\r\n\r\n\t\t\t\tif ( json.materials === undefined || json.materials.length === 0 ) {\r\n\r\n\t\t\t\t\treturn { geometry: geometry };\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tvar materials = Loader.prototype.initMaterials( json.materials, texturePath, this.crossOrigin );\r\n\r\n\t\t\t\t\treturn { geometry: geometry, materials: materials };\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\r\n\t\t} )()\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction ObjectLoader( manager ) {\r\n\r\n\t\tthis.manager = ( manager !== undefined ) ? manager : DefaultLoadingManager;\r\n\t\tthis.texturePath = '';\r\n\r\n\t}\r\n\r\n\tObject.assign( ObjectLoader.prototype, {\r\n\r\n\t\tcrossOrigin: 'anonymous',\r\n\r\n\t\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\t\tif ( this.texturePath === '' ) {\r\n\r\n\t\t\t\tthis.texturePath = url.substring( 0, url.lastIndexOf( '/' ) + 1 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar scope = this;\r\n\r\n\t\t\tvar loader = new FileLoader( scope.manager );\r\n\t\t\tloader.load( url, function ( text ) {\r\n\r\n\t\t\t\tvar json = null;\r\n\r\n\t\t\t\ttry {\r\n\r\n\t\t\t\t\tjson = JSON.parse( text );\r\n\r\n\t\t\t\t} catch ( error ) {\r\n\r\n\t\t\t\t\tif ( onError !== undefined ) onError( error );\r\n\r\n\t\t\t\t\tconsole.error( 'THREE:ObjectLoader: Can\\'t parse ' + url + '.', error.message );\r\n\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar metadata = json.metadata;\r\n\r\n\t\t\t\tif ( metadata === undefined || metadata.type === undefined || metadata.type.toLowerCase() === 'geometry' ) {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.ObjectLoader: Can\\'t load ' + url + '. Use THREE.JSONLoader instead.' );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tscope.parse( json, onLoad );\r\n\r\n\t\t\t}, onProgress, onError );\r\n\r\n\t\t},\r\n\r\n\t\tsetTexturePath: function ( value ) {\r\n\r\n\t\t\tthis.texturePath = value;\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetCrossOrigin: function ( value ) {\r\n\r\n\t\t\tthis.crossOrigin = value;\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tparse: function ( json, onLoad ) {\r\n\r\n\t\t\tvar shapes = this.parseShape( json.shapes );\r\n\t\t\tvar geometries = this.parseGeometries( json.geometries, shapes );\r\n\r\n\t\t\tvar images = this.parseImages( json.images, function () {\r\n\r\n\t\t\t\tif ( onLoad !== undefined ) onLoad( object );\r\n\r\n\t\t\t} );\r\n\r\n\t\t\tvar textures = this.parseTextures( json.textures, images );\r\n\t\t\tvar materials = this.parseMaterials( json.materials, textures );\r\n\r\n\t\t\tvar object = this.parseObject( json.object, geometries, materials );\r\n\r\n\t\t\tif ( json.animations ) {\r\n\r\n\t\t\t\tobject.animations = this.parseAnimations( json.animations );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( json.images === undefined || json.images.length === 0 ) {\r\n\r\n\t\t\t\tif ( onLoad !== undefined ) onLoad( object );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn object;\r\n\r\n\t\t},\r\n\r\n\t\tparseShape: function ( json ) {\r\n\r\n\t\t\tvar shapes = {};\r\n\r\n\t\t\tif ( json !== undefined ) {\r\n\r\n\t\t\t\tfor ( var i = 0, l = json.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tvar shape = new Shape().fromJSON( json[ i ] );\r\n\r\n\t\t\t\t\tshapes[ shape.uuid ] = shape;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn shapes;\r\n\r\n\t\t},\r\n\r\n\t\tparseGeometries: function ( json, shapes ) {\r\n\r\n\t\t\tvar geometries = {};\r\n\r\n\t\t\tif ( json !== undefined ) {\r\n\r\n\t\t\t\tvar geometryLoader = new JSONLoader();\r\n\t\t\t\tvar bufferGeometryLoader = new BufferGeometryLoader();\r\n\r\n\t\t\t\tfor ( var i = 0, l = json.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tvar geometry;\r\n\t\t\t\t\tvar data = json[ i ];\r\n\r\n\t\t\t\t\tswitch ( data.type ) {\r\n\r\n\t\t\t\t\t\tcase 'PlaneGeometry':\r\n\t\t\t\t\t\tcase 'PlaneBufferGeometry':\r\n\r\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\r\n\t\t\t\t\t\t\t\tdata.width,\r\n\t\t\t\t\t\t\t\tdata.height,\r\n\t\t\t\t\t\t\t\tdata.widthSegments,\r\n\t\t\t\t\t\t\t\tdata.heightSegments\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'BoxGeometry':\r\n\t\t\t\t\t\tcase 'BoxBufferGeometry':\r\n\t\t\t\t\t\tcase 'CubeGeometry': // backwards compatible\r\n\r\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\r\n\t\t\t\t\t\t\t\tdata.width,\r\n\t\t\t\t\t\t\t\tdata.height,\r\n\t\t\t\t\t\t\t\tdata.depth,\r\n\t\t\t\t\t\t\t\tdata.widthSegments,\r\n\t\t\t\t\t\t\t\tdata.heightSegments,\r\n\t\t\t\t\t\t\t\tdata.depthSegments\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'CircleGeometry':\r\n\t\t\t\t\t\tcase 'CircleBufferGeometry':\r\n\r\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\r\n\t\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\t\tdata.segments,\r\n\t\t\t\t\t\t\t\tdata.thetaStart,\r\n\t\t\t\t\t\t\t\tdata.thetaLength\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'CylinderGeometry':\r\n\t\t\t\t\t\tcase 'CylinderBufferGeometry':\r\n\r\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\r\n\t\t\t\t\t\t\t\tdata.radiusTop,\r\n\t\t\t\t\t\t\t\tdata.radiusBottom,\r\n\t\t\t\t\t\t\t\tdata.height,\r\n\t\t\t\t\t\t\t\tdata.radialSegments,\r\n\t\t\t\t\t\t\t\tdata.heightSegments,\r\n\t\t\t\t\t\t\t\tdata.openEnded,\r\n\t\t\t\t\t\t\t\tdata.thetaStart,\r\n\t\t\t\t\t\t\t\tdata.thetaLength\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'ConeGeometry':\r\n\t\t\t\t\t\tcase 'ConeBufferGeometry':\r\n\r\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\r\n\t\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\t\tdata.height,\r\n\t\t\t\t\t\t\t\tdata.radialSegments,\r\n\t\t\t\t\t\t\t\tdata.heightSegments,\r\n\t\t\t\t\t\t\t\tdata.openEnded,\r\n\t\t\t\t\t\t\t\tdata.thetaStart,\r\n\t\t\t\t\t\t\t\tdata.thetaLength\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'SphereGeometry':\r\n\t\t\t\t\t\tcase 'SphereBufferGeometry':\r\n\r\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\r\n\t\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\t\tdata.widthSegments,\r\n\t\t\t\t\t\t\t\tdata.heightSegments,\r\n\t\t\t\t\t\t\t\tdata.phiStart,\r\n\t\t\t\t\t\t\t\tdata.phiLength,\r\n\t\t\t\t\t\t\t\tdata.thetaStart,\r\n\t\t\t\t\t\t\t\tdata.thetaLength\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'DodecahedronGeometry':\r\n\t\t\t\t\t\tcase 'DodecahedronBufferGeometry':\r\n\t\t\t\t\t\tcase 'IcosahedronGeometry':\r\n\t\t\t\t\t\tcase 'IcosahedronBufferGeometry':\r\n\t\t\t\t\t\tcase 'OctahedronGeometry':\r\n\t\t\t\t\t\tcase 'OctahedronBufferGeometry':\r\n\t\t\t\t\t\tcase 'TetrahedronGeometry':\r\n\t\t\t\t\t\tcase 'TetrahedronBufferGeometry':\r\n\r\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\r\n\t\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\t\tdata.detail\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'RingGeometry':\r\n\t\t\t\t\t\tcase 'RingBufferGeometry':\r\n\r\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\r\n\t\t\t\t\t\t\t\tdata.innerRadius,\r\n\t\t\t\t\t\t\t\tdata.outerRadius,\r\n\t\t\t\t\t\t\t\tdata.thetaSegments,\r\n\t\t\t\t\t\t\t\tdata.phiSegments,\r\n\t\t\t\t\t\t\t\tdata.thetaStart,\r\n\t\t\t\t\t\t\t\tdata.thetaLength\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'TorusGeometry':\r\n\t\t\t\t\t\tcase 'TorusBufferGeometry':\r\n\r\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\r\n\t\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\t\tdata.tube,\r\n\t\t\t\t\t\t\t\tdata.radialSegments,\r\n\t\t\t\t\t\t\t\tdata.tubularSegments,\r\n\t\t\t\t\t\t\t\tdata.arc\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'TorusKnotGeometry':\r\n\t\t\t\t\t\tcase 'TorusKnotBufferGeometry':\r\n\r\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\r\n\t\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\t\tdata.tube,\r\n\t\t\t\t\t\t\t\tdata.tubularSegments,\r\n\t\t\t\t\t\t\t\tdata.radialSegments,\r\n\t\t\t\t\t\t\t\tdata.p,\r\n\t\t\t\t\t\t\t\tdata.q\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'LatheGeometry':\r\n\t\t\t\t\t\tcase 'LatheBufferGeometry':\r\n\r\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\r\n\t\t\t\t\t\t\t\tdata.points,\r\n\t\t\t\t\t\t\t\tdata.segments,\r\n\t\t\t\t\t\t\t\tdata.phiStart,\r\n\t\t\t\t\t\t\t\tdata.phiLength\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'PolyhedronGeometry':\r\n\t\t\t\t\t\tcase 'PolyhedronBufferGeometry':\r\n\r\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\r\n\t\t\t\t\t\t\t\tdata.vertices,\r\n\t\t\t\t\t\t\t\tdata.indices,\r\n\t\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\t\tdata.details\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'ShapeGeometry':\r\n\t\t\t\t\t\tcase 'ShapeBufferGeometry':\r\n\r\n\t\t\t\t\t\t\tvar geometryShapes = [];\r\n\r\n\t\t\t\t\t\t\tfor ( var j = 0, jl = data.shapes.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tvar shape = shapes[ data.shapes[ j ] ];\r\n\r\n\t\t\t\t\t\t\t\tgeometryShapes.push( shape );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\r\n\t\t\t\t\t\t\t\tgeometryShapes,\r\n\t\t\t\t\t\t\t\tdata.curveSegments\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\r\n\t\t\t\t\t\tcase 'ExtrudeGeometry':\r\n\t\t\t\t\t\tcase 'ExtrudeBufferGeometry':\r\n\r\n\t\t\t\t\t\t\tvar geometryShapes = [];\r\n\r\n\t\t\t\t\t\t\tfor ( var j = 0, jl = data.shapes.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tvar shape = shapes[ data.shapes[ j ] ];\r\n\r\n\t\t\t\t\t\t\t\tgeometryShapes.push( shape );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tvar extrudePath = data.options.extrudePath;\r\n\r\n\t\t\t\t\t\t\tif ( extrudePath !== undefined ) {\r\n\r\n\t\t\t\t\t\t\t\tdata.options.extrudePath = new Curves[ extrudePath.type ]().fromJSON( extrudePath );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\r\n\t\t\t\t\t\t\t\tgeometryShapes,\r\n\t\t\t\t\t\t\t\tdata.options\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'BufferGeometry':\r\n\r\n\t\t\t\t\t\t\tgeometry = bufferGeometryLoader.parse( data );\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'Geometry':\r\n\r\n\t\t\t\t\t\t\tgeometry = geometryLoader.parse( data, this.texturePath ).geometry;\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tdefault:\r\n\r\n\t\t\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Unsupported geometry type \"' + data.type + '\"' );\r\n\r\n\t\t\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tgeometry.uuid = data.uuid;\r\n\r\n\t\t\t\t\tif ( data.name !== undefined ) geometry.name = data.name;\r\n\t\t\t\t\tif ( geometry.isBufferGeometry === true && data.userData !== undefined ) geometry.userData = data.userData;\r\n\r\n\t\t\t\t\tgeometries[ data.uuid ] = geometry;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn geometries;\r\n\r\n\t\t},\r\n\r\n\t\tparseMaterials: function ( json, textures ) {\r\n\r\n\t\t\tvar materials = {};\r\n\r\n\t\t\tif ( json !== undefined ) {\r\n\r\n\t\t\t\tvar loader = new MaterialLoader();\r\n\t\t\t\tloader.setTextures( textures );\r\n\r\n\t\t\t\tfor ( var i = 0, l = json.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tvar data = json[ i ];\r\n\r\n\t\t\t\t\tif ( data.type === 'MultiMaterial' ) {\r\n\r\n\t\t\t\t\t\t// Deprecated\r\n\r\n\t\t\t\t\t\tvar array = [];\r\n\r\n\t\t\t\t\t\tfor ( var j = 0; j < data.materials.length; j ++ ) {\r\n\r\n\t\t\t\t\t\t\tarray.push( loader.parse( data.materials[ j ] ) );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tmaterials[ data.uuid ] = array;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tmaterials[ data.uuid ] = loader.parse( data );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn materials;\r\n\r\n\t\t},\r\n\r\n\t\tparseAnimations: function ( json ) {\r\n\r\n\t\t\tvar animations = [];\r\n\r\n\t\t\tfor ( var i = 0; i < json.length; i ++ ) {\r\n\r\n\t\t\t\tvar data = json[ i ];\r\n\r\n\t\t\t\tvar clip = AnimationClip.parse( data );\r\n\r\n\t\t\t\tif ( data.uuid !== undefined ) clip.uuid = data.uuid;\r\n\r\n\t\t\t\tanimations.push( clip );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn animations;\r\n\r\n\t\t},\r\n\r\n\t\tparseImages: function ( json, onLoad ) {\r\n\r\n\t\t\tvar scope = this;\r\n\t\t\tvar images = {};\r\n\r\n\t\t\tfunction loadImage( url ) {\r\n\r\n\t\t\t\tscope.manager.itemStart( url );\r\n\r\n\t\t\t\treturn loader.load( url, function () {\r\n\r\n\t\t\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t\t\t}, undefined, function () {\r\n\r\n\t\t\t\t\tscope.manager.itemEnd( url );\r\n\t\t\t\t\tscope.manager.itemError( url );\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( json !== undefined && json.length > 0 ) {\r\n\r\n\t\t\t\tvar manager = new LoadingManager( onLoad );\r\n\r\n\t\t\t\tvar loader = new ImageLoader( manager );\r\n\t\t\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\r\n\t\t\t\tfor ( var i = 0, il = json.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\tvar image = json[ i ];\r\n\t\t\t\t\tvar url = image.url;\r\n\r\n\t\t\t\t\tif ( Array.isArray( url ) ) {\r\n\r\n\t\t\t\t\t\t// load array of images e.g CubeTexture\r\n\r\n\t\t\t\t\t\timages[ image.uuid ] = [];\r\n\r\n\t\t\t\t\t\tfor ( var j = 0, jl = url.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\t\t\tvar currentUrl = url[ j ];\r\n\r\n\t\t\t\t\t\t\tvar path = /^(\\/\\/)|([a-z]+:(\\/\\/)?)/i.test( currentUrl ) ? currentUrl : scope.texturePath + currentUrl;\r\n\r\n\t\t\t\t\t\t\timages[ image.uuid ].push( loadImage( path ) );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// load single image\r\n\r\n\t\t\t\t\t\tvar path = /^(\\/\\/)|([a-z]+:(\\/\\/)?)/i.test( image.url ) ? image.url : scope.texturePath + image.url;\r\n\r\n\t\t\t\t\t\timages[ image.uuid ] = loadImage( path );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn images;\r\n\r\n\t\t},\r\n\r\n\t\tparseTextures: function ( json, images ) {\r\n\r\n\t\t\tfunction parseConstant( value, type ) {\r\n\r\n\t\t\t\tif ( typeof value === 'number' ) return value;\r\n\r\n\t\t\t\tconsole.warn( 'THREE.ObjectLoader.parseTexture: Constant should be in numeric form.', value );\r\n\r\n\t\t\t\treturn type[ value ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar textures = {};\r\n\r\n\t\t\tif ( json !== undefined ) {\r\n\r\n\t\t\t\tfor ( var i = 0, l = json.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tvar data = json[ i ];\r\n\r\n\t\t\t\t\tif ( data.image === undefined ) {\r\n\r\n\t\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: No \"image\" specified for', data.uuid );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( images[ data.image ] === undefined ) {\r\n\r\n\t\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined image', data.image );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar texture;\r\n\r\n\t\t\t\t\tif ( Array.isArray( images[ data.image ] ) ) {\r\n\r\n\t\t\t\t\t\ttexture = new CubeTexture( images[ data.image ] );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\ttexture = new Texture( images[ data.image ] );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\t\t\ttexture.uuid = data.uuid;\r\n\r\n\t\t\t\t\tif ( data.name !== undefined ) texture.name = data.name;\r\n\r\n\t\t\t\t\tif ( data.mapping !== undefined ) texture.mapping = parseConstant( data.mapping, TEXTURE_MAPPING );\r\n\r\n\t\t\t\t\tif ( data.offset !== undefined ) texture.offset.fromArray( data.offset );\r\n\t\t\t\t\tif ( data.repeat !== undefined ) texture.repeat.fromArray( data.repeat );\r\n\t\t\t\t\tif ( data.center !== undefined ) texture.center.fromArray( data.center );\r\n\t\t\t\t\tif ( data.rotation !== undefined ) texture.rotation = data.rotation;\r\n\r\n\t\t\t\t\tif ( data.wrap !== undefined ) {\r\n\r\n\t\t\t\t\t\ttexture.wrapS = parseConstant( data.wrap[ 0 ], TEXTURE_WRAPPING );\r\n\t\t\t\t\t\ttexture.wrapT = parseConstant( data.wrap[ 1 ], TEXTURE_WRAPPING );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( data.format !== undefined ) texture.format = data.format;\r\n\r\n\t\t\t\t\tif ( data.minFilter !== undefined ) texture.minFilter = parseConstant( data.minFilter, TEXTURE_FILTER );\r\n\t\t\t\t\tif ( data.magFilter !== undefined ) texture.magFilter = parseConstant( data.magFilter, TEXTURE_FILTER );\r\n\t\t\t\t\tif ( data.anisotropy !== undefined ) texture.anisotropy = data.anisotropy;\r\n\r\n\t\t\t\t\tif ( data.flipY !== undefined ) texture.flipY = data.flipY;\r\n\r\n\t\t\t\t\ttextures[ data.uuid ] = texture;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn textures;\r\n\r\n\t\t},\r\n\r\n\t\tparseObject: function ( data, geometries, materials ) {\r\n\r\n\t\t\tvar object;\r\n\r\n\t\t\tfunction getGeometry( name ) {\r\n\r\n\t\t\t\tif ( geometries[ name ] === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined geometry', name );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn geometries[ name ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction getMaterial( name ) {\r\n\r\n\t\t\t\tif ( name === undefined ) return undefined;\r\n\r\n\t\t\t\tif ( Array.isArray( name ) ) {\r\n\r\n\t\t\t\t\tvar array = [];\r\n\r\n\t\t\t\t\tfor ( var i = 0, l = name.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\t\tvar uuid = name[ i ];\r\n\r\n\t\t\t\t\t\tif ( materials[ uuid ] === undefined ) {\r\n\r\n\t\t\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined material', uuid );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tarray.push( materials[ uuid ] );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn array;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( materials[ name ] === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined material', name );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn materials[ name ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tswitch ( data.type ) {\r\n\r\n\t\t\t\tcase 'Scene':\r\n\r\n\t\t\t\t\tobject = new Scene();\r\n\r\n\t\t\t\t\tif ( data.background !== undefined ) {\r\n\r\n\t\t\t\t\t\tif ( Number.isInteger( data.background ) ) {\r\n\r\n\t\t\t\t\t\t\tobject.background = new Color( data.background );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( data.fog !== undefined ) {\r\n\r\n\t\t\t\t\t\tif ( data.fog.type === 'Fog' ) {\r\n\r\n\t\t\t\t\t\t\tobject.fog = new Fog( data.fog.color, data.fog.near, data.fog.far );\r\n\r\n\t\t\t\t\t\t} else if ( data.fog.type === 'FogExp2' ) {\r\n\r\n\t\t\t\t\t\t\tobject.fog = new FogExp2( data.fog.color, data.fog.density );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'PerspectiveCamera':\r\n\r\n\t\t\t\t\tobject = new PerspectiveCamera( data.fov, data.aspect, data.near, data.far );\r\n\r\n\t\t\t\t\tif ( data.focus !== undefined ) object.focus = data.focus;\r\n\t\t\t\t\tif ( data.zoom !== undefined ) object.zoom = data.zoom;\r\n\t\t\t\t\tif ( data.filmGauge !== undefined ) object.filmGauge = data.filmGauge;\r\n\t\t\t\t\tif ( data.filmOffset !== undefined ) object.filmOffset = data.filmOffset;\r\n\t\t\t\t\tif ( data.view !== undefined ) object.view = Object.assign( {}, data.view );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'OrthographicCamera':\r\n\r\n\t\t\t\t\tobject = new OrthographicCamera( data.left, data.right, data.top, data.bottom, data.near, data.far );\r\n\r\n\t\t\t\t\tif ( data.zoom !== undefined ) object.zoom = data.zoom;\r\n\t\t\t\t\tif ( data.view !== undefined ) object.view = Object.assign( {}, data.view );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'AmbientLight':\r\n\r\n\t\t\t\t\tobject = new AmbientLight( data.color, data.intensity );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'DirectionalLight':\r\n\r\n\t\t\t\t\tobject = new DirectionalLight( data.color, data.intensity );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'PointLight':\r\n\r\n\t\t\t\t\tobject = new PointLight( data.color, data.intensity, data.distance, data.decay );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'RectAreaLight':\r\n\r\n\t\t\t\t\tobject = new RectAreaLight( data.color, data.intensity, data.width, data.height );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'SpotLight':\r\n\r\n\t\t\t\t\tobject = new SpotLight( data.color, data.intensity, data.distance, data.angle, data.penumbra, data.decay );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'HemisphereLight':\r\n\r\n\t\t\t\t\tobject = new HemisphereLight( data.color, data.groundColor, data.intensity );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'SkinnedMesh':\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.' );\r\n\r\n\t\t\t\tcase 'Mesh':\r\n\r\n\t\t\t\t\tvar geometry = getGeometry( data.geometry );\r\n\t\t\t\t\tvar material = getMaterial( data.material );\r\n\r\n\t\t\t\t\tif ( geometry.bones && geometry.bones.length > 0 ) {\r\n\r\n\t\t\t\t\t\tobject = new SkinnedMesh( geometry, material );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tobject = new Mesh( geometry, material );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'LOD':\r\n\r\n\t\t\t\t\tobject = new LOD();\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'Line':\r\n\r\n\t\t\t\t\tobject = new Line( getGeometry( data.geometry ), getMaterial( data.material ), data.mode );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'LineLoop':\r\n\r\n\t\t\t\t\tobject = new LineLoop( getGeometry( data.geometry ), getMaterial( data.material ) );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'LineSegments':\r\n\r\n\t\t\t\t\tobject = new LineSegments( getGeometry( data.geometry ), getMaterial( data.material ) );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'PointCloud':\r\n\t\t\t\tcase 'Points':\r\n\r\n\t\t\t\t\tobject = new Points( getGeometry( data.geometry ), getMaterial( data.material ) );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'Sprite':\r\n\r\n\t\t\t\t\tobject = new Sprite( getMaterial( data.material ) );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'Group':\r\n\r\n\t\t\t\t\tobject = new Group();\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\r\n\t\t\t\t\tobject = new Object3D();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tobject.uuid = data.uuid;\r\n\r\n\t\t\tif ( data.name !== undefined ) object.name = data.name;\r\n\r\n\t\t\tif ( data.matrix !== undefined ) {\r\n\r\n\t\t\t\tobject.matrix.fromArray( data.matrix );\r\n\r\n\t\t\t\tif ( data.matrixAutoUpdate !== undefined ) object.matrixAutoUpdate = data.matrixAutoUpdate;\r\n\t\t\t\tif ( object.matrixAutoUpdate ) object.matrix.decompose( object.position, object.quaternion, object.scale );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif ( data.position !== undefined ) object.position.fromArray( data.position );\r\n\t\t\t\tif ( data.rotation !== undefined ) object.rotation.fromArray( data.rotation );\r\n\t\t\t\tif ( data.quaternion !== undefined ) object.quaternion.fromArray( data.quaternion );\r\n\t\t\t\tif ( data.scale !== undefined ) object.scale.fromArray( data.scale );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( data.castShadow !== undefined ) object.castShadow = data.castShadow;\r\n\t\t\tif ( data.receiveShadow !== undefined ) object.receiveShadow = data.receiveShadow;\r\n\r\n\t\t\tif ( data.shadow ) {\r\n\r\n\t\t\t\tif ( data.shadow.bias !== undefined ) object.shadow.bias = data.shadow.bias;\r\n\t\t\t\tif ( data.shadow.radius !== undefined ) object.shadow.radius = data.shadow.radius;\r\n\t\t\t\tif ( data.shadow.mapSize !== undefined ) object.shadow.mapSize.fromArray( data.shadow.mapSize );\r\n\t\t\t\tif ( data.shadow.camera !== undefined ) object.shadow.camera = this.parseObject( data.shadow.camera );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( data.visible !== undefined ) object.visible = data.visible;\r\n\t\t\tif ( data.frustumCulled !== undefined ) object.frustumCulled = data.frustumCulled;\r\n\t\t\tif ( data.renderOrder !== undefined ) object.renderOrder = data.renderOrder;\r\n\t\t\tif ( data.userData !== undefined ) object.userData = data.userData;\r\n\t\t\tif ( data.layers !== undefined ) object.layers.mask = data.layers;\r\n\r\n\t\t\tif ( data.children !== undefined ) {\r\n\r\n\t\t\t\tvar children = data.children;\r\n\r\n\t\t\t\tfor ( var i = 0; i < children.length; i ++ ) {\r\n\r\n\t\t\t\t\tobject.add( this.parseObject( children[ i ], geometries, materials ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( data.type === 'LOD' ) {\r\n\r\n\t\t\t\tvar levels = data.levels;\r\n\r\n\t\t\t\tfor ( var l = 0; l < levels.length; l ++ ) {\r\n\r\n\t\t\t\t\tvar level = levels[ l ];\r\n\t\t\t\t\tvar child = object.getObjectByProperty( 'uuid', level.object );\r\n\r\n\t\t\t\t\tif ( child !== undefined ) {\r\n\r\n\t\t\t\t\t\tobject.addLevel( child, level.distance );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn object;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tvar TEXTURE_MAPPING = {\r\n\t\tUVMapping: UVMapping,\r\n\t\tCubeReflectionMapping: CubeReflectionMapping,\r\n\t\tCubeRefractionMapping: CubeRefractionMapping,\r\n\t\tEquirectangularReflectionMapping: EquirectangularReflectionMapping,\r\n\t\tEquirectangularRefractionMapping: EquirectangularRefractionMapping,\r\n\t\tSphericalReflectionMapping: SphericalReflectionMapping,\r\n\t\tCubeUVReflectionMapping: CubeUVReflectionMapping,\r\n\t\tCubeUVRefractionMapping: CubeUVRefractionMapping\r\n\t};\r\n\r\n\tvar TEXTURE_WRAPPING = {\r\n\t\tRepeatWrapping: RepeatWrapping,\r\n\t\tClampToEdgeWrapping: ClampToEdgeWrapping,\r\n\t\tMirroredRepeatWrapping: MirroredRepeatWrapping\r\n\t};\r\n\r\n\tvar TEXTURE_FILTER = {\r\n\t\tNearestFilter: NearestFilter,\r\n\t\tNearestMipMapNearestFilter: NearestMipMapNearestFilter,\r\n\t\tNearestMipMapLinearFilter: NearestMipMapLinearFilter,\r\n\t\tLinearFilter: LinearFilter,\r\n\t\tLinearMipMapNearestFilter: LinearMipMapNearestFilter,\r\n\t\tLinearMipMapLinearFilter: LinearMipMapLinearFilter\r\n\t};\r\n\r\n\t/**\r\n\t * @author thespite / http://clicktorelease.com/\r\n\t */\r\n\r\n\r\n\tfunction ImageBitmapLoader( manager ) {\r\n\r\n\t\tif ( typeof createImageBitmap === 'undefined' ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.ImageBitmapLoader: createImageBitmap() not supported.' );\r\n\r\n\t\t}\r\n\r\n\t\tif ( typeof fetch === 'undefined' ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.ImageBitmapLoader: fetch() not supported.' );\r\n\r\n\t\t}\r\n\r\n\t\tthis.manager = manager !== undefined ? manager : DefaultLoadingManager;\r\n\t\tthis.options = undefined;\r\n\r\n\t}\r\n\r\n\tImageBitmapLoader.prototype = {\r\n\r\n\t\tconstructor: ImageBitmapLoader,\r\n\r\n\t\tsetOptions: function setOptions( options ) {\r\n\r\n\t\t\tthis.options = options;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\t\tif ( url === undefined ) url = '';\r\n\r\n\t\t\tif ( this.path !== undefined ) url = this.path + url;\r\n\r\n\t\t\turl = this.manager.resolveURL( url );\r\n\r\n\t\t\tvar scope = this;\r\n\r\n\t\t\tvar cached = Cache.get( url );\r\n\r\n\t\t\tif ( cached !== undefined ) {\r\n\r\n\t\t\t\tscope.manager.itemStart( url );\r\n\r\n\t\t\t\tsetTimeout( function () {\r\n\r\n\t\t\t\t\tif ( onLoad ) onLoad( cached );\r\n\r\n\t\t\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t\t\t}, 0 );\r\n\r\n\t\t\t\treturn cached;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfetch( url ).then( function ( res ) {\r\n\r\n\t\t\t\treturn res.blob();\r\n\r\n\t\t\t} ).then( function ( blob ) {\r\n\r\n\t\t\t\treturn createImageBitmap( blob, scope.options );\r\n\r\n\t\t\t} ).then( function ( imageBitmap ) {\r\n\r\n\t\t\t\tCache.add( url, imageBitmap );\r\n\r\n\t\t\t\tif ( onLoad ) onLoad( imageBitmap );\r\n\r\n\t\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t\t} ).catch( function ( e ) {\r\n\r\n\t\t\t\tif ( onError ) onError( e );\r\n\r\n\t\t\t\tscope.manager.itemEnd( url );\r\n\t\t\t\tscope.manager.itemError( url );\r\n\r\n\t\t\t} );\r\n\r\n\t\t},\r\n\r\n\t\tsetCrossOrigin: function ( /* value */ ) {\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetPath: function ( value ) {\r\n\r\n\t\t\tthis.path = value;\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\r\n\t * minimal class for proxing functions to Path. Replaces old \"extractSubpaths()\"\r\n\t **/\r\n\r\n\tfunction ShapePath() {\r\n\r\n\t\tthis.type = 'ShapePath';\r\n\r\n\t\tthis.color = new Color();\r\n\r\n\t\tthis.subPaths = [];\r\n\t\tthis.currentPath = null;\r\n\r\n\t}\r\n\r\n\tObject.assign( ShapePath.prototype, {\r\n\r\n\t\tmoveTo: function ( x, y ) {\r\n\r\n\t\t\tthis.currentPath = new Path();\r\n\t\t\tthis.subPaths.push( this.currentPath );\r\n\t\t\tthis.currentPath.moveTo( x, y );\r\n\r\n\t\t},\r\n\r\n\t\tlineTo: function ( x, y ) {\r\n\r\n\t\t\tthis.currentPath.lineTo( x, y );\r\n\r\n\t\t},\r\n\r\n\t\tquadraticCurveTo: function ( aCPx, aCPy, aX, aY ) {\r\n\r\n\t\t\tthis.currentPath.quadraticCurveTo( aCPx, aCPy, aX, aY );\r\n\r\n\t\t},\r\n\r\n\t\tbezierCurveTo: function ( aCP1x, aCP1y, aCP2x, aCP2y, aX, aY ) {\r\n\r\n\t\t\tthis.currentPath.bezierCurveTo( aCP1x, aCP1y, aCP2x, aCP2y, aX, aY );\r\n\r\n\t\t},\r\n\r\n\t\tsplineThru: function ( pts ) {\r\n\r\n\t\t\tthis.currentPath.splineThru( pts );\r\n\r\n\t\t},\r\n\r\n\t\ttoShapes: function ( isCCW, noHoles ) {\r\n\r\n\t\t\tfunction toShapesNoHoles( inSubpaths ) {\r\n\r\n\t\t\t\tvar shapes = [];\r\n\r\n\t\t\t\tfor ( var i = 0, l = inSubpaths.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tvar tmpPath = inSubpaths[ i ];\r\n\r\n\t\t\t\t\tvar tmpShape = new Shape();\r\n\t\t\t\t\ttmpShape.curves = tmpPath.curves;\r\n\r\n\t\t\t\t\tshapes.push( tmpShape );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn shapes;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction isPointInsidePolygon( inPt, inPolygon ) {\r\n\r\n\t\t\t\tvar polyLen = inPolygon.length;\r\n\r\n\t\t\t\t// inPt on polygon contour => immediate success    or\r\n\t\t\t\t// toggling of inside/outside at every single! intersection point of an edge\r\n\t\t\t\t//  with the horizontal line through inPt, left of inPt\r\n\t\t\t\t//  not counting lowerY endpoints of edges and whole edges on that line\r\n\t\t\t\tvar inside = false;\r\n\t\t\t\tfor ( var p = polyLen - 1, q = 0; q < polyLen; p = q ++ ) {\r\n\r\n\t\t\t\t\tvar edgeLowPt = inPolygon[ p ];\r\n\t\t\t\t\tvar edgeHighPt = inPolygon[ q ];\r\n\r\n\t\t\t\t\tvar edgeDx = edgeHighPt.x - edgeLowPt.x;\r\n\t\t\t\t\tvar edgeDy = edgeHighPt.y - edgeLowPt.y;\r\n\r\n\t\t\t\t\tif ( Math.abs( edgeDy ) > Number.EPSILON ) {\r\n\r\n\t\t\t\t\t\t// not parallel\r\n\t\t\t\t\t\tif ( edgeDy < 0 ) {\r\n\r\n\t\t\t\t\t\t\tedgeLowPt = inPolygon[ q ]; edgeDx = - edgeDx;\r\n\t\t\t\t\t\t\tedgeHighPt = inPolygon[ p ]; edgeDy = - edgeDy;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ( ( inPt.y < edgeLowPt.y ) || ( inPt.y > edgeHighPt.y ) ) \t\tcontinue;\r\n\r\n\t\t\t\t\t\tif ( inPt.y === edgeLowPt.y ) {\r\n\r\n\t\t\t\t\t\t\tif ( inPt.x === edgeLowPt.x )\t\treturn\ttrue;\t\t// inPt is on contour ?\r\n\t\t\t\t\t\t\t// continue;\t\t\t\t// no intersection or edgeLowPt => doesn't count !!!\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tvar perpEdge = edgeDy * ( inPt.x - edgeLowPt.x ) - edgeDx * ( inPt.y - edgeLowPt.y );\r\n\t\t\t\t\t\t\tif ( perpEdge === 0 )\t\t\t\treturn\ttrue;\t\t// inPt is on contour ?\r\n\t\t\t\t\t\t\tif ( perpEdge < 0 ) \t\t\t\tcontinue;\r\n\t\t\t\t\t\t\tinside = ! inside;\t\t// true intersection left of inPt\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// parallel or collinear\r\n\t\t\t\t\t\tif ( inPt.y !== edgeLowPt.y ) \t\tcontinue;\t\t\t// parallel\r\n\t\t\t\t\t\t// edge lies on the same horizontal line as inPt\r\n\t\t\t\t\t\tif ( ( ( edgeHighPt.x <= inPt.x ) && ( inPt.x <= edgeLowPt.x ) ) ||\r\n\t\t\t\t\t\t\t ( ( edgeLowPt.x <= inPt.x ) && ( inPt.x <= edgeHighPt.x ) ) )\t\treturn\ttrue;\t// inPt: Point on contour !\r\n\t\t\t\t\t\t// continue;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn\tinside;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar isClockWise = ShapeUtils.isClockWise;\r\n\r\n\t\t\tvar subPaths = this.subPaths;\r\n\t\t\tif ( subPaths.length === 0 ) return [];\r\n\r\n\t\t\tif ( noHoles === true )\treturn\ttoShapesNoHoles( subPaths );\r\n\r\n\r\n\t\t\tvar solid, tmpPath, tmpShape, shapes = [];\r\n\r\n\t\t\tif ( subPaths.length === 1 ) {\r\n\r\n\t\t\t\ttmpPath = subPaths[ 0 ];\r\n\t\t\t\ttmpShape = new Shape();\r\n\t\t\t\ttmpShape.curves = tmpPath.curves;\r\n\t\t\t\tshapes.push( tmpShape );\r\n\t\t\t\treturn shapes;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar holesFirst = ! isClockWise( subPaths[ 0 ].getPoints() );\r\n\t\t\tholesFirst = isCCW ? ! holesFirst : holesFirst;\r\n\r\n\t\t\t// console.log(\"Holes first\", holesFirst);\r\n\r\n\t\t\tvar betterShapeHoles = [];\r\n\t\t\tvar newShapes = [];\r\n\t\t\tvar newShapeHoles = [];\r\n\t\t\tvar mainIdx = 0;\r\n\t\t\tvar tmpPoints;\r\n\r\n\t\t\tnewShapes[ mainIdx ] = undefined;\r\n\t\t\tnewShapeHoles[ mainIdx ] = [];\r\n\r\n\t\t\tfor ( var i = 0, l = subPaths.length; i < l; i ++ ) {\r\n\r\n\t\t\t\ttmpPath = subPaths[ i ];\r\n\t\t\t\ttmpPoints = tmpPath.getPoints();\r\n\t\t\t\tsolid = isClockWise( tmpPoints );\r\n\t\t\t\tsolid = isCCW ? ! solid : solid;\r\n\r\n\t\t\t\tif ( solid ) {\r\n\r\n\t\t\t\t\tif ( ( ! holesFirst ) && ( newShapes[ mainIdx ] ) )\tmainIdx ++;\r\n\r\n\t\t\t\t\tnewShapes[ mainIdx ] = { s: new Shape(), p: tmpPoints };\r\n\t\t\t\t\tnewShapes[ mainIdx ].s.curves = tmpPath.curves;\r\n\r\n\t\t\t\t\tif ( holesFirst )\tmainIdx ++;\r\n\t\t\t\t\tnewShapeHoles[ mainIdx ] = [];\r\n\r\n\t\t\t\t\t//console.log('cw', i);\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tnewShapeHoles[ mainIdx ].push( { h: tmpPath, p: tmpPoints[ 0 ] } );\r\n\r\n\t\t\t\t\t//console.log('ccw', i);\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// only Holes? -> probably all Shapes with wrong orientation\r\n\t\t\tif ( ! newShapes[ 0 ] )\treturn\ttoShapesNoHoles( subPaths );\r\n\r\n\r\n\t\t\tif ( newShapes.length > 1 ) {\r\n\r\n\t\t\t\tvar ambiguous = false;\r\n\t\t\t\tvar toChange = [];\r\n\r\n\t\t\t\tfor ( var sIdx = 0, sLen = newShapes.length; sIdx < sLen; sIdx ++ ) {\r\n\r\n\t\t\t\t\tbetterShapeHoles[ sIdx ] = [];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor ( var sIdx = 0, sLen = newShapes.length; sIdx < sLen; sIdx ++ ) {\r\n\r\n\t\t\t\t\tvar sho = newShapeHoles[ sIdx ];\r\n\r\n\t\t\t\t\tfor ( var hIdx = 0; hIdx < sho.length; hIdx ++ ) {\r\n\r\n\t\t\t\t\t\tvar ho = sho[ hIdx ];\r\n\t\t\t\t\t\tvar hole_unassigned = true;\r\n\r\n\t\t\t\t\t\tfor ( var s2Idx = 0; s2Idx < newShapes.length; s2Idx ++ ) {\r\n\r\n\t\t\t\t\t\t\tif ( isPointInsidePolygon( ho.p, newShapes[ s2Idx ].p ) ) {\r\n\r\n\t\t\t\t\t\t\t\tif ( sIdx !== s2Idx )\ttoChange.push( { froms: sIdx, tos: s2Idx, hole: hIdx } );\r\n\t\t\t\t\t\t\t\tif ( hole_unassigned ) {\r\n\r\n\t\t\t\t\t\t\t\t\thole_unassigned = false;\r\n\t\t\t\t\t\t\t\t\tbetterShapeHoles[ s2Idx ].push( ho );\r\n\r\n\t\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\t\tambiguous = true;\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ( hole_unassigned ) {\r\n\r\n\t\t\t\t\t\t\tbetterShapeHoles[ sIdx ].push( ho );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\t// console.log(\"ambiguous: \", ambiguous);\r\n\t\t\t\tif ( toChange.length > 0 ) {\r\n\r\n\t\t\t\t\t// console.log(\"to change: \", toChange);\r\n\t\t\t\t\tif ( ! ambiguous )\tnewShapeHoles = betterShapeHoles;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar tmpHoles;\r\n\r\n\t\t\tfor ( var i = 0, il = newShapes.length; i < il; i ++ ) {\r\n\r\n\t\t\t\ttmpShape = newShapes[ i ].s;\r\n\t\t\t\tshapes.push( tmpShape );\r\n\t\t\t\ttmpHoles = newShapeHoles[ i ];\r\n\r\n\t\t\t\tfor ( var j = 0, jl = tmpHoles.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\ttmpShape.holes.push( tmpHoles[ j ].h );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//console.log(\"shape\", shapes);\r\n\r\n\t\t\treturn shapes;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\r\n\tfunction Font( data ) {\r\n\r\n\t\tthis.type = 'Font';\r\n\r\n\t\tthis.data = data;\r\n\r\n\t}\r\n\r\n\tObject.assign( Font.prototype, {\r\n\r\n\t\tisFont: true,\r\n\r\n\t\tgenerateShapes: function ( text, size ) {\r\n\r\n\t\t\tif ( size === undefined ) size = 100;\r\n\r\n\t\t\tvar shapes = [];\r\n\t\t\tvar paths = createPaths( text, size, this.data );\r\n\r\n\t\t\tfor ( var p = 0, pl = paths.length; p < pl; p ++ ) {\r\n\r\n\t\t\t\tArray.prototype.push.apply( shapes, paths[ p ].toShapes() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn shapes;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tfunction createPaths( text, size, data ) {\r\n\r\n\t\tvar chars = Array.from ? Array.from( text ) : String( text ).split( '' ); // see #13988\r\n\t\tvar scale = size / data.resolution;\r\n\t\tvar line_height = ( data.boundingBox.yMax - data.boundingBox.yMin + data.underlineThickness ) * scale;\r\n\r\n\t\tvar paths = [];\r\n\r\n\t\tvar offsetX = 0, offsetY = 0;\r\n\r\n\t\tfor ( var i = 0; i < chars.length; i ++ ) {\r\n\r\n\t\t\tvar char = chars[ i ];\r\n\r\n\t\t\tif ( char === '\\n' ) {\r\n\r\n\t\t\t\toffsetX = 0;\r\n\t\t\t\toffsetY -= line_height;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvar ret = createPath( char, scale, offsetX, offsetY, data );\r\n\t\t\t\toffsetX += ret.offsetX;\r\n\t\t\t\tpaths.push( ret.path );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn paths;\r\n\r\n\t}\r\n\r\n\tfunction createPath( char, scale, offsetX, offsetY, data ) {\r\n\r\n\t\tvar glyph = data.glyphs[ char ] || data.glyphs[ '?' ];\r\n\r\n\t\tif ( ! glyph ) return;\r\n\r\n\t\tvar path = new ShapePath();\r\n\r\n\t\tvar x, y, cpx, cpy, cpx1, cpy1, cpx2, cpy2;\r\n\r\n\t\tif ( glyph.o ) {\r\n\r\n\t\t\tvar outline = glyph._cachedOutline || ( glyph._cachedOutline = glyph.o.split( ' ' ) );\r\n\r\n\t\t\tfor ( var i = 0, l = outline.length; i < l; ) {\r\n\r\n\t\t\t\tvar action = outline[ i ++ ];\r\n\r\n\t\t\t\tswitch ( action ) {\r\n\r\n\t\t\t\t\tcase 'm': // moveTo\r\n\r\n\t\t\t\t\t\tx = outline[ i ++ ] * scale + offsetX;\r\n\t\t\t\t\t\ty = outline[ i ++ ] * scale + offsetY;\r\n\r\n\t\t\t\t\t\tpath.moveTo( x, y );\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'l': // lineTo\r\n\r\n\t\t\t\t\t\tx = outline[ i ++ ] * scale + offsetX;\r\n\t\t\t\t\t\ty = outline[ i ++ ] * scale + offsetY;\r\n\r\n\t\t\t\t\t\tpath.lineTo( x, y );\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'q': // quadraticCurveTo\r\n\r\n\t\t\t\t\t\tcpx = outline[ i ++ ] * scale + offsetX;\r\n\t\t\t\t\t\tcpy = outline[ i ++ ] * scale + offsetY;\r\n\t\t\t\t\t\tcpx1 = outline[ i ++ ] * scale + offsetX;\r\n\t\t\t\t\t\tcpy1 = outline[ i ++ ] * scale + offsetY;\r\n\r\n\t\t\t\t\t\tpath.quadraticCurveTo( cpx1, cpy1, cpx, cpy );\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'b': // bezierCurveTo\r\n\r\n\t\t\t\t\t\tcpx = outline[ i ++ ] * scale + offsetX;\r\n\t\t\t\t\t\tcpy = outline[ i ++ ] * scale + offsetY;\r\n\t\t\t\t\t\tcpx1 = outline[ i ++ ] * scale + offsetX;\r\n\t\t\t\t\t\tcpy1 = outline[ i ++ ] * scale + offsetY;\r\n\t\t\t\t\t\tcpx2 = outline[ i ++ ] * scale + offsetX;\r\n\t\t\t\t\t\tcpy2 = outline[ i ++ ] * scale + offsetY;\r\n\r\n\t\t\t\t\t\tpath.bezierCurveTo( cpx1, cpy1, cpx2, cpy2, cpx, cpy );\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn { offsetX: glyph.ha * scale, path: path };\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction FontLoader( manager ) {\r\n\r\n\t\tthis.manager = ( manager !== undefined ) ? manager : DefaultLoadingManager;\r\n\r\n\t}\r\n\r\n\tObject.assign( FontLoader.prototype, {\r\n\r\n\t\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\t\tvar scope = this;\r\n\r\n\t\t\tvar loader = new FileLoader( this.manager );\r\n\t\t\tloader.setPath( this.path );\r\n\t\t\tloader.load( url, function ( text ) {\r\n\r\n\t\t\t\tvar json;\r\n\r\n\t\t\t\ttry {\r\n\r\n\t\t\t\t\tjson = JSON.parse( text );\r\n\r\n\t\t\t\t} catch ( e ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead.' );\r\n\t\t\t\t\tjson = JSON.parse( text.substring( 65, text.length - 2 ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar font = scope.parse( json );\r\n\r\n\t\t\t\tif ( onLoad ) onLoad( font );\r\n\r\n\t\t\t}, onProgress, onError );\r\n\r\n\t\t},\r\n\r\n\t\tparse: function ( json ) {\r\n\r\n\t\t\treturn new Font( json );\r\n\r\n\t\t},\r\n\r\n\t\tsetPath: function ( value ) {\r\n\r\n\t\t\tthis.path = value;\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tvar context;\r\n\r\n\tvar AudioContext = {\r\n\r\n\t\tgetContext: function () {\r\n\r\n\t\t\tif ( context === undefined ) {\r\n\r\n\t\t\t\tcontext = new ( window.AudioContext || window.webkitAudioContext )();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn context;\r\n\r\n\t\t},\r\n\r\n\t\tsetContext: function ( value ) {\r\n\r\n\t\t\tcontext = value;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author Reece Aaron Lecrivain / http://reecenotes.com/\r\n\t */\r\n\r\n\tfunction AudioLoader( manager ) {\r\n\r\n\t\tthis.manager = ( manager !== undefined ) ? manager : DefaultLoadingManager;\r\n\r\n\t}\r\n\r\n\tObject.assign( AudioLoader.prototype, {\r\n\r\n\t\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\t\tvar loader = new FileLoader( this.manager );\r\n\t\t\tloader.setResponseType( 'arraybuffer' );\r\n\t\t\tloader.load( url, function ( buffer ) {\r\n\r\n\t\t\t\t// Create a copy of the buffer. The `decodeAudioData` method\r\n\t\t\t\t// detaches the buffer when complete, preventing reuse.\r\n\t\t\t\tvar bufferCopy = buffer.slice( 0 );\r\n\r\n\t\t\t\tvar context = AudioContext.getContext();\r\n\t\t\t\tcontext.decodeAudioData( bufferCopy, function ( audioBuffer ) {\r\n\r\n\t\t\t\t\tonLoad( audioBuffer );\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t}, onProgress, onError );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction StereoCamera() {\r\n\r\n\t\tthis.type = 'StereoCamera';\r\n\r\n\t\tthis.aspect = 1;\r\n\r\n\t\tthis.eyeSep = 0.064;\r\n\r\n\t\tthis.cameraL = new PerspectiveCamera();\r\n\t\tthis.cameraL.layers.enable( 1 );\r\n\t\tthis.cameraL.matrixAutoUpdate = false;\r\n\r\n\t\tthis.cameraR = new PerspectiveCamera();\r\n\t\tthis.cameraR.layers.enable( 2 );\r\n\t\tthis.cameraR.matrixAutoUpdate = false;\r\n\r\n\t}\r\n\r\n\tObject.assign( StereoCamera.prototype, {\r\n\r\n\t\tupdate: ( function () {\r\n\r\n\t\t\tvar instance, focus, fov, aspect, near, far, zoom, eyeSep;\r\n\r\n\t\t\tvar eyeRight = new Matrix4();\r\n\t\t\tvar eyeLeft = new Matrix4();\r\n\r\n\t\t\treturn function update( camera ) {\r\n\r\n\t\t\t\tvar needsUpdate = instance !== this || focus !== camera.focus || fov !== camera.fov ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t\taspect !== camera.aspect * this.aspect || near !== camera.near ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfar !== camera.far || zoom !== camera.zoom || eyeSep !== this.eyeSep;\r\n\r\n\t\t\t\tif ( needsUpdate ) {\r\n\r\n\t\t\t\t\tinstance = this;\r\n\t\t\t\t\tfocus = camera.focus;\r\n\t\t\t\t\tfov = camera.fov;\r\n\t\t\t\t\taspect = camera.aspect * this.aspect;\r\n\t\t\t\t\tnear = camera.near;\r\n\t\t\t\t\tfar = camera.far;\r\n\t\t\t\t\tzoom = camera.zoom;\r\n\r\n\t\t\t\t\t// Off-axis stereoscopic effect based on\r\n\t\t\t\t\t// http://paulbourke.net/stereographics/stereorender/\r\n\r\n\t\t\t\t\tvar projectionMatrix = camera.projectionMatrix.clone();\r\n\t\t\t\t\teyeSep = this.eyeSep / 2;\r\n\t\t\t\t\tvar eyeSepOnProjection = eyeSep * near / focus;\r\n\t\t\t\t\tvar ymax = ( near * Math.tan( _Math.DEG2RAD * fov * 0.5 ) ) / zoom;\r\n\t\t\t\t\tvar xmin, xmax;\r\n\r\n\t\t\t\t\t// translate xOffset\r\n\r\n\t\t\t\t\teyeLeft.elements[ 12 ] = - eyeSep;\r\n\t\t\t\t\teyeRight.elements[ 12 ] = eyeSep;\r\n\r\n\t\t\t\t\t// for left eye\r\n\r\n\t\t\t\t\txmin = - ymax * aspect + eyeSepOnProjection;\r\n\t\t\t\t\txmax = ymax * aspect + eyeSepOnProjection;\r\n\r\n\t\t\t\t\tprojectionMatrix.elements[ 0 ] = 2 * near / ( xmax - xmin );\r\n\t\t\t\t\tprojectionMatrix.elements[ 8 ] = ( xmax + xmin ) / ( xmax - xmin );\r\n\r\n\t\t\t\t\tthis.cameraL.projectionMatrix.copy( projectionMatrix );\r\n\r\n\t\t\t\t\t// for right eye\r\n\r\n\t\t\t\t\txmin = - ymax * aspect - eyeSepOnProjection;\r\n\t\t\t\t\txmax = ymax * aspect - eyeSepOnProjection;\r\n\r\n\t\t\t\t\tprojectionMatrix.elements[ 0 ] = 2 * near / ( xmax - xmin );\r\n\t\t\t\t\tprojectionMatrix.elements[ 8 ] = ( xmax + xmin ) / ( xmax - xmin );\r\n\r\n\t\t\t\t\tthis.cameraR.projectionMatrix.copy( projectionMatrix );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.cameraL.matrixWorld.copy( camera.matrixWorld ).multiply( eyeLeft );\r\n\t\t\t\tthis.cameraR.matrixWorld.copy( camera.matrixWorld ).multiply( eyeRight );\r\n\r\n\t\t\t};\r\n\r\n\t\t} )()\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * Camera for rendering cube maps\r\n\t *\t- renders scene into axis-aligned cube\r\n\t *\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\r\n\tfunction CubeCamera( near, far, cubeResolution ) {\r\n\r\n\t\tObject3D.call( this );\r\n\r\n\t\tthis.type = 'CubeCamera';\r\n\r\n\t\tvar fov = 90, aspect = 1;\r\n\r\n\t\tvar cameraPX = new PerspectiveCamera( fov, aspect, near, far );\r\n\t\tcameraPX.up.set( 0, - 1, 0 );\r\n\t\tcameraPX.lookAt( new Vector3( 1, 0, 0 ) );\r\n\t\tthis.add( cameraPX );\r\n\r\n\t\tvar cameraNX = new PerspectiveCamera( fov, aspect, near, far );\r\n\t\tcameraNX.up.set( 0, - 1, 0 );\r\n\t\tcameraNX.lookAt( new Vector3( - 1, 0, 0 ) );\r\n\t\tthis.add( cameraNX );\r\n\r\n\t\tvar cameraPY = new PerspectiveCamera( fov, aspect, near, far );\r\n\t\tcameraPY.up.set( 0, 0, 1 );\r\n\t\tcameraPY.lookAt( new Vector3( 0, 1, 0 ) );\r\n\t\tthis.add( cameraPY );\r\n\r\n\t\tvar cameraNY = new PerspectiveCamera( fov, aspect, near, far );\r\n\t\tcameraNY.up.set( 0, 0, - 1 );\r\n\t\tcameraNY.lookAt( new Vector3( 0, - 1, 0 ) );\r\n\t\tthis.add( cameraNY );\r\n\r\n\t\tvar cameraPZ = new PerspectiveCamera( fov, aspect, near, far );\r\n\t\tcameraPZ.up.set( 0, - 1, 0 );\r\n\t\tcameraPZ.lookAt( new Vector3( 0, 0, 1 ) );\r\n\t\tthis.add( cameraPZ );\r\n\r\n\t\tvar cameraNZ = new PerspectiveCamera( fov, aspect, near, far );\r\n\t\tcameraNZ.up.set( 0, - 1, 0 );\r\n\t\tcameraNZ.lookAt( new Vector3( 0, 0, - 1 ) );\r\n\t\tthis.add( cameraNZ );\r\n\r\n\t\tvar options = { format: RGBFormat, magFilter: LinearFilter, minFilter: LinearFilter };\r\n\r\n\t\tthis.renderTarget = new WebGLRenderTargetCube( cubeResolution, cubeResolution, options );\r\n\t\tthis.renderTarget.texture.name = \"CubeCamera\";\r\n\r\n\t\tthis.update = function ( renderer, scene ) {\r\n\r\n\t\t\tif ( this.parent === null ) this.updateMatrixWorld();\r\n\r\n\t\t\tvar renderTarget = this.renderTarget;\r\n\t\t\tvar generateMipmaps = renderTarget.texture.generateMipmaps;\r\n\r\n\t\t\trenderTarget.texture.generateMipmaps = false;\r\n\r\n\t\t\trenderTarget.activeCubeFace = 0;\r\n\t\t\trenderer.render( scene, cameraPX, renderTarget );\r\n\r\n\t\t\trenderTarget.activeCubeFace = 1;\r\n\t\t\trenderer.render( scene, cameraNX, renderTarget );\r\n\r\n\t\t\trenderTarget.activeCubeFace = 2;\r\n\t\t\trenderer.render( scene, cameraPY, renderTarget );\r\n\r\n\t\t\trenderTarget.activeCubeFace = 3;\r\n\t\t\trenderer.render( scene, cameraNY, renderTarget );\r\n\r\n\t\t\trenderTarget.activeCubeFace = 4;\r\n\t\t\trenderer.render( scene, cameraPZ, renderTarget );\r\n\r\n\t\t\trenderTarget.texture.generateMipmaps = generateMipmaps;\r\n\r\n\t\t\trenderTarget.activeCubeFace = 5;\r\n\t\t\trenderer.render( scene, cameraNZ, renderTarget );\r\n\r\n\t\t\trenderer.setRenderTarget( null );\r\n\r\n\t\t};\r\n\r\n\t\tthis.clear = function ( renderer, color, depth, stencil ) {\r\n\r\n\t\t\tvar renderTarget = this.renderTarget;\r\n\r\n\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\trenderTarget.activeCubeFace = i;\r\n\t\t\t\trenderer.setRenderTarget( renderTarget );\r\n\r\n\t\t\t\trenderer.clear( color, depth, stencil );\r\n\r\n\t\t\t}\r\n\r\n\t\t\trenderer.setRenderTarget( null );\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n\tCubeCamera.prototype = Object.create( Object3D.prototype );\r\n\tCubeCamera.prototype.constructor = CubeCamera;\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction AudioListener() {\r\n\r\n\t\tObject3D.call( this );\r\n\r\n\t\tthis.type = 'AudioListener';\r\n\r\n\t\tthis.context = AudioContext.getContext();\r\n\r\n\t\tthis.gain = this.context.createGain();\r\n\t\tthis.gain.connect( this.context.destination );\r\n\r\n\t\tthis.filter = null;\r\n\r\n\t}\r\n\r\n\tAudioListener.prototype = Object.assign( Object.create( Object3D.prototype ), {\r\n\r\n\t\tconstructor: AudioListener,\r\n\r\n\t\tgetInput: function () {\r\n\r\n\t\t\treturn this.gain;\r\n\r\n\t\t},\r\n\r\n\t\tremoveFilter: function ( ) {\r\n\r\n\t\t\tif ( this.filter !== null ) {\r\n\r\n\t\t\t\tthis.gain.disconnect( this.filter );\r\n\t\t\t\tthis.filter.disconnect( this.context.destination );\r\n\t\t\t\tthis.gain.connect( this.context.destination );\r\n\t\t\t\tthis.filter = null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetFilter: function () {\r\n\r\n\t\t\treturn this.filter;\r\n\r\n\t\t},\r\n\r\n\t\tsetFilter: function ( value ) {\r\n\r\n\t\t\tif ( this.filter !== null ) {\r\n\r\n\t\t\t\tthis.gain.disconnect( this.filter );\r\n\t\t\t\tthis.filter.disconnect( this.context.destination );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.gain.disconnect( this.context.destination );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.filter = value;\r\n\t\t\tthis.gain.connect( this.filter );\r\n\t\t\tthis.filter.connect( this.context.destination );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetMasterVolume: function () {\r\n\r\n\t\t\treturn this.gain.gain.value;\r\n\r\n\t\t},\r\n\r\n\t\tsetMasterVolume: function ( value ) {\r\n\r\n\t\t\tthis.gain.gain.setTargetAtTime( value, this.context.currentTime, 0.01 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tupdateMatrixWorld: ( function () {\r\n\r\n\t\t\tvar position = new Vector3();\r\n\t\t\tvar quaternion = new Quaternion();\r\n\t\t\tvar scale = new Vector3();\r\n\r\n\t\t\tvar orientation = new Vector3();\r\n\r\n\t\t\treturn function updateMatrixWorld( force ) {\r\n\r\n\t\t\t\tObject3D.prototype.updateMatrixWorld.call( this, force );\r\n\r\n\t\t\t\tvar listener = this.context.listener;\r\n\t\t\t\tvar up = this.up;\r\n\r\n\t\t\t\tthis.matrixWorld.decompose( position, quaternion, scale );\r\n\r\n\t\t\t\torientation.set( 0, 0, - 1 ).applyQuaternion( quaternion );\r\n\r\n\t\t\t\tif ( listener.positionX ) {\r\n\r\n\t\t\t\t\tlistener.positionX.setValueAtTime( position.x, this.context.currentTime );\r\n\t\t\t\t\tlistener.positionY.setValueAtTime( position.y, this.context.currentTime );\r\n\t\t\t\t\tlistener.positionZ.setValueAtTime( position.z, this.context.currentTime );\r\n\t\t\t\t\tlistener.forwardX.setValueAtTime( orientation.x, this.context.currentTime );\r\n\t\t\t\t\tlistener.forwardY.setValueAtTime( orientation.y, this.context.currentTime );\r\n\t\t\t\t\tlistener.forwardZ.setValueAtTime( orientation.z, this.context.currentTime );\r\n\t\t\t\t\tlistener.upX.setValueAtTime( up.x, this.context.currentTime );\r\n\t\t\t\t\tlistener.upY.setValueAtTime( up.y, this.context.currentTime );\r\n\t\t\t\t\tlistener.upZ.setValueAtTime( up.z, this.context.currentTime );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tlistener.setPosition( position.x, position.y, position.z );\r\n\t\t\t\t\tlistener.setOrientation( orientation.x, orientation.y, orientation.z, up.x, up.y, up.z );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\r\n\t\t} )()\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author Reece Aaron Lecrivain / http://reecenotes.com/\r\n\t */\r\n\r\n\tfunction Audio( listener ) {\r\n\r\n\t\tObject3D.call( this );\r\n\r\n\t\tthis.type = 'Audio';\r\n\r\n\t\tthis.context = listener.context;\r\n\r\n\t\tthis.gain = this.context.createGain();\r\n\t\tthis.gain.connect( listener.getInput() );\r\n\r\n\t\tthis.autoplay = false;\r\n\r\n\t\tthis.buffer = null;\r\n\t\tthis.loop = false;\r\n\t\tthis.startTime = 0;\r\n\t\tthis.offset = 0;\r\n\t\tthis.playbackRate = 1;\r\n\t\tthis.isPlaying = false;\r\n\t\tthis.hasPlaybackControl = true;\r\n\t\tthis.sourceType = 'empty';\r\n\r\n\t\tthis.filters = [];\r\n\r\n\t}\r\n\r\n\tAudio.prototype = Object.assign( Object.create( Object3D.prototype ), {\r\n\r\n\t\tconstructor: Audio,\r\n\r\n\t\tgetOutput: function () {\r\n\r\n\t\t\treturn this.gain;\r\n\r\n\t\t},\r\n\r\n\t\tsetNodeSource: function ( audioNode ) {\r\n\r\n\t\t\tthis.hasPlaybackControl = false;\r\n\t\t\tthis.sourceType = 'audioNode';\r\n\t\t\tthis.source = audioNode;\r\n\t\t\tthis.connect();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetMediaElementSource: function ( mediaElement ) {\r\n\r\n\t\t\tthis.hasPlaybackControl = false;\r\n\t\t\tthis.sourceType = 'mediaNode';\r\n\t\t\tthis.source = this.context.createMediaElementSource( mediaElement );\r\n\t\t\tthis.connect();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetBuffer: function ( audioBuffer ) {\r\n\r\n\t\t\tthis.buffer = audioBuffer;\r\n\t\t\tthis.sourceType = 'buffer';\r\n\r\n\t\t\tif ( this.autoplay ) this.play();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tplay: function () {\r\n\r\n\t\t\tif ( this.isPlaying === true ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Audio: Audio is already playing.' );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.hasPlaybackControl === false ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar source = this.context.createBufferSource();\r\n\r\n\t\t\tsource.buffer = this.buffer;\r\n\t\t\tsource.loop = this.loop;\r\n\t\t\tsource.onended = this.onEnded.bind( this );\r\n\t\t\tsource.playbackRate.setValueAtTime( this.playbackRate, this.startTime );\r\n\t\t\tthis.startTime = this.context.currentTime;\r\n\t\t\tsource.start( this.startTime, this.offset );\r\n\r\n\t\t\tthis.isPlaying = true;\r\n\r\n\t\t\tthis.source = source;\r\n\r\n\t\t\treturn this.connect();\r\n\r\n\t\t},\r\n\r\n\t\tpause: function () {\r\n\r\n\t\t\tif ( this.hasPlaybackControl === false ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.isPlaying === true ) {\r\n\r\n\t\t\t\tthis.source.stop();\r\n\t\t\t\tthis.source.onended = null;\r\n\t\t\t\tthis.offset += ( this.context.currentTime - this.startTime ) * this.playbackRate;\r\n\t\t\t\tthis.isPlaying = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tstop: function () {\r\n\r\n\t\t\tif ( this.hasPlaybackControl === false ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.source.stop();\r\n\t\t\tthis.source.onended = null;\r\n\t\t\tthis.offset = 0;\r\n\t\t\tthis.isPlaying = false;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tconnect: function () {\r\n\r\n\t\t\tif ( this.filters.length > 0 ) {\r\n\r\n\t\t\t\tthis.source.connect( this.filters[ 0 ] );\r\n\r\n\t\t\t\tfor ( var i = 1, l = this.filters.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tthis.filters[ i - 1 ].connect( this.filters[ i ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.filters[ this.filters.length - 1 ].connect( this.getOutput() );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.source.connect( this.getOutput() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tdisconnect: function () {\r\n\r\n\t\t\tif ( this.filters.length > 0 ) {\r\n\r\n\t\t\t\tthis.source.disconnect( this.filters[ 0 ] );\r\n\r\n\t\t\t\tfor ( var i = 1, l = this.filters.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tthis.filters[ i - 1 ].disconnect( this.filters[ i ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.filters[ this.filters.length - 1 ].disconnect( this.getOutput() );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.source.disconnect( this.getOutput() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetFilters: function () {\r\n\r\n\t\t\treturn this.filters;\r\n\r\n\t\t},\r\n\r\n\t\tsetFilters: function ( value ) {\r\n\r\n\t\t\tif ( ! value ) value = [];\r\n\r\n\t\t\tif ( this.isPlaying === true ) {\r\n\r\n\t\t\t\tthis.disconnect();\r\n\t\t\t\tthis.filters = value;\r\n\t\t\t\tthis.connect();\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.filters = value;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetFilter: function () {\r\n\r\n\t\t\treturn this.getFilters()[ 0 ];\r\n\r\n\t\t},\r\n\r\n\t\tsetFilter: function ( filter ) {\r\n\r\n\t\t\treturn this.setFilters( filter ? [ filter ] : [] );\r\n\r\n\t\t},\r\n\r\n\t\tsetPlaybackRate: function ( value ) {\r\n\r\n\t\t\tif ( this.hasPlaybackControl === false ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.playbackRate = value;\r\n\r\n\t\t\tif ( this.isPlaying === true ) {\r\n\r\n\t\t\t\tthis.source.playbackRate.setValueAtTime( this.playbackRate, this.context.currentTime );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetPlaybackRate: function () {\r\n\r\n\t\t\treturn this.playbackRate;\r\n\r\n\t\t},\r\n\r\n\t\tonEnded: function () {\r\n\r\n\t\t\tthis.isPlaying = false;\r\n\r\n\t\t},\r\n\r\n\t\tgetLoop: function () {\r\n\r\n\t\t\tif ( this.hasPlaybackControl === false ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\r\n\t\t\t\treturn false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this.loop;\r\n\r\n\t\t},\r\n\r\n\t\tsetLoop: function ( value ) {\r\n\r\n\t\t\tif ( this.hasPlaybackControl === false ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.loop = value;\r\n\r\n\t\t\tif ( this.isPlaying === true ) {\r\n\r\n\t\t\t\tthis.source.loop = this.loop;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetVolume: function () {\r\n\r\n\t\t\treturn this.gain.gain.value;\r\n\r\n\t\t},\r\n\r\n\t\tsetVolume: function ( value ) {\r\n\r\n\t\t\tthis.gain.gain.setTargetAtTime( value, this.context.currentTime, 0.01 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction PositionalAudio( listener ) {\r\n\r\n\t\tAudio.call( this, listener );\r\n\r\n\t\tthis.panner = this.context.createPanner();\r\n\t\tthis.panner.connect( this.gain );\r\n\r\n\t}\r\n\r\n\tPositionalAudio.prototype = Object.assign( Object.create( Audio.prototype ), {\r\n\r\n\t\tconstructor: PositionalAudio,\r\n\r\n\t\tgetOutput: function () {\r\n\r\n\t\t\treturn this.panner;\r\n\r\n\t\t},\r\n\r\n\t\tgetRefDistance: function () {\r\n\r\n\t\t\treturn this.panner.refDistance;\r\n\r\n\t\t},\r\n\r\n\t\tsetRefDistance: function ( value ) {\r\n\r\n\t\t\tthis.panner.refDistance = value;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetRolloffFactor: function () {\r\n\r\n\t\t\treturn this.panner.rolloffFactor;\r\n\r\n\t\t},\r\n\r\n\t\tsetRolloffFactor: function ( value ) {\r\n\r\n\t\t\tthis.panner.rolloffFactor = value;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetDistanceModel: function () {\r\n\r\n\t\t\treturn this.panner.distanceModel;\r\n\r\n\t\t},\r\n\r\n\t\tsetDistanceModel: function ( value ) {\r\n\r\n\t\t\tthis.panner.distanceModel = value;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetMaxDistance: function () {\r\n\r\n\t\t\treturn this.panner.maxDistance;\r\n\r\n\t\t},\r\n\r\n\t\tsetMaxDistance: function ( value ) {\r\n\r\n\t\t\tthis.panner.maxDistance = value;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetDirectionalCone: function ( coneInnerAngle, coneOuterAngle, coneOuterGain ) {\r\n\r\n\t\t\tthis.panner.coneInnerAngle = coneInnerAngle;\r\n\t\t\tthis.panner.coneOuterAngle = coneOuterAngle;\r\n\t\t\tthis.panner.coneOuterGain = coneOuterGain;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tupdateMatrixWorld: ( function () {\r\n\r\n\t\t\tvar position = new Vector3();\r\n\t\t\tvar quaternion = new Quaternion();\r\n\t\t\tvar scale = new Vector3();\r\n\r\n\t\t\tvar orientation = new Vector3();\r\n\r\n\t\t\treturn function updateMatrixWorld( force ) {\r\n\r\n\t\t\t\tObject3D.prototype.updateMatrixWorld.call( this, force );\r\n\r\n\t\t\t\tvar panner = this.panner;\r\n\t\t\t\tthis.matrixWorld.decompose( position, quaternion, scale );\r\n\r\n\t\t\t\torientation.set( 0, 0, 1 ).applyQuaternion( quaternion );\r\n\r\n\t\t\t\tpanner.setPosition( position.x, position.y, position.z );\r\n\t\t\t\tpanner.setOrientation( orientation.x, orientation.y, orientation.z );\r\n\r\n\t\t\t};\r\n\r\n\t\t} )()\r\n\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction AudioAnalyser( audio, fftSize ) {\r\n\r\n\t\tthis.analyser = audio.context.createAnalyser();\r\n\t\tthis.analyser.fftSize = fftSize !== undefined ? fftSize : 2048;\r\n\r\n\t\tthis.data = new Uint8Array( this.analyser.frequencyBinCount );\r\n\r\n\t\taudio.getOutput().connect( this.analyser );\r\n\r\n\t}\r\n\r\n\tObject.assign( AudioAnalyser.prototype, {\r\n\r\n\t\tgetFrequencyData: function () {\r\n\r\n\t\t\tthis.analyser.getByteFrequencyData( this.data );\r\n\r\n\t\t\treturn this.data;\r\n\r\n\t\t},\r\n\r\n\t\tgetAverageFrequency: function () {\r\n\r\n\t\t\tvar value = 0, data = this.getFrequencyData();\r\n\r\n\t\t\tfor ( var i = 0; i < data.length; i ++ ) {\r\n\r\n\t\t\t\tvalue += data[ i ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn value / data.length;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t *\r\n\t * Buffered scene graph property that allows weighted accumulation.\r\n\t *\r\n\t *\r\n\t * @author Ben Houston / http://clara.io/\r\n\t * @author David Sarno / http://lighthaus.us/\r\n\t * @author tschw\r\n\t */\r\n\r\n\tfunction PropertyMixer( binding, typeName, valueSize ) {\r\n\r\n\t\tthis.binding = binding;\r\n\t\tthis.valueSize = valueSize;\r\n\r\n\t\tvar bufferType = Float64Array,\r\n\t\t\tmixFunction;\r\n\r\n\t\tswitch ( typeName ) {\r\n\r\n\t\t\tcase 'quaternion':\r\n\t\t\t\tmixFunction = this._slerp;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'string':\r\n\t\t\tcase 'bool':\r\n\t\t\t\tbufferType = Array;\r\n\t\t\t\tmixFunction = this._select;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tdefault:\r\n\t\t\t\tmixFunction = this._lerp;\r\n\r\n\t\t}\r\n\r\n\t\tthis.buffer = new bufferType( valueSize * 4 );\r\n\t\t// layout: [ incoming | accu0 | accu1 | orig ]\r\n\t\t//\r\n\t\t// interpolators can use .buffer as their .result\r\n\t\t// the data then goes to 'incoming'\r\n\t\t//\r\n\t\t// 'accu0' and 'accu1' are used frame-interleaved for\r\n\t\t// the cumulative result and are compared to detect\r\n\t\t// changes\r\n\t\t//\r\n\t\t// 'orig' stores the original state of the property\r\n\r\n\t\tthis._mixBufferRegion = mixFunction;\r\n\r\n\t\tthis.cumulativeWeight = 0;\r\n\r\n\t\tthis.useCount = 0;\r\n\t\tthis.referenceCount = 0;\r\n\r\n\t}\r\n\r\n\tObject.assign( PropertyMixer.prototype, {\r\n\r\n\t\t// accumulate data in the 'incoming' region into 'accu<i>'\r\n\t\taccumulate: function ( accuIndex, weight ) {\r\n\r\n\t\t\t// note: happily accumulating nothing when weight = 0, the caller knows\r\n\t\t\t// the weight and shouldn't have made the call in the first place\r\n\r\n\t\t\tvar buffer = this.buffer,\r\n\t\t\t\tstride = this.valueSize,\r\n\t\t\t\toffset = accuIndex * stride + stride,\r\n\r\n\t\t\t\tcurrentWeight = this.cumulativeWeight;\r\n\r\n\t\t\tif ( currentWeight === 0 ) {\r\n\r\n\t\t\t\t// accuN := incoming * weight\r\n\r\n\t\t\t\tfor ( var i = 0; i !== stride; ++ i ) {\r\n\r\n\t\t\t\t\tbuffer[ offset + i ] = buffer[ i ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcurrentWeight = weight;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// accuN := accuN + incoming * weight\r\n\r\n\t\t\t\tcurrentWeight += weight;\r\n\t\t\t\tvar mix = weight / currentWeight;\r\n\t\t\t\tthis._mixBufferRegion( buffer, offset, 0, mix, stride );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.cumulativeWeight = currentWeight;\r\n\r\n\t\t},\r\n\r\n\t\t// apply the state of 'accu<i>' to the binding when accus differ\r\n\t\tapply: function ( accuIndex ) {\r\n\r\n\t\t\tvar stride = this.valueSize,\r\n\t\t\t\tbuffer = this.buffer,\r\n\t\t\t\toffset = accuIndex * stride + stride,\r\n\r\n\t\t\t\tweight = this.cumulativeWeight,\r\n\r\n\t\t\t\tbinding = this.binding;\r\n\r\n\t\t\tthis.cumulativeWeight = 0;\r\n\r\n\t\t\tif ( weight < 1 ) {\r\n\r\n\t\t\t\t// accuN := accuN + original * ( 1 - cumulativeWeight )\r\n\r\n\t\t\t\tvar originalValueOffset = stride * 3;\r\n\r\n\t\t\t\tthis._mixBufferRegion(\r\n\t\t\t\t\tbuffer, offset, originalValueOffset, 1 - weight, stride );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var i = stride, e = stride + stride; i !== e; ++ i ) {\r\n\r\n\t\t\t\tif ( buffer[ i ] !== buffer[ i + stride ] ) {\r\n\r\n\t\t\t\t\t// value has changed -> update scene graph\r\n\r\n\t\t\t\t\tbinding.setValue( buffer, offset );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t// remember the state of the bound property and copy it to both accus\r\n\t\tsaveOriginalState: function () {\r\n\r\n\t\t\tvar binding = this.binding;\r\n\r\n\t\t\tvar buffer = this.buffer,\r\n\t\t\t\tstride = this.valueSize,\r\n\r\n\t\t\t\toriginalValueOffset = stride * 3;\r\n\r\n\t\t\tbinding.getValue( buffer, originalValueOffset );\r\n\r\n\t\t\t// accu[0..1] := orig -- initially detect changes against the original\r\n\t\t\tfor ( var i = stride, e = originalValueOffset; i !== e; ++ i ) {\r\n\r\n\t\t\t\tbuffer[ i ] = buffer[ originalValueOffset + ( i % stride ) ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.cumulativeWeight = 0;\r\n\r\n\t\t},\r\n\r\n\t\t// apply the state previously taken via 'saveOriginalState' to the binding\r\n\t\trestoreOriginalState: function () {\r\n\r\n\t\t\tvar originalValueOffset = this.valueSize * 3;\r\n\t\t\tthis.binding.setValue( this.buffer, originalValueOffset );\r\n\r\n\t\t},\r\n\r\n\r\n\t\t// mix functions\r\n\r\n\t\t_select: function ( buffer, dstOffset, srcOffset, t, stride ) {\r\n\r\n\t\t\tif ( t >= 0.5 ) {\r\n\r\n\t\t\t\tfor ( var i = 0; i !== stride; ++ i ) {\r\n\r\n\t\t\t\t\tbuffer[ dstOffset + i ] = buffer[ srcOffset + i ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t_slerp: function ( buffer, dstOffset, srcOffset, t ) {\r\n\r\n\t\t\tQuaternion.slerpFlat( buffer, dstOffset, buffer, dstOffset, buffer, srcOffset, t );\r\n\r\n\t\t},\r\n\r\n\t\t_lerp: function ( buffer, dstOffset, srcOffset, t, stride ) {\r\n\r\n\t\t\tvar s = 1 - t;\r\n\r\n\t\t\tfor ( var i = 0; i !== stride; ++ i ) {\r\n\r\n\t\t\t\tvar j = dstOffset + i;\r\n\r\n\t\t\t\tbuffer[ j ] = buffer[ j ] * s + buffer[ srcOffset + i ] * t;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t *\r\n\t * A reference to a real property in the scene graph.\r\n\t *\r\n\t *\r\n\t * @author Ben Houston / http://clara.io/\r\n\t * @author David Sarno / http://lighthaus.us/\r\n\t * @author tschw\r\n\t */\r\n\r\n\t// Characters [].:/ are reserved for track binding syntax.\r\n\tvar RESERVED_CHARS_RE = '\\\\[\\\\]\\\\.:\\\\/';\r\n\r\n\tfunction Composite( targetGroup, path, optionalParsedPath ) {\r\n\r\n\t\tvar parsedPath = optionalParsedPath || PropertyBinding.parseTrackName( path );\r\n\r\n\t\tthis._targetGroup = targetGroup;\r\n\t\tthis._bindings = targetGroup.subscribe_( path, parsedPath );\r\n\r\n\t}\r\n\r\n\tObject.assign( Composite.prototype, {\r\n\r\n\t\tgetValue: function ( array, offset ) {\r\n\r\n\t\t\tthis.bind(); // bind all binding\r\n\r\n\t\t\tvar firstValidIndex = this._targetGroup.nCachedObjects_,\r\n\t\t\t\tbinding = this._bindings[ firstValidIndex ];\r\n\r\n\t\t\t// and only call .getValue on the first\r\n\t\t\tif ( binding !== undefined ) binding.getValue( array, offset );\r\n\r\n\t\t},\r\n\r\n\t\tsetValue: function ( array, offset ) {\r\n\r\n\t\t\tvar bindings = this._bindings;\r\n\r\n\t\t\tfor ( var i = this._targetGroup.nCachedObjects_,\r\n\t\t\t\t\t  n = bindings.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\tbindings[ i ].setValue( array, offset );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tbind: function () {\r\n\r\n\t\t\tvar bindings = this._bindings;\r\n\r\n\t\t\tfor ( var i = this._targetGroup.nCachedObjects_,\r\n\t\t\t\t\t  n = bindings.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\tbindings[ i ].bind();\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tunbind: function () {\r\n\r\n\t\t\tvar bindings = this._bindings;\r\n\r\n\t\t\tfor ( var i = this._targetGroup.nCachedObjects_,\r\n\t\t\t\t\t  n = bindings.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\tbindings[ i ].unbind();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\r\n\tfunction PropertyBinding( rootNode, path, parsedPath ) {\r\n\r\n\t\tthis.path = path;\r\n\t\tthis.parsedPath = parsedPath || PropertyBinding.parseTrackName( path );\r\n\r\n\t\tthis.node = PropertyBinding.findNode( rootNode, this.parsedPath.nodeName ) || rootNode;\r\n\r\n\t\tthis.rootNode = rootNode;\r\n\r\n\t}\r\n\r\n\tObject.assign( PropertyBinding, {\r\n\r\n\t\tComposite: Composite,\r\n\r\n\t\tcreate: function ( root, path, parsedPath ) {\r\n\r\n\t\t\tif ( ! ( root && root.isAnimationObjectGroup ) ) {\r\n\r\n\t\t\t\treturn new PropertyBinding( root, path, parsedPath );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\treturn new PropertyBinding.Composite( root, path, parsedPath );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Replaces spaces with underscores and removes unsupported characters from\r\n\t\t * node names, to ensure compatibility with parseTrackName().\r\n\t\t *\r\n\t\t * @param  {string} name Node name to be sanitized.\r\n\t\t * @return {string}\r\n\t\t */\r\n\t\tsanitizeNodeName: ( function () {\r\n\r\n\t\t\tvar reservedRe = new RegExp( '[' + RESERVED_CHARS_RE + ']', 'g' );\r\n\r\n\t\t\treturn function sanitizeNodeName( name ) {\r\n\r\n\t\t\t\treturn name.replace( /\\s/g, '_' ).replace( reservedRe, '' );\r\n\r\n\t\t\t};\r\n\r\n\t\t}() ),\r\n\r\n\t\tparseTrackName: function () {\r\n\r\n\t\t\t// Attempts to allow node names from any language. ES5's `\\w` regexp matches\r\n\t\t\t// only latin characters, and the unicode \\p{L} is not yet supported. So\r\n\t\t\t// instead, we exclude reserved characters and match everything else.\r\n\t\t\tvar wordChar = '[^' + RESERVED_CHARS_RE + ']';\r\n\t\t\tvar wordCharOrDot = '[^' + RESERVED_CHARS_RE.replace( '\\\\.', '' ) + ']';\r\n\r\n\t\t\t// Parent directories, delimited by '/' or ':'. Currently unused, but must\r\n\t\t\t// be matched to parse the rest of the track name.\r\n\t\t\tvar directoryRe = /((?:WC+[\\/:])*)/.source.replace( 'WC', wordChar );\r\n\r\n\t\t\t// Target node. May contain word characters (a-zA-Z0-9_) and '.' or '-'.\r\n\t\t\tvar nodeRe = /(WCOD+)?/.source.replace( 'WCOD', wordCharOrDot );\r\n\r\n\t\t\t// Object on target node, and accessor. May not contain reserved\r\n\t\t\t// characters. Accessor may contain any character except closing bracket.\r\n\t\t\tvar objectRe = /(?:\\.(WC+)(?:\\[(.+)\\])?)?/.source.replace( 'WC', wordChar );\r\n\r\n\t\t\t// Property and accessor. May not contain reserved characters. Accessor may\r\n\t\t\t// contain any non-bracket characters.\r\n\t\t\tvar propertyRe = /\\.(WC+)(?:\\[(.+)\\])?/.source.replace( 'WC', wordChar );\r\n\r\n\t\t\tvar trackRe = new RegExp( ''\r\n\t\t\t\t+ '^'\r\n\t\t\t\t+ directoryRe\r\n\t\t\t\t+ nodeRe\r\n\t\t\t\t+ objectRe\r\n\t\t\t\t+ propertyRe\r\n\t\t\t\t+ '$'\r\n\t\t\t);\r\n\r\n\t\t\tvar supportedObjectNames = [ 'material', 'materials', 'bones' ];\r\n\r\n\t\t\treturn function parseTrackName( trackName ) {\r\n\r\n\t\t\t\tvar matches = trackRe.exec( trackName );\r\n\r\n\t\t\t\tif ( ! matches ) {\r\n\r\n\t\t\t\t\tthrow new Error( 'PropertyBinding: Cannot parse trackName: ' + trackName );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar results = {\r\n\t\t\t\t\t// directoryName: matches[ 1 ], // (tschw) currently unused\r\n\t\t\t\t\tnodeName: matches[ 2 ],\r\n\t\t\t\t\tobjectName: matches[ 3 ],\r\n\t\t\t\t\tobjectIndex: matches[ 4 ],\r\n\t\t\t\t\tpropertyName: matches[ 5 ], // required\r\n\t\t\t\t\tpropertyIndex: matches[ 6 ]\r\n\t\t\t\t};\r\n\r\n\t\t\t\tvar lastDot = results.nodeName && results.nodeName.lastIndexOf( '.' );\r\n\r\n\t\t\t\tif ( lastDot !== undefined && lastDot !== - 1 ) {\r\n\r\n\t\t\t\t\tvar objectName = results.nodeName.substring( lastDot + 1 );\r\n\r\n\t\t\t\t\t// Object names must be checked against a whitelist. Otherwise, there\r\n\t\t\t\t\t// is no way to parse 'foo.bar.baz': 'baz' must be a property, but\r\n\t\t\t\t\t// 'bar' could be the objectName, or part of a nodeName (which can\r\n\t\t\t\t\t// include '.' characters).\r\n\t\t\t\t\tif ( supportedObjectNames.indexOf( objectName ) !== - 1 ) {\r\n\r\n\t\t\t\t\t\tresults.nodeName = results.nodeName.substring( 0, lastDot );\r\n\t\t\t\t\t\tresults.objectName = objectName;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( results.propertyName === null || results.propertyName.length === 0 ) {\r\n\r\n\t\t\t\t\tthrow new Error( 'PropertyBinding: can not parse propertyName from trackName: ' + trackName );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn results;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tfindNode: function ( root, nodeName ) {\r\n\r\n\t\t\tif ( ! nodeName || nodeName === \"\" || nodeName === \"root\" || nodeName === \".\" || nodeName === - 1 || nodeName === root.name || nodeName === root.uuid ) {\r\n\r\n\t\t\t\treturn root;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// search into skeleton bones.\r\n\t\t\tif ( root.skeleton ) {\r\n\r\n\t\t\t\tvar bone = root.skeleton.getBoneByName( nodeName );\r\n\r\n\t\t\t\tif ( bone !== undefined ) {\r\n\r\n\t\t\t\t\treturn bone;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// search into node subtree.\r\n\t\t\tif ( root.children ) {\r\n\r\n\t\t\t\tvar searchNodeSubtree = function ( children ) {\r\n\r\n\t\t\t\t\tfor ( var i = 0; i < children.length; i ++ ) {\r\n\r\n\t\t\t\t\t\tvar childNode = children[ i ];\r\n\r\n\t\t\t\t\t\tif ( childNode.name === nodeName || childNode.uuid === nodeName ) {\r\n\r\n\t\t\t\t\t\t\treturn childNode;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar result = searchNodeSubtree( childNode.children );\r\n\r\n\t\t\t\t\t\tif ( result ) return result;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn null;\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t\tvar subTreeNode = searchNodeSubtree( root.children );\r\n\r\n\t\t\t\tif ( subTreeNode ) {\r\n\r\n\t\t\t\t\treturn subTreeNode;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn null;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( PropertyBinding.prototype, { // prototype, continued\r\n\r\n\t\t// these are used to \"bind\" a nonexistent property\r\n\t\t_getValue_unavailable: function () {},\r\n\t\t_setValue_unavailable: function () {},\r\n\r\n\t\tBindingType: {\r\n\t\t\tDirect: 0,\r\n\t\t\tEntireArray: 1,\r\n\t\t\tArrayElement: 2,\r\n\t\t\tHasFromToArray: 3\r\n\t\t},\r\n\r\n\t\tVersioning: {\r\n\t\t\tNone: 0,\r\n\t\t\tNeedsUpdate: 1,\r\n\t\t\tMatrixWorldNeedsUpdate: 2\r\n\t\t},\r\n\r\n\t\tGetterByBindingType: [\r\n\r\n\t\t\tfunction getValue_direct( buffer, offset ) {\r\n\r\n\t\t\t\tbuffer[ offset ] = this.node[ this.propertyName ];\r\n\r\n\t\t\t},\r\n\r\n\t\t\tfunction getValue_array( buffer, offset ) {\r\n\r\n\t\t\t\tvar source = this.resolvedProperty;\r\n\r\n\t\t\t\tfor ( var i = 0, n = source.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\t\tbuffer[ offset ++ ] = source[ i ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\r\n\t\t\tfunction getValue_arrayElement( buffer, offset ) {\r\n\r\n\t\t\t\tbuffer[ offset ] = this.resolvedProperty[ this.propertyIndex ];\r\n\r\n\t\t\t},\r\n\r\n\t\t\tfunction getValue_toArray( buffer, offset ) {\r\n\r\n\t\t\t\tthis.resolvedProperty.toArray( buffer, offset );\r\n\r\n\t\t\t}\r\n\r\n\t\t],\r\n\r\n\t\tSetterByBindingTypeAndVersioning: [\r\n\r\n\t\t\t[\r\n\t\t\t\t// Direct\r\n\r\n\t\t\t\tfunction setValue_direct( buffer, offset ) {\r\n\r\n\t\t\t\t\tthis.targetObject[ this.propertyName ] = buffer[ offset ];\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tfunction setValue_direct_setNeedsUpdate( buffer, offset ) {\r\n\r\n\t\t\t\t\tthis.targetObject[ this.propertyName ] = buffer[ offset ];\r\n\t\t\t\t\tthis.targetObject.needsUpdate = true;\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tfunction setValue_direct_setMatrixWorldNeedsUpdate( buffer, offset ) {\r\n\r\n\t\t\t\t\tthis.targetObject[ this.propertyName ] = buffer[ offset ];\r\n\t\t\t\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t], [\r\n\r\n\t\t\t\t// EntireArray\r\n\r\n\t\t\t\tfunction setValue_array( buffer, offset ) {\r\n\r\n\t\t\t\t\tvar dest = this.resolvedProperty;\r\n\r\n\t\t\t\t\tfor ( var i = 0, n = dest.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\t\t\tdest[ i ] = buffer[ offset ++ ];\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tfunction setValue_array_setNeedsUpdate( buffer, offset ) {\r\n\r\n\t\t\t\t\tvar dest = this.resolvedProperty;\r\n\r\n\t\t\t\t\tfor ( var i = 0, n = dest.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\t\t\tdest[ i ] = buffer[ offset ++ ];\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.targetObject.needsUpdate = true;\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tfunction setValue_array_setMatrixWorldNeedsUpdate( buffer, offset ) {\r\n\r\n\t\t\t\t\tvar dest = this.resolvedProperty;\r\n\r\n\t\t\t\t\tfor ( var i = 0, n = dest.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\t\t\tdest[ i ] = buffer[ offset ++ ];\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t], [\r\n\r\n\t\t\t\t// ArrayElement\r\n\r\n\t\t\t\tfunction setValue_arrayElement( buffer, offset ) {\r\n\r\n\t\t\t\t\tthis.resolvedProperty[ this.propertyIndex ] = buffer[ offset ];\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tfunction setValue_arrayElement_setNeedsUpdate( buffer, offset ) {\r\n\r\n\t\t\t\t\tthis.resolvedProperty[ this.propertyIndex ] = buffer[ offset ];\r\n\t\t\t\t\tthis.targetObject.needsUpdate = true;\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tfunction setValue_arrayElement_setMatrixWorldNeedsUpdate( buffer, offset ) {\r\n\r\n\t\t\t\t\tthis.resolvedProperty[ this.propertyIndex ] = buffer[ offset ];\r\n\t\t\t\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t], [\r\n\r\n\t\t\t\t// HasToFromArray\r\n\r\n\t\t\t\tfunction setValue_fromArray( buffer, offset ) {\r\n\r\n\t\t\t\t\tthis.resolvedProperty.fromArray( buffer, offset );\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tfunction setValue_fromArray_setNeedsUpdate( buffer, offset ) {\r\n\r\n\t\t\t\t\tthis.resolvedProperty.fromArray( buffer, offset );\r\n\t\t\t\t\tthis.targetObject.needsUpdate = true;\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tfunction setValue_fromArray_setMatrixWorldNeedsUpdate( buffer, offset ) {\r\n\r\n\t\t\t\t\tthis.resolvedProperty.fromArray( buffer, offset );\r\n\t\t\t\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t]\r\n\r\n\t\t],\r\n\r\n\t\tgetValue: function getValue_unbound( targetArray, offset ) {\r\n\r\n\t\t\tthis.bind();\r\n\t\t\tthis.getValue( targetArray, offset );\r\n\r\n\t\t\t// Note: This class uses a State pattern on a per-method basis:\r\n\t\t\t// 'bind' sets 'this.getValue' / 'setValue' and shadows the\r\n\t\t\t// prototype version of these methods with one that represents\r\n\t\t\t// the bound state. When the property is not found, the methods\r\n\t\t\t// become no-ops.\r\n\r\n\t\t},\r\n\r\n\t\tsetValue: function getValue_unbound( sourceArray, offset ) {\r\n\r\n\t\t\tthis.bind();\r\n\t\t\tthis.setValue( sourceArray, offset );\r\n\r\n\t\t},\r\n\r\n\t\t// create getter / setter pair for a property in the scene graph\r\n\t\tbind: function () {\r\n\r\n\t\t\tvar targetObject = this.node,\r\n\t\t\t\tparsedPath = this.parsedPath,\r\n\r\n\t\t\t\tobjectName = parsedPath.objectName,\r\n\t\t\t\tpropertyName = parsedPath.propertyName,\r\n\t\t\t\tpropertyIndex = parsedPath.propertyIndex;\r\n\r\n\t\t\tif ( ! targetObject ) {\r\n\r\n\t\t\t\ttargetObject = PropertyBinding.findNode( this.rootNode, parsedPath.nodeName ) || this.rootNode;\r\n\r\n\t\t\t\tthis.node = targetObject;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// set fail state so we can just 'return' on error\r\n\t\t\tthis.getValue = this._getValue_unavailable;\r\n\t\t\tthis.setValue = this._setValue_unavailable;\r\n\r\n\t\t\t// ensure there is a value node\r\n\t\t\tif ( ! targetObject ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.PropertyBinding: Trying to update node for track: ' + this.path + ' but it wasn\\'t found.' );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( objectName ) {\r\n\r\n\t\t\t\tvar objectIndex = parsedPath.objectIndex;\r\n\r\n\t\t\t\t// special cases were we need to reach deeper into the hierarchy to get the face materials....\r\n\t\t\t\tswitch ( objectName ) {\r\n\r\n\t\t\t\t\tcase 'materials':\r\n\r\n\t\t\t\t\t\tif ( ! targetObject.material ) {\r\n\r\n\t\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to material as node does not have a material.', this );\r\n\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif ( ! targetObject.material.materials ) {\r\n\r\n\t\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.', this );\r\n\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\ttargetObject = targetObject.material.materials;\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'bones':\r\n\r\n\t\t\t\t\t\tif ( ! targetObject.skeleton ) {\r\n\r\n\t\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.', this );\r\n\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// potential future optimization: skip this if propertyIndex is already an integer\r\n\t\t\t\t\t\t// and convert the integer string to a true integer.\r\n\r\n\t\t\t\t\t\ttargetObject = targetObject.skeleton.bones;\r\n\r\n\t\t\t\t\t\t// support resolving morphTarget names into indices.\r\n\t\t\t\t\t\tfor ( var i = 0; i < targetObject.length; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tif ( targetObject[ i ].name === objectIndex ) {\r\n\r\n\t\t\t\t\t\t\t\tobjectIndex = i;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\r\n\t\t\t\t\t\tif ( targetObject[ objectName ] === undefined ) {\r\n\r\n\t\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to objectName of node undefined.', this );\r\n\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\ttargetObject = targetObject[ objectName ];\r\n\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t\tif ( objectIndex !== undefined ) {\r\n\r\n\t\t\t\t\tif ( targetObject[ objectIndex ] === undefined ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.', this, targetObject );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ttargetObject = targetObject[ objectIndex ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// resolve property\r\n\t\t\tvar nodeProperty = targetObject[ propertyName ];\r\n\r\n\t\t\tif ( nodeProperty === undefined ) {\r\n\r\n\t\t\t\tvar nodeName = parsedPath.nodeName;\r\n\r\n\t\t\t\tconsole.error( 'THREE.PropertyBinding: Trying to update property for track: ' + nodeName +\r\n\t\t\t\t\t'.' + propertyName + ' but it wasn\\'t found.', targetObject );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// determine versioning scheme\r\n\t\t\tvar versioning = this.Versioning.None;\r\n\r\n\t\t\tif ( targetObject.needsUpdate !== undefined ) { // material\r\n\r\n\t\t\t\tversioning = this.Versioning.NeedsUpdate;\r\n\t\t\t\tthis.targetObject = targetObject;\r\n\r\n\t\t\t} else if ( targetObject.matrixWorldNeedsUpdate !== undefined ) { // node transform\r\n\r\n\t\t\t\tversioning = this.Versioning.MatrixWorldNeedsUpdate;\r\n\t\t\t\tthis.targetObject = targetObject;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// determine how the property gets bound\r\n\t\t\tvar bindingType = this.BindingType.Direct;\r\n\r\n\t\t\tif ( propertyIndex !== undefined ) {\r\n\r\n\t\t\t\t// access a sub element of the property array (only primitives are supported right now)\r\n\r\n\t\t\t\tif ( propertyName === \"morphTargetInfluences\" ) {\r\n\r\n\t\t\t\t\t// potential optimization, skip this if propertyIndex is already an integer, and convert the integer string to a true integer.\r\n\r\n\t\t\t\t\t// support resolving morphTarget names into indices.\r\n\t\t\t\t\tif ( ! targetObject.geometry ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.', this );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( targetObject.geometry.isBufferGeometry ) {\r\n\r\n\t\t\t\t\t\tif ( ! targetObject.geometry.morphAttributes ) {\r\n\r\n\t\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.', this );\r\n\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tfor ( var i = 0; i < this.node.geometry.morphAttributes.position.length; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tif ( targetObject.geometry.morphAttributes.position[ i ].name === propertyIndex ) {\r\n\r\n\t\t\t\t\t\t\t\tpropertyIndex = i;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tif ( ! targetObject.geometry.morphTargets ) {\r\n\r\n\t\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.', this );\r\n\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tfor ( var i = 0; i < this.node.geometry.morphTargets.length; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tif ( targetObject.geometry.morphTargets[ i ].name === propertyIndex ) {\r\n\r\n\t\t\t\t\t\t\t\tpropertyIndex = i;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbindingType = this.BindingType.ArrayElement;\r\n\r\n\t\t\t\tthis.resolvedProperty = nodeProperty;\r\n\t\t\t\tthis.propertyIndex = propertyIndex;\r\n\r\n\t\t\t} else if ( nodeProperty.fromArray !== undefined && nodeProperty.toArray !== undefined ) {\r\n\r\n\t\t\t\t// must use copy for Object3D.Euler/Quaternion\r\n\r\n\t\t\t\tbindingType = this.BindingType.HasFromToArray;\r\n\r\n\t\t\t\tthis.resolvedProperty = nodeProperty;\r\n\r\n\t\t\t} else if ( Array.isArray( nodeProperty ) ) {\r\n\r\n\t\t\t\tbindingType = this.BindingType.EntireArray;\r\n\r\n\t\t\t\tthis.resolvedProperty = nodeProperty;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.propertyName = propertyName;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// select getter / setter\r\n\t\t\tthis.getValue = this.GetterByBindingType[ bindingType ];\r\n\t\t\tthis.setValue = this.SetterByBindingTypeAndVersioning[ bindingType ][ versioning ];\r\n\r\n\t\t},\r\n\r\n\t\tunbind: function () {\r\n\r\n\t\t\tthis.node = null;\r\n\r\n\t\t\t// back to the prototype version of getValue / setValue\r\n\t\t\t// note: avoiding to mutate the shape of 'this' via 'delete'\r\n\t\t\tthis.getValue = this._getValue_unbound;\r\n\t\t\tthis.setValue = this._setValue_unbound;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t//!\\ DECLARE ALIAS AFTER assign prototype !\r\n\tObject.assign( PropertyBinding.prototype, {\r\n\r\n\t\t// initial state of these methods that calls 'bind'\r\n\t\t_getValue_unbound: PropertyBinding.prototype.getValue,\r\n\t\t_setValue_unbound: PropertyBinding.prototype.setValue,\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t *\r\n\t * A group of objects that receives a shared animation state.\r\n\t *\r\n\t * Usage:\r\n\t *\r\n\t * \t-\tAdd objects you would otherwise pass as 'root' to the\r\n\t * \t\tconstructor or the .clipAction method of AnimationMixer.\r\n\t *\r\n\t * \t-\tInstead pass this object as 'root'.\r\n\t *\r\n\t * \t-\tYou can also add and remove objects later when the mixer\r\n\t * \t\tis running.\r\n\t *\r\n\t * Note:\r\n\t *\r\n\t *  \tObjects of this class appear as one object to the mixer,\r\n\t *  \tso cache control of the individual objects must be done\r\n\t *  \ton the group.\r\n\t *\r\n\t * Limitation:\r\n\t *\r\n\t * \t- \tThe animated properties must be compatible among the\r\n\t * \t\tall objects in the group.\r\n\t *\r\n\t *  -\tA single property can either be controlled through a\r\n\t *  \ttarget group or directly, but not both.\r\n\t *\r\n\t * @author tschw\r\n\t */\r\n\r\n\tfunction AnimationObjectGroup() {\r\n\r\n\t\tthis.uuid = _Math.generateUUID();\r\n\r\n\t\t// cached objects followed by the active ones\r\n\t\tthis._objects = Array.prototype.slice.call( arguments );\r\n\r\n\t\tthis.nCachedObjects_ = 0;\t\t\t// threshold\r\n\t\t// note: read by PropertyBinding.Composite\r\n\r\n\t\tvar indices = {};\r\n\t\tthis._indicesByUUID = indices;\t\t// for bookkeeping\r\n\r\n\t\tfor ( var i = 0, n = arguments.length; i !== n; ++ i ) {\r\n\r\n\t\t\tindices[ arguments[ i ].uuid ] = i;\r\n\r\n\t\t}\r\n\r\n\t\tthis._paths = [];\t\t\t\t\t// inside: string\r\n\t\tthis._parsedPaths = [];\t\t\t\t// inside: { we don't care, here }\r\n\t\tthis._bindings = []; \t\t\t\t// inside: Array< PropertyBinding >\r\n\t\tthis._bindingsIndicesByPath = {}; \t// inside: indices in these arrays\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tthis.stats = {\r\n\r\n\t\t\tobjects: {\r\n\t\t\t\tget total() {\r\n\r\n\t\t\t\t\treturn scope._objects.length;\r\n\r\n\t\t\t\t},\r\n\t\t\t\tget inUse() {\r\n\r\n\t\t\t\t\treturn this.total - scope.nCachedObjects_;\r\n\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tget bindingsPerObject() {\r\n\r\n\t\t\t\treturn scope._bindings.length;\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n\tObject.assign( AnimationObjectGroup.prototype, {\r\n\r\n\t\tisAnimationObjectGroup: true,\r\n\r\n\t\tadd: function () {\r\n\r\n\t\t\tvar objects = this._objects,\r\n\t\t\t\tnObjects = objects.length,\r\n\t\t\t\tnCachedObjects = this.nCachedObjects_,\r\n\t\t\t\tindicesByUUID = this._indicesByUUID,\r\n\t\t\t\tpaths = this._paths,\r\n\t\t\t\tparsedPaths = this._parsedPaths,\r\n\t\t\t\tbindings = this._bindings,\r\n\t\t\t\tnBindings = bindings.length,\r\n\t\t\t\tknownObject = undefined;\r\n\r\n\t\t\tfor ( var i = 0, n = arguments.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\tvar object = arguments[ i ],\r\n\t\t\t\t\tuuid = object.uuid,\r\n\t\t\t\t\tindex = indicesByUUID[ uuid ];\r\n\r\n\t\t\t\tif ( index === undefined ) {\r\n\r\n\t\t\t\t\t// unknown object -> add it to the ACTIVE region\r\n\r\n\t\t\t\t\tindex = nObjects ++;\r\n\t\t\t\t\tindicesByUUID[ uuid ] = index;\r\n\t\t\t\t\tobjects.push( object );\r\n\r\n\t\t\t\t\t// accounting is done, now do the same for all bindings\r\n\r\n\t\t\t\t\tfor ( var j = 0, m = nBindings; j !== m; ++ j ) {\r\n\r\n\t\t\t\t\t\tbindings[ j ].push( new PropertyBinding( object, paths[ j ], parsedPaths[ j ] ) );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else if ( index < nCachedObjects ) {\r\n\r\n\t\t\t\t\tknownObject = objects[ index ];\r\n\r\n\t\t\t\t\t// move existing object to the ACTIVE region\r\n\r\n\t\t\t\t\tvar firstActiveIndex = -- nCachedObjects,\r\n\t\t\t\t\t\tlastCachedObject = objects[ firstActiveIndex ];\r\n\r\n\t\t\t\t\tindicesByUUID[ lastCachedObject.uuid ] = index;\r\n\t\t\t\t\tobjects[ index ] = lastCachedObject;\r\n\r\n\t\t\t\t\tindicesByUUID[ uuid ] = firstActiveIndex;\r\n\t\t\t\t\tobjects[ firstActiveIndex ] = object;\r\n\r\n\t\t\t\t\t// accounting is done, now do the same for all bindings\r\n\r\n\t\t\t\t\tfor ( var j = 0, m = nBindings; j !== m; ++ j ) {\r\n\r\n\t\t\t\t\t\tvar bindingsForPath = bindings[ j ],\r\n\t\t\t\t\t\t\tlastCached = bindingsForPath[ firstActiveIndex ],\r\n\t\t\t\t\t\t\tbinding = bindingsForPath[ index ];\r\n\r\n\t\t\t\t\t\tbindingsForPath[ index ] = lastCached;\r\n\r\n\t\t\t\t\t\tif ( binding === undefined ) {\r\n\r\n\t\t\t\t\t\t\t// since we do not bother to create new bindings\r\n\t\t\t\t\t\t\t// for objects that are cached, the binding may\r\n\t\t\t\t\t\t\t// or may not exist\r\n\r\n\t\t\t\t\t\t\tbinding = new PropertyBinding( object, paths[ j ], parsedPaths[ j ] );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tbindingsForPath[ firstActiveIndex ] = binding;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else if ( objects[ index ] !== knownObject ) {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.AnimationObjectGroup: Different objects with the same UUID ' +\r\n\t\t\t\t\t\t\t'detected. Clean the caches or recreate your infrastructure when reloading scenes.' );\r\n\r\n\t\t\t\t} // else the object is already where we want it to be\r\n\r\n\t\t\t} // for arguments\r\n\r\n\t\t\tthis.nCachedObjects_ = nCachedObjects;\r\n\r\n\t\t},\r\n\r\n\t\tremove: function () {\r\n\r\n\t\t\tvar objects = this._objects,\r\n\t\t\t\tnCachedObjects = this.nCachedObjects_,\r\n\t\t\t\tindicesByUUID = this._indicesByUUID,\r\n\t\t\t\tbindings = this._bindings,\r\n\t\t\t\tnBindings = bindings.length;\r\n\r\n\t\t\tfor ( var i = 0, n = arguments.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\tvar object = arguments[ i ],\r\n\t\t\t\t\tuuid = object.uuid,\r\n\t\t\t\t\tindex = indicesByUUID[ uuid ];\r\n\r\n\t\t\t\tif ( index !== undefined && index >= nCachedObjects ) {\r\n\r\n\t\t\t\t\t// move existing object into the CACHED region\r\n\r\n\t\t\t\t\tvar lastCachedIndex = nCachedObjects ++,\r\n\t\t\t\t\t\tfirstActiveObject = objects[ lastCachedIndex ];\r\n\r\n\t\t\t\t\tindicesByUUID[ firstActiveObject.uuid ] = index;\r\n\t\t\t\t\tobjects[ index ] = firstActiveObject;\r\n\r\n\t\t\t\t\tindicesByUUID[ uuid ] = lastCachedIndex;\r\n\t\t\t\t\tobjects[ lastCachedIndex ] = object;\r\n\r\n\t\t\t\t\t// accounting is done, now do the same for all bindings\r\n\r\n\t\t\t\t\tfor ( var j = 0, m = nBindings; j !== m; ++ j ) {\r\n\r\n\t\t\t\t\t\tvar bindingsForPath = bindings[ j ],\r\n\t\t\t\t\t\t\tfirstActive = bindingsForPath[ lastCachedIndex ],\r\n\t\t\t\t\t\t\tbinding = bindingsForPath[ index ];\r\n\r\n\t\t\t\t\t\tbindingsForPath[ index ] = firstActive;\r\n\t\t\t\t\t\tbindingsForPath[ lastCachedIndex ] = binding;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} // for arguments\r\n\r\n\t\t\tthis.nCachedObjects_ = nCachedObjects;\r\n\r\n\t\t},\r\n\r\n\t\t// remove & forget\r\n\t\tuncache: function () {\r\n\r\n\t\t\tvar objects = this._objects,\r\n\t\t\t\tnObjects = objects.length,\r\n\t\t\t\tnCachedObjects = this.nCachedObjects_,\r\n\t\t\t\tindicesByUUID = this._indicesByUUID,\r\n\t\t\t\tbindings = this._bindings,\r\n\t\t\t\tnBindings = bindings.length;\r\n\r\n\t\t\tfor ( var i = 0, n = arguments.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\tvar object = arguments[ i ],\r\n\t\t\t\t\tuuid = object.uuid,\r\n\t\t\t\t\tindex = indicesByUUID[ uuid ];\r\n\r\n\t\t\t\tif ( index !== undefined ) {\r\n\r\n\t\t\t\t\tdelete indicesByUUID[ uuid ];\r\n\r\n\t\t\t\t\tif ( index < nCachedObjects ) {\r\n\r\n\t\t\t\t\t\t// object is cached, shrink the CACHED region\r\n\r\n\t\t\t\t\t\tvar firstActiveIndex = -- nCachedObjects,\r\n\t\t\t\t\t\t\tlastCachedObject = objects[ firstActiveIndex ],\r\n\t\t\t\t\t\t\tlastIndex = -- nObjects,\r\n\t\t\t\t\t\t\tlastObject = objects[ lastIndex ];\r\n\r\n\t\t\t\t\t\t// last cached object takes this object's place\r\n\t\t\t\t\t\tindicesByUUID[ lastCachedObject.uuid ] = index;\r\n\t\t\t\t\t\tobjects[ index ] = lastCachedObject;\r\n\r\n\t\t\t\t\t\t// last object goes to the activated slot and pop\r\n\t\t\t\t\t\tindicesByUUID[ lastObject.uuid ] = firstActiveIndex;\r\n\t\t\t\t\t\tobjects[ firstActiveIndex ] = lastObject;\r\n\t\t\t\t\t\tobjects.pop();\r\n\r\n\t\t\t\t\t\t// accounting is done, now do the same for all bindings\r\n\r\n\t\t\t\t\t\tfor ( var j = 0, m = nBindings; j !== m; ++ j ) {\r\n\r\n\t\t\t\t\t\t\tvar bindingsForPath = bindings[ j ],\r\n\t\t\t\t\t\t\t\tlastCached = bindingsForPath[ firstActiveIndex ],\r\n\t\t\t\t\t\t\t\tlast = bindingsForPath[ lastIndex ];\r\n\r\n\t\t\t\t\t\t\tbindingsForPath[ index ] = lastCached;\r\n\t\t\t\t\t\t\tbindingsForPath[ firstActiveIndex ] = last;\r\n\t\t\t\t\t\t\tbindingsForPath.pop();\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// object is active, just swap with the last and pop\r\n\r\n\t\t\t\t\t\tvar lastIndex = -- nObjects,\r\n\t\t\t\t\t\t\tlastObject = objects[ lastIndex ];\r\n\r\n\t\t\t\t\t\tindicesByUUID[ lastObject.uuid ] = index;\r\n\t\t\t\t\t\tobjects[ index ] = lastObject;\r\n\t\t\t\t\t\tobjects.pop();\r\n\r\n\t\t\t\t\t\t// accounting is done, now do the same for all bindings\r\n\r\n\t\t\t\t\t\tfor ( var j = 0, m = nBindings; j !== m; ++ j ) {\r\n\r\n\t\t\t\t\t\t\tvar bindingsForPath = bindings[ j ];\r\n\r\n\t\t\t\t\t\t\tbindingsForPath[ index ] = bindingsForPath[ lastIndex ];\r\n\t\t\t\t\t\t\tbindingsForPath.pop();\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} // cached or active\r\n\r\n\t\t\t\t} // if object is known\r\n\r\n\t\t\t} // for arguments\r\n\r\n\t\t\tthis.nCachedObjects_ = nCachedObjects;\r\n\r\n\t\t},\r\n\r\n\t\t// Internal interface used by befriended PropertyBinding.Composite:\r\n\r\n\t\tsubscribe_: function ( path, parsedPath ) {\r\n\r\n\t\t\t// returns an array of bindings for the given path that is changed\r\n\t\t\t// according to the contained objects in the group\r\n\r\n\t\t\tvar indicesByPath = this._bindingsIndicesByPath,\r\n\t\t\t\tindex = indicesByPath[ path ],\r\n\t\t\t\tbindings = this._bindings;\r\n\r\n\t\t\tif ( index !== undefined ) return bindings[ index ];\r\n\r\n\t\t\tvar paths = this._paths,\r\n\t\t\t\tparsedPaths = this._parsedPaths,\r\n\t\t\t\tobjects = this._objects,\r\n\t\t\t\tnObjects = objects.length,\r\n\t\t\t\tnCachedObjects = this.nCachedObjects_,\r\n\t\t\t\tbindingsForPath = new Array( nObjects );\r\n\r\n\t\t\tindex = bindings.length;\r\n\r\n\t\t\tindicesByPath[ path ] = index;\r\n\r\n\t\t\tpaths.push( path );\r\n\t\t\tparsedPaths.push( parsedPath );\r\n\t\t\tbindings.push( bindingsForPath );\r\n\r\n\t\t\tfor ( var i = nCachedObjects, n = objects.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\tvar object = objects[ i ];\r\n\t\t\t\tbindingsForPath[ i ] = new PropertyBinding( object, path, parsedPath );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn bindingsForPath;\r\n\r\n\t\t},\r\n\r\n\t\tunsubscribe_: function ( path ) {\r\n\r\n\t\t\t// tells the group to forget about a property path and no longer\r\n\t\t\t// update the array previously obtained with 'subscribe_'\r\n\r\n\t\t\tvar indicesByPath = this._bindingsIndicesByPath,\r\n\t\t\t\tindex = indicesByPath[ path ];\r\n\r\n\t\t\tif ( index !== undefined ) {\r\n\r\n\t\t\t\tvar paths = this._paths,\r\n\t\t\t\t\tparsedPaths = this._parsedPaths,\r\n\t\t\t\t\tbindings = this._bindings,\r\n\t\t\t\t\tlastBindingsIndex = bindings.length - 1,\r\n\t\t\t\t\tlastBindings = bindings[ lastBindingsIndex ],\r\n\t\t\t\t\tlastBindingsPath = path[ lastBindingsIndex ];\r\n\r\n\t\t\t\tindicesByPath[ lastBindingsPath ] = index;\r\n\r\n\t\t\t\tbindings[ index ] = lastBindings;\r\n\t\t\t\tbindings.pop();\r\n\r\n\t\t\t\tparsedPaths[ index ] = parsedPaths[ lastBindingsIndex ];\r\n\t\t\t\tparsedPaths.pop();\r\n\r\n\t\t\t\tpaths[ index ] = paths[ lastBindingsIndex ];\r\n\t\t\t\tpaths.pop();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t *\r\n\t * Action provided by AnimationMixer for scheduling clip playback on specific\r\n\t * objects.\r\n\t *\r\n\t * @author Ben Houston / http://clara.io/\r\n\t * @author David Sarno / http://lighthaus.us/\r\n\t * @author tschw\r\n\t *\r\n\t */\r\n\r\n\tfunction AnimationAction( mixer, clip, localRoot ) {\r\n\r\n\t\tthis._mixer = mixer;\r\n\t\tthis._clip = clip;\r\n\t\tthis._localRoot = localRoot || null;\r\n\r\n\t\tvar tracks = clip.tracks,\r\n\t\t\tnTracks = tracks.length,\r\n\t\t\tinterpolants = new Array( nTracks );\r\n\r\n\t\tvar interpolantSettings = {\r\n\t\t\tendingStart: ZeroCurvatureEnding,\r\n\t\t\tendingEnd: ZeroCurvatureEnding\r\n\t\t};\r\n\r\n\t\tfor ( var i = 0; i !== nTracks; ++ i ) {\r\n\r\n\t\t\tvar interpolant = tracks[ i ].createInterpolant( null );\r\n\t\t\tinterpolants[ i ] = interpolant;\r\n\t\t\tinterpolant.settings = interpolantSettings;\r\n\r\n\t\t}\r\n\r\n\t\tthis._interpolantSettings = interpolantSettings;\r\n\r\n\t\tthis._interpolants = interpolants;\t// bound by the mixer\r\n\r\n\t\t// inside: PropertyMixer (managed by the mixer)\r\n\t\tthis._propertyBindings = new Array( nTracks );\r\n\r\n\t\tthis._cacheIndex = null;\t\t\t// for the memory manager\r\n\t\tthis._byClipCacheIndex = null;\t\t// for the memory manager\r\n\r\n\t\tthis._timeScaleInterpolant = null;\r\n\t\tthis._weightInterpolant = null;\r\n\r\n\t\tthis.loop = LoopRepeat;\r\n\t\tthis._loopCount = - 1;\r\n\r\n\t\t// global mixer time when the action is to be started\r\n\t\t// it's set back to 'null' upon start of the action\r\n\t\tthis._startTime = null;\r\n\r\n\t\t// scaled local time of the action\r\n\t\t// gets clamped or wrapped to 0..clip.duration according to loop\r\n\t\tthis.time = 0;\r\n\r\n\t\tthis.timeScale = 1;\r\n\t\tthis._effectiveTimeScale = 1;\r\n\r\n\t\tthis.weight = 1;\r\n\t\tthis._effectiveWeight = 1;\r\n\r\n\t\tthis.repetitions = Infinity; \t\t// no. of repetitions when looping\r\n\r\n\t\tthis.paused = false;\t\t\t\t// true -> zero effective time scale\r\n\t\tthis.enabled = true;\t\t\t\t// false -> zero effective weight\r\n\r\n\t\tthis.clampWhenFinished \t= false;\t// keep feeding the last frame?\r\n\r\n\t\tthis.zeroSlopeAtStart \t= true;\t\t// for smooth interpolation w/o separate\r\n\t\tthis.zeroSlopeAtEnd\t\t= true;\t\t// clips for start, loop and end\r\n\r\n\t}\r\n\r\n\tObject.assign( AnimationAction.prototype, {\r\n\r\n\t\t// State & Scheduling\r\n\r\n\t\tplay: function () {\r\n\r\n\t\t\tthis._mixer._activateAction( this );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tstop: function () {\r\n\r\n\t\t\tthis._mixer._deactivateAction( this );\r\n\r\n\t\t\treturn this.reset();\r\n\r\n\t\t},\r\n\r\n\t\treset: function () {\r\n\r\n\t\t\tthis.paused = false;\r\n\t\t\tthis.enabled = true;\r\n\r\n\t\t\tthis.time = 0;\t\t\t// restart clip\r\n\t\t\tthis._loopCount = - 1;\t// forget previous loops\r\n\t\t\tthis._startTime = null;\t// forget scheduling\r\n\r\n\t\t\treturn this.stopFading().stopWarping();\r\n\r\n\t\t},\r\n\r\n\t\tisRunning: function () {\r\n\r\n\t\t\treturn this.enabled && ! this.paused && this.timeScale !== 0 &&\r\n\t\t\t\t\tthis._startTime === null && this._mixer._isActiveAction( this );\r\n\r\n\t\t},\r\n\r\n\t\t// return true when play has been called\r\n\t\tisScheduled: function () {\r\n\r\n\t\t\treturn this._mixer._isActiveAction( this );\r\n\r\n\t\t},\r\n\r\n\t\tstartAt: function ( time ) {\r\n\r\n\t\t\tthis._startTime = time;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetLoop: function ( mode, repetitions ) {\r\n\r\n\t\t\tthis.loop = mode;\r\n\t\t\tthis.repetitions = repetitions;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\t// Weight\r\n\r\n\t\t// set the weight stopping any scheduled fading\r\n\t\t// although .enabled = false yields an effective weight of zero, this\r\n\t\t// method does *not* change .enabled, because it would be confusing\r\n\t\tsetEffectiveWeight: function ( weight ) {\r\n\r\n\t\t\tthis.weight = weight;\r\n\r\n\t\t\t// note: same logic as when updated at runtime\r\n\t\t\tthis._effectiveWeight = this.enabled ? weight : 0;\r\n\r\n\t\t\treturn this.stopFading();\r\n\r\n\t\t},\r\n\r\n\t\t// return the weight considering fading and .enabled\r\n\t\tgetEffectiveWeight: function () {\r\n\r\n\t\t\treturn this._effectiveWeight;\r\n\r\n\t\t},\r\n\r\n\t\tfadeIn: function ( duration ) {\r\n\r\n\t\t\treturn this._scheduleFading( duration, 0, 1 );\r\n\r\n\t\t},\r\n\r\n\t\tfadeOut: function ( duration ) {\r\n\r\n\t\t\treturn this._scheduleFading( duration, 1, 0 );\r\n\r\n\t\t},\r\n\r\n\t\tcrossFadeFrom: function ( fadeOutAction, duration, warp ) {\r\n\r\n\t\t\tfadeOutAction.fadeOut( duration );\r\n\t\t\tthis.fadeIn( duration );\r\n\r\n\t\t\tif ( warp ) {\r\n\r\n\t\t\t\tvar fadeInDuration = this._clip.duration,\r\n\t\t\t\t\tfadeOutDuration = fadeOutAction._clip.duration,\r\n\r\n\t\t\t\t\tstartEndRatio = fadeOutDuration / fadeInDuration,\r\n\t\t\t\t\tendStartRatio = fadeInDuration / fadeOutDuration;\r\n\r\n\t\t\t\tfadeOutAction.warp( 1.0, startEndRatio, duration );\r\n\t\t\t\tthis.warp( endStartRatio, 1.0, duration );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcrossFadeTo: function ( fadeInAction, duration, warp ) {\r\n\r\n\t\t\treturn fadeInAction.crossFadeFrom( this, duration, warp );\r\n\r\n\t\t},\r\n\r\n\t\tstopFading: function () {\r\n\r\n\t\t\tvar weightInterpolant = this._weightInterpolant;\r\n\r\n\t\t\tif ( weightInterpolant !== null ) {\r\n\r\n\t\t\t\tthis._weightInterpolant = null;\r\n\t\t\t\tthis._mixer._takeBackControlInterpolant( weightInterpolant );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\t// Time Scale Control\r\n\r\n\t\t// set the time scale stopping any scheduled warping\r\n\t\t// although .paused = true yields an effective time scale of zero, this\r\n\t\t// method does *not* change .paused, because it would be confusing\r\n\t\tsetEffectiveTimeScale: function ( timeScale ) {\r\n\r\n\t\t\tthis.timeScale = timeScale;\r\n\t\t\tthis._effectiveTimeScale = this.paused ? 0 : timeScale;\r\n\r\n\t\t\treturn this.stopWarping();\r\n\r\n\t\t},\r\n\r\n\t\t// return the time scale considering warping and .paused\r\n\t\tgetEffectiveTimeScale: function () {\r\n\r\n\t\t\treturn this._effectiveTimeScale;\r\n\r\n\t\t},\r\n\r\n\t\tsetDuration: function ( duration ) {\r\n\r\n\t\t\tthis.timeScale = this._clip.duration / duration;\r\n\r\n\t\t\treturn this.stopWarping();\r\n\r\n\t\t},\r\n\r\n\t\tsyncWith: function ( action ) {\r\n\r\n\t\t\tthis.time = action.time;\r\n\t\t\tthis.timeScale = action.timeScale;\r\n\r\n\t\t\treturn this.stopWarping();\r\n\r\n\t\t},\r\n\r\n\t\thalt: function ( duration ) {\r\n\r\n\t\t\treturn this.warp( this._effectiveTimeScale, 0, duration );\r\n\r\n\t\t},\r\n\r\n\t\twarp: function ( startTimeScale, endTimeScale, duration ) {\r\n\r\n\t\t\tvar mixer = this._mixer, now = mixer.time,\r\n\t\t\t\tinterpolant = this._timeScaleInterpolant,\r\n\r\n\t\t\t\ttimeScale = this.timeScale;\r\n\r\n\t\t\tif ( interpolant === null ) {\r\n\r\n\t\t\t\tinterpolant = mixer._lendControlInterpolant();\r\n\t\t\t\tthis._timeScaleInterpolant = interpolant;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar times = interpolant.parameterPositions,\r\n\t\t\t\tvalues = interpolant.sampleValues;\r\n\r\n\t\t\ttimes[ 0 ] = now;\r\n\t\t\ttimes[ 1 ] = now + duration;\r\n\r\n\t\t\tvalues[ 0 ] = startTimeScale / timeScale;\r\n\t\t\tvalues[ 1 ] = endTimeScale / timeScale;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tstopWarping: function () {\r\n\r\n\t\t\tvar timeScaleInterpolant = this._timeScaleInterpolant;\r\n\r\n\t\t\tif ( timeScaleInterpolant !== null ) {\r\n\r\n\t\t\t\tthis._timeScaleInterpolant = null;\r\n\t\t\t\tthis._mixer._takeBackControlInterpolant( timeScaleInterpolant );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\t// Object Accessors\r\n\r\n\t\tgetMixer: function () {\r\n\r\n\t\t\treturn this._mixer;\r\n\r\n\t\t},\r\n\r\n\t\tgetClip: function () {\r\n\r\n\t\t\treturn this._clip;\r\n\r\n\t\t},\r\n\r\n\t\tgetRoot: function () {\r\n\r\n\t\t\treturn this._localRoot || this._mixer._root;\r\n\r\n\t\t},\r\n\r\n\t\t// Interna\r\n\r\n\t\t_update: function ( time, deltaTime, timeDirection, accuIndex ) {\r\n\r\n\t\t\t// called by the mixer\r\n\r\n\t\t\tif ( ! this.enabled ) {\r\n\r\n\t\t\t\t// call ._updateWeight() to update ._effectiveWeight\r\n\r\n\t\t\t\tthis._updateWeight( time );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar startTime = this._startTime;\r\n\r\n\t\t\tif ( startTime !== null ) {\r\n\r\n\t\t\t\t// check for scheduled start of action\r\n\r\n\t\t\t\tvar timeRunning = ( time - startTime ) * timeDirection;\r\n\t\t\t\tif ( timeRunning < 0 || timeDirection === 0 ) {\r\n\r\n\t\t\t\t\treturn; // yet to come / don't decide when delta = 0\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// start\r\n\r\n\t\t\t\tthis._startTime = null; // unschedule\r\n\t\t\t\tdeltaTime = timeDirection * timeRunning;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// apply time scale and advance time\r\n\r\n\t\t\tdeltaTime *= this._updateTimeScale( time );\r\n\t\t\tvar clipTime = this._updateTime( deltaTime );\r\n\r\n\t\t\t// note: _updateTime may disable the action resulting in\r\n\t\t\t// an effective weight of 0\r\n\r\n\t\t\tvar weight = this._updateWeight( time );\r\n\r\n\t\t\tif ( weight > 0 ) {\r\n\r\n\t\t\t\tvar interpolants = this._interpolants;\r\n\t\t\t\tvar propertyMixers = this._propertyBindings;\r\n\r\n\t\t\t\tfor ( var j = 0, m = interpolants.length; j !== m; ++ j ) {\r\n\r\n\t\t\t\t\tinterpolants[ j ].evaluate( clipTime );\r\n\t\t\t\t\tpropertyMixers[ j ].accumulate( accuIndex, weight );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t_updateWeight: function ( time ) {\r\n\r\n\t\t\tvar weight = 0;\r\n\r\n\t\t\tif ( this.enabled ) {\r\n\r\n\t\t\t\tweight = this.weight;\r\n\t\t\t\tvar interpolant = this._weightInterpolant;\r\n\r\n\t\t\t\tif ( interpolant !== null ) {\r\n\r\n\t\t\t\t\tvar interpolantValue = interpolant.evaluate( time )[ 0 ];\r\n\r\n\t\t\t\t\tweight *= interpolantValue;\r\n\r\n\t\t\t\t\tif ( time > interpolant.parameterPositions[ 1 ] ) {\r\n\r\n\t\t\t\t\t\tthis.stopFading();\r\n\r\n\t\t\t\t\t\tif ( interpolantValue === 0 ) {\r\n\r\n\t\t\t\t\t\t\t// faded out, disable\r\n\t\t\t\t\t\t\tthis.enabled = false;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis._effectiveWeight = weight;\r\n\t\t\treturn weight;\r\n\r\n\t\t},\r\n\r\n\t\t_updateTimeScale: function ( time ) {\r\n\r\n\t\t\tvar timeScale = 0;\r\n\r\n\t\t\tif ( ! this.paused ) {\r\n\r\n\t\t\t\ttimeScale = this.timeScale;\r\n\r\n\t\t\t\tvar interpolant = this._timeScaleInterpolant;\r\n\r\n\t\t\t\tif ( interpolant !== null ) {\r\n\r\n\t\t\t\t\tvar interpolantValue = interpolant.evaluate( time )[ 0 ];\r\n\r\n\t\t\t\t\ttimeScale *= interpolantValue;\r\n\r\n\t\t\t\t\tif ( time > interpolant.parameterPositions[ 1 ] ) {\r\n\r\n\t\t\t\t\t\tthis.stopWarping();\r\n\r\n\t\t\t\t\t\tif ( timeScale === 0 ) {\r\n\r\n\t\t\t\t\t\t\t// motion has halted, pause\r\n\t\t\t\t\t\t\tthis.paused = true;\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t// warp done - apply final time scale\r\n\t\t\t\t\t\t\tthis.timeScale = timeScale;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis._effectiveTimeScale = timeScale;\r\n\t\t\treturn timeScale;\r\n\r\n\t\t},\r\n\r\n\t\t_updateTime: function ( deltaTime ) {\r\n\r\n\t\t\tvar time = this.time + deltaTime;\r\n\t\t\tvar duration = this._clip.duration;\r\n\t\t\tvar loop = this.loop;\r\n\t\t\tvar loopCount = this._loopCount;\r\n\r\n\t\t\tvar pingPong = ( loop === LoopPingPong );\r\n\r\n\t\t\tif ( deltaTime === 0 ) {\r\n\r\n\t\t\t\tif ( loopCount === - 1 ) return time;\r\n\r\n\t\t\t\treturn ( pingPong && ( loopCount & 1 ) === 1 ) ? duration - time : time;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( loop === LoopOnce ) {\r\n\r\n\t\t\t\tif ( loopCount === - 1 ) {\r\n\r\n\t\t\t\t\t// just started\r\n\r\n\t\t\t\t\tthis._loopCount = 0;\r\n\t\t\t\t\tthis._setEndings( true, true, false );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\thandle_stop: {\r\n\r\n\t\t\t\t\tif ( time >= duration ) {\r\n\r\n\t\t\t\t\t\ttime = duration;\r\n\r\n\t\t\t\t\t} else if ( time < 0 ) {\r\n\r\n\t\t\t\t\t\ttime = 0;\r\n\r\n\t\t\t\t\t} else break handle_stop;\r\n\r\n\t\t\t\t\tif ( this.clampWhenFinished ) this.paused = true;\r\n\t\t\t\t\telse this.enabled = false;\r\n\r\n\t\t\t\t\tthis._mixer.dispatchEvent( {\r\n\t\t\t\t\t\ttype: 'finished', action: this,\r\n\t\t\t\t\t\tdirection: deltaTime < 0 ? - 1 : 1\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else { // repetitive Repeat or PingPong\r\n\r\n\t\t\t\tif ( loopCount === - 1 ) {\r\n\r\n\t\t\t\t\t// just started\r\n\r\n\t\t\t\t\tif ( deltaTime >= 0 ) {\r\n\r\n\t\t\t\t\t\tloopCount = 0;\r\n\r\n\t\t\t\t\t\tthis._setEndings( true, this.repetitions === 0, pingPong );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// when looping in reverse direction, the initial\r\n\t\t\t\t\t\t// transition through zero counts as a repetition,\r\n\t\t\t\t\t\t// so leave loopCount at -1\r\n\r\n\t\t\t\t\t\tthis._setEndings( this.repetitions === 0, true, pingPong );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( time >= duration || time < 0 ) {\r\n\r\n\t\t\t\t\t// wrap around\r\n\r\n\t\t\t\t\tvar loopDelta = Math.floor( time / duration ); // signed\r\n\t\t\t\t\ttime -= duration * loopDelta;\r\n\r\n\t\t\t\t\tloopCount += Math.abs( loopDelta );\r\n\r\n\t\t\t\t\tvar pending = this.repetitions - loopCount;\r\n\r\n\t\t\t\t\tif ( pending <= 0 ) {\r\n\r\n\t\t\t\t\t\t// have to stop (switch state, clamp time, fire event)\r\n\r\n\t\t\t\t\t\tif ( this.clampWhenFinished ) this.paused = true;\r\n\t\t\t\t\t\telse this.enabled = false;\r\n\r\n\t\t\t\t\t\ttime = deltaTime > 0 ? duration : 0;\r\n\r\n\t\t\t\t\t\tthis._mixer.dispatchEvent( {\r\n\t\t\t\t\t\t\ttype: 'finished', action: this,\r\n\t\t\t\t\t\t\tdirection: deltaTime > 0 ? 1 : - 1\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// keep running\r\n\r\n\t\t\t\t\t\tif ( pending === 1 ) {\r\n\r\n\t\t\t\t\t\t\t// entering the last round\r\n\r\n\t\t\t\t\t\t\tvar atStart = deltaTime < 0;\r\n\t\t\t\t\t\t\tthis._setEndings( atStart, ! atStart, pingPong );\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tthis._setEndings( false, false, pingPong );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tthis._loopCount = loopCount;\r\n\r\n\t\t\t\t\t\tthis._mixer.dispatchEvent( {\r\n\t\t\t\t\t\t\ttype: 'loop', action: this, loopDelta: loopDelta\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( pingPong && ( loopCount & 1 ) === 1 ) {\r\n\r\n\t\t\t\t\t// invert time for the \"pong round\"\r\n\r\n\t\t\t\t\tthis.time = time;\r\n\t\t\t\t\treturn duration - time;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.time = time;\r\n\t\t\treturn time;\r\n\r\n\t\t},\r\n\r\n\t\t_setEndings: function ( atStart, atEnd, pingPong ) {\r\n\r\n\t\t\tvar settings = this._interpolantSettings;\r\n\r\n\t\t\tif ( pingPong ) {\r\n\r\n\t\t\t\tsettings.endingStart \t= ZeroSlopeEnding;\r\n\t\t\t\tsettings.endingEnd\t\t= ZeroSlopeEnding;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// assuming for LoopOnce atStart == atEnd == true\r\n\r\n\t\t\t\tif ( atStart ) {\r\n\r\n\t\t\t\t\tsettings.endingStart = this.zeroSlopeAtStart ? ZeroSlopeEnding : ZeroCurvatureEnding;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tsettings.endingStart = WrapAroundEnding;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( atEnd ) {\r\n\r\n\t\t\t\t\tsettings.endingEnd = this.zeroSlopeAtEnd ? ZeroSlopeEnding : ZeroCurvatureEnding;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tsettings.endingEnd \t = WrapAroundEnding;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t_scheduleFading: function ( duration, weightNow, weightThen ) {\r\n\r\n\t\t\tvar mixer = this._mixer, now = mixer.time,\r\n\t\t\t\tinterpolant = this._weightInterpolant;\r\n\r\n\t\t\tif ( interpolant === null ) {\r\n\r\n\t\t\t\tinterpolant = mixer._lendControlInterpolant();\r\n\t\t\t\tthis._weightInterpolant = interpolant;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar times = interpolant.parameterPositions,\r\n\t\t\t\tvalues = interpolant.sampleValues;\r\n\r\n\t\t\ttimes[ 0 ] = now; \t\t\t\tvalues[ 0 ] = weightNow;\r\n\t\t\ttimes[ 1 ] = now + duration;\tvalues[ 1 ] = weightThen;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t *\r\n\t * Player for AnimationClips.\r\n\t *\r\n\t *\r\n\t * @author Ben Houston / http://clara.io/\r\n\t * @author David Sarno / http://lighthaus.us/\r\n\t * @author tschw\r\n\t */\r\n\r\n\tfunction AnimationMixer( root ) {\r\n\r\n\t\tthis._root = root;\r\n\t\tthis._initMemoryManager();\r\n\t\tthis._accuIndex = 0;\r\n\r\n\t\tthis.time = 0;\r\n\r\n\t\tthis.timeScale = 1.0;\r\n\r\n\t}\r\n\r\n\tAnimationMixer.prototype = Object.assign( Object.create( EventDispatcher.prototype ), {\r\n\r\n\t\tconstructor: AnimationMixer,\r\n\r\n\t\t_bindAction: function ( action, prototypeAction ) {\r\n\r\n\t\t\tvar root = action._localRoot || this._root,\r\n\t\t\t\ttracks = action._clip.tracks,\r\n\t\t\t\tnTracks = tracks.length,\r\n\t\t\t\tbindings = action._propertyBindings,\r\n\t\t\t\tinterpolants = action._interpolants,\r\n\t\t\t\trootUuid = root.uuid,\r\n\t\t\t\tbindingsByRoot = this._bindingsByRootAndName,\r\n\t\t\t\tbindingsByName = bindingsByRoot[ rootUuid ];\r\n\r\n\t\t\tif ( bindingsByName === undefined ) {\r\n\r\n\t\t\t\tbindingsByName = {};\r\n\t\t\t\tbindingsByRoot[ rootUuid ] = bindingsByName;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var i = 0; i !== nTracks; ++ i ) {\r\n\r\n\t\t\t\tvar track = tracks[ i ],\r\n\t\t\t\t\ttrackName = track.name,\r\n\t\t\t\t\tbinding = bindingsByName[ trackName ];\r\n\r\n\t\t\t\tif ( binding !== undefined ) {\r\n\r\n\t\t\t\t\tbindings[ i ] = binding;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tbinding = bindings[ i ];\r\n\r\n\t\t\t\t\tif ( binding !== undefined ) {\r\n\r\n\t\t\t\t\t\t// existing binding, make sure the cache knows\r\n\r\n\t\t\t\t\t\tif ( binding._cacheIndex === null ) {\r\n\r\n\t\t\t\t\t\t\t++ binding.referenceCount;\r\n\t\t\t\t\t\t\tthis._addInactiveBinding( binding, rootUuid, trackName );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar path = prototypeAction && prototypeAction.\r\n\t\t\t\t\t\t_propertyBindings[ i ].binding.parsedPath;\r\n\r\n\t\t\t\t\tbinding = new PropertyMixer(\r\n\t\t\t\t\t\tPropertyBinding.create( root, trackName, path ),\r\n\t\t\t\t\t\ttrack.ValueTypeName, track.getValueSize() );\r\n\r\n\t\t\t\t\t++ binding.referenceCount;\r\n\t\t\t\t\tthis._addInactiveBinding( binding, rootUuid, trackName );\r\n\r\n\t\t\t\t\tbindings[ i ] = binding;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tinterpolants[ i ].resultBuffer = binding.buffer;\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t_activateAction: function ( action ) {\r\n\r\n\t\t\tif ( ! this._isActiveAction( action ) ) {\r\n\r\n\t\t\t\tif ( action._cacheIndex === null ) {\r\n\r\n\t\t\t\t\t// this action has been forgotten by the cache, but the user\r\n\t\t\t\t\t// appears to be still using it -> rebind\r\n\r\n\t\t\t\t\tvar rootUuid = ( action._localRoot || this._root ).uuid,\r\n\t\t\t\t\t\tclipUuid = action._clip.uuid,\r\n\t\t\t\t\t\tactionsForClip = this._actionsByClip[ clipUuid ];\r\n\r\n\t\t\t\t\tthis._bindAction( action,\r\n\t\t\t\t\t\tactionsForClip && actionsForClip.knownActions[ 0 ] );\r\n\r\n\t\t\t\t\tthis._addInactiveAction( action, clipUuid, rootUuid );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar bindings = action._propertyBindings;\r\n\r\n\t\t\t\t// increment reference counts / sort out state\r\n\t\t\t\tfor ( var i = 0, n = bindings.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\t\tvar binding = bindings[ i ];\r\n\r\n\t\t\t\t\tif ( binding.useCount ++ === 0 ) {\r\n\r\n\t\t\t\t\t\tthis._lendBinding( binding );\r\n\t\t\t\t\t\tbinding.saveOriginalState();\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._lendAction( action );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t_deactivateAction: function ( action ) {\r\n\r\n\t\t\tif ( this._isActiveAction( action ) ) {\r\n\r\n\t\t\t\tvar bindings = action._propertyBindings;\r\n\r\n\t\t\t\t// decrement reference counts / sort out state\r\n\t\t\t\tfor ( var i = 0, n = bindings.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\t\tvar binding = bindings[ i ];\r\n\r\n\t\t\t\t\tif ( -- binding.useCount === 0 ) {\r\n\r\n\t\t\t\t\t\tbinding.restoreOriginalState();\r\n\t\t\t\t\t\tthis._takeBackBinding( binding );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._takeBackAction( action );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t// Memory manager\r\n\r\n\t\t_initMemoryManager: function () {\r\n\r\n\t\t\tthis._actions = []; // 'nActiveActions' followed by inactive ones\r\n\t\t\tthis._nActiveActions = 0;\r\n\r\n\t\t\tthis._actionsByClip = {};\r\n\t\t\t// inside:\r\n\t\t\t// {\r\n\t\t\t// \t\tknownActions: Array< AnimationAction >\t- used as prototypes\r\n\t\t\t// \t\tactionByRoot: AnimationAction\t\t\t- lookup\r\n\t\t\t// }\r\n\r\n\r\n\t\t\tthis._bindings = []; // 'nActiveBindings' followed by inactive ones\r\n\t\t\tthis._nActiveBindings = 0;\r\n\r\n\t\t\tthis._bindingsByRootAndName = {}; // inside: Map< name, PropertyMixer >\r\n\r\n\r\n\t\t\tthis._controlInterpolants = []; // same game as above\r\n\t\t\tthis._nActiveControlInterpolants = 0;\r\n\r\n\t\t\tvar scope = this;\r\n\r\n\t\t\tthis.stats = {\r\n\r\n\t\t\t\tactions: {\r\n\t\t\t\t\tget total() {\r\n\r\n\t\t\t\t\t\treturn scope._actions.length;\r\n\r\n\t\t\t\t\t},\r\n\t\t\t\t\tget inUse() {\r\n\r\n\t\t\t\t\t\treturn scope._nActiveActions;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tbindings: {\r\n\t\t\t\t\tget total() {\r\n\r\n\t\t\t\t\t\treturn scope._bindings.length;\r\n\r\n\t\t\t\t\t},\r\n\t\t\t\t\tget inUse() {\r\n\r\n\t\t\t\t\t\treturn scope._nActiveBindings;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tcontrolInterpolants: {\r\n\t\t\t\t\tget total() {\r\n\r\n\t\t\t\t\t\treturn scope._controlInterpolants.length;\r\n\r\n\t\t\t\t\t},\r\n\t\t\t\t\tget inUse() {\r\n\r\n\t\t\t\t\t\treturn scope._nActiveControlInterpolants;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\r\n\t\t},\r\n\r\n\t\t// Memory management for AnimationAction objects\r\n\r\n\t\t_isActiveAction: function ( action ) {\r\n\r\n\t\t\tvar index = action._cacheIndex;\r\n\t\t\treturn index !== null && index < this._nActiveActions;\r\n\r\n\t\t},\r\n\r\n\t\t_addInactiveAction: function ( action, clipUuid, rootUuid ) {\r\n\r\n\t\t\tvar actions = this._actions,\r\n\t\t\t\tactionsByClip = this._actionsByClip,\r\n\t\t\t\tactionsForClip = actionsByClip[ clipUuid ];\r\n\r\n\t\t\tif ( actionsForClip === undefined ) {\r\n\r\n\t\t\t\tactionsForClip = {\r\n\r\n\t\t\t\t\tknownActions: [ action ],\r\n\t\t\t\t\tactionByRoot: {}\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t\taction._byClipCacheIndex = 0;\r\n\r\n\t\t\t\tactionsByClip[ clipUuid ] = actionsForClip;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvar knownActions = actionsForClip.knownActions;\r\n\r\n\t\t\t\taction._byClipCacheIndex = knownActions.length;\r\n\t\t\t\tknownActions.push( action );\r\n\r\n\t\t\t}\r\n\r\n\t\t\taction._cacheIndex = actions.length;\r\n\t\t\tactions.push( action );\r\n\r\n\t\t\tactionsForClip.actionByRoot[ rootUuid ] = action;\r\n\r\n\t\t},\r\n\r\n\t\t_removeInactiveAction: function ( action ) {\r\n\r\n\t\t\tvar actions = this._actions,\r\n\t\t\t\tlastInactiveAction = actions[ actions.length - 1 ],\r\n\t\t\t\tcacheIndex = action._cacheIndex;\r\n\r\n\t\t\tlastInactiveAction._cacheIndex = cacheIndex;\r\n\t\t\tactions[ cacheIndex ] = lastInactiveAction;\r\n\t\t\tactions.pop();\r\n\r\n\t\t\taction._cacheIndex = null;\r\n\r\n\r\n\t\t\tvar clipUuid = action._clip.uuid,\r\n\t\t\t\tactionsByClip = this._actionsByClip,\r\n\t\t\t\tactionsForClip = actionsByClip[ clipUuid ],\r\n\t\t\t\tknownActionsForClip = actionsForClip.knownActions,\r\n\r\n\t\t\t\tlastKnownAction =\r\n\t\t\t\t\tknownActionsForClip[ knownActionsForClip.length - 1 ],\r\n\r\n\t\t\t\tbyClipCacheIndex = action._byClipCacheIndex;\r\n\r\n\t\t\tlastKnownAction._byClipCacheIndex = byClipCacheIndex;\r\n\t\t\tknownActionsForClip[ byClipCacheIndex ] = lastKnownAction;\r\n\t\t\tknownActionsForClip.pop();\r\n\r\n\t\t\taction._byClipCacheIndex = null;\r\n\r\n\r\n\t\t\tvar actionByRoot = actionsForClip.actionByRoot,\r\n\t\t\t\trootUuid = ( action._localRoot || this._root ).uuid;\r\n\r\n\t\t\tdelete actionByRoot[ rootUuid ];\r\n\r\n\t\t\tif ( knownActionsForClip.length === 0 ) {\r\n\r\n\t\t\t\tdelete actionsByClip[ clipUuid ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis._removeInactiveBindingsForAction( action );\r\n\r\n\t\t},\r\n\r\n\t\t_removeInactiveBindingsForAction: function ( action ) {\r\n\r\n\t\t\tvar bindings = action._propertyBindings;\r\n\t\t\tfor ( var i = 0, n = bindings.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\tvar binding = bindings[ i ];\r\n\r\n\t\t\t\tif ( -- binding.referenceCount === 0 ) {\r\n\r\n\t\t\t\t\tthis._removeInactiveBinding( binding );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t_lendAction: function ( action ) {\r\n\r\n\t\t\t// [ active actions |  inactive actions  ]\r\n\t\t\t// [  active actions >| inactive actions ]\r\n\t\t\t//                 s        a\r\n\t\t\t//                  <-swap->\r\n\t\t\t//                 a        s\r\n\r\n\t\t\tvar actions = this._actions,\r\n\t\t\t\tprevIndex = action._cacheIndex,\r\n\r\n\t\t\t\tlastActiveIndex = this._nActiveActions ++,\r\n\r\n\t\t\t\tfirstInactiveAction = actions[ lastActiveIndex ];\r\n\r\n\t\t\taction._cacheIndex = lastActiveIndex;\r\n\t\t\tactions[ lastActiveIndex ] = action;\r\n\r\n\t\t\tfirstInactiveAction._cacheIndex = prevIndex;\r\n\t\t\tactions[ prevIndex ] = firstInactiveAction;\r\n\r\n\t\t},\r\n\r\n\t\t_takeBackAction: function ( action ) {\r\n\r\n\t\t\t// [  active actions  | inactive actions ]\r\n\t\t\t// [ active actions |< inactive actions  ]\r\n\t\t\t//        a        s\r\n\t\t\t//         <-swap->\r\n\t\t\t//        s        a\r\n\r\n\t\t\tvar actions = this._actions,\r\n\t\t\t\tprevIndex = action._cacheIndex,\r\n\r\n\t\t\t\tfirstInactiveIndex = -- this._nActiveActions,\r\n\r\n\t\t\t\tlastActiveAction = actions[ firstInactiveIndex ];\r\n\r\n\t\t\taction._cacheIndex = firstInactiveIndex;\r\n\t\t\tactions[ firstInactiveIndex ] = action;\r\n\r\n\t\t\tlastActiveAction._cacheIndex = prevIndex;\r\n\t\t\tactions[ prevIndex ] = lastActiveAction;\r\n\r\n\t\t},\r\n\r\n\t\t// Memory management for PropertyMixer objects\r\n\r\n\t\t_addInactiveBinding: function ( binding, rootUuid, trackName ) {\r\n\r\n\t\t\tvar bindingsByRoot = this._bindingsByRootAndName,\r\n\t\t\t\tbindingByName = bindingsByRoot[ rootUuid ],\r\n\r\n\t\t\t\tbindings = this._bindings;\r\n\r\n\t\t\tif ( bindingByName === undefined ) {\r\n\r\n\t\t\t\tbindingByName = {};\r\n\t\t\t\tbindingsByRoot[ rootUuid ] = bindingByName;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tbindingByName[ trackName ] = binding;\r\n\r\n\t\t\tbinding._cacheIndex = bindings.length;\r\n\t\t\tbindings.push( binding );\r\n\r\n\t\t},\r\n\r\n\t\t_removeInactiveBinding: function ( binding ) {\r\n\r\n\t\t\tvar bindings = this._bindings,\r\n\t\t\t\tpropBinding = binding.binding,\r\n\t\t\t\trootUuid = propBinding.rootNode.uuid,\r\n\t\t\t\ttrackName = propBinding.path,\r\n\t\t\t\tbindingsByRoot = this._bindingsByRootAndName,\r\n\t\t\t\tbindingByName = bindingsByRoot[ rootUuid ],\r\n\r\n\t\t\t\tlastInactiveBinding = bindings[ bindings.length - 1 ],\r\n\t\t\t\tcacheIndex = binding._cacheIndex;\r\n\r\n\t\t\tlastInactiveBinding._cacheIndex = cacheIndex;\r\n\t\t\tbindings[ cacheIndex ] = lastInactiveBinding;\r\n\t\t\tbindings.pop();\r\n\r\n\t\t\tdelete bindingByName[ trackName ];\r\n\r\n\t\t\tremove_empty_map: {\r\n\r\n\t\t\t\tfor ( var _ in bindingByName ) break remove_empty_map; // eslint-disable-line no-unused-vars\r\n\r\n\t\t\t\tdelete bindingsByRoot[ rootUuid ];\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t_lendBinding: function ( binding ) {\r\n\r\n\t\t\tvar bindings = this._bindings,\r\n\t\t\t\tprevIndex = binding._cacheIndex,\r\n\r\n\t\t\t\tlastActiveIndex = this._nActiveBindings ++,\r\n\r\n\t\t\t\tfirstInactiveBinding = bindings[ lastActiveIndex ];\r\n\r\n\t\t\tbinding._cacheIndex = lastActiveIndex;\r\n\t\t\tbindings[ lastActiveIndex ] = binding;\r\n\r\n\t\t\tfirstInactiveBinding._cacheIndex = prevIndex;\r\n\t\t\tbindings[ prevIndex ] = firstInactiveBinding;\r\n\r\n\t\t},\r\n\r\n\t\t_takeBackBinding: function ( binding ) {\r\n\r\n\t\t\tvar bindings = this._bindings,\r\n\t\t\t\tprevIndex = binding._cacheIndex,\r\n\r\n\t\t\t\tfirstInactiveIndex = -- this._nActiveBindings,\r\n\r\n\t\t\t\tlastActiveBinding = bindings[ firstInactiveIndex ];\r\n\r\n\t\t\tbinding._cacheIndex = firstInactiveIndex;\r\n\t\t\tbindings[ firstInactiveIndex ] = binding;\r\n\r\n\t\t\tlastActiveBinding._cacheIndex = prevIndex;\r\n\t\t\tbindings[ prevIndex ] = lastActiveBinding;\r\n\r\n\t\t},\r\n\r\n\r\n\t\t// Memory management of Interpolants for weight and time scale\r\n\r\n\t\t_lendControlInterpolant: function () {\r\n\r\n\t\t\tvar interpolants = this._controlInterpolants,\r\n\t\t\t\tlastActiveIndex = this._nActiveControlInterpolants ++,\r\n\t\t\t\tinterpolant = interpolants[ lastActiveIndex ];\r\n\r\n\t\t\tif ( interpolant === undefined ) {\r\n\r\n\t\t\t\tinterpolant = new LinearInterpolant(\r\n\t\t\t\t\tnew Float32Array( 2 ), new Float32Array( 2 ),\r\n\t\t\t\t\t1, this._controlInterpolantsResultBuffer );\r\n\r\n\t\t\t\tinterpolant.__cacheIndex = lastActiveIndex;\r\n\t\t\t\tinterpolants[ lastActiveIndex ] = interpolant;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn interpolant;\r\n\r\n\t\t},\r\n\r\n\t\t_takeBackControlInterpolant: function ( interpolant ) {\r\n\r\n\t\t\tvar interpolants = this._controlInterpolants,\r\n\t\t\t\tprevIndex = interpolant.__cacheIndex,\r\n\r\n\t\t\t\tfirstInactiveIndex = -- this._nActiveControlInterpolants,\r\n\r\n\t\t\t\tlastActiveInterpolant = interpolants[ firstInactiveIndex ];\r\n\r\n\t\t\tinterpolant.__cacheIndex = firstInactiveIndex;\r\n\t\t\tinterpolants[ firstInactiveIndex ] = interpolant;\r\n\r\n\t\t\tlastActiveInterpolant.__cacheIndex = prevIndex;\r\n\t\t\tinterpolants[ prevIndex ] = lastActiveInterpolant;\r\n\r\n\t\t},\r\n\r\n\t\t_controlInterpolantsResultBuffer: new Float32Array( 1 ),\r\n\r\n\t\t// return an action for a clip optionally using a custom root target\r\n\t\t// object (this method allocates a lot of dynamic memory in case a\r\n\t\t// previously unknown clip/root combination is specified)\r\n\t\tclipAction: function ( clip, optionalRoot ) {\r\n\r\n\t\t\tvar root = optionalRoot || this._root,\r\n\t\t\t\trootUuid = root.uuid,\r\n\r\n\t\t\t\tclipObject = typeof clip === 'string' ?\r\n\t\t\t\t\tAnimationClip.findByName( root, clip ) : clip,\r\n\r\n\t\t\t\tclipUuid = clipObject !== null ? clipObject.uuid : clip,\r\n\r\n\t\t\t\tactionsForClip = this._actionsByClip[ clipUuid ],\r\n\t\t\t\tprototypeAction = null;\r\n\r\n\t\t\tif ( actionsForClip !== undefined ) {\r\n\r\n\t\t\t\tvar existingAction =\r\n\t\t\t\t\t\tactionsForClip.actionByRoot[ rootUuid ];\r\n\r\n\t\t\t\tif ( existingAction !== undefined ) {\r\n\r\n\t\t\t\t\treturn existingAction;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// we know the clip, so we don't have to parse all\r\n\t\t\t\t// the bindings again but can just copy\r\n\t\t\t\tprototypeAction = actionsForClip.knownActions[ 0 ];\r\n\r\n\t\t\t\t// also, take the clip from the prototype action\r\n\t\t\t\tif ( clipObject === null )\r\n\t\t\t\t\tclipObject = prototypeAction._clip;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// clip must be known when specified via string\r\n\t\t\tif ( clipObject === null ) return null;\r\n\r\n\t\t\t// allocate all resources required to run it\r\n\t\t\tvar newAction = new AnimationAction( this, clipObject, optionalRoot );\r\n\r\n\t\t\tthis._bindAction( newAction, prototypeAction );\r\n\r\n\t\t\t// and make the action known to the memory manager\r\n\t\t\tthis._addInactiveAction( newAction, clipUuid, rootUuid );\r\n\r\n\t\t\treturn newAction;\r\n\r\n\t\t},\r\n\r\n\t\t// get an existing action\r\n\t\texistingAction: function ( clip, optionalRoot ) {\r\n\r\n\t\t\tvar root = optionalRoot || this._root,\r\n\t\t\t\trootUuid = root.uuid,\r\n\r\n\t\t\t\tclipObject = typeof clip === 'string' ?\r\n\t\t\t\t\tAnimationClip.findByName( root, clip ) : clip,\r\n\r\n\t\t\t\tclipUuid = clipObject ? clipObject.uuid : clip,\r\n\r\n\t\t\t\tactionsForClip = this._actionsByClip[ clipUuid ];\r\n\r\n\t\t\tif ( actionsForClip !== undefined ) {\r\n\r\n\t\t\t\treturn actionsForClip.actionByRoot[ rootUuid ] || null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn null;\r\n\r\n\t\t},\r\n\r\n\t\t// deactivates all previously scheduled actions\r\n\t\tstopAllAction: function () {\r\n\r\n\t\t\tvar actions = this._actions,\r\n\t\t\t\tnActions = this._nActiveActions,\r\n\t\t\t\tbindings = this._bindings,\r\n\t\t\t\tnBindings = this._nActiveBindings;\r\n\r\n\t\t\tthis._nActiveActions = 0;\r\n\t\t\tthis._nActiveBindings = 0;\r\n\r\n\t\t\tfor ( var i = 0; i !== nActions; ++ i ) {\r\n\r\n\t\t\t\tactions[ i ].reset();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var i = 0; i !== nBindings; ++ i ) {\r\n\r\n\t\t\t\tbindings[ i ].useCount = 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\t// advance the time and update apply the animation\r\n\t\tupdate: function ( deltaTime ) {\r\n\r\n\t\t\tdeltaTime *= this.timeScale;\r\n\r\n\t\t\tvar actions = this._actions,\r\n\t\t\t\tnActions = this._nActiveActions,\r\n\r\n\t\t\t\ttime = this.time += deltaTime,\r\n\t\t\t\ttimeDirection = Math.sign( deltaTime ),\r\n\r\n\t\t\t\taccuIndex = this._accuIndex ^= 1;\r\n\r\n\t\t\t// run active actions\r\n\r\n\t\t\tfor ( var i = 0; i !== nActions; ++ i ) {\r\n\r\n\t\t\t\tvar action = actions[ i ];\r\n\r\n\t\t\t\taction._update( time, deltaTime, timeDirection, accuIndex );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// update scene graph\r\n\r\n\t\t\tvar bindings = this._bindings,\r\n\t\t\t\tnBindings = this._nActiveBindings;\r\n\r\n\t\t\tfor ( var i = 0; i !== nBindings; ++ i ) {\r\n\r\n\t\t\t\tbindings[ i ].apply( accuIndex );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\t// return this mixer's root target object\r\n\t\tgetRoot: function () {\r\n\r\n\t\t\treturn this._root;\r\n\r\n\t\t},\r\n\r\n\t\t// free all resources specific to a particular clip\r\n\t\tuncacheClip: function ( clip ) {\r\n\r\n\t\t\tvar actions = this._actions,\r\n\t\t\t\tclipUuid = clip.uuid,\r\n\t\t\t\tactionsByClip = this._actionsByClip,\r\n\t\t\t\tactionsForClip = actionsByClip[ clipUuid ];\r\n\r\n\t\t\tif ( actionsForClip !== undefined ) {\r\n\r\n\t\t\t\t// note: just calling _removeInactiveAction would mess up the\r\n\t\t\t\t// iteration state and also require updating the state we can\r\n\t\t\t\t// just throw away\r\n\r\n\t\t\t\tvar actionsToRemove = actionsForClip.knownActions;\r\n\r\n\t\t\t\tfor ( var i = 0, n = actionsToRemove.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\t\tvar action = actionsToRemove[ i ];\r\n\r\n\t\t\t\t\tthis._deactivateAction( action );\r\n\r\n\t\t\t\t\tvar cacheIndex = action._cacheIndex,\r\n\t\t\t\t\t\tlastInactiveAction = actions[ actions.length - 1 ];\r\n\r\n\t\t\t\t\taction._cacheIndex = null;\r\n\t\t\t\t\taction._byClipCacheIndex = null;\r\n\r\n\t\t\t\t\tlastInactiveAction._cacheIndex = cacheIndex;\r\n\t\t\t\t\tactions[ cacheIndex ] = lastInactiveAction;\r\n\t\t\t\t\tactions.pop();\r\n\r\n\t\t\t\t\tthis._removeInactiveBindingsForAction( action );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdelete actionsByClip[ clipUuid ];\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t// free all resources specific to a particular root target object\r\n\t\tuncacheRoot: function ( root ) {\r\n\r\n\t\t\tvar rootUuid = root.uuid,\r\n\t\t\t\tactionsByClip = this._actionsByClip;\r\n\r\n\t\t\tfor ( var clipUuid in actionsByClip ) {\r\n\r\n\t\t\t\tvar actionByRoot = actionsByClip[ clipUuid ].actionByRoot,\r\n\t\t\t\t\taction = actionByRoot[ rootUuid ];\r\n\r\n\t\t\t\tif ( action !== undefined ) {\r\n\r\n\t\t\t\t\tthis._deactivateAction( action );\r\n\t\t\t\t\tthis._removeInactiveAction( action );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar bindingsByRoot = this._bindingsByRootAndName,\r\n\t\t\t\tbindingByName = bindingsByRoot[ rootUuid ];\r\n\r\n\t\t\tif ( bindingByName !== undefined ) {\r\n\r\n\t\t\t\tfor ( var trackName in bindingByName ) {\r\n\r\n\t\t\t\t\tvar binding = bindingByName[ trackName ];\r\n\t\t\t\t\tbinding.restoreOriginalState();\r\n\t\t\t\t\tthis._removeInactiveBinding( binding );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t// remove a targeted clip from the cache\r\n\t\tuncacheAction: function ( clip, optionalRoot ) {\r\n\r\n\t\t\tvar action = this.existingAction( clip, optionalRoot );\r\n\r\n\t\t\tif ( action !== null ) {\r\n\r\n\t\t\t\tthis._deactivateAction( action );\r\n\t\t\t\tthis._removeInactiveAction( action );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction Uniform( value ) {\r\n\r\n\t\tif ( typeof value === 'string' ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Uniform: Type parameter is no longer needed.' );\r\n\t\t\tvalue = arguments[ 1 ];\r\n\r\n\t\t}\r\n\r\n\t\tthis.value = value;\r\n\r\n\t}\r\n\r\n\tUniform.prototype.clone = function () {\r\n\r\n\t\treturn new Uniform( this.value.clone === undefined ? this.value : this.value.clone() );\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author benaadams / https://twitter.com/ben_a_adams\r\n\t */\r\n\r\n\tfunction InstancedBufferGeometry() {\r\n\r\n\t\tBufferGeometry.call( this );\r\n\r\n\t\tthis.type = 'InstancedBufferGeometry';\r\n\t\tthis.maxInstancedCount = undefined;\r\n\r\n\t}\r\n\r\n\tInstancedBufferGeometry.prototype = Object.assign( Object.create( BufferGeometry.prototype ), {\r\n\r\n\t\tconstructor: InstancedBufferGeometry,\r\n\r\n\t\tisInstancedBufferGeometry: true,\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tBufferGeometry.prototype.copy.call( this, source );\r\n\r\n\t\t\tthis.maxInstancedCount = source.maxInstancedCount;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author benaadams / https://twitter.com/ben_a_adams\r\n\t */\r\n\r\n\tfunction InstancedInterleavedBuffer( array, stride, meshPerAttribute ) {\r\n\r\n\t\tInterleavedBuffer.call( this, array, stride );\r\n\r\n\t\tthis.meshPerAttribute = meshPerAttribute || 1;\r\n\r\n\t}\r\n\r\n\tInstancedInterleavedBuffer.prototype = Object.assign( Object.create( InterleavedBuffer.prototype ), {\r\n\r\n\t\tconstructor: InstancedInterleavedBuffer,\r\n\r\n\t\tisInstancedInterleavedBuffer: true,\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tInterleavedBuffer.prototype.copy.call( this, source );\r\n\r\n\t\t\tthis.meshPerAttribute = source.meshPerAttribute;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author benaadams / https://twitter.com/ben_a_adams\r\n\t */\r\n\r\n\tfunction InstancedBufferAttribute( array, itemSize, meshPerAttribute ) {\r\n\r\n\t\tBufferAttribute.call( this, array, itemSize );\r\n\r\n\t\tthis.meshPerAttribute = meshPerAttribute || 1;\r\n\r\n\t}\r\n\r\n\tInstancedBufferAttribute.prototype = Object.assign( Object.create( BufferAttribute.prototype ), {\r\n\r\n\t\tconstructor: InstancedBufferAttribute,\r\n\r\n\t\tisInstancedBufferAttribute: true,\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tBufferAttribute.prototype.copy.call( this, source );\r\n\r\n\t\t\tthis.meshPerAttribute = source.meshPerAttribute;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author bhouston / http://clara.io/\r\n\t * @author stephomi / http://stephaneginier.com/\r\n\t */\r\n\r\n\tfunction Raycaster( origin, direction, near, far ) {\r\n\r\n\t\tthis.ray = new Ray( origin, direction );\r\n\t\t// direction is assumed to be normalized (for accurate distance calculations)\r\n\r\n\t\tthis.near = near || 0;\r\n\t\tthis.far = far || Infinity;\r\n\r\n\t\tthis.params = {\r\n\t\t\tMesh: {},\r\n\t\t\tLine: {},\r\n\t\t\tLOD: {},\r\n\t\t\tPoints: { threshold: 1 },\r\n\t\t\tSprite: {}\r\n\t\t};\r\n\r\n\t\tObject.defineProperties( this.params, {\r\n\t\t\tPointCloud: {\r\n\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.Raycaster: params.PointCloud has been renamed to params.Points.' );\r\n\t\t\t\t\treturn this.Points;\r\n\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} );\r\n\r\n\t}\r\n\r\n\tfunction ascSort( a, b ) {\r\n\r\n\t\treturn a.distance - b.distance;\r\n\r\n\t}\r\n\r\n\tfunction intersectObject( object, raycaster, intersects, recursive ) {\r\n\r\n\t\tif ( object.visible === false ) return;\r\n\r\n\t\tobject.raycast( raycaster, intersects );\r\n\r\n\t\tif ( recursive === true ) {\r\n\r\n\t\t\tvar children = object.children;\r\n\r\n\t\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tintersectObject( children[ i ], raycaster, intersects, true );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tObject.assign( Raycaster.prototype, {\r\n\r\n\t\tlinePrecision: 1,\r\n\r\n\t\tset: function ( origin, direction ) {\r\n\r\n\t\t\t// direction is assumed to be normalized (for accurate distance calculations)\r\n\r\n\t\t\tthis.ray.set( origin, direction );\r\n\r\n\t\t},\r\n\r\n\t\tsetFromCamera: function ( coords, camera ) {\r\n\r\n\t\t\tif ( ( camera && camera.isPerspectiveCamera ) ) {\r\n\r\n\t\t\t\tthis.ray.origin.setFromMatrixPosition( camera.matrixWorld );\r\n\t\t\t\tthis.ray.direction.set( coords.x, coords.y, 0.5 ).unproject( camera ).sub( this.ray.origin ).normalize();\r\n\r\n\t\t\t} else if ( ( camera && camera.isOrthographicCamera ) ) {\r\n\r\n\t\t\t\tthis.ray.origin.set( coords.x, coords.y, ( camera.near + camera.far ) / ( camera.near - camera.far ) ).unproject( camera ); // set origin in plane of camera\r\n\t\t\t\tthis.ray.direction.set( 0, 0, - 1 ).transformDirection( camera.matrixWorld );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconsole.error( 'THREE.Raycaster: Unsupported camera type.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tintersectObject: function ( object, recursive, optionalTarget ) {\r\n\r\n\t\t\tvar intersects = optionalTarget || [];\r\n\r\n\t\t\tintersectObject( object, this, intersects, recursive );\r\n\r\n\t\t\tintersects.sort( ascSort );\r\n\r\n\t\t\treturn intersects;\r\n\r\n\t\t},\r\n\r\n\t\tintersectObjects: function ( objects, recursive, optionalTarget ) {\r\n\r\n\t\t\tvar intersects = optionalTarget || [];\r\n\r\n\t\t\tif ( Array.isArray( objects ) === false ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Raycaster.intersectObjects: objects is not an Array.' );\r\n\t\t\t\treturn intersects;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var i = 0, l = objects.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tintersectObject( objects[ i ], this, intersects, recursive );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tintersects.sort( ascSort );\r\n\r\n\t\t\treturn intersects;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\r\n\tfunction Clock( autoStart ) {\r\n\r\n\t\tthis.autoStart = ( autoStart !== undefined ) ? autoStart : true;\r\n\r\n\t\tthis.startTime = 0;\r\n\t\tthis.oldTime = 0;\r\n\t\tthis.elapsedTime = 0;\r\n\r\n\t\tthis.running = false;\r\n\r\n\t}\r\n\r\n\tObject.assign( Clock.prototype, {\r\n\r\n\t\tstart: function () {\r\n\r\n\t\t\tthis.startTime = ( typeof performance === 'undefined' ? Date : performance ).now(); // see #10732\r\n\r\n\t\t\tthis.oldTime = this.startTime;\r\n\t\t\tthis.elapsedTime = 0;\r\n\t\t\tthis.running = true;\r\n\r\n\t\t},\r\n\r\n\t\tstop: function () {\r\n\r\n\t\t\tthis.getElapsedTime();\r\n\t\t\tthis.running = false;\r\n\t\t\tthis.autoStart = false;\r\n\r\n\t\t},\r\n\r\n\t\tgetElapsedTime: function () {\r\n\r\n\t\t\tthis.getDelta();\r\n\t\t\treturn this.elapsedTime;\r\n\r\n\t\t},\r\n\r\n\t\tgetDelta: function () {\r\n\r\n\t\t\tvar diff = 0;\r\n\r\n\t\t\tif ( this.autoStart && ! this.running ) {\r\n\r\n\t\t\t\tthis.start();\r\n\t\t\t\treturn 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.running ) {\r\n\r\n\t\t\t\tvar newTime = ( typeof performance === 'undefined' ? Date : performance ).now();\r\n\r\n\t\t\t\tdiff = ( newTime - this.oldTime ) / 1000;\r\n\t\t\t\tthis.oldTime = newTime;\r\n\r\n\t\t\t\tthis.elapsedTime += diff;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn diff;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author bhouston / http://clara.io\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t *\r\n\t * Ref: https://en.wikipedia.org/wiki/Spherical_coordinate_system\r\n\t *\r\n\t * The polar angle (phi) is measured from the positive y-axis. The positive y-axis is up.\r\n\t * The azimuthal angle (theta) is measured from the positive z-axiz.\r\n\t */\r\n\r\n\tfunction Spherical( radius, phi, theta ) {\r\n\r\n\t\tthis.radius = ( radius !== undefined ) ? radius : 1.0;\r\n\t\tthis.phi = ( phi !== undefined ) ? phi : 0; // polar angle\r\n\t\tthis.theta = ( theta !== undefined ) ? theta : 0; // azimuthal angle\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\tObject.assign( Spherical.prototype, {\r\n\r\n\t\tset: function ( radius, phi, theta ) {\r\n\r\n\t\t\tthis.radius = radius;\r\n\t\t\tthis.phi = phi;\r\n\t\t\tthis.theta = theta;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( other ) {\r\n\r\n\t\t\tthis.radius = other.radius;\r\n\t\t\tthis.phi = other.phi;\r\n\t\t\tthis.theta = other.theta;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\t// restrict phi to be betwee EPS and PI-EPS\r\n\t\tmakeSafe: function () {\r\n\r\n\t\t\tvar EPS = 0.000001;\r\n\t\t\tthis.phi = Math.max( EPS, Math.min( Math.PI - EPS, this.phi ) );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromVector3: function ( v ) {\r\n\r\n\t\t\treturn this.setFromCartesianCoords( v.x, v.y, v.z );\r\n\r\n\t\t},\r\n\r\n\t\tsetFromCartesianCoords: function ( x, y, z ) {\r\n\r\n\t\t\tthis.radius = Math.sqrt( x * x + y * y + z * z );\r\n\r\n\t\t\tif ( this.radius === 0 ) {\r\n\r\n\t\t\t\tthis.theta = 0;\r\n\t\t\t\tthis.phi = 0;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.theta = Math.atan2( x, z );\r\n\t\t\t\tthis.phi = Math.acos( _Math.clamp( y / this.radius, - 1, 1 ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t *\r\n\t * Ref: https://en.wikipedia.org/wiki/Cylindrical_coordinate_system\r\n\t *\r\n\t */\r\n\r\n\tfunction Cylindrical( radius, theta, y ) {\r\n\r\n\t\tthis.radius = ( radius !== undefined ) ? radius : 1.0; // distance from the origin to a point in the x-z plane\r\n\t\tthis.theta = ( theta !== undefined ) ? theta : 0; // counterclockwise angle in the x-z plane measured in radians from the positive z-axis\r\n\t\tthis.y = ( y !== undefined ) ? y : 0; // height above the x-z plane\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\tObject.assign( Cylindrical.prototype, {\r\n\r\n\t\tset: function ( radius, theta, y ) {\r\n\r\n\t\t\tthis.radius = radius;\r\n\t\t\tthis.theta = theta;\r\n\t\t\tthis.y = y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( other ) {\r\n\r\n\t\t\tthis.radius = other.radius;\r\n\t\t\tthis.theta = other.theta;\r\n\t\t\tthis.y = other.y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromVector3: function ( v ) {\r\n\r\n\t\t\treturn this.setFromCartesianCoords( v.x, v.y, v.z );\r\n\r\n\t\t},\r\n\r\n\t\tsetFromCartesianCoords: function ( x, y, z ) {\r\n\r\n\t\t\tthis.radius = Math.sqrt( x * x + z * z );\r\n\t\t\tthis.theta = Math.atan2( x, z );\r\n\t\t\tthis.y = y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author bhouston / http://clara.io\r\n\t */\r\n\r\n\tfunction Box2( min, max ) {\r\n\r\n\t\tthis.min = ( min !== undefined ) ? min : new Vector2( + Infinity, + Infinity );\r\n\t\tthis.max = ( max !== undefined ) ? max : new Vector2( - Infinity, - Infinity );\r\n\r\n\t}\r\n\r\n\tObject.assign( Box2.prototype, {\r\n\r\n\t\tset: function ( min, max ) {\r\n\r\n\t\t\tthis.min.copy( min );\r\n\t\t\tthis.max.copy( max );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromPoints: function ( points ) {\r\n\r\n\t\t\tthis.makeEmpty();\r\n\r\n\t\t\tfor ( var i = 0, il = points.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tthis.expandByPoint( points[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromCenterAndSize: function () {\r\n\r\n\t\t\tvar v1 = new Vector2();\r\n\r\n\t\t\treturn function setFromCenterAndSize( center, size ) {\r\n\r\n\t\t\t\tvar halfSize = v1.copy( size ).multiplyScalar( 0.5 );\r\n\t\t\t\tthis.min.copy( center ).sub( halfSize );\r\n\t\t\t\tthis.max.copy( center ).add( halfSize );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( box ) {\r\n\r\n\t\t\tthis.min.copy( box.min );\r\n\t\t\tthis.max.copy( box.max );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmakeEmpty: function () {\r\n\r\n\t\t\tthis.min.x = this.min.y = + Infinity;\r\n\t\t\tthis.max.x = this.max.y = - Infinity;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tisEmpty: function () {\r\n\r\n\t\t\t// this is a more robust check for empty than ( volume <= 0 ) because volume can get positive with two negative axes\r\n\r\n\t\t\treturn ( this.max.x < this.min.x ) || ( this.max.y < this.min.y );\r\n\r\n\t\t},\r\n\r\n\t\tgetCenter: function ( target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Box2: .getCenter() target is now required' );\r\n\t\t\t\ttarget = new Vector2();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this.isEmpty() ? target.set( 0, 0 ) : target.addVectors( this.min, this.max ).multiplyScalar( 0.5 );\r\n\r\n\t\t},\r\n\r\n\t\tgetSize: function ( target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Box2: .getSize() target is now required' );\r\n\t\t\t\ttarget = new Vector2();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this.isEmpty() ? target.set( 0, 0 ) : target.subVectors( this.max, this.min );\r\n\r\n\t\t},\r\n\r\n\t\texpandByPoint: function ( point ) {\r\n\r\n\t\t\tthis.min.min( point );\r\n\t\t\tthis.max.max( point );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\texpandByVector: function ( vector ) {\r\n\r\n\t\t\tthis.min.sub( vector );\r\n\t\t\tthis.max.add( vector );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\texpandByScalar: function ( scalar ) {\r\n\r\n\t\t\tthis.min.addScalar( - scalar );\r\n\t\t\tthis.max.addScalar( scalar );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcontainsPoint: function ( point ) {\r\n\r\n\t\t\treturn point.x < this.min.x || point.x > this.max.x ||\r\n\t\t\t\tpoint.y < this.min.y || point.y > this.max.y ? false : true;\r\n\r\n\t\t},\r\n\r\n\t\tcontainsBox: function ( box ) {\r\n\r\n\t\t\treturn this.min.x <= box.min.x && box.max.x <= this.max.x &&\r\n\t\t\t\tthis.min.y <= box.min.y && box.max.y <= this.max.y;\r\n\r\n\t\t},\r\n\r\n\t\tgetParameter: function ( point, target ) {\r\n\r\n\t\t\t// This can potentially have a divide by zero if the box\r\n\t\t\t// has a size dimension of 0.\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Box2: .getParameter() target is now required' );\r\n\t\t\t\ttarget = new Vector2();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn target.set(\r\n\t\t\t\t( point.x - this.min.x ) / ( this.max.x - this.min.x ),\r\n\t\t\t\t( point.y - this.min.y ) / ( this.max.y - this.min.y )\r\n\t\t\t);\r\n\r\n\t\t},\r\n\r\n\t\tintersectsBox: function ( box ) {\r\n\r\n\t\t\t// using 4 splitting planes to rule out intersections\r\n\r\n\t\t\treturn box.max.x < this.min.x || box.min.x > this.max.x ||\r\n\t\t\t\tbox.max.y < this.min.y || box.min.y > this.max.y ? false : true;\r\n\r\n\t\t},\r\n\r\n\t\tclampPoint: function ( point, target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Box2: .clampPoint() target is now required' );\r\n\t\t\t\ttarget = new Vector2();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn target.copy( point ).clamp( this.min, this.max );\r\n\r\n\t\t},\r\n\r\n\t\tdistanceToPoint: function () {\r\n\r\n\t\t\tvar v1 = new Vector2();\r\n\r\n\t\t\treturn function distanceToPoint( point ) {\r\n\r\n\t\t\t\tvar clampedPoint = v1.copy( point ).clamp( this.min, this.max );\r\n\t\t\t\treturn clampedPoint.sub( point ).length();\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tintersect: function ( box ) {\r\n\r\n\t\t\tthis.min.max( box.min );\r\n\t\t\tthis.max.min( box.max );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tunion: function ( box ) {\r\n\r\n\t\t\tthis.min.min( box.min );\r\n\t\t\tthis.max.max( box.max );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttranslate: function ( offset ) {\r\n\r\n\t\t\tthis.min.add( offset );\r\n\t\t\tthis.max.add( offset );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tequals: function ( box ) {\r\n\r\n\t\t\treturn box.min.equals( this.min ) && box.max.equals( this.max );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author bhouston / http://clara.io\r\n\t */\r\n\r\n\tfunction Line3( start, end ) {\r\n\r\n\t\tthis.start = ( start !== undefined ) ? start : new Vector3();\r\n\t\tthis.end = ( end !== undefined ) ? end : new Vector3();\r\n\r\n\t}\r\n\r\n\tObject.assign( Line3.prototype, {\r\n\r\n\t\tset: function ( start, end ) {\r\n\r\n\t\t\tthis.start.copy( start );\r\n\t\t\tthis.end.copy( end );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( line ) {\r\n\r\n\t\t\tthis.start.copy( line.start );\r\n\t\t\tthis.end.copy( line.end );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetCenter: function ( target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Line3: .getCenter() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn target.addVectors( this.start, this.end ).multiplyScalar( 0.5 );\r\n\r\n\t\t},\r\n\r\n\t\tdelta: function ( target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Line3: .delta() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn target.subVectors( this.end, this.start );\r\n\r\n\t\t},\r\n\r\n\t\tdistanceSq: function () {\r\n\r\n\t\t\treturn this.start.distanceToSquared( this.end );\r\n\r\n\t\t},\r\n\r\n\t\tdistance: function () {\r\n\r\n\t\t\treturn this.start.distanceTo( this.end );\r\n\r\n\t\t},\r\n\r\n\t\tat: function ( t, target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Line3: .at() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this.delta( target ).multiplyScalar( t ).add( this.start );\r\n\r\n\t\t},\r\n\r\n\t\tclosestPointToPointParameter: function () {\r\n\r\n\t\t\tvar startP = new Vector3();\r\n\t\t\tvar startEnd = new Vector3();\r\n\r\n\t\t\treturn function closestPointToPointParameter( point, clampToLine ) {\r\n\r\n\t\t\t\tstartP.subVectors( point, this.start );\r\n\t\t\t\tstartEnd.subVectors( this.end, this.start );\r\n\r\n\t\t\t\tvar startEnd2 = startEnd.dot( startEnd );\r\n\t\t\t\tvar startEnd_startP = startEnd.dot( startP );\r\n\r\n\t\t\t\tvar t = startEnd_startP / startEnd2;\r\n\r\n\t\t\t\tif ( clampToLine ) {\r\n\r\n\t\t\t\t\tt = _Math.clamp( t, 0, 1 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn t;\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\r\n\t\tclosestPointToPoint: function ( point, clampToLine, target ) {\r\n\r\n\t\t\tvar t = this.closestPointToPointParameter( point, clampToLine );\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Line3: .closestPointToPoint() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this.delta( target ).multiplyScalar( t ).add( this.start );\r\n\r\n\t\t},\r\n\r\n\t\tapplyMatrix4: function ( matrix ) {\r\n\r\n\t\t\tthis.start.applyMatrix4( matrix );\r\n\t\t\tthis.end.applyMatrix4( matrix );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tequals: function ( line ) {\r\n\r\n\t\t\treturn line.start.equals( this.start ) && line.end.equals( this.end );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\r\n\tfunction ImmediateRenderObject( material ) {\r\n\r\n\t\tObject3D.call( this );\r\n\r\n\t\tthis.material = material;\r\n\t\tthis.render = function ( /* renderCallback */ ) {};\r\n\r\n\t}\r\n\r\n\tImmediateRenderObject.prototype = Object.create( Object3D.prototype );\r\n\tImmediateRenderObject.prototype.constructor = ImmediateRenderObject;\r\n\r\n\tImmediateRenderObject.prototype.isImmediateRenderObject = true;\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t */\r\n\r\n\tfunction VertexNormalsHelper( object, size, hex, linewidth ) {\r\n\r\n\t\tthis.object = object;\r\n\r\n\t\tthis.size = ( size !== undefined ) ? size : 1;\r\n\r\n\t\tvar color = ( hex !== undefined ) ? hex : 0xff0000;\r\n\r\n\t\tvar width = ( linewidth !== undefined ) ? linewidth : 1;\r\n\r\n\t\t//\r\n\r\n\t\tvar nNormals = 0;\r\n\r\n\t\tvar objGeometry = this.object.geometry;\r\n\r\n\t\tif ( objGeometry && objGeometry.isGeometry ) {\r\n\r\n\t\t\tnNormals = objGeometry.faces.length * 3;\r\n\r\n\t\t} else if ( objGeometry && objGeometry.isBufferGeometry ) {\r\n\r\n\t\t\tnNormals = objGeometry.attributes.normal.count;\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tvar geometry = new BufferGeometry();\r\n\r\n\t\tvar positions = new Float32BufferAttribute( nNormals * 2 * 3, 3 );\r\n\r\n\t\tgeometry.addAttribute( 'position', positions );\r\n\r\n\t\tLineSegments.call( this, geometry, new LineBasicMaterial( { color: color, linewidth: width } ) );\r\n\r\n\t\t//\r\n\r\n\t\tthis.matrixAutoUpdate = false;\r\n\r\n\t\tthis.update();\r\n\r\n\t}\r\n\r\n\tVertexNormalsHelper.prototype = Object.create( LineSegments.prototype );\r\n\tVertexNormalsHelper.prototype.constructor = VertexNormalsHelper;\r\n\r\n\tVertexNormalsHelper.prototype.update = ( function () {\r\n\r\n\t\tvar v1 = new Vector3();\r\n\t\tvar v2 = new Vector3();\r\n\t\tvar normalMatrix = new Matrix3();\r\n\r\n\t\treturn function update() {\r\n\r\n\t\t\tvar keys = [ 'a', 'b', 'c' ];\r\n\r\n\t\t\tthis.object.updateMatrixWorld( true );\r\n\r\n\t\t\tnormalMatrix.getNormalMatrix( this.object.matrixWorld );\r\n\r\n\t\t\tvar matrixWorld = this.object.matrixWorld;\r\n\r\n\t\t\tvar position = this.geometry.attributes.position;\r\n\r\n\t\t\t//\r\n\r\n\t\t\tvar objGeometry = this.object.geometry;\r\n\r\n\t\t\tif ( objGeometry && objGeometry.isGeometry ) {\r\n\r\n\t\t\t\tvar vertices = objGeometry.vertices;\r\n\r\n\t\t\t\tvar faces = objGeometry.faces;\r\n\r\n\t\t\t\tvar idx = 0;\r\n\r\n\t\t\t\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tvar face = faces[ i ];\r\n\r\n\t\t\t\t\tfor ( var j = 0, jl = face.vertexNormals.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\t\tvar vertex = vertices[ face[ keys[ j ] ] ];\r\n\r\n\t\t\t\t\t\tvar normal = face.vertexNormals[ j ];\r\n\r\n\t\t\t\t\t\tv1.copy( vertex ).applyMatrix4( matrixWorld );\r\n\r\n\t\t\t\t\t\tv2.copy( normal ).applyMatrix3( normalMatrix ).normalize().multiplyScalar( this.size ).add( v1 );\r\n\r\n\t\t\t\t\t\tposition.setXYZ( idx, v1.x, v1.y, v1.z );\r\n\r\n\t\t\t\t\t\tidx = idx + 1;\r\n\r\n\t\t\t\t\t\tposition.setXYZ( idx, v2.x, v2.y, v2.z );\r\n\r\n\t\t\t\t\t\tidx = idx + 1;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( objGeometry && objGeometry.isBufferGeometry ) {\r\n\r\n\t\t\t\tvar objPos = objGeometry.attributes.position;\r\n\r\n\t\t\t\tvar objNorm = objGeometry.attributes.normal;\r\n\r\n\t\t\t\tvar idx = 0;\r\n\r\n\t\t\t\t// for simplicity, ignore index and drawcalls, and render every normal\r\n\r\n\t\t\t\tfor ( var j = 0, jl = objPos.count; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\tv1.set( objPos.getX( j ), objPos.getY( j ), objPos.getZ( j ) ).applyMatrix4( matrixWorld );\r\n\r\n\t\t\t\t\tv2.set( objNorm.getX( j ), objNorm.getY( j ), objNorm.getZ( j ) );\r\n\r\n\t\t\t\t\tv2.applyMatrix3( normalMatrix ).normalize().multiplyScalar( this.size ).add( v1 );\r\n\r\n\t\t\t\t\tposition.setXYZ( idx, v1.x, v1.y, v1.z );\r\n\r\n\t\t\t\t\tidx = idx + 1;\r\n\r\n\t\t\t\t\tposition.setXYZ( idx, v2.x, v2.y, v2.z );\r\n\r\n\t\t\t\t\tidx = idx + 1;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tposition.needsUpdate = true;\r\n\r\n\t\t};\r\n\r\n\t}() );\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t */\r\n\r\n\tfunction SpotLightHelper( light, color ) {\r\n\r\n\t\tObject3D.call( this );\r\n\r\n\t\tthis.light = light;\r\n\t\tthis.light.updateMatrixWorld();\r\n\r\n\t\tthis.matrix = light.matrixWorld;\r\n\t\tthis.matrixAutoUpdate = false;\r\n\r\n\t\tthis.color = color;\r\n\r\n\t\tvar geometry = new BufferGeometry();\r\n\r\n\t\tvar positions = [\r\n\t\t\t0, 0, 0, \t0, 0, 1,\r\n\t\t\t0, 0, 0, \t1, 0, 1,\r\n\t\t\t0, 0, 0,\t- 1, 0, 1,\r\n\t\t\t0, 0, 0, \t0, 1, 1,\r\n\t\t\t0, 0, 0, \t0, - 1, 1\r\n\t\t];\r\n\r\n\t\tfor ( var i = 0, j = 1, l = 32; i < l; i ++, j ++ ) {\r\n\r\n\t\t\tvar p1 = ( i / l ) * Math.PI * 2;\r\n\t\t\tvar p2 = ( j / l ) * Math.PI * 2;\r\n\r\n\t\t\tpositions.push(\r\n\t\t\t\tMath.cos( p1 ), Math.sin( p1 ), 1,\r\n\t\t\t\tMath.cos( p2 ), Math.sin( p2 ), 1\r\n\t\t\t);\r\n\r\n\t\t}\r\n\r\n\t\tgeometry.addAttribute( 'position', new Float32BufferAttribute( positions, 3 ) );\r\n\r\n\t\tvar material = new LineBasicMaterial( { fog: false } );\r\n\r\n\t\tthis.cone = new LineSegments( geometry, material );\r\n\t\tthis.add( this.cone );\r\n\r\n\t\tthis.update();\r\n\r\n\t}\r\n\r\n\tSpotLightHelper.prototype = Object.create( Object3D.prototype );\r\n\tSpotLightHelper.prototype.constructor = SpotLightHelper;\r\n\r\n\tSpotLightHelper.prototype.dispose = function () {\r\n\r\n\t\tthis.cone.geometry.dispose();\r\n\t\tthis.cone.material.dispose();\r\n\r\n\t};\r\n\r\n\tSpotLightHelper.prototype.update = function () {\r\n\r\n\t\tvar vector = new Vector3();\r\n\t\tvar vector2 = new Vector3();\r\n\r\n\t\treturn function update() {\r\n\r\n\t\t\tthis.light.updateMatrixWorld();\r\n\r\n\t\t\tvar coneLength = this.light.distance ? this.light.distance : 1000;\r\n\t\t\tvar coneWidth = coneLength * Math.tan( this.light.angle );\r\n\r\n\t\t\tthis.cone.scale.set( coneWidth, coneWidth, coneLength );\r\n\r\n\t\t\tvector.setFromMatrixPosition( this.light.matrixWorld );\r\n\t\t\tvector2.setFromMatrixPosition( this.light.target.matrixWorld );\r\n\r\n\t\t\tthis.cone.lookAt( vector2.sub( vector ) );\r\n\r\n\t\t\tif ( this.color !== undefined ) {\r\n\r\n\t\t\t\tthis.cone.material.color.set( this.color );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.cone.material.color.copy( this.light.color );\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t}();\r\n\r\n\t/**\r\n\t * @author Sean Griffin / http://twitter.com/sgrif\r\n\t * @author Michael Guerrero / http://realitymeltdown.com\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author ikerr / http://verold.com\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t */\r\n\r\n\tfunction getBoneList( object ) {\r\n\r\n\t\tvar boneList = [];\r\n\r\n\t\tif ( object && object.isBone ) {\r\n\r\n\t\t\tboneList.push( object );\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0; i < object.children.length; i ++ ) {\r\n\r\n\t\t\tboneList.push.apply( boneList, getBoneList( object.children[ i ] ) );\r\n\r\n\t\t}\r\n\r\n\t\treturn boneList;\r\n\r\n\t}\r\n\r\n\tfunction SkeletonHelper( object ) {\r\n\r\n\t\tvar bones = getBoneList( object );\r\n\r\n\t\tvar geometry = new BufferGeometry();\r\n\r\n\t\tvar vertices = [];\r\n\t\tvar colors = [];\r\n\r\n\t\tvar color1 = new Color( 0, 0, 1 );\r\n\t\tvar color2 = new Color( 0, 1, 0 );\r\n\r\n\t\tfor ( var i = 0; i < bones.length; i ++ ) {\r\n\r\n\t\t\tvar bone = bones[ i ];\r\n\r\n\t\t\tif ( bone.parent && bone.parent.isBone ) {\r\n\r\n\t\t\t\tvertices.push( 0, 0, 0 );\r\n\t\t\t\tvertices.push( 0, 0, 0 );\r\n\t\t\t\tcolors.push( color1.r, color1.g, color1.b );\r\n\t\t\t\tcolors.push( color2.r, color2.g, color2.b );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tgeometry.addAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\t\tgeometry.addAttribute( 'color', new Float32BufferAttribute( colors, 3 ) );\r\n\r\n\t\tvar material = new LineBasicMaterial( { vertexColors: VertexColors, depthTest: false, depthWrite: false, transparent: true } );\r\n\r\n\t\tLineSegments.call( this, geometry, material );\r\n\r\n\t\tthis.root = object;\r\n\t\tthis.bones = bones;\r\n\r\n\t\tthis.matrix = object.matrixWorld;\r\n\t\tthis.matrixAutoUpdate = false;\r\n\r\n\t}\r\n\r\n\tSkeletonHelper.prototype = Object.create( LineSegments.prototype );\r\n\tSkeletonHelper.prototype.constructor = SkeletonHelper;\r\n\r\n\tSkeletonHelper.prototype.updateMatrixWorld = function () {\r\n\r\n\t\tvar vector = new Vector3();\r\n\r\n\t\tvar boneMatrix = new Matrix4();\r\n\t\tvar matrixWorldInv = new Matrix4();\r\n\r\n\t\treturn function updateMatrixWorld( force ) {\r\n\r\n\t\t\tvar bones = this.bones;\r\n\r\n\t\t\tvar geometry = this.geometry;\r\n\t\t\tvar position = geometry.getAttribute( 'position' );\r\n\r\n\t\t\tmatrixWorldInv.getInverse( this.root.matrixWorld );\r\n\r\n\t\t\tfor ( var i = 0, j = 0; i < bones.length; i ++ ) {\r\n\r\n\t\t\t\tvar bone = bones[ i ];\r\n\r\n\t\t\t\tif ( bone.parent && bone.parent.isBone ) {\r\n\r\n\t\t\t\t\tboneMatrix.multiplyMatrices( matrixWorldInv, bone.matrixWorld );\r\n\t\t\t\t\tvector.setFromMatrixPosition( boneMatrix );\r\n\t\t\t\t\tposition.setXYZ( j, vector.x, vector.y, vector.z );\r\n\r\n\t\t\t\t\tboneMatrix.multiplyMatrices( matrixWorldInv, bone.parent.matrixWorld );\r\n\t\t\t\t\tvector.setFromMatrixPosition( boneMatrix );\r\n\t\t\t\t\tposition.setXYZ( j + 1, vector.x, vector.y, vector.z );\r\n\r\n\t\t\t\t\tj += 2;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry.getAttribute( 'position' ).needsUpdate = true;\r\n\r\n\t\t\tObject3D.prototype.updateMatrixWorld.call( this, force );\r\n\r\n\t\t};\r\n\r\n\t}();\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction PointLightHelper( light, sphereSize, color ) {\r\n\r\n\t\tthis.light = light;\r\n\t\tthis.light.updateMatrixWorld();\r\n\r\n\t\tthis.color = color;\r\n\r\n\t\tvar geometry = new SphereBufferGeometry( sphereSize, 4, 2 );\r\n\t\tvar material = new MeshBasicMaterial( { wireframe: true, fog: false } );\r\n\r\n\t\tMesh.call( this, geometry, material );\r\n\r\n\t\tthis.matrix = this.light.matrixWorld;\r\n\t\tthis.matrixAutoUpdate = false;\r\n\r\n\t\tthis.update();\r\n\r\n\r\n\t\t/*\r\n\t\tvar distanceGeometry = new THREE.IcosahedronGeometry( 1, 2 );\r\n\t\tvar distanceMaterial = new THREE.MeshBasicMaterial( { color: hexColor, fog: false, wireframe: true, opacity: 0.1, transparent: true } );\r\n\r\n\t\tthis.lightSphere = new THREE.Mesh( bulbGeometry, bulbMaterial );\r\n\t\tthis.lightDistance = new THREE.Mesh( distanceGeometry, distanceMaterial );\r\n\r\n\t\tvar d = light.distance;\r\n\r\n\t\tif ( d === 0.0 ) {\r\n\r\n\t\t\tthis.lightDistance.visible = false;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.lightDistance.scale.set( d, d, d );\r\n\r\n\t\t}\r\n\r\n\t\tthis.add( this.lightDistance );\r\n\t\t*/\r\n\r\n\t}\r\n\r\n\tPointLightHelper.prototype = Object.create( Mesh.prototype );\r\n\tPointLightHelper.prototype.constructor = PointLightHelper;\r\n\r\n\tPointLightHelper.prototype.dispose = function () {\r\n\r\n\t\tthis.geometry.dispose();\r\n\t\tthis.material.dispose();\r\n\r\n\t};\r\n\r\n\tPointLightHelper.prototype.update = function () {\r\n\r\n\t\tif ( this.color !== undefined ) {\r\n\r\n\t\t\tthis.material.color.set( this.color );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.material.color.copy( this.light.color );\r\n\r\n\t\t}\r\n\r\n\t\t/*\r\n\t\tvar d = this.light.distance;\r\n\r\n\t\tif ( d === 0.0 ) {\r\n\r\n\t\t\tthis.lightDistance.visible = false;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.lightDistance.visible = true;\r\n\t\t\tthis.lightDistance.scale.set( d, d, d );\r\n\r\n\t\t}\r\n\t\t*/\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author abelnation / http://github.com/abelnation\r\n\t * @author Mugen87 / http://github.com/Mugen87\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t */\r\n\r\n\tfunction RectAreaLightHelper( light, color ) {\r\n\r\n\t\tObject3D.call( this );\r\n\r\n\t\tthis.light = light;\r\n\t\tthis.light.updateMatrixWorld();\r\n\r\n\t\tthis.matrix = light.matrixWorld;\r\n\t\tthis.matrixAutoUpdate = false;\r\n\r\n\t\tthis.color = color;\r\n\r\n\t\tvar material = new LineBasicMaterial( { fog: false } );\r\n\r\n\t\tvar geometry = new BufferGeometry();\r\n\r\n\t\tgeometry.addAttribute( 'position', new BufferAttribute( new Float32Array( 5 * 3 ), 3 ) );\r\n\r\n\t\tthis.line = new Line( geometry, material );\r\n\t\tthis.add( this.line );\r\n\r\n\r\n\t\tthis.update();\r\n\r\n\t}\r\n\r\n\tRectAreaLightHelper.prototype = Object.create( Object3D.prototype );\r\n\tRectAreaLightHelper.prototype.constructor = RectAreaLightHelper;\r\n\r\n\tRectAreaLightHelper.prototype.dispose = function () {\r\n\r\n\t\tthis.children[ 0 ].geometry.dispose();\r\n\t\tthis.children[ 0 ].material.dispose();\r\n\r\n\t};\r\n\r\n\tRectAreaLightHelper.prototype.update = function () {\r\n\r\n\t\t// calculate new dimensions of the helper\r\n\r\n\t\tvar hx = this.light.width * 0.5;\r\n\t\tvar hy = this.light.height * 0.5;\r\n\r\n\t\tvar position = this.line.geometry.attributes.position;\r\n\t\tvar array = position.array;\r\n\r\n\t\t// update vertices\r\n\r\n\t\tarray[ 0 ] = hx; array[ 1 ] = - hy; array[ 2 ] = 0;\r\n\t\tarray[ 3 ] = hx; array[ 4 ] = hy; array[ 5 ] = 0;\r\n\t\tarray[ 6 ] = - hx; array[ 7 ] = hy; array[ 8 ] = 0;\r\n\t\tarray[ 9 ] = - hx; array[ 10 ] = - hy; array[ 11 ] = 0;\r\n\t\tarray[ 12 ] = hx; array[ 13 ] = - hy; array[ 14 ] = 0;\r\n\r\n\t\tposition.needsUpdate = true;\r\n\r\n\t\tif ( this.color !== undefined ) {\r\n\r\n\t\t\tthis.line.material.color.set( this.color );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.line.material.color.copy( this.light.color );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t */\r\n\r\n\tfunction HemisphereLightHelper( light, size, color ) {\r\n\r\n\t\tObject3D.call( this );\r\n\r\n\t\tthis.light = light;\r\n\t\tthis.light.updateMatrixWorld();\r\n\r\n\t\tthis.matrix = light.matrixWorld;\r\n\t\tthis.matrixAutoUpdate = false;\r\n\r\n\t\tthis.color = color;\r\n\r\n\t\tvar geometry = new OctahedronBufferGeometry( size );\r\n\t\tgeometry.rotateY( Math.PI * 0.5 );\r\n\r\n\t\tthis.material = new MeshBasicMaterial( { wireframe: true, fog: false } );\r\n\t\tif ( this.color === undefined ) this.material.vertexColors = VertexColors;\r\n\r\n\t\tvar position = geometry.getAttribute( 'position' );\r\n\t\tvar colors = new Float32Array( position.count * 3 );\r\n\r\n\t\tgeometry.addAttribute( 'color', new BufferAttribute( colors, 3 ) );\r\n\r\n\t\tthis.add( new Mesh( geometry, this.material ) );\r\n\r\n\t\tthis.update();\r\n\r\n\t}\r\n\r\n\tHemisphereLightHelper.prototype = Object.create( Object3D.prototype );\r\n\tHemisphereLightHelper.prototype.constructor = HemisphereLightHelper;\r\n\r\n\tHemisphereLightHelper.prototype.dispose = function () {\r\n\r\n\t\tthis.children[ 0 ].geometry.dispose();\r\n\t\tthis.children[ 0 ].material.dispose();\r\n\r\n\t};\r\n\r\n\tHemisphereLightHelper.prototype.update = function () {\r\n\r\n\t\tvar vector = new Vector3();\r\n\r\n\t\tvar color1 = new Color();\r\n\t\tvar color2 = new Color();\r\n\r\n\t\treturn function update() {\r\n\r\n\t\t\tvar mesh = this.children[ 0 ];\r\n\r\n\t\t\tif ( this.color !== undefined ) {\r\n\r\n\t\t\t\tthis.material.color.set( this.color );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvar colors = mesh.geometry.getAttribute( 'color' );\r\n\r\n\t\t\t\tcolor1.copy( this.light.color );\r\n\t\t\t\tcolor2.copy( this.light.groundColor );\r\n\r\n\t\t\t\tfor ( var i = 0, l = colors.count; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tvar color = ( i < ( l / 2 ) ) ? color1 : color2;\r\n\r\n\t\t\t\t\tcolors.setXYZ( i, color.r, color.g, color.b );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcolors.needsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tmesh.lookAt( vector.setFromMatrixPosition( this.light.matrixWorld ).negate() );\r\n\r\n\t\t};\r\n\r\n\t}();\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction GridHelper( size, divisions, color1, color2 ) {\r\n\r\n\t\tsize = size || 10;\r\n\t\tdivisions = divisions || 10;\r\n\t\tcolor1 = new Color( color1 !== undefined ? color1 : 0x444444 );\r\n\t\tcolor2 = new Color( color2 !== undefined ? color2 : 0x888888 );\r\n\r\n\t\tvar center = divisions / 2;\r\n\t\tvar step = size / divisions;\r\n\t\tvar halfSize = size / 2;\r\n\r\n\t\tvar vertices = [], colors = [];\r\n\r\n\t\tfor ( var i = 0, j = 0, k = - halfSize; i <= divisions; i ++, k += step ) {\r\n\r\n\t\t\tvertices.push( - halfSize, 0, k, halfSize, 0, k );\r\n\t\t\tvertices.push( k, 0, - halfSize, k, 0, halfSize );\r\n\r\n\t\t\tvar color = i === center ? color1 : color2;\r\n\r\n\t\t\tcolor.toArray( colors, j ); j += 3;\r\n\t\t\tcolor.toArray( colors, j ); j += 3;\r\n\t\t\tcolor.toArray( colors, j ); j += 3;\r\n\t\t\tcolor.toArray( colors, j ); j += 3;\r\n\r\n\t\t}\r\n\r\n\t\tvar geometry = new BufferGeometry();\r\n\t\tgeometry.addAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\t\tgeometry.addAttribute( 'color', new Float32BufferAttribute( colors, 3 ) );\r\n\r\n\t\tvar material = new LineBasicMaterial( { vertexColors: VertexColors } );\r\n\r\n\t\tLineSegments.call( this, geometry, material );\r\n\r\n\t}\r\n\r\n\tGridHelper.prototype = Object.create( LineSegments.prototype );\r\n\tGridHelper.prototype.constructor = GridHelper;\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author Mugen87 / http://github.com/Mugen87\r\n\t * @author Hectate / http://www.github.com/Hectate\r\n\t */\r\n\r\n\tfunction PolarGridHelper( radius, radials, circles, divisions, color1, color2 ) {\r\n\r\n\t\tradius = radius || 10;\r\n\t\tradials = radials || 16;\r\n\t\tcircles = circles || 8;\r\n\t\tdivisions = divisions || 64;\r\n\t\tcolor1 = new Color( color1 !== undefined ? color1 : 0x444444 );\r\n\t\tcolor2 = new Color( color2 !== undefined ? color2 : 0x888888 );\r\n\r\n\t\tvar vertices = [];\r\n\t\tvar colors = [];\r\n\r\n\t\tvar x, z;\r\n\t\tvar v, i, j, r, color;\r\n\r\n\t\t// create the radials\r\n\r\n\t\tfor ( i = 0; i <= radials; i ++ ) {\r\n\r\n\t\t\tv = ( i / radials ) * ( Math.PI * 2 );\r\n\r\n\t\t\tx = Math.sin( v ) * radius;\r\n\t\t\tz = Math.cos( v ) * radius;\r\n\r\n\t\t\tvertices.push( 0, 0, 0 );\r\n\t\t\tvertices.push( x, 0, z );\r\n\r\n\t\t\tcolor = ( i & 1 ) ? color1 : color2;\r\n\r\n\t\t\tcolors.push( color.r, color.g, color.b );\r\n\t\t\tcolors.push( color.r, color.g, color.b );\r\n\r\n\t\t}\r\n\r\n\t\t// create the circles\r\n\r\n\t\tfor ( i = 0; i <= circles; i ++ ) {\r\n\r\n\t\t\tcolor = ( i & 1 ) ? color1 : color2;\r\n\r\n\t\t\tr = radius - ( radius / circles * i );\r\n\r\n\t\t\tfor ( j = 0; j < divisions; j ++ ) {\r\n\r\n\t\t\t\t// first vertex\r\n\r\n\t\t\t\tv = ( j / divisions ) * ( Math.PI * 2 );\r\n\r\n\t\t\t\tx = Math.sin( v ) * r;\r\n\t\t\t\tz = Math.cos( v ) * r;\r\n\r\n\t\t\t\tvertices.push( x, 0, z );\r\n\t\t\t\tcolors.push( color.r, color.g, color.b );\r\n\r\n\t\t\t\t// second vertex\r\n\r\n\t\t\t\tv = ( ( j + 1 ) / divisions ) * ( Math.PI * 2 );\r\n\r\n\t\t\t\tx = Math.sin( v ) * r;\r\n\t\t\t\tz = Math.cos( v ) * r;\r\n\r\n\t\t\t\tvertices.push( x, 0, z );\r\n\t\t\t\tcolors.push( color.r, color.g, color.b );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar geometry = new BufferGeometry();\r\n\t\tgeometry.addAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\t\tgeometry.addAttribute( 'color', new Float32BufferAttribute( colors, 3 ) );\r\n\r\n\t\tvar material = new LineBasicMaterial( { vertexColors: VertexColors } );\r\n\r\n\t\tLineSegments.call( this, geometry, material );\r\n\r\n\t}\r\n\r\n\tPolarGridHelper.prototype = Object.create( LineSegments.prototype );\r\n\tPolarGridHelper.prototype.constructor = PolarGridHelper;\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t */\r\n\r\n\tfunction FaceNormalsHelper( object, size, hex, linewidth ) {\r\n\r\n\t\t// FaceNormalsHelper only supports THREE.Geometry\r\n\r\n\t\tthis.object = object;\r\n\r\n\t\tthis.size = ( size !== undefined ) ? size : 1;\r\n\r\n\t\tvar color = ( hex !== undefined ) ? hex : 0xffff00;\r\n\r\n\t\tvar width = ( linewidth !== undefined ) ? linewidth : 1;\r\n\r\n\t\t//\r\n\r\n\t\tvar nNormals = 0;\r\n\r\n\t\tvar objGeometry = this.object.geometry;\r\n\r\n\t\tif ( objGeometry && objGeometry.isGeometry ) {\r\n\r\n\t\t\tnNormals = objGeometry.faces.length;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tconsole.warn( 'THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.' );\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tvar geometry = new BufferGeometry();\r\n\r\n\t\tvar positions = new Float32BufferAttribute( nNormals * 2 * 3, 3 );\r\n\r\n\t\tgeometry.addAttribute( 'position', positions );\r\n\r\n\t\tLineSegments.call( this, geometry, new LineBasicMaterial( { color: color, linewidth: width } ) );\r\n\r\n\t\t//\r\n\r\n\t\tthis.matrixAutoUpdate = false;\r\n\t\tthis.update();\r\n\r\n\t}\r\n\r\n\tFaceNormalsHelper.prototype = Object.create( LineSegments.prototype );\r\n\tFaceNormalsHelper.prototype.constructor = FaceNormalsHelper;\r\n\r\n\tFaceNormalsHelper.prototype.update = ( function () {\r\n\r\n\t\tvar v1 = new Vector3();\r\n\t\tvar v2 = new Vector3();\r\n\t\tvar normalMatrix = new Matrix3();\r\n\r\n\t\treturn function update() {\r\n\r\n\t\t\tthis.object.updateMatrixWorld( true );\r\n\r\n\t\t\tnormalMatrix.getNormalMatrix( this.object.matrixWorld );\r\n\r\n\t\t\tvar matrixWorld = this.object.matrixWorld;\r\n\r\n\t\t\tvar position = this.geometry.attributes.position;\r\n\r\n\t\t\t//\r\n\r\n\t\t\tvar objGeometry = this.object.geometry;\r\n\r\n\t\t\tvar vertices = objGeometry.vertices;\r\n\r\n\t\t\tvar faces = objGeometry.faces;\r\n\r\n\t\t\tvar idx = 0;\r\n\r\n\t\t\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar face = faces[ i ];\r\n\r\n\t\t\t\tvar normal = face.normal;\r\n\r\n\t\t\t\tv1.copy( vertices[ face.a ] )\r\n\t\t\t\t\t.add( vertices[ face.b ] )\r\n\t\t\t\t\t.add( vertices[ face.c ] )\r\n\t\t\t\t\t.divideScalar( 3 )\r\n\t\t\t\t\t.applyMatrix4( matrixWorld );\r\n\r\n\t\t\t\tv2.copy( normal ).applyMatrix3( normalMatrix ).normalize().multiplyScalar( this.size ).add( v1 );\r\n\r\n\t\t\t\tposition.setXYZ( idx, v1.x, v1.y, v1.z );\r\n\r\n\t\t\t\tidx = idx + 1;\r\n\r\n\t\t\t\tposition.setXYZ( idx, v2.x, v2.y, v2.z );\r\n\r\n\t\t\t\tidx = idx + 1;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tposition.needsUpdate = true;\r\n\r\n\t\t};\r\n\r\n\t}() );\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t */\r\n\r\n\tfunction DirectionalLightHelper( light, size, color ) {\r\n\r\n\t\tObject3D.call( this );\r\n\r\n\t\tthis.light = light;\r\n\t\tthis.light.updateMatrixWorld();\r\n\r\n\t\tthis.matrix = light.matrixWorld;\r\n\t\tthis.matrixAutoUpdate = false;\r\n\r\n\t\tthis.color = color;\r\n\r\n\t\tif ( size === undefined ) size = 1;\r\n\r\n\t\tvar geometry = new BufferGeometry();\r\n\t\tgeometry.addAttribute( 'position', new Float32BufferAttribute( [\r\n\t\t\t- size, size, 0,\r\n\t\t\tsize, size, 0,\r\n\t\t\tsize, - size, 0,\r\n\t\t\t- size, - size, 0,\r\n\t\t\t- size, size, 0\r\n\t\t], 3 ) );\r\n\r\n\t\tvar material = new LineBasicMaterial( { fog: false } );\r\n\r\n\t\tthis.lightPlane = new Line( geometry, material );\r\n\t\tthis.add( this.lightPlane );\r\n\r\n\t\tgeometry = new BufferGeometry();\r\n\t\tgeometry.addAttribute( 'position', new Float32BufferAttribute( [ 0, 0, 0, 0, 0, 1 ], 3 ) );\r\n\r\n\t\tthis.targetLine = new Line( geometry, material );\r\n\t\tthis.add( this.targetLine );\r\n\r\n\t\tthis.update();\r\n\r\n\t}\r\n\r\n\tDirectionalLightHelper.prototype = Object.create( Object3D.prototype );\r\n\tDirectionalLightHelper.prototype.constructor = DirectionalLightHelper;\r\n\r\n\tDirectionalLightHelper.prototype.dispose = function () {\r\n\r\n\t\tthis.lightPlane.geometry.dispose();\r\n\t\tthis.lightPlane.material.dispose();\r\n\t\tthis.targetLine.geometry.dispose();\r\n\t\tthis.targetLine.material.dispose();\r\n\r\n\t};\r\n\r\n\tDirectionalLightHelper.prototype.update = function () {\r\n\r\n\t\tvar v1 = new Vector3();\r\n\t\tvar v2 = new Vector3();\r\n\t\tvar v3 = new Vector3();\r\n\r\n\t\treturn function update() {\r\n\r\n\t\t\tv1.setFromMatrixPosition( this.light.matrixWorld );\r\n\t\t\tv2.setFromMatrixPosition( this.light.target.matrixWorld );\r\n\t\t\tv3.subVectors( v2, v1 );\r\n\r\n\t\t\tthis.lightPlane.lookAt( v3 );\r\n\r\n\t\t\tif ( this.color !== undefined ) {\r\n\r\n\t\t\t\tthis.lightPlane.material.color.set( this.color );\r\n\t\t\t\tthis.targetLine.material.color.set( this.color );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.lightPlane.material.color.copy( this.light.color );\r\n\t\t\t\tthis.targetLine.material.color.copy( this.light.color );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.targetLine.lookAt( v3 );\r\n\t\t\tthis.targetLine.scale.z = v3.length();\r\n\r\n\t\t};\r\n\r\n\t}();\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t *\r\n\t *\t- shows frustum, line of sight and up of the camera\r\n\t *\t- suitable for fast updates\r\n\t * \t- based on frustum visualization in lightgl.js shadowmap example\r\n\t *\t\thttp://evanw.github.com/lightgl.js/tests/shadowmap.html\r\n\t */\r\n\r\n\tfunction CameraHelper( camera ) {\r\n\r\n\t\tvar geometry = new BufferGeometry();\r\n\t\tvar material = new LineBasicMaterial( { color: 0xffffff, vertexColors: FaceColors } );\r\n\r\n\t\tvar vertices = [];\r\n\t\tvar colors = [];\r\n\r\n\t\tvar pointMap = {};\r\n\r\n\t\t// colors\r\n\r\n\t\tvar colorFrustum = new Color( 0xffaa00 );\r\n\t\tvar colorCone = new Color( 0xff0000 );\r\n\t\tvar colorUp = new Color( 0x00aaff );\r\n\t\tvar colorTarget = new Color( 0xffffff );\r\n\t\tvar colorCross = new Color( 0x333333 );\r\n\r\n\t\t// near\r\n\r\n\t\taddLine( 'n1', 'n2', colorFrustum );\r\n\t\taddLine( 'n2', 'n4', colorFrustum );\r\n\t\taddLine( 'n4', 'n3', colorFrustum );\r\n\t\taddLine( 'n3', 'n1', colorFrustum );\r\n\r\n\t\t// far\r\n\r\n\t\taddLine( 'f1', 'f2', colorFrustum );\r\n\t\taddLine( 'f2', 'f4', colorFrustum );\r\n\t\taddLine( 'f4', 'f3', colorFrustum );\r\n\t\taddLine( 'f3', 'f1', colorFrustum );\r\n\r\n\t\t// sides\r\n\r\n\t\taddLine( 'n1', 'f1', colorFrustum );\r\n\t\taddLine( 'n2', 'f2', colorFrustum );\r\n\t\taddLine( 'n3', 'f3', colorFrustum );\r\n\t\taddLine( 'n4', 'f4', colorFrustum );\r\n\r\n\t\t// cone\r\n\r\n\t\taddLine( 'p', 'n1', colorCone );\r\n\t\taddLine( 'p', 'n2', colorCone );\r\n\t\taddLine( 'p', 'n3', colorCone );\r\n\t\taddLine( 'p', 'n4', colorCone );\r\n\r\n\t\t// up\r\n\r\n\t\taddLine( 'u1', 'u2', colorUp );\r\n\t\taddLine( 'u2', 'u3', colorUp );\r\n\t\taddLine( 'u3', 'u1', colorUp );\r\n\r\n\t\t// target\r\n\r\n\t\taddLine( 'c', 't', colorTarget );\r\n\t\taddLine( 'p', 'c', colorCross );\r\n\r\n\t\t// cross\r\n\r\n\t\taddLine( 'cn1', 'cn2', colorCross );\r\n\t\taddLine( 'cn3', 'cn4', colorCross );\r\n\r\n\t\taddLine( 'cf1', 'cf2', colorCross );\r\n\t\taddLine( 'cf3', 'cf4', colorCross );\r\n\r\n\t\tfunction addLine( a, b, color ) {\r\n\r\n\t\t\taddPoint( a, color );\r\n\t\t\taddPoint( b, color );\r\n\r\n\t\t}\r\n\r\n\t\tfunction addPoint( id, color ) {\r\n\r\n\t\t\tvertices.push( 0, 0, 0 );\r\n\t\t\tcolors.push( color.r, color.g, color.b );\r\n\r\n\t\t\tif ( pointMap[ id ] === undefined ) {\r\n\r\n\t\t\t\tpointMap[ id ] = [];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tpointMap[ id ].push( ( vertices.length / 3 ) - 1 );\r\n\r\n\t\t}\r\n\r\n\t\tgeometry.addAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\t\tgeometry.addAttribute( 'color', new Float32BufferAttribute( colors, 3 ) );\r\n\r\n\t\tLineSegments.call( this, geometry, material );\r\n\r\n\t\tthis.camera = camera;\r\n\t\tif ( this.camera.updateProjectionMatrix ) this.camera.updateProjectionMatrix();\r\n\r\n\t\tthis.matrix = camera.matrixWorld;\r\n\t\tthis.matrixAutoUpdate = false;\r\n\r\n\t\tthis.pointMap = pointMap;\r\n\r\n\t\tthis.update();\r\n\r\n\t}\r\n\r\n\tCameraHelper.prototype = Object.create( LineSegments.prototype );\r\n\tCameraHelper.prototype.constructor = CameraHelper;\r\n\r\n\tCameraHelper.prototype.update = function () {\r\n\r\n\t\tvar geometry, pointMap;\r\n\r\n\t\tvar vector = new Vector3();\r\n\t\tvar camera = new Camera();\r\n\r\n\t\tfunction setPoint( point, x, y, z ) {\r\n\r\n\t\t\tvector.set( x, y, z ).unproject( camera );\r\n\r\n\t\t\tvar points = pointMap[ point ];\r\n\r\n\t\t\tif ( points !== undefined ) {\r\n\r\n\t\t\t\tvar position = geometry.getAttribute( 'position' );\r\n\r\n\t\t\t\tfor ( var i = 0, l = points.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tposition.setXYZ( points[ i ], vector.x, vector.y, vector.z );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn function update() {\r\n\r\n\t\t\tgeometry = this.geometry;\r\n\t\t\tpointMap = this.pointMap;\r\n\r\n\t\t\tvar w = 1, h = 1;\r\n\r\n\t\t\t// we need just camera projection matrix\r\n\t\t\t// world matrix must be identity\r\n\r\n\t\t\tcamera.projectionMatrix.copy( this.camera.projectionMatrix );\r\n\r\n\t\t\t// center / target\r\n\r\n\t\t\tsetPoint( 'c', 0, 0, - 1 );\r\n\t\t\tsetPoint( 't', 0, 0, 1 );\r\n\r\n\t\t\t// near\r\n\r\n\t\t\tsetPoint( 'n1', - w, - h, - 1 );\r\n\t\t\tsetPoint( 'n2', w, - h, - 1 );\r\n\t\t\tsetPoint( 'n3', - w, h, - 1 );\r\n\t\t\tsetPoint( 'n4', w, h, - 1 );\r\n\r\n\t\t\t// far\r\n\r\n\t\t\tsetPoint( 'f1', - w, - h, 1 );\r\n\t\t\tsetPoint( 'f2', w, - h, 1 );\r\n\t\t\tsetPoint( 'f3', - w, h, 1 );\r\n\t\t\tsetPoint( 'f4', w, h, 1 );\r\n\r\n\t\t\t// up\r\n\r\n\t\t\tsetPoint( 'u1', w * 0.7, h * 1.1, - 1 );\r\n\t\t\tsetPoint( 'u2', - w * 0.7, h * 1.1, - 1 );\r\n\t\t\tsetPoint( 'u3', 0, h * 2, - 1 );\r\n\r\n\t\t\t// cross\r\n\r\n\t\t\tsetPoint( 'cf1', - w, 0, 1 );\r\n\t\t\tsetPoint( 'cf2', w, 0, 1 );\r\n\t\t\tsetPoint( 'cf3', 0, - h, 1 );\r\n\t\t\tsetPoint( 'cf4', 0, h, 1 );\r\n\r\n\t\t\tsetPoint( 'cn1', - w, 0, - 1 );\r\n\t\t\tsetPoint( 'cn2', w, 0, - 1 );\r\n\t\t\tsetPoint( 'cn3', 0, - h, - 1 );\r\n\t\t\tsetPoint( 'cn4', 0, h, - 1 );\r\n\r\n\t\t\tgeometry.getAttribute( 'position' ).needsUpdate = true;\r\n\r\n\t\t};\r\n\r\n\t}();\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author Mugen87 / http://github.com/Mugen87\r\n\t */\r\n\r\n\tfunction BoxHelper( object, color ) {\r\n\r\n\t\tthis.object = object;\r\n\r\n\t\tif ( color === undefined ) color = 0xffff00;\r\n\r\n\t\tvar indices = new Uint16Array( [ 0, 1, 1, 2, 2, 3, 3, 0, 4, 5, 5, 6, 6, 7, 7, 4, 0, 4, 1, 5, 2, 6, 3, 7 ] );\r\n\t\tvar positions = new Float32Array( 8 * 3 );\r\n\r\n\t\tvar geometry = new BufferGeometry();\r\n\t\tgeometry.setIndex( new BufferAttribute( indices, 1 ) );\r\n\t\tgeometry.addAttribute( 'position', new BufferAttribute( positions, 3 ) );\r\n\r\n\t\tLineSegments.call( this, geometry, new LineBasicMaterial( { color: color } ) );\r\n\r\n\t\tthis.matrixAutoUpdate = false;\r\n\r\n\t\tthis.update();\r\n\r\n\t}\r\n\r\n\tBoxHelper.prototype = Object.create( LineSegments.prototype );\r\n\tBoxHelper.prototype.constructor = BoxHelper;\r\n\r\n\tBoxHelper.prototype.update = ( function () {\r\n\r\n\t\tvar box = new Box3();\r\n\r\n\t\treturn function update( object ) {\r\n\r\n\t\t\tif ( object !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.BoxHelper: .update() has no longer arguments.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.object !== undefined ) {\r\n\r\n\t\t\t\tbox.setFromObject( this.object );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( box.isEmpty() ) return;\r\n\r\n\t\t\tvar min = box.min;\r\n\t\t\tvar max = box.max;\r\n\r\n\t\t\t/*\r\n\t\t\t  5____4\r\n\t\t\t1/___0/|\r\n\t\t\t| 6__|_7\r\n\t\t\t2/___3/\r\n\r\n\t\t\t0: max.x, max.y, max.z\r\n\t\t\t1: min.x, max.y, max.z\r\n\t\t\t2: min.x, min.y, max.z\r\n\t\t\t3: max.x, min.y, max.z\r\n\t\t\t4: max.x, max.y, min.z\r\n\t\t\t5: min.x, max.y, min.z\r\n\t\t\t6: min.x, min.y, min.z\r\n\t\t\t7: max.x, min.y, min.z\r\n\t\t\t*/\r\n\r\n\t\t\tvar position = this.geometry.attributes.position;\r\n\t\t\tvar array = position.array;\r\n\r\n\t\t\tarray[ 0 ] = max.x; array[ 1 ] = max.y; array[ 2 ] = max.z;\r\n\t\t\tarray[ 3 ] = min.x; array[ 4 ] = max.y; array[ 5 ] = max.z;\r\n\t\t\tarray[ 6 ] = min.x; array[ 7 ] = min.y; array[ 8 ] = max.z;\r\n\t\t\tarray[ 9 ] = max.x; array[ 10 ] = min.y; array[ 11 ] = max.z;\r\n\t\t\tarray[ 12 ] = max.x; array[ 13 ] = max.y; array[ 14 ] = min.z;\r\n\t\t\tarray[ 15 ] = min.x; array[ 16 ] = max.y; array[ 17 ] = min.z;\r\n\t\t\tarray[ 18 ] = min.x; array[ 19 ] = min.y; array[ 20 ] = min.z;\r\n\t\t\tarray[ 21 ] = max.x; array[ 22 ] = min.y; array[ 23 ] = min.z;\r\n\r\n\t\t\tposition.needsUpdate = true;\r\n\r\n\t\t\tthis.geometry.computeBoundingSphere();\r\n\r\n\t\t};\r\n\r\n\t} )();\r\n\r\n\tBoxHelper.prototype.setFromObject = function ( object ) {\r\n\r\n\t\tthis.object = object;\r\n\t\tthis.update();\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t */\r\n\r\n\tfunction Box3Helper( box, hex ) {\r\n\r\n\t\tthis.type = 'Box3Helper';\r\n\r\n\t\tthis.box = box;\r\n\r\n\t\tvar color = ( hex !== undefined ) ? hex : 0xffff00;\r\n\r\n\t\tvar indices = new Uint16Array( [ 0, 1, 1, 2, 2, 3, 3, 0, 4, 5, 5, 6, 6, 7, 7, 4, 0, 4, 1, 5, 2, 6, 3, 7 ] );\r\n\r\n\t\tvar positions = [ 1, 1, 1, - 1, 1, 1, - 1, - 1, 1, 1, - 1, 1, 1, 1, - 1, - 1, 1, - 1, - 1, - 1, - 1, 1, - 1, - 1 ];\r\n\r\n\t\tvar geometry = new BufferGeometry();\r\n\r\n\t\tgeometry.setIndex( new BufferAttribute( indices, 1 ) );\r\n\r\n\t\tgeometry.addAttribute( 'position', new Float32BufferAttribute( positions, 3 ) );\r\n\r\n\t\tLineSegments.call( this, geometry, new LineBasicMaterial( { color: color } ) );\r\n\r\n\t\tthis.geometry.computeBoundingSphere();\r\n\r\n\t}\r\n\r\n\tBox3Helper.prototype = Object.create( LineSegments.prototype );\r\n\tBox3Helper.prototype.constructor = Box3Helper;\r\n\r\n\tBox3Helper.prototype.updateMatrixWorld = function ( force ) {\r\n\r\n\t\tvar box = this.box;\r\n\r\n\t\tif ( box.isEmpty() ) return;\r\n\r\n\t\tbox.getCenter( this.position );\r\n\r\n\t\tbox.getSize( this.scale );\r\n\r\n\t\tthis.scale.multiplyScalar( 0.5 );\r\n\r\n\t\tObject3D.prototype.updateMatrixWorld.call( this, force );\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t */\r\n\r\n\tfunction PlaneHelper( plane, size, hex ) {\r\n\r\n\t\tthis.type = 'PlaneHelper';\r\n\r\n\t\tthis.plane = plane;\r\n\r\n\t\tthis.size = ( size === undefined ) ? 1 : size;\r\n\r\n\t\tvar color = ( hex !== undefined ) ? hex : 0xffff00;\r\n\r\n\t\tvar positions = [ 1, - 1, 1, - 1, 1, 1, - 1, - 1, 1, 1, 1, 1, - 1, 1, 1, - 1, - 1, 1, 1, - 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0 ];\r\n\r\n\t\tvar geometry = new BufferGeometry();\r\n\t\tgeometry.addAttribute( 'position', new Float32BufferAttribute( positions, 3 ) );\r\n\t\tgeometry.computeBoundingSphere();\r\n\r\n\t\tLine.call( this, geometry, new LineBasicMaterial( { color: color } ) );\r\n\r\n\t\t//\r\n\r\n\t\tvar positions2 = [ 1, 1, 1, - 1, 1, 1, - 1, - 1, 1, 1, 1, 1, - 1, - 1, 1, 1, - 1, 1 ];\r\n\r\n\t\tvar geometry2 = new BufferGeometry();\r\n\t\tgeometry2.addAttribute( 'position', new Float32BufferAttribute( positions2, 3 ) );\r\n\t\tgeometry2.computeBoundingSphere();\r\n\r\n\t\tthis.add( new Mesh( geometry2, new MeshBasicMaterial( { color: color, opacity: 0.2, transparent: true, depthWrite: false } ) ) );\r\n\r\n\t}\r\n\r\n\tPlaneHelper.prototype = Object.create( Line.prototype );\r\n\tPlaneHelper.prototype.constructor = PlaneHelper;\r\n\r\n\tPlaneHelper.prototype.updateMatrixWorld = function ( force ) {\r\n\r\n\t\tvar scale = - this.plane.constant;\r\n\r\n\t\tif ( Math.abs( scale ) < 1e-8 ) scale = 1e-8; // sign does not matter\r\n\r\n\t\tthis.scale.set( 0.5 * this.size, 0.5 * this.size, scale );\r\n\r\n\t\tthis.children[ 0 ].material.side = ( scale < 0 ) ? BackSide : FrontSide; // renderer flips side when determinant < 0; flipping not wanted here\r\n\r\n\t\tthis.lookAt( this.plane.normal );\r\n\r\n\t\tObject3D.prototype.updateMatrixWorld.call( this, force );\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t * @author zz85 / http://github.com/zz85\r\n\t * @author bhouston / http://clara.io\r\n\t *\r\n\t * Creates an arrow for visualizing directions\r\n\t *\r\n\t * Parameters:\r\n\t *  dir - Vector3\r\n\t *  origin - Vector3\r\n\t *  length - Number\r\n\t *  color - color in hex value\r\n\t *  headLength - Number\r\n\t *  headWidth - Number\r\n\t */\r\n\r\n\tvar lineGeometry, coneGeometry;\r\n\r\n\tfunction ArrowHelper( dir, origin, length, color, headLength, headWidth ) {\r\n\r\n\t\t// dir is assumed to be normalized\r\n\r\n\t\tObject3D.call( this );\r\n\r\n\t\tif ( color === undefined ) color = 0xffff00;\r\n\t\tif ( length === undefined ) length = 1;\r\n\t\tif ( headLength === undefined ) headLength = 0.2 * length;\r\n\t\tif ( headWidth === undefined ) headWidth = 0.2 * headLength;\r\n\r\n\t\tif ( lineGeometry === undefined ) {\r\n\r\n\t\t\tlineGeometry = new BufferGeometry();\r\n\t\t\tlineGeometry.addAttribute( 'position', new Float32BufferAttribute( [ 0, 0, 0, 0, 1, 0 ], 3 ) );\r\n\r\n\t\t\tconeGeometry = new CylinderBufferGeometry( 0, 0.5, 1, 5, 1 );\r\n\t\t\tconeGeometry.translate( 0, - 0.5, 0 );\r\n\r\n\t\t}\r\n\r\n\t\tthis.position.copy( origin );\r\n\r\n\t\tthis.line = new Line( lineGeometry, new LineBasicMaterial( { color: color } ) );\r\n\t\tthis.line.matrixAutoUpdate = false;\r\n\t\tthis.add( this.line );\r\n\r\n\t\tthis.cone = new Mesh( coneGeometry, new MeshBasicMaterial( { color: color } ) );\r\n\t\tthis.cone.matrixAutoUpdate = false;\r\n\t\tthis.add( this.cone );\r\n\r\n\t\tthis.setDirection( dir );\r\n\t\tthis.setLength( length, headLength, headWidth );\r\n\r\n\t}\r\n\r\n\tArrowHelper.prototype = Object.create( Object3D.prototype );\r\n\tArrowHelper.prototype.constructor = ArrowHelper;\r\n\r\n\tArrowHelper.prototype.setDirection = ( function () {\r\n\r\n\t\tvar axis = new Vector3();\r\n\t\tvar radians;\r\n\r\n\t\treturn function setDirection( dir ) {\r\n\r\n\t\t\t// dir is assumed to be normalized\r\n\r\n\t\t\tif ( dir.y > 0.99999 ) {\r\n\r\n\t\t\t\tthis.quaternion.set( 0, 0, 0, 1 );\r\n\r\n\t\t\t} else if ( dir.y < - 0.99999 ) {\r\n\r\n\t\t\t\tthis.quaternion.set( 1, 0, 0, 0 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\taxis.set( dir.z, 0, - dir.x ).normalize();\r\n\r\n\t\t\t\tradians = Math.acos( dir.y );\r\n\r\n\t\t\t\tthis.quaternion.setFromAxisAngle( axis, radians );\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t}() );\r\n\r\n\tArrowHelper.prototype.setLength = function ( length, headLength, headWidth ) {\r\n\r\n\t\tif ( headLength === undefined ) headLength = 0.2 * length;\r\n\t\tif ( headWidth === undefined ) headWidth = 0.2 * headLength;\r\n\r\n\t\tthis.line.scale.set( 1, Math.max( 0, length - headLength ), 1 );\r\n\t\tthis.line.updateMatrix();\r\n\r\n\t\tthis.cone.scale.set( headWidth, headLength, headWidth );\r\n\t\tthis.cone.position.y = length;\r\n\t\tthis.cone.updateMatrix();\r\n\r\n\t};\r\n\r\n\tArrowHelper.prototype.setColor = function ( color ) {\r\n\r\n\t\tthis.line.material.color.copy( color );\r\n\t\tthis.cone.material.color.copy( color );\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author sroucheray / http://sroucheray.org/\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction AxesHelper( size ) {\r\n\r\n\t\tsize = size || 1;\r\n\r\n\t\tvar vertices = [\r\n\t\t\t0, 0, 0,\tsize, 0, 0,\r\n\t\t\t0, 0, 0,\t0, size, 0,\r\n\t\t\t0, 0, 0,\t0, 0, size\r\n\t\t];\r\n\r\n\t\tvar colors = [\r\n\t\t\t1, 0, 0,\t1, 0.6, 0,\r\n\t\t\t0, 1, 0,\t0.6, 1, 0,\r\n\t\t\t0, 0, 1,\t0, 0.6, 1\r\n\t\t];\r\n\r\n\t\tvar geometry = new BufferGeometry();\r\n\t\tgeometry.addAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\t\tgeometry.addAttribute( 'color', new Float32BufferAttribute( colors, 3 ) );\r\n\r\n\t\tvar material = new LineBasicMaterial( { vertexColors: VertexColors } );\r\n\r\n\t\tLineSegments.call( this, geometry, material );\r\n\r\n\t}\r\n\r\n\tAxesHelper.prototype = Object.create( LineSegments.prototype );\r\n\tAxesHelper.prototype.constructor = AxesHelper;\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction Face4( a, b, c, d, normal, color, materialIndex ) {\r\n\r\n\t\tconsole.warn( 'THREE.Face4 has been removed. A THREE.Face3 will be created instead.' );\r\n\t\treturn new Face3( a, b, c, normal, color, materialIndex );\r\n\r\n\t}\r\n\r\n\tvar LineStrip = 0;\r\n\r\n\tvar LinePieces = 1;\r\n\r\n\tfunction MeshFaceMaterial( materials ) {\r\n\r\n\t\tconsole.warn( 'THREE.MeshFaceMaterial has been removed. Use an Array instead.' );\r\n\t\treturn materials;\r\n\r\n\t}\r\n\r\n\tfunction MultiMaterial( materials ) {\r\n\r\n\t\tif ( materials === undefined ) materials = [];\r\n\r\n\t\tconsole.warn( 'THREE.MultiMaterial has been removed. Use an Array instead.' );\r\n\t\tmaterials.isMultiMaterial = true;\r\n\t\tmaterials.materials = materials;\r\n\t\tmaterials.clone = function () {\r\n\r\n\t\t\treturn materials.slice();\r\n\r\n\t\t};\r\n\t\treturn materials;\r\n\r\n\t}\r\n\r\n\tfunction PointCloud( geometry, material ) {\r\n\r\n\t\tconsole.warn( 'THREE.PointCloud has been renamed to THREE.Points.' );\r\n\t\treturn new Points( geometry, material );\r\n\r\n\t}\r\n\r\n\tfunction Particle( material ) {\r\n\r\n\t\tconsole.warn( 'THREE.Particle has been renamed to THREE.Sprite.' );\r\n\t\treturn new Sprite( material );\r\n\r\n\t}\r\n\r\n\tfunction ParticleSystem( geometry, material ) {\r\n\r\n\t\tconsole.warn( 'THREE.ParticleSystem has been renamed to THREE.Points.' );\r\n\t\treturn new Points( geometry, material );\r\n\r\n\t}\r\n\r\n\tfunction PointCloudMaterial( parameters ) {\r\n\r\n\t\tconsole.warn( 'THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial.' );\r\n\t\treturn new PointsMaterial( parameters );\r\n\r\n\t}\r\n\r\n\tfunction ParticleBasicMaterial( parameters ) {\r\n\r\n\t\tconsole.warn( 'THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial.' );\r\n\t\treturn new PointsMaterial( parameters );\r\n\r\n\t}\r\n\r\n\tfunction ParticleSystemMaterial( parameters ) {\r\n\r\n\t\tconsole.warn( 'THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial.' );\r\n\t\treturn new PointsMaterial( parameters );\r\n\r\n\t}\r\n\r\n\tfunction Vertex( x, y, z ) {\r\n\r\n\t\tconsole.warn( 'THREE.Vertex has been removed. Use THREE.Vector3 instead.' );\r\n\t\treturn new Vector3( x, y, z );\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tfunction DynamicBufferAttribute( array, itemSize ) {\r\n\r\n\t\tconsole.warn( 'THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead.' );\r\n\t\treturn new BufferAttribute( array, itemSize ).setDynamic( true );\r\n\r\n\t}\r\n\r\n\tfunction Int8Attribute( array, itemSize ) {\r\n\r\n\t\tconsole.warn( 'THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead.' );\r\n\t\treturn new Int8BufferAttribute( array, itemSize );\r\n\r\n\t}\r\n\r\n\tfunction Uint8Attribute( array, itemSize ) {\r\n\r\n\t\tconsole.warn( 'THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead.' );\r\n\t\treturn new Uint8BufferAttribute( array, itemSize );\r\n\r\n\t}\r\n\r\n\tfunction Uint8ClampedAttribute( array, itemSize ) {\r\n\r\n\t\tconsole.warn( 'THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead.' );\r\n\t\treturn new Uint8ClampedBufferAttribute( array, itemSize );\r\n\r\n\t}\r\n\r\n\tfunction Int16Attribute( array, itemSize ) {\r\n\r\n\t\tconsole.warn( 'THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead.' );\r\n\t\treturn new Int16BufferAttribute( array, itemSize );\r\n\r\n\t}\r\n\r\n\tfunction Uint16Attribute( array, itemSize ) {\r\n\r\n\t\tconsole.warn( 'THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead.' );\r\n\t\treturn new Uint16BufferAttribute( array, itemSize );\r\n\r\n\t}\r\n\r\n\tfunction Int32Attribute( array, itemSize ) {\r\n\r\n\t\tconsole.warn( 'THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead.' );\r\n\t\treturn new Int32BufferAttribute( array, itemSize );\r\n\r\n\t}\r\n\r\n\tfunction Uint32Attribute( array, itemSize ) {\r\n\r\n\t\tconsole.warn( 'THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead.' );\r\n\t\treturn new Uint32BufferAttribute( array, itemSize );\r\n\r\n\t}\r\n\r\n\tfunction Float32Attribute( array, itemSize ) {\r\n\r\n\t\tconsole.warn( 'THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead.' );\r\n\t\treturn new Float32BufferAttribute( array, itemSize );\r\n\r\n\t}\r\n\r\n\tfunction Float64Attribute( array, itemSize ) {\r\n\r\n\t\tconsole.warn( 'THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead.' );\r\n\t\treturn new Float64BufferAttribute( array, itemSize );\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tCurve.create = function ( construct, getPoint ) {\r\n\r\n\t\tconsole.log( 'THREE.Curve.create() has been deprecated' );\r\n\r\n\t\tconstruct.prototype = Object.create( Curve.prototype );\r\n\t\tconstruct.prototype.constructor = construct;\r\n\t\tconstruct.prototype.getPoint = getPoint;\r\n\r\n\t\treturn construct;\r\n\r\n\t};\r\n\r\n\t//\r\n\r\n\tObject.assign( CurvePath.prototype, {\r\n\r\n\t\tcreatePointsGeometry: function ( divisions ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.' );\r\n\r\n\t\t\t// generate geometry from path points (for Line or Points objects)\r\n\r\n\t\t\tvar pts = this.getPoints( divisions );\r\n\t\t\treturn this.createGeometry( pts );\r\n\r\n\t\t},\r\n\r\n\t\tcreateSpacedPointsGeometry: function ( divisions ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.' );\r\n\r\n\t\t\t// generate geometry from equidistant sampling along the path\r\n\r\n\t\t\tvar pts = this.getSpacedPoints( divisions );\r\n\t\t\treturn this.createGeometry( pts );\r\n\r\n\t\t},\r\n\r\n\t\tcreateGeometry: function ( points ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.' );\r\n\r\n\t\t\tvar geometry = new Geometry();\r\n\r\n\t\t\tfor ( var i = 0, l = points.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar point = points[ i ];\r\n\t\t\t\tgeometry.vertices.push( new Vector3( point.x, point.y, point.z || 0 ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn geometry;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t//\r\n\r\n\tObject.assign( Path.prototype, {\r\n\r\n\t\tfromPoints: function ( points ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Path: .fromPoints() has been renamed to .setFromPoints().' );\r\n\t\t\tthis.setFromPoints( points );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t//\r\n\r\n\tfunction ClosedSplineCurve3( points ) {\r\n\r\n\t\tconsole.warn( 'THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead.' );\r\n\r\n\t\tCatmullRomCurve3.call( this, points );\r\n\t\tthis.type = 'catmullrom';\r\n\t\tthis.closed = true;\r\n\r\n\t}\r\n\r\n\tClosedSplineCurve3.prototype = Object.create( CatmullRomCurve3.prototype );\r\n\r\n\t//\r\n\r\n\tfunction SplineCurve3( points ) {\r\n\r\n\t\tconsole.warn( 'THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead.' );\r\n\r\n\t\tCatmullRomCurve3.call( this, points );\r\n\t\tthis.type = 'catmullrom';\r\n\r\n\t}\r\n\r\n\tSplineCurve3.prototype = Object.create( CatmullRomCurve3.prototype );\r\n\r\n\t//\r\n\r\n\tfunction Spline( points ) {\r\n\r\n\t\tconsole.warn( 'THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead.' );\r\n\r\n\t\tCatmullRomCurve3.call( this, points );\r\n\t\tthis.type = 'catmullrom';\r\n\r\n\t}\r\n\r\n\tSpline.prototype = Object.create( CatmullRomCurve3.prototype );\r\n\r\n\tObject.assign( Spline.prototype, {\r\n\r\n\t\tinitFromArray: function ( /* a */ ) {\r\n\r\n\t\t\tconsole.error( 'THREE.Spline: .initFromArray() has been removed.' );\r\n\r\n\t\t},\r\n\t\tgetControlPointsArray: function ( /* optionalTarget */ ) {\r\n\r\n\t\t\tconsole.error( 'THREE.Spline: .getControlPointsArray() has been removed.' );\r\n\r\n\t\t},\r\n\t\treparametrizeByArcLength: function ( /* samplingCoef */ ) {\r\n\r\n\t\t\tconsole.error( 'THREE.Spline: .reparametrizeByArcLength() has been removed.' );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t//\r\n\r\n\tfunction AxisHelper( size ) {\r\n\r\n\t\tconsole.warn( 'THREE.AxisHelper has been renamed to THREE.AxesHelper.' );\r\n\t\treturn new AxesHelper( size );\r\n\r\n\t}\r\n\r\n\tfunction BoundingBoxHelper( object, color ) {\r\n\r\n\t\tconsole.warn( 'THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead.' );\r\n\t\treturn new BoxHelper( object, color );\r\n\r\n\t}\r\n\r\n\tfunction EdgesHelper( object, hex ) {\r\n\r\n\t\tconsole.warn( 'THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead.' );\r\n\t\treturn new LineSegments( new EdgesGeometry( object.geometry ), new LineBasicMaterial( { color: hex !== undefined ? hex : 0xffffff } ) );\r\n\r\n\t}\r\n\r\n\tGridHelper.prototype.setColors = function () {\r\n\r\n\t\tconsole.error( 'THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.' );\r\n\r\n\t};\r\n\r\n\tSkeletonHelper.prototype.update = function () {\r\n\r\n\t\tconsole.error( 'THREE.SkeletonHelper: update() no longer needs to be called.' );\r\n\r\n\t};\r\n\r\n\tfunction WireframeHelper( object, hex ) {\r\n\r\n\t\tconsole.warn( 'THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead.' );\r\n\t\treturn new LineSegments( new WireframeGeometry( object.geometry ), new LineBasicMaterial( { color: hex !== undefined ? hex : 0xffffff } ) );\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tObject.assign( Loader.prototype, {\r\n\r\n\t\textractUrlBase: function ( url ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead.' );\r\n\t\t\treturn LoaderUtils.extractUrlBase( url );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tfunction XHRLoader( manager ) {\r\n\r\n\t\tconsole.warn( 'THREE.XHRLoader has been renamed to THREE.FileLoader.' );\r\n\t\treturn new FileLoader( manager );\r\n\r\n\t}\r\n\r\n\tfunction BinaryTextureLoader( manager ) {\r\n\r\n\t\tconsole.warn( 'THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader.' );\r\n\t\treturn new DataTextureLoader( manager );\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tObject.assign( Box2.prototype, {\r\n\r\n\t\tcenter: function ( optionalTarget ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Box2: .center() has been renamed to .getCenter().' );\r\n\t\t\treturn this.getCenter( optionalTarget );\r\n\r\n\t\t},\r\n\t\tempty: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.Box2: .empty() has been renamed to .isEmpty().' );\r\n\t\t\treturn this.isEmpty();\r\n\r\n\t\t},\r\n\t\tisIntersectionBox: function ( box ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox().' );\r\n\t\t\treturn this.intersectsBox( box );\r\n\r\n\t\t},\r\n\t\tsize: function ( optionalTarget ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Box2: .size() has been renamed to .getSize().' );\r\n\t\t\treturn this.getSize( optionalTarget );\r\n\r\n\t\t}\r\n\t} );\r\n\r\n\tObject.assign( Box3.prototype, {\r\n\r\n\t\tcenter: function ( optionalTarget ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Box3: .center() has been renamed to .getCenter().' );\r\n\t\t\treturn this.getCenter( optionalTarget );\r\n\r\n\t\t},\r\n\t\tempty: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.Box3: .empty() has been renamed to .isEmpty().' );\r\n\t\t\treturn this.isEmpty();\r\n\r\n\t\t},\r\n\t\tisIntersectionBox: function ( box ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox().' );\r\n\t\t\treturn this.intersectsBox( box );\r\n\r\n\t\t},\r\n\t\tisIntersectionSphere: function ( sphere ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere().' );\r\n\t\t\treturn this.intersectsSphere( sphere );\r\n\r\n\t\t},\r\n\t\tsize: function ( optionalTarget ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Box3: .size() has been renamed to .getSize().' );\r\n\t\t\treturn this.getSize( optionalTarget );\r\n\r\n\t\t}\r\n\t} );\r\n\r\n\tLine3.prototype.center = function ( optionalTarget ) {\r\n\r\n\t\tconsole.warn( 'THREE.Line3: .center() has been renamed to .getCenter().' );\r\n\t\treturn this.getCenter( optionalTarget );\r\n\r\n\t};\r\n\r\n\tObject.assign( _Math, {\r\n\r\n\t\trandom16: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.Math: .random16() has been deprecated. Use Math.random() instead.' );\r\n\t\t\treturn Math.random();\r\n\r\n\t\t},\r\n\r\n\t\tnearestPowerOfTwo: function ( value ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo().' );\r\n\t\t\treturn _Math.floorPowerOfTwo( value );\r\n\r\n\t\t},\r\n\r\n\t\tnextPowerOfTwo: function ( value ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo().' );\r\n\t\t\treturn _Math.ceilPowerOfTwo( value );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( Matrix3.prototype, {\r\n\r\n\t\tflattenToArrayOffset: function ( array, offset ) {\r\n\r\n\t\t\tconsole.warn( \"THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead.\" );\r\n\t\t\treturn this.toArray( array, offset );\r\n\r\n\t\t},\r\n\t\tmultiplyVector3: function ( vector ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.' );\r\n\t\t\treturn vector.applyMatrix3( this );\r\n\r\n\t\t},\r\n\t\tmultiplyVector3Array: function ( /* a */ ) {\r\n\r\n\t\t\tconsole.error( 'THREE.Matrix3: .multiplyVector3Array() has been removed.' );\r\n\r\n\t\t},\r\n\t\tapplyToBuffer: function ( buffer /*, offset, length */ ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead.' );\r\n\t\t\treturn this.applyToBufferAttribute( buffer );\r\n\r\n\t\t},\r\n\t\tapplyToVector3Array: function ( /* array, offset, length */ ) {\r\n\r\n\t\t\tconsole.error( 'THREE.Matrix3: .applyToVector3Array() has been removed.' );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( Matrix4.prototype, {\r\n\r\n\t\textractPosition: function ( m ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .extractPosition() has been renamed to .copyPosition().' );\r\n\t\t\treturn this.copyPosition( m );\r\n\r\n\t\t},\r\n\t\tflattenToArrayOffset: function ( array, offset ) {\r\n\r\n\t\t\tconsole.warn( \"THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead.\" );\r\n\t\t\treturn this.toArray( array, offset );\r\n\r\n\t\t},\r\n\t\tgetPosition: function () {\r\n\r\n\t\t\tvar v1;\r\n\r\n\t\t\treturn function getPosition() {\r\n\r\n\t\t\t\tif ( v1 === undefined ) v1 = new Vector3();\r\n\t\t\t\tconsole.warn( 'THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.' );\r\n\t\t\t\treturn v1.setFromMatrixColumn( this, 3 );\r\n\r\n\t\t\t};\r\n\r\n\t\t}(),\r\n\t\tsetRotationFromQuaternion: function ( q ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().' );\r\n\t\t\treturn this.makeRotationFromQuaternion( q );\r\n\r\n\t\t},\r\n\t\tmultiplyToArray: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .multiplyToArray() has been removed.' );\r\n\r\n\t\t},\r\n\t\tmultiplyVector3: function ( vector ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead.' );\r\n\t\t\treturn vector.applyMatrix4( this );\r\n\r\n\t\t},\r\n\t\tmultiplyVector4: function ( vector ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.' );\r\n\t\t\treturn vector.applyMatrix4( this );\r\n\r\n\t\t},\r\n\t\tmultiplyVector3Array: function ( /* a */ ) {\r\n\r\n\t\t\tconsole.error( 'THREE.Matrix4: .multiplyVector3Array() has been removed.' );\r\n\r\n\t\t},\r\n\t\trotateAxis: function ( v ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.' );\r\n\t\t\tv.transformDirection( this );\r\n\r\n\t\t},\r\n\t\tcrossVector: function ( vector ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.' );\r\n\t\t\treturn vector.applyMatrix4( this );\r\n\r\n\t\t},\r\n\t\ttranslate: function () {\r\n\r\n\t\t\tconsole.error( 'THREE.Matrix4: .translate() has been removed.' );\r\n\r\n\t\t},\r\n\t\trotateX: function () {\r\n\r\n\t\t\tconsole.error( 'THREE.Matrix4: .rotateX() has been removed.' );\r\n\r\n\t\t},\r\n\t\trotateY: function () {\r\n\r\n\t\t\tconsole.error( 'THREE.Matrix4: .rotateY() has been removed.' );\r\n\r\n\t\t},\r\n\t\trotateZ: function () {\r\n\r\n\t\t\tconsole.error( 'THREE.Matrix4: .rotateZ() has been removed.' );\r\n\r\n\t\t},\r\n\t\trotateByAxis: function () {\r\n\r\n\t\t\tconsole.error( 'THREE.Matrix4: .rotateByAxis() has been removed.' );\r\n\r\n\t\t},\r\n\t\tapplyToBuffer: function ( buffer /*, offset, length */ ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead.' );\r\n\t\t\treturn this.applyToBufferAttribute( buffer );\r\n\r\n\t\t},\r\n\t\tapplyToVector3Array: function ( /* array, offset, length */ ) {\r\n\r\n\t\t\tconsole.error( 'THREE.Matrix4: .applyToVector3Array() has been removed.' );\r\n\r\n\t\t},\r\n\t\tmakeFrustum: function ( left, right, bottom, top, near, far ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead.' );\r\n\t\t\treturn this.makePerspective( left, right, top, bottom, near, far );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tPlane.prototype.isIntersectionLine = function ( line ) {\r\n\r\n\t\tconsole.warn( 'THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine().' );\r\n\t\treturn this.intersectsLine( line );\r\n\r\n\t};\r\n\r\n\tQuaternion.prototype.multiplyVector3 = function ( vector ) {\r\n\r\n\t\tconsole.warn( 'THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.' );\r\n\t\treturn vector.applyQuaternion( this );\r\n\r\n\t};\r\n\r\n\tObject.assign( Ray.prototype, {\r\n\r\n\t\tisIntersectionBox: function ( box ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox().' );\r\n\t\t\treturn this.intersectsBox( box );\r\n\r\n\t\t},\r\n\t\tisIntersectionPlane: function ( plane ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane().' );\r\n\t\t\treturn this.intersectsPlane( plane );\r\n\r\n\t\t},\r\n\t\tisIntersectionSphere: function ( sphere ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere().' );\r\n\t\t\treturn this.intersectsSphere( sphere );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( Triangle.prototype, {\r\n\r\n\t\tarea: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.Triangle: .area() has been renamed to .getArea().' );\r\n\t\t\treturn this.getArea();\r\n\r\n\t\t},\r\n\t\tbarycoordFromPoint: function ( point, target ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord().' );\r\n\t\t\treturn this.getBarycoord( point, target );\r\n\r\n\t\t},\r\n\t\tmidpoint: function ( target ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Triangle: .midpoint() has been renamed to .getMidpoint().' );\r\n\t\t\treturn this.getMidpoint( target );\r\n\r\n\t\t},\r\n\t\tnormal: function ( target ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Triangle: .normal() has been renamed to .getNormal().' );\r\n\t\t\treturn this.getNormal( target );\r\n\r\n\t\t},\r\n\t\tplane: function ( target ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Triangle: .plane() has been renamed to .getPlane().' );\r\n\t\t\treturn this.getPlane( target );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( Triangle, {\r\n\r\n\t\tbarycoordFromPoint: function ( point, a, b, c, target ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord().' );\r\n\t\t\treturn Triangle.getBarycoord( point, a, b, c, target );\r\n\r\n\t\t},\r\n\t\tnormal: function ( a, b, c, target ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Triangle: .normal() has been renamed to .getNormal().' );\r\n\t\t\treturn Triangle.getNormal( a, b, c, target );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( Shape.prototype, {\r\n\r\n\t\textractAllPoints: function ( divisions ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead.' );\r\n\t\t\treturn this.extractPoints( divisions );\r\n\r\n\t\t},\r\n\t\textrude: function ( options ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead.' );\r\n\t\t\treturn new ExtrudeGeometry( this, options );\r\n\r\n\t\t},\r\n\t\tmakeGeometry: function ( options ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead.' );\r\n\t\t\treturn new ShapeGeometry( this, options );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( Vector2.prototype, {\r\n\r\n\t\tfromAttribute: function ( attribute, index, offset ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute().' );\r\n\t\t\treturn this.fromBufferAttribute( attribute, index, offset );\r\n\r\n\t\t},\r\n\t\tdistanceToManhattan: function ( v ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo().' );\r\n\t\t\treturn this.manhattanDistanceTo( v );\r\n\r\n\t\t},\r\n\t\tlengthManhattan: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength().' );\r\n\t\t\treturn this.manhattanLength();\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( Vector3.prototype, {\r\n\r\n\t\tsetEulerFromRotationMatrix: function () {\r\n\r\n\t\t\tconsole.error( 'THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.' );\r\n\r\n\t\t},\r\n\t\tsetEulerFromQuaternion: function () {\r\n\r\n\t\t\tconsole.error( 'THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.' );\r\n\r\n\t\t},\r\n\t\tgetPositionFromMatrix: function ( m ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().' );\r\n\t\t\treturn this.setFromMatrixPosition( m );\r\n\r\n\t\t},\r\n\t\tgetScaleFromMatrix: function ( m ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().' );\r\n\t\t\treturn this.setFromMatrixScale( m );\r\n\r\n\t\t},\r\n\t\tgetColumnFromMatrix: function ( index, matrix ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().' );\r\n\t\t\treturn this.setFromMatrixColumn( matrix, index );\r\n\r\n\t\t},\r\n\t\tapplyProjection: function ( m ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead.' );\r\n\t\t\treturn this.applyMatrix4( m );\r\n\r\n\t\t},\r\n\t\tfromAttribute: function ( attribute, index, offset ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute().' );\r\n\t\t\treturn this.fromBufferAttribute( attribute, index, offset );\r\n\r\n\t\t},\r\n\t\tdistanceToManhattan: function ( v ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo().' );\r\n\t\t\treturn this.manhattanDistanceTo( v );\r\n\r\n\t\t},\r\n\t\tlengthManhattan: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength().' );\r\n\t\t\treturn this.manhattanLength();\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( Vector4.prototype, {\r\n\r\n\t\tfromAttribute: function ( attribute, index, offset ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute().' );\r\n\t\t\treturn this.fromBufferAttribute( attribute, index, offset );\r\n\r\n\t\t},\r\n\t\tlengthManhattan: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength().' );\r\n\t\t\treturn this.manhattanLength();\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t//\r\n\r\n\tObject.assign( Geometry.prototype, {\r\n\r\n\t\tcomputeTangents: function () {\r\n\r\n\t\t\tconsole.error( 'THREE.Geometry: .computeTangents() has been removed.' );\r\n\r\n\t\t},\r\n\t\tcomputeLineDistances: function () {\r\n\r\n\t\t\tconsole.error( 'THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.' );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( Object3D.prototype, {\r\n\r\n\t\tgetChildByName: function ( name ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Object3D: .getChildByName() has been renamed to .getObjectByName().' );\r\n\t\t\treturn this.getObjectByName( name );\r\n\r\n\t\t},\r\n\t\trenderDepth: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.' );\r\n\r\n\t\t},\r\n\t\ttranslate: function ( distance, axis ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.' );\r\n\t\t\treturn this.translateOnAxis( axis, distance );\r\n\r\n\t\t},\r\n\t\tgetWorldRotation: function () {\r\n\r\n\t\t\tconsole.error( 'THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.' );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.defineProperties( Object3D.prototype, {\r\n\r\n\t\teulerOrder: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Object3D: .eulerOrder is now .rotation.order.' );\r\n\t\t\t\treturn this.rotation.order;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Object3D: .eulerOrder is now .rotation.order.' );\r\n\t\t\t\tthis.rotation.order = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tuseQuaternion: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.' );\r\n\r\n\t\t\t},\r\n\t\t\tset: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.' );\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.defineProperties( LOD.prototype, {\r\n\r\n\t\tobjects: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.LOD: .objects has been renamed to .levels.' );\r\n\t\t\t\treturn this.levels;\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.defineProperty( Skeleton.prototype, 'useVertexTexture', {\r\n\r\n\t\tget: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.Skeleton: useVertexTexture has been removed.' );\r\n\r\n\t\t},\r\n\t\tset: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.Skeleton: useVertexTexture has been removed.' );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.defineProperty( Curve.prototype, '__arcLengthDivisions', {\r\n\r\n\t\tget: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions.' );\r\n\t\t\treturn this.arcLengthDivisions;\r\n\r\n\t\t},\r\n\t\tset: function ( value ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions.' );\r\n\t\t\tthis.arcLengthDivisions = value;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t//\r\n\r\n\tPerspectiveCamera.prototype.setLens = function ( focalLength, filmGauge ) {\r\n\r\n\t\tconsole.warn( \"THREE.PerspectiveCamera.setLens is deprecated. \" +\r\n\t\t\t\t\"Use .setFocalLength and .filmGauge for a photographic setup.\" );\r\n\r\n\t\tif ( filmGauge !== undefined ) this.filmGauge = filmGauge;\r\n\t\tthis.setFocalLength( focalLength );\r\n\r\n\t};\r\n\r\n\t//\r\n\r\n\tObject.defineProperties( Light.prototype, {\r\n\t\tonlyShadow: {\r\n\t\t\tset: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Light: .onlyShadow has been removed.' );\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowCameraFov: {\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Light: .shadowCameraFov is now .shadow.camera.fov.' );\r\n\t\t\t\tthis.shadow.camera.fov = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowCameraLeft: {\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Light: .shadowCameraLeft is now .shadow.camera.left.' );\r\n\t\t\t\tthis.shadow.camera.left = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowCameraRight: {\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Light: .shadowCameraRight is now .shadow.camera.right.' );\r\n\t\t\t\tthis.shadow.camera.right = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowCameraTop: {\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Light: .shadowCameraTop is now .shadow.camera.top.' );\r\n\t\t\t\tthis.shadow.camera.top = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowCameraBottom: {\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom.' );\r\n\t\t\t\tthis.shadow.camera.bottom = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowCameraNear: {\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Light: .shadowCameraNear is now .shadow.camera.near.' );\r\n\t\t\t\tthis.shadow.camera.near = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowCameraFar: {\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Light: .shadowCameraFar is now .shadow.camera.far.' );\r\n\t\t\t\tthis.shadow.camera.far = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowCameraVisible: {\r\n\t\t\tset: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.' );\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowBias: {\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Light: .shadowBias is now .shadow.bias.' );\r\n\t\t\t\tthis.shadow.bias = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowDarkness: {\r\n\t\t\tset: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Light: .shadowDarkness has been removed.' );\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowMapWidth: {\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Light: .shadowMapWidth is now .shadow.mapSize.width.' );\r\n\t\t\t\tthis.shadow.mapSize.width = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowMapHeight: {\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Light: .shadowMapHeight is now .shadow.mapSize.height.' );\r\n\t\t\t\tthis.shadow.mapSize.height = value;\r\n\r\n\t\t\t}\r\n\t\t}\r\n\t} );\r\n\r\n\t//\r\n\r\n\tObject.defineProperties( BufferAttribute.prototype, {\r\n\r\n\t\tlength: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.BufferAttribute: .length has been deprecated. Use .count instead.' );\r\n\t\t\t\treturn this.array.length;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tcopyIndicesArray: function ( /* indices */ ) {\r\n\r\n\t\t\tconsole.error( 'THREE.BufferAttribute: .copyIndicesArray() has been removed.' );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( BufferGeometry.prototype, {\r\n\r\n\t\taddIndex: function ( index ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .addIndex() has been renamed to .setIndex().' );\r\n\t\t\tthis.setIndex( index );\r\n\r\n\t\t},\r\n\t\taddDrawCall: function ( start, count, indexOffset ) {\r\n\r\n\t\t\tif ( indexOffset !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset.' );\r\n\r\n\t\t\t}\r\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .addDrawCall() is now .addGroup().' );\r\n\t\t\tthis.addGroup( start, count );\r\n\r\n\t\t},\r\n\t\tclearDrawCalls: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups().' );\r\n\t\t\tthis.clearGroups();\r\n\r\n\t\t},\r\n\t\tcomputeTangents: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .computeTangents() has been removed.' );\r\n\r\n\t\t},\r\n\t\tcomputeOffsets: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .computeOffsets() has been removed.' );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.defineProperties( BufferGeometry.prototype, {\r\n\r\n\t\tdrawcalls: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.error( 'THREE.BufferGeometry: .drawcalls has been renamed to .groups.' );\r\n\t\t\t\treturn this.groups;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\toffsets: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.BufferGeometry: .offsets has been renamed to .groups.' );\r\n\t\t\t\treturn this.groups;\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t//\r\n\r\n\tObject.assign( ExtrudeBufferGeometry.prototype, {\r\n\r\n\t\tgetArrays: function () {\r\n\r\n\t\t\tconsole.error( 'THREE.ExtrudeBufferGeometry: .getArrays() has been removed.' );\r\n\r\n\t\t},\r\n\r\n\t\taddShapeList: function () {\r\n\r\n\t\t\tconsole.error( 'THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.' );\r\n\r\n\t\t},\r\n\r\n\t\taddShape: function () {\r\n\r\n\t\t\tconsole.error( 'THREE.ExtrudeBufferGeometry: .addShape() has been removed.' );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t//\r\n\r\n\tObject.defineProperties( Uniform.prototype, {\r\n\r\n\t\tdynamic: {\r\n\t\t\tset: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.' );\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tonUpdate: {\r\n\t\t\tvalue: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead.' );\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t//\r\n\r\n\tObject.defineProperties( Material.prototype, {\r\n\r\n\t\twrapAround: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Material: .wrapAround has been removed.' );\r\n\r\n\t\t\t},\r\n\t\t\tset: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Material: .wrapAround has been removed.' );\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\twrapRGB: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Material: .wrapRGB has been removed.' );\r\n\t\t\t\treturn new Color();\r\n\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tshading: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.error( 'THREE.' + this.type + ': .shading has been removed. Use the boolean .flatShading instead.' );\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.' + this.type + ': .shading has been removed. Use the boolean .flatShading instead.' );\r\n\t\t\t\tthis.flatShading = ( value === FlatShading );\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.defineProperties( MeshPhongMaterial.prototype, {\r\n\r\n\t\tmetal: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead.' );\r\n\t\t\t\treturn false;\r\n\r\n\t\t\t},\r\n\t\t\tset: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead' );\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.defineProperties( ShaderMaterial.prototype, {\r\n\r\n\t\tderivatives: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives.' );\r\n\t\t\t\treturn this.extensions.derivatives;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives.' );\r\n\t\t\t\tthis.extensions.derivatives = value;\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t//\r\n\r\n\tObject.assign( WebGLRenderer.prototype, {\r\n\r\n\t\tanimate: function ( callback ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .animate() is now .setAnimationLoop().' );\r\n\t\t\tthis.setAnimationLoop( callback );\r\n\r\n\t\t},\r\n\r\n\t\tgetCurrentRenderTarget: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget().' );\r\n\t\t\treturn this.getRenderTarget();\r\n\r\n\t\t},\r\n\r\n\t\tgetMaxAnisotropy: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy().' );\r\n\t\t\treturn this.capabilities.getMaxAnisotropy();\r\n\r\n\t\t},\r\n\r\n\t\tgetPrecision: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision.' );\r\n\t\t\treturn this.capabilities.precision;\r\n\r\n\t\t},\r\n\r\n\t\tresetGLState: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .resetGLState() is now .state.reset().' );\r\n\t\t\treturn this.state.reset();\r\n\r\n\t\t},\r\n\r\n\t\tsupportsFloatTextures: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( \\'OES_texture_float\\' ).' );\r\n\t\t\treturn this.extensions.get( 'OES_texture_float' );\r\n\r\n\t\t},\r\n\t\tsupportsHalfFloatTextures: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( \\'OES_texture_half_float\\' ).' );\r\n\t\t\treturn this.extensions.get( 'OES_texture_half_float' );\r\n\r\n\t\t},\r\n\t\tsupportsStandardDerivatives: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( \\'OES_standard_derivatives\\' ).' );\r\n\t\t\treturn this.extensions.get( 'OES_standard_derivatives' );\r\n\r\n\t\t},\r\n\t\tsupportsCompressedTextureS3TC: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( \\'WEBGL_compressed_texture_s3tc\\' ).' );\r\n\t\t\treturn this.extensions.get( 'WEBGL_compressed_texture_s3tc' );\r\n\r\n\t\t},\r\n\t\tsupportsCompressedTexturePVRTC: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( \\'WEBGL_compressed_texture_pvrtc\\' ).' );\r\n\t\t\treturn this.extensions.get( 'WEBGL_compressed_texture_pvrtc' );\r\n\r\n\t\t},\r\n\t\tsupportsBlendMinMax: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( \\'EXT_blend_minmax\\' ).' );\r\n\t\t\treturn this.extensions.get( 'EXT_blend_minmax' );\r\n\r\n\t\t},\r\n\t\tsupportsVertexTextures: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures.' );\r\n\t\t\treturn this.capabilities.vertexTextures;\r\n\r\n\t\t},\r\n\t\tsupportsInstancedArrays: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( \\'ANGLE_instanced_arrays\\' ).' );\r\n\t\t\treturn this.extensions.get( 'ANGLE_instanced_arrays' );\r\n\r\n\t\t},\r\n\t\tenableScissorTest: function ( boolean ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest().' );\r\n\t\t\tthis.setScissorTest( boolean );\r\n\r\n\t\t},\r\n\t\tinitMaterial: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .initMaterial() has been removed.' );\r\n\r\n\t\t},\r\n\t\taddPrePlugin: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .addPrePlugin() has been removed.' );\r\n\r\n\t\t},\r\n\t\taddPostPlugin: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .addPostPlugin() has been removed.' );\r\n\r\n\t\t},\r\n\t\tupdateShadowMap: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .updateShadowMap() has been removed.' );\r\n\r\n\t\t},\r\n\t\tsetFaceCulling: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .setFaceCulling() has been removed.' );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.defineProperties( WebGLRenderer.prototype, {\r\n\r\n\t\tshadowMapEnabled: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\treturn this.shadowMap.enabled;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled.' );\r\n\t\t\t\tthis.shadowMap.enabled = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowMapType: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\treturn this.shadowMap.type;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type.' );\r\n\t\t\t\tthis.shadowMap.type = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowMapCullFace: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.' );\r\n\t\t\t\treturn undefined;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( /* value */ ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.' );\r\n\r\n\t\t\t}\r\n\t\t}\r\n\t} );\r\n\r\n\tObject.defineProperties( WebGLShadowMap.prototype, {\r\n\r\n\t\tcullFace: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.' );\r\n\t\t\t\treturn undefined;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( /* cullFace */ ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.' );\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\trenderReverseSided: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.' );\r\n\t\t\t\treturn undefined;\r\n\r\n\t\t\t},\r\n\t\t\tset: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.' );\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\trenderSingleSided: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.' );\r\n\t\t\t\treturn undefined;\r\n\r\n\t\t\t},\r\n\t\t\tset: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.' );\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t//\r\n\r\n\tObject.defineProperties( WebGLRenderTarget.prototype, {\r\n\r\n\t\twrapS: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.' );\r\n\t\t\t\treturn this.texture.wrapS;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.' );\r\n\t\t\t\tthis.texture.wrapS = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\twrapT: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.' );\r\n\t\t\t\treturn this.texture.wrapT;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.' );\r\n\t\t\t\tthis.texture.wrapT = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tmagFilter: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.' );\r\n\t\t\t\treturn this.texture.magFilter;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.' );\r\n\t\t\t\tthis.texture.magFilter = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tminFilter: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.' );\r\n\t\t\t\treturn this.texture.minFilter;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.' );\r\n\t\t\t\tthis.texture.minFilter = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tanisotropy: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.' );\r\n\t\t\t\treturn this.texture.anisotropy;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.' );\r\n\t\t\t\tthis.texture.anisotropy = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\toffset: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .offset is now .texture.offset.' );\r\n\t\t\t\treturn this.texture.offset;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .offset is now .texture.offset.' );\r\n\t\t\t\tthis.texture.offset = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\trepeat: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .repeat is now .texture.repeat.' );\r\n\t\t\t\treturn this.texture.repeat;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .repeat is now .texture.repeat.' );\r\n\t\t\t\tthis.texture.repeat = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tformat: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .format is now .texture.format.' );\r\n\t\t\t\treturn this.texture.format;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .format is now .texture.format.' );\r\n\t\t\t\tthis.texture.format = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\ttype: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .type is now .texture.type.' );\r\n\t\t\t\treturn this.texture.type;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .type is now .texture.type.' );\r\n\t\t\t\tthis.texture.type = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tgenerateMipmaps: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.' );\r\n\t\t\t\treturn this.texture.generateMipmaps;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.' );\r\n\t\t\t\tthis.texture.generateMipmaps = value;\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t//\r\n\r\n\tObject.defineProperties( WebVRManager.prototype, {\r\n\r\n\t\tstanding: {\r\n\t\t\tset: function ( /* value */ ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebVRManager: .standing has been removed.' );\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t//\r\n\r\n\tAudio.prototype.load = function ( file ) {\r\n\r\n\t\tconsole.warn( 'THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.' );\r\n\t\tvar scope = this;\r\n\t\tvar audioLoader = new AudioLoader();\r\n\t\taudioLoader.load( file, function ( buffer ) {\r\n\r\n\t\t\tscope.setBuffer( buffer );\r\n\r\n\t\t} );\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tAudioAnalyser.prototype.getData = function () {\r\n\r\n\t\tconsole.warn( 'THREE.AudioAnalyser: .getData() is now .getFrequencyData().' );\r\n\t\treturn this.getFrequencyData();\r\n\r\n\t};\r\n\r\n\t//\r\n\r\n\tCubeCamera.prototype.updateCubeMap = function ( renderer, scene ) {\r\n\r\n\t\tconsole.warn( 'THREE.CubeCamera: .updateCubeMap() is now .update().' );\r\n\t\treturn this.update( renderer, scene );\r\n\r\n\t};\r\n\r\n\t//\r\n\r\n\tvar GeometryUtils = {\r\n\r\n\t\tmerge: function ( geometry1, geometry2, materialIndexOffset ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.' );\r\n\t\t\tvar matrix;\r\n\r\n\t\t\tif ( geometry2.isMesh ) {\r\n\r\n\t\t\t\tgeometry2.matrixAutoUpdate && geometry2.updateMatrix();\r\n\r\n\t\t\t\tmatrix = geometry2.matrix;\r\n\t\t\t\tgeometry2 = geometry2.geometry;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry1.merge( geometry2, matrix, materialIndexOffset );\r\n\r\n\t\t},\r\n\r\n\t\tcenter: function ( geometry ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead.' );\r\n\t\t\treturn geometry.center();\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tImageUtils.crossOrigin = undefined;\r\n\r\n\tImageUtils.loadTexture = function ( url, mapping, onLoad, onError ) {\r\n\r\n\t\tconsole.warn( 'THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.' );\r\n\r\n\t\tvar loader = new TextureLoader();\r\n\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\r\n\t\tvar texture = loader.load( url, onLoad, undefined, onError );\r\n\r\n\t\tif ( mapping ) texture.mapping = mapping;\r\n\r\n\t\treturn texture;\r\n\r\n\t};\r\n\r\n\tImageUtils.loadTextureCube = function ( urls, mapping, onLoad, onError ) {\r\n\r\n\t\tconsole.warn( 'THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.' );\r\n\r\n\t\tvar loader = new CubeTextureLoader();\r\n\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\r\n\t\tvar texture = loader.load( urls, onLoad, undefined, onError );\r\n\r\n\t\tif ( mapping ) texture.mapping = mapping;\r\n\r\n\t\treturn texture;\r\n\r\n\t};\r\n\r\n\tImageUtils.loadCompressedTexture = function () {\r\n\r\n\t\tconsole.error( 'THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.' );\r\n\r\n\t};\r\n\r\n\tImageUtils.loadCompressedTextureCube = function () {\r\n\r\n\t\tconsole.error( 'THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.' );\r\n\r\n\t};\r\n\r\n\t//\r\n\r\n\tfunction Projector() {\r\n\r\n\t\tconsole.error( 'THREE.Projector has been moved to /examples/js/renderers/Projector.js.' );\r\n\r\n\t\tthis.projectVector = function ( vector, camera ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Projector: .projectVector() is now vector.project().' );\r\n\t\t\tvector.project( camera );\r\n\r\n\t\t};\r\n\r\n\t\tthis.unprojectVector = function ( vector, camera ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Projector: .unprojectVector() is now vector.unproject().' );\r\n\t\t\tvector.unproject( camera );\r\n\r\n\t\t};\r\n\r\n\t\tthis.pickingRay = function () {\r\n\r\n\t\t\tconsole.error( 'THREE.Projector: .pickingRay() is now raycaster.setFromCamera().' );\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tfunction CanvasRenderer() {\r\n\r\n\t\tconsole.error( 'THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js' );\r\n\r\n\t\tthis.domElement = document.createElementNS( 'http://www.w3.org/1999/xhtml', 'canvas' );\r\n\t\tthis.clear = function () {};\r\n\t\tthis.render = function () {};\r\n\t\tthis.setClearColor = function () {};\r\n\t\tthis.setSize = function () {};\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tvar SceneUtils = {\r\n\r\n\t\tcreateMultiMaterialObject: function ( /* geometry, materials */ ) {\r\n\r\n\t\t\tconsole.error( 'THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js' );\r\n\r\n\t\t},\r\n\r\n\t\tdetach: function ( /* child, parent, scene */ ) {\r\n\r\n\t\t\tconsole.error( 'THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js' );\r\n\r\n\t\t},\r\n\r\n\t\tattach: function ( /* child, scene, parent */ ) {\r\n\r\n\t\t\tconsole.error( 'THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js' );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t//\r\n\r\n\tfunction LensFlare() {\r\n\r\n\t\tconsole.error( 'THREE.LensFlare has been moved to /examples/js/objects/Lensflare.js' );\r\n\r\n\t}\r\n\r\n\tvar exports = {};\r\n\texports.WebGLRenderTargetCube = WebGLRenderTargetCube;\r\n\texports.WebGLRenderTarget = WebGLRenderTarget;\r\n\texports.WebGLRenderer = WebGLRenderer;\r\n\texports.ShaderLib = ShaderLib;\r\n\texports.UniformsLib = UniformsLib;\r\n\texports.UniformsUtils = UniformsUtils;\r\n\texports.ShaderChunk = ShaderChunk;\r\n\texports.FogExp2 = FogExp2;\r\n\texports.Fog = Fog;\r\n\texports.Scene = Scene;\r\n\texports.Sprite = Sprite;\r\n\texports.LOD = LOD;\r\n\texports.SkinnedMesh = SkinnedMesh;\r\n\texports.Skeleton = Skeleton;\r\n\texports.Bone = Bone;\r\n\texports.Mesh = Mesh;\r\n\texports.LineSegments = LineSegments;\r\n\texports.LineLoop = LineLoop;\r\n\texports.Line = Line;\r\n\texports.Points = Points;\r\n\texports.Group = Group;\r\n\texports.VideoTexture = VideoTexture;\r\n\texports.DataTexture = DataTexture;\r\n\texports.CompressedTexture = CompressedTexture;\r\n\texports.CubeTexture = CubeTexture;\r\n\texports.CanvasTexture = CanvasTexture;\r\n\texports.DepthTexture = DepthTexture;\r\n\texports.Texture = Texture;\r\n\texports.CompressedTextureLoader = CompressedTextureLoader;\r\n\texports.DataTextureLoader = DataTextureLoader;\r\n\texports.CubeTextureLoader = CubeTextureLoader;\r\n\texports.TextureLoader = TextureLoader;\r\n\texports.ObjectLoader = ObjectLoader;\r\n\texports.MaterialLoader = MaterialLoader;\r\n\texports.BufferGeometryLoader = BufferGeometryLoader;\r\n\texports.DefaultLoadingManager = DefaultLoadingManager;\r\n\texports.LoadingManager = LoadingManager;\r\n\texports.JSONLoader = JSONLoader;\r\n\texports.ImageLoader = ImageLoader;\r\n\texports.ImageBitmapLoader = ImageBitmapLoader;\r\n\texports.FontLoader = FontLoader;\r\n\texports.FileLoader = FileLoader;\r\n\texports.Loader = Loader;\r\n\texports.LoaderUtils = LoaderUtils;\r\n\texports.Cache = Cache;\r\n\texports.AudioLoader = AudioLoader;\r\n\texports.SpotLightShadow = SpotLightShadow;\r\n\texports.SpotLight = SpotLight;\r\n\texports.PointLight = PointLight;\r\n\texports.RectAreaLight = RectAreaLight;\r\n\texports.HemisphereLight = HemisphereLight;\r\n\texports.DirectionalLightShadow = DirectionalLightShadow;\r\n\texports.DirectionalLight = DirectionalLight;\r\n\texports.AmbientLight = AmbientLight;\r\n\texports.LightShadow = LightShadow;\r\n\texports.Light = Light;\r\n\texports.StereoCamera = StereoCamera;\r\n\texports.PerspectiveCamera = PerspectiveCamera;\r\n\texports.OrthographicCamera = OrthographicCamera;\r\n\texports.CubeCamera = CubeCamera;\r\n\texports.ArrayCamera = ArrayCamera;\r\n\texports.Camera = Camera;\r\n\texports.AudioListener = AudioListener;\r\n\texports.PositionalAudio = PositionalAudio;\r\n\texports.AudioContext = AudioContext;\r\n\texports.AudioAnalyser = AudioAnalyser;\r\n\texports.Audio = Audio;\r\n\texports.VectorKeyframeTrack = VectorKeyframeTrack;\r\n\texports.StringKeyframeTrack = StringKeyframeTrack;\r\n\texports.QuaternionKeyframeTrack = QuaternionKeyframeTrack;\r\n\texports.NumberKeyframeTrack = NumberKeyframeTrack;\r\n\texports.ColorKeyframeTrack = ColorKeyframeTrack;\r\n\texports.BooleanKeyframeTrack = BooleanKeyframeTrack;\r\n\texports.PropertyMixer = PropertyMixer;\r\n\texports.PropertyBinding = PropertyBinding;\r\n\texports.KeyframeTrack = KeyframeTrack;\r\n\texports.AnimationUtils = AnimationUtils;\r\n\texports.AnimationObjectGroup = AnimationObjectGroup;\r\n\texports.AnimationMixer = AnimationMixer;\r\n\texports.AnimationClip = AnimationClip;\r\n\texports.Uniform = Uniform;\r\n\texports.InstancedBufferGeometry = InstancedBufferGeometry;\r\n\texports.BufferGeometry = BufferGeometry;\r\n\texports.Geometry = Geometry;\r\n\texports.InterleavedBufferAttribute = InterleavedBufferAttribute;\r\n\texports.InstancedInterleavedBuffer = InstancedInterleavedBuffer;\r\n\texports.InterleavedBuffer = InterleavedBuffer;\r\n\texports.InstancedBufferAttribute = InstancedBufferAttribute;\r\n\texports.Face3 = Face3;\r\n\texports.Object3D = Object3D;\r\n\texports.Raycaster = Raycaster;\r\n\texports.Layers = Layers;\r\n\texports.EventDispatcher = EventDispatcher;\r\n\texports.Clock = Clock;\r\n\texports.QuaternionLinearInterpolant = QuaternionLinearInterpolant;\r\n\texports.LinearInterpolant = LinearInterpolant;\r\n\texports.DiscreteInterpolant = DiscreteInterpolant;\r\n\texports.CubicInterpolant = CubicInterpolant;\r\n\texports.Interpolant = Interpolant;\r\n\texports.Triangle = Triangle;\r\n\texports.Math = _Math;\r\n\texports.Spherical = Spherical;\r\n\texports.Cylindrical = Cylindrical;\r\n\texports.Plane = Plane;\r\n\texports.Frustum = Frustum;\r\n\texports.Sphere = Sphere;\r\n\texports.Ray = Ray;\r\n\texports.Matrix4 = Matrix4;\r\n\texports.Matrix3 = Matrix3;\r\n\texports.Box3 = Box3;\r\n\texports.Box2 = Box2;\r\n\texports.Line3 = Line3;\r\n\texports.Euler = Euler;\r\n\texports.Vector4 = Vector4;\r\n\texports.Vector3 = Vector3;\r\n\texports.Vector2 = Vector2;\r\n\texports.Quaternion = Quaternion;\r\n\texports.Color = Color;\r\n\texports.ImmediateRenderObject = ImmediateRenderObject;\r\n\texports.VertexNormalsHelper = VertexNormalsHelper;\r\n\texports.SpotLightHelper = SpotLightHelper;\r\n\texports.SkeletonHelper = SkeletonHelper;\r\n\texports.PointLightHelper = PointLightHelper;\r\n\texports.RectAreaLightHelper = RectAreaLightHelper;\r\n\texports.HemisphereLightHelper = HemisphereLightHelper;\r\n\texports.GridHelper = GridHelper;\r\n\texports.PolarGridHelper = PolarGridHelper;\r\n\texports.FaceNormalsHelper = FaceNormalsHelper;\r\n\texports.DirectionalLightHelper = DirectionalLightHelper;\r\n\texports.CameraHelper = CameraHelper;\r\n\texports.BoxHelper = BoxHelper;\r\n\texports.Box3Helper = Box3Helper;\r\n\texports.PlaneHelper = PlaneHelper;\r\n\texports.ArrowHelper = ArrowHelper;\r\n\texports.AxesHelper = AxesHelper;\r\n\texports.Shape = Shape;\r\n\texports.Path = Path;\r\n\texports.ShapePath = ShapePath;\r\n\texports.Font = Font;\r\n\texports.CurvePath = CurvePath;\r\n\texports.Curve = Curve;\r\n\texports.ImageUtils = ImageUtils;\r\n\texports.ShapeUtils = ShapeUtils;\r\n\texports.WebGLUtils = WebGLUtils;\r\n\texports.WireframeGeometry = WireframeGeometry;\r\n\texports.ParametricGeometry = ParametricGeometry;\r\n\texports.ParametricBufferGeometry = ParametricBufferGeometry;\r\n\texports.TetrahedronGeometry = TetrahedronGeometry;\r\n\texports.TetrahedronBufferGeometry = TetrahedronBufferGeometry;\r\n\texports.OctahedronGeometry = OctahedronGeometry;\r\n\texports.OctahedronBufferGeometry = OctahedronBufferGeometry;\r\n\texports.IcosahedronGeometry = IcosahedronGeometry;\r\n\texports.IcosahedronBufferGeometry = IcosahedronBufferGeometry;\r\n\texports.DodecahedronGeometry = DodecahedronGeometry;\r\n\texports.DodecahedronBufferGeometry = DodecahedronBufferGeometry;\r\n\texports.PolyhedronGeometry = PolyhedronGeometry;\r\n\texports.PolyhedronBufferGeometry = PolyhedronBufferGeometry;\r\n\texports.TubeGeometry = TubeGeometry;\r\n\texports.TubeBufferGeometry = TubeBufferGeometry;\r\n\texports.TorusKnotGeometry = TorusKnotGeometry;\r\n\texports.TorusKnotBufferGeometry = TorusKnotBufferGeometry;\r\n\texports.TorusGeometry = TorusGeometry;\r\n\texports.TorusBufferGeometry = TorusBufferGeometry;\r\n\texports.TextGeometry = TextGeometry;\r\n\texports.TextBufferGeometry = TextBufferGeometry;\r\n\texports.SphereGeometry = SphereGeometry;\r\n\texports.SphereBufferGeometry = SphereBufferGeometry;\r\n\texports.RingGeometry = RingGeometry;\r\n\texports.RingBufferGeometry = RingBufferGeometry;\r\n\texports.PlaneGeometry = PlaneGeometry;\r\n\texports.PlaneBufferGeometry = PlaneBufferGeometry;\r\n\texports.LatheGeometry = LatheGeometry;\r\n\texports.LatheBufferGeometry = LatheBufferGeometry;\r\n\texports.ShapeGeometry = ShapeGeometry;\r\n\texports.ShapeBufferGeometry = ShapeBufferGeometry;\r\n\texports.ExtrudeGeometry = ExtrudeGeometry;\r\n\texports.ExtrudeBufferGeometry = ExtrudeBufferGeometry;\r\n\texports.EdgesGeometry = EdgesGeometry;\r\n\texports.ConeGeometry = ConeGeometry;\r\n\texports.ConeBufferGeometry = ConeBufferGeometry;\r\n\texports.CylinderGeometry = CylinderGeometry;\r\n\texports.CylinderBufferGeometry = CylinderBufferGeometry;\r\n\texports.CircleGeometry = CircleGeometry;\r\n\texports.CircleBufferGeometry = CircleBufferGeometry;\r\n\texports.BoxGeometry = BoxGeometry;\r\n\texports.BoxBufferGeometry = BoxBufferGeometry;\r\n\texports.ShadowMaterial = ShadowMaterial;\r\n\texports.SpriteMaterial = SpriteMaterial;\r\n\texports.RawShaderMaterial = RawShaderMaterial;\r\n\texports.ShaderMaterial = ShaderMaterial;\r\n\texports.PointsMaterial = PointsMaterial;\r\n\texports.MeshPhysicalMaterial = MeshPhysicalMaterial;\r\n\texports.MeshStandardMaterial = MeshStandardMaterial;\r\n\texports.MeshPhongMaterial = MeshPhongMaterial;\r\n\texports.MeshToonMaterial = MeshToonMaterial;\r\n\texports.MeshNormalMaterial = MeshNormalMaterial;\r\n\texports.MeshLambertMaterial = MeshLambertMaterial;\r\n\texports.MeshDepthMaterial = MeshDepthMaterial;\r\n\texports.MeshDistanceMaterial = MeshDistanceMaterial;\r\n\texports.MeshBasicMaterial = MeshBasicMaterial;\r\n\texports.LineDashedMaterial = LineDashedMaterial;\r\n\texports.LineBasicMaterial = LineBasicMaterial;\r\n\texports.Material = Material;\r\n\texports.Float64BufferAttribute = Float64BufferAttribute;\r\n\texports.Float32BufferAttribute = Float32BufferAttribute;\r\n\texports.Uint32BufferAttribute = Uint32BufferAttribute;\r\n\texports.Int32BufferAttribute = Int32BufferAttribute;\r\n\texports.Uint16BufferAttribute = Uint16BufferAttribute;\r\n\texports.Int16BufferAttribute = Int16BufferAttribute;\r\n\texports.Uint8ClampedBufferAttribute = Uint8ClampedBufferAttribute;\r\n\texports.Uint8BufferAttribute = Uint8BufferAttribute;\r\n\texports.Int8BufferAttribute = Int8BufferAttribute;\r\n\texports.BufferAttribute = BufferAttribute;\r\n\texports.ArcCurve = ArcCurve;\r\n\texports.CatmullRomCurve3 = CatmullRomCurve3;\r\n\texports.CubicBezierCurve = CubicBezierCurve;\r\n\texports.CubicBezierCurve3 = CubicBezierCurve3;\r\n\texports.EllipseCurve = EllipseCurve;\r\n\texports.LineCurve = LineCurve;\r\n\texports.LineCurve3 = LineCurve3;\r\n\texports.QuadraticBezierCurve = QuadraticBezierCurve;\r\n\texports.QuadraticBezierCurve3 = QuadraticBezierCurve3;\r\n\texports.SplineCurve = SplineCurve;\r\n\texports.REVISION = REVISION;\r\n\texports.MOUSE = MOUSE;\r\n\texports.CullFaceNone = CullFaceNone;\r\n\texports.CullFaceBack = CullFaceBack;\r\n\texports.CullFaceFront = CullFaceFront;\r\n\texports.CullFaceFrontBack = CullFaceFrontBack;\r\n\texports.FrontFaceDirectionCW = FrontFaceDirectionCW;\r\n\texports.FrontFaceDirectionCCW = FrontFaceDirectionCCW;\r\n\texports.BasicShadowMap = BasicShadowMap;\r\n\texports.PCFShadowMap = PCFShadowMap;\r\n\texports.PCFSoftShadowMap = PCFSoftShadowMap;\r\n\texports.FrontSide = FrontSide;\r\n\texports.BackSide = BackSide;\r\n\texports.DoubleSide = DoubleSide;\r\n\texports.FlatShading = FlatShading;\r\n\texports.SmoothShading = SmoothShading;\r\n\texports.NoColors = NoColors;\r\n\texports.FaceColors = FaceColors;\r\n\texports.VertexColors = VertexColors;\r\n\texports.NoBlending = NoBlending;\r\n\texports.NormalBlending = NormalBlending;\r\n\texports.AdditiveBlending = AdditiveBlending;\r\n\texports.SubtractiveBlending = SubtractiveBlending;\r\n\texports.MultiplyBlending = MultiplyBlending;\r\n\texports.CustomBlending = CustomBlending;\r\n\texports.AddEquation = AddEquation;\r\n\texports.SubtractEquation = SubtractEquation;\r\n\texports.ReverseSubtractEquation = ReverseSubtractEquation;\r\n\texports.MinEquation = MinEquation;\r\n\texports.MaxEquation = MaxEquation;\r\n\texports.ZeroFactor = ZeroFactor;\r\n\texports.OneFactor = OneFactor;\r\n\texports.SrcColorFactor = SrcColorFactor;\r\n\texports.OneMinusSrcColorFactor = OneMinusSrcColorFactor;\r\n\texports.SrcAlphaFactor = SrcAlphaFactor;\r\n\texports.OneMinusSrcAlphaFactor = OneMinusSrcAlphaFactor;\r\n\texports.DstAlphaFactor = DstAlphaFactor;\r\n\texports.OneMinusDstAlphaFactor = OneMinusDstAlphaFactor;\r\n\texports.DstColorFactor = DstColorFactor;\r\n\texports.OneMinusDstColorFactor = OneMinusDstColorFactor;\r\n\texports.SrcAlphaSaturateFactor = SrcAlphaSaturateFactor;\r\n\texports.NeverDepth = NeverDepth;\r\n\texports.AlwaysDepth = AlwaysDepth;\r\n\texports.LessDepth = LessDepth;\r\n\texports.LessEqualDepth = LessEqualDepth;\r\n\texports.EqualDepth = EqualDepth;\r\n\texports.GreaterEqualDepth = GreaterEqualDepth;\r\n\texports.GreaterDepth = GreaterDepth;\r\n\texports.NotEqualDepth = NotEqualDepth;\r\n\texports.MultiplyOperation = MultiplyOperation;\r\n\texports.MixOperation = MixOperation;\r\n\texports.AddOperation = AddOperation;\r\n\texports.NoToneMapping = NoToneMapping;\r\n\texports.LinearToneMapping = LinearToneMapping;\r\n\texports.ReinhardToneMapping = ReinhardToneMapping;\r\n\texports.Uncharted2ToneMapping = Uncharted2ToneMapping;\r\n\texports.CineonToneMapping = CineonToneMapping;\r\n\texports.UVMapping = UVMapping;\r\n\texports.CubeReflectionMapping = CubeReflectionMapping;\r\n\texports.CubeRefractionMapping = CubeRefractionMapping;\r\n\texports.EquirectangularReflectionMapping = EquirectangularReflectionMapping;\r\n\texports.EquirectangularRefractionMapping = EquirectangularRefractionMapping;\r\n\texports.SphericalReflectionMapping = SphericalReflectionMapping;\r\n\texports.CubeUVReflectionMapping = CubeUVReflectionMapping;\r\n\texports.CubeUVRefractionMapping = CubeUVRefractionMapping;\r\n\texports.RepeatWrapping = RepeatWrapping;\r\n\texports.ClampToEdgeWrapping = ClampToEdgeWrapping;\r\n\texports.MirroredRepeatWrapping = MirroredRepeatWrapping;\r\n\texports.NearestFilter = NearestFilter;\r\n\texports.NearestMipMapNearestFilter = NearestMipMapNearestFilter;\r\n\texports.NearestMipMapLinearFilter = NearestMipMapLinearFilter;\r\n\texports.LinearFilter = LinearFilter;\r\n\texports.LinearMipMapNearestFilter = LinearMipMapNearestFilter;\r\n\texports.LinearMipMapLinearFilter = LinearMipMapLinearFilter;\r\n\texports.UnsignedByteType = UnsignedByteType;\r\n\texports.ByteType = ByteType;\r\n\texports.ShortType = ShortType;\r\n\texports.UnsignedShortType = UnsignedShortType;\r\n\texports.IntType = IntType;\r\n\texports.UnsignedIntType = UnsignedIntType;\r\n\texports.FloatType = FloatType;\r\n\texports.HalfFloatType = HalfFloatType;\r\n\texports.UnsignedShort4444Type = UnsignedShort4444Type;\r\n\texports.UnsignedShort5551Type = UnsignedShort5551Type;\r\n\texports.UnsignedShort565Type = UnsignedShort565Type;\r\n\texports.UnsignedInt248Type = UnsignedInt248Type;\r\n\texports.AlphaFormat = AlphaFormat;\r\n\texports.RGBFormat = RGBFormat;\r\n\texports.RGBAFormat = RGBAFormat;\r\n\texports.LuminanceFormat = LuminanceFormat;\r\n\texports.LuminanceAlphaFormat = LuminanceAlphaFormat;\r\n\texports.RGBEFormat = RGBEFormat;\r\n\texports.DepthFormat = DepthFormat;\r\n\texports.DepthStencilFormat = DepthStencilFormat;\r\n\texports.RGB_S3TC_DXT1_Format = RGB_S3TC_DXT1_Format;\r\n\texports.RGBA_S3TC_DXT1_Format = RGBA_S3TC_DXT1_Format;\r\n\texports.RGBA_S3TC_DXT3_Format = RGBA_S3TC_DXT3_Format;\r\n\texports.RGBA_S3TC_DXT5_Format = RGBA_S3TC_DXT5_Format;\r\n\texports.RGB_PVRTC_4BPPV1_Format = RGB_PVRTC_4BPPV1_Format;\r\n\texports.RGB_PVRTC_2BPPV1_Format = RGB_PVRTC_2BPPV1_Format;\r\n\texports.RGBA_PVRTC_4BPPV1_Format = RGBA_PVRTC_4BPPV1_Format;\r\n\texports.RGBA_PVRTC_2BPPV1_Format = RGBA_PVRTC_2BPPV1_Format;\r\n\texports.RGB_ETC1_Format = RGB_ETC1_Format;\r\n\texports.RGBA_ASTC_4x4_Format = RGBA_ASTC_4x4_Format;\r\n\texports.RGBA_ASTC_5x4_Format = RGBA_ASTC_5x4_Format;\r\n\texports.RGBA_ASTC_5x5_Format = RGBA_ASTC_5x5_Format;\r\n\texports.RGBA_ASTC_6x5_Format = RGBA_ASTC_6x5_Format;\r\n\texports.RGBA_ASTC_6x6_Format = RGBA_ASTC_6x6_Format;\r\n\texports.RGBA_ASTC_8x5_Format = RGBA_ASTC_8x5_Format;\r\n\texports.RGBA_ASTC_8x6_Format = RGBA_ASTC_8x6_Format;\r\n\texports.RGBA_ASTC_8x8_Format = RGBA_ASTC_8x8_Format;\r\n\texports.RGBA_ASTC_10x5_Format = RGBA_ASTC_10x5_Format;\r\n\texports.RGBA_ASTC_10x6_Format = RGBA_ASTC_10x6_Format;\r\n\texports.RGBA_ASTC_10x8_Format = RGBA_ASTC_10x8_Format;\r\n\texports.RGBA_ASTC_10x10_Format = RGBA_ASTC_10x10_Format;\r\n\texports.RGBA_ASTC_12x10_Format = RGBA_ASTC_12x10_Format;\r\n\texports.RGBA_ASTC_12x12_Format = RGBA_ASTC_12x12_Format;\r\n\texports.LoopOnce = LoopOnce;\r\n\texports.LoopRepeat = LoopRepeat;\r\n\texports.LoopPingPong = LoopPingPong;\r\n\texports.InterpolateDiscrete = InterpolateDiscrete;\r\n\texports.InterpolateLinear = InterpolateLinear;\r\n\texports.InterpolateSmooth = InterpolateSmooth;\r\n\texports.ZeroCurvatureEnding = ZeroCurvatureEnding;\r\n\texports.ZeroSlopeEnding = ZeroSlopeEnding;\r\n\texports.WrapAroundEnding = WrapAroundEnding;\r\n\texports.TrianglesDrawMode = TrianglesDrawMode;\r\n\texports.TriangleStripDrawMode = TriangleStripDrawMode;\r\n\texports.TriangleFanDrawMode = TriangleFanDrawMode;\r\n\texports.LinearEncoding = LinearEncoding;\r\n\texports.sRGBEncoding = sRGBEncoding;\r\n\texports.GammaEncoding = GammaEncoding;\r\n\texports.RGBEEncoding = RGBEEncoding;\r\n\texports.LogLuvEncoding = LogLuvEncoding;\r\n\texports.RGBM7Encoding = RGBM7Encoding;\r\n\texports.RGBM16Encoding = RGBM16Encoding;\r\n\texports.RGBDEncoding = RGBDEncoding;\r\n\texports.BasicDepthPacking = BasicDepthPacking;\r\n\texports.RGBADepthPacking = RGBADepthPacking;\r\n\texports.TangentSpaceNormalMap = TangentSpaceNormalMap;\r\n\texports.ObjectSpaceNormalMap = ObjectSpaceNormalMap;\r\n\texports.CubeGeometry = BoxGeometry;\r\n\texports.Face4 = Face4;\r\n\texports.LineStrip = LineStrip;\r\n\texports.LinePieces = LinePieces;\r\n\texports.MeshFaceMaterial = MeshFaceMaterial;\r\n\texports.MultiMaterial = MultiMaterial;\r\n\texports.PointCloud = PointCloud;\r\n\texports.Particle = Particle;\r\n\texports.ParticleSystem = ParticleSystem;\r\n\texports.PointCloudMaterial = PointCloudMaterial;\r\n\texports.ParticleBasicMaterial = ParticleBasicMaterial;\r\n\texports.ParticleSystemMaterial = ParticleSystemMaterial;\r\n\texports.Vertex = Vertex;\r\n\texports.DynamicBufferAttribute = DynamicBufferAttribute;\r\n\texports.Int8Attribute = Int8Attribute;\r\n\texports.Uint8Attribute = Uint8Attribute;\r\n\texports.Uint8ClampedAttribute = Uint8ClampedAttribute;\r\n\texports.Int16Attribute = Int16Attribute;\r\n\texports.Uint16Attribute = Uint16Attribute;\r\n\texports.Int32Attribute = Int32Attribute;\r\n\texports.Uint32Attribute = Uint32Attribute;\r\n\texports.Float32Attribute = Float32Attribute;\r\n\texports.Float64Attribute = Float64Attribute;\r\n\texports.ClosedSplineCurve3 = ClosedSplineCurve3;\r\n\texports.SplineCurve3 = SplineCurve3;\r\n\texports.Spline = Spline;\r\n\texports.AxisHelper = AxisHelper;\r\n\texports.BoundingBoxHelper = BoundingBoxHelper;\r\n\texports.EdgesHelper = EdgesHelper;\r\n\texports.WireframeHelper = WireframeHelper;\r\n\texports.XHRLoader = XHRLoader;\r\n\texports.BinaryTextureLoader = BinaryTextureLoader;\r\n\texports.GeometryUtils = GeometryUtils;\r\n\texports.Projector = Projector;\r\n\texports.CanvasRenderer = CanvasRenderer;\r\n\texports.SceneUtils = SceneUtils;\r\n\texports.LensFlare = LensFlare;\r\n\r\n\treturn exports;\t\r\n\r\n});\r\n"]}